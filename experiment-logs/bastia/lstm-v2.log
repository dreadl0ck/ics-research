2020-02-02 18:11:08.706121: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory
2020-02-02 18:11:08.706278: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory
2020-02-02 18:11:08.706293: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-02-02 18:11:09.505010: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory
2020-02-02 18:11:09.505041: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-02-02 18:11:09.505072: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (bastia): /proc/driver/nvidia/version does not exist
2020-02-02 18:11:09.505276: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-02-02 18:11:09.514640: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2112050000 Hz
2020-02-02 18:11:09.516084: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5362f70 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-02-02 18:11:09.516107: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-02-02 18:11:13.351564: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-02 18:11:13.368218: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 18:11:13.375696: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 18:11:13.436334: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-02 18:11:13.440002: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-02 18:11:13.445417: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 18:11:13.450745: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 18:11:13.464227: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-02 18:11:17.143533: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-02 18:11:17.147558: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 18:11:17.149434: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 18:11:17.163522: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-02 18:11:17.164457: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-02 18:11:17.165843: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 18:11:17.167233: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 18:11:17.171715: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
Date: 2020-02-02 18:11:09.499452
[INFO] input_shape (10, 16)
[INFO] LSTM first and last layer neurons: 5
adding core layer 0
[INFO] created DNN
[33m[INFO] epoch 1/10[0m
[33m[INFO] loading file 1-1/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1356 (0.2712%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** i/f_name:[2:99.9988%,3:0.0012%]
[INFO] ** i/f_dir:[1:99.9988%,0:0.0012%]
[INFO] ** src:[22:38.4088%,9:25.8982%,7:18.1636%,1:17.5218%,11:0.0014%,10:0.0014%,14:0.0012%,3:0.001%,2:0.001%,21:0.0006%,15:0.0004%,4:0.0004%,8:0.0002%]
[INFO] ** dst:[21:43.266%,10:21.0416%,8:18.1634%,9:17.5214%,6:0.0016%,16:0.0012%,15:0.0012%,22:0.001%,18:0.0006%,26:0.0004%,25:0.0004%,19:0.0004%,17:0.0004%,24:0.0002%,7:0.0002%]
[INFO] ** proto:[0:99.996%,2:0.0028%,1:0.0012%]
[INFO] ** appi_name:[21:99.9928%,30:0.0012%,22:0.001%,17:0.0008%,31:0.0006%,26:0.0006%,7:0.0006%,23:0.0004%,18:0.0004%,0:0.0004%,28:0.0002%,27:0.0002%,24:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.4088%,20:25.8982%,13:18.1636%,6:17.5218%,11:0.0014%,10:0.0014%,17:0.0012%,14:0.001%,1:0.001%,7:0.0006%,21:0.0004%,16:0.0004%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9928%,-33.760870000000004:0.007%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9974%,11:49.9954%,0:0.007%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:25.8976%,1:21.0406%,5:18.163%,4:17.521%,2:17.3678%,0:0.01%]
[INFO] ** service:[0.0048200000000000005:99.9936%,-211.73542999999998:0.0012%,-211.08818:0.001%,-205.44247:0.0008%,-211.07873999999998:0.0008%,-211.09762999999998:0.0006%,-211.08346:0.0006%,-186.43601999999998:0.0006%,-186.44547:0.0004%,-185.9872:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:25.8978%,-0.32151:21.0408%,-1.27613:18.1632%,-0.23351:17.5212%,-0.33484:17.368%,-71.33197:0.0012%,-71.14931:0.001%,-2.1481:0.0008%,-0.24151:0.0006%,-71.14798:0.0006%,-2.42942:0.0004%,4.44364:0.0004%,-1.02014:0.0004%,-64.19493:0.0004%,-5.1466400000000005:0.0002%,-1.2708:0.0002%,-58.035180000000004:0.0002%,4.076980000000001:0.0002%,-5.08665:0.0002%,1.47576:0.0002%,1.46509:0.0002%,4.29964:0.0002%,14.253910000000001:0.0002%,-68.79874000000001:0.0002%,6.1115699999999995:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,10.67005:0.0002%,-1.27347:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** classification:[normal:79.2972%,Single Stage Single Point:20.7028%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.6975 - tp: 43216.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 36784.0000 - accuracy: 0.9080 - precision: 1.0000 - recall: 0.5402 - auc: 0.9825 - val_loss: 0.1485 - val_tp: 19782.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 218.0000 - val_accuracy: 0.9978 - val_precision: 1.0000 - val_recall: 0.9891 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2121 - tp: 73174.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 6826.0000 - accuracy: 0.9829 - precision: 1.0000 - recall: 0.9147 - auc: 1.0000 - val_loss: 0.0374 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1397 - tp: 75794.0000 - fp: 228.0000 - tn: 319772.0000 - fn: 4206.0000 - accuracy: 0.9889 - precision: 0.9970 - recall: 0.9474 - auc: 0.9979 - val_loss: 3.4453 - val_tp: 10606.0000 - val_fp: 9394.0000 - val_tn: 70606.0000 - val_fn: 9394.0000 - val_accuracy: 0.8121 - val_precision: 0.5303 - val_recall: 0.5303 - val_auc: 0.6984
[INFO] saving weights to checkpoints/lstm-epoch-1-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.6927 - tp: 31443.0000 - fp: 27729.0000 - tn: 292271.0000 - fn: 48557.0000 - accuracy: 0.8093 - precision: 0.5314 - recall: 0.3930 - auc: 0.7763 - val_loss: 0.9185 - val_tp: 9629.0000 - val_fp: 8371.0000 - val_tn: 71629.0000 - val_fn: 10371.0000 - val_accuracy: 0.8126 - val_precision: 0.5349 - val_recall: 0.4814 - val_auc: 0.8832
[INFO] saving weights to checkpoints/lstm-epoch-1-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8914 - tp: 25338.0000 - fp: 22352.0000 - tn: 297648.0000 - fn: 54662.0000 - accuracy: 0.8075 - precision: 0.5313 - recall: 0.3167 - auc: 0.8817 - val_loss: 0.7533 - val_tp: 10603.0000 - val_fp: 8858.0000 - val_tn: 71142.0000 - val_fn: 9397.0000 - val_accuracy: 0.8174 - val_precision: 0.5448 - val_recall: 0.5301 - val_auc: 0.8826
[INFO] saving weights to checkpoints/lstm-epoch-1-files-0-1-batch-400000-500000
[33m[INFO] loading file 2-2/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1359 (0.2718%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9996%,3:0.0004%]
[INFO] ** i/f_dir:[1:99.9996%,0:0.0004%]
[INFO] ** src:[22:38.3832%,9:25.9606%,7:18.1352%,1:17.52%,14:0.0004%,3:0.0004%,15:0.0002%]
[INFO] ** dst:[21:43.3108%,10:21.0326%,8:18.135%,9:17.5198%,22:0.0008%,15:0.0004%,2:0.0004%,24:0.0002%]
[INFO] ** proto:[0:99.9996%,1:0.0004%]
[INFO] ** appi_name:[21:99.9992%,30:0.0004%,8:0.0002%,7:0.0002%]
[INFO] ** proxy_src_ip:[18:38.3832%,20:25.9606%,13:18.1352%,6:17.52%,17:0.0004%,1:0.0004%,16:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9992%,-33.760870000000004:0.0008%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.9992%,0:0.0008%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:25.9596%,1:21.0326%,5:18.1348%,4:17.5194%,2:17.3504%,0:0.0032%]
[INFO] ** service:[0.0048200000000000005:99.9992%,-211.73542999999998:0.0004%,-211.09762999999998:0.0002%,-211.35747999999998:0.0002%]
[INFO] ** s_port:[1.45442:25.96%,-0.32151:21.0326%,-1.27613:18.1348%,-0.23351:17.5196%,-0.33484:17.3506%,1.45709:0.0004%,-71.33197:0.0004%,-1.27347:0.0002%,-0.24950999999999998:0.0002%,-3.3787199999999995:0.0002%,1.47576:0.0002%,12.60597:0.0002%,-0.24151:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:72.7902%,Single Stage Single Point:27.2098%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7950 - tp: 26445.0000 - fp: 24185.0000 - tn: 295815.0000 - fn: 53555.0000 - accuracy: 0.8056 - precision: 0.5223 - recall: 0.3306 - auc: 0.8798 - val_loss: 0.7183 - val_tp: 10589.0000 - val_fp: 8935.0000 - val_tn: 71065.0000 - val_fn: 9411.0000 - val_accuracy: 0.8165 - val_precision: 0.5424 - val_recall: 0.5294 - val_auc: 0.8823
[INFO] saving weights to checkpoints/lstm-epoch-1-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5457 - tp: 61090.0000 - fp: 11873.0000 - tn: 308127.0000 - fn: 18910.0000 - accuracy: 0.9230 - precision: 0.8373 - recall: 0.7636 - auc: 0.9578 - val_loss: 0.1973 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3931 - tp: 69996.0000 - fp: 7287.0000 - tn: 312713.0000 - fn: 10004.0000 - accuracy: 0.9568 - precision: 0.9057 - recall: 0.8749 - auc: 0.9741 - val_loss: 1.1423 - val_tp: 10593.0000 - val_fp: 9407.0000 - val_tn: 70593.0000 - val_fn: 9407.0000 - val_accuracy: 0.8119 - val_precision: 0.5296 - val_recall: 0.5296 - val_auc: 0.8826
[INFO] saving weights to checkpoints/lstm-epoch-1-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7959 - tp: 35547.0000 - fp: 32006.0000 - tn: 287994.0000 - fn: 44453.0000 - accuracy: 0.8089 - precision: 0.5262 - recall: 0.4443 - auc: 0.8806 - val_loss: 0.7020 - val_tp: 10602.0000 - val_fp: 9398.0000 - val_tn: 70602.0000 - val_fn: 9398.0000 - val_accuracy: 0.8120 - val_precision: 0.5301 - val_recall: 0.5301 - val_auc: 0.8822
[INFO] saving weights to checkpoints/lstm-epoch-1-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5182 - tp: 63251.0000 - fp: 12377.0000 - tn: 307623.0000 - fn: 16749.0000 - accuracy: 0.9272 - precision: 0.8363 - recall: 0.7906 - auc: 0.9601 - val_loss: 0.1874 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-1-2-batch-400000-500000
[33m[INFO] loading file 3-3/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1357 (0.2714%)
[INFO] ** orig:[0:99.9988%,2:0.0012%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** i/f_name:[2:99.9984%,3:0.0016%]
[INFO] ** i/f_dir:[1:99.9984%,0:0.0016%]
[INFO] ** src:[22:38.418%,9:25.9724%,7:18.1538%,1:17.4466%,21:0.0022%,3:0.0018%,2:0.0014%,11:0.0008%,10:0.0008%,4:0.0008%,14:0.0004%,8:0.0004%,17:0.0002%,15:0.0002%,13:0.0002%]
[INFO] ** dst:[21:43.3012%,10:21.0888%,8:18.1536%,9:17.4462%,6:0.0024%,15:0.0016%,18:0.0014%,16:0.0014%,22:0.001%,2:0.0004%,7:0.0004%,25:0.0004%,17:0.0004%,12:0.0002%,24:0.0002%,19:0.0002%,0:0.0002%]
[INFO] ** proto:[0:99.9936%,2:0.0048%,1:0.0016%]
[INFO] ** appi_name:[21:99.9908%,30:0.0024%,22:0.0012%,31:0.001%,26:0.001%,17:0.001%,7:0.0008%,27:0.0004%,0:0.0004%,28:0.0002%,23:0.0002%,15:0.0002%,8:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.418%,20:25.9724%,13:18.1538%,6:17.4466%,17:0.0024%,1:0.0016%,14:0.0014%,7:0.001%,11:0.0008%,10:0.0008%,21:0.0006%,16:0.0002%,15:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9908%,-33.760870000000004:0.009%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9962%,11:49.9946%,0:0.009%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:25.9712%,1:21.0884%,5:18.153%,4:17.4458%,2:17.3292%,0:0.0124%]
[INFO] ** service:[0.0048200000000000005:99.991%,-211.73542999999998:0.0016%,-186.43601999999998:0.0014%,-211.08346:0.0012%,-211.08818:0.0012%,-205.44247:0.001%,-211.09762999999998:0.0008%,-186.44547:0.0004%,-202.75898:0.0004%,-183.8612:0.0002%,-185.9872:0.0002%,-201.23771000000002:0.0002%,-211.35747999999998:0.0002%,-211.07873999999998:0.0002%]
[INFO] ** s_port:[1.45442:25.9716%,-0.32151:21.0886%,-1.27613:18.1532%,-0.23351:17.446%,-0.33484:17.3294%,-71.33197:0.0016%,-71.14798:0.0012%,-71.14931:0.0012%,-64.19493:0.0004%,-0.08551:0.0004%,1.45709:0.0004%,-0.24151:0.0004%,13.431270000000001:0.0002%,14.4699:0.0002%,4.076980000000001:0.0002%,-5.1466400000000005:0.0002%,-1.02014:0.0002%,1.47576:0.0002%,-1.2708:0.0002%,-58.035180000000004:0.0002%,-58.032509999999995:0.0002%,12.60597:0.0002%,-5.08665:0.0002%,1.46509:0.0002%,-2.1481:0.0002%,-1.27347:0.0002%,10.67005:0.0002%,-43.76509:0.0002%,2.05573:0.0002%,6.1115699999999995:0.0002%,4.44364:0.0002%,13.86459:0.0002%,4.29964:0.0002%,-0.24950999999999998:0.0002%,-3.3787199999999995:0.0002%,10.192739999999999:0.0002%,-68.79874000000001:0.0002%,14.253910000000001:0.0002%,4.90362:0.0002%,-68.36943000000001:0.0002%]
[INFO] ** classification:[normal:86.7116%,Single Stage Single Point:13.2884%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7378 - tp: 40857.0000 - fp: 31506.0000 - tn: 288494.0000 - fn: 39143.0000 - accuracy: 0.8234 - precision: 0.5646 - recall: 0.5107 - auc: 0.8955 - val_loss: 0.6710 - val_tp: 10571.0000 - val_fp: 9429.0000 - val_tn: 70571.0000 - val_fn: 9429.0000 - val_accuracy: 0.8114 - val_precision: 0.5286 - val_recall: 0.5286 - val_auc: 0.9245
[INFO] saving weights to checkpoints/lstm-epoch-1-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5816 - tp: 54369.0000 - fp: 20535.0000 - tn: 299465.0000 - fn: 25631.0000 - accuracy: 0.8846 - precision: 0.7258 - recall: 0.6796 - auc: 0.9445 - val_loss: 0.3485 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1172 - tp: 78786.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1214.0000 - accuracy: 0.9970 - precision: 1.0000 - recall: 0.9848 - auc: 1.0000 - val_loss: 0.0175 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0509 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0079 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0364 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0045 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-2-3-batch-400000-500000
[33m[INFO] loading file 4-4/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1367 (0.2734%)
[INFO] ** orig:[0:99.9988%,2:0.0012%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** i/f_name:[2:99.9986%,3:0.0014%]
[INFO] ** i/f_dir:[1:99.9988%,0:0.0012%]
[INFO] ** src:[22:38.2474%,9:26.0432%,7:18.1738%,1:17.5328%,21:0.0012%,15:0.0004%,4:0.0004%,17:0.0002%,14:0.0002%,8:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.3578%,10:20.9324%,8:18.1738%,9:17.5324%,15:0.0014%,22:0.0012%,18:0.0004%,24:0.0002%,6:0.0002%,0:0.0002%]
[INFO] ** proto:[0:99.998%,1:0.0014%,2:0.0006%]
[INFO] ** appi_name:[21:99.9976%,30:0.0014%,31:0.0004%,33:0.0002%,26:0.0002%,9:0.0002%]
[INFO] ** proxy_src_ip:[18:38.2474%,20:26.0432%,13:18.1738%,6:17.5328%,17:0.0014%,21:0.0004%,16:0.0004%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9976%,-33.760870000000004:0.0024%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.9978%,0:0.0024%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.0422%,1:20.932%,5:18.1734%,4:17.5318%,2:17.315%,0:0.0056%]
[INFO] ** service:[0.0048200000000000005:99.9978%,-211.73542999999998:0.0014%,-186.43601999999998:0.0004%,-183.8612:0.0002%,-211.08346:0.0002%]
[INFO] ** s_port:[1.45442:26.0424%,-0.32151:20.9322%,-1.27613:18.1734%,-0.23351:17.5322%,-0.33484:17.3152%,-71.33197:0.0014%,1.45709:0.0004%,-0.24151:0.0004%,-1.02014:0.0004%,-0.08551:0.0004%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,14.4699:0.0002%,-49.275529999999996:0.0002%,-1.2708:0.0002%,-71.14798:0.0002%]
[INFO] ** classification:[normal:91.244%,Single Stage Single Point:8.756%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0293 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0029 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0245 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0020 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0014 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4824 - tp: 71528.0000 - fp: 8472.0000 - tn: 311528.0000 - fn: 8472.0000 - accuracy: 0.9576 - precision: 0.8941 - recall: 0.8941 - auc: 0.9625 - val_loss: 1.4751 - val_tp: 7806.0000 - val_fp: 12194.0000 - val_tn: 67806.0000 - val_fn: 12194.0000 - val_accuracy: 0.7561 - val_precision: 0.3903 - val_recall: 0.3903 - val_auc: 0.8475
[INFO] saving weights to checkpoints/lstm-epoch-1-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6305 - tp: 56887.0000 - fp: 23113.0000 - tn: 296887.0000 - fn: 23113.0000 - accuracy: 0.8844 - precision: 0.7111 - recall: 0.7111 - auc: 0.9289 - val_loss: 0.3404 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-3-4-batch-400000-500000
[33m[INFO] loading file 5-5/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1365 (0.273%)
[INFO] ** orig:[0:99.9982%,2:0.0018%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** i/f_name:[2:99.9978%,3:0.0022%]
[INFO] ** i/f_dir:[1:99.998%,0:0.002%]
[INFO] ** src:[22:37.992%,9:26.1346%,7:18.252%,1:17.618%,21:0.002%,14:0.0004%,16:0.0002%,15:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.365%,10:20.7618%,8:18.2518%,9:17.6176%,15:0.0022%,22:0.0008%,25:0.0002%,24:0.0002%,6:0.0002%,2:0.0002%]
[INFO] ** proto:[0:99.9974%,1:0.0022%,2:0.0004%]
[INFO] ** appi_name:[21:99.9968%,30:0.0022%,37:0.0002%,26:0.0002%,12:0.0002%,6:0.0002%,0:0.0002%]
[INFO] ** proxy_src_ip:[18:37.992%,20:26.1346%,13:18.252%,6:17.618%,17:0.0022%,21:0.0002%,16:0.0002%,7:0.0002%,5:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9968%,-33.760870000000004:0.0032%]
[INFO] ** modbus_function_description:[7:49.999%,11:49.9978%,0:0.0032%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.134%,1:20.7612%,5:18.2516%,4:17.6176%,2:17.2306%,0:0.005%]
[INFO] ** service:[0.0048200000000000005:99.9972%,-211.73542999999998:0.0022%,-186.44547:0.0002%,-211.08346:0.0002%,-211.35747999999998:0.0002%]
[INFO] ** s_port:[1.45442:26.1344%,-0.32151:20.7614%,-1.27613:18.2518%,-0.23351:17.6176%,-0.33484:17.2306%,-71.33197:0.0022%,-0.24151:0.0004%,-71.14798:0.0002%,-1.27347:0.0002%,1.45709:0.0002%,2.22906:0.0002%,-49.275529999999996:0.0002%,-61.95768:0.0002%,-1.02014:0.0002%,-64.19493:0.0002%]
[INFO] ** classification:[normal:88.731%,Single Stage Single Point:11.269%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5361 - tp: 62445.0000 - fp: 17555.0000 - tn: 302445.0000 - fn: 17555.0000 - accuracy: 0.9122 - precision: 0.7806 - recall: 0.7806 - auc: 0.9482 - val_loss: 0.6685 - val_tp: 12842.0000 - val_fp: 7158.0000 - val_tn: 72842.0000 - val_fn: 7158.0000 - val_accuracy: 0.8568 - val_precision: 0.6421 - val_recall: 0.6421 - val_auc: 0.9674
[INFO] saving weights to checkpoints/lstm-epoch-1-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5138 - tp: 56335.0000 - fp: 22778.0000 - tn: 297222.0000 - fn: 23665.0000 - accuracy: 0.8839 - precision: 0.7121 - recall: 0.7042 - auc: 0.9567 - val_loss: 0.3548 - val_tp: 15487.0000 - val_fp: 3806.0000 - val_tn: 76194.0000 - val_fn: 4513.0000 - val_accuracy: 0.9168 - val_precision: 0.8027 - val_recall: 0.7743 - val_auc: 0.9811
[INFO] saving weights to checkpoints/lstm-epoch-1-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1005 - tp: 78954.0000 - fp: 938.0000 - tn: 319062.0000 - fn: 1046.0000 - accuracy: 0.9950 - precision: 0.9883 - recall: 0.9869 - auc: 0.9996 - val_loss: 0.0093 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0351 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0042 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0245 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0024 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-4-5-batch-400000-500000
[33m[INFO] loading file 6-6/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1369 (0.2738%)
[INFO] ** orig:[0:99.9996%,1:0.0004%]
[INFO] ** type:[0:99.999%,1:0.001%]
[INFO] ** i/f_name:[2:99.9964%,3:0.0036%]
[INFO] ** i/f_dir:[1:99.9966%,0:0.0034%]
[INFO] ** src:[22:37.9454%,9:26.1658%,7:18.285%,1:17.5992%,14:0.0036%,2:0.0006%,15:0.0002%,10:0.0002%]
[INFO] ** dst:[21:43.3788%,10:20.7322%,8:18.2848%,9:17.599%,15:0.0036%,22:0.0004%,25:0.0002%,24:0.0002%,18:0.0002%,12:0.0002%,7:0.0002%,6:0.0002%]
[INFO] ** proto:[0:99.9954%,1:0.0036%,2:0.001%]
[INFO] ** appi_name:[21:99.9954%,30:0.0036%,31:0.0002%,27:0.0002%,26:0.0002%,5:0.0002%,0:0.0002%]
[INFO] ** proxy_src_ip:[18:37.9454%,20:26.1658%,13:18.285%,6:17.5992%,17:0.0036%,14:0.0006%,16:0.0002%,11:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9954%,-33.760870000000004:0.0046%]
[INFO] ** modbus_function_description:[7:49.9984%,11:49.997%,0:0.0046%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1652%,1:20.732%,5:18.2842%,4:17.5984%,2:17.213%,0:0.0072%]
[INFO] ** service:[0.0048200000000000005:99.9954%,-211.73542999999998:0.0036%,-186.44547:0.0002%,-211.08346:0.0002%,-186.43601999999998:0.0002%,-201.23771000000002:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:26.1654%,-0.32151:20.7322%,-1.27613:18.2844%,-0.23351:17.5988%,-0.33484:17.2132%,-71.33197:0.0036%,-0.24151:0.0002%,-1.2708:0.0002%,-64.19493:0.0002%,-1.02014:0.0002%,13.431270000000001:0.0002%,4.90362:0.0002%,-71.14798:0.0002%,1.47576:0.0002%,1.46509:0.0002%,-0.24950999999999998:0.0002%,-1.27347:0.0002%,-68.36943000000001:0.0002%]
[INFO] ** classification:[normal:91.919%,Single Stage Single Point:8.081%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0185 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0016 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0156 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0129 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.0386e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0109 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6616 - val_tp: 15632.0000 - val_fp: 4368.0000 - val_tn: 75632.0000 - val_fn: 4368.0000 - val_accuracy: 0.9126 - val_precision: 0.7816 - val_recall: 0.7816 - val_auc: 0.8635
[INFO] saving weights to checkpoints/lstm-epoch-1-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7559 - tp: 58776.0000 - fp: 20044.0000 - tn: 299956.0000 - fn: 21224.0000 - accuracy: 0.8968 - precision: 0.7457 - recall: 0.7347 - auc: 0.9366 - val_loss: 0.2151 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-5-6-batch-400000-500000
[33m[INFO] loading file 7-7/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1365 (0.273%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9986%,3:0.0014%]
[INFO] ** i/f_dir:[1:99.9986%,0:0.0014%]
[INFO] ** src:[22:37.9848%,9:26.133%,7:18.2404%,1:17.6366%,14:0.0014%,10:0.0008%,3:0.0008%,4:0.0006%,21:0.0004%,15:0.0004%,2:0.0004%,11:0.0002%,8:0.0002%]
[INFO] ** dst:[21:43.358%,10:20.759%,8:18.24%,9:17.6364%,6:0.0016%,22:0.0014%,15:0.0014%,16:0.0008%,24:0.0004%,18:0.0004%,17:0.0004%,7:0.0002%]
[INFO] ** proto:[0:99.9964%,2:0.0022%,1:0.0014%]
[INFO] ** appi_name:[21:99.9952%,30:0.0014%,22:0.001%,17:0.0008%,26:0.0006%,31:0.0004%,28:0.0002%,27:0.0002%,7:0.0002%]
[INFO] ** proxy_src_ip:[18:37.9848%,20:26.133%,13:18.2404%,6:17.6366%,17:0.0014%,11:0.0008%,1:0.0008%,21:0.0006%,16:0.0004%,14:0.0004%,7:0.0004%,10:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9952%,-33.760870000000004:0.0048%]
[INFO] ** modbus_function_description:[7:49.9984%,11:49.9968%,0:0.0048%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1316%,1:20.759%,5:18.2398%,4:17.636%,2:17.2258%,0:0.0078%]
[INFO] ** service:[0.0048200000000000005:99.9952%,-211.73542999999998:0.0014%,-211.08818:0.001%,-205.44247:0.0008%,-211.08346:0.0006%,-186.43601999999998:0.0004%,-211.09762999999998:0.0002%,-185.9872:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:26.132%,-0.32151:20.759%,-1.27613:18.2398%,-0.23351:17.6362%,-0.33484:17.2258%,-71.33197:0.0014%,-71.14931:0.001%,-71.14798:0.0006%,1.45709:0.0006%,-1.02014:0.0004%,-1.27347:0.0004%,-0.24151:0.0004%,-58.035180000000004:0.0002%,-1.2708:0.0002%,-5.1466400000000005:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-5.08665:0.0002%,14.253910000000001:0.0002%,-68.79874000000001:0.0002%,6.1115699999999995:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** classification:[normal:82.7162%,Single Stage Single Point:17.2838%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2360 - tp: 71601.0000 - fp: 7298.0000 - tn: 312702.0000 - fn: 8399.0000 - accuracy: 0.9608 - precision: 0.9075 - recall: 0.8950 - auc: 0.9943 - val_loss: 0.0668 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1288 - tp: 78097.0000 - fp: 1794.0000 - tn: 318206.0000 - fn: 1903.0000 - accuracy: 0.9908 - precision: 0.9775 - recall: 0.9762 - auc: 0.9994 - val_loss: 0.0218 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3341 - tp: 65325.0000 - fp: 13865.0000 - tn: 306135.0000 - fn: 14675.0000 - accuracy: 0.9286 - precision: 0.8249 - recall: 0.8166 - auc: 0.9808 - val_loss: 0.2299 - val_tp: 19611.0000 - val_fp: 365.0000 - val_tn: 79635.0000 - val_fn: 389.0000 - val_accuracy: 0.9925 - val_precision: 0.9817 - val_recall: 0.9805 - val_auc: 0.9982
[INFO] saving weights to checkpoints/lstm-epoch-1-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0452 - tp: 79915.0000 - fp: 74.0000 - tn: 319926.0000 - fn: 85.0000 - accuracy: 0.9996 - precision: 0.9991 - recall: 0.9989 - auc: 1.0000 - val_loss: 0.0029 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0266 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0014 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-6-7-batch-400000-500000
[33m[INFO] loading file 8-8/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1369 (0.2738%)
[INFO] ** orig:[0:99.9996%,2:0.0004%]
[INFO] ** type:[0:99.9994%,1:0.0004%,2:0.0002%]
[INFO] ** i/f_name:[2:99.999%,3:0.001%]
[INFO] ** i/f_dir:[1:99.9994%,0:0.0006%]
[INFO] ** src:[22:38.1046%,9:26.147%,7:18.1632%,1:17.5816%,11:0.0012%,15:0.0006%,14:0.0006%,21:0.0004%,2:0.0004%,16:0.0002%,10:0.0002%]
[INFO] ** dst:[21:43.4334%,10:20.8176%,8:18.164%,9:17.5812%,22:0.0014%,15:0.001%,25:0.0006%,19:0.0004%,26:0.0002%,24:0.0002%]
[INFO] ** proto:[0:99.9982%,1:0.001%,2:0.0008%]
[INFO] ** appi_name:[21:99.997%,30:0.001%,0:0.0006%,24:0.0002%,23:0.0002%,22:0.0002%,18:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.1046%,20:26.147%,13:18.1632%,6:17.5816%,10:0.0012%,17:0.001%,16:0.0006%,14:0.0004%,11:0.0002%,5:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.997%,-33.760870000000004:0.0028%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.9972%,0:0.0028%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.146%,1:20.8174%,5:18.163%,4:17.5808%,2:17.2868%,0:0.006%]
[INFO] ** service:[0.0048200000000000005:99.9978%,-211.73542999999998:0.001%,-186.44547:0.0006%,-211.07873999999998:0.0004%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:26.1464%,-0.32151:20.8176%,-1.27613:18.163%,-0.23351:17.581%,-0.33484:17.287%,-71.33197:0.001%,-15.039579999999999:0.0008%,-1.02014:0.0006%,-64.19493:0.0006%,1.45709:0.0004%,-0.24151:0.0004%,4.66896:0.0004%,-1.27347:0.0002%,-0.24950999999999998:0.0002%,1.47576:0.0002%,-71.14931:0.0002%]
[INFO] ** classification:[normal:94.2844%,Single Stage Single Point:5.7156%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.8077e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0164 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.9159e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0135 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3284e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3915 - tp: 73145.0000 - fp: 6819.0000 - tn: 313181.0000 - fn: 6855.0000 - accuracy: 0.9658 - precision: 0.9147 - recall: 0.9143 - auc: 0.9737 - val_loss: 0.1840 - val_tp: 16389.0000 - val_fp: 3602.0000 - val_tn: 76398.0000 - val_fn: 3611.0000 - val_accuracy: 0.9279 - val_precision: 0.8198 - val_recall: 0.8195 - val_auc: 0.9918
[INFO] saving weights to checkpoints/lstm-epoch-1-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0985 - tp: 77640.0000 - fp: 2175.0000 - tn: 317825.0000 - fn: 2360.0000 - accuracy: 0.9887 - precision: 0.9727 - recall: 0.9705 - auc: 0.9992 - val_loss: 0.0215 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-7-8-batch-400000-500000
[33m[INFO] loading file 9-9/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9992%,3:0.0008%]
[INFO] ** i/f_dir:[1:99.9992%,0:0.0008%]
[INFO] ** src:[22:38.0%,9:26.1346%,7:18.2984%,1:17.5654%,14:0.0008%,17:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.3632%,10:20.7708%,8:18.2982%,9:17.5652%,22:0.0008%,15:0.0008%,18:0.0004%,25:0.0002%,24:0.0002%,6:0.0002%]
[INFO] ** proto:[0:99.9984%,2:0.0008%,1:0.0008%]
[INFO] ** appi_name:[21:99.9984%,30:0.0008%,31:0.0004%,26:0.0002%,0:0.0002%]
[INFO] ** proxy_src_ip:[18:38.0%,20:26.1346%,13:18.2984%,6:17.5654%,17:0.0008%,21:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9984%,-33.760870000000004:0.0016%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.9986%,0:0.0016%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1334%,1:20.7708%,5:18.298%,4:17.5648%,2:17.2292%,0:0.0038%]
[INFO] ** service:[0.0048200000000000005:99.9984%,-211.73542999999998:0.0008%,-186.43601999999998:0.0004%,-186.44547:0.0002%,-211.08346:0.0002%]
[INFO] ** s_port:[1.45442:26.1338%,-0.32151:20.7708%,-1.27613:18.298%,-0.23351:17.565%,-0.33484:17.2292%,-71.33197:0.0008%,1.45709:0.0004%,-0.24151:0.0004%,-0.08551:0.0004%,-71.14798:0.0002%,-1.27347:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-64.19493:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:96.1038%,Single Stage Single Point:3.8962%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0646 - tp: 79018.0000 - fp: 969.0000 - tn: 319031.0000 - fn: 982.0000 - accuracy: 0.9951 - precision: 0.9879 - recall: 0.9877 - auc: 0.9996 - val_loss: 0.0096 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1250 - tp: 78454.0000 - fp: 1546.0000 - tn: 318454.0000 - fn: 1546.0000 - accuracy: 0.9923 - precision: 0.9807 - recall: 0.9807 - auc: 0.9924 - val_loss: 0.0033 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0018 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0136 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0011 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0105 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.4133e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-8-9-batch-400000-500000
[33m[INFO] loading file 10-10/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1365 (0.273%)
[INFO] ** orig:[0:99.9992%,1:0.0008%]
[INFO] ** type:[0:99.9984%,1:0.0014%,2:0.0002%]
[INFO] ** i/f_name:[2:99.998%,3:0.002%]
[INFO] ** i/f_dir:[1:99.9982%,0:0.0018%]
[INFO] ** src:[22:38.097%,9:26.13%,7:18.2188%,1:17.5504%,14:0.002%,11:0.001%,2:0.0004%,16:0.0002%,15:0.0002%]
[INFO] ** dst:[21:43.4154%,10:20.8112%,8:18.2186%,9:17.551%,15:0.002%,22:0.0006%,24:0.0004%,19:0.0004%,26:0.0002%,25:0.0002%]
[INFO] ** proto:[0:99.9976%,1:0.002%,2:0.0004%]
[INFO] ** appi_name:[21:99.9964%,30:0.002%,24:0.0002%,23:0.0002%,22:0.0002%,18:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%,0:0.0002%]
[INFO] ** proxy_src_ip:[18:38.097%,20:26.13%,13:18.2188%,6:17.5504%,17:0.002%,10:0.001%,14:0.0004%,16:0.0002%,5:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9964%,-33.760870000000004:0.0034%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9988%,11:49.9976%,0:0.0034%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.129%,1:20.811%,5:18.2182%,4:17.5498%,2:17.2856%,0:0.0064%]
[INFO] ** service:[0.0048200000000000005:99.9972%,-211.73542999999998:0.002%,-211.07873999999998:0.0004%,-186.44547:0.0002%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:26.1294%,-0.32151:20.8112%,-1.27613:18.2182%,-0.23351:17.55%,-0.33484:17.2858%,-71.33197:0.002%,-10.51843:0.0008%,5.71692:0.0004%,-1.27347:0.0004%,1.46509:0.0002%,1.47576:0.0002%,-0.24950999999999998:0.0002%,1.45709:0.0002%,-0.24151:0.0002%,-71.14931:0.0002%,-1.02014:0.0002%,-64.19493:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:93.8902%,Single Stage Single Point:6.1098%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0084 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.3942e-04 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0137 - tp: 79934.0000 - fp: 66.0000 - tn: 319934.0000 - fn: 66.0000 - accuracy: 0.9997 - precision: 0.9992 - recall: 0.9992 - auc: 0.9996 - val_loss: 2.8368 - val_tp: 12842.0000 - val_fp: 7158.0000 - val_tn: 72842.0000 - val_fn: 7158.0000 - val_accuracy: 0.8568 - val_precision: 0.6421 - val_recall: 0.6421 - val_auc: 0.7763
[INFO] saving weights to checkpoints/lstm-epoch-1-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5666 - tp: 67243.0000 - fp: 12708.0000 - tn: 307292.0000 - fn: 12757.0000 - accuracy: 0.9363 - precision: 0.8411 - recall: 0.8405 - auc: 0.9590 - val_loss: 0.5952 - val_tp: 12813.0000 - val_fp: 7187.0000 - val_tn: 72813.0000 - val_fn: 7187.0000 - val_accuracy: 0.8563 - val_precision: 0.6406 - val_recall: 0.6406 - val_auc: 0.9677
[INFO] saving weights to checkpoints/lstm-epoch-1-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1204 - tp: 76684.0000 - fp: 3282.0000 - tn: 316718.0000 - fn: 3316.0000 - accuracy: 0.9835 - precision: 0.9590 - recall: 0.9585 - auc: 0.9980 - val_loss: 0.0112 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0163 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0036 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-9-10-batch-400000-500000
[33m[INFO] loading file 11-11/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9996%,3:0.0004%]
[INFO] ** i/f_dir:[1:99.9996%,0:0.0004%]
[INFO] ** src:[22:38.147%,9:26.1112%,7:18.2032%,1:17.5368%,15:0.0006%,14:0.0004%,17:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.3768%,10:20.881%,8:18.2034%,9:17.5362%,22:0.0014%,18:0.0004%,15:0.0004%,25:0.0002%,6:0.0002%]
[INFO] ** proto:[0:99.9988%,2:0.0008%,1:0.0004%]
[INFO] ** appi_name:[21:99.9988%,31:0.0004%,30:0.0004%,26:0.0002%,0:0.0002%]
[INFO] ** proxy_src_ip:[18:38.147%,20:26.1112%,13:18.2032%,6:17.5368%,16:0.0006%,17:0.0004%,21:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9988%,-33.760870000000004:0.0012%]
[INFO] ** modbus_function_description:[7:50.0004%,11:49.9984%,0:0.0012%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1104%,1:20.881%,5:18.203%,4:17.536%,2:17.2658%,0:0.0038%]
[INFO] ** service:[0.0048200000000000005:99.9988%,-211.73542999999998:0.0004%,-186.43601999999998:0.0004%,-186.44547:0.0002%,-211.08346:0.0002%]
[INFO] ** s_port:[1.45442:26.1108%,-0.32151:20.881%,-1.27613:18.2032%,-0.23351:17.5362%,-0.33484:17.266%,-0.24151:0.0006%,-1.02014:0.0006%,-0.08551:0.0004%,-71.33197:0.0004%,-71.14798:0.0002%,1.45709:0.0002%,1.46509:0.0002%,-64.19493:0.0002%]
[INFO] ** classification:[normal:100.0%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0103 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0021 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0084 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0016 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0073 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0012 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0064 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.4455e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0056 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.5370e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-10-11-batch-400000-500000
[33m[INFO] loading file 12-12/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0:99.9982%,2:0.0018%]
[INFO] ** type:[0:99.9996%,1:0.0004%]
[INFO] ** i/f_name:[2:99.9978%,3:0.0022%]
[INFO] ** i/f_dir:[1:99.9982%,0:0.0018%]
[INFO] ** src:[22:38.138%,9:26.1258%,7:18.1958%,1:17.5378%,21:0.0018%,14:0.0004%,15:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.3898%,10:20.8738%,8:18.1954%,9:17.5376%,15:0.0022%,22:0.0006%,24:0.0004%,0:0.0002%]
[INFO] ** proto:[0:99.9978%,1:0.0022%]
[INFO] ** appi_name:[21:99.9976%,30:0.0022%,9:0.0002%]
[INFO] ** proxy_src_ip:[18:38.138%,20:26.1258%,13:18.1958%,6:17.5378%,17:0.0022%,16:0.0002%,1:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9976%,-33.760870000000004:0.0024%]
[INFO] ** modbus_function_description:[7:49.9994%,11:49.9982%,0:0.0024%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.125%,1:20.8738%,5:18.1952%,4:17.537%,2:17.2642%,0:0.0048%]
[INFO] ** service:[0.0048200000000000005:99.9976%,-211.73542999999998:0.0022%,-183.8612:0.0002%]
[INFO] ** s_port:[1.45442:26.1254%,-0.32151:20.8738%,-1.27613:18.1952%,-0.23351:17.5374%,-0.33484:17.2642%,-71.33197:0.0022%,-1.27347:0.0004%,1.45709:0.0002%,-0.24950999999999998:0.0002%,1.47576:0.0002%,14.4699:0.0002%,-0.24151:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:92.7618%,Single Stage Single Point:7.2382%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0049 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.0763e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0044 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2903 - val_tp: 16689.0000 - val_fp: 3311.0000 - val_tn: 76689.0000 - val_fn: 3311.0000 - val_accuracy: 0.9338 - val_precision: 0.8345 - val_recall: 0.8345 - val_auc: 0.8965
[INFO] saving weights to checkpoints/lstm-epoch-1-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6537 - tp: 62494.0000 - fp: 17034.0000 - tn: 302966.0000 - fn: 17506.0000 - accuracy: 0.9136 - precision: 0.7858 - recall: 0.7812 - auc: 0.9515 - val_loss: 0.3127 - val_tp: 17100.0000 - val_fp: 2900.0000 - val_tn: 77100.0000 - val_fn: 2900.0000 - val_accuracy: 0.9420 - val_precision: 0.8550 - val_recall: 0.8550 - val_auc: 0.9871
[INFO] saving weights to checkpoints/lstm-epoch-1-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1682 - tp: 75222.0000 - fp: 4728.0000 - tn: 315272.0000 - fn: 4778.0000 - accuracy: 0.9762 - precision: 0.9409 - recall: 0.9403 - auc: 0.9956 - val_loss: 0.0226 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0179 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0059 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-11-12-batch-400000-500000
[33m[INFO] loading file 13-13/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** i/f_name:[2:99.9996%,3:0.0004%]
[INFO] ** i/f_dir:[1:99.9996%,0:0.0004%]
[INFO] ** src:[22:38.0458%,9:26.115%,7:18.2794%,1:17.5554%,11:0.0012%,10:0.001%,15:0.0006%,21:0.0004%,14:0.0004%,17:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.3642%,10:20.7962%,8:18.2792%,9:17.556%,22:0.0012%,6:0.001%,18:0.0008%,25:0.0006%,15:0.0004%,24:0.0002%,7:0.0002%]
[INFO] ** proto:[0:99.997%,2:0.0026%,1:0.0004%]
[INFO] ** appi_name:[21:99.9962%,31:0.0008%,26:0.0006%,0:0.0006%,30:0.0004%,22:0.0004%,27:0.0002%,24:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.0458%,20:26.115%,13:18.2794%,6:17.5554%,10:0.0012%,11:0.001%,16:0.0006%,17:0.0004%,7:0.0004%,21:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9962%,-33.760870000000004:0.0036%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9988%,11:49.9974%,0:0.0036%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.114%,1:20.796%,5:18.279%,4:17.555%,2:17.2494%,0:0.0066%]
[INFO] ** service:[0.0048200000000000005:99.997%,-186.43601999999998:0.0008%,-186.44547:0.0006%,-211.08346:0.0006%,-211.73542999999998:0.0004%,-211.08818:0.0004%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:26.1144%,-0.32151:20.7962%,-1.27613:18.279%,-0.23351:17.555%,-0.33484:17.2496%,-9.78512:0.0008%,-71.14798:0.0006%,-64.19493:0.0006%,-1.02014:0.0006%,-0.08551:0.0004%,-71.14931:0.0004%,-0.24151:0.0004%,-71.33197:0.0004%,-1.27347:0.0002%,1.46509:0.0002%,-68.79874000000001:0.0002%,14.540560000000001:0.0002%,1.45709:0.0002%,-1.2708:0.0002%,6.1115699999999995:0.0002%,1.47576:0.0002%]
[INFO] ** classification:[normal:84.6974%,Single Stage Single Point:15.3026%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0126 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0037 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0102 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0025 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0086 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5389 - val_tp: 15075.0000 - val_fp: 4925.0000 - val_tn: 75075.0000 - val_fn: 4925.0000 - val_accuracy: 0.9015 - val_precision: 0.7538 - val_recall: 0.7538 - val_auc: 0.8592
[INFO] saving weights to checkpoints/lstm-epoch-1-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5548 - tp: 63242.0000 - fp: 16590.0000 - tn: 303410.0000 - fn: 16758.0000 - accuracy: 0.9166 - precision: 0.7922 - recall: 0.7905 - auc: 0.9587 - val_loss: 0.0773 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1057 - tp: 77878.0000 - fp: 2114.0000 - tn: 317886.0000 - fn: 2122.0000 - accuracy: 0.9894 - precision: 0.9736 - recall: 0.9735 - auc: 0.9990 - val_loss: 0.0225 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-12-13-batch-400000-500000
[33m[INFO] loading file 14-14/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1365 (0.273%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** i/f_name:[2:99.9998%,3:0.0002%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** src:[22:38.0404%,9:26.1076%,7:18.2758%,1:17.5756%,15:0.0002%,14:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.3416%,10:20.8058%,8:18.2756%,9:17.5754%,22:0.0008%,24:0.0004%,15:0.0002%,0:0.0002%]
[INFO] ** proto:[0:99.9998%,1:0.0002%]
[INFO] ** appi_name:[21:99.9996%,30:0.0002%,9:0.0002%]
[INFO] ** proxy_src_ip:[18:38.0404%,20:26.1076%,13:18.2758%,6:17.5756%,17:0.0002%,16:0.0002%,1:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9996%,-33.760870000000004:0.0004%]
[INFO] ** modbus_function_description:[7:50.0008%,11:49.9988%,0:0.0004%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1064%,1:20.8058%,5:18.275%,4:17.5748%,2:17.2344%,0:0.0036%]
[INFO] ** service:[0.0048200000000000005:99.9996%,-183.8612:0.0002%,-211.73542999999998:0.0002%]
[INFO] ** s_port:[1.45442:26.1068%,-0.32151:20.8058%,-1.27613:18.2752%,-0.23351:17.5752%,-0.33484:17.2346%,-1.27347:0.0004%,1.45709:0.0004%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,14.4699:0.0002%,-0.24151:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%,-71.33197:0.0002%]
[INFO] ** classification:[normal:96.5086%,Single Stage Single Point:3.4914%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3416 - tp: 67167.0000 - fp: 12807.0000 - tn: 307193.0000 - fn: 12833.0000 - accuracy: 0.9359 - precision: 0.8399 - recall: 0.8396 - auc: 0.9829 - val_loss: 0.3058 - val_tp: 16298.0000 - val_fp: 3686.0000 - val_tn: 76314.0000 - val_fn: 3702.0000 - val_accuracy: 0.9261 - val_precision: 0.8156 - val_recall: 0.8149 - val_auc: 0.9798
[INFO] saving weights to checkpoints/lstm-epoch-1-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0359 - tp: 79410.0000 - fp: 589.0000 - tn: 319411.0000 - fn: 590.0000 - accuracy: 0.9971 - precision: 0.9926 - recall: 0.9926 - auc: 0.9999 - val_loss: 0.0057 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0165 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0034 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0132 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0023 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0111 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0016 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-13-14-batch-400000-500000
[33m[INFO] loading file 15-15/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1374 (0.2748%)
[INFO] ** orig:[0:99.997%,2:0.003%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9968%,3:0.0032%]
[INFO] ** i/f_dir:[1:99.9968%,0:0.0032%]
[INFO] ** src:[22:38.005%,9:26.0626%,7:18.3142%,1:17.6136%,21:0.0034%,15:0.0006%,16:0.0002%,14:0.0002%,8:0.0002%]
[INFO] ** dst:[21:43.2978%,10:20.7692%,8:18.3144%,9:17.613%,15:0.0032%,22:0.0016%,25:0.0002%,24:0.0002%,16:0.0002%,6:0.0002%]
[INFO] ** proto:[0:99.9964%,1:0.0032%,2:0.0004%]
[INFO] ** appi_name:[21:99.996%,30:0.0032%,26:0.0002%,17:0.0002%,12:0.0002%,0:0.0002%]
[INFO] ** proxy_src_ip:[18:38.005%,20:26.0626%,13:18.3142%,6:17.6136%,17:0.0032%,16:0.0006%,7:0.0004%,5:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.996%,-33.760870000000004:0.004%]
[INFO] ** modbus_function_description:[7:49.999%,11:49.997%,0:0.004%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.0614%,1:20.7688%,5:18.314%,4:17.6124%,2:17.2358%,0:0.0076%]
[INFO] ** service:[0.0048200000000000005:99.9962%,-211.73542999999998:0.0032%,-186.44547:0.0002%,-211.08346:0.0002%,-205.44247:0.0002%]
[INFO] ** s_port:[1.45442:26.0618%,-0.32151:20.769%,-1.27613:18.314%,-0.23351:17.6128%,-0.33484:17.236%,-71.33197:0.0032%,-1.02014:0.0006%,-0.24151:0.0006%,1.45709:0.0004%,-64.19493:0.0002%,-61.95768:0.0002%,-71.14798:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,10.192739999999999:0.0002%,-0.24950999999999998:0.0002%,1.46509:0.0002%]
[INFO] ** classification:[normal:88.954%,Single Stage Multi Point:11.0452%,Single Stage Single Point:0.0008%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0097 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0012 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0084 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.4213e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0071 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.3208e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0064 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.4873 - val_tp: 11586.0000 - val_fp: 8414.0000 - val_tn: 71586.0000 - val_fn: 8414.0000 - val_accuracy: 0.8317 - val_precision: 0.5793 - val_recall: 0.5793 - val_auc: 0.7371
[INFO] saving weights to checkpoints/lstm-epoch-1-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.8093 - tp: 42253.0000 - fp: 37612.0000 - tn: 282388.0000 - fn: 37747.0000 - accuracy: 0.8116 - precision: 0.5291 - recall: 0.5282 - auc: 0.7506 - val_loss: 1.1811 - val_tp: 10627.0000 - val_fp: 9373.0000 - val_tn: 70627.0000 - val_fn: 9373.0000 - val_accuracy: 0.8125 - val_precision: 0.5314 - val_recall: 0.5314 - val_auc: 0.8827
[INFO] saving weights to checkpoints/lstm-epoch-1-files-14-15-batch-400000-500000
[33m[INFO] loading file 16-16/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (439690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (439690, 17)

[INFO] analyzing data
[INFO] 439690 rows
[INFO] ** unixtime:1201 (0.27315%)
[INFO] ** orig:[0:99.99886%,2:0.00114%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.99886%,3:0.00114%]
[INFO] ** i/f_dir:[1:99.99886%,0:0.00114%]
[INFO] ** src:[22:38.05363%,9:26.10544%,7:18.25172%,1:17.58762%,21:0.00114%,15:0.00023%,4:0.00023%]
[INFO] ** dst:[21:43.35941%,10:20.79943%,8:18.25127%,9:17.58762%,15:0.00114%,22:0.00091%,24:0.00023%]
[INFO] ** proto:[0:99.99886%,1:0.00114%]
[INFO] ** appi_name:[21:99.99864%,30:0.00114%,33:0.00023%]
[INFO] ** proxy_src_ip:[18:38.05363%,20:26.10544%,13:18.25172%,6:17.58762%,17:0.00114%,21:0.00023%,16:0.00023%]
[INFO] ** modbus_function_code:[0.02961:99.99864%,-33.760870000000004:0.00136%]
[INFO] ** modbus_function_description:[7:50.00045%,11:49.99818%,0:0.00136%]
[INFO] ** modbus_transaction_id:65536 (14.90505%)
[INFO] ** scada_tag:[3:26.1043%,1:20.7992%,5:18.25104%,4:17.58694%,2:17.25443%,0:0.00409%]
[INFO] ** service:[0.0048200000000000005:99.99886%,-211.73542999999998:0.00114%]
[INFO] ** s_port:[1.45442:26.10476%,-0.32151:20.7992%,-1.27613:18.25127%,-0.23351:17.58739%,-0.33484:17.25443%,-71.33197:0.00114%,1.45709:0.00045%,-1.27347:0.00023%,1.47576:0.00023%,-49.275529999999996:0.00023%,-0.24151:0.00023%,-1.02014:0.00023%,-1.2708:0.00023%]
[INFO] ** classification:[normal:84.4188%,Single Stage Multi Point:15.5812%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/439690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.4323 - tp: 40988.0000 - fp: 38785.0000 - tn: 281215.0000 - fn: 39012.0000 - accuracy: 0.8055 - precision: 0.5138 - recall: 0.5124 - auc: 0.8475 - val_loss: 0.8703 - val_tp: 10618.0000 - val_fp: 9382.0000 - val_tn: 70618.0000 - val_fn: 9382.0000 - val_accuracy: 0.8124 - val_precision: 0.5309 - val_recall: 0.5309 - val_auc: 0.8935
[INFO] saving weights to checkpoints/lstm-epoch-1-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/439690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.9147 - tp: 54125.0000 - fp: 25781.0000 - tn: 294219.0000 - fn: 25875.0000 - accuracy: 0.8709 - precision: 0.6774 - recall: 0.6766 - auc: 0.9140 - val_loss: 0.1116 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/439690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0935 - tp: 78580.0000 - fp: 1418.0000 - tn: 318582.0000 - fn: 1420.0000 - accuracy: 0.9929 - precision: 0.9823 - recall: 0.9822 - auc: 0.9996 - val_loss: 0.0184 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/439690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0266 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0120 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/439690
[33m[INFO] loading file 17-17/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539690, 17)

[INFO] analyzing data
[INFO] 539690 rows
[INFO] ** appi_name:[21:99.99722%,7:0.00056%,26:0.00037%,0:0.00037%,31:0.00019%,27:0.00019%,24:0.00019%,22:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:94.28376%,Multi Stage Multi Point:5.71624%]
[INFO] ** dst:[21:43.34562%,10:20.85123%,8:18.201%,9:17.59918%,22:0.00074%,6:0.00056%,25:0.00037%,16:0.00037%,2:0.00037%,24:0.00019%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99722%,-33.760870000000004:0.00259%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99963%,11:49.99759%,0:0.00259%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.14327%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9987%,2:0.0013%]
[INFO] ** proxy_src_ip:[18:38.08316%,20:26.11444%,13:18.20045%,6:17.59899%,10:0.00111%,11:0.00093%,1:0.00037%,16:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.11351%,-0.32151:20.85123%,-1.27613:18.20008%,-0.23351:17.59881%,-0.33484:17.23193%,6.0369:0.00074%,-71.14798:0.00037%,1.47576:0.00037%,-64.19493:0.00037%,1.45709:0.00037%,1.46509:0.00019%,-68.79874000000001:0.00019%,-1.27347:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,6.15557:0.00019%,6.06224:0.00019%,8.55414:0.00019%,-3.3787199999999995:0.00019%,-4.3880099999999995:0.00019%,-71.14931:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:26.11332%,1:20.85104%,5:18.19989%,4:17.59844%,2:17.23193%,0:0.00537%]
[INFO] ** service:[0.0048200000000000005:99.99796%,-211.09762999999998:0.00056%,-211.08346:0.00037%,-186.44547:0.00037%,-211.35747999999998:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.08316%,9:26.11444%,7:18.20045%,1:17.59899%,11:0.00111%,10:0.00093%,3:0.00037%,21:0.00019%,15:0.00019%,2:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1475 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0092 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0150 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0072 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0124 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0059 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8613 - tp: 68276.0000 - fp: 11202.0000 - tn: 308798.0000 - fn: 11724.0000 - accuracy: 0.9427 - precision: 0.8591 - recall: 0.8535 - auc: 0.9347 - val_loss: 0.4579 - val_tp: 16369.0000 - val_fp: 3631.0000 - val_tn: 76369.0000 - val_fn: 3631.0000 - val_accuracy: 0.9274 - val_precision: 0.8184 - val_recall: 0.8184 - val_auc: 0.9835
[INFO] saving weights to checkpoints/lstm-epoch-1-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3746 - tp: 71429.0000 - fp: 7765.0000 - tn: 312235.0000 - fn: 8571.0000 - accuracy: 0.9592 - precision: 0.9019 - recall: 0.8929 - auc: 0.9800 - val_loss: 0.1930 - val_tp: 17595.0000 - val_fp: 2019.0000 - val_tn: 77981.0000 - val_fn: 2405.0000 - val_accuracy: 0.9558 - val_precision: 0.8971 - val_recall: 0.8798 - val_auc: 0.9949
[INFO] saving weights to checkpoints/lstm-epoch-1-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/539690
[33m[INFO] loading file 18-18/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539690, 17)

[INFO] analyzing data
[INFO] 539690 rows
[INFO] ** appi_name:[21:99.99815%,30:0.00056%,7:0.00056%,31:0.00019%,27:0.00019%,22:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:82.02709%,Multi Stage Multi Point:17.97291%]
[INFO] ** dst:[21:43.33692%,10:20.8327%,8:18.26604%,9:17.56138%,22:0.00074%,15:0.00056%,24:0.00037%,16:0.00037%,2:0.00037%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99944%,0:0.00056%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.99815%,-33.760870000000004:0.00185%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99815%,0:0.00185%]
[INFO] ** modbus_transaction_id:65536 (12.14327%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99889%,2:0.00056%,1:0.00056%]
[INFO] ** proxy_src_ip:[18:38.07371%,20:26.09646%,13:18.26641%,6:17.56156%,17:0.00056%,11:0.00056%,1:0.00037%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.09572%,-0.32151:20.8327%,-1.27613:18.26586%,-0.23351:17.56119%,-0.33484:17.24101%,-71.33197:0.00056%,-1.27347:0.00037%,1.45709:0.00037%,-0.24151:0.00037%,1.47576:0.00019%,1.46509:0.00019%,3.6236699999999997:0.00019%,-1.2708:0.00019%,-2.48275:0.00019%,6.06224:0.00019%,-3.3787199999999995:0.00019%,8.10082:0.00019%,6.45955:0.00019%,-71.14931:0.00019%]
[INFO] ** scada_tag:[3:26.09535%,1:20.83251%,5:18.26567%,4:17.56101%,2:17.24082%,0:0.00463%]
[INFO] ** service:[0.0048200000000000005:99.99815%,-211.09762999999998:0.00056%,-211.73542999999998:0.00056%,-211.35747999999998:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.07371%,9:26.09646%,7:18.26641%,1:17.56156%,14:0.00056%,10:0.00056%,3:0.00037%,21:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1475 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4738 - tp: 70122.0000 - fp: 9620.0000 - tn: 310380.0000 - fn: 9878.0000 - accuracy: 0.9513 - precision: 0.8794 - recall: 0.8765 - auc: 0.9662 - val_loss: 1.2365 - val_tp: 12369.0000 - val_fp: 7631.0000 - val_tn: 72369.0000 - val_fn: 7631.0000 - val_accuracy: 0.8474 - val_precision: 0.6184 - val_recall: 0.6184 - val_auc: 0.9493
[INFO] saving weights to checkpoints/lstm-epoch-1-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4691 - tp: 68914.0000 - fp: 9953.0000 - tn: 310047.0000 - fn: 11086.0000 - accuracy: 0.9474 - precision: 0.8738 - recall: 0.8614 - auc: 0.9729 - val_loss: 0.0327 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2687 - tp: 73885.0000 - fp: 5983.0000 - tn: 314017.0000 - fn: 6115.0000 - accuracy: 0.9698 - precision: 0.9251 - recall: 0.9236 - auc: 0.9876 - val_loss: 0.0124 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5261 - tp: 71934.0000 - fp: 7957.0000 - tn: 312043.0000 - fn: 8066.0000 - accuracy: 0.9599 - precision: 0.9004 - recall: 0.8992 - auc: 0.9630 - val_loss: 0.0477 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79935.0000 - fp: 61.0000 - tn: 319939.0000 - fn: 65.0000 - accuracy: 0.9997 - precision: 0.9992 - recall: 0.9992 - auc: 1.0000 - val_loss: 0.0099 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/539690
[33m[INFO] loading file 19-19/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539690, 17)

[INFO] analyzing data
[INFO] 539690 rows
[INFO] ** appi_name:[21:99.99796%,26:0.00037%,0:0.00037%,31:0.00019%,27:0.00019%,24:0.00019%,22:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:86.74054%,Single Stage Multi Point:13.25946%]
[INFO] ** dst:[21:43.38213%,10:20.82492%,8:18.21879%,9:17.57138%,22:0.0013%,6:0.00056%,25:0.00037%,24:0.00019%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99796%,-33.760870000000004:0.00185%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99815%,0:0.00185%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.14327%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9987%,2:0.0013%]
[INFO] ** proxy_src_ip:[18:38.11318%,20:26.09405%,13:18.21879%,6:17.57138%,10:0.00111%,11:0.00093%,16:0.00056%]
[INFO] ** s_port:[1.45442:26.09294%,-0.32151:20.82492%,-1.27613:18.21842%,-0.23351:17.5712%,-0.33484:17.28826%,-5.20264:0.00074%,1.45709:0.00056%,-1.02014:0.00056%,-64.19493:0.00037%,-71.14798:0.00037%,1.46509:0.00037%,-1.27347:0.00019%,-0.24151:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-71.14931:0.00019%,-68.79874000000001:0.00019%,0.75578:0.00019%]
[INFO] ** scada_tag:[3:26.09257%,1:20.82473%,5:18.21824%,4:17.57101%,2:17.28807%,0:0.00537%]
[INFO] ** service:[0.0048200000000000005:99.9987%,-211.08346:0.00037%,-186.44547:0.00037%,-202.75898:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.11318%,9:26.09405%,7:18.21879%,1:17.57138%,11:0.00111%,10:0.00093%,15:0.00056%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1476 (0.27349%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0115 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0069 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0087 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0052 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0075 - tp: 79993.0000 - fp: 7.0000 - tn: 319993.0000 - fn: 7.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 0.0041 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6009 - tp: 69176.0000 - fp: 10824.0000 - tn: 309176.0000 - fn: 10824.0000 - accuracy: 0.9459 - precision: 0.8647 - recall: 0.8647 - auc: 0.9501 - val_loss: 1.8578 - val_tp: 7882.0000 - val_fp: 12118.0000 - val_tn: 67882.0000 - val_fn: 12118.0000 - val_accuracy: 0.7576 - val_precision: 0.3941 - val_recall: 0.3941 - val_auc: 0.8568
[INFO] saving weights to checkpoints/lstm-epoch-1-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2408 - tp: 38469.0000 - fp: 41519.0000 - tn: 278481.0000 - fn: 41531.0000 - accuracy: 0.7924 - precision: 0.4809 - recall: 0.4809 - auc: 0.8639 - val_loss: 0.6423 - val_tp: 7024.0000 - val_fp: 12740.0000 - val_tn: 67260.0000 - val_fn: 12976.0000 - val_accuracy: 0.7428 - val_precision: 0.3554 - val_recall: 0.3512 - val_auc: 0.8787
[INFO] saving weights to checkpoints/lstm-epoch-1-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/539690
[33m[INFO] loading file 20-20/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539690, 17)

[INFO] analyzing data
[INFO] 539690 rows
[INFO] ** appi_name:[21:99.99648%,30:0.00296%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:92.40694%,Single Stage Multi Point:7.59306%]
[INFO] ** dst:[21:43.42697%,10:20.83529%,8:18.16487%,9:17.56786%,15:0.00296%,22:0.00111%,24:0.00037%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99741%,0:0.00259%]
[INFO] ** i/f_name:[2:99.99704%,3:0.00296%]
[INFO] ** modbus_function_code:[0.02961:99.99648%,-33.760870000000004:0.00352%]
[INFO] ** modbus_function_description:[7:49.99944%,11:49.99704%,0:0.00352%]
[INFO] ** modbus_transaction_id:65536 (12.14327%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99648%,1:0.00296%,2:0.00056%]
[INFO] ** proxy_src_ip:[18:38.11373%,20:26.14909%,13:18.16506%,6:17.56842%,17:0.00296%,14:0.00056%,16:0.00019%]
[INFO] ** s_port:[1.45442:26.14834%,-0.32151:20.83529%,-1.27613:18.1645%,-0.23351:17.56768%,-0.33484:17.27844%,-71.33197:0.00296%,-0.24151:0.00056%,1.45709:0.00037%,-1.27347:0.00037%,13.431270000000001:0.00019%,-1.2708:0.00019%,-1.02014:0.00019%,-71.14798:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,11.862:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:26.14797%,1:20.83511%,5:18.1645%,4:17.56731%,2:17.27825%,0:0.00686%]
[INFO] ** service:[0.0048200000000000005:99.99648%,-211.73542999999998:0.00296%,-211.08346:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.11373%,9:26.14909%,7:18.16506%,1:17.56842%,14:0.00296%,2:0.00056%,15:0.00019%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1475 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1249 - tp: 76834.0000 - fp: 3163.0000 - tn: 316837.0000 - fn: 3166.0000 - accuracy: 0.9842 - precision: 0.9605 - recall: 0.9604 - auc: 0.9978 - val_loss: 0.1319 - val_tp: 19491.0000 - val_fp: 509.0000 - val_tn: 79491.0000 - val_fn: 509.0000 - val_accuracy: 0.9898 - val_precision: 0.9746 - val_recall: 0.9746 - val_auc: 0.9931
[INFO] saving weights to checkpoints/lstm-epoch-1-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5873 - tp: 64592.0000 - fp: 15408.0000 - tn: 304592.0000 - fn: 15408.0000 - accuracy: 0.9230 - precision: 0.8074 - recall: 0.8074 - auc: 0.9547 - val_loss: 0.5049 - val_tp: 16356.0000 - val_fp: 3644.0000 - val_tn: 76356.0000 - val_fn: 3644.0000 - val_accuracy: 0.9271 - val_precision: 0.8178 - val_recall: 0.8178 - val_auc: 0.9704
[INFO] saving weights to checkpoints/lstm-epoch-1-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5326 - tp: 64656.0000 - fp: 15344.0000 - tn: 304656.0000 - fn: 15344.0000 - accuracy: 0.9233 - precision: 0.8082 - recall: 0.8082 - auc: 0.9605 - val_loss: 0.4387 - val_tp: 16370.0000 - val_fp: 3630.0000 - val_tn: 76370.0000 - val_fn: 3630.0000 - val_accuracy: 0.9274 - val_precision: 0.8185 - val_recall: 0.8185 - val_auc: 0.9823
[INFO] saving weights to checkpoints/lstm-epoch-1-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2040 - tp: 75933.0000 - fp: 4067.0000 - tn: 315933.0000 - fn: 4067.0000 - accuracy: 0.9797 - precision: 0.9492 - recall: 0.9492 - auc: 0.9912 - val_loss: 0.0482 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0329 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0240 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/539690
[33m[INFO] loading file 21-21/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539688, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539688, 17)

[INFO] analyzing data
[INFO] 539688 rows
[INFO] ** appi_name:[21:99.99611%,30:0.00093%,7:0.00056%,26:0.00037%,22:0.00037%,0:0.00037%,31:0.00019%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:98.86916%,Multi Stage Single Point:1.13084%]
[INFO] ** dst:[21:43.30539%,10:20.98583%,8:18.17142%,9:17.53272%,22:0.00093%,15:0.00093%,6:0.00074%,24:0.00056%,25:0.00037%,16:0.00037%,2:0.00037%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99907%,0:0.00093%]
[INFO] ** i/f_name:[2:99.99907%,3:0.00093%]
[INFO] ** modbus_function_code:[0.02961:99.99611%,-33.760870000000004:0.00371%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.9987%,11:49.99741%,0:0.00371%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.14331%)
[INFO] ** orig:[0:99.99926%,2:0.00074%]
[INFO] ** proto:[0:99.99759%,2:0.00148%,1:0.00093%]
[INFO] ** proxy_src_ip:[18:38.31288%,20:25.97816%,13:18.1718%,6:17.53272%,10:0.00111%,17:0.00093%,11:0.00093%,16:0.00056%,1:0.00037%,21:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.9776%,-0.32151:20.98509%,-1.27613:18.17124%,-0.23351:17.53254%,-0.33484:17.32779%,-71.33197:0.00093%,-6.64392:0.00074%,-1.27347:0.00056%,-1.02014:0.00056%,-64.19493:0.00037%,-71.14931:0.00037%,-71.14798:0.00037%,1.47576:0.00019%,1.46509:0.00019%,6.62488:0.00019%,10.15141:0.00019%,-68.79874000000001:0.00019%,7.060860000000001:0.00019%,-3.3787199999999995:0.00019%,-2.2440900000000004:0.00019%,1.45709:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.97723%,1:20.9849%,5:18.17105%,4:17.53217%,2:17.32779%,0:0.00686%]
[INFO] ** service:[0.0048200000000000005:99.99685%,-211.73542999999998:0.00093%,-211.09762999999998:0.00056%,-211.08346:0.00037%,-186.44547:0.00037%,-211.08818:0.00037%,-211.35747999999998:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.31288%,9:25.97816%,7:18.1718%,1:17.53272%,11:0.00111%,21:0.00093%,10:0.00093%,15:0.00056%,3:0.00037%,14:0.00019%,4:0.00019%,2:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1470 (0.27238%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539688
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0227 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0185 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/539688
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0185 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0154 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/539688
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0154 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0128 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/539688
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0134 - tp: 79996.0000 - fp: 4.0000 - tn: 319996.0000 - fn: 4.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 0.0107 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/539688
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0112 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0091 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/539688
[33m[INFO] loading file 22-22/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (308729, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (308729, 17)

[INFO] analyzing data
[INFO] 308729 rows
[INFO] ** appi_name:[21:99.99223%,30:0.0068%,23:0.00032%,22:0.00032%,18:0.00032%]
[INFO] ** classification:[normal:57.06526%,Multi Stage Single Point:42.93474%]
[INFO] ** dst:[21:43.30108%,10:21.00386%,8:18.11394%,9:17.57205%,15:0.0068%,22:0.0013%,19:0.00065%,26:0.00032%]
[INFO] ** i/f_dir:[1:99.99352%,0:0.00648%]
[INFO] ** i/f_name:[2:99.9932%,3:0.00648%,0:0.00032%]
[INFO] ** modbus_function_code:[0.02961:99.99223%,-33.760870000000004:0.00777%]
[INFO] ** modbus_function_description:[7:49.99725%,11:49.99498%,0:0.00777%]
[INFO] ** modbus_transaction_id:65534 (21.22703%)
[INFO] ** orig:[0:99.99482%,2:0.00453%,1:0.00065%]
[INFO] ** proto:[0:99.99287%,1:0.0068%,2:0.00032%]
[INFO] ** proxy_src_ip:[18:38.32682%,20:25.97909%,13:18.1133%,6:17.57302%,17:0.0068%,14:0.00065%,10:0.00032%]
[INFO] ** s_port:[1.45442:25.97812%,-0.32151:21.00386%,-1.27613:18.1133%,-0.23351:17.57205%,-0.33484:17.32296%,-71.33197:0.0068%,1.45709:0.00065%,-0.24151:0.00065%,7.228860000000001:0.00065%,-0.24950999999999998:0.00032%,1.46509:0.00032%,-71.14931:0.00032%]
[INFO] ** scada_tag:[3:25.9778%,1:21.00386%,5:18.1133%,4:17.57172%,2:17.32296%,0:0.01037%]
[INFO] ** service:[0.0048200000000000005:99.99223%,-211.73542999999998:0.0068%,-211.07873999999998:0.00065%,-211.08818:0.00032%]
[INFO] ** src:[22:38.32682%,9:25.97909%,7:18.1133%,1:17.57302%,21:0.00453%,14:0.00227%,2:0.00065%,11:0.00032%]
[INFO] ** type:[0:99.99806%,1:0.00194%]
[INFO] ** unixtime:853 (0.27629%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/308729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.1164 - tp: 51917.0000 - fp: 25055.0000 - tn: 294945.0000 - fn: 28083.0000 - accuracy: 0.8672 - precision: 0.6745 - recall: 0.6490 - auc: 0.7772 - val_loss: 1.3737 - val_tp: 10612.0000 - val_fp: 9388.0000 - val_tn: 70612.0000 - val_fn: 9388.0000 - val_accuracy: 0.8122 - val_precision: 0.5306 - val_recall: 0.5306 - val_auc: 0.8878
[INFO] saving weights to checkpoints/lstm-epoch-1-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/308729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0523 - tp: 59767.0000 - fp: 16206.0000 - tn: 303794.0000 - fn: 20233.0000 - accuracy: 0.9089 - precision: 0.7867 - recall: 0.7471 - auc: 0.8997 - val_loss: 0.0779 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/308729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5231 - tp: 69090.0000 - fp: 10039.0000 - tn: 309961.0000 - fn: 10910.0000 - accuracy: 0.9476 - precision: 0.8731 - recall: 0.8636 - auc: 0.9636 - val_loss: 0.0204 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-21-22-batch-200000-300000
[INFO] processing batch 300000-400000/308729
[33m[INFO] loading file 23-23/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (508729, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (508729, 17)

[INFO] analyzing data
[INFO] 508729 rows
[INFO] ** appi_name:[21:99.99902%,31:0.00039%,33:0.0002%,30:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:97.42024%,Multi Stage Single Point:2.57976%]
[INFO] ** dst:[21:43.3384%,10:20.99821%,8:18.13618%,9:17.52505%,22:0.00098%,24:0.00039%,18:0.00039%,25:0.0002%,15:0.0002%]
[INFO] ** i/f_dir:[1:99.9998%,0:0.0002%]
[INFO] ** i/f_name:[2:99.9998%,3:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.99902%,-33.760870000000004:0.00098%]
[INFO] ** modbus_function_description:[7:50.00049%,11:49.99853%,0:0.00098%]
[INFO] ** modbus_transaction_id:65536 (12.8823%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99921%,2:0.00059%,1:0.0002%]
[INFO] ** proxy_src_ip:[18:38.34596%,20:25.99085%,13:18.13638%,6:17.52524%,16:0.00059%,21:0.0002%,17:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.99026%,-0.32151:20.99802%,-1.27613:18.13579%,-0.23351:17.52485%,-0.33484:17.34794%,-1.02014:0.00059%,-0.08551:0.00039%,-1.27347:0.00039%,1.47576:0.0002%,-49.275529999999996:0.0002%,1.46509:0.0002%,-0.24151:0.0002%,-0.24950999999999998:0.0002%,-64.19493:0.0002%,-1.2708:0.0002%,1.45709:0.0002%,-71.33197:0.0002%]
[INFO] ** scada_tag:[3:25.98987%,1:20.99802%,5:18.13559%,4:17.52465%,2:17.34774%,0:0.00413%]
[INFO] ** service:[0.0048200000000000005:99.99921%,-186.43601999999998:0.00039%,-186.44547:0.0002%,-211.73542999999998:0.0002%]
[INFO] ** src:[22:38.34596%,9:25.99085%,7:18.13638%,1:17.52524%,15:0.00059%,17:0.0002%,14:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1383 (0.27185%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6584 - tp: 66289.0000 - fp: 12739.0000 - tn: 307261.0000 - fn: 13711.0000 - accuracy: 0.9339 - precision: 0.8388 - recall: 0.8286 - auc: 0.9487 - val_loss: 0.0598 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0162 - tp: 79947.0000 - fp: 47.0000 - tn: 319953.0000 - fn: 53.0000 - accuracy: 0.9998 - precision: 0.9994 - recall: 0.9993 - auc: 1.0000 - val_loss: 0.0095 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0098 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0068 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0078 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0052 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0065 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0041 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/508729
[33m[INFO] loading file 24-24/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (508729, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (508729, 17)

[INFO] analyzing data
[INFO] 508729 rows
[INFO] ** appi_name:[21:99.99273%,30:0.00354%,26:0.00059%,31:0.00039%,27:0.00039%,22:0.00039%,0:0.00039%,24:0.0002%,23:0.0002%,19:0.0002%,18:0.0002%,16:0.0002%,15:0.0002%,11:0.0002%,5:0.0002%]
[INFO] ** classification:[normal:94.99144%,Multi Stage Single Point:5.00856%]
[INFO] ** dst:[21:43.36081%,10:21.0334%,8:18.09451%,9:17.50382%,15:0.00354%,22:0.00118%,6:0.00079%,25:0.00039%,19:0.00039%,18:0.00039%,7:0.00039%,26:0.0002%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.99666%,0:0.00334%]
[INFO] ** i/f_name:[2:99.99646%,3:0.00354%]
[INFO] ** modbus_function_code:[0.02961:99.99273%,-33.760870000000004:0.00668%,0.47422:0.0002%,-0.415:0.0002%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.99735%,11:49.99538%,0:0.00668%,15:0.0002%,10:0.0002%,2:0.0002%]
[INFO] ** modbus_transaction_id:65536 (12.8823%)
[INFO] ** orig:[0:99.99961%,1:0.00039%]
[INFO] ** proto:[0:99.9943%,1:0.00354%,2:0.00216%]
[INFO] ** proxy_src_ip:[18:38.41888%,20:25.97611%,13:18.09431%,6:17.50303%,17:0.00354%,10:0.00138%,14:0.00098%,11:0.00098%,21:0.00039%,16:0.00039%]
[INFO] ** s_port:[1.45442:25.97532%,-0.32151:21.0334%,-1.27613:18.09411%,-0.23351:17.50244%,-0.33484:17.38548%,-71.33197:0.00354%,-9.58113:0.00079%,-71.14798:0.00059%,7.6315100000000005:0.00039%,-64.19493:0.00039%,-1.02014:0.00039%,-71.14931:0.00039%,-0.24151:0.00039%,1.45709:0.00039%,-31.55091:0.00039%,7.4901800000000005:0.0002%,-1.27347:0.0002%,1.47576:0.0002%,1.46509:0.0002%,13.431270000000001:0.0002%,-68.79874000000001:0.0002%,-0.24950999999999998:0.0002%,11.862:0.0002%]
[INFO] ** scada_tag:[3:25.97513%,1:21.0334%,5:18.09392%,4:17.50205%,2:17.38529%,0:0.01022%]
[INFO] ** service:[0.0048200000000000005:99.99391%,-211.73542999999998:0.00354%,-211.08346:0.00059%,-186.44547:0.00039%,-186.43601999999998:0.00039%,-211.07873999999998:0.00039%,-211.08818:0.00039%,-202.75898:0.00039%]
[INFO] ** src:[22:38.41888%,9:25.97611%,7:18.09431%,1:17.50303%,14:0.00354%,11:0.00138%,10:0.00098%,2:0.00098%,15:0.00039%,4:0.00039%]
[INFO] ** type:[0:99.99862%,1:0.00098%,2:0.00039%]
[INFO] ** unixtime:1382 (0.27166%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0060 - tp: 79991.0000 - fp: 8.0000 - tn: 319992.0000 - fn: 9.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 0.0032 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0047 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0026 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0049 - tp: 79991.0000 - fp: 9.0000 - tn: 319991.0000 - fn: 9.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 0.0021 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0038 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0018 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.9173 - tp: 63160.0000 - fp: 16109.0000 - tn: 303891.0000 - fn: 16840.0000 - accuracy: 0.9176 - precision: 0.7968 - recall: 0.7895 - auc: 0.9258 - val_loss: 0.4878 - val_tp: 13111.0000 - val_fp: 6889.0000 - val_tn: 73111.0000 - val_fn: 6889.0000 - val_accuracy: 0.8622 - val_precision: 0.6556 - val_recall: 0.6556 - val_auc: 0.9685
[INFO] saving weights to checkpoints/lstm-epoch-1-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/508729
[33m[INFO] loading file 25-25/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (508729, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (508729, 17)

[INFO] analyzing data
[INFO] 508729 rows
[INFO] ** appi_name:[21:99.99627%,30:0.00098%,17:0.00079%,22:0.00059%,31:0.00039%,28:0.0002%,26:0.0002%,12:0.0002%,7:0.0002%,6:0.0002%]
[INFO] ** classification:[normal:64.33661%,Multi Stage Single Point:35.66339%]
[INFO] ** dst:[21:43.31029%,10:21.022%,8:18.1521%,9:17.51109%,22:0.00098%,15:0.00098%,16:0.00079%,6:0.00079%,18:0.00039%,17:0.00039%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.99902%,0:0.00098%]
[INFO] ** i/f_name:[2:99.99902%,3:0.00098%]
[INFO] ** modbus_function_code:[0.02961:99.99627%,-33.760870000000004:0.00373%]
[INFO] ** modbus_function_description:[7:49.99892%,11:49.99735%,0:0.00373%]
[INFO] ** modbus_transaction_id:65536 (12.8823%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99784%,2:0.00118%,1:0.00098%]
[INFO] ** proxy_src_ip:[18:38.38154%,20:25.95036%,13:18.1523%,6:17.51168%,17:0.00098%,1:0.00098%,21:0.00079%,16:0.00039%,14:0.00039%,7:0.00039%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.95016%,-0.32151:21.0216%,-1.27613:18.1519%,-0.23351:17.51109%,-0.33484:17.35993%,-71.33197:0.00098%,-71.14931:0.00059%,-1.02014:0.00039%,-0.24151:0.00039%,-49.275529999999996:0.00039%,-71.14798:0.0002%,-58.035180000000004:0.0002%,-1.2708:0.0002%,-5.1466400000000005:0.0002%,-5.08665:0.0002%,-1.27347:0.0002%,-0.24950999999999998:0.0002%,1.45709:0.0002%,6.1115699999999995:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,2.52505:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** scada_tag:[3:25.94977%,1:21.02141%,5:18.15171%,4:17.51089%,2:17.35973%,0:0.00649%]
[INFO] ** service:[0.0048200000000000005:99.99666%,-211.73542999999998:0.00098%,-205.44247:0.00079%,-211.08818:0.00059%,-186.43601999999998:0.00039%,-211.09762999999998:0.0002%,-211.08346:0.0002%,-185.9872:0.0002%]
[INFO] ** src:[22:38.38154%,9:25.95036%,7:18.1523%,1:17.51168%,14:0.00098%,3:0.00098%,4:0.00079%,21:0.00039%,15:0.00039%,2:0.00039%,8:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1382 (0.27166%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2896 - tp: 73294.0000 - fp: 6472.0000 - tn: 313528.0000 - fn: 6706.0000 - accuracy: 0.9671 - precision: 0.9189 - recall: 0.9162 - auc: 0.9860 - val_loss: 0.0084 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1709 - tp: 75289.0000 - fp: 4440.0000 - tn: 315560.0000 - fn: 4711.0000 - accuracy: 0.9771 - precision: 0.9443 - recall: 0.9411 - auc: 0.9914 - val_loss: 0.0064 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-1-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1369 - tp: 76050.0000 - fp: 3248.0000 - tn: 316752.0000 - fn: 3950.0000 - accuracy: 0.9820 - precision: 0.9590 - recall: 0.9506 - auc: 0.9920 - val_loss: 0.0047 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1068 - tp: 77658.0000 - fp: 1706.0000 - tn: 318294.0000 - fn: 2342.0000 - accuracy: 0.9899 - precision: 0.9785 - recall: 0.9707 - auc: 0.9932 - val_loss: 0.0035 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0932 - tp: 78875.0000 - fp: 1053.0000 - tn: 318947.0000 - fn: 1125.0000 - accuracy: 0.9946 - precision: 0.9868 - recall: 0.9859 - auc: 0.9932 - val_loss: 0.0035 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/508729
[33m[INFO] loading file 26-26/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (508729, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (508729, 17)

[INFO] analyzing data
[INFO] 508729 rows
[INFO] ** appi_name:[21:99.99882%,7:0.00059%,30:0.0002%,22:0.0002%,8:0.0002%]
[INFO] ** classification:[normal:64.39696%,Single Stage Single Point:31.39432%,Multi Stage Single Point:4.20872%]
[INFO] ** dst:[21:43.31068%,10:21.08431%,8:18.12026%,9:17.48239%,22:0.00079%,24:0.00039%,16:0.00039%,2:0.00039%,15:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.9998%,0:0.0002%]
[INFO] ** i/f_name:[2:99.9998%,3:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.99882%,-33.760870000000004:0.00118%]
[INFO] ** modbus_function_description:[7:50.0001%,11:49.99872%,0:0.00118%]
[INFO] ** modbus_transaction_id:65536 (12.8823%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99961%,2:0.0002%,1:0.0002%]
[INFO] ** proxy_src_ip:[18:38.4692%,20:25.92618%,13:18.12065%,6:17.48239%,16:0.00039%,1:0.00039%,21:0.0002%,17:0.0002%,14:0.0002%,7:0.0002%]
[INFO] ** s_port:[1.45442:25.92559%,-0.32151:21.08431%,-1.27613:18.12006%,-0.23351:17.4822%,-0.33484:17.38489%,-1.27347:0.00039%,-1.02014:0.00039%,7.66617:0.0002%,-1.2708:0.0002%,-71.14931:0.0002%,-0.24151:0.0002%,11.57001:0.0002%,1.47576:0.0002%,1.46509:0.0002%,14.191239999999999:0.0002%,-3.3787199999999995:0.0002%,1.45709:0.0002%,-71.33197:0.0002%]
[INFO] ** scada_tag:[3:25.9252%,1:21.08431%,5:18.12006%,4:17.482%,2:17.38489%,0:0.00354%]
[INFO] ** service:[0.0048200000000000005:99.99882%,-211.09762999999998:0.00059%,-211.73542999999998:0.0002%,-211.35747999999998:0.0002%,-211.08818:0.0002%]
[INFO] ** src:[22:38.4692%,9:25.92618%,7:18.12065%,1:17.48239%,15:0.00039%,3:0.00039%,21:0.0002%,14:0.0002%,4:0.0002%,2:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1381 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7078 - tp: 68726.0000 - fp: 10447.0000 - tn: 309553.0000 - fn: 11274.0000 - accuracy: 0.9457 - precision: 0.8680 - recall: 0.8591 - auc: 0.9561 - val_loss: 0.9999 - val_tp: 12898.0000 - val_fp: 7102.0000 - val_tn: 72898.0000 - val_fn: 7102.0000 - val_accuracy: 0.8580 - val_precision: 0.6449 - val_recall: 0.6449 - val_auc: 0.9582
[INFO] saving weights to checkpoints/lstm-epoch-1-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5552 - tp: 57696.0000 - fp: 16735.0000 - tn: 303265.0000 - fn: 22304.0000 - accuracy: 0.9024 - precision: 0.7752 - recall: 0.7212 - auc: 0.9669 - val_loss: 0.1328 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2210 - tp: 74515.0000 - fp: 3954.0000 - tn: 316046.0000 - fn: 5485.0000 - accuracy: 0.9764 - precision: 0.9496 - recall: 0.9314 - auc: 0.9928 - val_loss: 0.0476 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1291 - tp: 77328.0000 - fp: 2260.0000 - tn: 317740.0000 - fn: 2672.0000 - accuracy: 0.9877 - precision: 0.9716 - recall: 0.9666 - auc: 0.9970 - val_loss: 0.0241 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0931 - tp: 78207.0000 - fp: 1792.0000 - tn: 318208.0000 - fn: 1793.0000 - accuracy: 0.9910 - precision: 0.9776 - recall: 0.9776 - auc: 0.9988 - val_loss: 0.0136 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/508729
[33m[INFO] loading file 27-27/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (448859, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (448859, 17)

[INFO] analyzing data
[INFO] 448859 rows
[INFO] ** appi_name:[21:99.99933%,30:0.00067%]
[INFO] ** classification:[normal:64.33735%,Single Stage Single Point:35.66265%]
[INFO] ** dst:[21:43.2715%,10:21.06385%,8:18.1948%,9:17.46807%,22:0.00089%,15:0.00067%,24:0.00022%]
[INFO] ** i/f_dir:[1:99.99978%,0:0.00022%]
[INFO] ** i/f_name:[2:99.99933%,3:0.00067%]
[INFO] ** modbus_function_code:[0.02961:99.99933%,-33.760870000000004:0.00067%]
[INFO] ** modbus_function_description:[7:50.00033%,11:49.999%,0:0.00067%]
[INFO] ** modbus_transaction_id:65536 (14.60058%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99933%,1:0.00067%]
[INFO] ** proxy_src_ip:[18:38.40493%,20:25.93108%,13:18.19458%,6:17.46829%,17:0.00067%,16:0.00045%]
[INFO] ** s_port:[1.45442:25.93041%,-0.32151:21.06385%,-1.27613:18.19436%,-0.23351:17.46785%,-0.33484:17.34108%,-71.33197:0.00067%,-1.02014:0.00045%,-1.27347:0.00022%,1.45709:0.00022%,-0.24950999999999998:0.00022%,1.46509:0.00022%,1.47576:0.00022%,-0.24151:0.00022%]
[INFO] ** scada_tag:[3:25.92997%,1:21.06363%,5:18.19413%,4:17.46762%,2:17.34086%,0:0.00379%]
[INFO] ** service:[0.0048200000000000005:99.99933%,-211.73542999999998:0.00067%]
[INFO] ** src:[22:38.40493%,9:25.93108%,7:18.19458%,1:17.46829%,14:0.00067%,15:0.00045%]
[INFO] ** type:[0:99.99955%,1:0.00045%]
[INFO] ** unixtime:1220 (0.2718%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/448859
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0788 - tp: 78177.0000 - fp: 1823.0000 - tn: 318177.0000 - fn: 1823.0000 - accuracy: 0.9909 - precision: 0.9772 - recall: 0.9772 - auc: 0.9994 - val_loss: 0.0093 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/448859
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0651 - tp: 78314.0000 - fp: 1686.0000 - tn: 318314.0000 - fn: 1686.0000 - accuracy: 0.9916 - precision: 0.9789 - recall: 0.9789 - auc: 0.9996 - val_loss: 0.0074 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/448859
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0561 - tp: 78345.0000 - fp: 1435.0000 - tn: 318565.0000 - fn: 1655.0000 - accuracy: 0.9923 - precision: 0.9820 - recall: 0.9793 - auc: 0.9996 - val_loss: 0.0056 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/448859
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0497 - tp: 78988.0000 - fp: 985.0000 - tn: 319015.0000 - fn: 1012.0000 - accuracy: 0.9950 - precision: 0.9877 - recall: 0.9873 - auc: 0.9996 - val_loss: 0.0037 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/448859
[33m[INFO] loading file 28-28/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (382775, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (382775, 17)

[INFO] analyzing data
[INFO] 382775 rows
[INFO] ** appi_name:[21:99.99216%,30:0.00183%,17:0.00131%,22:0.00105%,7:0.00105%,31:0.00078%,26:0.00078%,28:0.00026%,27:0.00026%,8:0.00026%,0:0.00026%]
[INFO] ** classification:[normal:64.3088%,Single Stage Single Point:35.6912%]
[INFO] ** dst:[21:43.28235%,10:21.01835%,8:18.2073%,9:17.48364%,6:0.00209%,16:0.00183%,18:0.00131%,15:0.00078%,22:0.00052%,17:0.00052%,2:0.00052%,25:0.00026%,7:0.00026%,0:0.00026%]
[INFO] ** i/f_dir:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name:[2:99.99922%,3:0.00078%]
[INFO] ** modbus_function_code:[0.02961:99.99216%,-33.760870000000004:0.00784%]
[INFO] ** modbus_function_description:[11:49.99621%,7:49.99595%,0:0.00784%]
[INFO] ** modbus_transaction_id:65536 (17.12129%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9953%,2:0.00392%,1:0.00078%]
[INFO] ** proxy_src_ip:[18:38.3361%,20:25.9646%,13:18.20756%,6:17.4839%,1:0.00209%,17:0.00183%,14:0.00157%,7:0.00131%,21:0.00078%,0:0.00026%]
[INFO] ** s_port:[1.45442:25.96434%,-0.32151:21.01835%,-1.27613:18.2073%,-0.23351:17.48338%,-0.33484:17.31775%,-71.14798:0.00105%,-71.14931:0.00105%,-71.33197:0.00078%,-0.08551:0.00052%,-0.24151:0.00052%,7.66617:0.00026%,-58.035180000000004:0.00026%,-1.2708:0.00026%,-64.19493:0.00026%,-5.1466400000000005:0.00026%,13.431270000000001:0.00026%,11.57001:0.00026%,14.4699:0.00026%,1.47576:0.00026%,14.191239999999999:0.00026%,-5.08665:0.00026%,10.192739999999999:0.00026%,-3.3787199999999995:0.00026%,6.1115699999999995:0.00026%,2.05573:0.00026%,-43.76509:0.00026%,2.52505:0.00026%,11.862:0.00026%,-58.032509999999995:0.00026%]
[INFO] ** scada_tag:[3:25.96408%,1:21.01835%,5:18.2073%,4:17.48312%,2:17.31775%,0:0.00941%]
[INFO] ** service:[0.0048200000000000005:99.99216%,-205.44247:0.00131%,-186.43601999999998:0.00131%,-211.09762999999998:0.00105%,-211.08346:0.00105%,-211.08818:0.00105%,-211.73542999999998:0.00078%,-186.44547:0.00026%,-183.8612:0.00026%,-185.9872:0.00026%,-211.35747999999998:0.00026%,-202.75898:0.00026%]
[INFO] ** src:[22:38.3361%,9:25.9646%,7:18.20756%,1:17.4839%,3:0.00235%,2:0.00157%,21:0.00131%,4:0.00105%,14:0.00078%,8:0.00052%,17:0.00026%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1040 (0.2717%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/382775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0451 - tp: 79075.0000 - fp: 912.0000 - tn: 319088.0000 - fn: 925.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9884 - auc: 0.9996 - val_loss: 0.0030 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/382775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0420 - tp: 79082.0000 - fp: 918.0000 - tn: 319082.0000 - fn: 918.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9996 - val_loss: 0.0048 - val_tp: 19994.0000 - val_fp: 6.0000 - val_tn: 79994.0000 - val_fn: 6.0000 - val_accuracy: 0.9999 - val_precision: 0.9997 - val_recall: 0.9997 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-1-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/382775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0410 - tp: 79075.0000 - fp: 925.0000 - tn: 319075.0000 - fn: 925.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9996 - val_loss: 0.0014 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/382775
[33m[INFO] loading file 29-29/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582775, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582775, 17)

[INFO] analyzing data
[INFO] 582775 rows
[INFO] ** appi_name:[21:99.9988%,30:0.00051%,31:0.00017%,26:0.00017%,9:0.00017%,3:0.00017%]
[INFO] ** classification:[normal:64.38746%,Single Stage Single Point:35.61254%]
[INFO] ** dst:[21:43.32427%,10:21.06182%,8:18.14422%,9:17.46798%,22:0.00051%,15:0.00051%,24:0.00017%,18:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99966%,0:0.00034%]
[INFO] ** i/f_name:[2:99.99949%,3:0.00051%]
[INFO] ** modbus_function_code:[0.02961:99.9988%,-33.760870000000004:0.0012%]
[INFO] ** modbus_function_description:[7:49.99974%,11:49.99906%,0:0.0012%]
[INFO] ** modbus_transaction_id:65536 (11.24551%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99914%,1:0.00051%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.43542%,20:25.95084%,13:18.14457%,6:17.4678%,17:0.00051%,21:0.00017%,16:0.00017%,7:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95032%,-0.32151:21.06164%,-1.27613:18.14422%,-0.23351:17.4678%,-0.33484:17.37377%,-71.33197:0.00051%,1.45709:0.00034%,-71.14798:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,6.1115699999999995:0.00017%,14.4699:0.00017%]
[INFO] ** scada_tag:[3:25.94998%,1:21.06147%,5:18.14422%,4:17.46746%,2:17.37377%,0:0.00309%]
[INFO] ** service:[0.0048200000000000005:99.99897%,-211.73542999999998:0.00051%,-183.8612:0.00017%,-211.08346:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.43542%,9:25.95084%,7:18.14457%,1:17.4678%,14:0.00051%,21:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1583 (0.27163%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0383 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9997 - val_loss: 0.0011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0383 - tp: 79075.0000 - fp: 925.0000 - tn: 319075.0000 - fn: 925.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9997 - val_loss: 8.4679e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0361 - tp: 79098.0000 - fp: 902.0000 - tn: 319098.0000 - fn: 902.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9997 - val_loss: 6.6477e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0337 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9998 - val_loss: 5.3194e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0330 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9998 - val_loss: 0.0012 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/582775
[33m[INFO] loading file 30-30/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582775, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582775, 17)

[INFO] analyzing data
[INFO] 582775 rows
[INFO] ** appi_name:[21:99.9976%,30:0.00172%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.37459%,Single Stage Single Point:35.62541%]
[INFO] ** dst:[21:43.34143%,10:21.03024%,8:18.14525%,9:17.47982%,15:0.00172%,22:0.00069%,24:0.00034%,25:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99846%,0:0.00154%]
[INFO] ** i/f_name:[2:99.99828%,3:0.00172%]
[INFO] ** modbus_function_code:[0.02961:99.9976%,-33.760870000000004:0.0024%]
[INFO] ** modbus_function_description:[7:49.99957%,11:49.99803%,0:0.0024%]
[INFO] ** modbus_transaction_id:65536 (11.24551%)
[INFO] ** orig:[0:99.99914%,2:0.00051%,1:0.00034%]
[INFO] ** proto:[0:99.99794%,1:0.00172%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.37673%,20:25.99477%,13:18.1456%,6:17.48033%,17:0.00172%,7:0.00034%,16:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.99459%,-0.32151:21.03007%,-1.27613:18.14508%,-0.23351:17.47964%,-0.33484:17.34666%,-71.33197:0.00172%,-0.24151:0.00051%,-1.27347:0.00034%,-71.14798:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:25.99425%,1:21.03007%,5:18.14491%,4:17.47947%,2:17.34649%,0:0.0048%]
[INFO] ** service:[0.0048200000000000005:99.99777%,-211.73542999999998:0.00172%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.37673%,9:25.99477%,7:18.1456%,1:17.48033%,14:0.0012%,21:0.00086%,16:0.00017%,15:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99914%,1:0.00086%]
[INFO] ** unixtime:1584 (0.2718%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0325 - tp: 79113.0000 - fp: 887.0000 - tn: 319113.0000 - fn: 887.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9998 - val_loss: 0.0019 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-1-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0312 - tp: 79172.0000 - fp: 828.0000 - tn: 319172.0000 - fn: 828.0000 - accuracy: 0.9959 - precision: 0.9897 - recall: 0.9897 - auc: 0.9998 - val_loss: 2.9669e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0310 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9998 - val_loss: 2.4761e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0296 - tp: 79134.0000 - fp: 866.0000 - tn: 319134.0000 - fn: 866.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9998 - val_loss: 1.9434e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0288 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9998 - val_loss: 8.8253e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/582775
[33m[INFO] loading file 31-31/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582775, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582775, 17)

[INFO] analyzing data
[INFO] 582775 rows
[INFO] ** appi_name:[21:99.99966%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.3775%,Single Stage Single Point:35.6225%]
[INFO] ** dst:[21:43.32513%,10:21.05083%,8:18.12072%,9:17.50161%,22:0.00103%,24:0.00034%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99966%,-33.760870000000004:0.00034%]
[INFO] ** modbus_function_description:[7:50.00026%,11:49.9994%,0:0.00034%]
[INFO] ** modbus_transaction_id:65536 (11.24551%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.39835%,20:25.97829%,13:18.12089%,6:17.50161%,16:0.00051%,7:0.00034%]
[INFO] ** s_port:[1.45442:25.97761%,-0.32151:21.05083%,-1.27613:18.12054%,-0.23351:17.50144%,-0.33484:17.34752%,-1.02014:0.00051%,-1.27347:0.00034%,1.45709:0.00034%,-71.14798:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-0.24151:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.97726%,1:21.05066%,5:18.12037%,4:17.50109%,2:17.34735%,0:0.00326%]
[INFO] ** service:[0.0048200000000000005:99.99966%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.39835%,9:25.97829%,7:18.12089%,1:17.50161%,15:0.00051%,21:0.00034%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1583 (0.27163%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0283 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9998 - val_loss: 1.3100e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0267 - tp: 79176.0000 - fp: 824.0000 - tn: 319176.0000 - fn: 824.0000 - accuracy: 0.9959 - precision: 0.9897 - recall: 0.9897 - auc: 0.9998 - val_loss: 1.1182e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0285 - tp: 79089.0000 - fp: 911.0000 - tn: 319089.0000 - fn: 911.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9998 - val_loss: 9.3722e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0272 - tp: 79141.0000 - fp: 859.0000 - tn: 319141.0000 - fn: 859.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9998 - val_loss: 7.9808e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0285 - tp: 79076.0000 - fp: 924.0000 - tn: 319076.0000 - fn: 924.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9998 - val_loss: 6.6808e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/582775
[33m[INFO] loading file 32-32/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582775, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582775, 17)

[INFO] analyzing data
[INFO] 582775 rows
[INFO] ** appi_name:[21:99.99657%,30:0.00292%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.38214%,Single Stage Single Point:35.61786%]
[INFO] ** dst:[21:43.32187%,10:21.05581%,8:18.15349%,9:17.46437%,15:0.00292%,22:0.00086%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99743%,0:0.00257%]
[INFO] ** i/f_name:[2:99.99708%,3:0.00292%]
[INFO] ** modbus_function_code:[0.02961:99.99657%,-33.760870000000004:0.00343%]
[INFO] ** modbus_function_description:[7:49.99923%,11:49.99734%,0:0.00343%]
[INFO] ** modbus_transaction_id:65536 (11.24551%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99657%,1:0.00292%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.42306%,20:25.95496%,13:18.15349%,6:17.46489%,17:0.00292%,14:0.00051%,16:0.00017%]
[INFO] ** s_port:[1.45442:25.95444%,-0.32151:21.05581%,-1.27613:18.15315%,-0.23351:17.4642%,-0.33484:17.36725%,-71.33197:0.00292%,-0.24151:0.00051%,-1.2708:0.00017%,-1.02014:0.00017%,13.431270000000001:0.00017%,-71.14798:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.9541%,1:21.05564%,5:18.15315%,4:17.46386%,2:17.36725%,0:0.00601%]
[INFO] ** service:[0.0048200000000000005:99.99657%,-211.73542999999998:0.00292%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.42306%,9:25.95496%,7:18.15349%,1:17.46489%,14:0.00292%,2:0.00051%,15:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1581 (0.27129%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0280 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9998 - val_loss: 5.6937e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0272 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9998 - val_loss: 8.4761e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0284 - tp: 79057.0000 - fp: 943.0000 - tn: 319057.0000 - fn: 943.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9998 - val_loss: 4.0278e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0278 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9998 - val_loss: 0.0097 - val_tp: 19988.0000 - val_fp: 12.0000 - val_tn: 79988.0000 - val_fn: 12.0000 - val_accuracy: 0.9998 - val_precision: 0.9994 - val_recall: 0.9994 - val_auc: 0.9996
[INFO] saving weights to checkpoints/lstm-epoch-1-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0275 - tp: 79141.0000 - fp: 859.0000 - tn: 319141.0000 - fn: 859.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9998 - val_loss: 8.5422e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/582775
[33m[INFO] loading file 33-33/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582775, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582775, 17)

[INFO] analyzing data
[INFO] 582775 rows
[INFO] ** appi_name:[21:99.99708%,30:0.00103%,17:0.00069%,22:0.00051%,31:0.00017%,28:0.00017%,26:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:64.39552%,Single Stage Single Point:35.60448%]
[INFO] ** dst:[21:43.32736%,10:21.06353%,8:18.1226%,9:17.48188%,22:0.00137%,15:0.00103%,16:0.00069%,6:0.00069%,24:0.00034%,17:0.00034%,18:0.00017%]
[INFO] ** i/f_dir:[1:99.99897%,0:0.00103%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.99708%,-33.760870000000004:0.00292%]
[INFO] ** modbus_function_description:[7:49.99974%,11:49.99734%,0:0.00292%]
[INFO] ** modbus_transaction_id:65536 (11.24551%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99811%,1:0.00103%,2:0.00086%]
[INFO] ** proxy_src_ip:[18:38.42375%,20:25.968%,13:18.1226%,6:17.48205%,17:0.00103%,16:0.00069%,1:0.00069%,21:0.00034%,14:0.00034%,7:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.96714%,-0.32151:21.06353%,-1.27613:18.12226%,-0.23351:17.4817%,-0.33484:17.36022%,-71.33197:0.00103%,-1.02014:0.00069%,1.45709:0.00051%,-71.14931:0.00051%,-1.27347:0.00034%,-5.08665:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,-71.14798:0.00017%,-58.032509999999995:0.00017%,-58.035180000000004:0.00017%,-0.24151:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.9668%,1:21.06353%,5:18.12209%,4:17.48153%,2:17.36022%,0:0.00583%]
[INFO] ** service:[0.0048200000000000005:99.99708%,-211.73542999999998:0.00103%,-205.44247:0.00069%,-211.08818:0.00051%,-211.09762999999998:0.00017%,-211.08346:0.00017%,-185.9872:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.42375%,9:25.968%,7:18.1226%,1:17.48205%,14:0.00103%,15:0.00069%,3:0.00069%,21:0.00034%,4:0.00034%,2:0.00034%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1585 (0.27197%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0275 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9998 - val_loss: 2.9309e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0278 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9998 - val_loss: 2.1846e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0277 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9998 - val_loss: 1.8116e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0278 - tp: 79089.0000 - fp: 911.0000 - tn: 319089.0000 - fn: 911.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9998 - val_loss: 0.0015 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-1-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0282 - tp: 79094.0000 - fp: 906.0000 - tn: 319094.0000 - fn: 906.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9998 - val_loss: 1.2648e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/582775
[33m[INFO] loading file 34-34/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (424208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (424208, 17)

[INFO] analyzing data
[INFO] 424208 rows
[INFO] ** appi_name:[21:99.99764%,30:0.00071%,7:0.00071%,31:0.00024%,22:0.00024%,8:0.00024%,6:0.00024%]
[INFO] ** classification:[normal:64.34509%,Single Stage Single Point:35.65491%]
[INFO] ** dst:[21:43.28513%,10:21.05689%,8:18.18825%,9:17.4669%,22:0.00071%,15:0.00071%,16:0.00047%,2:0.00047%,18:0.00024%,6:0.00024%]
[INFO] ** i/f_dir:[1:99.99929%,0:0.00071%]
[INFO] ** i/f_name:[2:99.99929%,3:0.00071%]
[INFO] ** modbus_function_code:[0.02961:99.99764%,-33.760870000000004:0.00236%]
[INFO] ** modbus_function_description:[7:49.99929%,11:49.99835%,0:0.00236%]
[INFO] ** modbus_transaction_id:65536 (15.44903%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99882%,1:0.00071%,2:0.00047%]
[INFO] ** proxy_src_ip:[18:38.39343%,20:25.94883%,13:18.18801%,6:17.46737%,17:0.00071%,1:0.00071%,21:0.00047%,14:0.00024%,7:0.00024%]
[INFO] ** s_port:[1.45442:25.94836%,-0.32151:21.05665%,-1.27613:18.18801%,-0.23351:17.46667%,-0.33484:17.33678%,-0.24151:0.00071%,-71.33197:0.00071%,-3.0613900000000003:0.00024%,-3.3787199999999995:0.00024%,14.191239999999999:0.00024%,1.46509:0.00024%,1.47576:0.00024%,11.57001:0.00024%,-49.275529999999996:0.00024%,-71.14931:0.00024%,7.66617:0.00024%]
[INFO] ** scada_tag:[3:25.94812%,1:21.05642%,5:18.18778%,4:17.4662%,2:17.33678%,0:0.00471%]
[INFO] ** service:[0.0048200000000000005:99.99788%,-211.09762999999998:0.00071%,-211.73542999999998:0.00071%,-186.43601999999998:0.00024%,-211.35747999999998:0.00024%,-211.08818:0.00024%]
[INFO] ** src:[22:38.39343%,9:25.94883%,7:18.18801%,1:17.46737%,14:0.00071%,3:0.00071%,4:0.00047%,21:0.00024%,2:0.00024%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1152 (0.27156%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/424208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0269 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.0701e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/424208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0273 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9998 - val_loss: 8.9078e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/424208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0281 - tp: 79080.0000 - fp: 920.0000 - tn: 319080.0000 - fn: 920.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9998 - val_loss: 8.3893e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/424208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0266 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 6.7758e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-33-34-batch-300000-400000
[INFO] processing batch 400000-500000/424208
[33m[INFO] loading file 35-35/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524208, 17)

[INFO] analyzing data
[INFO] 524208 rows
[INFO] ** appi_name:[21:99.99886%,30:0.00114%]
[INFO] ** classification:[normal:64.37769%,Single Stage Single Point:35.62231%]
[INFO] ** dst:[21:43.33566%,10:21.03936%,8:18.14413%,9:17.47856%,22:0.00114%,15:0.00114%]
[INFO] ** i/f_dir:[1:99.99905%,0:0.00095%]
[INFO] ** i/f_name:[2:99.99886%,3:0.00114%]
[INFO] ** modbus_function_code:[0.02961:99.99886%,-33.760870000000004:0.00114%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99886%,0:0.00114%]
[INFO] ** modbus_transaction_id:65536 (12.50191%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99886%,1:0.00114%]
[INFO] ** proxy_src_ip:[18:38.40346%,20:25.97213%,13:18.14375%,6:17.47875%,17:0.00114%,16:0.00076%]
[INFO] ** s_port:[1.45442:25.97156%,-0.32151:21.03936%,-1.27613:18.14375%,-0.23351:17.47837%,-0.33484:17.3641%,-71.33197:0.00114%,-1.02014:0.00076%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.97118%,1:21.03936%,5:18.14356%,4:17.47799%,2:17.3641%,0:0.00382%]
[INFO] ** service:[0.0048200000000000005:99.99886%,-211.73542999999998:0.00114%]
[INFO] ** src:[22:38.40346%,9:25.97213%,7:18.14375%,1:17.47875%,14:0.00114%,15:0.00076%]
[INFO] ** type:[0:99.99905%,1:0.00095%]
[INFO] ** unixtime:1423 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0271 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 5.3716e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0259 - tp: 79164.0000 - fp: 836.0000 - tn: 319164.0000 - fn: 836.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 8.1351e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0273 - tp: 79109.0000 - fp: 891.0000 - tn: 319109.0000 - fn: 891.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9998 - val_loss: 3.5074e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0277 - tp: 79083.0000 - fp: 917.0000 - tn: 319083.0000 - fn: 917.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9998 - val_loss: 2.7793e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0270 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 2.2341e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/524208
[33m[INFO] loading file 36-36/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524208, 17)

[INFO] analyzing data
[INFO] 524208 rows
[INFO] ** appi_name:[21:99.99866%,30:0.00057%,31:0.00038%,33:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.35156%,Single Stage Single Point:35.64844%]
[INFO] ** dst:[21:43.33032%,10:21.01914%,8:18.1613%,9:17.48695%,22:0.00076%,15:0.00057%,24:0.00038%,18:0.00038%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99943%,0:0.00057%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99866%,-33.760870000000004:0.00134%]
[INFO] ** modbus_function_description:[7:50.00038%,11:49.99828%,0:0.00134%]
[INFO] ** modbus_transaction_id:65536 (12.50191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99886%,2:0.00057%,1:0.00057%]
[INFO] ** proxy_src_ip:[18:38.36836%,20:25.98129%,13:18.16149%,6:17.48752%,17:0.00057%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.98072%,-0.32151:21.01895%,-1.27613:18.16092%,-0.23351:17.48676%,-0.33484:17.34941%,-0.24151:0.00057%,-71.33197:0.00057%,-1.27347:0.00038%,-0.08551:0.00038%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-49.275529999999996:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.98034%,1:21.01876%,5:18.16073%,4:17.48657%,2:17.34922%,0:0.00439%]
[INFO] ** service:[0.0048200000000000005:99.99886%,-211.73542999999998:0.00057%,-186.43601999999998:0.00038%,-186.44547:0.00019%]
[INFO] ** src:[22:38.36836%,9:25.98129%,7:18.16149%,1:17.48752%,14:0.00057%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1424 (0.27165%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0268 - tp: 79130.0000 - fp: 870.0000 - tn: 319130.0000 - fn: 870.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.8025e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0259 - tp: 79175.0000 - fp: 825.0000 - tn: 319175.0000 - fn: 825.0000 - accuracy: 0.9959 - precision: 0.9897 - recall: 0.9897 - auc: 0.9999 - val_loss: 8.0743e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0276 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9998 - val_loss: 1.2189e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0273 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9998 - val_loss: 1.0215e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0271 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9998 - val_loss: 8.2918e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/524208
[33m[INFO] loading file 37-37/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524208, 17)

[INFO] analyzing data
[INFO] 524208 rows
[INFO] ** appi_name:[21:99.99886%,30:0.00076%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.38627%,Single Stage Single Point:35.61373%]
[INFO] ** dst:[21:43.33814%,10:21.04623%,8:18.13383%,9:17.4797%,22:0.00076%,15:0.00076%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99924%,3:0.00076%]
[INFO] ** modbus_function_code:[0.02961:99.99886%,-33.760870000000004:0.00114%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99866%,0:0.00114%]
[INFO] ** modbus_transaction_id:65536 (12.50191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99905%,1:0.00076%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.39545%,20:25.9893%,13:18.13402%,6:17.4797%,17:0.00076%,16:0.00038%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.98873%,-0.32151:21.04623%,-1.27613:18.13364%,-0.23351:17.47951%,-0.33484:17.34922%,-71.33197:0.00076%,-1.02014:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.98854%,1:21.04623%,5:18.13345%,4:17.47932%,2:17.34903%,0:0.00343%]
[INFO] ** service:[0.0048200000000000005:99.99886%,-211.73542999999998:0.00076%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.39545%,9:25.9893%,7:18.13402%,1:17.4797%,14:0.00076%,15:0.00038%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1424 (0.27165%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0277 - tp: 79068.0000 - fp: 932.0000 - tn: 319068.0000 - fn: 932.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9998 - val_loss: 6.6604e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0272 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 5.4617e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0261 - tp: 79165.0000 - fp: 835.0000 - tn: 319165.0000 - fn: 835.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9999 - val_loss: 4.6945e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0267 - tp: 79128.0000 - fp: 872.0000 - tn: 319128.0000 - fn: 872.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 8.0802e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0262 - tp: 79142.0000 - fp: 858.0000 - tn: 319142.0000 - fn: 858.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 3.3112e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/524208
[33m[INFO] loading file 38-38/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524208, 17)

[INFO] analyzing data
[INFO] 524208 rows
[INFO] ** appi_name:[21:99.99905%,30:0.00019%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.41126%,Single Stage Single Point:35.58874%]
[INFO] ** dst:[21:43.32212%,10:21.08705%,8:18.09625%,9:17.49267%,22:0.00095%,25:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99905%,-33.760870000000004:0.00095%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99943%,0:0.00095%]
[INFO] ** modbus_transaction_id:65536 (12.50191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99943%,2:0.00038%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.45439%,20:25.95535%,13:18.09606%,6:17.49306%,7:0.00038%,17:0.00019%,16:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95458%,-0.32151:21.08686%,-1.27613:18.09587%,-0.23351:17.49248%,-0.33484:17.36753%,1.45709:0.00038%,-0.24151:0.00038%,-71.14798:0.00019%,-64.19493:0.00019%,-1.02014:0.00019%,-61.95768:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,10.192739999999999:0.00019%,-0.24950999999999998:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.9542%,1:21.08686%,5:18.09587%,4:17.49229%,2:17.36753%,0:0.00324%]
[INFO] ** service:[0.0048200000000000005:99.99924%,-186.44547:0.00019%,-211.08346:0.00019%,-211.73542999999998:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.45439%,9:25.95535%,7:18.09606%,1:17.49306%,21:0.00038%,16:0.00019%,15:0.00019%,14:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1425 (0.27184%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0277 - tp: 79098.0000 - fp: 902.0000 - tn: 319098.0000 - fn: 902.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9998 - val_loss: 2.7556e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0268 - tp: 79119.0000 - fp: 881.0000 - tn: 319119.0000 - fn: 881.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 2.3189e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0271 - tp: 79106.0000 - fp: 894.0000 - tn: 319106.0000 - fn: 894.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9998 - val_loss: 2.0441e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0273 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.6804e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0276 - tp: 79072.0000 - fp: 928.0000 - tn: 319072.0000 - fn: 928.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9998 - val_loss: 1.5779e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/524208
[33m[INFO] loading file 39-39/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524208, 17)

[INFO] analyzing data
[INFO] 524208 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.41145%,Single Stage Single Point:35.58855%]
[INFO] ** dst:[21:43.32269%,10:21.088%,8:18.13002%,9:17.45815%,22:0.00095%,24:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.00057%,11:49.99943%]
[INFO] ** modbus_transaction_id:65536 (12.50191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.46164%,20:25.94924%,13:18.1304%,6:17.45815%,16:0.00057%]
[INFO] ** s_port:[1.45442:25.94886%,-0.32151:21.088%,-1.27613:18.13002%,-0.23351:17.45796%,-0.33484:17.37364%,-1.02014:0.00057%,-1.27347:0.00019%,1.45709:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.94848%,1:21.08781%,5:18.12983%,4:17.45796%,2:17.37345%,0:0.00248%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.46164%,9:25.94924%,7:18.1304%,1:17.45815%,15:0.00057%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1423 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0283 - tp: 79054.0000 - fp: 946.0000 - tn: 319054.0000 - fn: 946.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9998 - val_loss: 1.3079e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0263 - tp: 79156.0000 - fp: 844.0000 - tn: 319156.0000 - fn: 844.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.2448e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0267 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.2345e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0268 - tp: 79129.0000 - fp: 871.0000 - tn: 319129.0000 - fn: 871.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.2025e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0261 - tp: 79131.0000 - fp: 869.0000 - tn: 319131.0000 - fn: 869.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/524208
[33m[INFO] loading file 40-40/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524208, 17)

[INFO] analyzing data
[INFO] 524208 rows
[INFO] ** appi_name:[21:99.99618%,30:0.00324%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.33782%,Single Stage Single Point:35.66218%]
[INFO] ** dst:[21:43.29541%,10:21.03726%,8:18.19087%,9:17.4715%,15:0.00324%,22:0.00095%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99695%,0:0.00305%]
[INFO] ** i/f_name:[2:99.99676%,3:0.00324%]
[INFO] ** modbus_function_code:[0.02961:99.99618%,-33.760870000000004:0.00382%]
[INFO] ** modbus_function_description:[7:49.99924%,11:49.99695%,0:0.00382%]
[INFO] ** modbus_transaction_id:65536 (12.50191%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99618%,1:0.00324%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.35271%,20:25.98091%,13:18.19068%,6:17.47188%,17:0.00324%,14:0.00057%]
[INFO] ** s_port:[1.45442:25.97995%,-0.32151:21.03726%,-1.27613:18.19049%,-0.23351:17.47131%,-0.33484:17.31545%,-71.33197:0.00324%,1.45709:0.00057%,-0.24151:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,13.431270000000001:0.00019%]
[INFO] ** scada_tag:[3:25.97957%,1:21.03707%,5:18.1903%,4:17.47093%,2:17.31526%,0:0.00687%]
[INFO] ** service:[0.0048200000000000005:99.99618%,-211.73542999999998:0.00324%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.35271%,9:25.98091%,7:18.19068%,1:17.47188%,14:0.00324%,2:0.00057%]
[INFO] ** type:[0:99.99905%,1:0.00095%]
[INFO] ** unixtime:1426 (0.27203%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0260 - tp: 79164.0000 - fp: 836.0000 - tn: 319164.0000 - fn: 836.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0273 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0274 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9998 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0271 - tp: 79130.0000 - fp: 870.0000 - tn: 319130.0000 - fn: 870.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0268 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/524208
[33m[INFO] loading file 41-41/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (464366, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (464366, 17)

[INFO] analyzing data
[INFO] 464366 rows
[INFO] ** appi_name:[21:99.99634%,30:0.00108%,22:0.00086%,17:0.00086%,32:0.00022%,28:0.00022%,26:0.00022%,7:0.00022%]
[INFO] ** classification:[normal:64.39231%,Single Stage Single Point:35.60769%]
[INFO] ** dst:[21:43.32208%,10:21.06571%,8:18.13699%,9:17.47049%,16:0.00108%,15:0.00108%,6:0.00108%,22:0.00065%,24:0.00043%,17:0.00043%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99634%,-33.760870000000004:0.00366%]
[INFO] ** modbus_function_description:[7:49.99892%,11:49.99742%,0:0.00366%]
[INFO] ** modbus_transaction_id:65536 (14.11301%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99763%,2:0.00129%,1:0.00108%]
[INFO] ** proxy_src_ip:[18:38.43994%,20:25.94807%,13:18.1372%,6:17.4707%,17:0.00108%,1:0.00086%,21:0.00043%,16:0.00043%,14:0.00043%,0:0.00043%,7:0.00022%,2:0.00022%]
[INFO] ** s_port:[1.45442:25.94764%,-0.32151:21.06571%,-1.27613:18.13656%,-0.23351:17.47027%,-0.33484:17.37423%,-71.33197:0.00108%,-71.14931:0.00086%,-1.02014:0.00043%,-1.27347:0.00043%,-71.14798:0.00022%,-0.24151:0.00022%,-58.035180000000004:0.00022%,-1.2708:0.00022%,-5.1466400000000005:0.00022%,1.47576:0.00022%,1.46509:0.00022%,-64.19226:0.00022%,-5.08665:0.00022%,-0.24950999999999998:0.00022%,2.05573:0.00022%,-43.76509:0.00022%,-58.032509999999995:0.00022%]
[INFO] ** scada_tag:[3:25.94742%,1:21.06571%,5:18.13656%,4:17.47006%,2:17.37423%,0:0.00603%]
[INFO] ** service:[0.0048200000000000005:99.99634%,-211.73542999999998:0.00108%,-205.44247:0.00086%,-211.08818:0.00086%,89.64175:0.00022%,-211.09762999999998:0.00022%,-211.08346:0.00022%,-185.9872:0.00022%]
[INFO] ** src:[22:38.43994%,9:25.94807%,7:18.1372%,1:17.4707%,14:0.00108%,3:0.00086%,15:0.00043%,8:0.00043%,4:0.00043%,2:0.00043%,21:0.00022%,17:0.00022%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1260 (0.27134%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/464366
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0275 - tp: 79075.0000 - fp: 925.0000 - tn: 319075.0000 - fn: 925.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/464366
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0272 - tp: 79083.0000 - fp: 917.0000 - tn: 319083.0000 - fn: 917.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 8.0603e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/464366
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0271 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/464366
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0276 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/464366
[33m[INFO] loading file 42-42/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (407880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (407880, 17)

[INFO] analyzing data
[INFO] 407880 rows
[INFO] ** appi_name:[21:99.99166%,30:0.00221%,17:0.00123%,31:0.00098%,26:0.00098%,7:0.00098%,22:0.00074%,28:0.00025%,27:0.00025%,9:0.00025%,8:0.00025%,0:0.00025%]
[INFO] ** classification:[normal:64.37947%,Single Stage Single Point:35.62053%]
[INFO] ** dst:[21:43.31691%,10:21.05374%,8:18.17741%,9:17.44263%,16:0.00221%,6:0.00196%,18:0.00123%,2:0.00098%,22:0.00074%,15:0.00074%,17:0.00049%,25:0.00025%,24:0.00025%,7:0.00025%,0:0.00025%]
[INFO] ** i/f_dir:[1:99.99926%,0:0.00074%]
[INFO] ** i/f_name:[2:99.99926%,3:0.00074%]
[INFO] ** modbus_function_code:[0.02961:99.99166%,-33.760870000000004:0.00834%]
[INFO] ** modbus_function_description:[7:49.99657%,11:49.9951%,0:0.00834%]
[INFO] ** modbus_transaction_id:65536 (16.06747%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99559%,2:0.00368%,1:0.00074%]
[INFO] ** proxy_src_ip:[18:38.4135%,20:25.95739%,13:18.1779%,6:17.44263%,17:0.00221%,1:0.00221%,14:0.00147%,21:0.00098%,7:0.00074%,0:0.00049%,16:0.00025%,2:0.00025%]
[INFO] ** s_port:[1.45442:25.9569%,-0.32151:21.05374%,-1.27613:18.17741%,-0.23351:17.44239%,-0.33484:17.35976%,-71.14931:0.00098%,-71.14798:0.00098%,-71.33197:0.00074%,11.57001:0.00049%,-0.08551:0.00049%,-3.3787199999999995:0.00049%,-0.24151:0.00025%,13.431270000000001:0.00025%,-5.1466400000000005:0.00025%,0.31847:0.00025%,-1.02014:0.00025%,-1.2708:0.00025%,-58.035180000000004:0.00025%,7.66617:0.00025%,-64.19493:0.00025%,1.47576:0.00025%,14.4699:0.00025%,15.912510000000001:0.00025%,14.191239999999999:0.00025%,7.9608300000000005:0.00025%,-5.08665:0.00025%,10.192739999999999:0.00025%,-3.0613900000000003:0.00025%,1.45709:0.00025%,2.05573:0.00025%,-43.76509:0.00025%,11.862:0.00025%,-1.27347:0.00025%,-58.032509999999995:0.00025%]
[INFO] ** scada_tag:[3:25.95641%,1:21.05374%,5:18.17716%,4:17.44239%,2:17.35952%,0:0.01079%]
[INFO] ** service:[0.0048200000000000005:99.99166%,-211.09762999999998:0.00172%,-205.44247:0.00123%,-186.43601999999998:0.00123%,-211.08346:0.00098%,-211.08818:0.00098%,-211.73542999999998:0.00074%,-211.35747999999998:0.00049%,-186.44547:0.00025%,-183.8612:0.00025%,-185.9872:0.00025%,-202.75898:0.00025%]
[INFO] ** src:[22:38.4135%,9:25.95739%,7:18.1779%,1:17.44263%,3:0.00294%,2:0.00172%,4:0.00123%,21:0.00098%,14:0.00074%,8:0.00049%,17:0.00025%,15:0.00025%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1107 (0.2714%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/407880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0270 - tp: 79134.0000 - fp: 866.0000 - tn: 319134.0000 - fn: 866.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9998 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/407880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0264 - tp: 79135.0000 - fp: 865.0000 - tn: 319135.0000 - fn: 865.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1929e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/407880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0266 - tp: 79129.0000 - fp: 871.0000 - tn: 319129.0000 - fn: 871.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/407880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0273 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-41-42-batch-300000-400000
[INFO] processing batch 400000-500000/407880
[33m[INFO] loading file 43-43/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.99921%,30:0.00059%,26:0.0002%]
[INFO] ** classification:[normal:64.40124%,Single Stage Single Point:35.59876%]
[INFO] ** dst:[21:43.3313%,10:21.06817%,8:18.12653%,9:17.47204%,22:0.00098%,15:0.00059%,24:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.9998%,0:0.0002%]
[INFO] ** i/f_name:[2:99.99941%,3:0.00059%]
[INFO] ** modbus_function_code:[0.02961:99.99921%,-33.760870000000004:0.00079%]
[INFO] ** modbus_function_description:[7:50.0002%,11:49.99902%,0:0.00079%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99921%,1:0.00059%,2:0.0002%]
[INFO] ** proxy_src_ip:[18:38.42227%,20:25.97759%,13:18.12672%,6:17.47224%,17:0.00059%,16:0.00039%,1:0.0002%]
[INFO] ** s_port:[1.45442:25.977%,-0.32151:21.06817%,-1.27613:18.12633%,-0.23351:17.47184%,-0.33484:17.3541%,-71.33197:0.00059%,1.45709:0.00039%,-1.02014:0.00039%,-71.14798:0.0002%,-1.27347:0.0002%,-0.24950999999999998:0.0002%,1.47576:0.0002%,-0.24151:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.97661%,1:21.06817%,5:18.12613%,4:17.47145%,2:17.3539%,0:0.00374%]
[INFO] ** service:[0.0048200000000000005:99.99921%,-211.73542999999998:0.00059%,-211.08346:0.0002%]
[INFO] ** src:[22:38.42227%,9:25.97759%,7:18.12672%,1:17.47224%,14:0.00059%,15:0.00039%,3:0.0002%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1381 (0.27191%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0263 - tp: 79139.0000 - fp: 861.0000 - tn: 319139.0000 - fn: 861.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0266 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0263 - tp: 79142.0000 - fp: 858.0000 - tn: 319142.0000 - fn: 858.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0275 - tp: 79088.0000 - fp: 912.0000 - tn: 319088.0000 - fn: 912.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0272 - tp: 79094.0000 - fp: 906.0000 - tn: 319094.0000 - fn: 906.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 44-44/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.99803%,30:0.00079%,31:0.00059%,0:0.00039%,22:0.0002%]
[INFO] ** classification:[normal:64.36501%,Single Stage Single Point:35.63499%]
[INFO] ** dst:[21:43.32185%,10:21.04001%,8:18.16965%,9:17.46515%,22:0.00098%,15:0.00079%,18:0.00059%,25:0.00039%,24:0.00039%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99921%,0:0.00079%]
[INFO] ** i/f_name:[2:99.99921%,3:0.00079%]
[INFO] ** modbus_function_code:[0.02961:99.99803%,-33.760870000000004:0.00197%]
[INFO] ** modbus_function_description:[7:50.0002%,11:49.99783%,0:0.00197%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99803%,2:0.00118%,1:0.00079%]
[INFO] ** proxy_src_ip:[18:38.40947%,20:25.95278%,13:18.16984%,6:17.46574%,17:0.00079%,7:0.00039%,16:0.0002%,5:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.95219%,-0.32151:21.04001%,-1.27613:18.16925%,-0.23351:17.46495%,-0.33484:17.36946%,-71.33197:0.00079%,-0.24151:0.00059%,-64.19493:0.00039%,-0.08551:0.00039%,-1.27347:0.00039%,1.46509:0.0002%,1.47576:0.0002%,-0.24950999999999998:0.0002%,1.45709:0.0002%,4.42897:0.0002%,-71.14931:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.9518%,1:21.04001%,5:18.16925%,4:17.46456%,2:17.36926%,0:0.00512%]
[INFO] ** service:[0.0048200000000000005:99.99803%,-211.73542999999998:0.00079%,-186.43601999999998:0.00059%,-186.44547:0.00039%,-211.08818:0.0002%]
[INFO] ** src:[22:38.40947%,9:25.95278%,7:18.16984%,1:17.46574%,14:0.00079%,21:0.00039%,17:0.0002%,16:0.0002%,15:0.0002%,8:0.0002%,3:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1378 (0.27132%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0265 - tp: 79139.0000 - fp: 861.0000 - tn: 319139.0000 - fn: 861.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9998 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0265 - tp: 79123.0000 - fp: 877.0000 - tn: 319123.0000 - fn: 877.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0266 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0267 - tp: 79130.0000 - fp: 870.0000 - tn: 319130.0000 - fn: 870.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0276 - tp: 79086.0000 - fp: 914.0000 - tn: 319086.0000 - fn: 914.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9998 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-1-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 45-45/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.99902%,30:0.00059%,26:0.0002%,9:0.0002%]
[INFO] ** classification:[normal:64.41797%,Single Stage Single Point:35.58203%]
[INFO] ** dst:[21:43.32441%,10:21.0914%,8:18.12003%,9:17.462%,22:0.00118%,15:0.00059%,6:0.0002%,0:0.0002%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99941%,3:0.00059%]
[INFO] ** modbus_function_code:[0.02961:99.99902%,-33.760870000000004:0.00098%]
[INFO] ** modbus_function_description:[7:50.00039%,11:49.99862%,0:0.00098%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99921%,1:0.00059%,2:0.0002%]
[INFO] ** proxy_src_ip:[18:38.48527%,20:25.93113%,13:18.12003%,6:17.4622%,17:0.00059%,16:0.00039%,21:0.0002%,1:0.0002%]
[INFO] ** s_port:[1.45442:25.93053%,-0.32151:21.0914%,-1.27613:18.12003%,-0.23351:17.462%,-0.33484:17.39387%,1.45709:0.00059%,-71.33197:0.00059%,-1.02014:0.00039%,-71.14798:0.0002%,14.4699:0.0002%,-0.24151:0.0002%]
[INFO] ** scada_tag:[3:25.93014%,1:21.0912%,5:18.12003%,4:17.462%,2:17.39368%,0:0.00295%]
[INFO] ** service:[0.0048200000000000005:99.99902%,-211.73542999999998:0.00059%,-183.8612:0.0002%,-211.08346:0.0002%]
[INFO] ** src:[22:38.48527%,9:25.93113%,7:18.12003%,1:17.4622%,14:0.00059%,15:0.00039%,4:0.0002%,3:0.0002%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** unixtime:1379 (0.27152%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0261 - tp: 79140.0000 - fp: 860.0000 - tn: 319140.0000 - fn: 860.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0264 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0266 - tp: 79132.0000 - fp: 868.0000 - tn: 319132.0000 - fn: 868.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0263 - tp: 79135.0000 - fp: 865.0000 - tn: 319135.0000 - fn: 865.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0277 - tp: 79076.0000 - fp: 924.0000 - tn: 319076.0000 - fn: 924.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9998 - val_loss: 3.9409e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 46-46/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.99823%,30:0.00098%,26:0.0002%,17:0.0002%,12:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:64.42093%,Single Stage Single Point:35.57907%]
[INFO] ** dst:[21:43.35%,10:21.06836%,8:18.10979%,9:17.46928%,22:0.00098%,15:0.00098%,25:0.0002%,16:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99902%,0:0.00098%]
[INFO] ** i/f_name:[2:99.99902%,3:0.00098%]
[INFO] ** modbus_function_code:[0.02961:99.99823%,-33.760870000000004:0.00177%]
[INFO] ** modbus_function_description:[11:49.99921%,7:49.99902%,0:0.00177%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:99.99961%,1:0.00039%]
[INFO] ** proto:[0:99.99862%,1:0.00098%,2:0.00039%]
[INFO] ** proxy_src_ip:[18:38.44097%,20:25.9772%,13:18.10979%,6:17.46987%,17:0.00098%,16:0.00039%,7:0.00039%,5:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.977%,-0.32151:21.06817%,-1.27613:18.10959%,-0.23351:17.46909%,-0.33484:17.3728%,-71.33197:0.00098%,-0.24151:0.00059%,-1.02014:0.00039%,-71.14798:0.0002%,-0.24950999999999998:0.0002%,10.192739999999999:0.0002%,1.47576:0.0002%,-61.95768:0.0002%,-64.19493:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.97681%,1:21.06797%,5:18.1094%,4:17.46869%,2:17.3728%,0:0.00433%]
[INFO] ** service:[0.0048200000000000005:99.99842%,-211.73542999999998:0.00098%,-186.44547:0.0002%,-211.08346:0.0002%,-205.44247:0.0002%]
[INFO] ** src:[22:38.44097%,9:25.9772%,7:18.10979%,1:17.46987%,14:0.00098%,21:0.00039%,15:0.00039%,16:0.0002%,8:0.0002%]
[INFO] ** type:[0:99.99921%,1:0.00079%]
[INFO] ** unixtime:1381 (0.27191%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0257 - tp: 79184.0000 - fp: 816.0000 - tn: 319184.0000 - fn: 816.0000 - accuracy: 0.9959 - precision: 0.9898 - recall: 0.9898 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0270 - tp: 79113.0000 - fp: 887.0000 - tn: 319113.0000 - fn: 887.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0273 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9998 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0265 - tp: 79129.0000 - fp: 871.0000 - tn: 319129.0000 - fn: 871.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0260 - tp: 79154.0000 - fp: 846.0000 - tn: 319154.0000 - fn: 846.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 47-47/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.9998%,33:0.0002%]
[INFO] ** classification:[normal:64.39257%,Single Stage Single Point:35.60743%]
[INFO] ** dst:[21:43.30058%,10:21.09022%,8:18.12849%,9:17.47854%,22:0.00177%,24:0.00039%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.9998%,-33.760870000000004:0.0002%]
[INFO] ** modbus_function_description:[7:50.00138%,11:49.99842%,0:0.0002%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.46086%,20:25.93073%,13:18.12889%,6:17.47893%,16:0.00039%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.92975%,-0.32151:21.09022%,-1.27613:18.1283%,-0.23351:17.47834%,-0.33484:17.37064%,1.45709:0.00059%,-0.24151:0.00059%,-1.27347:0.00039%,-1.02014:0.00039%,-61.95635:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.92916%,1:21.09002%,5:18.1281%,4:17.47814%,2:17.37044%,0:0.00413%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.46086%,9:25.93073%,7:18.12889%,1:17.47893%,15:0.00039%,8:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1379 (0.27152%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0263 - tp: 79140.0000 - fp: 860.0000 - tn: 319140.0000 - fn: 860.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0270 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0270 - tp: 79106.0000 - fp: 894.0000 - tn: 319106.0000 - fn: 894.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9998 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0272 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0269 - tp: 79124.0000 - fp: 876.0000 - tn: 319124.0000 - fn: 876.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9998 - val_loss: 1.2339e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 48-48/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.99665%,30:0.00276%,31:0.0002%,27:0.0002%,26:0.0002%]
[INFO] ** classification:[normal:64.41719%,Single Stage Single Point:35.58281%]
[INFO] ** dst:[21:43.33169%,10:21.08155%,8:18.11432%,9:17.4681%,15:0.00276%,22:0.00079%,24:0.0002%,18:0.0002%,7:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99764%,0:0.00236%]
[INFO] ** i/f_name:[2:99.99724%,3:0.00276%]
[INFO] ** modbus_function_code:[0.02961:99.99665%,-33.760870000000004:0.00335%]
[INFO] ** modbus_function_description:[7:49.99921%,11:49.99744%,0:0.00335%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99665%,1:0.00276%,2:0.00059%]
[INFO] ** proxy_src_ip:[18:38.45515%,20:25.9583%,13:18.11471%,6:17.4681%,17:0.00276%,14:0.00059%,16:0.00039%]
[INFO] ** s_port:[1.45442:25.9579%,-0.32151:21.08155%,-1.27613:18.11432%,-0.23351:17.46791%,-0.33484:17.37359%,-71.33197:0.00276%,-1.02014:0.00039%,-71.14798:0.0002%,-1.27347:0.0002%,11.862:0.0002%,1.45709:0.0002%,1.47576:0.0002%,-0.24151:0.0002%,13.431270000000001:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.95751%,1:21.08155%,5:18.11432%,4:17.46791%,2:17.3734%,0:0.00532%]
[INFO] ** service:[0.0048200000000000005:99.99665%,-211.73542999999998:0.00276%,-211.08346:0.0002%,-186.43601999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:38.45515%,9:25.9583%,7:18.11471%,1:17.4681%,14:0.00276%,2:0.00059%,15:0.00039%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1378 (0.27132%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0280 - tp: 79051.0000 - fp: 949.0000 - tn: 319051.0000 - fn: 949.0000 - accuracy: 0.9953 - precision: 0.9881 - recall: 0.9881 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0273 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0266 - tp: 79129.0000 - fp: 871.0000 - tn: 319129.0000 - fn: 871.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0273 - tp: 79109.0000 - fp: 891.0000 - tn: 319109.0000 - fn: 891.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0271 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9998 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 49-49/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.99724%,30:0.00098%,17:0.00079%,22:0.00039%,28:0.0002%,26:0.0002%,7:0.0002%]
[INFO] ** classification:[normal:64.37151%,Single Stage Single Point:35.62849%]
[INFO] ** dst:[21:43.29901%,10:21.06797%,8:18.14149%,9:17.4872%,22:0.00138%,15:0.00098%,16:0.00079%,6:0.00059%,17:0.00039%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.99902%,0:0.00098%]
[INFO] ** i/f_name:[2:99.99902%,3:0.00098%]
[INFO] ** modbus_function_code:[0.02961:99.99724%,-33.760870000000004:0.00276%]
[INFO] ** modbus_function_description:[7:49.99941%,11:49.99783%,0:0.00276%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99842%,1:0.00098%,2:0.00059%]
[INFO] ** proxy_src_ip:[18:38.42798%,20:25.93979%,13:18.14129%,6:17.48779%,17:0.00098%,1:0.00079%,21:0.00039%,16:0.00039%,14:0.00039%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.939%,-0.32151:21.06797%,-1.27613:18.1411%,-0.23351:17.487%,-0.33484:17.36001%,-71.33197:0.00098%,-0.24151:0.00059%,1.45709:0.00039%,-1.02014:0.00039%,-71.14931:0.00039%,-71.14798:0.0002%,-58.035180000000004:0.0002%,-5.1466400000000005:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,-5.08665:0.0002%,-0.24950999999999998:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** scada_tag:[3:25.93861%,1:21.06777%,5:18.1409%,4:17.48661%,2:17.36001%,0:0.0061%]
[INFO] ** service:[0.0048200000000000005:99.99724%,-211.73542999999998:0.00098%,-205.44247:0.00079%,-211.08818:0.00039%,-211.09762999999998:0.0002%,-211.08346:0.0002%,-185.9872:0.0002%]
[INFO] ** src:[22:38.42798%,9:25.93979%,7:18.14129%,1:17.48779%,14:0.00098%,3:0.00079%,15:0.00039%,4:0.00039%,2:0.00039%,8:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1379 (0.27152%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0272 - tp: 79082.0000 - fp: 918.0000 - tn: 319082.0000 - fn: 918.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0265 - tp: 79135.0000 - fp: 865.0000 - tn: 319135.0000 - fn: 865.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0277 - tp: 79047.0000 - fp: 953.0000 - tn: 319047.0000 - fn: 953.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0274 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0269 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 50-50/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (357862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (357862, 17)

[INFO] analyzing data
[INFO] 357862 rows
[INFO] ** appi_name:[21:99.99749%,30:0.00084%,7:0.00084%,31:0.00028%,22:0.00028%,8:0.00028%]
[INFO] ** classification:[normal:64.2949%,Single Stage Single Point:35.7051%]
[INFO] ** dst:[21:43.25019%,10:21.04163%,8:18.2263%,9:17.47853%,15:0.00084%,22:0.00056%,16:0.00056%,2:0.00056%,24:0.00028%,18:0.00028%,6:0.00028%]
[INFO] ** i/f_dir:[1:99.99916%,0:0.00084%]
[INFO] ** i/f_name:[2:99.99916%,3:0.00084%]
[INFO] ** modbus_function_code:[0.02961:99.99749%,-33.760870000000004:0.00251%]
[INFO] ** modbus_function_description:[7:49.99916%,11:49.99832%,0:0.00251%]
[INFO] ** modbus_transaction_id:65535 (18.31293%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9986%,1:0.00084%,2:0.00056%]
[INFO] ** proxy_src_ip:[18:38.36339%,20:25.92871%,13:18.22658%,6:17.47853%,17:0.00084%,1:0.00084%,21:0.00028%,16:0.00028%,14:0.00028%,7:0.00028%]
[INFO] ** s_port:[1.45442:25.92815%,-0.32151:21.04163%,-1.27613:18.22602%,-0.23351:17.47853%,-0.33484:17.32176%,-71.33197:0.00084%,-3.3787199999999995:0.00028%,4.33564:0.00028%,15.912510000000001:0.00028%,7.9608300000000005:0.00028%,1.46509:0.00028%,1.45709:0.00028%,-1.27347:0.00028%,-71.14931:0.00028%,-1.02014:0.00028%,-1.2708:0.00028%,0.31847:0.00028%]
[INFO] ** scada_tag:[3:25.92787%,1:21.04135%,5:18.22574%,4:17.47853%,2:17.32148%,0:0.00503%]
[INFO] ** service:[0.0048200000000000005:99.99749%,-211.09762999999998:0.00084%,-211.73542999999998:0.00084%,-186.43601999999998:0.00028%,-211.35747999999998:0.00028%,-211.08818:0.00028%]
[INFO] ** src:[22:38.36339%,9:25.92871%,7:18.22658%,1:17.47853%,14:0.00084%,3:0.00084%,21:0.00028%,15:0.00028%,4:0.00028%,2:0.00028%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:973 (0.27189%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/357862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0275 - tp: 79074.0000 - fp: 926.0000 - tn: 319074.0000 - fn: 926.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/357862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0277 - tp: 79077.0000 - fp: 923.0000 - tn: 319077.0000 - fn: 923.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9998 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/357862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0269 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9998 - val_loss: 1.1925e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/357862
[33m[INFO] epoch 2/10[0m
[33m[INFO] loading file 1-1/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99355%,30:0.00108%,22:0.0009%,17:0.00072%,31:0.00054%,26:0.00054%,7:0.00054%,23:0.00036%,18:0.00036%,0:0.00036%,28:0.00018%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:77.7375%,Single Stage Single Point:22.2625%]
[INFO] ** dst:[21:43.26823%,10:21.03423%,8:18.17026%,9:17.52028%,6:0.00143%,22:0.00108%,16:0.00108%,15:0.00108%,18:0.00054%,26:0.00036%,25:0.00036%,19:0.00036%,17:0.00036%,24:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99355%,-33.760870000000004:0.00627%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99767%,11:49.99588%,0:0.00627%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99641%,2:0.00251%,1:0.00108%]
[INFO] ** proxy_src_ip:[18:38.39605%,20:25.90605%,13:18.17044%,6:17.52064%,11:0.00125%,10:0.00125%,17:0.00108%,14:0.0009%,1:0.0009%,7:0.00054%,21:0.00036%,16:0.00036%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.90551%,-0.32151:21.03352%,-1.27613:18.17009%,-0.23351:17.5201%,-0.33484:17.36254%,-71.33197:0.00108%,-71.14931:0.0009%,-2.1481:0.00072%,-0.24151:0.00054%,-71.14798:0.00054%,-1.02014:0.00036%,-64.19493:0.00036%,-2.42942:0.00036%,4.44364:0.00036%,-43.76509:0.00018%,10.67005:0.00018%,4.29964:0.00018%,-5.08665:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,1.47576:0.00018%,1.46509:0.00018%,4.076980000000001:0.00018%,-58.032509999999995:0.00018%,-58.035180000000004:0.00018%,-1.2708:0.00018%,-1.27347:0.00018%,-5.1466400000000005:0.00018%,-68.79874000000001:0.00018%,14.253910000000001:0.00018%,1.45709:0.00018%]
[INFO] ** scada_tag:[3:25.90533%,1:21.03334%,5:18.16973%,4:17.51992%,2:17.36236%,0:0.00932%]
[INFO] ** service:[0.0048200000000000005:99.99426%,-211.73542999999998:0.00108%,-211.08818:0.0009%,-205.44247:0.00072%,-211.07873999999998:0.00072%,-211.09762999999998:0.00054%,-211.08346:0.00054%,-186.43601999999998:0.00054%,-186.44547:0.00036%,-185.9872:0.00018%,-202.75898:0.00018%]
[INFO] ** src:[22:38.39605%,9:25.90605%,7:18.17044%,1:17.52064%,11:0.00125%,10:0.00125%,14:0.00108%,3:0.0009%,2:0.0009%,21:0.00054%,15:0.00036%,4:0.00036%,8:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1514 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3769 - tp: 75427.0000 - fp: 4573.0000 - tn: 315427.0000 - fn: 4573.0000 - accuracy: 0.9771 - precision: 0.9428 - recall: 0.9428 - auc: 0.9842 - val_loss: 0.2840 - val_tp: 19637.0000 - val_fp: 363.0000 - val_tn: 79637.0000 - val_fn: 363.0000 - val_accuracy: 0.9927 - val_precision: 0.9819 - val_recall: 0.9819 - val_auc: 0.9886
[INFO] saving weights to checkpoints/lstm-epoch-2-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0243 - tp: 79911.0000 - fp: 89.0000 - tn: 319911.0000 - fn: 89.0000 - accuracy: 0.9996 - precision: 0.9989 - recall: 0.9989 - auc: 0.9994 - val_loss: 9.8871e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0085 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2773 - tp: 59961.0000 - fp: 20039.0000 - tn: 299961.0000 - fn: 20039.0000 - accuracy: 0.8998 - precision: 0.7495 - recall: 0.7495 - auc: 0.9165 - val_loss: 0.8122 - val_tp: 10621.0000 - val_fp: 9379.0000 - val_tn: 70621.0000 - val_fn: 9379.0000 - val_accuracy: 0.8124 - val_precision: 0.5311 - val_recall: 0.5311 - val_auc: 0.9005
[INFO] saving weights to checkpoints/lstm-epoch-2-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6475 - tp: 42751.0000 - fp: 37249.0000 - tn: 282751.0000 - fn: 37249.0000 - accuracy: 0.8138 - precision: 0.5344 - recall: 0.5344 - auc: 0.9099 - val_loss: 0.4523 - val_tp: 14400.0000 - val_fp: 5600.0000 - val_tn: 74400.0000 - val_fn: 5600.0000 - val_accuracy: 0.8880 - val_precision: 0.7200 - val_recall: 0.7200 - val_auc: 0.9524
[INFO] saving weights to checkpoints/lstm-epoch-2-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 2-2/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99875%,7:0.00054%,30:0.00036%,31:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:70.74223%,Single Stage Single Point:29.25777%]
[INFO] ** dst:[21:43.30838%,10:21.03047%,8:18.14571%,9:17.51311%,22:0.0009%,16:0.00036%,15:0.00036%,2:0.00036%,24:0.00018%,18:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99964%,3:0.00036%]
[INFO] ** modbus_function_code:[0.02961:99.99875%,-33.760870000000004:0.00125%]
[INFO] ** modbus_function_description:[7:49.99982%,11:49.99892%,0:0.00125%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99946%,1:0.00036%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.38064%,20:25.95875%,13:18.14571%,6:17.51347%,1:0.00054%,17:0.00036%,16:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.95803%,-0.32151:21.03047%,-1.27613:18.14535%,-0.23351:17.51293%,-0.33484:17.35017%,-0.24151:0.00036%,-71.33197:0.00036%,1.45709:0.00036%,1.47576:0.00018%,12.60597:0.00018%,10.67005:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,4.076980000000001:0.00018%,-3.3787199999999995:0.00018%,4.29964:0.00018%,-1.27347:0.00018%]
[INFO] ** scada_tag:[3:25.95767%,1:21.03047%,5:18.14535%,4:17.51257%,2:17.34999%,0:0.00394%]
[INFO] ** service:[0.0048200000000000005:99.99875%,-211.09762999999998:0.00054%,-211.73542999999998:0.00036%,-211.35747999999998:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.38064%,9:25.95875%,7:18.14571%,1:17.51347%,3:0.00054%,14:0.00036%,21:0.00018%,15:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1517 (0.27193%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4424 - tp: 63628.0000 - fp: 16372.0000 - tn: 303628.0000 - fn: 16372.0000 - accuracy: 0.9181 - precision: 0.7954 - recall: 0.7954 - auc: 0.9688 - val_loss: 0.3854 - val_tp: 16542.0000 - val_fp: 3458.0000 - val_tn: 76542.0000 - val_fn: 3458.0000 - val_accuracy: 0.9308 - val_precision: 0.8271 - val_recall: 0.8271 - val_auc: 0.9820
[INFO] saving weights to checkpoints/lstm-epoch-2-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4033 - tp: 64258.0000 - fp: 15742.0000 - tn: 304258.0000 - fn: 15742.0000 - accuracy: 0.9213 - precision: 0.8032 - recall: 0.8032 - auc: 0.9731 - val_loss: 0.6243 - val_tp: 9139.0000 - val_fp: 10861.0000 - val_tn: 69139.0000 - val_fn: 10861.0000 - val_accuracy: 0.7828 - val_precision: 0.4570 - val_recall: 0.4570 - val_auc: 0.9149
[INFO] saving weights to checkpoints/lstm-epoch-2-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1518 - tp: 69715.0000 - fp: 10285.0000 - tn: 309715.0000 - fn: 10285.0000 - accuracy: 0.9486 - precision: 0.8714 - recall: 0.8714 - auc: 0.9948 - val_loss: 1.6409e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5920 - tp: 53895.0000 - fp: 26105.0000 - tn: 293895.0000 - fn: 26105.0000 - accuracy: 0.8695 - precision: 0.6737 - recall: 0.6737 - auc: 0.9391 - val_loss: 0.4295 - val_tp: 15517.0000 - val_fp: 4483.0000 - val_tn: 75517.0000 - val_fn: 4483.0000 - val_accuracy: 0.9103 - val_precision: 0.7758 - val_recall: 0.7758 - val_auc: 0.9697
[INFO] saving weights to checkpoints/lstm-epoch-2-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4220 - tp: 63700.0000 - fp: 16300.0000 - tn: 303700.0000 - fn: 16300.0000 - accuracy: 0.9185 - precision: 0.7962 - recall: 0.7962 - auc: 0.9672 - val_loss: 0.6087 - val_tp: 9366.0000 - val_fp: 10634.0000 - val_tn: 69366.0000 - val_fn: 10634.0000 - val_accuracy: 0.7873 - val_precision: 0.4683 - val_recall: 0.4683 - val_auc: 0.9158
[INFO] saving weights to checkpoints/lstm-epoch-2-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 3-3/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99175%,30:0.00215%,22:0.00108%,31:0.0009%,26:0.0009%,17:0.0009%,7:0.00072%,27:0.00036%,0:0.00036%,28:0.00018%,23:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:88.08989%,Single Stage Single Point:11.91011%]
[INFO] ** dst:[21:43.31053%,10:21.08066%,8:18.1561%,9:17.44356%,6:0.00215%,15:0.00143%,18:0.00125%,16:0.00125%,22:0.0009%,2:0.00036%,7:0.00036%,25:0.00036%,17:0.00036%,12:0.00018%,24:0.00018%,19:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99857%,0:0.00143%]
[INFO] ** i/f_name:[2:99.99857%,3:0.00143%]
[INFO] ** modbus_function_code:[0.02961:99.99175%,-33.760870000000004:0.00807%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99641%,11:49.99534%,0:0.00807%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99892%,2:0.00108%]
[INFO] ** proto:[0:99.99426%,2:0.0043%,1:0.00143%]
[INFO] ** proxy_src_ip:[18:38.40502%,20:25.98653%,13:18.15628%,6:17.44392%,17:0.00215%,1:0.00143%,14:0.00125%,7:0.0009%,11:0.00072%,10:0.00072%,21:0.00054%,16:0.00018%,15:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.98582%,-0.32151:21.08048%,-1.27613:18.15574%,-0.23351:17.44338%,-0.33484:17.32454%,-71.33197:0.00143%,-71.14931:0.00108%,-71.14798:0.00108%,-64.19493:0.00036%,-0.08551:0.00036%,1.45709:0.00036%,-0.24151:0.00036%,14.4699:0.00018%,4.29964:0.00018%,4.90362:0.00018%,10.192739999999999:0.00018%,-3.3787199999999995:0.00018%,13.86459:0.00018%,4.44364:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,-43.76509:0.00018%,-5.08665:0.00018%,-58.035180000000004:0.00018%,4.076980000000001:0.00018%,-58.032509999999995:0.00018%,-1.27347:0.00018%,-1.2708:0.00018%,-1.02014:0.00018%,-5.1466400000000005:0.00018%,13.431270000000001:0.00018%,12.60597:0.00018%,1.47576:0.00018%,1.46509:0.00018%,14.253910000000001:0.00018%,-68.79874000000001:0.00018%,-0.24950999999999998:0.00018%,-2.1481:0.00018%,10.67005:0.00018%,-68.36943000000001:0.00018%]
[INFO] ** scada_tag:[3:25.98546%,1:21.0803%,5:18.15557%,4:17.4432%,2:17.32436%,0:0.01111%]
[INFO] ** service:[0.0048200000000000005:99.99193%,-211.73542999999998:0.00143%,-186.43601999999998:0.00125%,-211.08346:0.00108%,-211.08818:0.00108%,-205.44247:0.0009%,-211.09762999999998:0.00072%,-202.75898:0.00036%,-186.44547:0.00036%,-183.8612:0.00018%,-185.9872:0.00018%,-201.23771000000002:0.00018%,-211.35747999999998:0.00018%,-211.07873999999998:0.00018%]
[INFO] ** src:[22:38.40502%,9:25.98653%,7:18.15628%,1:17.44392%,21:0.00197%,3:0.00161%,2:0.00125%,11:0.00072%,10:0.00072%,4:0.00072%,14:0.00036%,8:0.00036%,17:0.00018%,15:0.00018%,13:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1515 (0.27157%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2605 - tp: 63153.0000 - fp: 16847.0000 - tn: 303153.0000 - fn: 16847.0000 - accuracy: 0.9158 - precision: 0.7894 - recall: 0.7894 - auc: 0.9819 - val_loss: 0.4382 - val_tp: 14605.0000 - val_fp: 5395.0000 - val_tn: 74605.0000 - val_fn: 5395.0000 - val_accuracy: 0.8921 - val_precision: 0.7303 - val_recall: 0.7303 - val_auc: 0.9554
[INFO] saving weights to checkpoints/lstm-epoch-2-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3868 - tp: 66163.0000 - fp: 13837.0000 - tn: 306163.0000 - fn: 13837.0000 - accuracy: 0.9308 - precision: 0.8270 - recall: 0.8270 - auc: 0.9773 - val_loss: 0.1953 - val_tp: 19985.0000 - val_fp: 15.0000 - val_tn: 79985.0000 - val_fn: 15.0000 - val_accuracy: 0.9997 - val_precision: 0.9992 - val_recall: 0.9992 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2325 - tp: 71258.0000 - fp: 8742.0000 - tn: 311258.0000 - fn: 8742.0000 - accuracy: 0.9563 - precision: 0.8907 - recall: 0.8907 - auc: 0.9908 - val_loss: 0.0240 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0598 - tp: 74927.0000 - fp: 5073.0000 - tn: 314927.0000 - fn: 5073.0000 - accuracy: 0.9746 - precision: 0.9366 - recall: 0.9366 - auc: 0.9990 - val_loss: 9.6405e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0497 - tp: 74927.0000 - fp: 5073.0000 - tn: 314927.0000 - fn: 5073.0000 - accuracy: 0.9746 - precision: 0.9366 - recall: 0.9366 - auc: 0.9990 - val_loss: 3.1506e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 4-4/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99767%,30:0.00125%,31:0.00036%,33:0.00018%,26:0.00018%,23:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:92.15218%,Single Stage Single Point:7.84782%]
[INFO] ** dst:[21:43.35086%,10:20.9464%,8:18.17636%,9:17.52297%,15:0.00125%,22:0.00108%,18:0.00036%,24:0.00018%,19:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99875%,3:0.00125%]
[INFO] ** modbus_function_code:[0.02961:99.99767%,-33.760870000000004:0.00233%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.99803%,0:0.00233%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99892%,2:0.00108%]
[INFO] ** proto:[0:99.99821%,1:0.00125%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.25785%,20:26.03977%,13:18.17636%,6:17.52333%,17:0.00125%,21:0.00036%,16:0.00036%,14:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.03906%,-0.32151:20.94622%,-1.27613:18.176%,-0.23351:17.52279%,-0.33484:17.31163%,-71.33197:0.00125%,1.45709:0.00036%,-0.08551:0.00036%,-0.24151:0.00036%,-1.02014:0.00036%,-1.2708:0.00018%,14.4699:0.00018%,4.44364:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-49.275529999999996:0.00018%]
[INFO] ** scada_tag:[3:26.03888%,1:20.94604%,5:18.176%,4:17.52243%,2:17.31145%,0:0.0052%]
[INFO] ** service:[0.0048200000000000005:99.99785%,-211.73542999999998:0.00125%,-186.43601999999998:0.00036%,-183.8612:0.00018%,-211.08346:0.00018%,-211.07873999999998:0.00018%]
[INFO] ** src:[22:38.25785%,9:26.03977%,7:18.17636%,1:17.52333%,21:0.00108%,15:0.00036%,4:0.00036%,17:0.00018%,14:0.00018%,8:0.00018%,3:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1525 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0419 - tp: 78849.0000 - fp: 1149.0000 - tn: 318851.0000 - fn: 1151.0000 - accuracy: 0.9942 - precision: 0.9856 - recall: 0.9856 - auc: 0.9999 - val_loss: 1.6326e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0353 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0015 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-2-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0301 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7788e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0267 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8393e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8676 - tp: 45868.0000 - fp: 34132.0000 - tn: 285868.0000 - fn: 34132.0000 - accuracy: 0.8293 - precision: 0.5734 - recall: 0.5734 - auc: 0.8875 - val_loss: 0.7018 - val_tp: 10352.0000 - val_fp: 9648.0000 - val_tn: 70352.0000 - val_fn: 9648.0000 - val_accuracy: 0.8070 - val_precision: 0.5176 - val_recall: 0.5176 - val_auc: 0.8776
[INFO] saving weights to checkpoints/lstm-epoch-2-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 5-5/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99641%,30:0.00251%,37:0.00018%,26:0.00018%,12:0.00018%,9:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:89.89983%,Single Stage Single Point:10.10017%]
[INFO] ** dst:[21:43.36556%,10:20.76929%,8:18.23641%,9:17.62443%,15:0.00251%,22:0.0009%,25:0.00018%,24:0.00018%,6:0.00018%,2:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99785%,0:0.00215%]
[INFO] ** i/f_name:[2:99.99749%,3:0.00251%]
[INFO] ** modbus_function_code:[0.02961:99.99641%,-33.760870000000004:0.00359%]
[INFO] ** modbus_function_description:[7:49.99875%,11:49.99767%,0:0.00359%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99803%,2:0.00197%]
[INFO] ** proto:[0:99.99713%,1:0.00251%,2:0.00036%]
[INFO] ** proxy_src_ip:[18:38.00689%,20:26.12815%,13:18.23659%,6:17.62461%,17:0.00251%,1:0.00036%,21:0.00018%,16:0.00018%,7:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.12761%,-0.32151:20.76894%,-1.27613:18.23641%,-0.23351:17.62425%,-0.33484:17.23795%,-71.33197:0.00251%,-0.24151:0.00036%,1.45709:0.00036%,1.47576:0.00018%,-49.275529999999996:0.00018%,-1.27347:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,2.22906:0.00018%,14.4699:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.12725%,1:20.76876%,5:18.23623%,4:17.62425%,2:17.23795%,0:0.00556%]
[INFO] ** service:[0.0048200000000000005:99.99677%,-211.73542999999998:0.00251%,-183.8612:0.00018%,-211.08346:0.00018%,-211.35747999999998:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.00689%,9:26.12815%,7:18.23659%,1:17.62461%,21:0.00215%,14:0.00054%,3:0.00036%,16:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1526 (0.27354%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1640 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3950 - val_tp: 16070.0000 - val_fp: 3930.0000 - val_tn: 76070.0000 - val_fn: 3930.0000 - val_accuracy: 0.9214 - val_precision: 0.8035 - val_recall: 0.8035 - val_auc: 0.8643
[INFO] saving weights to checkpoints/lstm-epoch-2-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6037 - tp: 51296.0000 - fp: 28704.0000 - tn: 291296.0000 - fn: 28704.0000 - accuracy: 0.8565 - precision: 0.6412 - recall: 0.6412 - auc: 0.9383 - val_loss: 0.4720 - val_tp: 12850.0000 - val_fp: 7150.0000 - val_tn: 72850.0000 - val_fn: 7150.0000 - val_accuracy: 0.8570 - val_precision: 0.6425 - val_recall: 0.6425 - val_auc: 0.9535
[INFO] saving weights to checkpoints/lstm-epoch-2-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3496 - tp: 63439.0000 - fp: 16561.0000 - tn: 303439.0000 - fn: 16561.0000 - accuracy: 0.9172 - precision: 0.7930 - recall: 0.7930 - auc: 0.9751 - val_loss: 0.1825 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0598 - tp: 79932.0000 - fp: 68.0000 - tn: 319932.0000 - fn: 68.0000 - accuracy: 0.9997 - precision: 0.9991 - recall: 0.9991 - auc: 1.0000 - val_loss: 0.0010 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0169 - tp: 79997.0000 - fp: 3.0000 - tn: 319997.0000 - fn: 3.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.1843e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 6-6/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99588%,30:0.00323%,31:0.00018%,27:0.00018%,26:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:92.75717%,Single Stage Single Point:7.24283%]
[INFO] ** dst:[21:43.37471%,10:20.73129%,8:18.27871%,9:17.61045%,15:0.00323%,22:0.00054%,25:0.00018%,24:0.00018%,18:0.00018%,12:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99695%,0:0.00305%]
[INFO] ** i/f_name:[2:99.99677%,3:0.00323%]
[INFO] ** modbus_function_code:[0.02961:99.99588%,-33.760870000000004:0.00412%]
[INFO] ** modbus_function_description:[7:49.99857%,11:49.99731%,0:0.00412%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99964%,1:0.00036%]
[INFO] ** proto:[0:99.99588%,1:0.00323%,2:0.0009%]
[INFO] ** proxy_src_ip:[18:37.94057%,20:26.16561%,13:18.27889%,6:17.61063%,17:0.00323%,14:0.00054%,16:0.00036%,11:0.00018%]
[INFO] ** s_port:[1.45442:26.16525%,-0.32151:20.73129%,-1.27613:18.27836%,-0.23351:17.61027%,-0.33484:17.20927%,-71.33197:0.00323%,-1.02014:0.00036%,-71.14798:0.00018%,-64.19493:0.00018%,4.90362:0.00018%,-1.2708:0.00018%,-0.24151:0.00018%,13.431270000000001:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-68.36943000000001:0.00018%]
[INFO] ** scada_tag:[3:26.16507%,1:20.73093%,5:18.27818%,4:17.60991%,2:17.20909%,0:0.00681%]
[INFO] ** service:[0.0048200000000000005:99.99588%,-211.73542999999998:0.00323%,-211.08346:0.00018%,-201.23771000000002:0.00018%,-202.75898:0.00018%,-186.44547:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:37.94057%,9:26.16561%,7:18.27889%,1:17.61063%,14:0.00323%,2:0.00054%,15:0.00036%,10:0.00018%]
[INFO] ** type:[0:99.9991%,1:0.0009%]
[INFO] ** unixtime:1527 (0.27372%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0139 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6878e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0122 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.5467e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0113 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8426e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0104 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8364e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5947 - tp: 66906.0000 - fp: 13094.0000 - tn: 306906.0000 - fn: 13094.0000 - accuracy: 0.9345 - precision: 0.8363 - recall: 0.8363 - auc: 0.9640 - val_loss: 0.4120 - val_tp: 13087.0000 - val_fp: 6913.0000 - val_tn: 73087.0000 - val_fn: 6913.0000 - val_accuracy: 0.8617 - val_precision: 0.6543 - val_recall: 0.6543 - val_auc: 0.9682
[INFO] saving weights to checkpoints/lstm-epoch-2-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 7-7/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99534%,30:0.00161%,22:0.0009%,17:0.00072%,26:0.00054%,31:0.00036%,28:0.00018%,27:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:80.77535%,Single Stage Single Point:19.22465%]
[INFO] ** dst:[21:43.36037%,10:20.74438%,8:18.25021%,9:17.63859%,15:0.00161%,22:0.00143%,6:0.00143%,16:0.00072%,24:0.00036%,18:0.00036%,17:0.00036%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99839%,0:0.00161%]
[INFO] ** i/f_name:[2:99.99839%,3:0.00161%]
[INFO] ** modbus_function_code:[0.02961:99.99534%,-33.760870000000004:0.00466%]
[INFO] ** modbus_function_description:[7:49.99839%,11:49.99695%,0:0.00466%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99641%,2:0.00197%,1:0.00161%]
[INFO] ** proxy_src_ip:[18:37.96817%,20:26.13729%,13:18.25057%,6:17.63877%,17:0.00161%,11:0.00072%,1:0.00072%,21:0.00054%,16:0.00054%,14:0.00036%,7:0.00036%,10:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13639%,-0.32151:20.74438%,-1.27613:18.25003%,-0.23351:17.63841%,-0.33484:17.22379%,-71.33197:0.00161%,-71.14931:0.0009%,-1.02014:0.00054%,-71.14798:0.00054%,1.45709:0.00054%,-0.24151:0.00036%,-1.27347:0.00036%,1.47576:0.00018%,1.46509:0.00018%,14.253910000000001:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,-68.79874000000001:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,6.1115699999999995:0.00018%,-5.08665:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:26.13603%,1:20.74438%,5:18.24985%,4:17.63823%,2:17.22379%,0:0.00771%]
[INFO] ** service:[0.0048200000000000005:99.99534%,-211.73542999999998:0.00161%,-211.08818:0.0009%,-205.44247:0.00072%,-211.08346:0.00054%,-186.43601999999998:0.00036%,-211.09762999999998:0.00018%,-185.9872:0.00018%,-202.75898:0.00018%]
[INFO] ** src:[22:37.96817%,9:26.13729%,7:18.25057%,1:17.63877%,14:0.00161%,10:0.00072%,3:0.00072%,15:0.00054%,4:0.00054%,21:0.00036%,2:0.00036%,11:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1524 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0878 - tp: 76693.0000 - fp: 3307.0000 - tn: 316693.0000 - fn: 3307.0000 - accuracy: 0.9835 - precision: 0.9587 - recall: 0.9587 - auc: 0.9988 - val_loss: 5.9841e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0367 - tp: 78952.0000 - fp: 1048.0000 - tn: 318952.0000 - fn: 1048.0000 - accuracy: 0.9948 - precision: 0.9869 - recall: 0.9869 - auc: 0.9997 - val_loss: 4.9176e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0314 - tp: 79042.0000 - fp: 958.0000 - tn: 319042.0000 - fn: 958.0000 - accuracy: 0.9952 - precision: 0.9880 - recall: 0.9880 - auc: 0.9998 - val_loss: 0.2942 - val_tp: 19583.0000 - val_fp: 417.0000 - val_tn: 79583.0000 - val_fn: 417.0000 - val_accuracy: 0.9917 - val_precision: 0.9791 - val_recall: 0.9791 - val_auc: 0.9870
[INFO] saving weights to checkpoints/lstm-epoch-2-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2012 - tp: 78471.0000 - fp: 1529.0000 - tn: 318471.0000 - fn: 1529.0000 - accuracy: 0.9924 - precision: 0.9809 - recall: 0.9809 - auc: 0.9907 - val_loss: 5.3510e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0169 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7383e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 8-8/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99713%,30:0.00108%,0:0.00054%,24:0.00018%,23:0.00018%,22:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:94.87723%,Single Stage Single Point:5.12277%]
[INFO] ** dst:[21:43.42095%,10:20.80335%,8:18.19034%,9:17.58177%,22:0.00125%,15:0.00108%,25:0.00054%,19:0.00036%,26:0.00018%,24:0.00018%]
[INFO] ** i/f_dir:[1:99.99928%,0:0.00072%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99713%,-33.760870000000004:0.00269%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.99749%,0:0.00269%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99964%,2:0.00036%]
[INFO] ** proto:[0:99.99821%,1:0.00108%,2:0.00072%]
[INFO] ** proxy_src_ip:[18:38.08863%,20:26.13621%,13:18.18962%,6:17.58213%,17:0.00108%,10:0.00108%,16:0.00054%,14:0.00036%,11:0.00018%,5:0.00018%]
[INFO] ** s_port:[1.45442:26.13568%,-0.32151:20.80335%,-1.27613:18.18944%,-0.23351:17.58159%,-0.33484:17.28528%,-71.33197:0.00108%,-15.039579999999999:0.00072%,-1.02014:0.00054%,-64.19493:0.00054%,1.45709:0.00036%,-0.24151:0.00036%,4.66896:0.00036%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.13514%,1:20.80317%,5:18.18944%,4:17.58141%,2:17.2851%,0:0.00574%]
[INFO] ** service:[0.0048200000000000005:99.99785%,-211.73542999999998:0.00108%,-186.44547:0.00054%,-211.07873999999998:0.00036%,-211.08818:0.00018%]
[INFO] ** src:[22:38.08863%,9:26.13621%,7:18.18962%,1:17.58213%,11:0.00108%,14:0.00072%,15:0.00054%,21:0.00036%,2:0.00036%,16:0.00018%,10:0.00018%]
[INFO] ** type:[0:99.99946%,1:0.00036%,2:0.00018%]
[INFO] ** unixtime:1528 (0.2739%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0154 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7752e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0120 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0886e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0101 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.9551e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0090 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8514e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4657 - tp: 67680.0000 - fp: 12320.0000 - tn: 307680.0000 - fn: 12320.0000 - accuracy: 0.9384 - precision: 0.8460 - recall: 0.8460 - auc: 0.9726 - val_loss: 0.0273 - val_tp: 19943.0000 - val_fp: 57.0000 - val_tn: 79943.0000 - val_fn: 57.0000 - val_accuracy: 0.9989 - val_precision: 0.9972 - val_recall: 0.9972 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 9-9/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99821%,30:0.00108%,31:0.00036%,26:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:94.62824%,Single Stage Single Point:5.37176%]
[INFO] ** dst:[21:43.37327%,10:20.77055%,8:18.27979%,9:17.57352%,15:0.00108%,22:0.0009%,18:0.00036%,25:0.00018%,24:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99821%,-33.760870000000004:0.00179%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99821%,0:0.00179%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99964%,2:0.00036%]
[INFO] ** proto:[0:99.99821%,1:0.00108%,2:0.00072%]
[INFO] ** proxy_src_ip:[18:38.00653%,20:26.13783%,13:18.27979%,6:17.57388%,17:0.00108%,21:0.00018%,16:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13711%,-0.32151:20.77055%,-1.27613:18.27943%,-0.23351:17.57334%,-0.33484:17.23598%,-71.33197:0.00108%,-0.24151:0.00036%,1.45709:0.00036%,-0.08551:0.00036%,1.46509:0.00018%,1.47576:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.13675%,1:20.77037%,5:18.27943%,4:17.57316%,2:17.2358%,0:0.00448%]
[INFO] ** service:[0.0048200000000000005:99.99821%,-211.73542999999998:0.00108%,-186.43601999999998:0.00036%,-211.08346:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.00653%,9:26.13783%,7:18.27979%,1:17.57388%,14:0.00072%,21:0.00036%,17:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1528 (0.2739%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1135 - tp: 76490.0000 - fp: 3510.0000 - tn: 316490.0000 - fn: 3510.0000 - accuracy: 0.9824 - precision: 0.9561 - recall: 0.9561 - auc: 0.9975 - val_loss: 0.0053 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1515 - tp: 75018.0000 - fp: 4982.0000 - tn: 315018.0000 - fn: 4982.0000 - accuracy: 0.9751 - precision: 0.9377 - recall: 0.9377 - auc: 0.9959 - val_loss: 0.2701 - val_tp: 16424.0000 - val_fp: 3576.0000 - val_tn: 76424.0000 - val_fn: 3576.0000 - val_accuracy: 0.9285 - val_precision: 0.8212 - val_recall: 0.8212 - val_auc: 0.9917
[INFO] saving weights to checkpoints/lstm-epoch-2-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0192 - tp: 79865.0000 - fp: 135.0000 - tn: 319865.0000 - fn: 135.0000 - accuracy: 0.9993 - precision: 0.9983 - recall: 0.9983 - auc: 1.0000 - val_loss: 0.0021 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0107 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0083 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.3564e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 10-10/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99624%,30:0.00179%,31:0.00036%,26:0.00018%,24:0.00018%,23:0.00018%,22:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:94.52391%,Single Stage Single Point:5.47609%]
[INFO] ** dst:[21:43.41181%,10:20.80586%,8:18.22565%,9:17.55273%,15:0.00179%,22:0.00054%,24:0.00036%,19:0.00036%,18:0.00036%,26:0.00018%,25:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99839%,0:0.00161%]
[INFO] ** i/f_name:[2:99.99821%,3:0.00179%]
[INFO] ** modbus_function_code:[0.02961:99.99624%,-33.760870000000004:0.00359%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99892%,11:49.99731%,0:0.00359%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99928%,1:0.00072%]
[INFO] ** proto:[0:99.99731%,1:0.00179%,2:0.0009%]
[INFO] ** proxy_src_ip:[18:38.08325%,20:26.13496%,13:18.22583%,6:17.55201%,17:0.00179%,10:0.0009%,14:0.00036%,21:0.00018%,16:0.00018%,5:0.00018%,2:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13424%,-0.32151:20.80586%,-1.27613:18.2253%,-0.23351:17.55165%,-0.33484:17.27739%,-71.33197:0.00179%,-10.51843:0.00072%,-0.08551:0.00036%,-1.27347:0.00036%,5.71692:0.00036%,1.47576:0.00036%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-71.14931:0.00018%,-64.19493:0.00018%,1.45709:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.13388%,1:20.80568%,5:18.2253%,4:17.55147%,2:17.27721%,0:0.00645%]
[INFO] ** service:[0.0048200000000000005:99.99695%,-211.73542999999998:0.00179%,-211.07873999999998:0.00036%,-186.43601999999998:0.00036%,-211.08346:0.00018%,-186.44547:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.08325%,9:26.13496%,7:18.22583%,1:17.55201%,14:0.00179%,11:0.0009%,2:0.00036%,17:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%]
[INFO] ** type:[0:99.99857%,1:0.00125%,2:0.00018%]
[INFO] ** unixtime:1524 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0065 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.0378e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0057 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5058e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4582 - tp: 64954.0000 - fp: 15046.0000 - tn: 304954.0000 - fn: 15046.0000 - accuracy: 0.9248 - precision: 0.8119 - recall: 0.8119 - auc: 0.9752 - val_loss: 0.4460 - val_tp: 13664.0000 - val_fp: 6336.0000 - val_tn: 73664.0000 - val_fn: 6336.0000 - val_accuracy: 0.8733 - val_precision: 0.6832 - val_recall: 0.6832 - val_auc: 0.9692
[INFO] saving weights to checkpoints/lstm-epoch-2-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2354 - tp: 71659.0000 - fp: 8341.0000 - tn: 311659.0000 - fn: 8341.0000 - accuracy: 0.9583 - precision: 0.8957 - recall: 0.8957 - auc: 0.9899 - val_loss: 0.0979 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0479 - tp: 79997.0000 - fp: 3.0000 - tn: 319997.0000 - fn: 3.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0109 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 11-11/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99892%,31:0.00036%,30:0.00036%,26:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.38833%,10:20.87559%,8:18.19787%,9:17.53588%,22:0.00125%,18:0.00036%,15:0.00036%,25:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99964%,3:0.00036%]
[INFO] ** modbus_function_code:[0.02961:99.99892%,-33.760870000000004:0.00108%]
[INFO] ** modbus_function_description:[7:50.00054%,11:49.99839%,0:0.00108%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99892%,2:0.00072%,1:0.00036%]
[INFO] ** proxy_src_ip:[18:38.14689%,20:26.11739%,13:18.19787%,6:17.53624%,16:0.00054%,17:0.00036%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.11685%,-0.32151:20.87559%,-1.27613:18.19769%,-0.23351:17.5357%,-0.33484:17.2713%,-0.24151:0.00054%,-1.02014:0.00054%,-0.08551:0.00036%,-71.33197:0.00036%,-71.14798:0.00018%,1.45709:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:26.11649%,1:20.87559%,5:18.19751%,4:17.53534%,2:17.27112%,0:0.00394%]
[INFO] ** service:[0.0048200000000000005:99.99892%,-211.73542999999998:0.00036%,-186.43601999999998:0.00036%,-211.08346:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.14689%,9:26.11739%,7:18.19787%,1:17.53624%,15:0.00054%,14:0.00036%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1525 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0096 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0032 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0076 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0051 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5306e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0042 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.5990e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0038 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5696e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 12-12/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99785%,30:0.00197%,9:0.00018%]
[INFO] ** classification:[normal:93.51255%,Single Stage Single Point:6.48745%]
[INFO] ** dst:[21:43.40159%,10:20.88312%,8:18.18066%,9:17.53158%,15:0.00197%,22:0.00054%,24:0.00036%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99839%,0:0.00161%]
[INFO] ** i/f_name:[2:99.99803%,3:0.00197%]
[INFO] ** modbus_function_code:[0.02961:99.99785%,-33.760870000000004:0.00215%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.99821%,0:0.00215%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99839%,2:0.00161%]
[INFO] ** proto:[0:99.99803%,1:0.00197%]
[INFO] ** proxy_src_ip:[18:38.15496%,20:26.13012%,13:18.18084%,6:17.53176%,17:0.00197%,16:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:26.12958%,-0.32151:20.88312%,-1.27613:18.1803%,-0.23351:17.5314%,-0.33484:17.27183%,-71.33197:0.00197%,-1.27347:0.00036%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:26.12922%,1:20.88312%,5:18.1803%,4:17.53104%,2:17.27183%,0:0.00448%]
[INFO] ** service:[0.0048200000000000005:99.99785%,-211.73542999999998:0.00197%,-183.8612:0.00018%]
[INFO] ** src:[22:38.15496%,9:26.13012%,7:18.18084%,1:17.53176%,21:0.00161%,14:0.00036%,15:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1525 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0039 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.1890e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0036 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0953e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4384 - tp: 68763.0000 - fp: 11237.0000 - tn: 308763.0000 - fn: 11237.0000 - accuracy: 0.9438 - precision: 0.8595 - recall: 0.8595 - auc: 0.9794 - val_loss: 0.5734 - val_tp: 12822.0000 - val_fp: 7178.0000 - val_tn: 72822.0000 - val_fn: 7178.0000 - val_accuracy: 0.8564 - val_precision: 0.6411 - val_recall: 0.6411 - val_auc: 0.9678
[INFO] saving weights to checkpoints/lstm-epoch-2-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3366 - tp: 62224.0000 - fp: 17776.0000 - tn: 302224.0000 - fn: 17776.0000 - accuracy: 0.9111 - precision: 0.7778 - recall: 0.7778 - auc: 0.9781 - val_loss: 0.1777 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0792 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.1842e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 13-13/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99659%,31:0.00072%,26:0.00054%,0:0.00054%,30:0.00036%,22:0.00036%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:86.2846%,Single Stage Single Point:13.7154%]
[INFO] ** dst:[21:43.35535%,10:20.80622%,8:18.28033%,9:17.55416%,22:0.00108%,6:0.0009%,18:0.00072%,25:0.00054%,15:0.00036%,24:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99964%,3:0.00036%]
[INFO] ** modbus_function_code:[0.02961:99.99659%,-33.760870000000004:0.00323%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99892%,11:49.99767%,0:0.00323%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99731%,2:0.00233%,1:0.00036%]
[INFO] ** proxy_src_ip:[18:38.05403%,20:26.10789%,13:18.28051%,6:17.55362%,10:0.00108%,11:0.0009%,16:0.00054%,17:0.00036%,7:0.00036%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.10735%,-0.32151:20.80622%,-1.27613:18.28015%,-0.23351:17.55327%,-0.33484:17.24781%,-9.78512:0.00072%,-64.19493:0.00054%,-1.02014:0.00054%,-71.14798:0.00054%,-0.24151:0.00036%,-71.14931:0.00036%,-0.08551:0.00036%,-71.33197:0.00036%,1.47576:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-1.2708:0.00018%,-68.79874000000001:0.00018%,6.1115699999999995:0.00018%,14.540560000000001:0.00018%,1.45709:0.00018%]
[INFO] ** scada_tag:[3:26.10699%,1:20.80604%,5:18.28015%,4:17.55327%,2:17.24763%,0:0.00592%]
[INFO] ** service:[0.0048200000000000005:99.99731%,-186.43601999999998:0.00072%,-211.08346:0.00054%,-186.44547:0.00054%,-211.73542999999998:0.00036%,-211.08818:0.00036%,-202.75898:0.00018%]
[INFO] ** src:[22:38.05403%,9:26.10789%,7:18.28051%,1:17.55362%,11:0.00108%,10:0.0009%,15:0.00054%,21:0.00036%,14:0.00036%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1525 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0123 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5754e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0111 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6784e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0093 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0071e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4035 - tp: 67145.0000 - fp: 12855.0000 - tn: 307145.0000 - fn: 12855.0000 - accuracy: 0.9357 - precision: 0.8393 - recall: 0.8393 - auc: 0.9788 - val_loss: 0.3923 - val_tp: 12833.0000 - val_fp: 7167.0000 - val_tn: 72833.0000 - val_fn: 7167.0000 - val_accuracy: 0.8567 - val_precision: 0.6417 - val_recall: 0.6417 - val_auc: 0.9679
[INFO] saving weights to checkpoints/lstm-epoch-2-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2810 - tp: 64832.0000 - fp: 15168.0000 - tn: 304832.0000 - fn: 15168.0000 - accuracy: 0.9242 - precision: 0.8104 - recall: 0.8104 - auc: 0.9801 - val_loss: 0.1799 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 14-14/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99964%,30:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:93.16856%,Single Stage Single Point:6.83144%]
[INFO] ** dst:[21:43.35086%,10:20.81303%,8:18.26151%,9:17.57316%,22:0.00072%,24:0.00036%,15:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:99.99982%,3:0.00018%]
[INFO] ** modbus_function_code:[0.02961:99.99964%,-33.760870000000004:0.00036%]
[INFO] ** modbus_function_description:[7:50.00054%,11:49.9991%,0:0.00036%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,1:0.00018%]
[INFO] ** proxy_src_ip:[18:38.05296%,20:26.11148%,13:18.26168%,6:17.57334%,17:0.00018%,16:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:26.11076%,-0.32151:20.81303%,-1.27613:18.26115%,-0.23351:17.57298%,-0.33484:17.23993%,-1.27347:0.00036%,1.45709:0.00036%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,14.4699:0.00018%,-71.33197:0.00018%]
[INFO] ** scada_tag:[3:26.1104%,1:20.81303%,5:18.26097%,4:17.57263%,2:17.23975%,0:0.00323%]
[INFO] ** service:[0.0048200000000000005:99.99964%,-183.8612:0.00018%,-211.73542999999998:0.00018%]
[INFO] ** src:[22:38.05296%,9:26.11148%,7:18.26168%,1:17.57334%,15:0.00018%,14:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1524 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1731 - tp: 77948.0000 - fp: 2052.0000 - tn: 317948.0000 - fn: 2052.0000 - accuracy: 0.9897 - precision: 0.9743 - recall: 0.9743 - auc: 0.9978 - val_loss: 0.1139 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3436 - tp: 55879.0000 - fp: 24121.0000 - tn: 295879.0000 - fn: 24121.0000 - accuracy: 0.8794 - precision: 0.6985 - recall: 0.6985 - auc: 0.9719 - val_loss: 0.1058 - val_tp: 19550.0000 - val_fp: 450.0000 - val_tn: 79550.0000 - val_fn: 450.0000 - val_accuracy: 0.9910 - val_precision: 0.9775 - val_recall: 0.9775 - val_auc: 0.9998
[INFO] saving weights to checkpoints/lstm-epoch-2-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0496 - tp: 77120.0000 - fp: 2880.0000 - tn: 317120.0000 - fn: 2880.0000 - accuracy: 0.9856 - precision: 0.9640 - recall: 0.9640 - auc: 0.9996 - val_loss: 0.0060 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0255 - tp: 79737.0000 - fp: 263.0000 - tn: 319737.0000 - fn: 263.0000 - accuracy: 0.9987 - precision: 0.9967 - recall: 0.9967 - auc: 1.0000 - val_loss: 1.9950e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8968e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 15-15/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99624%,30:0.00305%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:90.0997%,Single Stage Multi Point:9.89958%,Single Stage Single Point:0.00072%]
[INFO] ** dst:[21:43.30229%,10:20.77682%,8:18.31528%,9:17.60023%,15:0.00305%,22:0.00161%,25:0.00018%,24:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99713%,0:0.00287%]
[INFO] ** i/f_name:[2:99.99695%,3:0.00305%]
[INFO] ** modbus_function_code:[0.02961:99.99624%,-33.760870000000004:0.00376%]
[INFO] ** modbus_function_description:[7:49.9991%,11:49.99713%,0:0.00376%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99731%,2:0.00269%]
[INFO] ** proto:[0:99.99659%,1:0.00305%,2:0.00036%]
[INFO] ** proxy_src_ip:[18:38.01012%,20:26.06971%,13:18.31492%,6:17.60077%,17:0.00305%,16:0.00072%,7:0.00036%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.06881%,-0.32151:20.77664%,-1.27613:18.31474%,-0.23351:17.60005%,-0.33484:17.23347%,-71.33197:0.00305%,-1.02014:0.00072%,-0.24151:0.00054%,1.46509:0.00036%,1.45709:0.00036%,1.47576:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-61.95768:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.06845%,1:20.77646%,5:18.31474%,4:17.59969%,2:17.23329%,0:0.00735%]
[INFO] ** service:[0.0048200000000000005:99.99641%,-211.73542999999998:0.00305%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.01012%,9:26.06971%,7:18.31492%,1:17.60077%,21:0.00305%,15:0.00072%,14:0.00036%,16:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1533 (0.2748%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0188 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6201e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0179 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2961e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0162 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.3422e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0150 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2314e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.7952 - tp: 61214.0000 - fp: 18786.0000 - tn: 301214.0000 - fn: 18786.0000 - accuracy: 0.9061 - precision: 0.7652 - recall: 0.7652 - auc: 0.8522 - val_loss: 7.5199 - val_tp: 10669.0000 - val_fp: 9331.0000 - val_tn: 70669.0000 - val_fn: 9331.0000 - val_accuracy: 0.8134 - val_precision: 0.5335 - val_recall: 0.5335 - val_auc: 0.7084
[INFO] saving weights to checkpoints/lstm-epoch-2-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 16-16/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (497552, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (497552, 17)

[INFO] analyzing data
[INFO] 497552 rows
[INFO] ** appi_name:[21:99.99819%,30:0.00161%,33:0.0002%]
[INFO] ** classification:[normal:80.78191%,Single Stage Multi Point:19.21809%]
[INFO] ** dst:[21:43.35004%,10:20.79541%,8:18.25819%,9:17.59334%,15:0.00161%,22:0.00121%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.99839%,0:0.00161%]
[INFO] ** i/f_name:[2:99.99839%,3:0.00161%]
[INFO] ** modbus_function_code:[0.02961:99.99819%,-33.760870000000004:0.00181%]
[INFO] ** modbus_function_description:[7:50.0004%,11:49.99779%,0:0.00181%]
[INFO] ** modbus_transaction_id:65536 (13.17169%)
[INFO] ** orig:[0:99.99839%,2:0.00161%]
[INFO] ** proto:[0:99.99839%,1:0.00161%]
[INFO] ** proxy_src_ip:[18:38.04205%,20:26.1036%,13:18.25859%,6:17.59354%,17:0.00161%,16:0.0004%,21:0.0002%]
[INFO] ** s_port:[1.45442:26.103%,-0.32151:20.79521%,-1.27613:18.25819%,-0.23351:17.59314%,-0.33484:17.24684%,-71.33197:0.00161%,1.45709:0.0004%,-0.24151:0.0004%,-1.02014:0.0004%,-1.27347:0.0002%,1.47576:0.0002%,-49.275529999999996:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:26.1026%,1:20.79501%,5:18.25799%,4:17.59273%,2:17.24664%,0:0.00502%]
[INFO] ** service:[0.0048200000000000005:99.99839%,-211.73542999999998:0.00161%]
[INFO] ** src:[22:38.04205%,9:26.1036%,7:18.25859%,1:17.59354%,21:0.00161%,15:0.0004%,4:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1362 (0.27374%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/497552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5704 - tp: 42459.0000 - fp: 37541.0000 - tn: 282459.0000 - fn: 37541.0000 - accuracy: 0.8123 - precision: 0.5307 - recall: 0.5307 - auc: 0.7048 - val_loss: 7.5368 - val_tp: 10648.0000 - val_fp: 9352.0000 - val_tn: 70648.0000 - val_fn: 9352.0000 - val_accuracy: 0.8130 - val_precision: 0.5324 - val_recall: 0.5324 - val_auc: 0.7078
[INFO] saving weights to checkpoints/lstm-epoch-2-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/497552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5538 - tp: 42540.0000 - fp: 37460.0000 - tn: 282540.0000 - fn: 37460.0000 - accuracy: 0.8127 - precision: 0.5318 - recall: 0.5318 - auc: 0.7054 - val_loss: 7.5803 - val_tp: 10594.0000 - val_fp: 9406.0000 - val_tn: 70594.0000 - val_fn: 9406.0000 - val_accuracy: 0.8119 - val_precision: 0.5297 - val_recall: 0.5297 - val_auc: 0.7061
[INFO] saving weights to checkpoints/lstm-epoch-2-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/497552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3860 - tp: 78139.0000 - fp: 1861.0000 - tn: 318139.0000 - fn: 1861.0000 - accuracy: 0.9907 - precision: 0.9767 - recall: 0.9767 - auc: 0.9853 - val_loss: 1.7191e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/497552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0105 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4707e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/497552
[33m[INFO] loading file 17-17/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597552, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597552, 17)

[INFO] analyzing data
[INFO] 597552 rows
[INFO] ** appi_name:[21:99.99732%,7:0.0005%,26:0.00033%,0:0.00033%,33:0.00017%,31:0.00017%,27:0.00017%,24:0.00017%,22:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:94.83727%,Multi Stage Multi Point:5.16273%]
[INFO] ** dst:[21:43.35255%,10:20.83651%,8:18.2098%,9:17.5983%,22:0.00084%,6:0.0005%,25:0.00033%,16:0.00033%,2:0.00033%,24:0.00017%,18:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99732%,-33.760870000000004:0.00251%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99967%,11:49.99766%,0:0.00251%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (10.96741%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99883%,2:0.00117%]
[INFO] ** proxy_src_ip:[18:38.07736%,20:26.11237%,13:18.20929%,6:17.59813%,10:0.001%,11:0.00084%,1:0.00033%,21:0.00017%,16:0.00017%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:26.11137%,-0.32151:20.83635%,-1.27613:18.20896%,-0.23351:17.59797%,-0.33484:17.24101%,6.0369:0.00067%,1.45709:0.0005%,1.47576:0.00033%,-71.14798:0.00033%,-64.19493:0.00033%,1.46509:0.00017%,-49.275529999999996:0.00017%,-1.27347:0.00017%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,-68.79874000000001:0.00017%,6.15557:0.00017%,6.06224:0.00017%,8.55414:0.00017%,-3.3787199999999995:0.00017%,-4.3880099999999995:0.00017%,-71.14931:0.00017%]
[INFO] ** scada_tag:[3:26.1112%,1:20.83618%,5:18.20879%,4:17.59746%,2:17.24101%,0:0.00536%]
[INFO] ** service:[0.0048200000000000005:99.99816%,-211.09762999999998:0.0005%,-211.08346:0.00033%,-186.44547:0.00033%,-211.35747999999998:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.07736%,9:26.11237%,7:18.20929%,1:17.59813%,11:0.001%,10:0.00084%,3:0.00033%,21:0.00017%,15:0.00017%,4:0.00017%,2:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1632 (0.27311%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0090 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3289e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0078 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3511e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0071 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2875e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1701 - tp: 79186.0000 - fp: 814.0000 - tn: 319186.0000 - fn: 814.0000 - accuracy: 0.9959 - precision: 0.9898 - recall: 0.9898 - auc: 0.9936 - val_loss: 2.9778 - val_tp: 16305.0000 - val_fp: 3695.0000 - val_tn: 76305.0000 - val_fn: 3695.0000 - val_accuracy: 0.9261 - val_precision: 0.8152 - val_recall: 0.8152 - val_auc: 0.8845
[INFO] saving weights to checkpoints/lstm-epoch-2-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9281 - tp: 65489.0000 - fp: 14511.0000 - tn: 305489.0000 - fn: 14511.0000 - accuracy: 0.9274 - precision: 0.8186 - recall: 0.8186 - auc: 0.8859 - val_loss: 2.8988 - val_tp: 16403.0000 - val_fp: 3597.0000 - val_tn: 76403.0000 - val_fn: 3597.0000 - val_accuracy: 0.9281 - val_precision: 0.8202 - val_recall: 0.8202 - val_auc: 0.8876
[INFO] saving weights to checkpoints/lstm-epoch-2-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/597552
[33m[INFO] loading file 18-18/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597552, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597552, 17)

[INFO] analyzing data
[INFO] 597552 rows
[INFO] ** appi_name:[21:99.99833%,30:0.0005%,7:0.0005%,31:0.00017%,27:0.00017%,22:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:82.38965%,Multi Stage Multi Point:17.61035%]
[INFO] ** dst:[21:43.34234%,10:20.83233%,8:18.25314%,9:17.56952%,22:0.00067%,15:0.0005%,24:0.00033%,16:0.00033%,2:0.00033%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.9995%,0:0.0005%]
[INFO] ** i/f_name:[2:99.9995%,3:0.0005%]
[INFO] ** modbus_function_code:[0.02961:99.99833%,-33.760870000000004:0.00167%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99833%,0:0.00167%]
[INFO] ** modbus_transaction_id:65536 (10.96741%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.999%,2:0.0005%,1:0.0005%]
[INFO] ** proxy_src_ip:[18:38.0797%,20:26.09547%,13:18.25347%,6:17.56968%,17:0.0005%,11:0.0005%,1:0.00033%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:26.0948%,-0.32151:20.83233%,-1.27613:18.25297%,-0.23351:17.56935%,-0.33484:17.24737%,-71.33197:0.0005%,-1.27347:0.00033%,1.45709:0.00033%,-0.24151:0.00033%,1.47576:0.00017%,1.46509:0.00017%,3.6236699999999997:0.00017%,-1.2708:0.00017%,-2.48275:0.00017%,6.06224:0.00017%,-3.3787199999999995:0.00017%,8.10082:0.00017%,6.45955:0.00017%,-71.14931:0.00017%]
[INFO] ** scada_tag:[3:26.09447%,1:20.83216%,5:18.2528%,4:17.56918%,2:17.2472%,0:0.00418%]
[INFO] ** service:[0.0048200000000000005:99.99833%,-211.09762999999998:0.0005%,-211.73542999999998:0.0005%,-211.35747999999998:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.0797%,9:26.09547%,7:18.25347%,1:17.56968%,14:0.0005%,10:0.0005%,3:0.00033%,21:0.00017%,2:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1632 (0.27311%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.6632 - tp: 71767.0000 - fp: 8233.0000 - tn: 311767.0000 - fn: 8233.0000 - accuracy: 0.9588 - precision: 0.8971 - recall: 0.8971 - auc: 0.9353 - val_loss: 1.1993e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 3s - loss: 4.8142 - tp: 56121.0000 - fp: 23879.0000 - tn: 296121.0000 - fn: 23879.0000 - accuracy: 0.8806 - precision: 0.7015 - recall: 0.7015 - auc: 0.8123 - val_loss: 6.1080 - val_tp: 12421.0000 - val_fp: 7579.0000 - val_tn: 72421.0000 - val_fn: 7579.0000 - val_accuracy: 0.8484 - val_precision: 0.6211 - val_recall: 0.6211 - val_auc: 0.7632
[INFO] saving weights to checkpoints/lstm-epoch-2-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1409 - tp: 49533.0000 - fp: 30467.0000 - tn: 289533.0000 - fn: 30467.0000 - accuracy: 0.8477 - precision: 0.6192 - recall: 0.6192 - auc: 0.7605 - val_loss: 6.1329 - val_tp: 12390.0000 - val_fp: 7610.0000 - val_tn: 72390.0000 - val_fn: 7610.0000 - val_accuracy: 0.8478 - val_precision: 0.6195 - val_recall: 0.6195 - val_auc: 0.7622
[INFO] saving weights to checkpoints/lstm-epoch-2-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.5356 - tp: 52536.0000 - fp: 27464.0000 - tn: 292536.0000 - fn: 27464.0000 - accuracy: 0.8627 - precision: 0.6567 - recall: 0.6567 - auc: 0.7840 - val_loss: 1.1938e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0032 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1934e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/597552
[33m[INFO] loading file 19-19/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597552, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597552, 17)

[INFO] analyzing data
[INFO] 597552 rows
[INFO] ** appi_name:[21:99.99816%,26:0.00033%,0:0.00033%,31:0.00017%,27:0.00017%,24:0.00017%,22:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:88.02447%,Single Stage Multi Point:11.97553%]
[INFO] ** dst:[21:43.39037%,10:20.83233%,8:18.20411%,9:17.57069%,22:0.00117%,6:0.0005%,25:0.00033%,24:0.00017%,18:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99816%,-33.760870000000004:0.00167%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99816%,0:0.00167%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (10.96741%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99883%,2:0.00117%]
[INFO] ** proxy_src_ip:[18:38.1217%,20:26.10116%,13:18.20411%,6:17.57069%,10:0.001%,11:0.00084%,16:0.0005%]
[INFO] ** s_port:[1.45442:26.10016%,-0.32151:20.83233%,-1.27613:18.20377%,-0.23351:17.57052%,-0.33484:17.28937%,-5.20264:0.00067%,1.45709:0.0005%,-1.02014:0.0005%,-64.19493:0.00033%,-71.14798:0.00033%,1.46509:0.00033%,-1.27347:0.00017%,-0.24151:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,-71.14931:0.00017%,-68.79874000000001:0.00017%,0.75578:0.00017%]
[INFO] ** scada_tag:[3:26.09982%,1:20.83216%,5:18.2036%,4:17.57035%,2:17.28921%,0:0.00485%]
[INFO] ** service:[0.0048200000000000005:99.99883%,-211.08346:0.00033%,-186.44547:0.00033%,-202.75898:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.1217%,9:26.10116%,7:18.20411%,1:17.57069%,11:0.001%,10:0.00084%,15:0.0005%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1634 (0.27345%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0028 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0024 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0023 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0018 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.3229 - tp: 43658.0000 - fp: 36342.0000 - tn: 283658.0000 - fn: 36342.0000 - accuracy: 0.8183 - precision: 0.5457 - recall: 0.5457 - auc: 0.7143 - val_loss: 9.8232 - val_tp: 7811.0000 - val_fp: 12189.0000 - val_tn: 67811.0000 - val_fn: 12189.0000 - val_accuracy: 0.7562 - val_precision: 0.3905 - val_recall: 0.3905 - val_auc: 0.6191
[INFO] saving weights to checkpoints/lstm-epoch-2-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/597552
[33m[INFO] loading file 20-20/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597552, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597552, 17)

[INFO] analyzing data
[INFO] 597552 rows
[INFO] ** appi_name:[21:99.99682%,30:0.00268%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:89.2883%,Single Stage Multi Point:10.7117%]
[INFO] ** dst:[21:43.42735%,10:20.8345%,8:18.15407%,9:17.57939%,15:0.00268%,22:0.00117%,24:0.00033%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99766%,0:0.00234%]
[INFO] ** i/f_name:[2:99.99732%,3:0.00268%]
[INFO] ** modbus_function_code:[0.02961:99.99682%,-33.760870000000004:0.00318%]
[INFO] ** modbus_function_description:[7:49.99967%,11:49.99716%,0:0.00318%]
[INFO] ** modbus_transaction_id:65536 (10.96741%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99682%,1:0.00268%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.11233%,20:26.15019%,13:18.15424%,6:17.57989%,17:0.00268%,14:0.0005%,16:0.00017%]
[INFO] ** s_port:[1.45442:26.14936%,-0.32151:20.8345%,-1.27613:18.15373%,-0.23351:17.57922%,-0.33484:17.27783%,-71.33197:0.00268%,1.45709:0.0005%,-0.24151:0.0005%,-1.27347:0.00033%,13.431270000000001:0.00017%,-1.2708:0.00017%,-1.02014:0.00017%,-71.14798:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:26.14885%,1:20.83434%,5:18.15373%,4:17.57889%,2:17.27766%,0:0.00653%]
[INFO] ** service:[0.0048200000000000005:99.99682%,-211.73542999999998:0.00268%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.11233%,9:26.15019%,7:18.15424%,1:17.57989%,14:0.00268%,2:0.0005%,15:0.00017%]
[INFO] ** type:[0:99.99967%,1:0.00033%]
[INFO] ** unixtime:1634 (0.27345%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.6409 - tp: 56971.0000 - fp: 23029.0000 - tn: 296971.0000 - fn: 23029.0000 - accuracy: 0.8849 - precision: 0.7121 - recall: 0.7121 - auc: 0.8190 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.9091 - tp: 75494.0000 - fp: 4506.0000 - tn: 315494.0000 - fn: 4506.0000 - accuracy: 0.9775 - precision: 0.9437 - recall: 0.9437 - auc: 0.9646 - val_loss: 2.9681 - val_tp: 16317.0000 - val_fp: 3683.0000 - val_tn: 76317.0000 - val_fn: 3683.0000 - val_accuracy: 0.9263 - val_precision: 0.8159 - val_recall: 0.8159 - val_auc: 0.8849
[INFO] saving weights to checkpoints/lstm-epoch-2-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9417 - tp: 65404.0000 - fp: 14596.0000 - tn: 305404.0000 - fn: 14596.0000 - accuracy: 0.9270 - precision: 0.8176 - recall: 0.8176 - auc: 0.8853 - val_loss: 2.9690 - val_tp: 16316.0000 - val_fp: 3684.0000 - val_tn: 76316.0000 - val_fn: 3684.0000 - val_accuracy: 0.9263 - val_precision: 0.8158 - val_recall: 0.8158 - val_auc: 0.8849
[INFO] saving weights to checkpoints/lstm-epoch-2-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9254 - tp: 65479.0000 - fp: 14521.0000 - tn: 305479.0000 - fn: 14521.0000 - accuracy: 0.9274 - precision: 0.8185 - recall: 0.8185 - auc: 0.8859 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.0259e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/597552
[33m[INFO] loading file 21-21/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597550, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597550, 17)

[INFO] analyzing data
[INFO] 597550 rows
[INFO] ** appi_name:[21:99.99632%,30:0.001%,7:0.0005%,26:0.00033%,22:0.00033%,0:0.00033%,31:0.00017%,27:0.00017%,24:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:98.97866%,Multi Stage Single Point:1.02134%]
[INFO] ** dst:[21:43.32809%,10:20.9723%,8:18.16199%,9:17.53309%,15:0.001%,22:0.00084%,24:0.00067%,6:0.00067%,25:0.00033%,16:0.00033%,2:0.00033%,18:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.999%,0:0.001%]
[INFO] ** i/f_name:[2:99.999%,3:0.001%]
[INFO] ** modbus_function_code:[0.02961:99.99632%,-33.760870000000004:0.00351%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99916%,11:49.99716%,0:0.00351%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (10.96745%)
[INFO] ** orig:[0:99.99933%,2:0.00067%]
[INFO] ** proto:[0:99.99766%,2:0.00134%,1:0.001%]
[INFO] ** proxy_src_ip:[18:38.30223%,20:25.99799%,13:18.16266%,6:17.53293%,17:0.001%,10:0.001%,11:0.00084%,16:0.0005%,1:0.00033%,21:0.00017%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.99732%,-0.32151:20.97163%,-1.27613:18.16183%,-0.23351:17.53276%,-0.33484:17.3306%,-71.33197:0.001%,-1.27347:0.00067%,-6.64392:0.00067%,-1.02014:0.0005%,-64.19493:0.00033%,-71.14931:0.00033%,-71.14798:0.00033%,1.47576:0.00033%,1.46509:0.00017%,-1.2708:0.00017%,6.62488:0.00017%,10.15141:0.00017%,-68.79874000000001:0.00017%,7.060860000000001:0.00017%,-3.3787199999999995:0.00017%,-2.2440900000000004:0.00017%,1.45709:0.00017%,-0.24151:0.00017%]
[INFO] ** scada_tag:[3:25.99682%,1:20.9713%,5:18.16166%,4:17.53242%,2:17.3306%,0:0.0072%]
[INFO] ** service:[0.0048200000000000005:99.99699%,-211.73542999999998:0.001%,-211.09762999999998:0.0005%,-211.08346:0.00033%,-186.44547:0.00033%,-211.08818:0.00033%,-211.35747999999998:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.30223%,9:25.99799%,7:18.16266%,1:17.53293%,11:0.001%,21:0.00084%,10:0.00084%,15:0.0005%,14:0.00033%,3:0.00033%,4:0.00017%,2:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1628 (0.27245%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597550
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.2582e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/597550
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.8026e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/597550
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.0789e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/597550
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.9902e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/597550
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.5362e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/597550
[33m[INFO] loading file 22-22/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (366591, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (366591, 17)

[INFO] analyzing data
[INFO] 366591 rows
[INFO] ** appi_name:[21:99.99291%,30:0.00627%,23:0.00027%,22:0.00027%,18:0.00027%]
[INFO] ** classification:[normal:63.84199%,Multi Stage Single Point:36.15801%]
[INFO] ** dst:[21:43.31912%,10:21.00679%,8:18.1011%,9:17.56481%,15:0.00627%,22:0.00109%,19:0.00055%,26:0.00027%]
[INFO] ** i/f_dir:[1:99.994%,0:0.006%]
[INFO] ** i/f_name:[2:99.99373%,3:0.006%,0:0.00027%]
[INFO] ** modbus_function_code:[0.02961:99.99291%,-33.760870000000004:0.00709%]
[INFO] ** modbus_function_description:[7:49.99714%,11:49.99577%,0:0.00709%]
[INFO] ** modbus_transaction_id:65534 (17.8766%)
[INFO] ** orig:[0:99.99509%,2:0.00436%,1:0.00055%]
[INFO] ** proto:[0:99.99345%,1:0.00627%,2:0.00027%]
[INFO] ** proxy_src_ip:[18:38.33018%,20:25.99655%,13:18.10055%,6:17.56562%,17:0.00627%,14:0.00055%,10:0.00027%]
[INFO] ** s_port:[1.45442:25.99573%,-0.32151:21.00679%,-1.27613:18.10055%,-0.23351:17.56481%,-0.33484:17.32339%,-71.33197:0.00627%,1.45709:0.00055%,-0.24151:0.00055%,7.228860000000001:0.00055%,-0.24950999999999998:0.00027%,1.46509:0.00027%,-71.14931:0.00027%]
[INFO] ** scada_tag:[3:25.99546%,1:21.00679%,5:18.10055%,4:17.56453%,2:17.32339%,0:0.00927%]
[INFO] ** service:[0.0048200000000000005:99.99291%,-211.73542999999998:0.00627%,-211.07873999999998:0.00055%,-211.08818:0.00027%]
[INFO] ** src:[22:38.33018%,9:25.99655%,7:18.10055%,1:17.56562%,21:0.00436%,14:0.00191%,2:0.00055%,11:0.00027%]
[INFO] ** type:[0:99.99836%,1:0.00164%]
[INFO] ** unixtime:1012 (0.27606%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/366591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.9154e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.8380 - val_tp: 12756.0000 - val_fp: 7244.0000 - val_tn: 72756.0000 - val_fn: 7244.0000 - val_accuracy: 0.8551 - val_precision: 0.6378 - val_recall: 0.6378 - val_auc: 0.7736
[INFO] saving weights to checkpoints/lstm-epoch-2-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/366591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5676 - tp: 42440.0000 - fp: 37560.0000 - tn: 282440.0000 - fn: 37560.0000 - accuracy: 0.8122 - precision: 0.5305 - recall: 0.5305 - auc: 0.7048 - val_loss: 7.5763 - val_tp: 10599.0000 - val_fp: 9401.0000 - val_tn: 70599.0000 - val_fn: 9401.0000 - val_accuracy: 0.8120 - val_precision: 0.5300 - val_recall: 0.5300 - val_auc: 0.7062
[INFO] saving weights to checkpoints/lstm-epoch-2-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/366591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5919 - tp: 42319.0000 - fp: 37681.0000 - tn: 282319.0000 - fn: 37681.0000 - accuracy: 0.8116 - precision: 0.5290 - recall: 0.5290 - auc: 0.7038 - val_loss: 7.5763 - val_tp: 10599.0000 - val_fp: 9401.0000 - val_tn: 70599.0000 - val_fn: 9401.0000 - val_accuracy: 0.8120 - val_precision: 0.5300 - val_recall: 0.5300 - val_auc: 0.7062
[INFO] saving weights to checkpoints/lstm-epoch-2-files-21-22-batch-200000-300000
[INFO] processing batch 300000-400000/366591
[33m[INFO] loading file 23-23/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (566591, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (566591, 17)

[INFO] analyzing data
[INFO] 566591 rows
[INFO] ** appi_name:[21:99.99859%,30:0.00071%,31:0.00035%,33:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:92.88711%,Multi Stage Single Point:7.11289%]
[INFO] ** dst:[21:43.31978%,10:21.00104%,8:18.14342%,9:17.53311%,22:0.00106%,15:0.00071%,24:0.00035%,18:0.00035%,25:0.00018%]
[INFO] ** i/f_dir:[1:99.99929%,0:0.00071%]
[INFO] ** i/f_name:[2:99.99929%,3:0.00071%]
[INFO] ** modbus_function_code:[0.02961:99.99859%,-33.760870000000004:0.00141%]
[INFO] ** modbus_function_description:[7:50.00026%,11:49.99832%,0:0.00141%]
[INFO] ** modbus_transaction_id:65536 (11.56672%)
[INFO] ** orig:[0:99.99947%,2:0.00053%]
[INFO] ** proto:[0:99.99876%,1:0.00071%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.33541%,20:25.98594%,13:18.14342%,6:17.53328%,17:0.00071%,16:0.00053%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.98506%,-0.32151:21.00086%,-1.27613:18.14289%,-0.23351:17.53293%,-0.33484:17.33455%,-71.33197:0.00071%,-1.02014:0.00053%,-0.08551:0.00035%,-1.27347:0.00035%,1.45709:0.00035%,1.46509:0.00035%,-0.24151:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%,-0.24950999999999998:0.00018%,-49.275529999999996:0.00018%]
[INFO] ** scada_tag:[3:25.98471%,1:21.00086%,5:18.14272%,4:17.53275%,2:17.33437%,0:0.00459%]
[INFO] ** service:[0.0048200000000000005:99.99876%,-211.73542999999998:0.00071%,-186.43601999999998:0.00035%,-186.44547:0.00018%]
[INFO] ** src:[22:38.33541%,9:25.98594%,7:18.14342%,1:17.53328%,21:0.00053%,15:0.00053%,17:0.00018%,14:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1543 (0.27233%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5686 - tp: 42434.0000 - fp: 37566.0000 - tn: 282434.0000 - fn: 37566.0000 - accuracy: 0.8122 - precision: 0.5304 - recall: 0.5304 - auc: 0.7047 - val_loss: 2.2050 - val_tp: 17264.0000 - val_fp: 2736.0000 - val_tn: 77264.0000 - val_fn: 2736.0000 - val_accuracy: 0.9453 - val_precision: 0.8632 - val_recall: 0.8632 - val_auc: 0.9145
[INFO] saving weights to checkpoints/lstm-epoch-2-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.7357e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.4126e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.1884e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.5083e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/566591
[33m[INFO] loading file 24-24/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (566591, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (566591, 17)

[INFO] analyzing data
[INFO] 566591 rows
[INFO] ** appi_name:[21:99.99347%,30:0.00318%,26:0.00053%,31:0.00035%,27:0.00035%,22:0.00035%,0:0.00035%,24:0.00018%,23:0.00018%,19:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,11:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:95.50293%,Multi Stage Single Point:4.49707%]
[INFO] ** dst:[21:43.37079%,10:21.01781%,8:18.09648%,9:17.50804%,15:0.00318%,22:0.00106%,6:0.00071%,25:0.00035%,24:0.00035%,19:0.00035%,18:0.00035%,7:0.00035%,26:0.00018%]
[INFO] ** i/f_dir:[1:99.997%,0:0.003%]
[INFO] ** i/f_name:[2:99.99682%,3:0.00318%]
[INFO] ** modbus_function_code:[0.02961:99.99347%,-33.760870000000004:0.006%,-0.415:0.00018%,0.9188299999999999:0.00018%,0.47422:0.00018%]
[INFO] ** modbus_function_description:[7:49.99779%,11:49.99568%,0:0.006%,15:0.00018%,10:0.00018%,2:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.56672%)
[INFO] ** orig:[0:99.99965%,1:0.00035%]
[INFO] ** proto:[0:99.99488%,1:0.00318%,2:0.00194%]
[INFO] ** proxy_src_ip:[18:38.40319%,20:25.98629%,13:18.0963%,6:17.50734%,17:0.00318%,10:0.00124%,14:0.00088%,11:0.00088%,21:0.00035%,16:0.00035%]
[INFO] ** s_port:[1.45442:25.98541%,-0.32151:21.01781%,-1.27613:18.09595%,-0.23351:17.50663%,-0.33484:17.38538%,-71.33197:0.00318%,-9.58113:0.00071%,-71.14798:0.00053%,-0.24950999999999998:0.00035%,-1.27347:0.00035%,1.45709:0.00035%,-0.24151:0.00035%,-1.02014:0.00035%,-31.55091:0.00035%,7.6315100000000005:0.00035%,-71.14931:0.00035%,-64.19493:0.00035%,1.47576:0.00035%,-68.79874000000001:0.00018%,1.46509:0.00018%,7.4901800000000005:0.00018%,13.431270000000001:0.00018%,11.862:0.00018%]
[INFO] ** scada_tag:[3:25.98523%,1:21.01781%,5:18.09577%,4:17.50628%,2:17.3852%,0:0.00971%]
[INFO] ** service:[0.0048200000000000005:99.99453%,-211.73542999999998:0.00318%,-211.08346:0.00053%,-211.07873999999998:0.00035%,-202.75898:0.00035%,-186.44547:0.00035%,-186.43601999999998:0.00035%,-211.08818:0.00035%]
[INFO] ** src:[22:38.40319%,9:25.98629%,7:18.0963%,1:17.50734%,14:0.00318%,11:0.00124%,10:0.00088%,2:0.00088%,15:0.00035%,4:0.00035%]
[INFO] ** type:[0:99.99876%,1:0.00088%,2:0.00035%]
[INFO] ** unixtime:1539 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.6473e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.4399e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2104e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.5431e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.5484e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4716 - val_tp: 18174.0000 - val_fp: 1826.0000 - val_tn: 78174.0000 - val_fn: 1826.0000 - val_accuracy: 0.9635 - val_precision: 0.9087 - val_recall: 0.9087 - val_auc: 0.9429
[INFO] saving weights to checkpoints/lstm-epoch-2-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/566591
[33m[INFO] loading file 25-25/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (566591, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (566591, 17)

[INFO] analyzing data
[INFO] 566591 rows
[INFO] ** appi_name:[21:99.99647%,30:0.00106%,17:0.00071%,22:0.00053%,31:0.00035%,28:0.00018%,26:0.00018%,12:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** classification:[normal:64.35118%,Multi Stage Single Point:35.64882%]
[INFO] ** dst:[21:43.32102%,10:21.02593%,8:18.13389%,9:17.51493%,15:0.00106%,22:0.00088%,16:0.00071%,6:0.00071%,18:0.00035%,17:0.00035%,24:0.00018%]
[INFO] ** i/f_dir:[1:99.99894%,0:0.00106%]
[INFO] ** i/f_name:[2:99.99894%,3:0.00106%]
[INFO] ** modbus_function_code:[0.02961:99.99647%,-33.760870000000004:0.00353%]
[INFO] ** modbus_function_description:[7:49.99903%,11:49.99744%,0:0.00353%]
[INFO] ** modbus_transaction_id:65536 (11.56672%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99788%,2:0.00106%,1:0.00106%]
[INFO] ** proxy_src_ip:[18:38.38924%,20:25.95752%,13:18.13389%,6:17.51546%,17:0.00106%,1:0.00088%,21:0.00071%,16:0.00035%,14:0.00035%,7:0.00035%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95717%,-0.32151:21.02557%,-1.27613:18.13354%,-0.23351:17.51493%,-0.33484:17.36367%,-71.33197:0.00106%,-71.14931:0.00053%,-0.24151:0.00035%,-1.02014:0.00035%,-49.275529999999996:0.00035%,1.46509:0.00018%,-5.1466400000000005:0.00018%,-1.27347:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,-0.24950999999999998:0.00018%,2.52505:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,6.1115699999999995:0.00018%,-5.08665:0.00018%,1.45709:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:25.95682%,1:21.0254%,5:18.13336%,4:17.51475%,2:17.3635%,0:0.00618%]
[INFO] ** service:[0.0048200000000000005:99.99682%,-211.73542999999998:0.00106%,-205.44247:0.00071%,-211.08818:0.00053%,-186.43601999999998:0.00035%,-211.09762999999998:0.00018%,-211.08346:0.00018%,-185.9872:0.00018%]
[INFO] ** src:[22:38.38924%,9:25.95752%,7:18.13389%,1:17.51546%,14:0.00106%,3:0.00088%,4:0.00071%,21:0.00035%,15:0.00035%,2:0.00035%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1539 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7331 - tp: 51545.0000 - fp: 28455.0000 - tn: 291545.0000 - fn: 28455.0000 - accuracy: 0.8577 - precision: 0.6443 - recall: 0.6443 - auc: 0.7777 - val_loss: 5.7429 - val_tp: 12874.0000 - val_fp: 7126.0000 - val_tn: 72874.0000 - val_fn: 7126.0000 - val_accuracy: 0.8575 - val_precision: 0.6437 - val_recall: 0.6437 - val_auc: 0.7773
[INFO] saving weights to checkpoints/lstm-epoch-2-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7552 - tp: 51435.0000 - fp: 28565.0000 - tn: 291435.0000 - fn: 28565.0000 - accuracy: 0.8572 - precision: 0.6429 - recall: 0.6429 - auc: 0.7768 - val_loss: 5.7566 - val_tp: 12857.0000 - val_fp: 7143.0000 - val_tn: 72857.0000 - val_fn: 7143.0000 - val_accuracy: 0.8571 - val_precision: 0.6428 - val_recall: 0.6428 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-2-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7463 - tp: 51479.0000 - fp: 28521.0000 - tn: 291479.0000 - fn: 28521.0000 - accuracy: 0.8574 - precision: 0.6435 - recall: 0.6435 - auc: 0.7772 - val_loss: 5.7276 - val_tp: 12893.0000 - val_fp: 7107.0000 - val_tn: 72893.0000 - val_fn: 7107.0000 - val_accuracy: 0.8579 - val_precision: 0.6446 - val_recall: 0.6446 - val_auc: 0.7779
[INFO] saving weights to checkpoints/lstm-epoch-2-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7498 - tp: 51462.0000 - fp: 28538.0000 - tn: 291462.0000 - fn: 28538.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.7770 - val_loss: 5.7324 - val_tp: 12887.0000 - val_fp: 7113.0000 - val_tn: 72887.0000 - val_fn: 7113.0000 - val_accuracy: 0.8577 - val_precision: 0.6443 - val_recall: 0.6443 - val_auc: 0.7777
[INFO] saving weights to checkpoints/lstm-epoch-2-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7594 - tp: 51414.0000 - fp: 28586.0000 - tn: 291414.0000 - fn: 28586.0000 - accuracy: 0.8571 - precision: 0.6427 - recall: 0.6427 - auc: 0.7767 - val_loss: 5.7195 - val_tp: 12903.0000 - val_fp: 7097.0000 - val_tn: 72903.0000 - val_fn: 7097.0000 - val_accuracy: 0.8581 - val_precision: 0.6452 - val_recall: 0.6452 - val_auc: 0.7782
[INFO] saving weights to checkpoints/lstm-epoch-2-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/566591
[33m[INFO] loading file 26-26/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (566591, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (566591, 17)

[INFO] analyzing data
[INFO] 566591 rows
[INFO] ** appi_name:[21:99.99824%,30:0.00053%,7:0.00053%,31:0.00018%,22:0.00018%,12:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:64.39707%,Single Stage Single Point:28.18823%,Multi Stage Single Point:7.4147%]
[INFO] ** dst:[21:43.30884%,10:21.08593%,8:18.12189%,9:17.48069%,22:0.00071%,15:0.00053%,24:0.00035%,16:0.00035%,2:0.00035%,18:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99947%,0:0.00053%]
[INFO] ** i/f_name:[2:99.99947%,3:0.00053%]
[INFO] ** modbus_function_code:[0.02961:99.99824%,-33.760870000000004:0.00176%]
[INFO] ** modbus_function_description:[7:49.99974%,11:49.9985%,0:0.00176%]
[INFO] ** modbus_transaction_id:65536 (11.56672%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99912%,1:0.00053%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.46337%,20:25.93158%,13:18.12224%,6:17.48069%,17:0.00053%,1:0.00053%,21:0.00035%,16:0.00035%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.93105%,-0.32151:21.08576%,-1.27613:18.12171%,-0.23351:17.48051%,-0.33484:17.37761%,-71.33197:0.00053%,-1.02014:0.00035%,-1.27347:0.00035%,-49.275529999999996:0.00018%,1.47576:0.00018%,1.45709:0.00018%,1.46509:0.00018%,-1.2708:0.00018%,14.191239999999999:0.00018%,2.52505:0.00018%,-3.3787199999999995:0.00018%,11.57001:0.00018%,-71.14931:0.00018%,7.66617:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.9307%,1:21.08576%,5:18.12154%,4:17.48033%,2:17.37761%,0:0.00406%]
[INFO] ** service:[0.0048200000000000005:99.99841%,-211.09762999999998:0.00053%,-211.73542999999998:0.00053%,-211.35747999999998:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.46337%,9:25.93158%,7:18.12224%,1:17.48069%,14:0.00053%,3:0.00053%,15:0.00035%,4:0.00035%,21:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1538 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7425 - tp: 51498.0000 - fp: 28502.0000 - tn: 291498.0000 - fn: 28502.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.7773 - val_loss: 5.7550 - val_tp: 12859.0000 - val_fp: 7141.0000 - val_tn: 72859.0000 - val_fn: 7141.0000 - val_accuracy: 0.8572 - val_precision: 0.6429 - val_recall: 0.6429 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-2-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9337 - tp: 51613.0000 - fp: 28387.0000 - tn: 291613.0000 - fn: 28387.0000 - accuracy: 0.8581 - precision: 0.6452 - recall: 0.6452 - auc: 0.8496 - val_loss: 1.6340 - val_tp: 12852.0000 - val_fp: 7148.0000 - val_tn: 72852.0000 - val_fn: 7148.0000 - val_accuracy: 0.8570 - val_precision: 0.6426 - val_recall: 0.6426 - val_auc: 0.9577
[INFO] saving weights to checkpoints/lstm-epoch-2-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.4362 - tp: 51473.0000 - fp: 28527.0000 - tn: 291473.0000 - fn: 28527.0000 - accuracy: 0.8574 - precision: 0.6434 - recall: 0.6434 - auc: 0.9446 - val_loss: 1.2677 - val_tp: 12863.0000 - val_fp: 7137.0000 - val_tn: 72863.0000 - val_fn: 7137.0000 - val_accuracy: 0.8573 - val_precision: 0.6431 - val_recall: 0.6431 - val_auc: 0.9475
[INFO] saving weights to checkpoints/lstm-epoch-2-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.1322 - tp: 51574.0000 - fp: 28426.0000 - tn: 291574.0000 - fn: 28426.0000 - accuracy: 0.8579 - precision: 0.6447 - recall: 0.6447 - auc: 0.9484 - val_loss: 1.0167 - val_tp: 12836.0000 - val_fp: 7164.0000 - val_tn: 72836.0000 - val_fn: 7164.0000 - val_accuracy: 0.8567 - val_precision: 0.6418 - val_recall: 0.6418 - val_auc: 0.9670
[INFO] saving weights to checkpoints/lstm-epoch-2-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8950 - tp: 51541.0000 - fp: 28459.0000 - tn: 291541.0000 - fn: 28459.0000 - accuracy: 0.8577 - precision: 0.6443 - recall: 0.6443 - auc: 0.9649 - val_loss: 0.7862 - val_tp: 12852.0000 - val_fp: 7148.0000 - val_tn: 72852.0000 - val_fn: 7148.0000 - val_accuracy: 0.8570 - val_precision: 0.6426 - val_recall: 0.6426 - val_auc: 0.9681
[INFO] saving weights to checkpoints/lstm-epoch-2-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/566591
[33m[INFO] loading file 27-27/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (506721, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (506721, 17)

[INFO] analyzing data
[INFO] 506721 rows
[INFO] ** appi_name:[21:99.99941%,30:0.00059%]
[INFO] ** classification:[normal:64.35849%,Single Stage Single Point:35.64151%]
[INFO] ** dst:[21:43.28773%,10:21.06899%,8:18.17154%,9:17.47017%,22:0.00079%,15:0.00059%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.9998%,0:0.0002%]
[INFO] ** i/f_name:[2:99.99941%,3:0.00059%]
[INFO] ** modbus_function_code:[0.02961:99.99941%,-33.760870000000004:0.00059%]
[INFO] ** modbus_function_description:[7:50.0003%,11:49.99911%,0:0.00059%]
[INFO] ** modbus_transaction_id:65536 (12.93335%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99941%,1:0.00059%]
[INFO] ** proxy_src_ip:[18:38.42627%,20:25.93104%,13:18.17134%,6:17.47036%,17:0.00059%,16:0.00039%]
[INFO] ** s_port:[1.45442:25.93044%,-0.32151:21.06899%,-1.27613:18.17114%,-0.23351:17.46997%,-0.33484:17.35728%,-71.33197:0.00059%,-1.02014:0.00039%,-1.27347:0.0002%,1.45709:0.0002%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-0.24151:0.0002%]
[INFO] ** scada_tag:[3:25.93005%,1:21.06879%,5:18.17095%,4:17.46977%,2:17.35709%,0:0.00335%]
[INFO] ** service:[0.0048200000000000005:99.99941%,-211.73542999999998:0.00059%]
[INFO] ** src:[22:38.42627%,9:25.93104%,7:18.17134%,1:17.47036%,14:0.00059%,15:0.00039%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1376 (0.27155%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/506721
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6977 - tp: 51539.0000 - fp: 28461.0000 - tn: 291539.0000 - fn: 28461.0000 - accuracy: 0.8577 - precision: 0.6442 - recall: 0.6442 - auc: 0.9663 - val_loss: 0.6093 - val_tp: 12844.0000 - val_fp: 7156.0000 - val_tn: 72844.0000 - val_fn: 7156.0000 - val_accuracy: 0.8569 - val_precision: 0.6422 - val_recall: 0.6422 - val_auc: 0.9680
[INFO] saving weights to checkpoints/lstm-epoch-2-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/506721
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5410 - tp: 51457.0000 - fp: 28543.0000 - tn: 291457.0000 - fn: 28543.0000 - accuracy: 0.8573 - precision: 0.6432 - recall: 0.6432 - auc: 0.9663 - val_loss: 0.4656 - val_tp: 12868.0000 - val_fp: 7132.0000 - val_tn: 72868.0000 - val_fn: 7132.0000 - val_accuracy: 0.8574 - val_precision: 0.6434 - val_recall: 0.6434 - val_auc: 0.9682
[INFO] saving weights to checkpoints/lstm-epoch-2-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/506721
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4153 - tp: 51586.0000 - fp: 28414.0000 - tn: 291586.0000 - fn: 28414.0000 - accuracy: 0.8579 - precision: 0.6448 - recall: 0.6448 - auc: 0.9667 - val_loss: 0.3549 - val_tp: 12895.0000 - val_fp: 7105.0000 - val_tn: 72895.0000 - val_fn: 7105.0000 - val_accuracy: 0.8579 - val_precision: 0.6447 - val_recall: 0.6447 - val_auc: 0.9684
[INFO] saving weights to checkpoints/lstm-epoch-2-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/506721
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3254 - tp: 51406.0000 - fp: 28594.0000 - tn: 291406.0000 - fn: 28594.0000 - accuracy: 0.8570 - precision: 0.6426 - recall: 0.6426 - auc: 0.9662 - val_loss: 0.2737 - val_tp: 12868.0000 - val_fp: 7132.0000 - val_tn: 72868.0000 - val_fn: 7132.0000 - val_accuracy: 0.8574 - val_precision: 0.6434 - val_recall: 0.6434 - val_auc: 0.9682
[INFO] saving weights to checkpoints/lstm-epoch-2-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/506721
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2572 - tp: 67514.0000 - fp: 12486.0000 - tn: 307514.0000 - fn: 12486.0000 - accuracy: 0.9376 - precision: 0.8439 - recall: 0.8439 - auc: 0.9875 - val_loss: 0.2152 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-26-27-batch-400000-500000
[INFO] processing batch 500000-600000/506721
[33m[INFO] loading file 28-28/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (340637, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (340637, 17)

[INFO] analyzing data
[INFO] 340637 rows
[INFO] ** appi_name:[21:99.99149%,30:0.00176%,17:0.00147%,22:0.00117%,7:0.00117%,31:0.00088%,26:0.00088%,28:0.00029%,27:0.00029%,8:0.00029%,0:0.00029%]
[INFO] ** classification:[normal:64.31421%,Single Stage Single Point:35.68579%]
[INFO] ** dst:[21:43.28714%,10:21.01856%,8:18.19796%,9:17.48753%,6:0.00235%,16:0.00205%,18:0.00147%,17:0.00059%,15:0.00059%,2:0.00059%,25:0.00029%,22:0.00029%,7:0.00029%,0:0.00029%]
[INFO] ** i/f_dir:[1:99.99941%,0:0.00059%]
[INFO] ** i/f_name:[2:99.99941%,3:0.00059%]
[INFO] ** modbus_function_code:[0.02961:99.99149%,-33.760870000000004:0.00851%]
[INFO] ** modbus_function_description:[11:49.99604%,7:49.99545%,0:0.00851%]
[INFO] ** modbus_transaction_id:65535 (19.23896%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99501%,2:0.0044%,1:0.00059%]
[INFO] ** proxy_src_ip:[18:38.33935%,20:25.96635%,13:18.19826%,6:17.48753%,1:0.00235%,17:0.00176%,14:0.00176%,7:0.00147%,21:0.00088%,0:0.00029%]
[INFO] ** s_port:[1.45442:25.96606%,-0.32151:21.01856%,-1.27613:18.19796%,-0.23351:17.48724%,-0.33484:17.32078%,-71.14798:0.00117%,-71.14931:0.00117%,-71.33197:0.00059%,-0.08551:0.00059%,7.66617:0.00029%,-58.035180000000004:0.00029%,-1.2708:0.00029%,-64.19493:0.00029%,-5.1466400000000005:0.00029%,13.431270000000001:0.00029%,-0.24151:0.00029%,11.57001:0.00029%,14.4699:0.00029%,1.47576:0.00029%,14.191239999999999:0.00029%,-5.08665:0.00029%,10.192739999999999:0.00029%,-3.3787199999999995:0.00029%,6.1115699999999995:0.00029%,2.05573:0.00029%,-43.76509:0.00029%,2.52505:0.00029%,11.862:0.00029%,-58.032509999999995:0.00029%]
[INFO] ** scada_tag:[3:25.96606%,1:21.01856%,5:18.19796%,4:17.48694%,2:17.32078%,0:0.00969%]
[INFO] ** service:[0.0048200000000000005:99.99149%,-205.44247:0.00147%,-186.43601999999998:0.00147%,-211.09762999999998:0.00117%,-211.08346:0.00117%,-211.08818:0.00117%,-211.73542999999998:0.00059%,-186.44547:0.00029%,-183.8612:0.00029%,-185.9872:0.00029%,-211.35747999999998:0.00029%,-202.75898:0.00029%]
[INFO] ** src:[22:38.33935%,9:25.96635%,7:18.19826%,1:17.48753%,3:0.00264%,2:0.00176%,21:0.00147%,4:0.00117%,14:0.00059%,8:0.00059%,17:0.00029%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:926 (0.27184%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/340637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2078 - tp: 78443.0000 - fp: 1557.0000 - tn: 318443.0000 - fn: 1557.0000 - accuracy: 0.9922 - precision: 0.9805 - recall: 0.9805 - auc: 0.9982 - val_loss: 0.1686 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/340637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1720 - tp: 78431.0000 - fp: 1569.0000 - tn: 318431.0000 - fn: 1569.0000 - accuracy: 0.9922 - precision: 0.9804 - recall: 0.9804 - auc: 0.9982 - val_loss: 0.1356 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/340637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1473 - tp: 78418.0000 - fp: 1582.0000 - tn: 318418.0000 - fn: 1582.0000 - accuracy: 0.9921 - precision: 0.9802 - recall: 0.9802 - auc: 0.9981 - val_loss: 0.1096 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/340637
[33m[INFO] loading file 29-29/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540637, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540637, 17)

[INFO] analyzing data
[INFO] 540637 rows
[INFO] ** appi_name:[21:99.99889%,30:0.00055%,26:0.00018%,9:0.00018%,3:0.00018%]
[INFO] ** classification:[normal:64.39219%,Single Stage Single Point:35.60781%]
[INFO] ** dst:[21:43.32704%,10:21.06386%,8:18.14341%,9:17.46403%,22:0.00055%,15:0.00055%,24:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99945%,3:0.00055%]
[INFO] ** modbus_function_code:[0.02961:99.99889%,-33.760870000000004:0.00111%]
[INFO] ** modbus_function_description:[7:49.99972%,11:49.99917%,0:0.00111%]
[INFO] ** modbus_transaction_id:65536 (12.122%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99926%,1:0.00055%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.44058%,20:25.9505%,13:18.14378%,6:17.46384%,17:0.00055%,21:0.00018%,16:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.94994%,-0.32151:21.06367%,-1.27613:18.14341%,-0.23351:17.46384%,-0.33484:17.37691%,-71.33197:0.00055%,1.45709:0.00037%,-71.14798:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.94957%,1:21.06349%,5:18.14341%,4:17.46347%,2:17.37691%,0:0.00314%]
[INFO] ** service:[0.0048200000000000005:99.99908%,-211.73542999999998:0.00055%,-183.8612:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.44058%,9:25.9505%,7:18.14378%,1:17.46384%,14:0.00055%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1468 (0.27153%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1287 - tp: 78393.0000 - fp: 1607.0000 - tn: 318393.0000 - fn: 1607.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9981 - val_loss: 0.0908 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1156 - tp: 78397.0000 - fp: 1603.0000 - tn: 318397.0000 - fn: 1603.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9981 - val_loss: 0.0769 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1070 - tp: 78321.0000 - fp: 1679.0000 - tn: 318321.0000 - fn: 1679.0000 - accuracy: 0.9916 - precision: 0.9790 - recall: 0.9790 - auc: 0.9980 - val_loss: 0.0654 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0994 - tp: 78360.0000 - fp: 1640.0000 - tn: 318360.0000 - fn: 1640.0000 - accuracy: 0.9918 - precision: 0.9795 - recall: 0.9795 - auc: 0.9981 - val_loss: 0.0569 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0922 - tp: 78416.0000 - fp: 1584.0000 - tn: 318416.0000 - fn: 1584.0000 - accuracy: 0.9921 - precision: 0.9802 - recall: 0.9802 - auc: 0.9981 - val_loss: 0.0495 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/540637
[33m[INFO] loading file 30-30/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540637, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540637, 17)

[INFO] analyzing data
[INFO] 540637 rows
[INFO] ** appi_name:[21:99.9976%,30:0.00166%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.36925%,Single Stage Single Point:35.63075%]
[INFO] ** dst:[21:43.33684%,10:21.02945%,8:18.14489%,9:17.48548%,15:0.00166%,22:0.00074%,24:0.00037%,25:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99834%,0:0.00166%]
[INFO] ** i/f_name:[2:99.99834%,3:0.00166%]
[INFO] ** modbus_function_code:[0.02961:99.9976%,-33.760870000000004:0.0024%]
[INFO] ** modbus_function_description:[7:49.99972%,11:49.99787%,0:0.0024%]
[INFO] ** modbus_transaction_id:65536 (12.122%)
[INFO] ** orig:[0:99.99908%,2:0.00055%,1:0.00037%]
[INFO] ** proto:[0:99.99797%,1:0.00166%,2:0.00037%]
[INFO] ** proxy_src_ip:[18:38.36955%,20:25.99656%,13:18.14526%,6:17.48604%,17:0.00166%,7:0.00037%,16:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.99637%,-0.32151:21.02927%,-1.27613:18.14471%,-0.23351:17.4853%,-0.33484:17.34029%,-71.33197:0.00166%,-0.24151:0.00055%,-1.27347:0.00037%,-71.14798:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:25.996%,1:21.02927%,5:18.14452%,4:17.48511%,2:17.3401%,0:0.00499%]
[INFO] ** service:[0.0048200000000000005:99.99778%,-211.73542999999998:0.00166%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.36955%,9:25.99656%,7:18.14526%,1:17.48604%,14:0.00111%,21:0.00092%,16:0.00018%,15:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99926%,1:0.00074%]
[INFO] ** unixtime:1470 (0.2719%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0903 - tp: 78340.0000 - fp: 1660.0000 - tn: 318340.0000 - fn: 1660.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9980 - val_loss: 0.0444 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0867 - tp: 78371.0000 - fp: 1629.0000 - tn: 318371.0000 - fn: 1629.0000 - accuracy: 0.9919 - precision: 0.9796 - recall: 0.9796 - auc: 0.9980 - val_loss: 0.0389 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0846 - tp: 78366.0000 - fp: 1634.0000 - tn: 318366.0000 - fn: 1634.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9981 - val_loss: 0.0351 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0804 - tp: 78445.0000 - fp: 1555.0000 - tn: 318445.0000 - fn: 1555.0000 - accuracy: 0.9922 - precision: 0.9806 - recall: 0.9806 - auc: 0.9981 - val_loss: 0.0317 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0790 - tp: 78451.0000 - fp: 1549.0000 - tn: 318451.0000 - fn: 1549.0000 - accuracy: 0.9923 - precision: 0.9806 - recall: 0.9806 - auc: 0.9981 - val_loss: 0.0294 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/540637
[33m[INFO] loading file 31-31/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540637, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540637, 17)

[INFO] analyzing data
[INFO] 540637 rows
[INFO] ** appi_name:[21:99.99982%,26:0.00018%]
[INFO] ** classification:[normal:64.37869%,Single Stage Single Point:35.62131%]
[INFO] ** dst:[21:43.32093%,10:21.05646%,8:18.12492%,9:17.49621%,22:0.00092%,24:0.00037%,6:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99982%,-33.760870000000004:0.00018%]
[INFO] ** modbus_function_description:[11:49.99991%,7:49.99991%,0:0.00018%]
[INFO] ** modbus_transaction_id:65536 (12.122%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.40081%,20:25.97732%,13:18.1251%,6:17.49621%,16:0.00037%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.97658%,-0.32151:21.05646%,-1.27613:18.12473%,-0.23351:17.49603%,-0.33484:17.34435%,-1.27347:0.00037%,1.45709:0.00037%,-1.02014:0.00037%,-71.14798:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.97621%,1:21.05627%,5:18.12455%,4:17.49584%,2:17.34417%,0:0.00296%]
[INFO] ** service:[0.0048200000000000005:99.99982%,-211.08346:0.00018%]
[INFO] ** src:[22:38.40081%,9:25.97732%,7:18.1251%,1:17.49621%,15:0.00037%,21:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1469 (0.27172%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0814 - tp: 78350.0000 - fp: 1650.0000 - tn: 318350.0000 - fn: 1650.0000 - accuracy: 0.9918 - precision: 0.9794 - recall: 0.9794 - auc: 0.9980 - val_loss: 0.0269 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0792 - tp: 78401.0000 - fp: 1599.0000 - tn: 318401.0000 - fn: 1599.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9981 - val_loss: 0.0254 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0825 - tp: 78293.0000 - fp: 1707.0000 - tn: 318293.0000 - fn: 1707.0000 - accuracy: 0.9915 - precision: 0.9787 - recall: 0.9787 - auc: 0.9980 - val_loss: 0.0242 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0788 - tp: 78396.0000 - fp: 1604.0000 - tn: 318396.0000 - fn: 1604.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9981 - val_loss: 0.0229 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0795 - tp: 78370.0000 - fp: 1630.0000 - tn: 318370.0000 - fn: 1630.0000 - accuracy: 0.9919 - precision: 0.9796 - recall: 0.9796 - auc: 0.9981 - val_loss: 0.0221 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/540637
[33m[INFO] loading file 32-32/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540637, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540637, 17)

[INFO] analyzing data
[INFO] 540637 rows
[INFO] ** appi_name:[21:99.9963%,30:0.00314%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.37554%,Single Stage Single Point:35.62446%]
[INFO] ** dst:[21:43.31964%,10:21.05109%,8:18.16024%,9:17.46421%,15:0.00314%,22:0.00092%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99723%,0:0.00277%]
[INFO] ** i/f_name:[2:99.99686%,3:0.00314%]
[INFO] ** modbus_function_code:[0.02961:99.9963%,-33.760870000000004:0.0037%]
[INFO] ** modbus_function_description:[7:49.99917%,11:49.99713%,0:0.0037%]
[INFO] ** modbus_transaction_id:65536 (12.122%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9963%,1:0.00314%,2:0.00055%]
[INFO] ** proxy_src_ip:[18:38.41376%,20:25.95734%,13:18.16024%,6:17.46477%,17:0.00314%,14:0.00055%,16:0.00018%]
[INFO] ** s_port:[1.45442:25.95679%,-0.32151:21.05109%,-1.27613:18.15987%,-0.23351:17.46403%,-0.33484:17.36267%,-71.33197:0.00314%,-0.24151:0.00055%,-1.2708:0.00018%,-1.02014:0.00018%,13.431270000000001:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,1.45709:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:25.95642%,1:21.05091%,5:18.15987%,4:17.46366%,2:17.36267%,0:0.00647%]
[INFO] ** service:[0.0048200000000000005:99.9963%,-211.73542999999998:0.00314%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.41376%,9:25.95734%,7:18.16024%,1:17.46477%,14:0.00314%,2:0.00055%,15:0.00018%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1467 (0.27135%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0788 - tp: 78392.0000 - fp: 1608.0000 - tn: 318392.0000 - fn: 1608.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9981 - val_loss: 0.0215 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0783 - tp: 78400.0000 - fp: 1600.0000 - tn: 318400.0000 - fn: 1600.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9981 - val_loss: 0.0208 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0771 - tp: 78431.0000 - fp: 1569.0000 - tn: 318431.0000 - fn: 1569.0000 - accuracy: 0.9922 - precision: 0.9804 - recall: 0.9804 - auc: 0.9981 - val_loss: 0.0203 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0811 - tp: 78321.0000 - fp: 1679.0000 - tn: 318321.0000 - fn: 1679.0000 - accuracy: 0.9916 - precision: 0.9790 - recall: 0.9790 - auc: 0.9980 - val_loss: 0.0204 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0782 - tp: 78400.0000 - fp: 1600.0000 - tn: 318400.0000 - fn: 1600.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9981 - val_loss: 0.0201 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/540637
[33m[INFO] loading file 33-33/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540637, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540637, 17)

[INFO] analyzing data
[INFO] 540637 rows
[INFO] ** appi_name:[21:99.99686%,30:0.00111%,17:0.00074%,22:0.00055%,31:0.00018%,28:0.00018%,26:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.39811%,Single Stage Single Point:35.60189%]
[INFO] ** dst:[21:43.33185%,10:21.06127%,8:18.11474%,9:17.48715%,22:0.00148%,15:0.00111%,16:0.00074%,6:0.00074%,24:0.00037%,17:0.00037%,18:0.00018%]
[INFO] ** i/f_dir:[1:99.99889%,0:0.00111%]
[INFO] ** i/f_name:[2:99.99889%,3:0.00111%]
[INFO] ** modbus_function_code:[0.02961:99.99686%,-33.760870000000004:0.00314%]
[INFO] ** modbus_function_description:[7:49.99954%,11:49.99732%,0:0.00314%]
[INFO] ** modbus_transaction_id:65536 (12.122%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99797%,1:0.00111%,2:0.00092%]
[INFO] ** proxy_src_ip:[18:38.42449%,20:25.96955%,13:18.11474%,6:17.48733%,17:0.00111%,16:0.00074%,1:0.00074%,21:0.00037%,14:0.00037%,7:0.00037%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.96863%,-0.32151:21.06127%,-1.27613:18.11437%,-0.23351:17.48696%,-0.33484:17.36322%,-71.33197:0.00111%,-1.02014:0.00074%,1.45709:0.00055%,-71.14931:0.00055%,-1.27347:0.00037%,-5.08665:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,-43.76509:0.00018%,-71.14798:0.00018%,-58.032509999999995:0.00018%,-58.035180000000004:0.00018%,-0.24151:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:25.96826%,1:21.06127%,5:18.11419%,4:17.48678%,2:17.36322%,0:0.00629%]
[INFO] ** service:[0.0048200000000000005:99.99686%,-211.73542999999998:0.00111%,-205.44247:0.00074%,-211.08818:0.00055%,-211.09762999999998:0.00018%,-211.08346:0.00018%,-185.9872:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.42449%,9:25.96955%,7:18.11474%,1:17.48733%,14:0.00111%,15:0.00074%,3:0.00074%,21:0.00037%,4:0.00037%,2:0.00037%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1470 (0.2719%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0790 - tp: 78377.0000 - fp: 1623.0000 - tn: 318377.0000 - fn: 1623.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9981 - val_loss: 0.0199 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0796 - tp: 78363.0000 - fp: 1637.0000 - tn: 318363.0000 - fn: 1637.0000 - accuracy: 0.9918 - precision: 0.9795 - recall: 0.9795 - auc: 0.9981 - val_loss: 0.0199 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0790 - tp: 78380.0000 - fp: 1620.0000 - tn: 318380.0000 - fn: 1620.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9981 - val_loss: 0.0199 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0780 - tp: 78403.0000 - fp: 1597.0000 - tn: 318403.0000 - fn: 1597.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9981 - val_loss: 0.0198 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0783 - tp: 78396.0000 - fp: 1604.0000 - tn: 318396.0000 - fn: 1604.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9981 - val_loss: 0.0195 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/540637
[33m[INFO] loading file 34-34/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (382070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (382070, 17)

[INFO] analyzing data
[INFO] 382070 rows
[INFO] ** appi_name:[21:99.99738%,30:0.00079%,7:0.00079%,31:0.00026%,22:0.00026%,8:0.00026%,6:0.00026%]
[INFO] ** classification:[normal:64.34109%,Single Stage Single Point:35.65891%]
[INFO] ** dst:[21:43.28107%,10:21.05687%,8:18.19954%,9:17.45937%,22:0.00079%,15:0.00079%,16:0.00052%,2:0.00052%,18:0.00026%,6:0.00026%]
[INFO] ** i/f_dir:[1:99.99921%,0:0.00079%]
[INFO] ** i/f_name:[2:99.99921%,3:0.00079%]
[INFO] ** modbus_function_code:[0.02961:99.99738%,-33.760870000000004:0.00262%]
[INFO] ** modbus_function_description:[7:49.99921%,11:49.99817%,0:0.00262%]
[INFO] ** modbus_transaction_id:65536 (17.15288%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99869%,1:0.00079%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.38852%,20:25.94943%,13:18.19954%,6:17.45989%,17:0.00079%,1:0.00079%,21:0.00052%,14:0.00026%,7:0.00026%]
[INFO] ** s_port:[1.45442:25.94917%,-0.32151:21.05661%,-1.27613:18.19954%,-0.23351:17.4591%,-0.33484:17.3319%,-0.24151:0.00079%,-71.33197:0.00079%,-3.0613900000000003:0.00026%,-3.3787199999999995:0.00026%,14.191239999999999:0.00026%,1.47576:0.00026%,11.57001:0.00026%,-49.275529999999996:0.00026%,-71.14931:0.00026%,7.66617:0.00026%]
[INFO] ** scada_tag:[3:25.94891%,1:21.05635%,5:18.19928%,4:17.45858%,2:17.3319%,0:0.00497%]
[INFO] ** service:[0.0048200000000000005:99.99764%,-211.09762999999998:0.00079%,-211.73542999999998:0.00079%,-186.43601999999998:0.00026%,-211.35747999999998:0.00026%,-211.08818:0.00026%]
[INFO] ** src:[22:38.38852%,9:25.94943%,7:18.19954%,1:17.45989%,14:0.00079%,3:0.00079%,4:0.00052%,21:0.00026%,2:0.00026%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1038 (0.27168%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/382070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0794 - tp: 78369.0000 - fp: 1631.0000 - tn: 318369.0000 - fn: 1631.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9981 - val_loss: 0.0196 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/382070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0773 - tp: 78426.0000 - fp: 1574.0000 - tn: 318426.0000 - fn: 1574.0000 - accuracy: 0.9921 - precision: 0.9803 - recall: 0.9803 - auc: 0.9981 - val_loss: 0.0195 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/382070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0770 - tp: 78435.0000 - fp: 1565.0000 - tn: 318435.0000 - fn: 1565.0000 - accuracy: 0.9922 - precision: 0.9804 - recall: 0.9804 - auc: 0.9982 - val_loss: 0.0193 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/382070
[33m[INFO] loading file 35-35/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582070, 17)

[INFO] analyzing data
[INFO] 582070 rows
[INFO] ** appi_name:[21:99.99897%,30:0.00103%]
[INFO] ** classification:[normal:64.36356%,Single Stage Single Point:35.63644%]
[INFO] ** dst:[21:43.32297%,10:21.03802%,8:18.16208%,9:17.4747%,22:0.0012%,15:0.00103%]
[INFO] ** i/f_dir:[1:99.99914%,0:0.00086%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.99897%,-33.760870000000004:0.00103%]
[INFO] ** modbus_function_description:[7:50.00034%,11:49.99863%,0:0.00103%]
[INFO] ** modbus_transaction_id:65536 (11.25913%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.99897%,1:0.00103%]
[INFO] ** proxy_src_ip:[18:38.39384%,20:25.96767%,13:18.16173%,6:17.47505%,17:0.00103%,16:0.00069%]
[INFO] ** s_port:[1.45442:25.96715%,-0.32151:21.03802%,-1.27613:18.16173%,-0.23351:17.47453%,-0.33484:17.35582%,-71.33197:0.00103%,-1.02014:0.00069%,-0.24151:0.00034%,1.45709:0.00017%,-0.24950999999999998:0.00017%,1.46509:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.96681%,1:21.03802%,5:18.16156%,4:17.47419%,2:17.35582%,0:0.00361%]
[INFO] ** service:[0.0048200000000000005:99.99897%,-211.73542999999998:0.00103%]
[INFO] ** src:[22:38.39384%,9:25.96767%,7:18.16173%,1:17.47505%,14:0.00103%,15:0.00069%]
[INFO] ** type:[0:99.99914%,1:0.00086%]
[INFO] ** unixtime:1580 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0797 - tp: 78361.0000 - fp: 1639.0000 - tn: 318361.0000 - fn: 1639.0000 - accuracy: 0.9918 - precision: 0.9795 - recall: 0.9795 - auc: 0.9981 - val_loss: 0.0197 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0801 - tp: 78348.0000 - fp: 1652.0000 - tn: 318348.0000 - fn: 1652.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9981 - val_loss: 0.0199 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0794 - tp: 78366.0000 - fp: 1634.0000 - tn: 318366.0000 - fn: 1634.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9981 - val_loss: 0.0198 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0779 - tp: 78411.0000 - fp: 1589.0000 - tn: 318411.0000 - fn: 1589.0000 - accuracy: 0.9921 - precision: 0.9801 - recall: 0.9801 - auc: 0.9981 - val_loss: 0.0194 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0808 - tp: 78327.0000 - fp: 1673.0000 - tn: 318327.0000 - fn: 1673.0000 - accuracy: 0.9916 - precision: 0.9791 - recall: 0.9791 - auc: 0.9980 - val_loss: 0.0203 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/582070
[33m[INFO] loading file 36-36/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582070, 17)

[INFO] analyzing data
[INFO] 582070 rows
[INFO] ** appi_name:[21:99.99863%,30:0.00069%,31:0.00034%,33:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.36391%,Single Stage Single Point:35.63609%]
[INFO] ** dst:[21:43.33121%,10:21.03046%,8:18.15039%,9:17.48553%,22:0.00086%,15:0.00069%,24:0.00034%,18:0.00034%,25:0.00017%]
[INFO] ** i/f_dir:[1:99.99931%,0:0.00069%]
[INFO] ** i/f_name:[2:99.99931%,3:0.00069%]
[INFO] ** modbus_function_code:[0.02961:99.99863%,-33.760870000000004:0.00137%]
[INFO] ** modbus_function_description:[7:50.00034%,11:49.99828%,0:0.00137%]
[INFO] ** modbus_transaction_id:65536 (11.25913%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9988%,1:0.00069%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.38284%,20:25.97901%,13:18.15057%,6:17.48604%,17:0.00069%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.97849%,-0.32151:21.03029%,-1.27613:18.15005%,-0.23351:17.48535%,-0.33484:17.35255%,-71.33197:0.00069%,-0.24151:0.00052%,-0.08551:0.00034%,-1.27347:0.00034%,1.45709:0.00017%,1.47576:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,-64.19493:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:25.97815%,1:21.03012%,5:18.14988%,4:17.48518%,2:17.35238%,0:0.0043%]
[INFO] ** service:[0.0048200000000000005:99.9988%,-211.73542999999998:0.00069%,-186.43601999999998:0.00034%,-186.44547:0.00017%]
[INFO] ** src:[22:38.38284%,9:25.97901%,7:18.15057%,1:17.48604%,14:0.00069%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1581 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0793 - tp: 78369.0000 - fp: 1631.0000 - tn: 318369.0000 - fn: 1631.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9981 - val_loss: 0.0199 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0785 - tp: 78388.0000 - fp: 1612.0000 - tn: 318388.0000 - fn: 1612.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9981 - val_loss: 0.0198 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0771 - tp: 78432.0000 - fp: 1568.0000 - tn: 318432.0000 - fn: 1568.0000 - accuracy: 0.9922 - precision: 0.9804 - recall: 0.9804 - auc: 0.9982 - val_loss: 0.0192 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0780 - tp: 78405.0000 - fp: 1595.0000 - tn: 318405.0000 - fn: 1595.0000 - accuracy: 0.9920 - precision: 0.9801 - recall: 0.9801 - auc: 0.9981 - val_loss: 0.0191 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0824 - tp: 78284.0000 - fp: 1716.0000 - tn: 318284.0000 - fn: 1716.0000 - accuracy: 0.9914 - precision: 0.9786 - recall: 0.9786 - auc: 0.9980 - val_loss: 0.0206 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/582070
[33m[INFO] loading file 37-37/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582070, 17)

[INFO] analyzing data
[INFO] 582070 rows
[INFO] ** appi_name:[21:99.9988%,30:0.00069%,33:0.00017%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:64.37937%,Single Stage Single Point:35.62063%]
[INFO] ** dst:[21:43.33963%,10:21.03785%,8:18.13596%,9:17.48467%,22:0.00069%,15:0.00069%,24:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99966%,0:0.00034%]
[INFO] ** i/f_name:[2:99.99931%,3:0.00069%]
[INFO] ** modbus_function_code:[0.02961:99.9988%,-33.760870000000004:0.0012%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.99863%,0:0.0012%]
[INFO] ** modbus_transaction_id:65536 (11.25913%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99914%,1:0.00069%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.38559%,20:25.99206%,13:18.13596%,6:17.48484%,17:0.00069%,21:0.00034%,16:0.00034%,1:0.00017%]
[INFO] ** s_port:[1.45442:25.99155%,-0.32151:21.03768%,-1.27613:18.13562%,-0.23351:17.48449%,-0.33484:17.34791%,-71.33197:0.00069%,-1.02014:0.00034%,1.46509:0.00017%,1.47576:0.00017%,-1.27347:0.00017%,-49.275529999999996:0.00017%,-0.24950999999999998:0.00017%,-0.24151:0.00017%,-1.2708:0.00017%,1.45709:0.00017%,14.4699:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:25.99138%,1:21.03768%,5:18.13545%,4:17.48432%,2:17.34774%,0:0.00344%]
[INFO] ** service:[0.0048200000000000005:99.99897%,-211.73542999999998:0.00069%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.38559%,9:25.99206%,7:18.13596%,1:17.48484%,14:0.00069%,15:0.00034%,4:0.00034%,3:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1581 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0775 - tp: 78421.0000 - fp: 1579.0000 - tn: 318421.0000 - fn: 1579.0000 - accuracy: 0.9921 - precision: 0.9803 - recall: 0.9803 - auc: 0.9981 - val_loss: 0.0195 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0788 - tp: 78385.0000 - fp: 1615.0000 - tn: 318385.0000 - fn: 1615.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9981 - val_loss: 0.0194 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0775 - tp: 78415.0000 - fp: 1585.0000 - tn: 318415.0000 - fn: 1585.0000 - accuracy: 0.9921 - precision: 0.9802 - recall: 0.9802 - auc: 0.9981 - val_loss: 0.0196 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0794 - tp: 78365.0000 - fp: 1635.0000 - tn: 318365.0000 - fn: 1635.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9981 - val_loss: 0.0199 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0814 - tp: 78309.0000 - fp: 1691.0000 - tn: 318309.0000 - fn: 1691.0000 - accuracy: 0.9915 - precision: 0.9789 - recall: 0.9789 - auc: 0.9980 - val_loss: 0.0206 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/582070
[33m[INFO] loading file 38-38/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582070, 17)

[INFO] analyzing data
[INFO] 582070 rows
[INFO] ** appi_name:[21:99.99897%,30:0.00034%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.4072%,Single Stage Single Point:35.5928%]
[INFO] ** dst:[21:43.32211%,10:21.08303%,8:18.09851%,9:17.49446%,22:0.00086%,15:0.00034%,25:0.00017%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99983%,0:0.00017%]
[INFO] ** i/f_name:[2:99.99966%,3:0.00034%]
[INFO] ** modbus_function_code:[0.02961:99.99897%,-33.760870000000004:0.00103%]
[INFO] ** modbus_function_description:[11:49.99948%,7:49.99948%,0:0.00103%]
[INFO] ** modbus_transaction_id:65536 (11.25913%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99931%,2:0.00034%,1:0.00034%]
[INFO] ** proxy_src_ip:[18:38.44469%,20:25.96097%,13:18.09834%,6:17.4948%,17:0.00034%,7:0.00034%,16:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.96028%,-0.32151:21.08286%,-1.27613:18.09817%,-0.23351:17.49429%,-0.33484:17.36183%,-0.24151:0.00034%,-71.33197:0.00034%,1.45709:0.00034%,1.47576:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-61.95768:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:25.95994%,1:21.08286%,5:18.09817%,4:17.49412%,2:17.36183%,0:0.00309%]
[INFO] ** service:[0.0048200000000000005:99.99914%,-211.73542999999998:0.00034%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.44469%,9:25.96097%,7:18.09834%,1:17.4948%,21:0.00034%,14:0.00034%,16:0.00017%,15:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1582 (0.27179%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0805 - tp: 78334.0000 - fp: 1666.0000 - tn: 318334.0000 - fn: 1666.0000 - accuracy: 0.9917 - precision: 0.9792 - recall: 0.9792 - auc: 0.9980 - val_loss: 0.0203 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0782 - tp: 78398.0000 - fp: 1602.0000 - tn: 318398.0000 - fn: 1602.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9981 - val_loss: 0.0197 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0804 - tp: 78338.0000 - fp: 1662.0000 - tn: 318338.0000 - fn: 1662.0000 - accuracy: 0.9917 - precision: 0.9792 - recall: 0.9792 - auc: 0.9980 - val_loss: 0.0201 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0773 - tp: 78421.0000 - fp: 1579.0000 - tn: 318421.0000 - fn: 1579.0000 - accuracy: 0.9921 - precision: 0.9803 - recall: 0.9803 - auc: 0.9981 - val_loss: 0.0195 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0769 - tp: 78433.0000 - fp: 1567.0000 - tn: 318433.0000 - fn: 1567.0000 - accuracy: 0.9922 - precision: 0.9804 - recall: 0.9804 - auc: 0.9982 - val_loss: 0.0193 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/582070
[33m[INFO] loading file 39-39/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582070, 17)

[INFO] analyzing data
[INFO] 582070 rows
[INFO] ** appi_name:[21:99.99966%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.39672%,Single Stage Single Point:35.60328%]
[INFO] ** dst:[21:43.31558%,10:21.07994%,8:18.13871%,9:17.46439%,22:0.00086%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99966%,-33.760870000000004:0.00034%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99966%,0:0.00034%]
[INFO] ** modbus_transaction_id:65536 (11.25913%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.44125%,20:25.95461%,13:18.13888%,6:17.46439%,16:0.00052%,7:0.00034%]
[INFO] ** s_port:[1.45442:25.95409%,-0.32151:21.07994%,-1.27613:18.13854%,-0.23351:17.46422%,-0.33484:17.36131%,-1.02014:0.00052%,-71.14798:0.00017%,-1.27347:0.00017%,1.45709:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-0.24151:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.95375%,1:21.07977%,5:18.13837%,4:17.46422%,2:17.36114%,0:0.00275%]
[INFO] ** service:[0.0048200000000000005:99.99966%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.44125%,9:25.95461%,7:18.13888%,1:17.46439%,15:0.00052%,21:0.00034%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1580 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0783 - tp: 78396.0000 - fp: 1604.0000 - tn: 318396.0000 - fn: 1604.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9981 - val_loss: 0.0203 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0776 - tp: 78413.0000 - fp: 1587.0000 - tn: 318413.0000 - fn: 1587.0000 - accuracy: 0.9921 - precision: 0.9802 - recall: 0.9802 - auc: 0.9981 - val_loss: 0.0192 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0788 - tp: 78380.0000 - fp: 1620.0000 - tn: 318380.0000 - fn: 1620.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9981 - val_loss: 0.0195 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0769 - tp: 78434.0000 - fp: 1566.0000 - tn: 318434.0000 - fn: 1566.0000 - accuracy: 0.9922 - precision: 0.9804 - recall: 0.9804 - auc: 0.9982 - val_loss: 0.0192 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0774 - tp: 78422.0000 - fp: 1578.0000 - tn: 318422.0000 - fn: 1578.0000 - accuracy: 0.9921 - precision: 0.9803 - recall: 0.9803 - auc: 0.9981 - val_loss: 0.0193 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/582070
[33m[INFO] loading file 40-40/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582070, 17)

[INFO] analyzing data
[INFO] 582070 rows
[INFO] ** appi_name:[21:99.99656%,30:0.00292%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.33539%,Single Stage Single Point:35.66461%]
[INFO] ** dst:[21:43.29101%,10:21.03974%,8:18.19661%,9:17.46817%,15:0.00292%,22:0.00086%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99725%,0:0.00275%]
[INFO] ** i/f_name:[2:99.99708%,3:0.00292%]
[INFO] ** modbus_function_code:[0.02961:99.99656%,-33.760870000000004:0.00344%]
[INFO] ** modbus_function_description:[7:49.99931%,11:49.99725%,0:0.00344%]
[INFO] ** modbus_transaction_id:65536 (11.25913%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.99656%,1:0.00292%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.35707%,20:25.97454%,13:18.19644%,6:17.46852%,17:0.00292%,14:0.00052%]
[INFO] ** s_port:[1.45442:25.97368%,-0.32151:21.03974%,-1.27613:18.19627%,-0.23351:17.468%,-0.33484:17.31733%,-71.33197:0.00292%,1.45709:0.00052%,-0.24151:0.00034%,-71.14798:0.00017%,-1.27347:0.00017%,11.862:0.00017%,-0.24950999999999998:0.00017%,1.46509:0.00017%,1.47576:0.00017%,13.431270000000001:0.00017%]
[INFO] ** scada_tag:[3:25.97334%,1:21.03957%,5:18.19609%,4:17.46766%,2:17.31716%,0:0.00618%]
[INFO] ** service:[0.0048200000000000005:99.99656%,-211.73542999999998:0.00292%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.35707%,9:25.97454%,7:18.19644%,1:17.46852%,14:0.00292%,2:0.00052%]
[INFO] ** type:[0:99.99914%,1:0.00086%]
[INFO] ** unixtime:1583 (0.27196%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0806 - tp: 78335.0000 - fp: 1665.0000 - tn: 318335.0000 - fn: 1665.0000 - accuracy: 0.9917 - precision: 0.9792 - recall: 0.9792 - auc: 0.9980 - val_loss: 0.0202 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0769 - tp: 78434.0000 - fp: 1566.0000 - tn: 318434.0000 - fn: 1566.0000 - accuracy: 0.9922 - precision: 0.9804 - recall: 0.9804 - auc: 0.9982 - val_loss: 0.0194 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0778 - tp: 78410.0000 - fp: 1590.0000 - tn: 318410.0000 - fn: 1590.0000 - accuracy: 0.9921 - precision: 0.9801 - recall: 0.9801 - auc: 0.9981 - val_loss: 0.0194 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0789 - tp: 78381.0000 - fp: 1619.0000 - tn: 318381.0000 - fn: 1619.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9981 - val_loss: 0.0199 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0792 - tp: 78374.0000 - fp: 1626.0000 - tn: 318374.0000 - fn: 1626.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9981 - val_loss: 0.0199 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/582070
[33m[INFO] loading file 41-41/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (522228, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (522228, 17)

[INFO] analyzing data
[INFO] 522228 rows
[INFO] ** appi_name:[21:99.99674%,30:0.00096%,22:0.00077%,17:0.00077%,32:0.00019%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.38778%,Single Stage Single Point:35.61222%]
[INFO] ** dst:[21:43.32724%,10:21.05651%,8:18.14284%,9:17.46919%,16:0.00096%,15:0.00096%,6:0.00096%,22:0.00057%,24:0.00038%,17:0.00038%]
[INFO] ** i/f_dir:[1:99.99904%,0:0.00096%]
[INFO] ** i/f_name:[2:99.99904%,3:0.00096%]
[INFO] ** modbus_function_code:[0.02961:99.99674%,-33.760870000000004:0.00326%]
[INFO] ** modbus_function_description:[7:49.99923%,11:49.99751%,0:0.00326%]
[INFO] ** modbus_transaction_id:65536 (12.54931%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99789%,2:0.00115%,1:0.00096%]
[INFO] ** proxy_src_ip:[18:38.42843%,20:25.95552%,13:18.14303%,6:17.46938%,17:0.00096%,1:0.00077%,21:0.00038%,16:0.00038%,14:0.00038%,0:0.00038%,7:0.00019%,2:0.00019%]
[INFO] ** s_port:[1.45442:25.95514%,-0.32151:21.05651%,-1.27613:18.14246%,-0.23351:17.469%,-0.33484:17.37191%,-71.33197:0.00096%,-71.14931:0.00077%,-1.02014:0.00038%,-1.27347:0.00038%,-71.14798:0.00019%,-0.24151:0.00019%,-58.035180000000004:0.00019%,-1.2708:0.00019%,-5.1466400000000005:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-64.19226:0.00019%,-5.08665:0.00019%,-0.24950999999999998:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:25.95495%,1:21.05651%,5:18.14246%,4:17.46881%,2:17.37172%,0:0.00555%]
[INFO] ** service:[0.0048200000000000005:99.99674%,-211.73542999999998:0.00096%,-205.44247:0.00077%,-211.08818:0.00077%,89.64175:0.00019%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.42843%,9:25.95552%,7:18.14303%,1:17.46938%,14:0.00096%,3:0.00077%,15:0.00038%,8:0.00038%,4:0.00038%,2:0.00038%,21:0.00019%,17:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1417 (0.27134%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/522228
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0797 - tp: 78360.0000 - fp: 1640.0000 - tn: 318360.0000 - fn: 1640.0000 - accuracy: 0.9918 - precision: 0.9795 - recall: 0.9795 - auc: 0.9981 - val_loss: 0.0202 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/522228
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0749 - tp: 78489.0000 - fp: 1511.0000 - tn: 318489.0000 - fn: 1511.0000 - accuracy: 0.9924 - precision: 0.9811 - recall: 0.9811 - auc: 0.9982 - val_loss: 0.0195 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/522228
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0812 - tp: 78323.0000 - fp: 1677.0000 - tn: 318323.0000 - fn: 1677.0000 - accuracy: 0.9916 - precision: 0.9790 - recall: 0.9790 - auc: 0.9980 - val_loss: 0.0198 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/522228
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0784 - tp: 78391.0000 - fp: 1609.0000 - tn: 318391.0000 - fn: 1609.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9981 - val_loss: 0.0196 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/522228
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0793 - tp: 78367.0000 - fp: 1633.0000 - tn: 318367.0000 - fn: 1633.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9981 - val_loss: 0.0197 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-40-41-batch-400000-500000
[INFO] processing batch 500000-600000/522228
[33m[INFO] loading file 42-42/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (365742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (365742, 17)

[INFO] analyzing data
[INFO] 365742 rows
[INFO] ** appi_name:[21:99.9907%,30:0.00246%,17:0.00137%,31:0.00109%,26:0.00109%,7:0.00109%,22:0.00082%,28:0.00027%,27:0.00027%,9:0.00027%,8:0.00027%,0:0.00027%]
[INFO] ** classification:[normal:64.34809%,Single Stage Single Point:35.65191%]
[INFO] ** dst:[21:43.30102%,10:21.03723%,8:18.19643%,9:17.4552%,16:0.00246%,6:0.00219%,18:0.00137%,2:0.00109%,22:0.00082%,15:0.00082%,17:0.00055%,25:0.00027%,7:0.00027%,0:0.00027%]
[INFO] ** i/f_dir:[1:99.99918%,0:0.00082%]
[INFO] ** i/f_name:[2:99.99918%,3:0.00082%]
[INFO] ** modbus_function_code:[0.02961:99.9907%,-33.760870000000004:0.0093%]
[INFO] ** modbus_function_description:[7:49.9959%,11:49.99481%,0:0.0093%]
[INFO] ** modbus_transaction_id:65536 (17.91864%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99508%,2:0.0041%,1:0.00082%]
[INFO] ** proxy_src_ip:[18:38.38881%,20:25.94971%,13:18.19671%,6:17.4552%,17:0.00246%,1:0.00246%,14:0.00164%,21:0.00109%,7:0.00082%,0:0.00055%,16:0.00027%,2:0.00027%]
[INFO] ** s_port:[1.45442:25.94917%,-0.32151:21.03723%,-1.27613:18.19643%,-0.23351:17.45493%,-0.33484:17.35158%,-71.14931:0.00109%,-71.14798:0.00109%,-71.33197:0.00082%,-3.3787199999999995:0.00055%,-0.08551:0.00055%,11.57001:0.00055%,13.431270000000001:0.00027%,-5.1466400000000005:0.00027%,0.31847:0.00027%,-1.02014:0.00027%,-64.19493:0.00027%,-1.2708:0.00027%,-58.035180000000004:0.00027%,7.66617:0.00027%,-0.24151:0.00027%,1.47576:0.00027%,14.4699:0.00027%,15.912510000000001:0.00027%,14.191239999999999:0.00027%,7.9608300000000005:0.00027%,-5.08665:0.00027%,10.192739999999999:0.00027%,-3.0613900000000003:0.00027%,1.45709:0.00027%,2.05573:0.00027%,-43.76509:0.00027%,11.862:0.00027%,-58.032509999999995:0.00027%]
[INFO] ** scada_tag:[3:25.94889%,1:21.03723%,5:18.19616%,4:17.45493%,2:17.3513%,0:0.01148%]
[INFO] ** service:[0.0048200000000000005:99.9907%,-211.09762999999998:0.00191%,-205.44247:0.00137%,-186.43601999999998:0.00137%,-211.08346:0.00109%,-211.08818:0.00109%,-211.73542999999998:0.00082%,-211.35747999999998:0.00055%,-186.44547:0.00027%,-183.8612:0.00027%,-185.9872:0.00027%,-202.75898:0.00027%]
[INFO] ** src:[22:38.38881%,9:25.94971%,7:18.19671%,1:17.4552%,3:0.00328%,2:0.00191%,4:0.00137%,21:0.00109%,14:0.00082%,8:0.00055%,17:0.00027%,15:0.00027%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:993 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/365742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0752 - tp: 78480.0000 - fp: 1520.0000 - tn: 318480.0000 - fn: 1520.0000 - accuracy: 0.9924 - precision: 0.9810 - recall: 0.9810 - auc: 0.9982 - val_loss: 0.0192 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/365742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0813 - tp: 78314.0000 - fp: 1686.0000 - tn: 318314.0000 - fn: 1686.0000 - accuracy: 0.9916 - precision: 0.9789 - recall: 0.9789 - auc: 0.9980 - val_loss: 0.0201 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/365742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0792 - tp: 78372.0000 - fp: 1628.0000 - tn: 318372.0000 - fn: 1628.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9981 - val_loss: 0.0197 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/365742
[33m[INFO] loading file 43-43/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99894%,30:0.00053%,26:0.00018%,8:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.39844%,Single Stage Single Point:35.60156%]
[INFO] ** dst:[21:43.32646%,10:21.06985%,8:18.13123%,9:17.47015%,22:0.00106%,15:0.00053%,2:0.00035%,24:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99982%,0:0.00018%]
[INFO] ** i/f_name:[2:99.99947%,3:0.00053%]
[INFO] ** modbus_function_code:[0.02961:99.99894%,-33.760870000000004:0.00106%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99894%,0:0.00106%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99929%,1:0.00053%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.41804%,20:25.9788%,13:18.13141%,6:17.47033%,17:0.00053%,1:0.00053%,16:0.00035%]
[INFO] ** s_port:[1.45442:25.9781%,-0.32151:21.06985%,-1.27613:18.13106%,-0.23351:17.4698%,-0.33484:17.34819%,-71.33197:0.00053%,1.45709:0.00035%,1.47576:0.00035%,-0.24151:0.00035%,-1.02014:0.00035%,0.31847:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-1.2708:0.00018%,-3.3787199999999995:0.00018%]
[INFO] ** scada_tag:[3:25.97774%,1:21.06985%,5:18.13088%,4:17.46945%,2:17.34801%,0:0.00407%]
[INFO] ** service:[0.0048200000000000005:99.99894%,-211.73542999999998:0.00053%,-211.09762999999998:0.00018%,-211.08346:0.00018%,-211.35747999999998:0.00018%]
[INFO] ** src:[22:38.41804%,9:25.9788%,7:18.13141%,1:17.47033%,14:0.00053%,3:0.00053%,15:0.00035%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1538 (0.27186%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0781 - tp: 78404.0000 - fp: 1596.0000 - tn: 318404.0000 - fn: 1596.0000 - accuracy: 0.9920 - precision: 0.9801 - recall: 0.9801 - auc: 0.9981 - val_loss: 0.0195 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0773 - tp: 78423.0000 - fp: 1577.0000 - tn: 318423.0000 - fn: 1577.0000 - accuracy: 0.9921 - precision: 0.9803 - recall: 0.9803 - auc: 0.9981 - val_loss: 0.0194 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0771 - tp: 78436.0000 - fp: 1564.0000 - tn: 318436.0000 - fn: 1564.0000 - accuracy: 0.9922 - precision: 0.9804 - recall: 0.9804 - auc: 0.9981 - val_loss: 0.0192 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0799 - tp: 78353.0000 - fp: 1647.0000 - tn: 318353.0000 - fn: 1647.0000 - accuracy: 0.9918 - precision: 0.9794 - recall: 0.9794 - auc: 0.9981 - val_loss: 0.0200 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0816 - tp: 78306.0000 - fp: 1694.0000 - tn: 318306.0000 - fn: 1694.0000 - accuracy: 0.9915 - precision: 0.9788 - recall: 0.9788 - auc: 0.9980 - val_loss: 0.0205 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 44-44/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99823%,30:0.00071%,31:0.00053%,0:0.00035%,22:0.00018%]
[INFO] ** classification:[normal:64.3926%,Single Stage Single Point:35.6074%]
[INFO] ** dst:[21:43.33619%,10:21.05341%,8:18.15121%,9:17.45601%,22:0.00106%,15:0.00071%,18:0.00053%,25:0.00035%,24:0.00035%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99929%,0:0.00071%]
[INFO] ** i/f_name:[2:99.99929%,3:0.00071%]
[INFO] ** modbus_function_code:[0.02961:99.99823%,-33.760870000000004:0.00177%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99806%,0:0.00177%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99823%,2:0.00106%,1:0.00071%]
[INFO] ** proxy_src_ip:[18:38.43554%,20:25.95459%,13:18.15138%,6:17.45654%,17:0.00071%,7:0.00035%,16:0.00018%,5:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95388%,-0.32151:21.05341%,-1.27613:18.15085%,-0.23351:17.45584%,-0.33484:17.38213%,-71.33197:0.00071%,-0.24151:0.00053%,-0.08551:0.00035%,-64.19493:0.00035%,-1.27347:0.00035%,1.45709:0.00035%,-1.02014:0.00018%,-1.2708:0.00018%,1.47576:0.00018%,-71.14931:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,4.42897:0.00018%]
[INFO] ** scada_tag:[3:25.95335%,1:21.05341%,5:18.15085%,4:17.45548%,2:17.38195%,0:0.00495%]
[INFO] ** service:[0.0048200000000000005:99.99823%,-211.73542999999998:0.00071%,-186.43601999999998:0.00053%,-186.44547:0.00035%,-211.08818:0.00018%]
[INFO] ** src:[22:38.43554%,9:25.95459%,7:18.15138%,1:17.45654%,14:0.00071%,21:0.00035%,17:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1535 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0776 - tp: 78412.0000 - fp: 1588.0000 - tn: 318412.0000 - fn: 1588.0000 - accuracy: 0.9921 - precision: 0.9801 - recall: 0.9801 - auc: 0.9981 - val_loss: 0.0199 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0779 - tp: 78408.0000 - fp: 1592.0000 - tn: 318408.0000 - fn: 1592.0000 - accuracy: 0.9920 - precision: 0.9801 - recall: 0.9801 - auc: 0.9981 - val_loss: 0.0194 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0784 - tp: 78393.0000 - fp: 1607.0000 - tn: 318393.0000 - fn: 1607.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9981 - val_loss: 0.0196 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0799 - tp: 78353.0000 - fp: 1647.0000 - tn: 318353.0000 - fn: 1647.0000 - accuracy: 0.9918 - precision: 0.9794 - recall: 0.9794 - auc: 0.9980 - val_loss: 0.0199 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0794 - tp: 78364.0000 - fp: 1636.0000 - tn: 318364.0000 - fn: 1636.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9981 - val_loss: 0.0196 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 45-45/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99876%,30:0.00053%,31:0.00035%,26:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:64.41912%,Single Stage Single Point:35.58088%]
[INFO] ** dst:[21:43.32646%,10:21.08983%,8:18.12505%,9:17.45601%,22:0.00141%,15:0.00053%,18:0.00035%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99965%,0:0.00035%]
[INFO] ** i/f_name:[2:99.99947%,3:0.00053%]
[INFO] ** modbus_function_code:[0.02961:99.99876%,-33.760870000000004:0.00124%]
[INFO] ** modbus_function_description:[7:50.00035%,11:49.99841%,0:0.00124%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99894%,2:0.00053%,1:0.00053%]
[INFO] ** proxy_src_ip:[18:38.48645%,20:25.93055%,13:18.12487%,6:17.45654%,17:0.00053%,16:0.00035%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.92984%,-0.32151:21.08983%,-1.27613:18.12487%,-0.23351:17.45584%,-0.33484:17.39662%,1.45709:0.00053%,-0.24151:0.00053%,-71.33197:0.00053%,-1.02014:0.00035%,-0.08551:0.00035%,-71.14798:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.92931%,1:21.08965%,5:18.12487%,4:17.45584%,2:17.39645%,0:0.00389%]
[INFO] ** service:[0.0048200000000000005:99.99876%,-211.73542999999998:0.00053%,-186.43601999999998:0.00035%,-183.8612:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.48645%,9:25.93055%,7:18.12487%,1:17.45654%,14:0.00053%,15:0.00035%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1535 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0801 - tp: 78344.0000 - fp: 1656.0000 - tn: 318344.0000 - fn: 1656.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9981 - val_loss: 0.0199 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0767 - tp: 78440.0000 - fp: 1560.0000 - tn: 318440.0000 - fn: 1560.0000 - accuracy: 0.9922 - precision: 0.9805 - recall: 0.9805 - auc: 0.9982 - val_loss: 0.0192 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0796 - tp: 78358.0000 - fp: 1642.0000 - tn: 318358.0000 - fn: 1642.0000 - accuracy: 0.9918 - precision: 0.9795 - recall: 0.9795 - auc: 0.9981 - val_loss: 0.0198 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0819 - tp: 78296.0000 - fp: 1704.0000 - tn: 318296.0000 - fn: 1704.0000 - accuracy: 0.9915 - precision: 0.9787 - recall: 0.9787 - auc: 0.9980 - val_loss: 0.0202 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0802 - tp: 78345.0000 - fp: 1655.0000 - tn: 318345.0000 - fn: 1655.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9980 - val_loss: 0.0203 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 46-46/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99823%,30:0.00106%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.42336%,Single Stage Single Point:35.57664%]
[INFO] ** dst:[21:43.34538%,10:21.07533%,8:18.10348%,9:17.47316%,22:0.00106%,15:0.00106%,25:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99912%,0:0.00088%]
[INFO] ** i/f_name:[2:99.99894%,3:0.00106%]
[INFO] ** modbus_function_code:[0.02961:99.99823%,-33.760870000000004:0.00177%]
[INFO] ** modbus_function_description:[11:49.99929%,7:49.99894%,0:0.00177%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:99.99965%,1:0.00035%]
[INFO] ** proto:[0:99.99859%,1:0.00106%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.44668%,20:25.97403%,13:18.10348%,6:17.47369%,17:0.00106%,16:0.00035%,7:0.00035%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.97368%,-0.32151:21.07515%,-1.27613:18.10331%,-0.23351:17.47298%,-0.33484:17.37152%,-71.33197:0.00106%,-0.24151:0.00053%,-1.02014:0.00035%,-71.14798:0.00018%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:25.97332%,1:21.07498%,5:18.10313%,4:17.47263%,2:17.37152%,0:0.00442%]
[INFO] ** service:[0.0048200000000000005:99.99841%,-211.73542999999998:0.00106%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.44668%,9:25.97403%,7:18.10348%,1:17.47369%,14:0.00106%,21:0.00035%,15:0.00035%,16:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99912%,1:0.00088%]
[INFO] ** unixtime:1538 (0.27186%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0771 - tp: 78430.0000 - fp: 1570.0000 - tn: 318430.0000 - fn: 1570.0000 - accuracy: 0.9922 - precision: 0.9804 - recall: 0.9804 - auc: 0.9982 - val_loss: 0.0195 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0789 - tp: 78383.0000 - fp: 1617.0000 - tn: 318383.0000 - fn: 1617.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9981 - val_loss: 0.0194 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0797 - tp: 78359.0000 - fp: 1641.0000 - tn: 318359.0000 - fn: 1641.0000 - accuracy: 0.9918 - precision: 0.9795 - recall: 0.9795 - auc: 0.9981 - val_loss: 0.0201 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0760 - tp: 78458.0000 - fp: 1542.0000 - tn: 318458.0000 - fn: 1542.0000 - accuracy: 0.9923 - precision: 0.9807 - recall: 0.9807 - auc: 0.9982 - val_loss: 0.0191 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0789 - tp: 78378.0000 - fp: 1622.0000 - tn: 318378.0000 - fn: 1622.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9981 - val_loss: 0.0196 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 47-47/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99947%,33:0.00018%,26:0.00018%,17:0.00018%]
[INFO] ** classification:[normal:64.39649%,Single Stage Single Point:35.60351%]
[INFO] ** dst:[21:43.31179%,10:21.08276%,8:18.12876%,9:17.4744%,22:0.00159%,24:0.00035%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99947%,-33.760870000000004:0.00053%]
[INFO] ** modbus_function_description:[7:50.00106%,11:49.99841%,0:0.00053%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.45392%,20:25.94133%,13:18.12911%,6:17.47475%,16:0.00035%,7:0.00035%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.94045%,-0.32151:21.08276%,-1.27613:18.12858%,-0.23351:17.47422%,-0.33484:17.37117%,1.45709:0.00053%,-0.24151:0.00053%,-1.27347:0.00035%,-1.02014:0.00035%,-71.14798:0.00018%,-61.95635:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%]
[INFO] ** scada_tag:[3:25.93992%,1:21.08258%,5:18.1284%,4:17.47404%,2:17.37099%,0:0.00407%]
[INFO] ** service:[0.0048200000000000005:99.99965%,-211.08346:0.00018%,-205.44247:0.00018%]
[INFO] ** src:[22:38.45392%,9:25.94133%,7:18.12911%,1:17.47475%,21:0.00035%,15:0.00035%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1536 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0793 - tp: 78367.0000 - fp: 1633.0000 - tn: 318367.0000 - fn: 1633.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9981 - val_loss: 0.0198 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0801 - tp: 78346.0000 - fp: 1654.0000 - tn: 318346.0000 - fn: 1654.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9980 - val_loss: 0.0199 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0806 - tp: 78335.0000 - fp: 1665.0000 - tn: 318335.0000 - fn: 1665.0000 - accuracy: 0.9917 - precision: 0.9792 - recall: 0.9792 - auc: 0.9980 - val_loss: 0.0200 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0783 - tp: 78397.0000 - fp: 1603.0000 - tn: 318397.0000 - fn: 1603.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9981 - val_loss: 0.0195 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0798 - tp: 78357.0000 - fp: 1643.0000 - tn: 318357.0000 - fn: 1643.0000 - accuracy: 0.9918 - precision: 0.9795 - recall: 0.9795 - auc: 0.9980 - val_loss: 0.0196 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 48-48/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99682%,30:0.00247%,33:0.00018%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.43114%,Single Stage Single Point:35.56886%]
[INFO] ** dst:[21:43.3353%,10:21.09195%,8:18.09995%,9:17.46874%,15:0.00247%,22:0.00088%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99788%,0:0.00212%]
[INFO] ** i/f_name:[2:99.99753%,3:0.00247%]
[INFO] ** modbus_function_code:[0.02961:99.99682%,-33.760870000000004:0.00318%]
[INFO] ** modbus_function_description:[7:49.99912%,11:49.9977%,0:0.00318%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.997%,1:0.00247%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.46736%,20:25.96024%,13:18.10012%,6:17.46874%,17:0.00247%,14:0.00053%,16:0.00035%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95971%,-0.32151:21.09195%,-1.27613:18.09977%,-0.23351:17.46856%,-0.33484:17.37541%,-71.33197:0.00247%,-1.02014:0.00035%,-1.2708:0.00018%,13.431270000000001:0.00018%,-0.24151:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-61.95635:0.00018%,1.45709:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:25.95936%,1:21.09177%,5:18.09977%,4:17.46856%,2:17.37523%,0:0.0053%]
[INFO] ** service:[0.0048200000000000005:99.997%,-211.73542999999998:0.00247%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.46736%,9:25.96024%,7:18.10012%,1:17.46874%,14:0.00247%,2:0.00053%,15:0.00035%,8:0.00018%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1535 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0789 - tp: 78378.0000 - fp: 1622.0000 - tn: 318378.0000 - fn: 1622.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9981 - val_loss: 0.0197 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0791 - tp: 78374.0000 - fp: 1626.0000 - tn: 318374.0000 - fn: 1626.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9981 - val_loss: 0.0199 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0782 - tp: 78397.0000 - fp: 1603.0000 - tn: 318397.0000 - fn: 1603.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9981 - val_loss: 0.0197 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0797 - tp: 78357.0000 - fp: 1643.0000 - tn: 318357.0000 - fn: 1643.0000 - accuracy: 0.9918 - precision: 0.9795 - recall: 0.9795 - auc: 0.9981 - val_loss: 0.0210 - val_tp: 19993.0000 - val_fp: 7.0000 - val_tn: 79993.0000 - val_fn: 7.0000 - val_accuracy: 0.9999 - val_precision: 0.9997 - val_recall: 0.9997 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0801 - tp: 78344.0000 - fp: 1656.0000 - tn: 318344.0000 - fn: 1656.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9981 - val_loss: 0.0203 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 49-49/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99735%,30:0.00088%,17:0.00071%,26:0.00035%,22:0.00035%,28:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.37493%,Single Stage Single Point:35.62507%]
[INFO] ** dst:[21:43.31338%,10:21.0573%,8:18.13441%,9:17.49048%,22:0.00141%,15:0.00088%,16:0.00071%,6:0.00071%,24:0.00035%,17:0.00035%]
[INFO] ** i/f_dir:[1:99.99912%,0:0.00088%]
[INFO] ** i/f_name:[2:99.99912%,3:0.00088%]
[INFO] ** modbus_function_code:[0.02961:99.99735%,-33.760870000000004:0.00265%]
[INFO] ** modbus_function_description:[7:49.99965%,11:49.9977%,0:0.00265%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99841%,1:0.00088%,2:0.00071%]
[INFO] ** proxy_src_ip:[18:38.42246%,20:25.94893%,13:18.13459%,6:17.49101%,17:0.00088%,1:0.00071%,14:0.00053%,21:0.00035%,16:0.00035%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.94805%,-0.32151:21.0573%,-1.27613:18.13406%,-0.23351:17.4903%,-0.33484:17.36516%,-71.33197:0.00088%,1.45709:0.00053%,-0.24151:0.00053%,-1.27347:0.00035%,-71.14931:0.00035%,-1.02014:0.00035%,-71.14798:0.00035%,1.47576:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,1.46509:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,-5.08665:0.00018%,-0.24950999999999998:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:25.94769%,1:21.05712%,5:18.13388%,4:17.48995%,2:17.36516%,0:0.00619%]
[INFO] ** service:[0.0048200000000000005:99.99735%,-211.73542999999998:0.00088%,-205.44247:0.00071%,-211.08346:0.00035%,-211.08818:0.00035%,-211.09762999999998:0.00018%,-185.9872:0.00018%]
[INFO] ** src:[22:38.42246%,9:25.94893%,7:18.13459%,1:17.49101%,14:0.00088%,3:0.00071%,2:0.00053%,15:0.00035%,4:0.00035%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1536 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0784 - tp: 78393.0000 - fp: 1607.0000 - tn: 318393.0000 - fn: 1607.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9981 - val_loss: 0.0197 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0800 - tp: 78349.0000 - fp: 1651.0000 - tn: 318349.0000 - fn: 1651.0000 - accuracy: 0.9917 - precision: 0.9794 - recall: 0.9794 - auc: 0.9981 - val_loss: 0.0199 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0766 - tp: 78442.0000 - fp: 1558.0000 - tn: 318442.0000 - fn: 1558.0000 - accuracy: 0.9922 - precision: 0.9805 - recall: 0.9805 - auc: 0.9982 - val_loss: 0.0193 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0775 - tp: 78419.0000 - fp: 1581.0000 - tn: 318419.0000 - fn: 1581.0000 - accuracy: 0.9921 - precision: 0.9802 - recall: 0.9802 - auc: 0.9981 - val_loss: 0.0197 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0764 - tp: 78446.0000 - fp: 1554.0000 - tn: 318446.0000 - fn: 1554.0000 - accuracy: 0.9922 - precision: 0.9806 - recall: 0.9806 - auc: 0.9982 - val_loss: 0.0190 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 50-50/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (415724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (415724, 17)

[INFO] analyzing data
[INFO] 415724 rows
[INFO] ** appi_name:[21:99.99759%,30:0.00096%,7:0.00072%,31:0.00024%,22:0.00024%,8:0.00024%]
[INFO] ** classification:[normal:64.30733%,Single Stage Single Point:35.69267%]
[INFO] ** dst:[21:43.26139%,10:21.04281%,8:18.21834%,9:17.47409%,15:0.00096%,22:0.00072%,16:0.00048%,2:0.00048%,24:0.00024%,18:0.00024%,6:0.00024%]
[INFO] ** i/f_dir:[1:99.99904%,0:0.00096%]
[INFO] ** i/f_name:[2:99.99904%,3:0.00096%]
[INFO] ** modbus_function_code:[0.02961:99.99759%,-33.760870000000004:0.00241%]
[INFO] ** modbus_function_description:[11:49.9988%,7:49.9988%,0:0.00241%]
[INFO] ** modbus_transaction_id:65536 (15.76431%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99856%,1:0.00096%,2:0.00048%]
[INFO] ** proxy_src_ip:[18:38.3656%,20:25.93884%,13:18.21858%,6:17.47409%,17:0.00096%,1:0.00072%,16:0.00048%,21:0.00024%,14:0.00024%,7:0.00024%]
[INFO] ** s_port:[1.45442:25.93836%,-0.32151:21.04281%,-1.27613:18.2181%,-0.23351:17.47409%,-0.33484:17.32279%,-71.33197:0.00096%,-1.02014:0.00048%,-3.3787199999999995:0.00024%,4.33564:0.00024%,15.912510000000001:0.00024%,7.9608300000000005:0.00024%,1.46509:0.00024%,1.45709:0.00024%,-1.27347:0.00024%,-71.14931:0.00024%,-1.2708:0.00024%,0.31847:0.00024%]
[INFO] ** scada_tag:[3:25.93812%,1:21.04257%,5:18.21786%,4:17.47409%,2:17.32255%,0:0.00481%]
[INFO] ** service:[0.0048200000000000005:99.99759%,-211.73542999999998:0.00096%,-211.09762999999998:0.00072%,-186.43601999999998:0.00024%,-211.35747999999998:0.00024%,-211.08818:0.00024%]
[INFO] ** src:[22:38.3656%,9:25.93884%,7:18.21858%,1:17.47409%,14:0.00096%,3:0.00072%,15:0.00048%,21:0.00024%,4:0.00024%,2:0.00024%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1130 (0.27181%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/415724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0774 - tp: 78421.0000 - fp: 1579.0000 - tn: 318421.0000 - fn: 1579.0000 - accuracy: 0.9921 - precision: 0.9803 - recall: 0.9803 - auc: 0.9981 - val_loss: 0.0192 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/415724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0776 - tp: 78417.0000 - fp: 1583.0000 - tn: 318417.0000 - fn: 1583.0000 - accuracy: 0.9921 - precision: 0.9802 - recall: 0.9802 - auc: 0.9981 - val_loss: 0.0195 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/415724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0802 - tp: 78344.0000 - fp: 1656.0000 - tn: 318344.0000 - fn: 1656.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9980 - val_loss: 0.0198 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/415724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0788 - tp: 78383.0000 - fp: 1617.0000 - tn: 318383.0000 - fn: 1617.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9981 - val_loss: 0.0196 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-49-50-batch-300000-400000
[INFO] processing batch 400000-500000/415724
[33m[INFO] epoch 3/10[0m
[33m[INFO] loading file 1-1/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99302%,30:0.00116%,22:0.00097%,17:0.00078%,31:0.00058%,26:0.00058%,7:0.00058%,23:0.00039%,18:0.00039%,0:0.00039%,28:0.00019%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:78.84217%,Single Stage Single Point:21.15783%]
[INFO] ** dst:[21:43.26578%,10:21.04381%,8:18.16766%,9:17.51538%,6:0.00155%,16:0.00116%,15:0.00116%,22:0.00097%,18:0.00058%,26:0.00039%,25:0.00039%,19:0.00039%,17:0.00039%,24:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99884%,0:0.00116%]
[INFO] ** i/f_name:[2:99.99884%,3:0.00116%]
[INFO] ** modbus_function_code:[0.02961:99.99302%,-33.760870000000004:0.00679%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99748%,11:49.99554%,0:0.00679%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99612%,2:0.00271%,1:0.00116%]
[INFO] ** proxy_src_ip:[18:38.40523%,20:25.90378%,13:18.16786%,6:17.51576%,11:0.00136%,10:0.00136%,17:0.00116%,14:0.00097%,1:0.00097%,7:0.00058%,21:0.00039%,16:0.00039%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.90339%,-0.32151:21.04304%,-1.27613:18.16747%,-0.23351:17.51518%,-0.33484:17.36219%,-71.33197:0.00116%,-71.14931:0.00097%,-2.1481:0.00078%,-0.24151:0.00058%,-71.14798:0.00058%,-2.42942:0.00039%,4.44364:0.00039%,-1.02014:0.00039%,-64.19493:0.00039%,-5.1466400000000005:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,4.076980000000001:0.00019%,-5.08665:0.00019%,1.47576:0.00019%,1.46509:0.00019%,4.29964:0.00019%,14.253910000000001:0.00019%,-68.79874000000001:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,10.67005:0.00019%,-1.27347:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:25.9032%,1:21.04284%,5:18.16708%,4:17.51499%,2:17.362%,0:0.00989%]
[INFO] ** service:[0.0048200000000000005:99.9938%,-211.73542999999998:0.00116%,-211.08818:0.00097%,-205.44247:0.00078%,-211.07873999999998:0.00078%,-211.09762999999998:0.00058%,-211.08346:0.00058%,-186.43601999999998:0.00058%,-186.44547:0.00039%,-185.9872:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.40523%,9:25.90378%,7:18.16786%,1:17.51576%,11:0.00136%,10:0.00136%,14:0.00116%,3:0.00097%,2:0.00097%,21:0.00058%,15:0.00039%,4:0.00039%,8:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1400 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5233 - tp: 61376.0000 - fp: 18624.0000 - tn: 301376.0000 - fn: 18624.0000 - accuracy: 0.9069 - precision: 0.7672 - recall: 0.7672 - auc: 0.9807 - val_loss: 0.0177 - val_tp: 19780.0000 - val_fp: 220.0000 - val_tn: 79780.0000 - val_fn: 220.0000 - val_accuracy: 0.9956 - val_precision: 0.9890 - val_recall: 0.9890 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0535 - tp: 77419.0000 - fp: 2581.0000 - tn: 317419.0000 - fn: 2581.0000 - accuracy: 0.9871 - precision: 0.9677 - recall: 0.9677 - auc: 0.9997 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0475 - tp: 77545.0000 - fp: 2455.0000 - tn: 317545.0000 - fn: 2455.0000 - accuracy: 0.9877 - precision: 0.9693 - recall: 0.9693 - auc: 0.9998 - val_loss: 1.8076 - val_tp: 17757.0000 - val_fp: 2243.0000 - val_tn: 77757.0000 - val_fn: 2243.0000 - val_accuracy: 0.9551 - val_precision: 0.8878 - val_recall: 0.8878 - val_auc: 0.9299
[INFO] saving weights to checkpoints/lstm-epoch-3-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.4866 - tp: 57774.0000 - fp: 22226.0000 - tn: 297774.0000 - fn: 22226.0000 - accuracy: 0.8889 - precision: 0.7222 - recall: 0.7222 - auc: 0.8518 - val_loss: 2.7431e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2340 - tp: 75893.0000 - fp: 4107.0000 - tn: 315893.0000 - fn: 4107.0000 - accuracy: 0.9795 - precision: 0.9487 - recall: 0.9487 - auc: 0.9902 - val_loss: 1.4557e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 2-2/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99864%,7:0.00058%,30:0.00039%,31:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:72.18764%,Single Stage Single Point:27.81236%]
[INFO] ** dst:[21:43.31348%,10:21.03199%,8:18.13606%,9:17.51615%,22:0.00078%,16:0.00039%,15:0.00039%,2:0.00039%,24:0.00019%,18:0.00019%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99961%,3:0.00039%]
[INFO] ** modbus_function_code:[0.02961:99.99864%,-33.760870000000004:0.00136%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99884%,0:0.00136%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99942%,1:0.00039%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.38545%,20:25.96059%,13:18.13606%,6:17.51635%,1:0.00058%,17:0.00039%,16:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.95982%,-0.32151:21.03199%,-1.27613:18.13567%,-0.23351:17.51596%,-0.33484:17.35347%,-71.33197:0.00039%,1.45709:0.00039%,12.60597:0.00019%,-1.2708:0.00019%,-1.02014:0.00019%,-0.24151:0.00019%,4.076980000000001:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-1.27347:0.00019%,-3.3787199999999995:0.00019%,-0.24950999999999998:0.00019%,10.67005:0.00019%,4.29964:0.00019%]
[INFO] ** scada_tag:[3:25.95943%,1:21.03199%,5:18.13567%,4:17.51576%,2:17.35327%,0:0.00388%]
[INFO] ** service:[0.0048200000000000005:99.99864%,-211.09762999999998:0.00058%,-211.73542999999998:0.00039%,-186.43601999999998:0.00019%,-211.35747999999998:0.00019%]
[INFO] ** src:[22:38.38545%,9:25.96059%,7:18.13606%,1:17.51635%,3:0.00058%,14:0.00039%,21:0.00019%,15:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1403 (0.27204%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1912 - tp: 76765.0000 - fp: 3235.0000 - tn: 316765.0000 - fn: 3235.0000 - accuracy: 0.9838 - precision: 0.9596 - recall: 0.9596 - auc: 0.9913 - val_loss: 4.7411e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2409 - tp: 59558.0000 - fp: 20442.0000 - tn: 299558.0000 - fn: 20442.0000 - accuracy: 0.8978 - precision: 0.7445 - recall: 0.7445 - auc: 0.9278 - val_loss: 0.7075 - val_tp: 11435.0000 - val_fp: 8565.0000 - val_tn: 71435.0000 - val_fn: 8565.0000 - val_accuracy: 0.8287 - val_precision: 0.5717 - val_recall: 0.5717 - val_auc: 0.9475
[INFO] saving weights to checkpoints/lstm-epoch-3-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0758 - tp: 76899.0000 - fp: 3101.0000 - tn: 316899.0000 - fn: 3101.0000 - accuracy: 0.9845 - precision: 0.9612 - recall: 0.9612 - auc: 0.9982 - val_loss: 5.5096 - val_tp: 10613.0000 - val_fp: 9387.0000 - val_tn: 70613.0000 - val_fn: 9387.0000 - val_accuracy: 0.8123 - val_precision: 0.5307 - val_recall: 0.5307 - val_auc: 0.7067
[INFO] saving weights to checkpoints/lstm-epoch-3-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1886 - tp: 76004.0000 - fp: 3996.0000 - tn: 316004.0000 - fn: 3996.0000 - accuracy: 0.9800 - precision: 0.9500 - recall: 0.9500 - auc: 0.9920 - val_loss: 3.2761e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6772 - tp: 59361.0000 - fp: 20639.0000 - tn: 299361.0000 - fn: 20639.0000 - accuracy: 0.8968 - precision: 0.7420 - recall: 0.7420 - auc: 0.9562 - val_loss: 0.3749 - val_tp: 13337.0000 - val_fp: 6663.0000 - val_tn: 73337.0000 - val_fn: 6663.0000 - val_accuracy: 0.8667 - val_precision: 0.6668 - val_recall: 0.6668 - val_auc: 0.9592
[INFO] saving weights to checkpoints/lstm-epoch-3-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 3-3/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99108%,30:0.00233%,22:0.00116%,31:0.00097%,26:0.00097%,17:0.00097%,7:0.00078%,27:0.00039%,0:0.00039%,28:0.00019%,23:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:87.11675%,Single Stage Single Point:12.88325%]
[INFO] ** dst:[21:43.30611%,10:21.08861%,8:18.1539%,9:17.4415%,6:0.00233%,15:0.00155%,18:0.00136%,16:0.00136%,22:0.00097%,2:0.00039%,7:0.00039%,25:0.00039%,17:0.00039%,12:0.00019%,24:0.00019%,19:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99845%,0:0.00155%]
[INFO] ** i/f_name:[2:99.99845%,3:0.00155%]
[INFO] ** modbus_function_code:[0.02961:99.99108%,-33.760870000000004:0.00873%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99632%,11:49.99476%,0:0.00873%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99884%,2:0.00116%]
[INFO] ** proto:[0:99.9938%,2:0.00465%,1:0.00155%]
[INFO] ** proxy_src_ip:[18:38.42036%,20:25.97475%,13:18.15409%,6:17.44189%,17:0.00233%,1:0.00155%,14:0.00136%,7:0.00097%,11:0.00078%,10:0.00078%,21:0.00058%,16:0.00019%,15:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.97397%,-0.32151:21.08841%,-1.27613:18.15351%,-0.23351:17.44131%,-0.33484:17.33194%,-71.33197:0.00155%,-71.14798:0.00116%,-71.14931:0.00116%,-64.19493:0.00039%,-0.08551:0.00039%,1.45709:0.00039%,-0.24151:0.00039%,13.431270000000001:0.00019%,14.4699:0.00019%,4.076980000000001:0.00019%,-5.1466400000000005:0.00019%,-1.02014:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,12.60597:0.00019%,-5.08665:0.00019%,1.46509:0.00019%,-2.1481:0.00019%,-1.27347:0.00019%,10.67005:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,6.1115699999999995:0.00019%,4.44364:0.00019%,13.86459:0.00019%,4.29964:0.00019%,-0.24950999999999998:0.00019%,-3.3787199999999995:0.00019%,10.192739999999999:0.00019%,-68.79874000000001:0.00019%,14.253910000000001:0.00019%,4.90362:0.00019%,-68.36943000000001:0.00019%]
[INFO] ** scada_tag:[3:25.97358%,1:21.08822%,5:18.15331%,4:17.44111%,2:17.33175%,0:0.01202%]
[INFO] ** service:[0.0048200000000000005:99.99127%,-211.73542999999998:0.00155%,-186.43601999999998:0.00136%,-211.08346:0.00116%,-211.08818:0.00116%,-205.44247:0.00097%,-211.09762999999998:0.00078%,-186.44547:0.00039%,-202.75898:0.00039%,-183.8612:0.00019%,-185.9872:0.00019%,-201.23771000000002:0.00019%,-211.35747999999998:0.00019%,-211.07873999999998:0.00019%]
[INFO] ** src:[22:38.42036%,9:25.97475%,7:18.15409%,1:17.44189%,21:0.00213%,3:0.00175%,2:0.00136%,11:0.00078%,10:0.00078%,4:0.00078%,14:0.00039%,8:0.00039%,17:0.00019%,15:0.00019%,13:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1400 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2135 - tp: 73206.0000 - fp: 6794.0000 - tn: 313206.0000 - fn: 6794.0000 - accuracy: 0.9660 - precision: 0.9151 - recall: 0.9151 - auc: 0.9927 - val_loss: 0.0486 - val_tp: 19997.0000 - val_fp: 3.0000 - val_tn: 79997.0000 - val_fn: 3.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2987 - tp: 68859.0000 - fp: 11141.0000 - tn: 308859.0000 - fn: 11141.0000 - accuracy: 0.9443 - precision: 0.8607 - recall: 0.8607 - auc: 0.9855 - val_loss: 0.9715 - val_tp: 10634.0000 - val_fp: 9366.0000 - val_tn: 70634.0000 - val_fn: 9366.0000 - val_accuracy: 0.8127 - val_precision: 0.5317 - val_recall: 0.5317 - val_auc: 0.9449
[INFO] saving weights to checkpoints/lstm-epoch-3-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0532 - tp: 77469.0000 - fp: 2531.0000 - tn: 317469.0000 - fn: 2531.0000 - accuracy: 0.9873 - precision: 0.9684 - recall: 0.9684 - auc: 0.9995 - val_loss: 7.2939e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0318 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.6776e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0252 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.0972e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 4-4/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99767%,30:0.00136%,31:0.00039%,33:0.00019%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:91.51096%,Single Stage Single Point:8.48904%]
[INFO] ** dst:[21:43.35517%,10:20.94143%,8:18.17174%,9:17.52817%,15:0.00136%,22:0.00116%,18:0.00039%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99884%,0:0.00116%]
[INFO] ** i/f_name:[2:99.99864%,3:0.00136%]
[INFO] ** modbus_function_code:[0.02961:99.99767%,-33.760870000000004:0.00233%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99787%,0:0.00233%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99884%,2:0.00116%]
[INFO] ** proto:[0:99.99806%,1:0.00136%,2:0.00058%]
[INFO] ** proxy_src_ip:[18:38.25884%,20:26.03815%,13:18.17174%,6:17.52856%,17:0.00136%,21:0.00039%,16:0.00039%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.03738%,-0.32151:20.94124%,-1.27613:18.17135%,-0.23351:17.52798%,-0.33484:17.3176%,-71.33197:0.00136%,1.45709:0.00039%,-0.24151:0.00039%,-1.02014:0.00039%,-0.08551:0.00039%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,14.4699:0.00019%,-49.275529999999996:0.00019%,-1.2708:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:26.03718%,1:20.94105%,5:18.17135%,4:17.52759%,2:17.3174%,0:0.00543%]
[INFO] ** service:[0.0048200000000000005:99.99787%,-211.73542999999998:0.00136%,-186.43601999999998:0.00039%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.25884%,9:26.03815%,7:18.17174%,1:17.52856%,21:0.00116%,15:0.00039%,4:0.00039%,17:0.00019%,14:0.00019%,8:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1411 (0.2736%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0187 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.6567e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0137 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1001e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0113 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4755e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0091 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.6758 - val_tp: 8906.0000 - val_fp: 11094.0000 - val_tn: 68906.0000 - val_fn: 11094.0000 - val_accuracy: 0.7781 - val_precision: 0.4453 - val_recall: 0.4453 - val_auc: 0.6533
[INFO] saving weights to checkpoints/lstm-epoch-3-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.5031 - tp: 45641.0000 - fp: 34359.0000 - tn: 285641.0000 - fn: 34359.0000 - accuracy: 0.8282 - precision: 0.5705 - recall: 0.5705 - auc: 0.8431 - val_loss: 0.4733 - val_tp: 12752.0000 - val_fp: 7248.0000 - val_tn: 72752.0000 - val_fn: 7248.0000 - val_accuracy: 0.8550 - val_precision: 0.6376 - val_recall: 0.6376 - val_auc: 0.9328
[INFO] saving weights to checkpoints/lstm-epoch-3-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 5-5/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.9967%,30:0.00233%,37:0.00019%,26:0.00019%,12:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:89.07458%,Single Stage Single Point:10.92542%]
[INFO] ** dst:[21:43.36641%,10:20.76285%,8:18.24813%,9:17.61873%,15:0.00233%,22:0.00078%,25:0.00019%,24:0.00019%,6:0.00019%,2:0.00019%]
[INFO] ** i/f_dir:[1:99.99806%,0:0.00194%]
[INFO] ** i/f_name:[2:99.99767%,3:0.00233%]
[INFO] ** modbus_function_code:[0.02961:99.9967%,-33.760870000000004:0.0033%]
[INFO] ** modbus_function_description:[7:49.99884%,11:49.99787%,0:0.0033%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99825%,2:0.00175%]
[INFO] ** proto:[0:99.99729%,1:0.00233%,2:0.00039%]
[INFO] ** proxy_src_ip:[18:37.99416%,20:26.13491%,13:18.24833%,6:17.61911%,17:0.00233%,21:0.00019%,16:0.00019%,7:0.00019%,5:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.13472%,-0.32151:20.76246%,-1.27613:18.24813%,-0.23351:17.61873%,-0.33484:17.2317%,-71.33197:0.00233%,-0.24151:0.00039%,-71.14798:0.00019%,-1.27347:0.00019%,1.45709:0.00019%,2.22906:0.00019%,-49.275529999999996:0.00019%,-61.95768:0.00019%,-1.02014:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:26.13433%,1:20.76227%,5:18.24794%,4:17.61873%,2:17.2317%,0:0.00504%]
[INFO] ** service:[0.0048200000000000005:99.99709%,-211.73542999999998:0.00233%,-186.44547:0.00019%,-211.08346:0.00019%,-211.35747999999998:0.00019%]
[INFO] ** src:[22:37.99416%,9:26.13491%,7:18.24833%,1:17.61911%,21:0.00194%,14:0.00058%,16:0.00019%,15:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1409 (0.27321%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2480 - tp: 68192.0000 - fp: 11808.0000 - tn: 308192.0000 - fn: 11808.0000 - accuracy: 0.9410 - precision: 0.8524 - recall: 0.8524 - auc: 0.9879 - val_loss: 0.2066 - val_tp: 18761.0000 - val_fp: 1239.0000 - val_tn: 78761.0000 - val_fn: 1239.0000 - val_accuracy: 0.9752 - val_precision: 0.9380 - val_recall: 0.9380 - val_auc: 0.9977
[INFO] saving weights to checkpoints/lstm-epoch-3-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0519 - tp: 77927.0000 - fp: 2073.0000 - tn: 317927.0000 - fn: 2073.0000 - accuracy: 0.9896 - precision: 0.9741 - recall: 0.9741 - auc: 0.9996 - val_loss: 1.7818e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1946 - tp: 77697.0000 - fp: 2303.0000 - tn: 317697.0000 - fn: 2303.0000 - accuracy: 0.9885 - precision: 0.9712 - recall: 0.9712 - auc: 0.9909 - val_loss: 0.0173 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7134e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0134 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.4353e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 6-6/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99554%,30:0.00349%,31:0.00019%,27:0.00019%,26:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:92.16538%,Single Stage Single Point:7.83462%]
[INFO] ** dst:[21:43.37708%,10:20.7295%,8:18.28517%,9:17.60321%,15:0.00349%,22:0.00039%,25:0.00019%,24:0.00019%,18:0.00019%,12:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.9967%,0:0.0033%]
[INFO] ** i/f_name:[2:99.99651%,3:0.00349%]
[INFO] ** modbus_function_code:[0.02961:99.99554%,-33.760870000000004:0.00446%]
[INFO] ** modbus_function_description:[7:49.99845%,11:49.99709%,0:0.00446%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99961%,1:0.00039%]
[INFO] ** proto:[0:99.99554%,1:0.00349%,2:0.00097%]
[INFO] ** proxy_src_ip:[18:37.94665%,20:26.16012%,13:18.28536%,6:17.60341%,17:0.00349%,14:0.00058%,16:0.00019%,11:0.00019%]
[INFO] ** s_port:[1.45442:26.15973%,-0.32151:20.7295%,-1.27613:18.28478%,-0.23351:17.60302%,-0.33484:17.21715%,-71.33197:0.00349%,-0.24151:0.00019%,-1.2708:0.00019%,-64.19493:0.00019%,-1.02014:0.00019%,13.431270000000001:0.00019%,4.90362:0.00019%,-71.14798:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-1.27347:0.00019%,-68.36943000000001:0.00019%]
[INFO] ** scada_tag:[3:26.15953%,1:20.7293%,5:18.28459%,4:17.60263%,2:17.21696%,0:0.00698%]
[INFO] ** service:[0.0048200000000000005:99.99554%,-211.73542999999998:0.00349%,-186.44547:0.00019%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-201.23771000000002:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:37.94665%,9:26.16012%,7:18.28536%,1:17.60341%,14:0.00349%,2:0.00058%,15:0.00019%,10:0.00019%]
[INFO] ** type:[0:99.99903%,1:0.00097%]
[INFO] ** unixtime:1412 (0.27379%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0106 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.6455e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0075 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0954e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0062 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0859e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0055 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.0851e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2443 - tp: 75856.0000 - fp: 4144.0000 - tn: 315856.0000 - fn: 4144.0000 - accuracy: 0.9793 - precision: 0.9482 - recall: 0.9482 - auc: 0.9881 - val_loss: 0.0076 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 7-7/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99535%,30:0.00136%,22:0.00097%,17:0.00078%,26:0.00058%,31:0.00039%,28:0.00019%,27:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:82.14064%,Single Stage Single Point:17.85936%]
[INFO] ** dst:[21:43.36157%,10:20.74695%,8:18.24794%,9:17.63715%,6:0.00155%,22:0.00136%,15:0.00136%,16:0.00078%,24:0.00039%,18:0.00039%,17:0.00039%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99864%,0:0.00136%]
[INFO] ** i/f_name:[2:99.99864%,3:0.00136%]
[INFO] ** modbus_function_code:[0.02961:99.99535%,-33.760870000000004:0.00465%]
[INFO] ** modbus_function_description:[7:49.99845%,11:49.9969%,0:0.00465%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99651%,2:0.00213%,1:0.00136%]
[INFO] ** proxy_src_ip:[18:37.97147%,20:26.13782%,13:18.24833%,6:17.63734%,17:0.00136%,11:0.00078%,1:0.00078%,21:0.00058%,16:0.00039%,14:0.00039%,7:0.00039%,10:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.13685%,-0.32151:20.74695%,-1.27613:18.24774%,-0.23351:17.63695%,-0.33484:17.22452%,-71.33197:0.00136%,-71.14931:0.00097%,-71.14798:0.00058%,1.45709:0.00058%,-1.02014:0.00039%,-1.27347:0.00039%,-0.24151:0.00039%,-58.035180000000004:0.00019%,-1.2708:0.00019%,-5.1466400000000005:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-5.08665:0.00019%,14.253910000000001:0.00019%,-68.79874000000001:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:26.13646%,1:20.74695%,5:18.24774%,4:17.63676%,2:17.22452%,0:0.00756%]
[INFO] ** service:[0.0048200000000000005:99.99535%,-211.73542999999998:0.00136%,-211.08818:0.00097%,-205.44247:0.00078%,-211.08346:0.00058%,-186.43601999999998:0.00039%,-211.09762999999998:0.00019%,-185.9872:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:37.97147%,9:26.13782%,7:18.24833%,1:17.63734%,14:0.00136%,10:0.00078%,3:0.00078%,4:0.00058%,21:0.00039%,15:0.00039%,2:0.00039%,11:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1409 (0.27321%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0500 - tp: 78471.0000 - fp: 1529.0000 - tn: 318471.0000 - fn: 1529.0000 - accuracy: 0.9924 - precision: 0.9809 - recall: 0.9809 - auc: 0.9995 - val_loss: 2.8066e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0432 - tp: 78518.0000 - fp: 1482.0000 - tn: 318518.0000 - fn: 1482.0000 - accuracy: 0.9926 - precision: 0.9815 - recall: 0.9815 - auc: 0.9997 - val_loss: 4.3731e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2986 - tp: 68433.0000 - fp: 11567.0000 - tn: 308433.0000 - fn: 11567.0000 - accuracy: 0.9422 - precision: 0.8554 - recall: 0.8554 - auc: 0.9855 - val_loss: 0.2975 - val_tp: 13482.0000 - val_fp: 6518.0000 - val_tn: 73482.0000 - val_fn: 6518.0000 - val_accuracy: 0.8696 - val_precision: 0.6741 - val_recall: 0.6741 - val_auc: 0.9695
[INFO] saving weights to checkpoints/lstm-epoch-3-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0234 - tp: 79822.0000 - fp: 178.0000 - tn: 319822.0000 - fn: 178.0000 - accuracy: 0.9991 - precision: 0.9978 - recall: 0.9978 - auc: 1.0000 - val_loss: 8.5245e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0135 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3638e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 8-8/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99709%,30:0.00097%,0:0.00058%,24:0.00019%,23:0.00019%,22:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:94.45866%,Single Stage Single Point:5.54134%]
[INFO] ** dst:[21:43.43312%,10:20.81133%,8:18.1727%,9:17.57917%,22:0.00136%,15:0.00097%,25:0.00058%,19:0.00039%,26:0.00019%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99942%,0:0.00058%]
[INFO] ** i/f_name:[2:99.99903%,3:0.00097%]
[INFO] ** modbus_function_code:[0.02961:99.99709%,-33.760870000000004:0.00271%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99961%,11:49.99748%,0:0.00271%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99961%,2:0.00039%]
[INFO] ** proto:[0:99.99825%,1:0.00097%,2:0.00078%]
[INFO] ** proxy_src_ip:[18:38.10003%,20:26.14499%,13:18.17193%,6:17.57956%,10:0.00116%,17:0.00097%,16:0.00058%,14:0.00039%,11:0.00019%,5:0.00019%]
[INFO] ** s_port:[1.45442:26.14441%,-0.32151:20.81133%,-1.27613:18.17174%,-0.23351:17.57898%,-0.33484:17.2887%,-71.33197:0.00097%,-15.039579999999999:0.00078%,-1.02014:0.00058%,-64.19493:0.00058%,1.45709:0.00039%,-0.24151:0.00039%,4.66896:0.00039%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-71.14931:0.00019%]
[INFO] ** scada_tag:[3:26.14402%,1:20.81113%,5:18.17174%,4:17.57878%,2:17.28851%,0:0.00582%]
[INFO] ** service:[0.0048200000000000005:99.99787%,-211.73542999999998:0.00097%,-186.44547:0.00058%,-211.07873999999998:0.00039%,-211.08818:0.00019%]
[INFO] ** src:[22:38.10003%,9:26.14499%,7:18.17193%,1:17.57956%,11:0.00116%,15:0.00058%,14:0.00058%,21:0.00039%,2:0.00039%,16:0.00019%,10:0.00019%]
[INFO] ** type:[0:99.99942%,1:0.00039%,2:0.00019%]
[INFO] ** unixtime:1413 (0.27398%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0099 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6484e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0068 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.7503e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0050 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.0491e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1691 - tp: 75866.0000 - fp: 4134.0000 - tn: 315866.0000 - fn: 4134.0000 - accuracy: 0.9793 - precision: 0.9483 - recall: 0.9483 - auc: 0.9944 - val_loss: 0.3113 - val_tp: 16361.0000 - val_fp: 3639.0000 - val_tn: 76361.0000 - val_fn: 3639.0000 - val_accuracy: 0.9272 - val_precision: 0.8181 - val_recall: 0.8181 - val_auc: 0.9917
[INFO] saving weights to checkpoints/lstm-epoch-3-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0479 - tp: 78714.0000 - fp: 1286.0000 - tn: 318714.0000 - fn: 1286.0000 - accuracy: 0.9936 - precision: 0.9839 - recall: 0.9839 - auc: 0.9996 - val_loss: 4.9049e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 9-9/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99825%,30:0.00097%,31:0.00039%,26:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:95.67327%,Single Stage Single Point:4.32673%]
[INFO] ** dst:[21:43.3606%,10:20.77351%,8:18.28963%,9:17.57355%,15:0.00097%,22:0.00078%,18:0.00039%,25:0.00019%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99903%,0:0.00097%]
[INFO] ** i/f_name:[2:99.99903%,3:0.00097%]
[INFO] ** modbus_function_code:[0.02961:99.99825%,-33.760870000000004:0.00175%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99825%,0:0.00175%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99981%,2:0.00019%]
[INFO] ** proto:[0:99.99825%,1:0.00097%,2:0.00078%]
[INFO] ** proxy_src_ip:[18:38.00579%,20:26.1289%,13:18.28982%,6:17.57374%,17:0.00097%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.12812%,-0.32151:20.77351%,-1.27613:18.28943%,-0.23351:17.57335%,-0.33484:17.23228%,-71.33197:0.00097%,1.45709:0.00039%,-0.24151:0.00039%,-0.08551:0.00039%,-71.14798:0.00019%,-1.27347:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.12773%,1:20.77332%,5:18.28943%,4:17.57316%,2:17.23228%,0:0.00407%]
[INFO] ** service:[0.0048200000000000005:99.99825%,-211.73542999999998:0.00097%,-186.43601999999998:0.00039%,-186.44547:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.00579%,9:26.1289%,7:18.28982%,1:17.57374%,14:0.00078%,21:0.00019%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1411 (0.2736%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0333 - tp: 79132.0000 - fp: 868.0000 - tn: 319132.0000 - fn: 868.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9998 - val_loss: 1.8193e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1625 - tp: 75349.0000 - fp: 4651.0000 - tn: 315349.0000 - fn: 4651.0000 - accuracy: 0.9767 - precision: 0.9419 - recall: 0.9419 - auc: 0.9949 - val_loss: 0.0519 - val_tp: 19982.0000 - val_fp: 18.0000 - val_tn: 79982.0000 - val_fn: 18.0000 - val_accuracy: 0.9996 - val_precision: 0.9991 - val_recall: 0.9991 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0100 - tp: 79997.0000 - fp: 3.0000 - tn: 319997.0000 - fn: 3.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5399e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0064 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.9784e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0048 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0680e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 10-10/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99651%,30:0.00194%,24:0.00019%,23:0.00019%,22:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:94.07648%,Single Stage Single Point:5.92352%]
[INFO] ** dst:[21:43.41489%,10:20.81288%,8:18.22002%,9:17.54853%,15:0.00194%,22:0.00058%,24:0.00039%,19:0.00039%,26:0.00019%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99825%,0:0.00175%]
[INFO] ** i/f_name:[2:99.99806%,3:0.00194%]
[INFO] ** modbus_function_code:[0.02961:99.99651%,-33.760870000000004:0.0033%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99884%,11:49.99767%,0:0.0033%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99922%,1:0.00078%]
[INFO] ** proto:[0:99.99767%,1:0.00194%,2:0.00039%]
[INFO] ** proxy_src_ip:[18:38.09906%,20:26.12909%,13:18.22021%,6:17.54795%,17:0.00194%,10:0.00097%,14:0.00039%,16:0.00019%,5:0.00019%]
[INFO] ** s_port:[1.45442:26.12851%,-0.32151:20.81288%,-1.27613:18.21963%,-0.23351:17.54756%,-0.33484:17.28618%,-71.33197:0.00194%,-10.51843:0.00078%,5.71692:0.00039%,-1.27347:0.00039%,1.46509:0.00019%,1.47576:0.00019%,-0.24950999999999998:0.00019%,1.45709:0.00019%,-0.24151:0.00019%,-71.14931:0.00019%,-1.02014:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.12812%,1:20.81268%,5:18.21963%,4:17.54737%,2:17.28599%,0:0.0062%]
[INFO] ** service:[0.0048200000000000005:99.99729%,-211.73542999999998:0.00194%,-211.07873999999998:0.00039%,-186.44547:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.09906%,9:26.12909%,7:18.22021%,1:17.54795%,14:0.00194%,11:0.00097%,2:0.00039%,16:0.00019%,15:0.00019%]
[INFO] ** type:[0:99.99845%,1:0.00136%,2:0.00019%]
[INFO] ** unixtime:1409 (0.27321%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0038 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7083e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0027 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0235 - val_tp: 18412.0000 - val_fp: 1588.0000 - val_tn: 78412.0000 - val_fn: 1588.0000 - val_accuracy: 0.9682 - val_precision: 0.9206 - val_recall: 0.9206 - val_auc: 0.9504
[INFO] saving weights to checkpoints/lstm-epoch-3-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1892 - tp: 77079.0000 - fp: 2921.0000 - tn: 317079.0000 - fn: 2921.0000 - accuracy: 0.9854 - precision: 0.9635 - recall: 0.9635 - auc: 0.9921 - val_loss: 3.8359 - val_tp: 13136.0000 - val_fp: 6864.0000 - val_tn: 73136.0000 - val_fn: 6864.0000 - val_accuracy: 0.8627 - val_precision: 0.6568 - val_recall: 0.6568 - val_auc: 0.7855
[INFO] saving weights to checkpoints/lstm-epoch-3-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1312 - tp: 78669.0000 - fp: 1331.0000 - tn: 318669.0000 - fn: 1331.0000 - accuracy: 0.9933 - precision: 0.9834 - recall: 0.9834 - auc: 0.9935 - val_loss: 7.3301e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0047 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5168e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 11-11/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99884%,31:0.00039%,30:0.00039%,26:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.38483%,10:20.88055%,8:18.19791%,9:17.53418%,22:0.00136%,18:0.00039%,15:0.00039%,25:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99961%,3:0.00039%]
[INFO] ** modbus_function_code:[0.02961:99.99884%,-33.760870000000004:0.00116%]
[INFO] ** modbus_function_description:[7:50.00058%,11:49.99825%,0:0.00116%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99884%,2:0.00078%,1:0.00039%]
[INFO] ** proxy_src_ip:[18:38.1487%,20:26.11707%,13:18.19791%,6:17.53457%,16:0.00058%,17:0.00039%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.11649%,-0.32151:20.88055%,-1.27613:18.19772%,-0.23351:17.53399%,-0.33484:17.26815%,-0.24151:0.00058%,-1.02014:0.00058%,-0.08551:0.00039%,-71.33197:0.00039%,-71.14798:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.1161%,1:20.88055%,5:18.19752%,4:17.5336%,2:17.26796%,0:0.00427%]
[INFO] ** service:[0.0048200000000000005:99.99884%,-211.73542999999998:0.00039%,-186.43601999999998:0.00039%,-186.44547:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.1487%,9:26.11707%,7:18.19791%,1:17.53457%,15:0.00058%,14:0.00039%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1410 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0036 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5351e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0029 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4753e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0024 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2381e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0022 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2061e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0020 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1991e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 12-12/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99767%,30:0.00213%,9:0.00019%]
[INFO] ** classification:[normal:92.98249%,Single Stage Single Point:7.01751%]
[INFO] ** dst:[21:43.3922%,10:20.87221%,8:18.1919%,9:17.54039%,15:0.00213%,22:0.00058%,24:0.00039%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99825%,0:0.00175%]
[INFO] ** i/f_name:[2:99.99787%,3:0.00213%]
[INFO] ** modbus_function_code:[0.02961:99.99767%,-33.760870000000004:0.00233%]
[INFO] ** modbus_function_description:[7:49.99961%,11:49.99806%,0:0.00233%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99825%,2:0.00175%]
[INFO] ** proto:[0:99.99787%,1:0.00213%]
[INFO] ** proxy_src_ip:[18:38.139%,20:26.1258%,13:18.19209%,6:17.54058%,17:0.00213%,16:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:26.12521%,-0.32151:20.87221%,-1.27613:18.19151%,-0.23351:17.5402%,-0.33484:17.26679%,-71.33197:0.00213%,-1.27347:0.00039%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.12483%,1:20.87221%,5:18.19151%,4:17.53981%,2:17.26679%,0:0.00485%]
[INFO] ** service:[0.0048200000000000005:99.99767%,-211.73542999999998:0.00213%,-183.8612:0.00019%]
[INFO] ** src:[22:38.139%,9:26.1258%,7:18.19209%,1:17.54058%,21:0.00175%,14:0.00039%,15:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1410 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0019 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1934e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0018 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4844 - tp: 72362.0000 - fp: 7638.0000 - tn: 312362.0000 - fn: 7638.0000 - accuracy: 0.9618 - precision: 0.9045 - recall: 0.9045 - auc: 0.9756 - val_loss: 0.0305 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1483 - tp: 76564.0000 - fp: 3436.0000 - tn: 316564.0000 - fn: 3436.0000 - accuracy: 0.9828 - precision: 0.9571 - recall: 0.9571 - auc: 0.9951 - val_loss: 0.0311 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0127 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0024 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 13-13/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99632%,31:0.00078%,26:0.00058%,0:0.00058%,30:0.00039%,22:0.00039%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:85.16396%,Single Stage Single Point:14.83604%]
[INFO] ** dst:[21:43.35439%,10:20.80008%,8:18.27935%,9:17.56191%,22:0.00116%,6:0.00097%,18:0.00078%,25:0.00058%,15:0.00039%,24:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99961%,3:0.00039%]
[INFO] ** modbus_function_code:[0.02961:99.99632%,-33.760870000000004:0.00349%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99884%,11:49.99748%,0:0.00349%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99709%,2:0.00252%,1:0.00039%]
[INFO] ** proxy_src_ip:[18:38.05214%,20:26.10272%,13:18.27954%,6:17.56133%,10:0.00116%,11:0.00097%,16:0.00058%,17:0.00039%,7:0.00039%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.10214%,-0.32151:20.80008%,-1.27613:18.27916%,-0.23351:17.56094%,-0.33484:17.25206%,-9.78512:0.00078%,-71.14798:0.00058%,-64.19493:0.00058%,-1.02014:0.00058%,-0.08551:0.00039%,-71.14931:0.00039%,-0.24151:0.00039%,-71.33197:0.00039%,-1.27347:0.00019%,1.46509:0.00019%,-68.79874000000001:0.00019%,14.540560000000001:0.00019%,1.45709:0.00019%,-1.2708:0.00019%,6.1115699999999995:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:26.10175%,1:20.79989%,5:18.27916%,4:17.56094%,2:17.25186%,0:0.0064%]
[INFO] ** service:[0.0048200000000000005:99.99709%,-186.43601999999998:0.00078%,-186.44547:0.00058%,-211.08346:0.00058%,-211.73542999999998:0.00039%,-211.08818:0.00039%,-202.75898:0.00019%]
[INFO] ** src:[22:38.05214%,9:26.10272%,7:18.27954%,1:17.56133%,11:0.00116%,10:0.00097%,15:0.00058%,21:0.00039%,14:0.00039%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1410 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0052 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1425e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0028 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3114e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0021 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1206e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3190 - tp: 74277.0000 - fp: 5723.0000 - tn: 314277.0000 - fn: 5723.0000 - accuracy: 0.9714 - precision: 0.9285 - recall: 0.9285 - auc: 0.9837 - val_loss: 0.0096 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0596 - tp: 78429.0000 - fp: 1571.0000 - tn: 318429.0000 - fn: 1571.0000 - accuracy: 0.9921 - precision: 0.9804 - recall: 0.9804 - auc: 0.9995 - val_loss: 0.0028 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 14-14/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99961%,30:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:95.53308%,Single Stage Single Point:4.46692%]
[INFO] ** dst:[21:43.34722%,10:20.81133%,8:18.26772%,9:17.57219%,22:0.00078%,24:0.00039%,15:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99961%,-33.760870000000004:0.00039%]
[INFO] ** modbus_function_description:[7:50.00097%,11:49.99864%,0:0.00039%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99981%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.05%,20:26.10912%,13:18.26791%,6:17.57238%,17:0.00019%,16:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:26.10834%,-0.32151:20.81133%,-1.27613:18.26733%,-0.23351:17.572%,-0.33484:17.23868%,-1.27347:0.00039%,1.45709:0.00039%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:26.10796%,1:20.81133%,5:18.26714%,4:17.57161%,2:17.23848%,0:0.00349%]
[INFO] ** service:[0.0048200000000000005:99.99961%,-183.8612:0.00019%,-211.73542999999998:0.00019%]
[INFO] ** src:[22:38.05%,9:26.10912%,7:18.26791%,1:17.57238%,15:0.00019%,14:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1409 (0.27321%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2717 - tp: 71054.0000 - fp: 8946.0000 - tn: 311054.0000 - fn: 8946.0000 - accuracy: 0.9553 - precision: 0.8882 - recall: 0.8882 - auc: 0.9887 - val_loss: 0.3994 - val_tp: 12807.0000 - val_fp: 7193.0000 - val_tn: 72807.0000 - val_fn: 7193.0000 - val_accuracy: 0.8561 - val_precision: 0.6403 - val_recall: 0.6403 - val_auc: 0.9677
[INFO] saving weights to checkpoints/lstm-epoch-3-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0267 - tp: 79579.0000 - fp: 421.0000 - tn: 319579.0000 - fn: 421.0000 - accuracy: 0.9979 - precision: 0.9947 - recall: 0.9947 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0097 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.9612e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0076 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6731e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0063 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0929e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 15-15/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99612%,30:0.0031%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:89.29078%,Single Stage Multi Point:10.70844%,Single Stage Single Point:0.00078%]
[INFO] ** dst:[21:43.29467%,10:20.77507%,8:18.316%,9:17.60884%,15:0.0031%,22:0.00155%,25:0.00019%,24:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.9969%,0:0.0031%]
[INFO] ** i/f_name:[2:99.9969%,3:0.0031%]
[INFO] ** modbus_function_code:[0.02961:99.99612%,-33.760870000000004:0.00388%]
[INFO] ** modbus_function_description:[7:49.99903%,11:49.99709%,0:0.00388%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99709%,2:0.00291%]
[INFO] ** proto:[0:99.99651%,1:0.0031%,2:0.00039%]
[INFO] ** proxy_src_ip:[18:38.00424%,20:26.06607%,13:18.3158%,6:17.60942%,17:0.0031%,16:0.00058%,7:0.00039%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.0653%,-0.32151:20.77487%,-1.27613:18.31561%,-0.23351:17.60864%,-0.33484:17.22937%,-71.33197:0.0031%,-1.02014:0.00058%,-0.24151:0.00058%,1.45709:0.00039%,-64.19493:0.00019%,-61.95768:0.00019%,-71.14798:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,10.192739999999999:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%]
[INFO] ** scada_tag:[3:26.06491%,1:20.77468%,5:18.31561%,4:17.60826%,2:17.22918%,0:0.00737%]
[INFO] ** service:[0.0048200000000000005:99.99632%,-211.73542999999998:0.0031%,-186.44547:0.00019%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.00424%,9:26.06607%,7:18.3158%,1:17.60942%,21:0.0033%,15:0.00058%,16:0.00019%,14:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1418 (0.27495%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0057 - tp: 79993.0000 - fp: 7.0000 - tn: 319993.0000 - fn: 7.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 1.1596e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0044 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.6069e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0037 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.9585e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0032 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.8930 - val_tp: 18892.0000 - val_fp: 1108.0000 - val_tn: 78892.0000 - val_fn: 1108.0000 - val_accuracy: 0.9778 - val_precision: 0.9446 - val_recall: 0.9446 - val_auc: 0.9654
[INFO] saving weights to checkpoints/lstm-epoch-3-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5314 - tp: 42627.0000 - fp: 37373.0000 - tn: 282627.0000 - fn: 37373.0000 - accuracy: 0.8131 - precision: 0.5328 - recall: 0.5328 - auc: 0.7037 - val_loss: 7.5473 - val_tp: 10635.0000 - val_fp: 9365.0000 - val_tn: 70635.0000 - val_fn: 9365.0000 - val_accuracy: 0.8127 - val_precision: 0.5318 - val_recall: 0.5318 - val_auc: 0.7073
[INFO] saving weights to checkpoints/lstm-epoch-3-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 16-16/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (455414, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (455414, 17)

[INFO] analyzing data
[INFO] 455414 rows
[INFO] ** appi_name:[21:99.99846%,30:0.00132%,33:0.00022%]
[INFO] ** classification:[normal:83.33626%,Single Stage Multi Point:16.66374%]
[INFO] ** dst:[21:43.35659%,10:20.79844%,8:18.2524%,9:17.58971%,22:0.00132%,15:0.00132%,24:0.00022%]
[INFO] ** i/f_dir:[1:99.99868%,0:0.00132%]
[INFO] ** i/f_name:[2:99.99868%,3:0.00132%]
[INFO] ** modbus_function_code:[0.02961:99.99846%,-33.760870000000004:0.00154%]
[INFO] ** modbus_function_description:[7:50.00066%,11:49.9978%,0:0.00154%]
[INFO] ** modbus_transaction_id:65536 (14.39042%)
[INFO] ** orig:[0:99.99868%,2:0.00132%]
[INFO] ** proto:[0:99.99868%,1:0.00132%]
[INFO] ** proxy_src_ip:[18:38.0478%,20:26.10745%,13:18.25284%,6:17.58993%,17:0.00132%,16:0.00044%,21:0.00022%]
[INFO] ** s_port:[1.45442:26.1068%,-0.32151:20.79822%,-1.27613:18.2524%,-0.23351:17.58949%,-0.33484:17.24958%,-71.33197:0.00132%,1.45709:0.00044%,-0.24151:0.00044%,-1.02014:0.00044%,-1.27347:0.00022%,1.47576:0.00022%,-49.275529999999996:0.00022%,-1.2708:0.00022%]
[INFO] ** scada_tag:[3:26.10636%,1:20.79822%,5:18.25218%,4:17.58905%,2:17.24936%,0:0.00483%]
[INFO] ** service:[0.0048200000000000005:99.99868%,-211.73542999999998:0.00132%]
[INFO] ** src:[22:38.0478%,9:26.10745%,7:18.25284%,1:17.58993%,21:0.00132%,15:0.00044%,4:0.00022%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1246 (0.2736%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/455414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5580 - tp: 42494.0000 - fp: 37506.0000 - tn: 282494.0000 - fn: 37506.0000 - accuracy: 0.8125 - precision: 0.5312 - recall: 0.5312 - auc: 0.7026 - val_loss: 7.5562 - val_tp: 10624.0000 - val_fp: 9376.0000 - val_tn: 70624.0000 - val_fn: 9376.0000 - val_accuracy: 0.8125 - val_precision: 0.5312 - val_recall: 0.5312 - val_auc: 0.7070
[INFO] saving weights to checkpoints/lstm-epoch-3-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/455414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.8457 - tp: 50993.0000 - fp: 29007.0000 - tn: 290993.0000 - fn: 29007.0000 - accuracy: 0.8550 - precision: 0.6374 - recall: 0.6374 - auc: 0.7706 - val_loss: 1.0521e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/455414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0019 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.0942e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/455414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0018 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.6719e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/455414
[33m[INFO] loading file 17-17/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555414, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555414, 17)

[INFO] analyzing data
[INFO] 555414 rows
[INFO] ** appi_name:[21:99.99712%,7:0.00054%,26:0.00036%,0:0.00036%,33:0.00018%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:94.44558%,Multi Stage Multi Point:5.55442%]
[INFO] ** dst:[21:43.3464%,10:20.84661%,8:18.20444%,9:17.59966%,22:0.00072%,6:0.00054%,25:0.00036%,16:0.00036%,2:0.00036%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99712%,-33.760870000000004:0.0027%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99946%,11:49.99766%,0:0.0027%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.79949%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99874%,2:0.00126%]
[INFO] ** proxy_src_ip:[18:38.07718%,20:26.11637%,13:18.2039%,6:17.59948%,10:0.00108%,11:0.0009%,1:0.00036%,21:0.00018%,16:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.11547%,-0.32151:20.84643%,-1.27613:18.20354%,-0.23351:17.5993%,-0.33484:17.23075%,6.0369:0.00072%,1.47576:0.00036%,-71.14798:0.00036%,1.45709:0.00036%,-64.19493:0.00036%,1.46509:0.00018%,-68.79874000000001:0.00018%,-49.275529999999996:0.00018%,-1.27347:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,6.15557:0.00018%,6.06224:0.00018%,8.55414:0.00018%,-3.3787199999999995:0.00018%,-4.3880099999999995:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.11529%,1:20.84625%,5:18.20336%,4:17.59894%,2:17.23075%,0:0.0054%]
[INFO] ** service:[0.0048200000000000005:99.99802%,-211.09762999999998:0.00054%,-211.08346:0.00036%,-186.44547:0.00036%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.07718%,9:26.11637%,7:18.2039%,1:17.59948%,11:0.00108%,10:0.0009%,3:0.00036%,21:0.00018%,15:0.00018%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1517 (0.27313%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0015 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0877e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0014 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4910e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0012 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3754e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.7171 - tp: 71482.0000 - fp: 8518.0000 - tn: 311482.0000 - fn: 8518.0000 - accuracy: 0.9574 - precision: 0.8935 - recall: 0.8935 - auc: 0.9330 - val_loss: 2.9456 - val_tp: 16345.0000 - val_fp: 3655.0000 - val_tn: 76345.0000 - val_fn: 3655.0000 - val_accuracy: 0.9269 - val_precision: 0.8173 - val_recall: 0.8173 - val_auc: 0.8858
[INFO] saving weights to checkpoints/lstm-epoch-3-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9162 - tp: 65530.0000 - fp: 14470.0000 - tn: 305530.0000 - fn: 14470.0000 - accuracy: 0.9277 - precision: 0.8191 - recall: 0.8191 - auc: 0.8863 - val_loss: 2.9238 - val_tp: 16372.0000 - val_fp: 3628.0000 - val_tn: 76372.0000 - val_fn: 3628.0000 - val_accuracy: 0.9274 - val_precision: 0.8186 - val_recall: 0.8186 - val_auc: 0.8866
[INFO] saving weights to checkpoints/lstm-epoch-3-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/555414
[33m[INFO] loading file 18-18/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555414, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555414, 17)

[INFO] analyzing data
[INFO] 555414 rows
[INFO] ** appi_name:[21:99.9982%,30:0.00054%,7:0.00054%,31:0.00018%,27:0.00018%,22:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:82.43166%,Multi Stage Multi Point:17.56834%]
[INFO] ** dst:[21:43.34154%,10:20.83311%,8:18.25989%,9:17.56257%,22:0.00072%,15:0.00054%,24:0.00036%,16:0.00036%,2:0.00036%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99946%,0:0.00054%]
[INFO] ** i/f_name:[2:99.99946%,3:0.00054%]
[INFO] ** modbus_function_code:[0.02961:99.9982%,-33.760870000000004:0.0018%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.9982%,0:0.0018%]
[INFO] ** modbus_transaction_id:65536 (11.79949%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99892%,2:0.00054%,1:0.00054%]
[INFO] ** proxy_src_ip:[18:38.07754%,20:26.09765%,13:18.26025%,6:17.56275%,17:0.00054%,11:0.00054%,1:0.00036%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.09693%,-0.32151:20.83311%,-1.27613:18.25971%,-0.23351:17.56239%,-0.33484:17.24443%,-71.33197:0.00054%,-1.27347:0.00036%,1.45709:0.00036%,-0.24151:0.00036%,1.47576:0.00018%,1.46509:0.00018%,3.6236699999999997:0.00018%,-1.2708:0.00018%,-2.48275:0.00018%,6.06224:0.00018%,-3.3787199999999995:0.00018%,8.10082:0.00018%,6.45955:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.09657%,1:20.83293%,5:18.25953%,4:17.56221%,2:17.24425%,0:0.0045%]
[INFO] ** service:[0.0048200000000000005:99.9982%,-211.09762999999998:0.00054%,-211.73542999999998:0.00054%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.07754%,9:26.09765%,7:18.26025%,1:17.56275%,14:0.00054%,10:0.00054%,3:0.00036%,21:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1518 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4993 - tp: 77526.0000 - fp: 2474.0000 - tn: 317526.0000 - fn: 2474.0000 - accuracy: 0.9876 - precision: 0.9691 - recall: 0.9691 - auc: 0.9805 - val_loss: 6.1305 - val_tp: 12393.0000 - val_fp: 7607.0000 - val_tn: 72393.0000 - val_fn: 7607.0000 - val_accuracy: 0.8479 - val_precision: 0.6197 - val_recall: 0.6197 - val_auc: 0.7623
[INFO] saving weights to checkpoints/lstm-epoch-3-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1311 - tp: 49572.0000 - fp: 30428.0000 - tn: 289572.0000 - fn: 30428.0000 - accuracy: 0.8479 - precision: 0.6197 - recall: 0.6197 - auc: 0.7606 - val_loss: 6.0395 - val_tp: 12506.0000 - val_fp: 7494.0000 - val_tn: 72506.0000 - val_fn: 7494.0000 - val_accuracy: 0.8501 - val_precision: 0.6253 - val_recall: 0.6253 - val_auc: 0.7658
[INFO] saving weights to checkpoints/lstm-epoch-3-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1449 - tp: 49503.0000 - fp: 30497.0000 - tn: 289503.0000 - fn: 30497.0000 - accuracy: 0.8475 - precision: 0.6188 - recall: 0.6188 - auc: 0.7601 - val_loss: 6.1474 - val_tp: 12372.0000 - val_fp: 7628.0000 - val_tn: 72372.0000 - val_fn: 7628.0000 - val_accuracy: 0.8474 - val_precision: 0.6186 - val_recall: 0.6186 - val_auc: 0.7616
[INFO] saving weights to checkpoints/lstm-epoch-3-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.3073 - tp: 68551.0000 - fp: 11449.0000 - tn: 308551.0000 - fn: 11449.0000 - accuracy: 0.9428 - precision: 0.8569 - recall: 0.8569 - auc: 0.9100 - val_loss: 2.3580e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.5900e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8446e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/555414
[33m[INFO] loading file 19-19/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555414, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555414, 17)

[INFO] analyzing data
[INFO] 555414 rows
[INFO] ** appi_name:[21:99.99802%,26:0.00036%,0:0.00036%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:87.11592%,Single Stage Multi Point:12.88408%]
[INFO] ** dst:[21:43.38601%,10:20.82591%,8:18.21236%,9:17.57302%,22:0.00126%,6:0.00054%,25:0.00036%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99802%,-33.760870000000004:0.0018%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99802%,0:0.0018%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.79949%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99874%,2:0.00126%]
[INFO] ** proxy_src_ip:[18:38.11337%,20:26.09873%,13:18.21236%,6:17.57302%,10:0.00108%,11:0.0009%,16:0.00054%]
[INFO] ** s_port:[1.45442:26.09765%,-0.32151:20.82591%,-1.27613:18.212%,-0.23351:17.57284%,-0.33484:17.28746%,-5.20264:0.00072%,1.45709:0.00054%,-1.02014:0.00054%,-64.19493:0.00036%,-71.14798:0.00036%,1.46509:0.00036%,-1.27347:0.00018%,-0.24151:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-71.14931:0.00018%,-68.79874000000001:0.00018%,0.75578:0.00018%]
[INFO] ** scada_tag:[3:26.09729%,1:20.82573%,5:18.21182%,4:17.57266%,2:17.28728%,0:0.00522%]
[INFO] ** service:[0.0048200000000000005:99.99874%,-211.08346:0.00036%,-186.44547:0.00036%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.11337%,9:26.09873%,7:18.21236%,1:17.57302%,11:0.00108%,10:0.0009%,15:0.00054%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1519 (0.27349%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.8142e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4827e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.2030e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3317e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.4587e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2363e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2226 - tp: 78897.0000 - fp: 1103.0000 - tn: 318897.0000 - fn: 1103.0000 - accuracy: 0.9945 - precision: 0.9862 - recall: 0.9862 - auc: 0.9914 - val_loss: 9.7974 - val_tp: 7843.0000 - val_fp: 12157.0000 - val_tn: 67843.0000 - val_fn: 12157.0000 - val_accuracy: 0.7569 - val_precision: 0.3922 - val_recall: 0.3922 - val_auc: 0.6201
[INFO] saving weights to checkpoints/lstm-epoch-3-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.8376 - tp: 31173.0000 - fp: 48827.0000 - tn: 271173.0000 - fn: 48827.0000 - accuracy: 0.7559 - precision: 0.3897 - recall: 0.3897 - auc: 0.6162 - val_loss: 7.6343 - val_tp: 10527.0000 - val_fp: 9473.0000 - val_tn: 70527.0000 - val_fn: 9473.0000 - val_accuracy: 0.8105 - val_precision: 0.5264 - val_recall: 0.5264 - val_auc: 0.7040
[INFO] saving weights to checkpoints/lstm-epoch-3-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/555414
[33m[INFO] loading file 20-20/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555414, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555414, 17)

[INFO] analyzing data
[INFO] 555414 rows
[INFO] ** appi_name:[21:99.99658%,30:0.00288%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:92.6219%,Single Stage Multi Point:7.3781%]
[INFO] ** dst:[21:43.42508%,10:20.83671%,8:18.16087%,9:17.57248%,15:0.00288%,22:0.00108%,24:0.00036%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99748%,0:0.00252%]
[INFO] ** i/f_name:[2:99.99712%,3:0.00288%]
[INFO] ** modbus_function_code:[0.02961:99.99658%,-33.760870000000004:0.00342%]
[INFO] ** modbus_function_description:[7:49.99946%,11:49.99712%,0:0.00342%]
[INFO] ** modbus_transaction_id:65536 (11.79949%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99658%,1:0.00288%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.11499%,20:26.14734%,13:18.16105%,6:17.57302%,17:0.00288%,14:0.00054%,16:0.00018%]
[INFO] ** s_port:[1.45442:26.14662%,-0.32151:20.83671%,-1.27613:18.16051%,-0.23351:17.5723%,-0.33484:17.27828%,-71.33197:0.00288%,-0.24151:0.00054%,1.45709:0.00036%,-1.27347:0.00036%,13.431270000000001:0.00018%,-1.2708:0.00018%,-1.02014:0.00018%,-71.14798:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:26.14608%,1:20.83653%,5:18.16051%,4:17.57194%,2:17.2781%,0:0.00684%]
[INFO] ** service:[0.0048200000000000005:99.99658%,-211.73542999999998:0.00288%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.11499%,9:26.14734%,7:18.16105%,1:17.57302%,14:0.00288%,2:0.00054%,15:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1518 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.5623e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1928e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.4605 - tp: 67789.0000 - fp: 12211.0000 - tn: 307789.0000 - fn: 12211.0000 - accuracy: 0.9389 - precision: 0.8474 - recall: 0.8474 - auc: 0.9041 - val_loss: 2.9625 - val_tp: 16324.0000 - val_fp: 3676.0000 - val_tn: 76324.0000 - val_fn: 3676.0000 - val_accuracy: 0.9265 - val_precision: 0.8162 - val_recall: 0.8162 - val_auc: 0.8851
[INFO] saving weights to checkpoints/lstm-epoch-3-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9436 - tp: 65391.0000 - fp: 14609.0000 - tn: 305391.0000 - fn: 14609.0000 - accuracy: 0.9270 - precision: 0.8174 - recall: 0.8174 - auc: 0.8852 - val_loss: 2.9424 - val_tp: 16349.0000 - val_fp: 3651.0000 - val_tn: 76349.0000 - val_fn: 3651.0000 - val_accuracy: 0.9270 - val_precision: 0.8174 - val_recall: 0.8174 - val_auc: 0.8859
[INFO] saving weights to checkpoints/lstm-epoch-3-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.3767 - tp: 73168.0000 - fp: 6832.0000 - tn: 313168.0000 - fn: 6832.0000 - accuracy: 0.9658 - precision: 0.9146 - recall: 0.9146 - auc: 0.9463 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.2162e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/555414
[33m[INFO] loading file 21-21/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555412, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555412, 17)

[INFO] analyzing data
[INFO] 555412 rows
[INFO] ** appi_name:[21:99.99604%,30:0.00108%,7:0.00054%,26:0.00036%,22:0.00036%,0:0.00036%,31:0.00018%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:98.90118%,Multi Stage Single Point:1.09882%]
[INFO] ** dst:[21:43.31001%,10:20.98352%,8:18.16795%,9:17.53365%,15:0.00108%,22:0.0009%,24:0.00072%,6:0.00072%,25:0.00036%,16:0.00036%,2:0.00036%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99604%,-33.760870000000004:0.00378%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99892%,11:49.99712%,0:0.00378%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.79953%)
[INFO] ** orig:[0:99.99928%,2:0.00072%]
[INFO] ** proto:[0:99.99748%,2:0.00144%,1:0.00108%]
[INFO] ** proxy_src_ip:[18:38.30868%,20:25.98449%,13:18.16867%,6:17.53365%,17:0.00108%,10:0.00108%,11:0.0009%,16:0.00054%,1:0.00036%,21:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.98395%,-0.32151:20.9828%,-1.27613:18.16777%,-0.23351:17.53347%,-0.33484:17.32588%,-71.33197:0.00108%,-1.27347:0.00072%,-6.64392:0.00072%,-1.02014:0.00054%,-64.19493:0.00036%,-71.14931:0.00036%,-71.14798:0.00036%,1.47576:0.00018%,1.46509:0.00018%,-1.2708:0.00018%,6.62488:0.00018%,10.15141:0.00018%,-68.79874000000001:0.00018%,7.060860000000001:0.00018%,-3.3787199999999995:0.00018%,-2.2440900000000004:0.00018%,1.45709:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.98341%,1:20.98262%,5:18.16759%,4:17.53311%,2:17.32588%,0:0.00738%]
[INFO] ** service:[0.0048200000000000005:99.99676%,-211.73542999999998:0.00108%,-211.09762999999998:0.00054%,-211.08346:0.00036%,-186.44547:0.00036%,-211.08818:0.00036%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.30868%,9:25.98449%,7:18.16867%,1:17.53365%,11:0.00108%,21:0.0009%,10:0.0009%,15:0.00054%,14:0.00036%,3:0.00036%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1513 (0.27241%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555412
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.9726e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/555412
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.7814e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/555412
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.4918e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/555412
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.4097e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.6945e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/555412
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2298e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/555412
[33m[INFO] loading file 22-22/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (324453, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (324453, 17)

[INFO] analyzing data
[INFO] 324453 rows
[INFO] ** appi_name:[21:99.9926%,30:0.00647%,23:0.00031%,22:0.00031%,18:0.00031%]
[INFO] ** classification:[normal:59.14601%,Multi Stage Single Point:40.85399%]
[INFO] ** dst:[21:43.30365%,10:21.00427%,8:18.10956%,9:17.57389%,15:0.00647%,22:0.00123%,19:0.00062%,26:0.00031%]
[INFO] ** i/f_dir:[1:99.99384%,0:0.00616%]
[INFO] ** i/f_name:[2:99.99353%,3:0.00616%,0:0.00031%]
[INFO] ** modbus_function_code:[0.02961:99.9926%,-33.760870000000004:0.0074%]
[INFO] ** modbus_function_description:[7:49.99707%,11:49.99553%,0:0.0074%]
[INFO] ** modbus_transaction_id:65534 (20.1983%)
[INFO] ** orig:[0:99.99507%,2:0.00431%,1:0.00062%]
[INFO] ** proto:[0:99.99322%,1:0.00647%,2:0.00031%]
[INFO] ** proxy_src_ip:[18:38.32943%,20:25.97942%,13:18.10894%,6:17.57481%,17:0.00647%,14:0.00062%,10:0.00031%]
[INFO] ** s_port:[1.45442:25.97849%,-0.32151:21.00427%,-1.27613:18.10894%,-0.23351:17.57389%,-0.33484:17.32516%,-71.33197:0.00647%,1.45709:0.00062%,-0.24151:0.00062%,7.228860000000001:0.00062%,-0.24950999999999998:0.00031%,1.46509:0.00031%,-71.14931:0.00031%]
[INFO] ** scada_tag:[3:25.97818%,1:21.00427%,5:18.10894%,4:17.57358%,2:17.32516%,0:0.00986%]
[INFO] ** service:[0.0048200000000000005:99.9926%,-211.73542999999998:0.00647%,-211.07873999999998:0.00062%,-211.08818:0.00031%]
[INFO] ** src:[22:38.32943%,9:25.97942%,7:18.10894%,1:17.57481%,21:0.00431%,14:0.00216%,2:0.00062%,11:0.00031%]
[INFO] ** type:[0:99.99815%,1:0.00185%]
[INFO] ** unixtime:895 (0.27585%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/324453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.5531 - tp: 62365.0000 - fp: 17635.0000 - tn: 302365.0000 - fn: 17635.0000 - accuracy: 0.9118 - precision: 0.7796 - recall: 0.7796 - auc: 0.8622 - val_loss: 7.5626 - val_tp: 10616.0000 - val_fp: 9384.0000 - val_tn: 70616.0000 - val_fn: 9384.0000 - val_accuracy: 0.8123 - val_precision: 0.5308 - val_recall: 0.5308 - val_auc: 0.7068
[INFO] saving weights to checkpoints/lstm-epoch-3-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/324453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5699 - tp: 42428.0000 - fp: 37572.0000 - tn: 282428.0000 - fn: 37572.0000 - accuracy: 0.8121 - precision: 0.5304 - recall: 0.5304 - auc: 0.7065 - val_loss: 7.5900 - val_tp: 10582.0000 - val_fp: 9418.0000 - val_tn: 70582.0000 - val_fn: 9418.0000 - val_accuracy: 0.8116 - val_precision: 0.5291 - val_recall: 0.5291 - val_auc: 0.7057
[INFO] saving weights to checkpoints/lstm-epoch-3-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/324453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5856 - tp: 42350.0000 - fp: 37650.0000 - tn: 282350.0000 - fn: 37650.0000 - accuracy: 0.8117 - precision: 0.5294 - recall: 0.5294 - auc: 0.7059 - val_loss: 7.6077 - val_tp: 10560.0000 - val_fp: 9440.0000 - val_tn: 70560.0000 - val_fn: 9440.0000 - val_accuracy: 0.8112 - val_precision: 0.5280 - val_recall: 0.5280 - val_auc: 0.7050
[INFO] saving weights to checkpoints/lstm-epoch-3-files-21-22-batch-200000-300000
[INFO] processing batch 300000-400000/324453
[33m[INFO] loading file 23-23/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524453, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524453, 17)

[INFO] analyzing data
[INFO] 524453 rows
[INFO] ** appi_name:[21:99.99886%,31:0.00038%,30:0.00038%,33:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:96.09345%,Multi Stage Single Point:3.90655%]
[INFO] ** dst:[21:43.32743%,10:21.00303%,8:18.13985%,9:17.5274%,22:0.00095%,24:0.00038%,18:0.00038%,15:0.00038%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99886%,-33.760870000000004:0.00114%]
[INFO] ** modbus_function_description:[7:50.00029%,11:49.99857%,0:0.00114%]
[INFO] ** modbus_transaction_id:65536 (12.49607%)
[INFO] ** orig:[0:99.99981%,2:0.00019%]
[INFO] ** proto:[0:99.99905%,2:0.00057%,1:0.00038%]
[INFO] ** proxy_src_ip:[18:38.34929%,20:25.98136%,13:18.14004%,6:17.5276%,16:0.00057%,17:0.00038%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.98078%,-0.32151:21.00284%,-1.27613:18.13947%,-0.23351:17.52721%,-0.33484:17.34645%,-1.02014:0.00057%,-1.27347:0.00038%,-0.08551:0.00038%,-71.33197:0.00038%,1.45709:0.00019%,-0.24151:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,1.46509:0.00019%,-64.19493:0.00019%,-0.24950999999999998:0.00019%,-49.275529999999996:0.00019%]
[INFO] ** scada_tag:[3:25.9804%,1:21.00284%,5:18.13928%,4:17.52702%,2:17.34626%,0:0.00419%]
[INFO] ** service:[0.0048200000000000005:99.99905%,-211.73542999999998:0.00038%,-186.43601999999998:0.00038%,-186.44547:0.00019%]
[INFO] ** src:[22:38.34929%,9:25.98136%,7:18.14004%,1:17.5276%,15:0.00057%,21:0.00019%,17:0.00019%,14:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1426 (0.2719%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.1279 - tp: 59512.0000 - fp: 20488.0000 - tn: 299512.0000 - fn: 20488.0000 - accuracy: 0.8976 - precision: 0.7439 - recall: 0.7439 - auc: 0.8399 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.6437e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.5376e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.6394e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1922e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.0807e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/524453
[33m[INFO] loading file 24-24/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524453, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524453, 17)

[INFO] analyzing data
[INFO] 524453 rows
[INFO] ** appi_name:[21:99.99295%,30:0.00343%,26:0.00057%,31:0.00038%,27:0.00038%,22:0.00038%,0:0.00038%,24:0.00019%,23:0.00019%,19:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,11:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:95.1416%,Multi Stage Single Point:4.8584%]
[INFO] ** dst:[21:43.35851%,10:21.02324%,8:18.1021%,9:17.50891%,15:0.00343%,22:0.00114%,6:0.00076%,25:0.00038%,19:0.00038%,18:0.00038%,7:0.00038%,26:0.00019%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99676%,0:0.00324%]
[INFO] ** i/f_name:[2:99.99657%,3:0.00343%]
[INFO] ** modbus_function_code:[0.02961:99.99295%,-33.760870000000004:0.00648%,-0.415:0.00019%,0.9188299999999999:0.00019%,0.47422:0.00019%]
[INFO] ** modbus_function_description:[7:49.99743%,11:49.99552%,0:0.00648%,15:0.00019%,10:0.00019%,2:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.49607%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99447%,1:0.00343%,2:0.0021%]
[INFO] ** proxy_src_ip:[18:38.4023%,20:25.98021%,13:18.10191%,6:17.50815%,17:0.00343%,10:0.00133%,14:0.00095%,11:0.00095%,21:0.00038%,16:0.00038%]
[INFO] ** s_port:[1.45442:25.97945%,-0.32151:21.02324%,-1.27613:18.10172%,-0.23351:17.50757%,-0.33484:17.37906%,-71.33197:0.00343%,-9.58113:0.00076%,-71.14798:0.00057%,1.45709:0.00038%,-0.24151:0.00038%,-1.02014:0.00038%,-31.55091:0.00038%,7.6315100000000005:0.00038%,-71.14931:0.00038%,-64.19493:0.00038%,-68.79874000000001:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,-1.27347:0.00019%,7.4901800000000005:0.00019%,13.431270000000001:0.00019%,11.862:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:25.97926%,1:21.02324%,5:18.10153%,4:17.50719%,2:17.37887%,0:0.00992%]
[INFO] ** service:[0.0048200000000000005:99.99409%,-211.73542999999998:0.00343%,-211.08346:0.00057%,-211.07873999999998:0.00038%,-202.75898:0.00038%,-186.44547:0.00038%,-186.43601999999998:0.00038%,-211.08818:0.00038%]
[INFO] ** src:[22:38.4023%,9:25.98021%,7:18.10191%,1:17.50815%,14:0.00343%,11:0.00133%,10:0.00095%,2:0.00095%,15:0.00038%,4:0.00038%]
[INFO] ** type:[0:99.99867%,1:0.00095%,2:0.00038%]
[INFO] ** unixtime:1425 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.4747e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.9247e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.4235e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2184e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.0540e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.9515 - tp: 70314.0000 - fp: 9686.0000 - tn: 310314.0000 - fn: 9686.0000 - accuracy: 0.9516 - precision: 0.8789 - recall: 0.8789 - auc: 0.9243 - val_loss: 5.7340 - val_tp: 12885.0000 - val_fp: 7115.0000 - val_tn: 72885.0000 - val_fn: 7115.0000 - val_accuracy: 0.8577 - val_precision: 0.6442 - val_recall: 0.6442 - val_auc: 0.7777
[INFO] saving weights to checkpoints/lstm-epoch-3-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/524453
[33m[INFO] loading file 25-25/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524453, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524453, 17)

[INFO] analyzing data
[INFO] 524453 rows
[INFO] ** appi_name:[21:99.99619%,30:0.00114%,17:0.00076%,22:0.00057%,31:0.00038%,28:0.00019%,26:0.00019%,12:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** classification:[normal:64.34228%,Multi Stage Single Point:35.65772%]
[INFO] ** dst:[21:43.31523%,10:21.02247%,8:18.14843%,9:17.50929%,15:0.00114%,22:0.00095%,16:0.00076%,6:0.00076%,18:0.00038%,17:0.00038%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99886%,0:0.00114%]
[INFO] ** i/f_name:[2:99.99886%,3:0.00114%]
[INFO] ** modbus_function_code:[0.02961:99.99619%,-33.760870000000004:0.00381%]
[INFO] ** modbus_function_description:[7:49.99895%,11:49.99724%,0:0.00381%]
[INFO] ** modbus_transaction_id:65536 (12.49607%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99771%,2:0.00114%,1:0.00114%]
[INFO] ** proxy_src_ip:[18:38.38533%,20:25.95218%,13:18.14843%,6:17.50986%,17:0.00114%,1:0.00095%,21:0.00076%,16:0.00038%,14:0.00038%,7:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.9518%,-0.32151:21.02209%,-1.27613:18.14805%,-0.23351:17.50929%,-0.33484:17.36323%,-71.33197:0.00114%,-71.14931:0.00057%,-0.24151:0.00038%,-1.02014:0.00038%,-49.275529999999996:0.00038%,1.46509:0.00019%,-5.1466400000000005:0.00019%,-1.27347:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,-0.24950999999999998:0.00019%,2.52505:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,6.1115699999999995:0.00019%,-5.08665:0.00019%,1.45709:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:25.95142%,1:21.0219%,5:18.14786%,4:17.5091%,2:17.36304%,0:0.00667%]
[INFO] ** service:[0.0048200000000000005:99.99657%,-211.73542999999998:0.00114%,-205.44247:0.00076%,-211.08818:0.00057%,-186.43601999999998:0.00038%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.38533%,9:25.95218%,7:18.14843%,1:17.50986%,14:0.00114%,3:0.00095%,4:0.00076%,21:0.00038%,15:0.00038%,2:0.00038%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1425 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7499 - tp: 51461.0000 - fp: 28539.0000 - tn: 291461.0000 - fn: 28539.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.7770 - val_loss: 5.7421 - val_tp: 12875.0000 - val_fp: 7125.0000 - val_tn: 72875.0000 - val_fn: 7125.0000 - val_accuracy: 0.8575 - val_precision: 0.6438 - val_recall: 0.6438 - val_auc: 0.7773
[INFO] saving weights to checkpoints/lstm-epoch-3-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7445 - tp: 51488.0000 - fp: 28512.0000 - tn: 291488.0000 - fn: 28512.0000 - accuracy: 0.8574 - precision: 0.6436 - recall: 0.6436 - auc: 0.7772 - val_loss: 5.7453 - val_tp: 12871.0000 - val_fp: 7129.0000 - val_tn: 72871.0000 - val_fn: 7129.0000 - val_accuracy: 0.8574 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.7772
[INFO] saving weights to checkpoints/lstm-epoch-3-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7512 - tp: 51455.0000 - fp: 28545.0000 - tn: 291455.0000 - fn: 28545.0000 - accuracy: 0.8573 - precision: 0.6432 - recall: 0.6432 - auc: 0.7770 - val_loss: 5.7558 - val_tp: 12858.0000 - val_fp: 7142.0000 - val_tn: 72858.0000 - val_fn: 7142.0000 - val_accuracy: 0.8572 - val_precision: 0.6429 - val_recall: 0.6429 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-3-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7415 - tp: 51503.0000 - fp: 28497.0000 - tn: 291503.0000 - fn: 28497.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.7774 - val_loss: 5.7759 - val_tp: 12833.0000 - val_fp: 7167.0000 - val_tn: 72833.0000 - val_fn: 7167.0000 - val_accuracy: 0.8567 - val_precision: 0.6417 - val_recall: 0.6417 - val_auc: 0.7760
[INFO] saving weights to checkpoints/lstm-epoch-3-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7405 - tp: 51508.0000 - fp: 28492.0000 - tn: 291508.0000 - fn: 28492.0000 - accuracy: 0.8575 - precision: 0.6439 - recall: 0.6439 - auc: 0.7774 - val_loss: 5.7590 - val_tp: 12854.0000 - val_fp: 7146.0000 - val_tn: 72854.0000 - val_fn: 7146.0000 - val_accuracy: 0.8571 - val_precision: 0.6427 - val_recall: 0.6427 - val_auc: 0.7767
[INFO] saving weights to checkpoints/lstm-epoch-3-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/524453
[33m[INFO] loading file 26-26/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524453, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524453, 17)

[INFO] analyzing data
[INFO] 524453 rows
[INFO] ** appi_name:[21:99.99847%,7:0.00057%,31:0.00019%,30:0.00019%,22:0.00019%,12:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:64.40005%,Single Stage Single Point:30.45306%,Multi Stage Single Point:5.14689%]
[INFO] ** dst:[21:43.31027%,10:21.08769%,8:18.11907%,9:17.4805%,22:0.00076%,24:0.00038%,16:0.00038%,2:0.00038%,18:0.00019%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99847%,-33.760870000000004:0.00153%]
[INFO] ** modbus_function_description:[7:49.9999%,11:49.99857%,0:0.00153%]
[INFO] ** modbus_transaction_id:65536 (12.49607%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99943%,2:0.00038%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.47094%,20:25.9272%,13:18.11945%,6:17.4805%,1:0.00057%,21:0.00038%,16:0.00038%,17:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.92663%,-0.32151:21.08749%,-1.27613:18.11888%,-0.23351:17.48031%,-0.33484:17.38345%,-1.27347:0.00038%,-1.02014:0.00038%,7.66617:0.00019%,-71.14931:0.00019%,11.57001:0.00019%,-3.3787199999999995:0.00019%,2.52505:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%,1.45709:0.00019%,-49.275529999999996:0.00019%,1.47576:0.00019%,1.46509:0.00019%,14.191239999999999:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.92625%,1:21.08749%,5:18.11888%,4:17.48012%,2:17.38345%,0:0.00381%]
[INFO] ** service:[0.0048200000000000005:99.99867%,-211.09762999999998:0.00057%,-211.35747999999998:0.00019%,-211.73542999999998:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.47094%,9:25.9272%,7:18.11945%,1:17.4805%,3:0.00057%,15:0.00038%,4:0.00038%,21:0.00019%,14:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1423 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.4786 - tp: 52599.0000 - fp: 27401.0000 - tn: 292599.0000 - fn: 27401.0000 - accuracy: 0.8630 - precision: 0.6575 - recall: 0.6575 - auc: 0.7898 - val_loss: 3.2640e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0824 - tp: 78778.0000 - fp: 1222.0000 - tn: 318778.0000 - fn: 1222.0000 - accuracy: 0.9939 - precision: 0.9847 - recall: 0.9847 - auc: 0.9927 - val_loss: 5.3769e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0604 - tp: 79124.0000 - fp: 876.0000 - tn: 319124.0000 - fn: 876.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9956 - val_loss: 1.3336e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0549 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9998 - val_loss: 1.0829e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0488 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9998 - val_loss: 5.5636e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/524453
[33m[INFO] loading file 27-27/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (464583, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (464583, 17)

[INFO] analyzing data
[INFO] 464583 rows
[INFO] ** appi_name:[21:99.99935%,30:0.00065%]
[INFO] ** classification:[normal:64.3377%,Single Stage Single Point:35.6623%]
[INFO] ** dst:[21:43.27192%,10:21.06384%,8:18.18965%,9:17.47287%,22:0.00086%,15:0.00065%,24:0.00022%]
[INFO] ** i/f_dir:[1:99.99978%,0:0.00022%]
[INFO] ** i/f_name:[2:99.99935%,3:0.00065%]
[INFO] ** modbus_function_code:[0.02961:99.99935%,-33.760870000000004:0.00065%]
[INFO] ** modbus_function_description:[7:50.00054%,11:49.99882%,0:0.00065%]
[INFO] ** modbus_transaction_id:65536 (14.10641%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99935%,1:0.00065%]
[INFO] ** proxy_src_ip:[18:38.40433%,20:25.93207%,13:18.18943%,6:17.47309%,17:0.00065%,16:0.00043%]
[INFO] ** s_port:[1.45442:25.93143%,-0.32151:21.06384%,-1.27613:18.18921%,-0.23351:17.47266%,-0.33484:17.3405%,-71.33197:0.00065%,-1.02014:0.00043%,-1.27347:0.00022%,1.45709:0.00022%,-0.24950999999999998:0.00022%,1.46509:0.00022%,1.47576:0.00022%,-0.24151:0.00022%]
[INFO] ** scada_tag:[3:25.931%,1:21.06362%,5:18.189%,4:17.47244%,2:17.34028%,0:0.00366%]
[INFO] ** service:[0.0048200000000000005:99.99935%,-211.73542999999998:0.00065%]
[INFO] ** src:[22:38.40433%,9:25.93207%,7:18.18943%,1:17.47309%,14:0.00065%,15:0.00043%]
[INFO] ** type:[0:99.99957%,1:0.00043%]
[INFO] ** unixtime:1262 (0.27164%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/464583
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0419 - tp: 79139.0000 - fp: 861.0000 - tn: 319139.0000 - fn: 861.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 2.9813e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/464583
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0395 - tp: 79091.0000 - fp: 909.0000 - tn: 319091.0000 - fn: 909.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.5145e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/464583
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0364 - tp: 79059.0000 - fp: 941.0000 - tn: 319059.0000 - fn: 941.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 6.5329e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/464583
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0310 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 3.5852e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/464583
[33m[INFO] loading file 28-28/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (398499, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (398499, 17)

[INFO] analyzing data
[INFO] 398499 rows
[INFO] ** appi_name:[21:99.99247%,30:0.00176%,17:0.00125%,22:0.001%,7:0.001%,31:0.00075%,26:0.00075%,28:0.00025%,27:0.00025%,8:0.00025%,0:0.00025%]
[INFO] ** classification:[normal:64.31283%,Single Stage Single Point:35.68717%]
[INFO] ** dst:[21:43.28543%,10:21.01963%,8:18.2023%,9:17.48461%,6:0.00201%,16:0.00176%,18:0.00125%,15:0.00075%,22:0.0005%,17:0.0005%,2:0.0005%,25:0.00025%,7:0.00025%,0:0.00025%]
[INFO] ** i/f_dir:[1:99.99925%,0:0.00075%]
[INFO] ** i/f_name:[2:99.99925%,3:0.00075%]
[INFO] ** modbus_function_code:[0.02961:99.99247%,-33.760870000000004:0.00753%]
[INFO] ** modbus_function_description:[7:49.99636%,11:49.99611%,0:0.00753%]
[INFO] ** modbus_transaction_id:65536 (16.44571%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99548%,2:0.00376%,1:0.00075%]
[INFO] ** proxy_src_ip:[18:38.34263%,20:25.96242%,13:18.20256%,6:17.48486%,1:0.00201%,17:0.00176%,14:0.00151%,7:0.00125%,21:0.00075%,0:0.00025%]
[INFO] ** s_port:[1.45442:25.96217%,-0.32151:21.01963%,-1.27613:18.2023%,-0.23351:17.48436%,-0.33484:17.323%,-71.14798:0.001%,-71.14931:0.001%,-71.33197:0.00075%,-0.08551:0.0005%,-0.24151:0.0005%,7.66617:0.00025%,-58.035180000000004:0.00025%,-1.2708:0.00025%,-64.19493:0.00025%,-5.1466400000000005:0.00025%,13.431270000000001:0.00025%,11.57001:0.00025%,14.4699:0.00025%,1.47576:0.00025%,14.191239999999999:0.00025%,-5.08665:0.00025%,10.192739999999999:0.00025%,-3.3787199999999995:0.00025%,6.1115699999999995:0.00025%,2.05573:0.00025%,-43.76509:0.00025%,2.52505:0.00025%,11.862:0.00025%,-58.032509999999995:0.00025%]
[INFO] ** scada_tag:[3:25.96192%,1:21.01963%,5:18.2023%,4:17.48411%,2:17.323%,0:0.00903%]
[INFO] ** service:[0.0048200000000000005:99.99247%,-205.44247:0.00125%,-186.43601999999998:0.00125%,-211.09762999999998:0.001%,-211.08346:0.001%,-211.08818:0.001%,-211.73542999999998:0.00075%,-186.44547:0.00025%,-183.8612:0.00025%,-185.9872:0.00025%,-211.35747999999998:0.00025%,-202.75898:0.00025%]
[INFO] ** src:[22:38.34263%,9:25.96242%,7:18.20256%,1:17.48486%,3:0.00226%,2:0.00151%,21:0.00125%,4:0.001%,14:0.00075%,8:0.0005%,17:0.00025%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1083 (0.27177%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/398499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0274 - tp: 79138.0000 - fp: 862.0000 - tn: 319138.0000 - fn: 862.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 4.5970e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/398499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0270 - tp: 79079.0000 - fp: 921.0000 - tn: 319079.0000 - fn: 921.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.0888e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/398499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0258 - tp: 79053.0000 - fp: 947.0000 - tn: 319053.0000 - fn: 947.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.4094e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/398499
[33m[INFO] loading file 29-29/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598499, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598499, 17)

[INFO] analyzing data
[INFO] 598499 rows
[INFO] ** appi_name:[21:99.99883%,30:0.0005%,31:0.00017%,26:0.00017%,9:0.00017%,3:0.00017%]
[INFO] ** classification:[normal:64.38123%,Single Stage Single Point:35.61877%]
[INFO] ** dst:[21:43.31536%,10:21.06453%,8:18.14874%,9:17.4697%,22:0.0005%,15:0.0005%,24:0.00017%,18:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99967%,0:0.00033%]
[INFO] ** i/f_name:[2:99.9995%,3:0.0005%]
[INFO] ** modbus_function_code:[0.02961:99.99883%,-33.760870000000004:0.00117%]
[INFO] ** modbus_function_description:[7:49.99975%,11:49.99908%,0:0.00117%]
[INFO] ** modbus_transaction_id:65536 (10.95006%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99916%,1:0.0005%,2:0.00033%]
[INFO] ** proxy_src_ip:[18:38.43214%,20:25.94808%,13:18.14907%,6:17.46937%,17:0.0005%,21:0.00017%,16:0.00017%,7:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.94741%,-0.32151:21.06436%,-1.27613:18.14874%,-0.23351:17.46937%,-0.33484:17.36778%,-71.33197:0.0005%,1.45709:0.00033%,1.47576:0.00033%,-71.14798:0.00017%,-1.27347:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,6.1115699999999995:0.00017%,14.4699:0.00017%]
[INFO] ** scada_tag:[3:25.94708%,1:21.0642%,5:18.14874%,4:17.46904%,2:17.36778%,0:0.00317%]
[INFO] ** service:[0.0048200000000000005:99.999%,-211.73542999999998:0.0005%,-183.8612:0.00017%,-211.08346:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.43214%,9:25.94808%,7:18.14907%,1:17.46937%,14:0.0005%,21:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1625 (0.27151%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0249 - tp: 79054.0000 - fp: 946.0000 - tn: 319054.0000 - fn: 946.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.3434e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0236 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.3215e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0232 - tp: 79129.0000 - fp: 871.0000 - tn: 319129.0000 - fn: 871.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0224 - tp: 79144.0000 - fp: 856.0000 - tn: 319144.0000 - fn: 856.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1922e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0230 - tp: 79040.0000 - fp: 960.0000 - tn: 319040.0000 - fn: 960.0000 - accuracy: 0.9952 - precision: 0.9880 - recall: 0.9880 - auc: 0.9999 - val_loss: 1.2006e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/598499
[33m[INFO] loading file 30-30/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598499, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598499, 17)

[INFO] analyzing data
[INFO] 598499 rows
[INFO] ** appi_name:[21:99.99749%,30:0.00167%,26:0.00017%,17:0.00017%,12:0.00017%,3:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.37287%,Single Stage Single Point:35.62713%]
[INFO] ** dst:[21:43.34143%,10:21.02861%,8:18.14506%,9:17.48173%,15:0.00167%,22:0.00067%,24:0.00033%,25:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.9985%,0:0.0015%]
[INFO] ** i/f_name:[2:99.99833%,3:0.00167%]
[INFO] ** modbus_function_code:[0.02961:99.99749%,-33.760870000000004:0.00251%]
[INFO] ** modbus_function_description:[7:49.99958%,11:49.99791%,0:0.00251%]
[INFO] ** modbus_transaction_id:65536 (10.95006%)
[INFO] ** orig:[0:99.99916%,2:0.0005%,1:0.00033%]
[INFO] ** proto:[0:99.99799%,1:0.00167%,2:0.00033%]
[INFO] ** proxy_src_ip:[18:38.3755%,20:25.9942%,13:18.14539%,6:17.48223%,17:0.00167%,7:0.00033%,0:0.00033%,16:0.00017%,5:0.00017%]
[INFO] ** s_port:[1.45442:25.99403%,-0.32151:21.02827%,-1.27613:18.14489%,-0.23351:17.48157%,-0.33484:17.34723%,-71.33197:0.00167%,-0.24151:0.0005%,-1.27347:0.00033%,-61.95768:0.00033%,-71.14798:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:25.99369%,1:21.02827%,5:18.14473%,4:17.4814%,2:17.34706%,0:0.00485%]
[INFO] ** service:[0.0048200000000000005:99.99783%,-211.73542999999998:0.00167%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.3755%,9:25.9942%,7:18.14539%,1:17.48223%,14:0.00117%,21:0.00084%,8:0.00033%,16:0.00017%,15:0.00017%]
[INFO] ** type:[0:99.99916%,1:0.00084%]
[INFO] ** unixtime:1627 (0.27185%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79119.0000 - fp: 881.0000 - tn: 319119.0000 - fn: 881.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0196 - tp: 79164.0000 - fp: 836.0000 - tn: 319164.0000 - fn: 836.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/598499
[33m[INFO] loading file 31-31/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598499, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598499, 17)

[INFO] analyzing data
[INFO] 598499 rows
[INFO] ** appi_name:[21:99.99967%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.37939%,Single Stage Single Point:35.62061%]
[INFO] ** dst:[21:43.32956%,10:21.04849%,8:18.12133%,9:17.49894%,22:0.001%,24:0.00033%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99967%,-33.760870000000004:0.00033%]
[INFO] ** modbus_function_description:[7:50.00008%,11:49.99958%,0:0.00033%]
[INFO] ** modbus_transaction_id:65536 (10.95006%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.3999%,20:25.97882%,13:18.12167%,6:17.49878%,16:0.0005%,7:0.00033%]
[INFO] ** s_port:[1.45442:25.97799%,-0.32151:21.04849%,-1.27613:18.12117%,-0.23351:17.49861%,-0.33484:17.35141%,-1.02014:0.0005%,-1.27347:0.00033%,1.45709:0.00033%,1.47576:0.00033%,-71.14798:0.00017%,1.46509:0.00017%,-0.24151:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.97765%,1:21.04832%,5:18.121%,4:17.49827%,2:17.35124%,0:0.00351%]
[INFO] ** service:[0.0048200000000000005:99.99967%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.3999%,9:25.97882%,7:18.12167%,1:17.49878%,15:0.0005%,21:0.00033%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1626 (0.27168%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79155.0000 - fp: 845.0000 - tn: 319155.0000 - fn: 845.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.3003e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79109.0000 - fp: 891.0000 - tn: 319109.0000 - fn: 891.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79075.0000 - fp: 925.0000 - tn: 319075.0000 - fn: 925.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 6.2199e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/598499
[33m[INFO] loading file 32-32/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598499, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598499, 17)

[INFO] analyzing data
[INFO] 598499 rows
[INFO] ** appi_name:[21:99.99666%,30:0.00284%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.38507%,Single Stage Single Point:35.61493%]
[INFO] ** dst:[21:43.32071%,10:21.06002%,8:18.14907%,9:17.46586%,15:0.00284%,22:0.00084%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99749%,0:0.00251%]
[INFO] ** i/f_name:[2:99.99716%,3:0.00284%]
[INFO] ** modbus_function_code:[0.02961:99.99666%,-33.760870000000004:0.00334%]
[INFO] ** modbus_function_description:[7:49.99908%,11:49.99758%,0:0.00334%]
[INFO] ** modbus_transaction_id:65536 (10.95006%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99666%,1:0.00284%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.4278%,20:25.95326%,13:18.14907%,6:17.46636%,17:0.00284%,14:0.0005%,16:0.00017%]
[INFO] ** s_port:[1.45442:25.95276%,-0.32151:21.06002%,-1.27613:18.14874%,-0.23351:17.46569%,-0.33484:17.36778%,-71.33197:0.00284%,-0.24151:0.0005%,-1.2708:0.00017%,-1.02014:0.00017%,13.431270000000001:0.00017%,-71.14798:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.95242%,1:21.05985%,5:18.14874%,4:17.46536%,2:17.36778%,0:0.00585%]
[INFO] ** service:[0.0048200000000000005:99.99666%,-211.73542999999998:0.00284%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.4278%,9:25.95326%,7:18.14907%,1:17.46636%,14:0.00284%,2:0.0005%,15:0.00017%]
[INFO] ** type:[0:99.99967%,1:0.00033%]
[INFO] ** unixtime:1624 (0.27135%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79131.0000 - fp: 869.0000 - tn: 319131.0000 - fn: 869.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1933e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79072.0000 - fp: 928.0000 - tn: 319072.0000 - fn: 928.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79106.0000 - fp: 894.0000 - tn: 319106.0000 - fn: 894.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0196 - tp: 79132.0000 - fp: 868.0000 - tn: 319132.0000 - fn: 868.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 9.0696e-04 - val_tp: 19997.0000 - val_fp: 3.0000 - val_tn: 79997.0000 - val_fn: 3.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/598499
[33m[INFO] loading file 33-33/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598499, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598499, 17)

[INFO] analyzing data
[INFO] 598499 rows
[INFO] ** appi_name:[21:99.99716%,30:0.001%,17:0.00067%,22:0.0005%,31:0.00017%,28:0.00017%,26:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:64.39259%,Single Stage Single Point:35.60741%]
[INFO] ** dst:[21:43.32656%,10:21.06152%,8:18.12183%,9:17.48558%,22:0.00134%,15:0.001%,16:0.00067%,6:0.00067%,24:0.00033%,17:0.00033%,18:0.00017%]
[INFO] ** i/f_dir:[1:99.999%,0:0.001%]
[INFO] ** i/f_name:[2:99.999%,3:0.001%]
[INFO] ** modbus_function_code:[0.02961:99.99716%,-33.760870000000004:0.00284%]
[INFO] ** modbus_function_description:[7:49.99942%,11:49.99774%,0:0.00284%]
[INFO] ** modbus_transaction_id:65536 (10.95006%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99816%,1:0.001%,2:0.00084%]
[INFO] ** proxy_src_ip:[18:38.41928%,20:25.96963%,13:18.12183%,6:17.48574%,17:0.001%,16:0.00067%,1:0.00067%,21:0.00033%,14:0.00033%,7:0.00033%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.9688%,-0.32151:21.06152%,-1.27613:18.1215%,-0.23351:17.48541%,-0.33484:17.35776%,-71.33197:0.001%,-1.02014:0.00067%,1.45709:0.0005%,-71.14931:0.0005%,-1.27347:0.00033%,-5.08665:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,-71.14798:0.00017%,-58.032509999999995:0.00017%,-58.035180000000004:0.00017%,-0.24151:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.96846%,1:21.06136%,5:18.12133%,4:17.48524%,2:17.35776%,0:0.00585%]
[INFO] ** service:[0.0048200000000000005:99.99716%,-211.73542999999998:0.001%,-205.44247:0.00067%,-211.08818:0.0005%,-211.09762999999998:0.00017%,-211.08346:0.00017%,-185.9872:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.41928%,9:25.96963%,7:18.12183%,1:17.48574%,14:0.001%,15:0.00067%,3:0.00067%,21:0.00033%,4:0.00033%,2:0.00033%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1627 (0.27185%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0194 - tp: 79167.0000 - fp: 833.0000 - tn: 319167.0000 - fn: 833.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79093.0000 - fp: 907.0000 - tn: 319093.0000 - fn: 907.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/598499
[33m[INFO] loading file 34-34/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (439932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (439932, 17)

[INFO] analyzing data
[INFO] 439932 rows
[INFO] ** appi_name:[21:99.99773%,30:0.00068%,7:0.00068%,31:0.00023%,22:0.00023%,8:0.00023%,6:0.00023%]
[INFO] ** classification:[normal:64.35745%,Single Stage Single Point:35.64255%]
[INFO] ** dst:[21:43.29737%,10:21.05712%,8:18.18372%,9:17.45906%,22:0.00068%,15:0.00068%,16:0.00045%,2:0.00045%,18:0.00023%,6:0.00023%]
[INFO] ** i/f_dir:[1:99.99932%,0:0.00068%]
[INFO] ** i/f_name:[2:99.99932%,3:0.00068%]
[INFO] ** modbus_function_code:[0.02961:99.99773%,-33.760870000000004:0.00227%]
[INFO] ** modbus_function_description:[7:49.99932%,11:49.99841%,0:0.00227%]
[INFO] ** modbus_transaction_id:65536 (14.89685%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99886%,1:0.00068%,2:0.00045%]
[INFO] ** proxy_src_ip:[18:38.40139%,20:25.95333%,13:18.18349%,6:17.45952%,17:0.00068%,1:0.00068%,21:0.00045%,14:0.00023%,7:0.00023%]
[INFO] ** s_port:[1.45442:25.95287%,-0.32151:21.05689%,-1.27613:18.18349%,-0.23351:17.45883%,-0.33484:17.3445%,-0.24151:0.00068%,-71.33197:0.00068%,-3.0613900000000003:0.00023%,-3.3787199999999995:0.00023%,14.191239999999999:0.00023%,1.46509:0.00023%,1.47576:0.00023%,11.57001:0.00023%,-49.275529999999996:0.00023%,-71.14931:0.00023%,7.66617:0.00023%]
[INFO] ** scada_tag:[3:25.95265%,1:21.05666%,5:18.18326%,4:17.45838%,2:17.3445%,0:0.00455%]
[INFO] ** service:[0.0048200000000000005:99.99795%,-211.09762999999998:0.00068%,-211.73542999999998:0.00068%,-186.43601999999998:0.00023%,-211.35747999999998:0.00023%,-211.08818:0.00023%]
[INFO] ** src:[22:38.40139%,9:25.95333%,7:18.18349%,1:17.45952%,14:0.00068%,3:0.00068%,4:0.00045%,21:0.00023%,2:0.00023%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1195 (0.27163%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/439932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/439932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79062.0000 - fp: 938.0000 - tn: 319062.0000 - fn: 938.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/439932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79106.0000 - fp: 894.0000 - tn: 319106.0000 - fn: 894.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/439932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-33-34-batch-300000-400000
[INFO] processing batch 400000-500000/439932
[33m[INFO] loading file 35-35/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539932, 17)

[INFO] analyzing data
[INFO] 539932 rows
[INFO] ** appi_name:[21:99.99889%,30:0.00111%]
[INFO] ** classification:[normal:64.36866%,Single Stage Single Point:35.63134%]
[INFO] ** dst:[21:43.33305%,10:21.03302%,8:18.15377%,9:17.47794%,22:0.00111%,15:0.00111%]
[INFO] ** i/f_dir:[1:99.99907%,0:0.00093%]
[INFO] ** i/f_name:[2:99.99889%,3:0.00111%]
[INFO] ** modbus_function_code:[0.02961:99.99889%,-33.760870000000004:0.00111%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.9987%,0:0.00111%]
[INFO] ** modbus_transaction_id:65536 (12.13782%)
[INFO] ** orig:[0:99.99963%,1:0.00037%]
[INFO] ** proto:[0:99.99889%,1:0.00111%]
[INFO] ** proxy_src_ip:[18:38.39669%,20:25.96994%,13:18.1534%,6:17.47813%,17:0.00111%,16:0.00074%]
[INFO] ** s_port:[1.45442:25.96938%,-0.32151:21.03302%,-1.27613:18.1534%,-0.23351:17.47776%,-0.33484:17.36367%,-71.33197:0.00111%,-1.02014:0.00074%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.96901%,1:21.03302%,5:18.15321%,4:17.47739%,2:17.36367%,0:0.0037%]
[INFO] ** service:[0.0048200000000000005:99.99889%,-211.73542999999998:0.00111%]
[INFO] ** src:[22:38.39669%,9:25.96994%,7:18.1534%,1:17.47813%,14:0.00111%,15:0.00074%]
[INFO] ** type:[0:99.99907%,1:0.00093%]
[INFO] ** unixtime:1465 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0192 - tp: 79167.0000 - fp: 833.0000 - tn: 319167.0000 - fn: 833.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79136.0000 - fp: 864.0000 - tn: 319136.0000 - fn: 864.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79086.0000 - fp: 914.0000 - tn: 319086.0000 - fn: 914.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79094.0000 - fp: 906.0000 - tn: 319094.0000 - fn: 906.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/539932
[33m[INFO] loading file 36-36/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539932, 17)

[INFO] analyzing data
[INFO] 539932 rows
[INFO] ** appi_name:[21:99.9987%,30:0.00056%,31:0.00037%,33:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.35496%,Single Stage Single Point:35.64504%]
[INFO] ** dst:[21:43.33138%,10:21.02154%,8:18.15673%,9:17.48813%,22:0.00074%,15:0.00056%,24:0.00037%,18:0.00037%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99944%,0:0.00056%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.9987%,-33.760870000000004:0.0013%]
[INFO] ** modbus_function_description:[7:50.00037%,11:49.99833%,0:0.0013%]
[INFO] ** modbus_transaction_id:65536 (12.13782%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99889%,2:0.00056%,1:0.00056%]
[INFO] ** proxy_src_ip:[18:38.3702%,20:25.9829%,13:18.15692%,6:17.48868%,17:0.00056%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.98235%,-0.32151:21.02135%,-1.27613:18.15636%,-0.23351:17.48794%,-0.33484:17.34885%,-0.24151:0.00056%,-71.33197:0.00056%,-1.27347:0.00037%,-0.08551:0.00037%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-49.275529999999996:0.00019%,-1.2708:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:25.98198%,1:21.02117%,5:18.15618%,4:17.48776%,2:17.34867%,0:0.00426%]
[INFO] ** service:[0.0048200000000000005:99.99889%,-211.73542999999998:0.00056%,-186.43601999999998:0.00037%,-186.44547:0.00019%]
[INFO] ** src:[22:38.3702%,9:25.9829%,7:18.15692%,1:17.48868%,14:0.00056%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1467 (0.2717%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79142.0000 - fp: 858.0000 - tn: 319142.0000 - fn: 858.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79038.0000 - fp: 962.0000 - tn: 319038.0000 - fn: 962.0000 - accuracy: 0.9952 - precision: 0.9880 - recall: 0.9880 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79137.0000 - fp: 863.0000 - tn: 319137.0000 - fn: 863.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79134.0000 - fp: 866.0000 - tn: 319134.0000 - fn: 866.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/539932
[33m[INFO] loading file 37-37/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539932, 17)

[INFO] analyzing data
[INFO] 539932 rows
[INFO] ** appi_name:[21:99.99889%,30:0.00074%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.38033%,Single Stage Single Point:35.61967%]
[INFO] ** dst:[21:43.33675%,10:21.04172%,8:18.13691%,9:17.48257%,22:0.00074%,15:0.00074%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99926%,3:0.00074%]
[INFO] ** modbus_function_code:[0.02961:99.99889%,-33.760870000000004:0.00111%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99889%,0:0.00111%]
[INFO] ** modbus_transaction_id:65536 (12.13782%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99907%,1:0.00074%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.39317%,20:25.98568%,13:18.1371%,6:17.48257%,17:0.00074%,16:0.00037%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.98512%,-0.32151:21.04172%,-1.27613:18.13673%,-0.23351:17.48239%,-0.33484:17.35144%,-71.33197:0.00074%,-1.02014:0.00037%,-71.14798:0.00019%,-1.27347:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%,14.4699:0.00019%]
[INFO] ** scada_tag:[3:25.98494%,1:21.04172%,5:18.13654%,4:17.4822%,2:17.35126%,0:0.00333%]
[INFO] ** service:[0.0048200000000000005:99.99889%,-211.73542999999998:0.00074%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.39317%,9:25.98568%,7:18.1371%,1:17.48257%,14:0.00074%,15:0.00037%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1467 (0.2717%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79048.0000 - fp: 952.0000 - tn: 319048.0000 - fn: 952.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79076.0000 - fp: 924.0000 - tn: 319076.0000 - fn: 924.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/539932
[33m[INFO] loading file 38-38/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539932, 17)

[INFO] analyzing data
[INFO] 539932 rows
[INFO] ** appi_name:[21:99.99907%,30:0.00019%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.40793%,Single Stage Single Point:35.59207%]
[INFO] ** dst:[21:43.32138%,10:21.08451%,8:18.09858%,9:17.49368%,22:0.00093%,25:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99907%,-33.760870000000004:0.00093%]
[INFO] ** modbus_function_description:[7:49.99963%,11:49.99944%,0:0.00093%]
[INFO] ** modbus_transaction_id:65536 (12.13782%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99944%,2:0.00037%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.45373%,20:25.95271%,13:18.09839%,6:17.49405%,7:0.00037%,17:0.00019%,16:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95197%,-0.32151:21.08432%,-1.27613:18.0982%,-0.23351:17.4935%,-0.33484:17.36941%,-0.24151:0.00037%,1.45709:0.00037%,-64.19493:0.00019%,10.192739999999999:0.00019%,-1.02014:0.00019%,-71.14798:0.00019%,-61.95768:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.9516%,1:21.08432%,5:18.0982%,4:17.49331%,2:17.36941%,0:0.00315%]
[INFO] ** service:[0.0048200000000000005:99.99926%,-211.08346:0.00019%,-205.44247:0.00019%,-186.44547:0.00019%,-211.73542999999998:0.00019%]
[INFO] ** src:[22:38.45373%,9:25.95271%,7:18.09839%,1:17.49405%,21:0.00037%,16:0.00019%,15:0.00019%,14:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1468 (0.27189%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79140.0000 - fp: 860.0000 - tn: 319140.0000 - fn: 860.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79059.0000 - fp: 941.0000 - tn: 319059.0000 - fn: 941.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.1926e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/539932
[33m[INFO] loading file 39-39/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539932, 17)

[INFO] analyzing data
[INFO] 539932 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.41089%,Single Stage Single Point:35.58911%]
[INFO] ** dst:[21:43.32453%,10:21.08543%,8:18.1271%,9:17.46183%,22:0.00093%,24:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99981%]
[INFO] ** modbus_transaction_id:65536 (12.13782%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.45595%,20:25.95438%,13:18.12728%,6:17.46183%,16:0.00056%]
[INFO] ** s_port:[1.45442:25.95382%,-0.32151:21.08543%,-1.27613:18.12691%,-0.23351:17.46164%,-0.33484:17.37052%,-1.02014:0.00056%,-1.27347:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.95345%,1:21.08525%,5:18.12673%,4:17.46164%,2:17.37034%,0:0.00259%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.45595%,9:25.95438%,7:18.12728%,1:17.46183%,15:0.00056%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1465 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79084.0000 - fp: 916.0000 - tn: 319084.0000 - fn: 916.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 4.8042e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79183.0000 - fp: 817.0000 - tn: 319183.0000 - fn: 817.0000 - accuracy: 0.9959 - precision: 0.9898 - recall: 0.9898 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79091.0000 - fp: 909.0000 - tn: 319091.0000 - fn: 909.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79142.0000 - fp: 858.0000 - tn: 319142.0000 - fn: 858.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/539932
[33m[INFO] loading file 40-40/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539932, 17)

[INFO] analyzing data
[INFO] 539932 rows
[INFO] ** appi_name:[21:99.9963%,30:0.00315%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.33847%,Single Stage Single Point:35.66153%]
[INFO] ** dst:[21:43.29453%,10:21.03895%,8:18.19377%,9:17.46794%,15:0.00315%,22:0.00093%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99704%,0:0.00296%]
[INFO] ** i/f_name:[2:99.99685%,3:0.00315%]
[INFO] ** modbus_function_code:[0.02961:99.9963%,-33.760870000000004:0.0037%]
[INFO] ** modbus_function_description:[7:49.99907%,11:49.99722%,0:0.0037%]
[INFO] ** modbus_transaction_id:65536 (12.13782%)
[INFO] ** orig:[0:99.99963%,1:0.00037%]
[INFO] ** proto:[0:99.9963%,1:0.00315%,2:0.00056%]
[INFO] ** proxy_src_ip:[18:38.35668%,20:25.97772%,13:18.19359%,6:17.46831%,17:0.00315%,14:0.00056%]
[INFO] ** s_port:[1.45442:25.97679%,-0.32151:21.03895%,-1.27613:18.1934%,-0.23351:17.46776%,-0.33484:17.31774%,-71.33197:0.00315%,1.45709:0.00056%,-0.24151:0.00037%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,13.431270000000001:0.00019%]
[INFO] ** scada_tag:[3:25.97642%,1:21.03876%,5:18.19322%,4:17.46738%,2:17.31755%,0:0.00667%]
[INFO] ** service:[0.0048200000000000005:99.9963%,-211.73542999999998:0.00315%,-211.08346:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.35668%,9:25.97772%,7:18.19359%,1:17.46831%,14:0.00315%,2:0.00056%]
[INFO] ** type:[0:99.99907%,1:0.00093%]
[INFO] ** unixtime:1468 (0.27189%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79086.0000 - fp: 914.0000 - tn: 319086.0000 - fn: 914.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79066.0000 - fp: 934.0000 - tn: 319066.0000 - fn: 934.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/539932
[33m[INFO] loading file 41-41/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (480090, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (480090, 17)

[INFO] analyzing data
[INFO] 480090 rows
[INFO] ** appi_name:[21:99.99646%,30:0.00104%,22:0.00083%,17:0.00083%,32:0.00021%,28:0.00021%,26:0.00021%,7:0.00021%]
[INFO] ** classification:[normal:64.39084%,Single Stage Single Point:35.60916%]
[INFO] ** dst:[21:43.3225%,10:21.06397%,8:18.13535%,9:17.4736%,16:0.00104%,15:0.00104%,6:0.00104%,22:0.00062%,24:0.00042%,17:0.00042%]
[INFO] ** i/f_dir:[1:99.99896%,0:0.00104%]
[INFO] ** i/f_name:[2:99.99896%,3:0.00104%]
[INFO] ** modbus_function_code:[0.02961:99.99646%,-33.760870000000004:0.00354%]
[INFO] ** modbus_function_description:[7:49.99896%,11:49.9975%,0:0.00354%]
[INFO] ** modbus_transaction_id:65536 (13.65077%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99771%,2:0.00125%,1:0.00104%]
[INFO] ** proxy_src_ip:[18:38.43779%,20:25.94888%,13:18.13556%,6:17.47381%,17:0.00104%,1:0.00083%,21:0.00042%,16:0.00042%,14:0.00042%,0:0.00042%,7:0.00021%,2:0.00021%]
[INFO] ** s_port:[1.45442:25.94847%,-0.32151:21.06397%,-1.27613:18.13493%,-0.23351:17.47339%,-0.33484:17.37383%,-71.33197:0.00104%,-71.14931:0.00083%,-1.02014:0.00042%,-1.27347:0.00042%,-71.14798:0.00021%,-0.24151:0.00021%,-58.035180000000004:0.00021%,-1.2708:0.00021%,-5.1466400000000005:0.00021%,1.47576:0.00021%,1.46509:0.00021%,-64.19226:0.00021%,-5.08665:0.00021%,-0.24950999999999998:0.00021%,2.05573:0.00021%,-43.76509:0.00021%,-58.032509999999995:0.00021%]
[INFO] ** scada_tag:[3:25.94826%,1:21.06397%,5:18.13493%,4:17.47318%,2:17.37383%,0:0.00583%]
[INFO] ** service:[0.0048200000000000005:99.99646%,-211.73542999999998:0.00104%,-205.44247:0.00083%,-211.08818:0.00083%,89.64175:0.00021%,-211.09762999999998:0.00021%,-211.08346:0.00021%,-185.9872:0.00021%]
[INFO] ** src:[22:38.43779%,9:25.94888%,7:18.13556%,1:17.47381%,14:0.00104%,3:0.00083%,15:0.00042%,8:0.00042%,4:0.00042%,2:0.00042%,21:0.00021%,17:0.00021%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1302 (0.2712%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/480090
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79086.0000 - fp: 914.0000 - tn: 319086.0000 - fn: 914.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/480090
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79128.0000 - fp: 872.0000 - tn: 319128.0000 - fn: 872.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/480090
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79129.0000 - fp: 871.0000 - tn: 319129.0000 - fn: 871.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/480090
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79140.0000 - fp: 860.0000 - tn: 319140.0000 - fn: 860.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/480090
[33m[INFO] loading file 42-42/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (423604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (423604, 17)

[INFO] analyzing data
[INFO] 423604 rows
[INFO] ** appi_name:[21:99.99197%,30:0.00212%,17:0.00118%,31:0.00094%,26:0.00094%,7:0.00094%,22:0.00071%,28:0.00024%,27:0.00024%,9:0.00024%,8:0.00024%,0:0.00024%]
[INFO] ** classification:[normal:64.39104%,Single Stage Single Point:35.60896%]
[INFO] ** dst:[21:43.32702%,10:21.05528%,8:18.16413%,9:17.44436%,16:0.00212%,6:0.00189%,18:0.00118%,22:0.00094%,2:0.00094%,15:0.00071%,17:0.00047%,25:0.00024%,24:0.00024%,7:0.00024%,0:0.00024%]
[INFO] ** i/f_dir:[1:99.99929%,0:0.00071%]
[INFO] ** i/f_name:[2:99.99929%,3:0.00071%]
[INFO] ** modbus_function_code:[0.02961:99.99197%,-33.760870000000004:0.00803%]
[INFO] ** modbus_function_description:[7:49.99693%,11:49.99504%,0:0.00803%]
[INFO] ** modbus_transaction_id:65536 (15.47105%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99575%,2:0.00354%,1:0.00071%]
[INFO] ** proxy_src_ip:[18:38.42079%,20:25.96175%,13:18.16461%,6:17.44436%,17:0.00212%,1:0.00212%,14:0.00142%,21:0.00094%,7:0.00071%,16:0.00047%,0:0.00047%,2:0.00024%]
[INFO] ** s_port:[1.45442:25.96128%,-0.32151:21.05528%,-1.27613:18.16413%,-0.23351:17.44412%,-0.33484:17.36551%,-71.14798:0.00094%,-71.14931:0.00094%,-71.33197:0.00071%,11.57001:0.00047%,-0.08551:0.00047%,-3.3787199999999995:0.00047%,-1.02014:0.00047%,-5.1466400000000005:0.00024%,-0.24151:0.00024%,13.431270000000001:0.00024%,0.31847:0.00024%,-1.2708:0.00024%,-58.035180000000004:0.00024%,7.66617:0.00024%,-64.19493:0.00024%,1.47576:0.00024%,14.4699:0.00024%,15.912510000000001:0.00024%,14.191239999999999:0.00024%,7.9608300000000005:0.00024%,-5.08665:0.00024%,10.192739999999999:0.00024%,-3.0613900000000003:0.00024%,1.45709:0.00024%,2.05573:0.00024%,-43.76509:0.00024%,11.862:0.00024%,-1.27347:0.00024%,-58.032509999999995:0.00024%]
[INFO] ** scada_tag:[3:25.9608%,1:21.05528%,5:18.1639%,4:17.44412%,2:17.36528%,0:0.01062%]
[INFO] ** service:[0.0048200000000000005:99.99197%,-211.09762999999998:0.00165%,-205.44247:0.00118%,-186.43601999999998:0.00118%,-211.08346:0.00094%,-211.08818:0.00094%,-211.73542999999998:0.00071%,-211.35747999999998:0.00047%,-186.44547:0.00024%,-183.8612:0.00024%,-185.9872:0.00024%,-202.75898:0.00024%]
[INFO] ** src:[22:38.42079%,9:25.96175%,7:18.16461%,1:17.44436%,3:0.00283%,2:0.00165%,4:0.00118%,21:0.00094%,14:0.00071%,15:0.00047%,8:0.00047%,17:0.00024%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1150 (0.27148%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/423604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79160.0000 - fp: 840.0000 - tn: 319160.0000 - fn: 840.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1939e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/423604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79064.0000 - fp: 936.0000 - tn: 319064.0000 - fn: 936.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.2144e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/423604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79116.0000 - fp: 884.0000 - tn: 319116.0000 - fn: 884.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/423604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79079.0000 - fp: 921.0000 - tn: 319079.0000 - fn: 921.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-41-42-batch-300000-400000
[INFO] processing batch 400000-500000/423604
[33m[INFO] loading file 43-43/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99924%,30:0.00057%,26:0.00019%]
[INFO] ** classification:[normal:64.39867%,Single Stage Single Point:35.60133%]
[INFO] ** dst:[21:43.3316%,10:21.06535%,8:18.13088%,9:17.47026%,22:0.00095%,15:0.00057%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99924%,-33.760870000000004:0.00076%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99924%,0:0.00076%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99924%,1:0.00057%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.41816%,20:25.97918%,13:18.13107%,6:17.47045%,17:0.00057%,16:0.00038%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.9786%,-0.32151:21.06535%,-1.27613:18.13069%,-0.23351:17.47007%,-0.33484:17.35281%,-71.33197:0.00057%,1.45709:0.00038%,-1.02014:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.97822%,1:21.06535%,5:18.1305%,4:17.46969%,2:17.35262%,0:0.00363%]
[INFO] ** service:[0.0048200000000000005:99.99924%,-211.73542999999998:0.00057%,-211.08346:0.00019%]
[INFO] ** src:[22:38.41816%,9:25.97918%,7:18.13107%,1:17.47045%,14:0.00057%,15:0.00038%,3:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1424 (0.27196%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79088.0000 - fp: 912.0000 - tn: 319088.0000 - fn: 912.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79127.0000 - fp: 873.0000 - tn: 319127.0000 - fn: 873.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 7.2106e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79149.0000 - fp: 851.0000 - tn: 319149.0000 - fn: 851.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 44-44/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99809%,30:0.00076%,31:0.00057%,0:0.00038%,22:0.00019%]
[INFO] ** classification:[normal:64.36868%,Single Stage Single Point:35.63132%]
[INFO] ** dst:[21:43.32282%,10:21.04262%,8:18.16506%,9:17.46606%,22:0.00115%,15:0.00076%,18:0.00057%,25:0.00038%,24:0.00038%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99924%,0:0.00076%]
[INFO] ** i/f_name:[2:99.99924%,3:0.00076%]
[INFO] ** modbus_function_code:[0.02961:99.99809%,-33.760870000000004:0.00191%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.9979%,0:0.00191%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99809%,2:0.00115%,1:0.00076%]
[INFO] ** proxy_src_ip:[18:38.41395%,20:25.95206%,13:18.16525%,6:17.46664%,17:0.00076%,7:0.00038%,16:0.00019%,5:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95129%,-0.32151:21.04262%,-1.27613:18.16468%,-0.23351:17.46587%,-0.33484:17.37133%,-71.33197:0.00076%,-0.24151:0.00057%,1.45709:0.00038%,-64.19493:0.00038%,-0.08551:0.00038%,-1.27347:0.00038%,1.46509:0.00019%,1.47576:0.00019%,-0.24950999999999998:0.00019%,4.42897:0.00019%,-71.14931:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.95072%,1:21.04262%,5:18.16468%,4:17.46549%,2:17.37114%,0:0.00535%]
[INFO] ** service:[0.0048200000000000005:99.99809%,-211.73542999999998:0.00076%,-186.43601999999998:0.00057%,-186.44547:0.00038%,-211.08818:0.00019%]
[INFO] ** src:[22:38.41395%,9:25.95206%,7:18.16525%,1:17.46664%,14:0.00076%,21:0.00038%,17:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1421 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79148.0000 - fp: 852.0000 - tn: 319148.0000 - fn: 852.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79127.0000 - fp: 873.0000 - tn: 319127.0000 - fn: 873.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 8.1652e-04 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79136.0000 - fp: 864.0000 - tn: 319136.0000 - fn: 864.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 45-45/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99905%,30:0.00057%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.41681%,Single Stage Single Point:35.58319%]
[INFO] ** dst:[21:43.32301%,10:21.09151%,8:18.12152%,9:17.46186%,22:0.00115%,15:0.00057%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99905%,-33.760870000000004:0.00095%]
[INFO] ** modbus_function_description:[7:50.00038%,11:49.99866%,0:0.00095%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99924%,1:0.00057%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.48596%,20:25.92933%,13:18.12133%,6:17.46205%,17:0.00057%,16:0.00038%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.92856%,-0.32151:21.09151%,-1.27613:18.12133%,-0.23351:17.46167%,-0.33484:17.39444%,1.45709:0.00057%,-71.33197:0.00057%,-1.02014:0.00038%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.92799%,1:21.09132%,5:18.12133%,4:17.46167%,2:17.39425%,0:0.00344%]
[INFO] ** service:[0.0048200000000000005:99.99905%,-211.73542999999998:0.00057%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.48596%,9:25.92933%,7:18.12133%,1:17.46205%,14:0.00057%,15:0.00038%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1421 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79119.0000 - fp: 881.0000 - tn: 319119.0000 - fn: 881.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79094.0000 - fp: 906.0000 - tn: 319094.0000 - fn: 906.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79084.0000 - fp: 916.0000 - tn: 319084.0000 - fn: 916.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 46-46/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99809%,30:0.00115%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.42139%,Single Stage Single Point:35.57861%]
[INFO] ** dst:[21:43.34745%,10:21.07127%,8:18.10624%,9:17.47236%,15:0.00115%,22:0.00095%,25:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99905%,0:0.00095%]
[INFO] ** i/f_name:[2:99.99885%,3:0.00115%]
[INFO] ** modbus_function_code:[0.02961:99.99809%,-33.760870000000004:0.00191%]
[INFO] ** modbus_function_description:[11:49.99924%,7:49.99885%,0:0.00191%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99847%,1:0.00115%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:38.44298%,20:25.97555%,13:18.10624%,6:17.47294%,17:0.00115%,16:0.00038%,7:0.00038%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.97536%,-0.32151:21.07108%,-1.27613:18.10605%,-0.23351:17.47217%,-0.33484:17.37191%,-71.33197:0.00115%,-0.24151:0.00057%,-1.02014:0.00038%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,10.192739999999999:0.00019%,1.47576:0.00019%,-61.95768:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.97497%,1:21.07089%,5:18.10586%,4:17.47179%,2:17.37191%,0:0.00458%]
[INFO] ** service:[0.0048200000000000005:99.99828%,-211.73542999999998:0.00115%,-186.44547:0.00019%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.44298%,9:25.97555%,7:18.10624%,1:17.47294%,14:0.00115%,21:0.00038%,15:0.00038%,16:0.00019%,8:0.00019%]
[INFO] ** type:[0:99.99905%,1:0.00095%]
[INFO] ** unixtime:1423 (0.27177%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79145.0000 - fp: 855.0000 - tn: 319145.0000 - fn: 855.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 8.9450e-04 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79124.0000 - fp: 876.0000 - tn: 319124.0000 - fn: 876.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79146.0000 - fp: 854.0000 - tn: 319146.0000 - fn: 854.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79075.0000 - fp: 925.0000 - tn: 319075.0000 - fn: 925.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 47-47/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99943%,33:0.00019%,26:0.00019%,17:0.00019%]
[INFO] ** classification:[normal:64.3958%,Single Stage Single Point:35.6042%]
[INFO] ** dst:[21:43.30486%,10:21.08884%,8:18.12725%,9:17.47657%,22:0.00172%,24:0.00038%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99943%,-33.760870000000004:0.00057%]
[INFO] ** modbus_function_description:[7:50.00095%,11:49.99847%,0:0.00057%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99981%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.46036%,20:25.9341%,13:18.12763%,6:17.47695%,16:0.00038%,7:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.93315%,-0.32151:21.08884%,-1.27613:18.12706%,-0.23351:17.47638%,-0.33484:17.37153%,1.45709:0.00057%,-0.24151:0.00057%,-1.27347:0.00038%,-1.02014:0.00038%,-71.14798:0.00019%,-61.95635:0.00019%,10.192739999999999:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.93257%,1:21.08865%,5:18.12687%,4:17.47618%,2:17.37133%,0:0.00439%]
[INFO] ** service:[0.0048200000000000005:99.99962%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.46036%,9:25.9341%,7:18.12763%,1:17.47695%,21:0.00038%,15:0.00038%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1421 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79128.0000 - fp: 872.0000 - tn: 319128.0000 - fn: 872.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.0008e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79165.0000 - fp: 835.0000 - tn: 319165.0000 - fn: 835.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 48-48/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99656%,30:0.00267%,33:0.00019%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.41758%,Single Stage Single Point:35.58242%]
[INFO] ** dst:[21:43.33046%,10:21.08311%,8:18.11254%,9:17.4695%,15:0.00267%,22:0.00095%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99771%,0:0.00229%]
[INFO] ** i/f_name:[2:99.99733%,3:0.00267%]
[INFO] ** modbus_function_code:[0.02961:99.99656%,-33.760870000000004:0.00344%]
[INFO] ** modbus_function_description:[7:49.99885%,11:49.99771%,0:0.00344%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99675%,1:0.00267%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.45444%,20:25.95931%,13:18.11293%,6:17.4695%,17:0.00267%,14:0.00057%,16:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95893%,-0.32151:21.08311%,-1.27613:18.11254%,-0.23351:17.46931%,-0.33484:17.37133%,-71.33197:0.00267%,-1.02014:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,1.45709:0.00019%,-61.95635:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,13.431270000000001:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.95855%,1:21.08311%,5:18.11254%,4:17.46931%,2:17.37114%,0:0.00535%]
[INFO] ** service:[0.0048200000000000005:99.99675%,-211.73542999999998:0.00267%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.45444%,9:25.95931%,7:18.11293%,1:17.4695%,14:0.00267%,2:0.00057%,15:0.00038%,8:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1421 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79094.0000 - fp: 906.0000 - tn: 319094.0000 - fn: 906.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79142.0000 - fp: 858.0000 - tn: 319142.0000 - fn: 858.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79049.0000 - fp: 951.0000 - tn: 319049.0000 - fn: 951.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9999 - val_loss: 1.2064e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79116.0000 - fp: 884.0000 - tn: 319116.0000 - fn: 884.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.7558e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 49-49/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99733%,30:0.00095%,17:0.00076%,22:0.00038%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.36601%,Single Stage Single Point:35.63399%]
[INFO] ** dst:[21:43.30219%,10:21.05943%,8:18.14367%,9:17.49032%,22:0.00134%,15:0.00095%,16:0.00076%,6:0.00057%,24:0.00038%,17:0.00038%]
[INFO] ** i/f_dir:[1:99.99905%,0:0.00095%]
[INFO] ** i/f_name:[2:99.99905%,3:0.00095%]
[INFO] ** modbus_function_code:[0.02961:99.99733%,-33.760870000000004:0.00267%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99771%,0:0.00267%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99847%,1:0.00095%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.4193%,20:25.94308%,13:18.14367%,6:17.49089%,17:0.00095%,1:0.00076%,21:0.00038%,16:0.00038%,14:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.94232%,-0.32151:21.05943%,-1.27613:18.14329%,-0.23351:17.49013%,-0.33484:17.35988%,-71.33197:0.00095%,-0.24151:0.00057%,1.45709:0.00038%,-1.02014:0.00038%,-71.14931:0.00038%,-1.27347:0.00038%,-71.14798:0.00019%,-58.035180000000004:0.00019%,-5.1466400000000005:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-5.08665:0.00019%,-0.24950999999999998:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:25.94193%,1:21.05924%,5:18.1431%,4:17.48974%,2:17.35988%,0:0.00611%]
[INFO] ** service:[0.0048200000000000005:99.99733%,-211.73542999999998:0.00095%,-205.44247:0.00076%,-211.08818:0.00038%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.4193%,9:25.94308%,7:18.14367%,1:17.49089%,14:0.00095%,3:0.00076%,15:0.00038%,4:0.00038%,2:0.00038%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1422 (0.27158%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79076.0000 - fp: 924.0000 - tn: 319076.0000 - fn: 924.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79062.0000 - fp: 938.0000 - tn: 319062.0000 - fn: 938.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79072.0000 - fp: 928.0000 - tn: 319072.0000 - fn: 928.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 50-50/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (373586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (373586, 17)

[INFO] analyzing data
[INFO] 373586 rows
[INFO] ** appi_name:[21:99.99732%,30:0.00107%,7:0.0008%,31:0.00027%,22:0.00027%,8:0.00027%]
[INFO] ** classification:[normal:64.29631%,Single Stage Single Point:35.70369%]
[INFO] ** dst:[21:43.25216%,10:21.04094%,8:18.22713%,9:17.4763%,15:0.00107%,22:0.00054%,16:0.00054%,2:0.00054%,24:0.00027%,18:0.00027%,6:0.00027%]
[INFO] ** i/f_dir:[1:99.99893%,0:0.00107%]
[INFO] ** i/f_name:[2:99.99893%,3:0.00107%]
[INFO] ** modbus_function_code:[0.02961:99.99732%,-33.760870000000004:0.00268%]
[INFO] ** modbus_function_description:[11:49.99893%,7:49.99839%,0:0.00268%]
[INFO] ** modbus_transaction_id:65535 (17.54215%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99839%,1:0.00107%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.36145%,20:25.93191%,13:18.2274%,6:17.4763%,17:0.00107%,1:0.0008%,21:0.00027%,16:0.00027%,14:0.00027%,7:0.00027%]
[INFO] ** s_port:[1.45442:25.93138%,-0.32151:21.04094%,-1.27613:18.22686%,-0.23351:17.4763%,-0.33484:17.32051%,-71.33197:0.00107%,-3.3787199999999995:0.00027%,4.33564:0.00027%,15.912510000000001:0.00027%,7.9608300000000005:0.00027%,1.46509:0.00027%,1.45709:0.00027%,-1.27347:0.00027%,-71.14931:0.00027%,-1.02014:0.00027%,-1.2708:0.00027%,0.31847:0.00027%]
[INFO] ** scada_tag:[3:25.93111%,1:21.04067%,5:18.22659%,4:17.4763%,2:17.32024%,0:0.00509%]
[INFO] ** service:[0.0048200000000000005:99.99732%,-211.73542999999998:0.00107%,-211.09762999999998:0.0008%,-186.43601999999998:0.00027%,-211.35747999999998:0.00027%,-211.08818:0.00027%]
[INFO] ** src:[22:38.36145%,9:25.93191%,7:18.2274%,1:17.4763%,14:0.00107%,3:0.0008%,21:0.00027%,15:0.00027%,4:0.00027%,2:0.00027%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1015 (0.27169%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/373586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79091.0000 - fp: 909.0000 - tn: 319091.0000 - fn: 909.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/373586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79073.0000 - fp: 927.0000 - tn: 319073.0000 - fn: 927.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/373586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.5500e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/373586
[33m[INFO] epoch 4/10[0m
[33m[INFO] loading file 1-1/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99355%,30:0.00105%,22:0.00087%,17:0.0007%,7:0.0007%,31:0.00052%,26:0.00052%,23:0.00035%,18:0.00035%,0:0.00035%,28:0.00017%,27:0.00017%,24:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:77.37096%,Single Stage Single Point:22.62904%]
[INFO] ** dst:[21:43.26762%,10:21.03643%,8:18.17129%,9:17.51769%,6:0.00139%,22:0.00105%,16:0.00105%,15:0.00105%,18:0.00052%,26:0.00035%,25:0.00035%,19:0.00035%,17:0.00035%,24:0.00017%,7:0.00017%,2:0.00017%]
[INFO] ** i/f_dir:[1:99.99895%,0:0.00105%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.99355%,-33.760870000000004:0.00628%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99756%,11:49.99599%,0:0.00628%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99651%,2:0.00244%,1:0.00105%]
[INFO] ** proxy_src_ip:[18:38.39581%,20:25.90788%,13:18.17147%,6:17.51804%,11:0.00122%,10:0.00122%,17:0.00105%,1:0.00105%,14:0.00087%,7:0.00052%,21:0.00035%,16:0.00035%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.90736%,-0.32151:21.03573%,-1.27613:18.17112%,-0.23351:17.51751%,-0.33484:17.36008%,-71.33197:0.00105%,-71.14931:0.00087%,-2.1481:0.0007%,-71.14798:0.00052%,-0.24151:0.00052%,-64.19493:0.00035%,-2.42942:0.00035%,4.44364:0.00035%,-1.02014:0.00035%,1.47576:0.00017%,-5.1466400000000005:0.00017%,-1.27347:0.00017%,10.67005:0.00017%,4.29964:0.00017%,-5.08665:0.00017%,1.45709:0.00017%,-68.79874000000001:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,14.253910000000001:0.00017%,4.076980000000001:0.00017%,-58.032509999999995:0.00017%,-58.035180000000004:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,0.31847:0.00017%]
[INFO] ** scada_tag:[3:25.90719%,1:21.03556%,5:18.17077%,4:17.51734%,2:17.35991%,0:0.00924%]
[INFO] ** service:[0.0048200000000000005:99.99425%,-211.73542999999998:0.00105%,-211.08818:0.00087%,-211.09762999999998:0.0007%,-205.44247:0.0007%,-211.07873999999998:0.0007%,-211.08346:0.00052%,-186.43601999999998:0.00052%,-186.44547:0.00035%,-185.9872:0.00017%,-202.75898:0.00017%]
[INFO] ** src:[22:38.39581%,9:25.90788%,7:18.17147%,1:17.51804%,11:0.00122%,10:0.00122%,14:0.00105%,3:0.00105%,2:0.00087%,21:0.00052%,15:0.00035%,4:0.00035%,8:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1557 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1789 - tp: 78186.0000 - fp: 1814.0000 - tn: 318186.0000 - fn: 1814.0000 - accuracy: 0.9909 - precision: 0.9773 - recall: 0.9773 - auc: 0.9933 - val_loss: 3.9154e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0094 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1944e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0059 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1925e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7417 - tp: 66807.0000 - fp: 13193.0000 - tn: 306807.0000 - fn: 13193.0000 - accuracy: 0.9340 - precision: 0.8351 - recall: 0.8351 - auc: 0.9599 - val_loss: 1.3623 - val_tp: 10612.0000 - val_fp: 9388.0000 - val_tn: 70612.0000 - val_fn: 9388.0000 - val_accuracy: 0.8122 - val_precision: 0.5306 - val_recall: 0.5306 - val_auc: 0.9030
[INFO] saving weights to checkpoints/lstm-epoch-4-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5613 - tp: 63456.0000 - fp: 16544.0000 - tn: 303456.0000 - fn: 16544.0000 - accuracy: 0.9173 - precision: 0.7932 - recall: 0.7932 - auc: 0.9636 - val_loss: 0.1862 - val_tp: 18680.0000 - val_fp: 1320.0000 - val_tn: 78680.0000 - val_fn: 1320.0000 - val_accuracy: 0.9736 - val_precision: 0.9340 - val_recall: 0.9340 - val_auc: 0.9958
[INFO] saving weights to checkpoints/lstm-epoch-4-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 2-2/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99861%,30:0.00052%,7:0.00052%,31:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:70.25834%,Single Stage Single Point:29.74166%]
[INFO] ** dst:[21:43.31417%,10:21.02475%,8:18.13677%,9:17.52187%,22:0.00087%,15:0.00052%,16:0.00035%,2:0.00035%,24:0.00017%,18:0.00017%]
[INFO] ** i/f_dir:[1:99.99948%,0:0.00052%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.99861%,-33.760870000000004:0.00139%]
[INFO] ** modbus_function_description:[7:49.99983%,11:49.99878%,0:0.00139%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9993%,1:0.00052%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.37716%,20:25.96228%,13:18.13677%,6:17.52222%,17:0.00052%,1:0.00052%,16:0.00017%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.96158%,-0.32151:21.02475%,-1.27613:18.13643%,-0.23351:17.5217%,-0.33484:17.35241%,-71.33197:0.00052%,-0.24151:0.00035%,1.45709:0.00035%,1.46509:0.00017%,1.47576:0.00017%,12.60597:0.00017%,10.67005:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,4.076980000000001:0.00017%,-3.3787199999999995:0.00017%,4.29964:0.00017%,-1.27347:0.00017%]
[INFO] ** scada_tag:[3:25.96123%,1:21.02475%,5:18.13643%,4:17.52135%,2:17.35224%,0:0.00401%]
[INFO] ** service:[0.0048200000000000005:99.99861%,-211.09762999999998:0.00052%,-211.73542999999998:0.00052%,-211.35747999999998:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.37716%,9:25.96228%,7:18.13677%,1:17.52222%,14:0.00052%,3:0.00052%,21:0.00017%,15:0.00017%,2:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1560 (0.27197%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1614 - tp: 74447.0000 - fp: 5553.0000 - tn: 314447.0000 - fn: 5553.0000 - accuracy: 0.9722 - precision: 0.9306 - recall: 0.9306 - auc: 0.9962 - val_loss: 0.0623 - val_tp: 19187.0000 - val_fp: 813.0000 - val_tn: 79187.0000 - val_fn: 813.0000 - val_accuracy: 0.9837 - val_precision: 0.9593 - val_recall: 0.9593 - val_auc: 0.9994
[INFO] saving weights to checkpoints/lstm-epoch-4-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0928 - tp: 76425.0000 - fp: 3575.0000 - tn: 316425.0000 - fn: 3575.0000 - accuracy: 0.9821 - precision: 0.9553 - recall: 0.9553 - auc: 0.9986 - val_loss: 0.0456 - val_tp: 19633.0000 - val_fp: 367.0000 - val_tn: 79633.0000 - val_fn: 367.0000 - val_accuracy: 0.9927 - val_precision: 0.9816 - val_recall: 0.9816 - val_auc: 0.9994
[INFO] saving weights to checkpoints/lstm-epoch-4-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0704 - tp: 79441.0000 - fp: 559.0000 - tn: 319441.0000 - fn: 559.0000 - accuracy: 0.9972 - precision: 0.9930 - recall: 0.9930 - auc: 0.9975 - val_loss: 1.8069e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6145 - tp: 59597.0000 - fp: 20403.0000 - tn: 299597.0000 - fn: 20403.0000 - accuracy: 0.8980 - precision: 0.7450 - recall: 0.7450 - auc: 0.9493 - val_loss: 0.5332 - val_tp: 10620.0000 - val_fp: 9380.0000 - val_tn: 70620.0000 - val_fn: 9380.0000 - val_accuracy: 0.8124 - val_precision: 0.5310 - val_recall: 0.5310 - val_auc: 0.9292
[INFO] saving weights to checkpoints/lstm-epoch-4-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4088 - tp: 63494.0000 - fp: 16506.0000 - tn: 303494.0000 - fn: 16506.0000 - accuracy: 0.9175 - precision: 0.7937 - recall: 0.7937 - auc: 0.9709 - val_loss: 0.3489 - val_tp: 16520.0000 - val_fp: 3480.0000 - val_tn: 76520.0000 - val_fn: 3480.0000 - val_accuracy: 0.9304 - val_precision: 0.8260 - val_recall: 0.8260 - val_auc: 0.9835
[INFO] saving weights to checkpoints/lstm-epoch-4-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 3-3/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99198%,30:0.00209%,22:0.00105%,31:0.00087%,26:0.00087%,17:0.00087%,7:0.0007%,27:0.00035%,0:0.00035%,28:0.00017%,23:0.00017%,15:0.00017%,8:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:88.37716%,Single Stage Single Point:11.62284%]
[INFO] ** dst:[21:43.30719%,10:21.08054%,8:18.15874%,9:17.44464%,6:0.00209%,15:0.00139%,18:0.00122%,16:0.00122%,22:0.00087%,2:0.00035%,7:0.00035%,25:0.00035%,17:0.00035%,12:0.00017%,24:0.00017%,19:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99861%,0:0.00139%]
[INFO] ** i/f_name:[2:99.99861%,3:0.00139%]
[INFO] ** modbus_function_code:[0.02961:99.99198%,-33.760870000000004:0.00785%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99669%,11:49.99529%,0:0.00785%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99895%,2:0.00105%]
[INFO] ** proto:[0:99.99442%,2:0.00418%,1:0.00139%]
[INFO] ** proxy_src_ip:[18:38.40523%,20:25.98268%,13:18.15909%,6:17.44499%,17:0.00209%,1:0.00139%,14:0.00122%,7:0.00087%,11:0.0007%,10:0.0007%,21:0.00052%,16:0.00017%,15:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.98198%,-0.32151:21.08036%,-1.27613:18.15839%,-0.23351:17.44446%,-0.33484:17.32486%,-71.33197:0.00139%,-71.14931:0.00105%,-71.14798:0.00105%,-64.19493:0.00035%,-1.2708:0.00035%,-0.08551:0.00035%,1.45709:0.00035%,-0.24151:0.00035%,13.86459:0.00017%,2.05573:0.00017%,6.1115699999999995:0.00017%,4.44364:0.00017%,-5.08665:0.00017%,-3.3787199999999995:0.00017%,10.192739999999999:0.00017%,4.29964:0.00017%,14.4699:0.00017%,-43.76509:0.00017%,-58.035180000000004:0.00017%,4.90362:0.00017%,4.076980000000001:0.00017%,-58.032509999999995:0.00017%,-1.27347:0.00017%,-1.02014:0.00017%,-5.1466400000000005:0.00017%,13.431270000000001:0.00017%,12.60597:0.00017%,1.47576:0.00017%,1.46509:0.00017%,14.253910000000001:0.00017%,-68.79874000000001:0.00017%,-0.24950999999999998:0.00017%,-2.1481:0.00017%,10.67005:0.00017%,-68.36943000000001:0.00017%]
[INFO] ** scada_tag:[3:25.98163%,1:21.08019%,5:18.15822%,4:17.44429%,2:17.32469%,0:0.01098%]
[INFO] ** service:[0.0048200000000000005:99.99215%,-211.73542999999998:0.00139%,-186.43601999999998:0.00122%,-211.08346:0.00105%,-211.08818:0.00105%,-205.44247:0.00087%,-211.09762999999998:0.0007%,-202.75898:0.00035%,-186.44547:0.00035%,-183.8612:0.00017%,-185.9872:0.00017%,-201.23771000000002:0.00017%,-211.35747999999998:0.00017%,-211.07873999999998:0.00017%]
[INFO] ** src:[22:38.40523%,9:25.98268%,7:18.15909%,1:17.44499%,21:0.00192%,3:0.00157%,2:0.00122%,11:0.0007%,10:0.0007%,4:0.0007%,14:0.00035%,8:0.00035%,17:0.00017%,15:0.00017%,13:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1558 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0977 - tp: 78359.0000 - fp: 1641.0000 - tn: 318359.0000 - fn: 1641.0000 - accuracy: 0.9918 - precision: 0.9795 - recall: 0.9795 - auc: 0.9986 - val_loss: 2.0804 - val_tp: 10572.0000 - val_fp: 9428.0000 - val_tn: 70572.0000 - val_fn: 9428.0000 - val_accuracy: 0.8114 - val_precision: 0.5286 - val_recall: 0.5286 - val_auc: 0.9024
[INFO] saving weights to checkpoints/lstm-epoch-4-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3205 - tp: 70507.0000 - fp: 9493.0000 - tn: 310507.0000 - fn: 9493.0000 - accuracy: 0.9525 - precision: 0.8813 - recall: 0.8813 - auc: 0.9840 - val_loss: 0.0519 - val_tp: 19651.0000 - val_fp: 349.0000 - val_tn: 79651.0000 - val_fn: 349.0000 - val_accuracy: 0.9930 - val_precision: 0.9826 - val_recall: 0.9826 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-4-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3656 - tp: 69595.0000 - fp: 10405.0000 - tn: 309595.0000 - fn: 10405.0000 - accuracy: 0.9480 - precision: 0.8699 - recall: 0.8699 - auc: 0.9771 - val_loss: 0.1505 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0608 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0103 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0017 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 4-4/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99773%,30:0.00122%,31:0.00035%,33:0.00017%,26:0.00017%,23:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:92.36732%,Single Stage Single Point:7.63268%]
[INFO] ** dst:[21:43.34938%,10:20.951%,8:18.17565%,9:17.5203%,22:0.00122%,15:0.00122%,24:0.00035%,18:0.00035%,19:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99895%,0:0.00105%]
[INFO] ** i/f_name:[2:99.99878%,3:0.00122%]
[INFO] ** modbus_function_code:[0.02961:99.99773%,-33.760870000000004:0.00227%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99773%,0:0.00227%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99895%,2:0.00105%]
[INFO] ** proto:[0:99.99826%,1:0.00122%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.26227%,20:26.03847%,13:18.17583%,6:17.52065%,17:0.00122%,16:0.00052%,21:0.00035%,14:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.03777%,-0.32151:20.95083%,-1.27613:18.1753%,-0.23351:17.52013%,-0.33484:17.31144%,-71.33197:0.00122%,-1.02014:0.00052%,1.45709:0.00035%,-0.08551:0.00035%,-1.27347:0.00035%,-0.24151:0.00035%,14.4699:0.00017%,4.44364:0.00017%,-71.14798:0.00017%,-1.2708:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:26.03742%,1:20.95065%,5:18.1753%,4:17.51978%,2:17.31127%,0:0.00558%]
[INFO] ** service:[0.0048200000000000005:99.99791%,-211.73542999999998:0.00122%,-186.43601999999998:0.00035%,-183.8612:0.00017%,-211.08346:0.00017%,-211.07873999999998:0.00017%]
[INFO] ** src:[22:38.26227%,9:26.03847%,7:18.17583%,1:17.52065%,21:0.00105%,15:0.00052%,4:0.00035%,17:0.00017%,14:0.00017%,8:0.00017%,3:0.00017%,2:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1568 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0132 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2335e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0101 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.1658e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0084 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9019e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0073 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.2501e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8127 - tp: 54969.0000 - fp: 25031.0000 - tn: 294969.0000 - fn: 25031.0000 - accuracy: 0.8748 - precision: 0.6871 - recall: 0.6871 - auc: 0.9229 - val_loss: 0.7757 - val_tp: 7842.0000 - val_fp: 12158.0000 - val_tn: 67842.0000 - val_fn: 12158.0000 - val_accuracy: 0.7568 - val_precision: 0.3921 - val_recall: 0.3921 - val_auc: 0.8654
[INFO] saving weights to checkpoints/lstm-epoch-4-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 5-5/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99616%,30:0.00279%,37:0.00017%,26:0.00017%,12:0.00017%,9:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:88.95144%,Single Stage Single Point:11.04856%]
[INFO] ** dst:[21:43.36473%,10:20.77108%,8:18.23737%,9:17.62229%,15:0.00279%,22:0.00087%,25:0.00017%,24:0.00017%,6:0.00017%,2:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99756%,0:0.00244%]
[INFO] ** i/f_name:[2:99.99721%,3:0.00279%]
[INFO] ** modbus_function_code:[0.02961:99.99616%,-33.760870000000004:0.00384%]
[INFO] ** modbus_function_description:[7:49.99861%,11:49.99756%,0:0.00384%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99773%,2:0.00227%]
[INFO] ** proto:[0:99.99686%,1:0.00279%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.00895%,20:26.12721%,13:18.23737%,6:17.62247%,17:0.00279%,1:0.00035%,21:0.00017%,16:0.00017%,7:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.12651%,-0.32151:20.77073%,-1.27613:18.2372%,-0.23351:17.62212%,-0.33484:17.23822%,-71.33197:0.00279%,-0.24151:0.00035%,1.45709:0.00035%,1.47576:0.00017%,1.46509:0.00017%,-49.275529999999996:0.00017%,-1.27347:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,2.22906:0.00017%,14.4699:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.12616%,1:20.77056%,5:18.23702%,4:17.62212%,2:17.23822%,0:0.00593%]
[INFO] ** service:[0.0048200000000000005:99.99651%,-211.73542999999998:0.00279%,-183.8612:0.00017%,-211.08346:0.00017%,-211.35747999999998:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.00895%,9:26.12721%,7:18.23737%,1:17.62247%,21:0.00244%,14:0.00052%,3:0.00035%,16:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1571 (0.27389%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3049 - tp: 72964.0000 - fp: 7036.0000 - tn: 312964.0000 - fn: 7036.0000 - accuracy: 0.9648 - precision: 0.9121 - recall: 0.9121 - auc: 0.9823 - val_loss: 0.1018 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4196 - tp: 62476.0000 - fp: 17524.0000 - tn: 302476.0000 - fn: 17524.0000 - accuracy: 0.9124 - precision: 0.7810 - recall: 0.7810 - auc: 0.9762 - val_loss: 0.2284 - val_tp: 16498.0000 - val_fp: 3502.0000 - val_tn: 76498.0000 - val_fn: 3502.0000 - val_accuracy: 0.9300 - val_precision: 0.8249 - val_recall: 0.8249 - val_auc: 0.9923
[INFO] saving weights to checkpoints/lstm-epoch-4-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2974 - tp: 65024.0000 - fp: 14976.0000 - tn: 305024.0000 - fn: 14976.0000 - accuracy: 0.9251 - precision: 0.8128 - recall: 0.8128 - auc: 0.9845 - val_loss: 0.3468 - val_tp: 16346.0000 - val_fp: 3654.0000 - val_tn: 76346.0000 - val_fn: 3654.0000 - val_accuracy: 0.9269 - val_precision: 0.8173 - val_recall: 0.8173 - val_auc: 0.9756
[INFO] saving weights to checkpoints/lstm-epoch-4-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1203 - tp: 79510.0000 - fp: 490.0000 - tn: 319510.0000 - fn: 490.0000 - accuracy: 0.9976 - precision: 0.9939 - recall: 0.9939 - auc: 0.9997 - val_loss: 0.0533 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0260 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5380e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 6-6/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99599%,30:0.00314%,31:0.00017%,27:0.00017%,26:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:92.95572%,Single Stage Single Point:7.04428%]
[INFO] ** dst:[21:43.37606%,10:20.73046%,8:18.27869%,9:17.61009%,15:0.00314%,22:0.00052%,25:0.00017%,24:0.00017%,18:0.00017%,12:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99704%,0:0.00296%]
[INFO] ** i/f_name:[2:99.99686%,3:0.00314%]
[INFO] ** modbus_function_code:[0.02961:99.99599%,-33.760870000000004:0.00401%]
[INFO] ** modbus_function_description:[7:49.99878%,11:49.99721%,0:0.00401%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99965%,1:0.00035%]
[INFO] ** proto:[0:99.99599%,1:0.00314%,2:0.00087%]
[INFO] ** proxy_src_ip:[18:37.94061%,20:26.16608%,13:18.27886%,6:17.61026%,17:0.00314%,14:0.00052%,16:0.00035%,11:0.00017%]
[INFO] ** s_port:[1.45442:26.16574%,-0.32151:20.73046%,-1.27613:18.27834%,-0.23351:17.60991%,-0.33484:17.21015%,-71.33197:0.00314%,-1.02014:0.00035%,-71.14798:0.00017%,-64.19493:0.00017%,4.90362:0.00017%,-1.2708:0.00017%,-0.24151:0.00017%,13.431270000000001:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-68.36943000000001:0.00017%]
[INFO] ** scada_tag:[3:26.16556%,1:20.73011%,5:18.27817%,4:17.60957%,2:17.20997%,0:0.00662%]
[INFO] ** service:[0.0048200000000000005:99.99599%,-211.73542999999998:0.00314%,-211.08346:0.00017%,-201.23771000000002:0.00017%,-202.75898:0.00017%,-186.44547:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:37.94061%,9:26.16608%,7:18.27886%,1:17.61026%,14:0.00314%,2:0.00052%,15:0.00035%,10:0.00017%]
[INFO] ** type:[0:99.99913%,1:0.00087%]
[INFO] ** unixtime:1570 (0.27372%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0115 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.1889e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0095 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8249e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0084 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1141e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0077 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.8749e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2709 - tp: 72843.0000 - fp: 7157.0000 - tn: 312843.0000 - fn: 7157.0000 - accuracy: 0.9642 - precision: 0.9105 - recall: 0.9105 - auc: 0.9883 - val_loss: 0.5902 - val_tp: 12742.0000 - val_fp: 7258.0000 - val_tn: 72742.0000 - val_fn: 7258.0000 - val_accuracy: 0.8548 - val_precision: 0.6371 - val_recall: 0.6371 - val_auc: 0.9671
[INFO] saving weights to checkpoints/lstm-epoch-4-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 7-7/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99547%,30:0.00157%,22:0.00087%,17:0.0007%,26:0.00052%,31:0.00035%,28:0.00017%,27:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:80.31577%,Single Stage Single Point:19.68423%]
[INFO] ** dst:[21:43.36368%,10:20.73848%,8:18.25149%,9:17.64007%,15:0.00157%,22:0.00139%,6:0.00139%,16:0.0007%,24:0.00035%,18:0.00035%,17:0.00035%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.99843%,0:0.00157%]
[INFO] ** i/f_name:[2:99.99843%,3:0.00157%]
[INFO] ** modbus_function_code:[0.02961:99.99547%,-33.760870000000004:0.00453%]
[INFO] ** modbus_function_description:[7:49.99843%,11:49.99704%,0:0.00453%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99651%,2:0.00192%,1:0.00157%]
[INFO] ** proxy_src_ip:[18:37.96031%,20:26.14255%,13:18.25184%,6:17.64025%,17:0.00157%,11:0.0007%,1:0.0007%,21:0.00052%,16:0.00052%,14:0.00035%,7:0.00035%,10:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.14168%,-0.32151:20.73848%,-1.27613:18.25132%,-0.23351:17.6399%,-0.33484:17.22183%,-71.33197:0.00157%,-71.14931:0.00087%,-1.02014:0.00052%,-71.14798:0.00052%,1.45709:0.00052%,-0.24151:0.00035%,-1.27347:0.00035%,1.47576:0.00017%,1.46509:0.00017%,14.253910000000001:0.00017%,-1.2708:0.00017%,-58.035180000000004:0.00017%,-58.032509999999995:0.00017%,-68.79874000000001:0.00017%,-43.76509:0.00017%,2.05573:0.00017%,6.1115699999999995:0.00017%,-5.08665:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:26.14133%,1:20.73848%,5:18.25114%,4:17.63973%,2:17.22165%,0:0.00767%]
[INFO] ** service:[0.0048200000000000005:99.99547%,-211.73542999999998:0.00157%,-211.08818:0.00087%,-205.44247:0.0007%,-211.08346:0.00052%,-186.43601999999998:0.00035%,-211.09762999999998:0.00017%,-185.9872:0.00017%,-202.75898:0.00017%]
[INFO] ** src:[22:37.96031%,9:26.14255%,7:18.25184%,1:17.64025%,14:0.00157%,10:0.0007%,3:0.0007%,15:0.00052%,4:0.00052%,21:0.00035%,2:0.00035%,11:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1567 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0493 - tp: 78313.0000 - fp: 1687.0000 - tn: 318313.0000 - fn: 1687.0000 - accuracy: 0.9916 - precision: 0.9789 - recall: 0.9789 - auc: 0.9997 - val_loss: 0.0024 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0287 - tp: 79051.0000 - fp: 949.0000 - tn: 319051.0000 - fn: 949.0000 - accuracy: 0.9953 - precision: 0.9881 - recall: 0.9881 - auc: 0.9999 - val_loss: 2.8059e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0254 - tp: 79027.0000 - fp: 973.0000 - tn: 319027.0000 - fn: 973.0000 - accuracy: 0.9951 - precision: 0.9878 - recall: 0.9878 - auc: 0.9999 - val_loss: 1.0885e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2980 - tp: 74037.0000 - fp: 5963.0000 - tn: 314037.0000 - fn: 5963.0000 - accuracy: 0.9702 - precision: 0.9255 - recall: 0.9255 - auc: 0.9865 - val_loss: 0.0757 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0222 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0019 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 8-8/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99721%,30:0.00105%,0:0.00052%,24:0.00017%,23:0.00017%,22:0.00017%,18:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:95.01766%,Single Stage Single Point:4.98234%]
[INFO] ** dst:[21:43.4179%,10:20.80176%,8:18.19483%,9:17.58202%,22:0.00122%,15:0.00105%,25:0.00052%,19:0.00035%,26:0.00017%,24:0.00017%]
[INFO] ** i/f_dir:[1:99.9993%,0:0.0007%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.99721%,-33.760870000000004:0.00262%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99965%,11:49.99756%,0:0.00262%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99965%,2:0.00035%]
[INFO] ** proto:[0:99.99826%,1:0.00105%,2:0.0007%]
[INFO] ** proxy_src_ip:[18:38.08461%,20:26.13558%,13:18.19413%,6:17.58237%,17:0.00105%,10:0.00105%,16:0.00052%,14:0.00035%,11:0.00017%,5:0.00017%]
[INFO] ** s_port:[1.45442:26.13505%,-0.32151:20.80176%,-1.27613:18.19396%,-0.23351:17.58184%,-0.33484:17.28285%,-71.33197:0.00105%,-15.039579999999999:0.0007%,-1.02014:0.00052%,-64.19493:0.00052%,1.45709:0.00035%,-0.24151:0.00035%,4.66896:0.00035%,-1.27347:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,-71.14931:0.00017%]
[INFO] ** scada_tag:[3:26.13453%,1:20.80159%,5:18.19396%,4:17.58167%,2:17.28267%,0:0.00558%]
[INFO] ** service:[0.0048200000000000005:99.99791%,-211.73542999999998:0.00105%,-186.44547:0.00052%,-211.07873999999998:0.00035%,-211.08818:0.00017%]
[INFO] ** src:[22:38.08461%,9:26.13558%,7:18.19413%,1:17.58237%,11:0.00105%,14:0.0007%,15:0.00052%,21:0.00035%,2:0.00035%,16:0.00017%,10:0.00017%]
[INFO] ** type:[0:99.99948%,1:0.00035%,2:0.00017%]
[INFO] ** unixtime:1570 (0.27372%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0098 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.6242e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0074 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4767e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0059 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8351e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0049 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4970e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3613 - tp: 67908.0000 - fp: 12092.0000 - tn: 307908.0000 - fn: 12092.0000 - accuracy: 0.9395 - precision: 0.8489 - recall: 0.8489 - auc: 0.9805 - val_loss: 0.2632 - val_tp: 16384.0000 - val_fp: 3616.0000 - val_tn: 76384.0000 - val_fn: 3616.0000 - val_accuracy: 0.9277 - val_precision: 0.8192 - val_recall: 0.8192 - val_auc: 0.9842
[INFO] saving weights to checkpoints/lstm-epoch-4-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 9-9/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99826%,30:0.00105%,31:0.00035%,26:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:94.27636%,Single Stage Single Point:5.72364%]
[INFO] ** dst:[21:43.37362%,10:20.77387%,8:18.27782%,9:17.57191%,15:0.00105%,22:0.00087%,18:0.00035%,25:0.00017%,24:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99895%,0:0.00105%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.99826%,-33.760870000000004:0.00174%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99826%,0:0.00174%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99965%,2:0.00035%]
[INFO] ** proto:[0:99.99826%,1:0.00105%,2:0.0007%]
[INFO] ** proxy_src_ip:[18:38.01069%,20:26.13732%,13:18.27782%,6:17.57226%,17:0.00105%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.13662%,-0.32151:20.77387%,-1.27613:18.27747%,-0.23351:17.57173%,-0.33484:17.23682%,-71.33197:0.00105%,-0.24151:0.00035%,1.45709:0.00035%,-0.08551:0.00035%,1.46509:0.00017%,1.47576:0.00017%,-1.27347:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.13627%,1:20.77369%,5:18.27747%,4:17.57156%,2:17.23665%,0:0.00436%]
[INFO] ** service:[0.0048200000000000005:99.99826%,-211.73542999999998:0.00105%,-186.43601999999998:0.00035%,-211.08346:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.01069%,9:26.13732%,7:18.27782%,1:17.57226%,14:0.0007%,21:0.00035%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1570 (0.27372%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1118 - tp: 75699.0000 - fp: 4301.0000 - tn: 315699.0000 - fn: 4301.0000 - accuracy: 0.9785 - precision: 0.9462 - recall: 0.9462 - auc: 0.9982 - val_loss: 0.0164 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0330 - tp: 79385.0000 - fp: 615.0000 - tn: 319385.0000 - fn: 615.0000 - accuracy: 0.9969 - precision: 0.9923 - recall: 0.9923 - auc: 0.9994 - val_loss: 1.7659 - val_tp: 16355.0000 - val_fp: 3645.0000 - val_tn: 76355.0000 - val_fn: 3645.0000 - val_accuracy: 0.9271 - val_precision: 0.8177 - val_recall: 0.8177 - val_auc: 0.8865
[INFO] saving weights to checkpoints/lstm-epoch-4-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0485 - tp: 79574.0000 - fp: 426.0000 - tn: 319574.0000 - fn: 426.0000 - accuracy: 0.9979 - precision: 0.9947 - recall: 0.9947 - auc: 0.9978 - val_loss: 7.1483e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0073 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3155e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0057 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5775e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 10-10/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99634%,30:0.00174%,31:0.00035%,26:0.00017%,24:0.00017%,23:0.00017%,22:0.00017%,18:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:94.67403%,Single Stage Single Point:5.32597%]
[INFO] ** dst:[21:43.4118%,10:20.80769%,8:18.2222%,9:17.55447%,15:0.00174%,22:0.00052%,24:0.00035%,19:0.00035%,18:0.00035%,26:0.00017%,25:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99843%,0:0.00157%]
[INFO] ** i/f_name:[2:99.99826%,3:0.00174%]
[INFO] ** modbus_function_code:[0.02961:99.99634%,-33.760870000000004:0.00349%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99895%,11:49.99738%,0:0.00349%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.9993%,1:0.0007%]
[INFO] ** proto:[0:99.99738%,1:0.00174%,2:0.00087%]
[INFO] ** proxy_src_ip:[18:38.08426%,20:26.13575%,13:18.22238%,6:17.55378%,17:0.00174%,10:0.00087%,14:0.00035%,21:0.00017%,16:0.00017%,5:0.00017%,2:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.13505%,-0.32151:20.80769%,-1.27613:18.22185%,-0.23351:17.55343%,-0.33484:17.27657%,-71.33197:0.00174%,-10.51843:0.0007%,-0.08551:0.00035%,-1.27347:0.00035%,5.71692:0.00035%,1.47576:0.00035%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-71.14931:0.00017%,-64.19493:0.00017%,1.45709:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.1347%,1:20.80752%,5:18.22185%,4:17.55325%,2:17.2764%,0:0.00628%]
[INFO] ** service:[0.0048200000000000005:99.99704%,-211.73542999999998:0.00174%,-211.07873999999998:0.00035%,-186.43601999999998:0.00035%,-211.08346:0.00017%,-186.44547:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.08426%,9:26.13575%,7:18.22238%,1:17.55378%,14:0.00174%,11:0.00087%,2:0.00035%,17:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%]
[INFO] ** type:[0:99.99861%,1:0.00122%,2:0.00017%]
[INFO] ** unixtime:1567 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0046 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.0858e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0038 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.2147e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3840 - tp: 70464.0000 - fp: 9536.0000 - tn: 310464.0000 - fn: 9536.0000 - accuracy: 0.9523 - precision: 0.8808 - recall: 0.8808 - auc: 0.9797 - val_loss: 0.6222 - val_tp: 12813.0000 - val_fp: 7187.0000 - val_tn: 72813.0000 - val_fn: 7187.0000 - val_accuracy: 0.8563 - val_precision: 0.6406 - val_recall: 0.6406 - val_auc: 0.9677
[INFO] saving weights to checkpoints/lstm-epoch-4-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3041 - tp: 66174.0000 - fp: 13826.0000 - tn: 306174.0000 - fn: 13826.0000 - accuracy: 0.9309 - precision: 0.8272 - recall: 0.8272 - auc: 0.9835 - val_loss: 0.1496 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0561 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0026 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 11-11/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99895%,31:0.00035%,30:0.00035%,26:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.39314%,10:20.87411%,8:18.19344%,9:17.53704%,22:0.00122%,18:0.00035%,15:0.00035%,25:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99965%,0:0.00035%]
[INFO] ** i/f_name:[2:99.99965%,3:0.00035%]
[INFO] ** modbus_function_code:[0.02961:99.99895%,-33.760870000000004:0.00105%]
[INFO] ** modbus_function_description:[7:50.00052%,11:49.99843%,0:0.00105%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99895%,2:0.0007%,1:0.00035%]
[INFO] ** proxy_src_ip:[18:38.15069%,20:26.11692%,13:18.19344%,6:17.53739%,16:0.00052%,17:0.00035%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.1164%,-0.32151:20.87411%,-1.27613:18.19326%,-0.23351:17.53686%,-0.33484:17.27657%,-0.24151:0.00052%,-1.02014:0.00052%,-0.08551:0.00035%,-71.33197:0.00035%,-71.14798:0.00017%,1.45709:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:26.11605%,1:20.87394%,5:18.19309%,4:17.53652%,2:17.2764%,0:0.00401%]
[INFO] ** service:[0.0048200000000000005:99.99895%,-211.73542999999998:0.00035%,-186.43601999999998:0.00035%,-211.08346:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.15069%,9:26.11692%,7:18.19344%,1:17.53739%,15:0.00052%,14:0.00035%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1568 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0125 - tp: 79997.0000 - fp: 3.0000 - tn: 319997.0000 - fn: 3.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0012 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0099 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7251e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0083 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0527e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0074 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1558e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0068 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.1378e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 12-12/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99791%,30:0.00192%,9:0.00017%]
[INFO] ** classification:[normal:93.6904%,Single Stage Single Point:6.3096%]
[INFO] ** dst:[21:43.40657%,10:20.8851%,8:18.17635%,9:17.52902%,15:0.00192%,22:0.00052%,24:0.00035%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99843%,0:0.00157%]
[INFO] ** i/f_name:[2:99.99808%,3:0.00192%]
[INFO] ** modbus_function_code:[0.02961:99.99791%,-33.760870000000004:0.00209%]
[INFO] ** modbus_function_description:[7:49.99965%,11:49.99826%,0:0.00209%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99843%,2:0.00157%]
[INFO] ** proto:[0:99.99808%,1:0.00192%]
[INFO] ** proxy_src_ip:[18:38.15871%,20:26.13331%,13:18.17652%,6:17.52919%,17:0.00192%,16:0.00017%,1:0.00017%]
[INFO] ** s_port:[1.45442:26.13279%,-0.32151:20.8851%,-1.27613:18.176%,-0.23351:17.52884%,-0.33484:17.27361%,-71.33197:0.00192%,-1.27347:0.00035%,1.45709:0.00017%,-0.24950999999999998:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,14.4699:0.00017%]
[INFO] ** scada_tag:[3:26.13244%,1:20.8851%,5:18.176%,4:17.5285%,2:17.27361%,0:0.00436%]
[INFO] ** service:[0.0048200000000000005:99.99791%,-211.73542999999998:0.00192%,-183.8612:0.00017%]
[INFO] ** src:[22:38.15871%,9:26.13331%,7:18.17652%,1:17.52919%,21:0.00157%,14:0.00035%,15:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1568 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0061 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.4581e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0054 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2260e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2426 - tp: 74395.0000 - fp: 5605.0000 - tn: 314395.0000 - fn: 5605.0000 - accuracy: 0.9720 - precision: 0.9299 - recall: 0.9299 - auc: 0.9897 - val_loss: 0.6433 - val_tp: 12841.0000 - val_fp: 7159.0000 - val_tn: 72841.0000 - val_fn: 7159.0000 - val_accuracy: 0.8568 - val_precision: 0.6421 - val_recall: 0.6421 - val_auc: 0.9680
[INFO] saving weights to checkpoints/lstm-epoch-4-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3722 - tp: 56573.0000 - fp: 23427.0000 - tn: 296573.0000 - fn: 23427.0000 - accuracy: 0.8829 - precision: 0.7072 - recall: 0.7072 - auc: 0.9721 - val_loss: 0.2175 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1233 - tp: 79997.0000 - fp: 3.0000 - tn: 319997.0000 - fn: 3.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0049 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 13-13/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99651%,31:0.0007%,30:0.00052%,26:0.00052%,0:0.00052%,22:0.00035%,27:0.00017%,24:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:86.66059%,Single Stage Single Point:13.33941%]
[INFO] ** dst:[21:43.35653%,10:20.80368%,8:18.27695%,9:17.55883%,22:0.00105%,6:0.00087%,18:0.0007%,25:0.00052%,15:0.00052%,24:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.99965%,0:0.00035%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.99651%,-33.760870000000004:0.00331%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99878%,11:49.99773%,0:0.00331%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99721%,2:0.00227%,1:0.00052%]
[INFO] ** proxy_src_ip:[18:38.05027%,20:26.1103%,13:18.27712%,6:17.55831%,10:0.00105%,11:0.00087%,17:0.00052%,16:0.00052%,7:0.00035%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.10977%,-0.32151:20.80368%,-1.27613:18.27677%,-0.23351:17.55796%,-0.33484:17.24659%,-9.78512:0.0007%,-64.19493:0.00052%,-1.02014:0.00052%,-71.14798:0.00052%,-71.33197:0.00052%,-0.24151:0.00035%,-71.14931:0.00035%,-0.08551:0.00035%,1.47576:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-1.2708:0.00017%,-68.79874000000001:0.00017%,6.1115699999999995:0.00017%,14.540560000000001:0.00017%,1.45709:0.00017%]
[INFO] ** scada_tag:[3:26.10942%,1:20.80351%,5:18.27677%,4:17.55796%,2:17.24641%,0:0.00593%]
[INFO] ** service:[0.0048200000000000005:99.99721%,-186.43601999999998:0.0007%,-211.08346:0.00052%,-186.44547:0.00052%,-211.73542999999998:0.00052%,-211.08818:0.00035%,-202.75898:0.00017%]
[INFO] ** src:[22:38.05027%,9:26.1103%,7:18.27712%,1:17.55831%,11:0.00105%,10:0.00087%,15:0.00052%,14:0.00052%,21:0.00035%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99965%,2:0.00017%,1:0.00017%]
[INFO] ** unixtime:1567 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0152 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0126 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.5252e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0112 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.6032e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2876 - tp: 72504.0000 - fp: 7496.0000 - tn: 312504.0000 - fn: 7496.0000 - accuracy: 0.9625 - precision: 0.9063 - recall: 0.9063 - auc: 0.9871 - val_loss: 0.5033 - val_tp: 12841.0000 - val_fp: 7159.0000 - val_tn: 72841.0000 - val_fn: 7159.0000 - val_accuracy: 0.8568 - val_precision: 0.6421 - val_recall: 0.6421 - val_auc: 0.9680
[INFO] saving weights to checkpoints/lstm-epoch-4-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2089 - tp: 65165.0000 - fp: 14835.0000 - tn: 305165.0000 - fn: 14835.0000 - accuracy: 0.9258 - precision: 0.8146 - recall: 0.8146 - auc: 0.9902 - val_loss: 0.1335 - val_tp: 16494.0000 - val_fp: 3506.0000 - val_tn: 76494.0000 - val_fn: 3506.0000 - val_accuracy: 0.9299 - val_precision: 0.8247 - val_recall: 0.8247 - val_auc: 0.9923
[INFO] saving weights to checkpoints/lstm-epoch-4-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 14-14/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99895%,31:0.00035%,30:0.00035%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:92.37272%,Single Stage Single Point:7.62728%]
[INFO] ** dst:[21:43.35392%,10:20.80856%,8:18.26474%,9:17.57069%,22:0.0007%,24:0.00035%,18:0.00035%,15:0.00035%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99983%,0:0.00017%]
[INFO] ** i/f_name:[2:99.99965%,3:0.00035%]
[INFO] ** modbus_function_code:[0.02961:99.99895%,-33.760870000000004:0.00105%]
[INFO] ** modbus_function_description:[7:50.00035%,11:49.99861%,0:0.00105%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99913%,2:0.00052%,1:0.00035%]
[INFO] ** proxy_src_ip:[18:38.05253%,20:26.11047%,13:18.26492%,6:17.57086%,17:0.00035%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.10977%,-0.32151:20.80856%,-1.27613:18.26439%,-0.23351:17.57051%,-0.33484:17.24397%,-1.27347:0.00035%,-0.08551:0.00035%,-71.33197:0.00035%,1.45709:0.00035%,1.47576:0.00017%,1.46509:0.00017%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,-0.24950999999999998:0.00017%,14.4699:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.10942%,1:20.80856%,5:18.26422%,4:17.57016%,2:17.2438%,0:0.00384%]
[INFO] ** service:[0.0048200000000000005:99.99895%,-211.73542999999998:0.00035%,-186.43601999999998:0.00035%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.05253%,9:26.11047%,7:18.26492%,1:17.57086%,14:0.00035%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1567 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1335 - tp: 75704.0000 - fp: 4296.0000 - tn: 315704.0000 - fn: 4296.0000 - accuracy: 0.9785 - precision: 0.9463 - recall: 0.9463 - auc: 0.9981 - val_loss: 0.0913 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2980 - tp: 63723.0000 - fp: 16277.0000 - tn: 303723.0000 - fn: 16277.0000 - accuracy: 0.9186 - precision: 0.7965 - recall: 0.7965 - auc: 0.9778 - val_loss: 0.2102 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1661 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1169 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1005 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0776 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0696 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0558 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 15-15/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99634%,30:0.00296%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:90.3711%,Single Stage Multi Point:9.6282%,Single Stage Single Point:0.0007%]
[INFO] ** dst:[21:43.30528%,10:20.77666%,8:18.31112%,9:17.60172%,15:0.00296%,22:0.00157%,25:0.00017%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99721%,0:0.00279%]
[INFO] ** i/f_name:[2:99.99704%,3:0.00296%]
[INFO] ** modbus_function_code:[0.02961:99.99634%,-33.760870000000004:0.00366%]
[INFO] ** modbus_function_description:[7:49.99913%,11:49.99721%,0:0.00366%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99738%,2:0.00262%]
[INFO] ** proto:[0:99.99669%,1:0.00296%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.00999%,20:26.07264%,13:18.31077%,6:17.60224%,17:0.00296%,16:0.0007%,7:0.00035%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.07177%,-0.32151:20.77648%,-1.27613:18.31059%,-0.23351:17.60155%,-0.33484:17.23351%,-71.33197:0.00296%,-1.02014:0.0007%,-0.24151:0.00052%,1.46509:0.00035%,1.45709:0.00035%,1.47576:0.00017%,-1.27347:0.00017%,-0.24950999999999998:0.00017%,-61.95768:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.07142%,1:20.77631%,5:18.31059%,4:17.6012%,2:17.23316%,0:0.00732%]
[INFO] ** service:[0.0048200000000000005:99.99651%,-211.73542999999998:0.00296%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.00999%,9:26.07264%,7:18.31077%,1:17.60224%,21:0.00296%,15:0.0007%,14:0.00035%,16:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1576 (0.27476%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0468 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0393 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0262 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0185 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0187 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0071 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0074 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0013 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.3049 - tp: 68578.0000 - fp: 11422.0000 - tn: 308578.0000 - fn: 11422.0000 - accuracy: 0.9429 - precision: 0.8572 - recall: 0.8572 - auc: 0.9091 - val_loss: 7.5382 - val_tp: 10647.0000 - val_fp: 9353.0000 - val_tn: 70647.0000 - val_fn: 9353.0000 - val_accuracy: 0.8129 - val_precision: 0.5324 - val_recall: 0.5324 - val_auc: 0.7055
[INFO] saving weights to checkpoints/lstm-epoch-4-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 16-16/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513276, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513276, 17)

[INFO] analyzing data
[INFO] 513276 rows
[INFO] ** appi_name:[21:99.99805%,30:0.00175%,33:0.00019%]
[INFO] ** classification:[normal:79.94062%,Single Stage Multi Point:20.05938%]
[INFO] ** dst:[21:43.34276%,10:20.79486%,8:18.26152%,9:17.59774%,15:0.00175%,22:0.00117%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99825%,0:0.00175%]
[INFO] ** i/f_name:[2:99.99825%,3:0.00175%]
[INFO] ** modbus_function_code:[0.02961:99.99805%,-33.760870000000004:0.00195%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99805%,0:0.00195%]
[INFO] ** modbus_transaction_id:65536 (12.76818%)
[INFO] ** orig:[0:99.99825%,2:0.00175%]
[INFO] ** proto:[0:99.99825%,1:0.00175%]
[INFO] ** proxy_src_ip:[18:38.04035%,20:26.09746%,13:18.26191%,6:17.59794%,17:0.00175%,16:0.00039%,21:0.00019%]
[INFO] ** s_port:[1.45442:26.09688%,-0.32151:20.79466%,-1.27613:18.26152%,-0.23351:17.59755%,-0.33484:17.24569%,-71.33197:0.00175%,1.45709:0.00039%,-0.24151:0.00039%,-1.02014:0.00039%,-1.27347:0.00019%,1.47576:0.00019%,-49.275529999999996:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.09649%,1:20.79447%,5:18.26133%,4:17.59716%,2:17.2455%,0:0.00507%]
[INFO] ** service:[0.0048200000000000005:99.99825%,-211.73542999999998:0.00175%]
[INFO] ** src:[22:38.04035%,9:26.09746%,7:18.26191%,1:17.59794%,21:0.00175%,15:0.00039%,4:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1406 (0.27393%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5518 - tp: 42526.0000 - fp: 37474.0000 - tn: 282526.0000 - fn: 37474.0000 - accuracy: 0.8126 - precision: 0.5316 - recall: 0.5316 - auc: 0.7043 - val_loss: 7.5814 - val_tp: 10593.0000 - val_fp: 9407.0000 - val_tn: 70593.0000 - val_fn: 9407.0000 - val_accuracy: 0.8119 - val_precision: 0.5296 - val_recall: 0.5296 - val_auc: 0.7040
[INFO] saving weights to checkpoints/lstm-epoch-4-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5478 - tp: 42546.0000 - fp: 37454.0000 - tn: 282546.0000 - fn: 37454.0000 - accuracy: 0.8127 - precision: 0.5318 - recall: 0.5318 - auc: 0.7041 - val_loss: 7.5465 - val_tp: 10636.0000 - val_fp: 9364.0000 - val_tn: 70636.0000 - val_fn: 9364.0000 - val_accuracy: 0.8127 - val_precision: 0.5318 - val_recall: 0.5318 - val_auc: 0.7074
[INFO] saving weights to checkpoints/lstm-epoch-4-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.8683 - tp: 70739.0000 - fp: 9261.0000 - tn: 310739.0000 - fn: 9261.0000 - accuracy: 0.9537 - precision: 0.8842 - recall: 0.8842 - auc: 0.9270 - val_loss: 6.4400e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0025 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6706e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0024 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3177e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-15-16-batch-400000-500000
[INFO] processing batch 500000-600000/513276
[33m[INFO] loading file 17-17/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513276, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513276, 17)

[INFO] analyzing data
[INFO] 513276 rows
[INFO] ** appi_name:[21:99.99708%,7:0.00058%,26:0.00039%,0:0.00039%,31:0.00019%,27:0.00019%,24:0.00019%,22:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:93.98959%,Multi Stage Multi Point:6.01041%]
[INFO] ** dst:[21:43.34802%,10:20.85038%,8:18.2019%,9:17.59658%,22:0.00078%,6:0.00058%,25:0.00039%,16:0.00039%,2:0.00039%,24:0.00019%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99708%,-33.760870000000004:0.00273%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99961%,11:49.99747%,0:0.00273%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.76818%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99864%,2:0.00136%]
[INFO] ** proxy_src_ip:[18:38.08633%,20:26.11285%,13:18.20132%,6:17.59638%,10:0.00117%,11:0.00097%,1:0.00039%,16:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.11188%,-0.32151:20.85038%,-1.27613:18.20093%,-0.23351:17.59619%,-0.33484:17.23595%,6.0369:0.00078%,-64.19493:0.00039%,1.47576:0.00039%,-71.14798:0.00039%,1.45709:0.00039%,-3.3787199999999995:0.00019%,-68.79874000000001:0.00019%,-1.27347:0.00019%,1.46509:0.00019%,8.55414:0.00019%,6.06224:0.00019%,-4.3880099999999995:0.00019%,-0.24151:0.00019%,-71.14931:0.00019%,-1.02014:0.00019%,6.15557:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.11168%,1:20.85019%,5:18.20073%,4:17.5958%,2:17.23595%,0:0.00565%]
[INFO] ** service:[0.0048200000000000005:99.99786%,-211.09762999999998:0.00058%,-186.44547:0.00039%,-211.08346:0.00039%,-186.43601999999998:0.00019%,-211.35747999999998:0.00019%,-211.08818:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.08633%,9:26.11285%,7:18.20132%,1:17.59638%,11:0.00117%,10:0.00097%,3:0.00039%,21:0.00019%,15:0.00019%,2:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1403 (0.27334%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0023 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2394e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0021 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2202e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0021 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2975 - val_tp: 18390.0000 - val_fp: 1610.0000 - val_tn: 78390.0000 - val_fn: 1610.0000 - val_accuracy: 0.9678 - val_precision: 0.9195 - val_recall: 0.9195 - val_auc: 0.9497
[INFO] saving weights to checkpoints/lstm-epoch-4-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9383 - tp: 65424.0000 - fp: 14576.0000 - tn: 305424.0000 - fn: 14576.0000 - accuracy: 0.9271 - precision: 0.8178 - recall: 0.8178 - auc: 0.8854 - val_loss: 2.8996 - val_tp: 16402.0000 - val_fp: 3598.0000 - val_tn: 76402.0000 - val_fn: 3598.0000 - val_accuracy: 0.9280 - val_precision: 0.8201 - val_recall: 0.8201 - val_auc: 0.8876
[INFO] saving weights to checkpoints/lstm-epoch-4-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.2311 - tp: 68934.0000 - fp: 11066.0000 - tn: 308934.0000 - fn: 11066.0000 - accuracy: 0.9447 - precision: 0.8617 - recall: 0.8617 - auc: 0.9130 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/513276
[33m[INFO] loading file 18-18/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513276, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513276, 17)

[INFO] analyzing data
[INFO] 513276 rows
[INFO] ** appi_name:[21:99.99805%,30:0.00058%,7:0.00058%,31:0.00019%,27:0.00019%,22:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:81.10218%,Multi Stage Multi Point:18.89782%]
[INFO] ** dst:[21:43.34413%,10:20.82661%,8:18.26678%,9:17.55936%,22:0.00078%,15:0.00058%,24:0.00039%,16:0.00039%,2:0.00039%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99942%,0:0.00058%]
[INFO] ** i/f_name:[2:99.99942%,3:0.00058%]
[INFO] ** modbus_function_code:[0.02961:99.99805%,-33.760870000000004:0.00195%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99786%,0:0.00195%]
[INFO] ** modbus_transaction_id:65536 (12.76818%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99883%,2:0.00058%,1:0.00058%]
[INFO] ** proxy_src_ip:[18:38.0686%,20:26.10272%,13:18.26717%,6:17.55956%,17:0.00058%,11:0.00058%,1:0.00039%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.10194%,-0.32151:20.82661%,-1.27613:18.26659%,-0.23351:17.55917%,-0.33484:17.24199%,-71.33197:0.00058%,1.45709:0.00039%,-0.24151:0.00039%,-1.27347:0.00039%,-1.2708:0.00019%,-71.14931:0.00019%,6.45955:0.00019%,-2.48275:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-3.3787199999999995:0.00019%,3.6236699999999997:0.00019%,6.06224:0.00019%,8.10082:0.00019%]
[INFO] ** scada_tag:[3:26.10155%,1:20.82642%,5:18.26639%,4:17.55897%,2:17.2418%,0:0.00487%]
[INFO] ** service:[0.0048200000000000005:99.99805%,-211.09762999999998:0.00058%,-211.73542999999998:0.00058%,-186.43601999999998:0.00019%,-211.35747999999998:0.00019%,-211.08818:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.0686%,9:26.10272%,7:18.26717%,1:17.55956%,14:0.00058%,10:0.00058%,3:0.00039%,21:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1403 (0.27334%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.6159 - tp: 62060.0000 - fp: 17940.0000 - tn: 302060.0000 - fn: 17940.0000 - accuracy: 0.9103 - precision: 0.7757 - recall: 0.7757 - auc: 0.8590 - val_loss: 6.1023 - val_tp: 12428.0000 - val_fp: 7572.0000 - val_tn: 72428.0000 - val_fn: 7572.0000 - val_accuracy: 0.8486 - val_precision: 0.6214 - val_recall: 0.6214 - val_auc: 0.7634
[INFO] saving weights to checkpoints/lstm-epoch-4-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1245 - tp: 49607.0000 - fp: 30393.0000 - tn: 289607.0000 - fn: 30393.0000 - accuracy: 0.8480 - precision: 0.6201 - recall: 0.6201 - auc: 0.7610 - val_loss: 6.1587 - val_tp: 12358.0000 - val_fp: 7642.0000 - val_tn: 72358.0000 - val_fn: 7642.0000 - val_accuracy: 0.8472 - val_precision: 0.6179 - val_recall: 0.6179 - val_auc: 0.7612
[INFO] saving weights to checkpoints/lstm-epoch-4-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1271 - tp: 49594.0000 - fp: 30406.0000 - tn: 289594.0000 - fn: 30406.0000 - accuracy: 0.8480 - precision: 0.6199 - recall: 0.6199 - auc: 0.7610 - val_loss: 2.4540 - val_tp: 16955.0000 - val_fp: 3045.0000 - val_tn: 76955.0000 - val_fn: 3045.0000 - val_accuracy: 0.9391 - val_precision: 0.8478 - val_recall: 0.8478 - val_auc: 0.9048
[INFO] saving weights to checkpoints/lstm-epoch-4-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0015 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0014 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/513276
[33m[INFO] loading file 19-19/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513276, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513276, 17)

[INFO] analyzing data
[INFO] 513276 rows
[INFO] ** appi_name:[21:99.99786%,26:0.00039%,0:0.00039%,31:0.00019%,27:0.00019%,24:0.00019%,22:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:86.05818%,Single Stage Multi Point:13.94182%]
[INFO] ** dst:[21:43.38075%,10:20.82895%,8:18.21437%,9:17.573%,22:0.00136%,6:0.00058%,25:0.00039%,24:0.00019%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99786%,-33.760870000000004:0.00195%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99786%,0:0.00195%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.76818%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99864%,2:0.00136%]
[INFO] ** proxy_src_ip:[18:38.11828%,20:26.09142%,13:18.21457%,6:17.573%,10:0.00117%,11:0.00097%,16:0.00058%]
[INFO] ** s_port:[1.45442:26.09045%,-0.32151:20.82895%,-1.27613:18.21418%,-0.23351:17.57281%,-0.33484:17.28933%,-5.20264:0.00078%,1.45709:0.00058%,-1.02014:0.00058%,-64.19493:0.00039%,-71.14798:0.00039%,-1.27347:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-71.14931:0.00019%,1.46509:0.00019%,-68.79874000000001:0.00019%,-1.2708:0.00019%,0.75578:0.00019%]
[INFO] ** scada_tag:[3:26.09006%,1:20.82875%,5:18.21398%,4:17.57261%,2:17.28933%,0:0.00526%]
[INFO] ** service:[0.0048200000000000005:99.99864%,-186.44547:0.00039%,-211.08346:0.00039%,-186.43601999999998:0.00019%,-211.08818:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.11828%,9:26.09142%,7:18.21457%,1:17.573%,11:0.00117%,10:0.00097%,15:0.00058%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1404 (0.27354%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0013 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0012 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0011 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.3831 - tp: 53285.0000 - fp: 26715.0000 - tn: 293285.0000 - fn: 26715.0000 - accuracy: 0.8664 - precision: 0.6661 - recall: 0.6661 - auc: 0.7900 - val_loss: 9.8530 - val_tp: 7774.0000 - val_fp: 12226.0000 - val_tn: 67774.0000 - val_fn: 12226.0000 - val_accuracy: 0.7555 - val_precision: 0.3887 - val_recall: 0.3887 - val_auc: 0.6179
[INFO] saving weights to checkpoints/lstm-epoch-4-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.5725 - tp: 47381.0000 - fp: 32619.0000 - tn: 287381.0000 - fn: 32619.0000 - accuracy: 0.8369 - precision: 0.5923 - recall: 0.5923 - auc: 0.7436 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/513276
[33m[INFO] loading file 20-20/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513276, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513276, 17)

[INFO] analyzing data
[INFO] 513276 rows
[INFO] ** appi_name:[21:99.9963%,30:0.00312%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:92.01619%,Single Stage Multi Point:7.98381%]
[INFO] ** dst:[21:43.42245%,10:20.8385%,8:18.16528%,9:17.56852%,15:0.00312%,22:0.00117%,24:0.00039%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99727%,0:0.00273%]
[INFO] ** i/f_name:[2:99.99688%,3:0.00312%]
[INFO] ** modbus_function_code:[0.02961:99.9963%,-33.760870000000004:0.0037%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99649%,0:0.0037%]
[INFO] ** modbus_transaction_id:65536 (12.76818%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9963%,1:0.00312%,2:0.00058%]
[INFO] ** proxy_src_ip:[18:38.1175%,20:26.14402%,13:18.16547%,6:17.56911%,17:0.00312%,14:0.00058%,16:0.00019%]
[INFO] ** s_port:[1.45442:26.14324%,-0.32151:20.8385%,-1.27613:18.16489%,-0.23351:17.56833%,-0.33484:17.27901%,-71.33197:0.00312%,-0.24151:0.00058%,1.45709:0.00039%,-1.27347:0.00039%,-1.2708:0.00019%,-1.02014:0.00019%,13.431270000000001:0.00019%,-71.14798:0.00019%,1.47576:0.00019%,-0.24950999999999998:0.00019%,11.862:0.00019%,1.46509:0.00019%]
[INFO] ** scada_tag:[3:26.14285%,1:20.8383%,5:18.16489%,4:17.56794%,2:17.27881%,0:0.00721%]
[INFO] ** service:[0.0048200000000000005:99.9963%,-211.73542999999998:0.00312%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.1175%,9:26.14402%,7:18.16547%,1:17.56911%,14:0.00312%,2:0.00058%,15:0.00019%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1403 (0.27334%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3363 - tp: 78335.0000 - fp: 1665.0000 - tn: 318335.0000 - fn: 1665.0000 - accuracy: 0.9917 - precision: 0.9792 - recall: 0.9792 - auc: 0.9869 - val_loss: 2.9262 - val_tp: 16369.0000 - val_fp: 3631.0000 - val_tn: 76369.0000 - val_fn: 3631.0000 - val_accuracy: 0.9274 - val_precision: 0.8184 - val_recall: 0.8184 - val_auc: 0.8865
[INFO] saving weights to checkpoints/lstm-epoch-4-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9430 - tp: 65396.0000 - fp: 14604.0000 - tn: 305396.0000 - fn: 14604.0000 - accuracy: 0.9270 - precision: 0.8174 - recall: 0.8174 - auc: 0.8852 - val_loss: 2.9609 - val_tp: 16326.0000 - val_fp: 3674.0000 - val_tn: 76326.0000 - val_fn: 3674.0000 - val_accuracy: 0.9265 - val_precision: 0.8163 - val_recall: 0.8163 - val_auc: 0.8852
[INFO] saving weights to checkpoints/lstm-epoch-4-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9430 - tp: 65396.0000 - fp: 14604.0000 - tn: 305396.0000 - fn: 14604.0000 - accuracy: 0.9270 - precision: 0.8174 - recall: 0.8174 - auc: 0.8852 - val_loss: 2.2573 - val_tp: 17199.0000 - val_fp: 2801.0000 - val_tn: 77199.0000 - val_fn: 2801.0000 - val_accuracy: 0.9440 - val_precision: 0.8600 - val_recall: 0.8600 - val_auc: 0.9125
[INFO] saving weights to checkpoints/lstm-epoch-4-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.7303e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7722e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/513276
[33m[INFO] loading file 21-21/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513274, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513274, 17)

[INFO] analyzing data
[INFO] 513274 rows
[INFO] ** appi_name:[21:99.9961%,30:0.00078%,7:0.00058%,26:0.00039%,22:0.00039%,0:0.00039%,31:0.00019%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:98.81097%,Multi Stage Single Point:1.18903%]
[INFO] ** dst:[21:43.30767%,10:20.99892%,8:18.16301%,9:17.52592%,22:0.00097%,15:0.00078%,6:0.00078%,25:0.00039%,24:0.00039%,16:0.00039%,2:0.00039%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name:[2:99.99922%,3:0.00078%]
[INFO] ** modbus_function_code:[0.02961:99.9961%,-33.760870000000004:0.0037%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99883%,11:49.99727%,0:0.0037%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.76823%)
[INFO] ** orig:[0:99.99922%,2:0.00078%]
[INFO] ** proto:[0:99.99766%,2:0.00156%,1:0.00078%]
[INFO] ** proxy_src_ip:[18:38.33352%,20:25.97287%,13:18.1632%,6:17.52592%,10:0.00117%,11:0.00097%,17:0.00078%,16:0.00058%,1:0.00039%,21:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.97229%,-0.32151:20.99814%,-1.27613:18.16281%,-0.23351:17.52573%,-0.33484:17.33538%,-6.64392:0.00078%,-71.33197:0.00078%,-1.02014:0.00058%,-1.27347:0.00039%,-71.14931:0.00039%,-71.14798:0.00039%,-64.19493:0.00039%,1.45709:0.00019%,-2.2440900000000004:0.00019%,-3.3787199999999995:0.00019%,-68.79874000000001:0.00019%,10.15141:0.00019%,1.46509:0.00019%,1.47576:0.00019%,7.060860000000001:0.00019%,-0.24151:0.00019%,6.62488:0.00019%]
[INFO] ** scada_tag:[3:25.9719%,1:20.99795%,5:18.16262%,4:17.52553%,2:17.33538%,0:0.00662%]
[INFO] ** service:[0.0048200000000000005:99.99688%,-211.73542999999998:0.00078%,-211.09762999999998:0.00058%,-186.44547:0.00039%,-211.08346:0.00039%,-211.08818:0.00039%,-186.43601999999998:0.00019%,-211.35747999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.33352%,9:25.97287%,7:18.1632%,1:17.52592%,11:0.00117%,21:0.00097%,10:0.00097%,15:0.00058%,3:0.00039%,4:0.00019%,2:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1398 (0.27237%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513274
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.1463e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/513274
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.5425e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/513274
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.1127e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/513274
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.7684e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/513274
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.2713e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/513274
[33m[INFO] loading file 22-22/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (282315, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (282315, 17)

[INFO] analyzing data
[INFO] 282315 rows
[INFO] ** appi_name:[21:99.99221%,30:0.00673%,23:0.00035%,22:0.00035%,18:0.00035%]
[INFO] ** classification:[normal:53.04819%,Multi Stage Single Point:46.95181%]
[INFO] ** dst:[21:43.30907%,10:21.00703%,8:18.10177%,9:17.57292%,15:0.00673%,22:0.00142%,19:0.00071%,26:0.00035%]
[INFO] ** i/f_dir:[1:99.99362%,0:0.00638%]
[INFO] ** i/f_name:[2:99.99327%,3:0.00638%,0:0.00035%]
[INFO] ** modbus_function_code:[0.02961:99.99221%,-33.760870000000004:0.00779%]
[INFO] ** modbus_function_description:[7:49.99699%,11:49.99522%,0:0.00779%]
[INFO] ** modbus_transaction_id:65534 (23.21308%)
[INFO] ** orig:[0:99.99504%,2:0.00425%,1:0.00071%]
[INFO] ** proto:[0:99.99292%,1:0.00673%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.33023%,20:25.98693%,13:18.10106%,6:17.57399%,17:0.00673%,14:0.00071%,10:0.00035%]
[INFO] ** s_port:[1.45442:25.98587%,-0.32151:21.00703%,-1.27613:18.10106%,-0.23351:17.57292%,-0.33484:17.3232%,-71.33197:0.00673%,1.45709:0.00071%,-0.24151:0.00071%,7.228860000000001:0.00071%,-0.24950999999999998:0.00035%,1.46509:0.00035%,-71.14931:0.00035%]
[INFO] ** scada_tag:[3:25.98551%,1:21.00703%,5:18.10106%,4:17.57257%,2:17.3232%,0:0.01063%]
[INFO] ** service:[0.0048200000000000005:99.99221%,-211.73542999999998:0.00673%,-211.07873999999998:0.00071%,-211.08818:0.00035%]
[INFO] ** src:[22:38.33023%,9:25.98693%,7:18.10106%,1:17.57399%,21:0.00425%,14:0.00248%,2:0.00071%,11:0.00035%]
[INFO] ** type:[0:99.99787%,1:0.00213%]
[INFO] ** unixtime:779 (0.27593%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/282315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5356 - tp: 42599.0000 - fp: 37401.0000 - tn: 282599.0000 - fn: 37401.0000 - accuracy: 0.8130 - precision: 0.5325 - recall: 0.5325 - auc: 0.7059 - val_loss: 7.5763 - val_tp: 10599.0000 - val_fp: 9401.0000 - val_tn: 70599.0000 - val_fn: 9401.0000 - val_accuracy: 0.8120 - val_precision: 0.5300 - val_recall: 0.5300 - val_auc: 0.7062
[INFO] saving weights to checkpoints/lstm-epoch-4-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/282315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5912 - tp: 42323.0000 - fp: 37677.0000 - tn: 282323.0000 - fn: 37677.0000 - accuracy: 0.8116 - precision: 0.5290 - recall: 0.5290 - auc: 0.7037 - val_loss: 7.5997 - val_tp: 10570.0000 - val_fp: 9430.0000 - val_tn: 70570.0000 - val_fn: 9430.0000 - val_accuracy: 0.8114 - val_precision: 0.5285 - val_recall: 0.5285 - val_auc: 0.7053
[INFO] saving weights to checkpoints/lstm-epoch-4-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/282315
[33m[INFO] loading file 23-23/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582315, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582315, 17)

[INFO] analyzing data
[INFO] 582315 rows
[INFO] ** appi_name:[21:99.99828%,30:0.00103%,31:0.00034%,33:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:91.81234%,Multi Stage Single Point:8.18766%]
[INFO] ** dst:[21:43.32397%,10:20.99809%,8:18.14053%,9:17.5345%,22:0.00103%,15:0.00103%,24:0.00034%,18:0.00034%,25:0.00017%]
[INFO] ** i/f_dir:[1:99.99897%,0:0.00103%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.99828%,-33.760870000000004:0.00172%]
[INFO] ** modbus_function_description:[7:50.00009%,11:49.9982%,0:0.00172%]
[INFO] ** modbus_transaction_id:65536 (11.25439%)
[INFO] ** orig:[0:99.99948%,2:0.00052%]
[INFO] ** proto:[0:99.99845%,1:0.00103%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.33561%,20:25.98697%,13:18.14053%,6:17.53467%,17:0.00103%,16:0.00052%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.98611%,-0.32151:20.99791%,-1.27613:18.14001%,-0.23351:17.53432%,-0.33484:17.3377%,-71.33197:0.00103%,-1.02014:0.00052%,-0.08551:0.00034%,-1.27347:0.00034%,1.45709:0.00034%,1.46509:0.00034%,-0.24151:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:25.98576%,1:20.99791%,5:18.13984%,4:17.53415%,2:17.33752%,0:0.00481%]
[INFO] ** service:[0.0048200000000000005:99.99845%,-211.73542999999998:0.00103%,-186.43601999999998:0.00034%,-186.44547:0.00017%]
[INFO] ** src:[22:38.33561%,9:25.98697%,7:18.14053%,1:17.53467%,21:0.00052%,15:0.00052%,14:0.00052%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1586 (0.27236%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5672 - tp: 42442.0000 - fp: 37558.0000 - tn: 282442.0000 - fn: 37558.0000 - accuracy: 0.8122 - precision: 0.5305 - recall: 0.5305 - auc: 0.7048 - val_loss: 7.5747 - val_tp: 10601.0000 - val_fp: 9399.0000 - val_tn: 70601.0000 - val_fn: 9399.0000 - val_accuracy: 0.8120 - val_precision: 0.5300 - val_recall: 0.5300 - val_auc: 0.7063
[INFO] saving weights to checkpoints/lstm-epoch-4-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1455 - tp: 79279.0000 - fp: 721.0000 - tn: 319279.0000 - fn: 721.0000 - accuracy: 0.9964 - precision: 0.9910 - recall: 0.9910 - auc: 0.9943 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.0529e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.7726e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.5356e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/582315
[33m[INFO] loading file 24-24/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582315, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582315, 17)

[INFO] analyzing data
[INFO] 582315 rows
[INFO] ** appi_name:[21:99.99365%,30:0.00309%,26:0.00052%,31:0.00034%,27:0.00034%,22:0.00034%,0:0.00034%,24:0.00017%,23:0.00017%,19:0.00017%,18:0.00017%,16:0.00017%,15:0.00017%,11:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:95.62436%,Multi Stage Single Point:4.37564%]
[INFO] ** dst:[21:43.36897%,10:21.0089%,8:18.1%,9:17.51526%,15:0.00309%,22:0.0012%,6:0.00069%,25:0.00034%,24:0.00034%,19:0.00034%,18:0.00034%,7:0.00034%,26:0.00017%]
[INFO] ** i/f_dir:[1:99.99708%,0:0.00292%]
[INFO] ** i/f_name:[2:99.99691%,3:0.00309%]
[INFO] ** modbus_function_code:[0.02961:99.99365%,-33.760870000000004:0.00584%,-0.415:0.00017%,0.9188299999999999:0.00017%,0.47422:0.00017%]
[INFO] ** modbus_function_description:[7:49.9982%,11:49.99545%,0:0.00584%,15:0.00017%,10:0.00017%,2:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.25439%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.99502%,1:0.00309%,2:0.00189%]
[INFO] ** proxy_src_ip:[18:38.38575%,20:25.99315%,13:18.09983%,6:17.51458%,17:0.00309%,10:0.0012%,14:0.00086%,11:0.00086%,21:0.00034%,16:0.00034%]
[INFO] ** s_port:[1.45442:25.99212%,-0.32151:21.0089%,-1.27613:18.09948%,-0.23351:17.51389%,-0.33484:17.37685%,-71.33197:0.00309%,-9.58113:0.00069%,-71.14798:0.00052%,1.45709:0.00052%,-0.24950999999999998:0.00034%,-1.27347:0.00034%,-0.24151:0.00034%,-1.02014:0.00034%,-31.55091:0.00034%,7.6315100000000005:0.00034%,-71.14931:0.00034%,-64.19493:0.00034%,1.47576:0.00034%,-68.79874000000001:0.00017%,1.46509:0.00017%,7.4901800000000005:0.00017%,13.431270000000001:0.00017%,11.862:0.00017%]
[INFO] ** scada_tag:[3:25.99195%,1:21.0089%,5:18.09931%,4:17.51355%,2:17.37668%,0:0.00962%]
[INFO] ** service:[0.0048200000000000005:99.99468%,-211.73542999999998:0.00309%,-211.08346:0.00052%,-211.07873999999998:0.00034%,-202.75898:0.00034%,-186.44547:0.00034%,-186.43601999999998:0.00034%,-211.08818:0.00034%]
[INFO] ** src:[22:38.38575%,9:25.99315%,7:18.09983%,1:17.51458%,14:0.00309%,11:0.0012%,10:0.00086%,2:0.00086%,15:0.00034%,4:0.00034%]
[INFO] ** type:[0:99.9988%,1:0.00086%,2:0.00034%]
[INFO] ** unixtime:1582 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.3665e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2572e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.1018e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.1860e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.2509e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/582315
[33m[INFO] loading file 25-25/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582315, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582315, 17)

[INFO] analyzing data
[INFO] 582315 rows
[INFO] ** appi_name:[21:99.99657%,30:0.00103%,17:0.00069%,22:0.00052%,31:0.00034%,28:0.00017%,26:0.00017%,12:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** classification:[normal:65.00021%,Multi Stage Single Point:34.99979%]
[INFO] ** dst:[21:43.32535%,10:21.02968%,8:18.12696%,9:17.51389%,15:0.00103%,22:0.00086%,16:0.00069%,6:0.00069%,18:0.00034%,17:0.00034%,24:0.00017%]
[INFO] ** i/f_dir:[1:99.99897%,0:0.00103%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.99657%,-33.760870000000004:0.00343%]
[INFO] ** modbus_function_description:[7:49.99906%,11:49.99751%,0:0.00343%]
[INFO] ** modbus_transaction_id:65536 (11.25439%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99794%,2:0.00103%,1:0.00103%]
[INFO] ** proxy_src_ip:[18:38.39674%,20:25.95829%,13:18.12696%,6:17.51423%,17:0.00103%,1:0.00086%,21:0.00069%,16:0.00034%,14:0.00034%,7:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95777%,-0.32151:21.02934%,-1.27613:18.12662%,-0.23351:17.51372%,-0.33484:17.3674%,-71.33197:0.00103%,-71.14931:0.00052%,-49.275529999999996:0.00034%,-0.24151:0.00034%,-1.02014:0.00034%,-58.032509999999995:0.00017%,-5.08665:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,2.52505:0.00017%,-71.14798:0.00017%,-58.035180000000004:0.00017%,-1.2708:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.95743%,1:21.02917%,5:18.12644%,4:17.51355%,2:17.36723%,0:0.00618%]
[INFO] ** service:[0.0048200000000000005:99.99691%,-211.73542999999998:0.00103%,-205.44247:0.00069%,-211.08818:0.00052%,-186.43601999999998:0.00034%,-211.09762999999998:0.00017%,-211.08346:0.00017%,-185.9872:0.00017%]
[INFO] ** src:[22:38.39674%,9:25.95829%,7:18.12696%,1:17.51423%,14:0.00103%,3:0.00086%,4:0.00069%,21:0.00034%,15:0.00034%,2:0.00034%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1582 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.9697 - tp: 55334.0000 - fp: 24666.0000 - tn: 295334.0000 - fn: 24666.0000 - accuracy: 0.8767 - precision: 0.6917 - recall: 0.6917 - auc: 0.8073 - val_loss: 5.7582 - val_tp: 12855.0000 - val_fp: 7145.0000 - val_tn: 72855.0000 - val_fn: 7145.0000 - val_accuracy: 0.8571 - val_precision: 0.6428 - val_recall: 0.6428 - val_auc: 0.7767
[INFO] saving weights to checkpoints/lstm-epoch-4-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7524 - tp: 51449.0000 - fp: 28551.0000 - tn: 291449.0000 - fn: 28551.0000 - accuracy: 0.8572 - precision: 0.6431 - recall: 0.6431 - auc: 0.7769 - val_loss: 5.7445 - val_tp: 12872.0000 - val_fp: 7128.0000 - val_tn: 72872.0000 - val_fn: 7128.0000 - val_accuracy: 0.8574 - val_precision: 0.6436 - val_recall: 0.6436 - val_auc: 0.7772
[INFO] saving weights to checkpoints/lstm-epoch-4-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7492 - tp: 51465.0000 - fp: 28535.0000 - tn: 291465.0000 - fn: 28535.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.7771 - val_loss: 5.7453 - val_tp: 12871.0000 - val_fp: 7129.0000 - val_tn: 72871.0000 - val_fn: 7129.0000 - val_accuracy: 0.8574 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.7772
[INFO] saving weights to checkpoints/lstm-epoch-4-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7463 - tp: 51479.0000 - fp: 28521.0000 - tn: 291479.0000 - fn: 28521.0000 - accuracy: 0.8574 - precision: 0.6435 - recall: 0.6435 - auc: 0.7772 - val_loss: 5.7276 - val_tp: 12893.0000 - val_fp: 7107.0000 - val_tn: 72893.0000 - val_fn: 7107.0000 - val_accuracy: 0.8579 - val_precision: 0.6446 - val_recall: 0.6446 - val_auc: 0.7779
[INFO] saving weights to checkpoints/lstm-epoch-4-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7570 - tp: 51426.0000 - fp: 28574.0000 - tn: 291426.0000 - fn: 28574.0000 - accuracy: 0.8571 - precision: 0.6428 - recall: 0.6428 - auc: 0.7768 - val_loss: 5.7630 - val_tp: 12849.0000 - val_fp: 7151.0000 - val_tn: 72849.0000 - val_fn: 7151.0000 - val_accuracy: 0.8570 - val_precision: 0.6424 - val_recall: 0.6424 - val_auc: 0.7765
[INFO] saving weights to checkpoints/lstm-epoch-4-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/582315
[33m[INFO] loading file 26-26/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582315, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582315, 17)

[INFO] analyzing data
[INFO] 582315 rows
[INFO] ** appi_name:[21:99.99828%,30:0.00052%,7:0.00052%,31:0.00017%,22:0.00017%,12:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:64.40191%,Single Stage Single Point:27.42708%,Multi Stage Single Point:8.17101%]
[INFO] ** dst:[21:43.30938%,10:21.09013%,8:18.11923%,9:17.47851%,22:0.00086%,15:0.00052%,24:0.00034%,16:0.00034%,2:0.00034%,18:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99948%,0:0.00052%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.99828%,-33.760870000000004:0.00172%]
[INFO] ** modbus_function_description:[7:49.99974%,11:49.99854%,0:0.00172%]
[INFO] ** modbus_transaction_id:65536 (11.25439%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99914%,1:0.00052%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.4699%,20:25.92978%,13:18.11957%,6:17.47868%,17:0.00052%,1:0.00052%,21:0.00034%,16:0.00034%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.92927%,-0.32151:21.08996%,-1.27613:18.11906%,-0.23351:17.47834%,-0.33484:17.37994%,-71.33197:0.00052%,-1.02014:0.00034%,-1.27347:0.00034%,-0.24151:0.00034%,-49.275529999999996:0.00017%,1.47576:0.00017%,1.45709:0.00017%,1.46509:0.00017%,-1.2708:0.00017%,14.191239999999999:0.00017%,2.52505:0.00017%,-3.3787199999999995:0.00017%,11.57001:0.00017%,-71.14931:0.00017%,7.66617:0.00017%]
[INFO] ** scada_tag:[3:25.92892%,1:21.08996%,5:18.11889%,4:17.47817%,2:17.37994%,0:0.00412%]
[INFO] ** service:[0.0048200000000000005:99.99845%,-211.09762999999998:0.00052%,-211.73542999999998:0.00052%,-211.35747999999998:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.4699%,9:25.92978%,7:18.11957%,1:17.47868%,14:0.00052%,3:0.00052%,15:0.00034%,4:0.00034%,21:0.00017%,2:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1581 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7379 - tp: 51521.0000 - fp: 28479.0000 - tn: 291521.0000 - fn: 28479.0000 - accuracy: 0.8576 - precision: 0.6440 - recall: 0.6440 - auc: 0.7775 - val_loss: 5.7356 - val_tp: 12883.0000 - val_fp: 7117.0000 - val_tn: 72883.0000 - val_fn: 7117.0000 - val_accuracy: 0.8577 - val_precision: 0.6442 - val_recall: 0.6442 - val_auc: 0.7776
[INFO] saving weights to checkpoints/lstm-epoch-4-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.7614 - tp: 51575.0000 - fp: 28425.0000 - tn: 291575.0000 - fn: 28425.0000 - accuracy: 0.8579 - precision: 0.6447 - recall: 0.6447 - auc: 0.8118 - val_loss: 1.6546 - val_tp: 12899.0000 - val_fp: 7101.0000 - val_tn: 72899.0000 - val_fn: 7101.0000 - val_accuracy: 0.8580 - val_precision: 0.6449 - val_recall: 0.6449 - val_auc: 0.9151
[INFO] saving weights to checkpoints/lstm-epoch-4-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.4355 - tp: 51440.0000 - fp: 28560.0000 - tn: 291440.0000 - fn: 28560.0000 - accuracy: 0.8572 - precision: 0.6430 - recall: 0.6430 - auc: 0.9321 - val_loss: 1.2407 - val_tp: 12889.0000 - val_fp: 7111.0000 - val_tn: 72889.0000 - val_fn: 7111.0000 - val_accuracy: 0.8578 - val_precision: 0.6445 - val_recall: 0.6445 - val_auc: 0.9498
[INFO] saving weights to checkpoints/lstm-epoch-4-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0901 - tp: 51525.0000 - fp: 28475.0000 - tn: 291525.0000 - fn: 28475.0000 - accuracy: 0.8576 - precision: 0.6441 - recall: 0.6441 - auc: 0.9656 - val_loss: 0.9519 - val_tp: 12873.0000 - val_fp: 7127.0000 - val_tn: 72873.0000 - val_fn: 7127.0000 - val_accuracy: 0.8575 - val_precision: 0.6436 - val_recall: 0.6436 - val_auc: 0.9683
[INFO] saving weights to checkpoints/lstm-epoch-4-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8403 - tp: 51547.0000 - fp: 28453.0000 - tn: 291547.0000 - fn: 28453.0000 - accuracy: 0.8577 - precision: 0.6443 - recall: 0.6443 - auc: 0.9665 - val_loss: 0.7371 - val_tp: 12846.0000 - val_fp: 7154.0000 - val_tn: 72846.0000 - val_fn: 7154.0000 - val_accuracy: 0.8569 - val_precision: 0.6423 - val_recall: 0.6423 - val_auc: 0.9680
[INFO] saving weights to checkpoints/lstm-epoch-4-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/582315
[33m[INFO] loading file 27-27/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (522445, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (522445, 17)

[INFO] analyzing data
[INFO] 522445 rows
[INFO] ** appi_name:[21:99.99943%,30:0.00057%]
[INFO] ** classification:[normal:64.35816%,Single Stage Single Point:35.64184%]
[INFO] ** dst:[21:43.28838%,10:21.06806%,8:18.1711%,9:17.47093%,22:0.00077%,15:0.00057%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99943%,-33.760870000000004:0.00057%]
[INFO] ** modbus_function_description:[7:50.00048%,11:49.99895%,0:0.00057%]
[INFO] ** modbus_transaction_id:65536 (12.5441%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99943%,1:0.00057%]
[INFO] ** proxy_src_ip:[18:38.42089%,20:25.93613%,13:18.17091%,6:17.47112%,17:0.00057%,16:0.00038%]
[INFO] ** s_port:[1.45442:25.93555%,-0.32151:21.06806%,-1.27613:18.17072%,-0.23351:17.47074%,-0.33484:17.35283%,-71.33197:0.00057%,-1.02014:0.00038%,-1.27347:0.00019%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.93517%,1:21.06786%,5:18.17053%,4:17.47055%,2:17.35264%,0:0.00325%]
[INFO] ** service:[0.0048200000000000005:99.99943%,-211.73542999999998:0.00057%]
[INFO] ** src:[22:38.42089%,9:25.93613%,7:18.17091%,1:17.47112%,14:0.00057%,15:0.00038%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1419 (0.27161%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/522445
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6477 - tp: 51540.0000 - fp: 28460.0000 - tn: 291540.0000 - fn: 28460.0000 - accuracy: 0.8577 - precision: 0.6442 - recall: 0.6442 - auc: 0.9666 - val_loss: 0.5617 - val_tp: 12872.0000 - val_fp: 7128.0000 - val_tn: 72872.0000 - val_fn: 7128.0000 - val_accuracy: 0.8574 - val_precision: 0.6436 - val_recall: 0.6436 - val_auc: 0.9682
[INFO] saving weights to checkpoints/lstm-epoch-4-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/522445
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4984 - tp: 51445.0000 - fp: 28555.0000 - tn: 291445.0000 - fn: 28555.0000 - accuracy: 0.8572 - precision: 0.6431 - recall: 0.6431 - auc: 0.9663 - val_loss: 0.4279 - val_tp: 12854.0000 - val_fp: 7146.0000 - val_tn: 72854.0000 - val_fn: 7146.0000 - val_accuracy: 0.8571 - val_precision: 0.6427 - val_recall: 0.6427 - val_auc: 0.9681
[INFO] saving weights to checkpoints/lstm-epoch-4-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/522445
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3820 - tp: 51580.0000 - fp: 28420.0000 - tn: 291580.0000 - fn: 28420.0000 - accuracy: 0.8579 - precision: 0.6447 - recall: 0.6447 - auc: 0.9666 - val_loss: 0.3257 - val_tp: 12863.0000 - val_fp: 7137.0000 - val_tn: 72863.0000 - val_fn: 7137.0000 - val_accuracy: 0.8573 - val_precision: 0.6431 - val_recall: 0.6431 - val_auc: 0.9682
[INFO] saving weights to checkpoints/lstm-epoch-4-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/522445
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2979 - tp: 51464.0000 - fp: 28536.0000 - tn: 291464.0000 - fn: 28536.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.9665 - val_loss: 0.2509 - val_tp: 12838.0000 - val_fp: 7162.0000 - val_tn: 72838.0000 - val_fn: 7162.0000 - val_accuracy: 0.8568 - val_precision: 0.6419 - val_recall: 0.6419 - val_auc: 0.9679
[INFO] saving weights to checkpoints/lstm-epoch-4-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/522445
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2363 - tp: 77255.0000 - fp: 2745.0000 - tn: 317255.0000 - fn: 2745.0000 - accuracy: 0.9863 - precision: 0.9657 - recall: 0.9657 - auc: 0.9980 - val_loss: 0.1937 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-26-27-batch-400000-500000
[INFO] processing batch 500000-600000/522445
[33m[INFO] loading file 28-28/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (356361, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (356361, 17)

[INFO] analyzing data
[INFO] 356361 rows
[INFO] ** appi_name:[21:99.99186%,30:0.00168%,17:0.0014%,22:0.00112%,7:0.00112%,31:0.00084%,26:0.00084%,28:0.00028%,27:0.00028%,8:0.00028%,0:0.00028%]
[INFO] ** classification:[normal:64.2994%,Single Stage Single Point:35.7006%]
[INFO] ** dst:[21:43.27718%,10:21.0138%,8:18.21383%,9:17.48648%,6:0.00224%,16:0.00196%,18:0.0014%,22:0.00056%,17:0.00056%,15:0.00056%,2:0.00056%,25:0.00028%,7:0.00028%,0:0.00028%]
[INFO] ** i/f_dir:[1:99.99944%,0:0.00056%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.99186%,-33.760870000000004:0.00814%]
[INFO] ** modbus_function_description:[11:49.99593%,7:49.99593%,0:0.00814%]
[INFO] ** modbus_transaction_id:65535 (18.39006%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99523%,2:0.00421%,1:0.00056%]
[INFO] ** proxy_src_ip:[18:38.32967%,20:25.96131%,13:18.21411%,6:17.48676%,1:0.00224%,17:0.00168%,14:0.00168%,7:0.0014%,21:0.00084%,0:0.00028%]
[INFO] ** s_port:[1.45442:25.96103%,-0.32151:21.0138%,-1.27613:18.21383%,-0.23351:17.4862%,-0.33484:17.31587%,-71.14798:0.00112%,-71.14931:0.00112%,-71.33197:0.00056%,-0.08551:0.00056%,-0.24151:0.00056%,7.66617:0.00028%,-58.035180000000004:0.00028%,-1.2708:0.00028%,-64.19493:0.00028%,-5.1466400000000005:0.00028%,13.431270000000001:0.00028%,11.57001:0.00028%,14.4699:0.00028%,1.47576:0.00028%,14.191239999999999:0.00028%,-5.08665:0.00028%,10.192739999999999:0.00028%,-3.3787199999999995:0.00028%,6.1115699999999995:0.00028%,2.05573:0.00028%,-43.76509:0.00028%,2.52505:0.00028%,11.862:0.00028%,-58.032509999999995:0.00028%]
[INFO] ** scada_tag:[3:25.96103%,1:21.0138%,5:18.21383%,4:17.48592%,2:17.31587%,0:0.00954%]
[INFO] ** service:[0.0048200000000000005:99.99186%,-205.44247:0.0014%,-186.43601999999998:0.0014%,-211.09762999999998:0.00112%,-211.08346:0.00112%,-211.08818:0.00112%,-211.73542999999998:0.00056%,-186.44547:0.00028%,-183.8612:0.00028%,-185.9872:0.00028%,-211.35747999999998:0.00028%,-202.75898:0.00028%]
[INFO] ** src:[22:38.32967%,9:25.96131%,7:18.21411%,1:17.48676%,3:0.00253%,2:0.00168%,21:0.0014%,4:0.00112%,14:0.00056%,8:0.00056%,17:0.00028%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:969 (0.27192%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/356361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1930 - tp: 78430.0000 - fp: 1570.0000 - tn: 318430.0000 - fn: 1570.0000 - accuracy: 0.9922 - precision: 0.9804 - recall: 0.9804 - auc: 0.9982 - val_loss: 0.1538 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/356361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1615 - tp: 78407.0000 - fp: 1593.0000 - tn: 318407.0000 - fn: 1593.0000 - accuracy: 0.9920 - precision: 0.9801 - recall: 0.9801 - auc: 0.9981 - val_loss: 0.1236 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/356361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1392 - tp: 78403.0000 - fp: 1597.0000 - tn: 318403.0000 - fn: 1597.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9981 - val_loss: 0.1021 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/356361
[33m[INFO] loading file 29-29/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (556361, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (556361, 17)

[INFO] analyzing data
[INFO] 556361 rows
[INFO] ** appi_name:[21:99.99874%,30:0.00054%,31:0.00018%,26:0.00018%,9:0.00018%,3:0.00018%]
[INFO] ** classification:[normal:64.39668%,Single Stage Single Point:35.60332%]
[INFO] ** dst:[21:43.33356%,10:21.06168%,8:18.13786%,9:17.4651%,22:0.00054%,15:0.00054%,24:0.00018%,18:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99946%,3:0.00054%]
[INFO] ** modbus_function_code:[0.02961:99.99874%,-33.760870000000004:0.00126%]
[INFO] ** modbus_function_description:[7:49.99973%,11:49.99901%,0:0.00126%]
[INFO] ** modbus_transaction_id:65536 (11.7794%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9991%,1:0.00054%,2:0.00036%]
[INFO] ** proxy_src_ip:[18:38.44303%,20:25.95239%,13:18.13822%,6:17.46492%,17:0.00054%,21:0.00018%,16:0.00018%,7:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95186%,-0.32151:21.06151%,-1.27613:18.13786%,-0.23351:17.46492%,-0.33484:17.38152%,-71.33197:0.00054%,1.45709:0.00036%,-71.14798:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,6.1115699999999995:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.9515%,1:21.06133%,5:18.13786%,4:17.46456%,2:17.38152%,0:0.00324%]
[INFO] ** service:[0.0048200000000000005:99.99892%,-211.73542999999998:0.00054%,-183.8612:0.00018%,-211.08346:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.44303%,9:25.95239%,7:18.13822%,1:17.46492%,14:0.00054%,21:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1511 (0.27159%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1227 - tp: 78384.0000 - fp: 1616.0000 - tn: 318384.0000 - fn: 1616.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9981 - val_loss: 0.0844 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1116 - tp: 78367.0000 - fp: 1633.0000 - tn: 318367.0000 - fn: 1633.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9981 - val_loss: 0.0714 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1018 - tp: 78404.0000 - fp: 1596.0000 - tn: 318404.0000 - fn: 1596.0000 - accuracy: 0.9920 - precision: 0.9801 - recall: 0.9801 - auc: 0.9981 - val_loss: 0.0610 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0967 - tp: 78354.0000 - fp: 1646.0000 - tn: 318354.0000 - fn: 1646.0000 - accuracy: 0.9918 - precision: 0.9794 - recall: 0.9794 - auc: 0.9980 - val_loss: 0.0540 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0937 - tp: 78282.0000 - fp: 1718.0000 - tn: 318282.0000 - fn: 1718.0000 - accuracy: 0.9914 - precision: 0.9785 - recall: 0.9785 - auc: 0.9980 - val_loss: 0.0469 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/556361
[33m[INFO] loading file 30-30/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (556361, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (556361, 17)

[INFO] analyzing data
[INFO] 556361 rows
[INFO] ** appi_name:[21:99.99748%,30:0.0018%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.36864%,Single Stage Single Point:35.63136%]
[INFO] ** dst:[21:43.33769%,10:21.02789%,8:18.14829%,9:17.48271%,15:0.0018%,22:0.00072%,24:0.00036%,25:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99838%,0:0.00162%]
[INFO] ** i/f_name:[2:99.9982%,3:0.0018%]
[INFO] ** modbus_function_code:[0.02961:99.99748%,-33.760870000000004:0.00252%]
[INFO] ** modbus_function_description:[7:49.99973%,11:49.99775%,0:0.00252%]
[INFO] ** modbus_transaction_id:65536 (11.7794%)
[INFO] ** orig:[0:99.9991%,2:0.00054%,1:0.00036%]
[INFO] ** proto:[0:99.99784%,1:0.0018%,2:0.00036%]
[INFO] ** proxy_src_ip:[18:38.36825%,20:25.99715%,13:18.14865%,6:17.48325%,17:0.0018%,7:0.00036%,16:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.99697%,-0.32151:21.02771%,-1.27613:18.14811%,-0.23351:17.48253%,-0.33484:17.34054%,-71.33197:0.0018%,-0.24151:0.00054%,-1.27347:0.00036%,-71.14798:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:25.99661%,1:21.02771%,5:18.14793%,4:17.48235%,2:17.34036%,0:0.00503%]
[INFO] ** service:[0.0048200000000000005:99.99766%,-211.73542999999998:0.0018%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.36825%,9:25.99715%,7:18.14865%,1:17.48325%,14:0.00126%,21:0.0009%,16:0.00018%,15:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.9991%,1:0.0009%]
[INFO] ** unixtime:1513 (0.27195%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0876 - tp: 78390.0000 - fp: 1610.0000 - tn: 318390.0000 - fn: 1610.0000 - accuracy: 0.9919 - precision: 0.9799 - recall: 0.9799 - auc: 0.9981 - val_loss: 0.0415 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0857 - tp: 78369.0000 - fp: 1631.0000 - tn: 318369.0000 - fn: 1631.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9980 - val_loss: 0.0372 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0811 - tp: 78452.0000 - fp: 1548.0000 - tn: 318452.0000 - fn: 1548.0000 - accuracy: 0.9923 - precision: 0.9807 - recall: 0.9807 - auc: 0.9982 - val_loss: 0.0337 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0803 - tp: 78427.0000 - fp: 1573.0000 - tn: 318427.0000 - fn: 1573.0000 - accuracy: 0.9921 - precision: 0.9803 - recall: 0.9803 - auc: 0.9982 - val_loss: 0.0305 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0802 - tp: 78400.0000 - fp: 1600.0000 - tn: 318400.0000 - fn: 1600.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9981 - val_loss: 0.0282 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/556361
[33m[INFO] loading file 31-31/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (556361, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (556361, 17)

[INFO] analyzing data
[INFO] 556361 rows
[INFO] ** appi_name:[21:99.99964%,26:0.00018%,17:0.00018%]
[INFO] ** classification:[normal:64.37547%,Single Stage Single Point:35.62453%]
[INFO] ** dst:[21:43.32115%,10:21.0527%,8:18.12528%,9:17.49907%,22:0.00108%,24:0.00036%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99964%,-33.760870000000004:0.00036%]
[INFO] ** modbus_function_description:[7:50.00009%,11:49.99955%,0:0.00036%]
[INFO] ** modbus_transaction_id:65536 (11.7794%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.39557%,20:25.979%,13:18.12546%,6:17.49907%,16:0.00054%,7:0.00036%]
[INFO] ** s_port:[1.45442:25.97828%,-0.32151:21.0527%,-1.27613:18.1251%,-0.23351:17.49889%,-0.33484:17.34288%,-1.02014:0.00054%,-1.27347:0.00036%,1.45709:0.00036%,-71.14798:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,10.192739999999999:0.00018%]
[INFO] ** scada_tag:[3:25.97792%,1:21.05252%,5:18.12492%,4:17.49853%,2:17.3427%,0:0.00342%]
[INFO] ** service:[0.0048200000000000005:99.99964%,-211.08346:0.00018%,-205.44247:0.00018%]
[INFO] ** src:[22:38.39557%,9:25.979%,7:18.12546%,1:17.49907%,15:0.00054%,21:0.00036%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1512 (0.27177%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0791 - tp: 78409.0000 - fp: 1591.0000 - tn: 318409.0000 - fn: 1591.0000 - accuracy: 0.9920 - precision: 0.9801 - recall: 0.9801 - auc: 0.9981 - val_loss: 0.0263 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0818 - tp: 78315.0000 - fp: 1685.0000 - tn: 318315.0000 - fn: 1685.0000 - accuracy: 0.9916 - precision: 0.9789 - recall: 0.9789 - auc: 0.9980 - val_loss: 0.0251 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0789 - tp: 78394.0000 - fp: 1606.0000 - tn: 318394.0000 - fn: 1606.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9981 - val_loss: 0.0235 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0793 - tp: 78378.0000 - fp: 1622.0000 - tn: 318378.0000 - fn: 1622.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9981 - val_loss: 0.0225 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0798 - tp: 78360.0000 - fp: 1640.0000 - tn: 318360.0000 - fn: 1640.0000 - accuracy: 0.9918 - precision: 0.9795 - recall: 0.9795 - auc: 0.9981 - val_loss: 0.0217 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/556361
[33m[INFO] loading file 32-32/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (556361, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (556361, 17)

[INFO] analyzing data
[INFO] 556361 rows
[INFO] ** appi_name:[21:99.99641%,30:0.00306%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.37583%,Single Stage Single Point:35.62417%]
[INFO] ** dst:[21:43.32331%,10:21.04784%,8:18.15907%,9:17.4651%,15:0.00306%,22:0.0009%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.9973%,0:0.0027%]
[INFO] ** i/f_name:[2:99.99694%,3:0.00306%]
[INFO] ** modbus_function_code:[0.02961:99.99641%,-33.760870000000004:0.00359%]
[INFO] ** modbus_function_description:[7:49.99919%,11:49.99721%,0:0.00359%]
[INFO] ** modbus_transaction_id:65536 (11.7794%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99641%,1:0.00306%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.41373%,20:25.95779%,13:18.15907%,6:17.46564%,17:0.00306%,14:0.00054%,16:0.00018%]
[INFO] ** s_port:[1.45442:25.95725%,-0.32151:21.04784%,-1.27613:18.15871%,-0.23351:17.46492%,-0.33484:17.36588%,-71.33197:0.00306%,-0.24151:0.00054%,-1.2708:0.00018%,-1.02014:0.00018%,13.431270000000001:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,1.45709:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:25.95689%,1:21.04767%,5:18.15871%,4:17.46456%,2:17.36588%,0:0.00629%]
[INFO] ** service:[0.0048200000000000005:99.99641%,-211.73542999999998:0.00306%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.41373%,9:25.95779%,7:18.15907%,1:17.46564%,14:0.00306%,2:0.00054%,15:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1510 (0.27141%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0809 - tp: 78332.0000 - fp: 1668.0000 - tn: 318332.0000 - fn: 1668.0000 - accuracy: 0.9917 - precision: 0.9791 - recall: 0.9791 - auc: 0.9980 - val_loss: 0.0211 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0785 - tp: 78395.0000 - fp: 1605.0000 - tn: 318395.0000 - fn: 1605.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9981 - val_loss: 0.0206 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0794 - tp: 78365.0000 - fp: 1635.0000 - tn: 318365.0000 - fn: 1635.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9981 - val_loss: 0.0206 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0803 - tp: 78343.0000 - fp: 1657.0000 - tn: 318343.0000 - fn: 1657.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9980 - val_loss: 0.0203 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0814 - tp: 78312.0000 - fp: 1688.0000 - tn: 318312.0000 - fn: 1688.0000 - accuracy: 0.9916 - precision: 0.9789 - recall: 0.9789 - auc: 0.9980 - val_loss: 0.0203 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/556361
[33m[INFO] loading file 33-33/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (556361, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (556361, 17)

[INFO] analyzing data
[INFO] 556361 rows
[INFO] ** appi_name:[21:99.99694%,30:0.00108%,17:0.00072%,22:0.00054%,31:0.00018%,28:0.00018%,26:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.39218%,Single Stage Single Point:35.60782%]
[INFO] ** dst:[21:43.32421%,10:21.06312%,8:18.12151%,9:17.48631%,22:0.00144%,15:0.00108%,16:0.00072%,6:0.00072%,24:0.00036%,17:0.00036%,18:0.00018%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99694%,-33.760870000000004:0.00306%]
[INFO] ** modbus_function_description:[7:49.99955%,11:49.99739%,0:0.00306%]
[INFO] ** modbus_transaction_id:65536 (11.7794%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99802%,1:0.00108%,2:0.0009%]
[INFO] ** proxy_src_ip:[18:38.42146%,20:25.96677%,13:18.12151%,6:17.48649%,17:0.00108%,16:0.00072%,1:0.00072%,21:0.00036%,14:0.00036%,7:0.00036%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.96587%,-0.32151:21.06312%,-1.27613:18.12115%,-0.23351:17.48613%,-0.33484:17.35833%,-71.33197:0.00108%,-1.02014:0.00072%,1.45709:0.00054%,-71.14931:0.00054%,-1.27347:0.00036%,-5.08665:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,-43.76509:0.00018%,-71.14798:0.00018%,-58.032509999999995:0.00018%,-58.035180000000004:0.00018%,-0.24151:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:25.96552%,1:21.06312%,5:18.12097%,4:17.48595%,2:17.35833%,0:0.00611%]
[INFO] ** service:[0.0048200000000000005:99.99694%,-211.73542999999998:0.00108%,-205.44247:0.00072%,-211.08818:0.00054%,-211.09762999999998:0.00018%,-211.08346:0.00018%,-185.9872:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.42146%,9:25.96677%,7:18.12151%,1:17.48649%,14:0.00108%,15:0.00072%,3:0.00072%,21:0.00036%,4:0.00036%,2:0.00036%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1513 (0.27195%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0798 - tp: 78356.0000 - fp: 1644.0000 - tn: 318356.0000 - fn: 1644.0000 - accuracy: 0.9918 - precision: 0.9794 - recall: 0.9794 - auc: 0.9981 - val_loss: 0.0203 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0789 - tp: 78381.0000 - fp: 1619.0000 - tn: 318381.0000 - fn: 1619.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9981 - val_loss: 0.0199 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0779 - tp: 78411.0000 - fp: 1589.0000 - tn: 318411.0000 - fn: 1589.0000 - accuracy: 0.9921 - precision: 0.9801 - recall: 0.9801 - auc: 0.9981 - val_loss: 0.0195 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0795 - tp: 78362.0000 - fp: 1638.0000 - tn: 318362.0000 - fn: 1638.0000 - accuracy: 0.9918 - precision: 0.9795 - recall: 0.9795 - auc: 0.9981 - val_loss: 0.0196 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0786 - tp: 78387.0000 - fp: 1613.0000 - tn: 318387.0000 - fn: 1613.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9981 - val_loss: 0.0199 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/556361
[33m[INFO] loading file 34-34/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (397794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (397794, 17)

[INFO] analyzing data
[INFO] 397794 rows
[INFO] ** appi_name:[21:99.99749%,30:0.00075%,7:0.00075%,31:0.00025%,22:0.00025%,8:0.00025%,6:0.00025%]
[INFO] ** classification:[normal:64.33858%,Single Stage Single Point:35.66142%]
[INFO] ** dst:[21:43.27592%,10:21.05939%,8:18.19535%,9:17.46633%,22:0.00075%,15:0.00075%,16:0.0005%,2:0.0005%,18:0.00025%,6:0.00025%]
[INFO] ** i/f_dir:[1:99.99925%,0:0.00075%]
[INFO] ** i/f_name:[2:99.99925%,3:0.00075%]
[INFO] ** modbus_function_code:[0.02961:99.99749%,-33.760870000000004:0.00251%]
[INFO] ** modbus_function_description:[7:49.99925%,11:49.99824%,0:0.00251%]
[INFO] ** modbus_transaction_id:65536 (16.47486%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99874%,1:0.00075%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.38997%,20:25.94559%,13:18.1951%,6:17.46683%,17:0.00075%,1:0.00075%,21:0.0005%,14:0.00025%,7:0.00025%]
[INFO] ** s_port:[1.45442:25.94509%,-0.32151:21.05914%,-1.27613:18.1951%,-0.23351:17.46608%,-0.33484:17.33083%,-0.24151:0.00075%,-71.33197:0.00075%,-3.0613900000000003:0.00025%,-3.3787199999999995:0.00025%,14.191239999999999:0.00025%,1.46509:0.00025%,1.47576:0.00025%,11.57001:0.00025%,-49.275529999999996:0.00025%,-71.14931:0.00025%,7.66617:0.00025%]
[INFO] ** scada_tag:[3:25.94484%,1:21.05889%,5:18.19484%,4:17.46557%,2:17.33083%,0:0.00503%]
[INFO] ** service:[0.0048200000000000005:99.99774%,-211.09762999999998:0.00075%,-211.73542999999998:0.00075%,-186.43601999999998:0.00025%,-211.35747999999998:0.00025%,-211.08818:0.00025%]
[INFO] ** src:[22:38.38997%,9:25.94559%,7:18.1951%,1:17.46683%,14:0.00075%,3:0.00075%,4:0.0005%,21:0.00025%,2:0.00025%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1080 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/397794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0775 - tp: 78418.0000 - fp: 1582.0000 - tn: 318418.0000 - fn: 1582.0000 - accuracy: 0.9921 - precision: 0.9802 - recall: 0.9802 - auc: 0.9981 - val_loss: 0.0194 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/397794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0805 - tp: 78338.0000 - fp: 1662.0000 - tn: 318338.0000 - fn: 1662.0000 - accuracy: 0.9917 - precision: 0.9792 - recall: 0.9792 - auc: 0.9980 - val_loss: 0.0199 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/397794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0791 - tp: 78375.0000 - fp: 1625.0000 - tn: 318375.0000 - fn: 1625.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9981 - val_loss: 0.0199 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/397794
[33m[INFO] loading file 35-35/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597794, 17)

[INFO] analyzing data
[INFO] 597794 rows
[INFO] ** appi_name:[21:99.999%,30:0.001%]
[INFO] ** classification:[normal:64.35745%,Single Stage Single Point:35.64255%]
[INFO] ** dst:[21:43.31994%,10:21.03501%,8:18.16863%,9:17.47425%,22:0.00117%,15:0.001%]
[INFO] ** i/f_dir:[1:99.99916%,0:0.00084%]
[INFO] ** i/f_name:[2:99.999%,3:0.001%]
[INFO] ** modbus_function_code:[0.02961:99.999%,-33.760870000000004:0.001%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.99883%,0:0.001%]
[INFO] ** modbus_transaction_id:65536 (10.96297%)
[INFO] ** orig:[0:99.99967%,1:0.00033%]
[INFO] ** proto:[0:99.999%,1:0.001%]
[INFO] ** proxy_src_ip:[18:38.3868%,20:25.96864%,13:18.1683%,6:17.47458%,17:0.001%,16:0.00067%]
[INFO] ** s_port:[1.45442:25.96814%,-0.32151:21.03501%,-1.27613:18.1683%,-0.23351:17.47408%,-0.33484:17.3518%,-71.33197:0.001%,-1.02014:0.00067%,-0.24151:0.00033%,1.45709:0.00017%,-0.24950999999999998:0.00017%,1.46509:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.96781%,1:21.03501%,5:18.16813%,4:17.47375%,2:17.3518%,0:0.00351%]
[INFO] ** service:[0.0048200000000000005:99.999%,-211.73542999999998:0.001%]
[INFO] ** src:[22:38.3868%,9:25.96864%,7:18.1683%,1:17.47458%,14:0.001%,15:0.00067%]
[INFO] ** type:[0:99.99916%,1:0.00084%]
[INFO] ** unixtime:1623 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0762 - tp: 78456.0000 - fp: 1544.0000 - tn: 318456.0000 - fn: 1544.0000 - accuracy: 0.9923 - precision: 0.9807 - recall: 0.9807 - auc: 0.9982 - val_loss: 0.0199 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0828 - tp: 78272.0000 - fp: 1728.0000 - tn: 318272.0000 - fn: 1728.0000 - accuracy: 0.9914 - precision: 0.9784 - recall: 0.9784 - auc: 0.9980 - val_loss: 0.0205 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0757 - tp: 78466.0000 - fp: 1534.0000 - tn: 318466.0000 - fn: 1534.0000 - accuracy: 0.9923 - precision: 0.9808 - recall: 0.9808 - auc: 0.9982 - val_loss: 0.0192 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0767 - tp: 78444.0000 - fp: 1556.0000 - tn: 318444.0000 - fn: 1556.0000 - accuracy: 0.9922 - precision: 0.9805 - recall: 0.9805 - auc: 0.9982 - val_loss: 0.0191 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0770 - tp: 78430.0000 - fp: 1570.0000 - tn: 318430.0000 - fn: 1570.0000 - accuracy: 0.9922 - precision: 0.9804 - recall: 0.9804 - auc: 0.9982 - val_loss: 0.0191 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/597794
[33m[INFO] loading file 36-36/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597794, 17)

[INFO] analyzing data
[INFO] 597794 rows
[INFO] ** appi_name:[21:99.99866%,30:0.00067%,31:0.00033%,33:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.36448%,Single Stage Single Point:35.63552%]
[INFO] ** dst:[21:43.33031%,10:21.03199%,8:18.14973%,9:17.48562%,22:0.00084%,15:0.00067%,24:0.00033%,18:0.00033%,25:0.00017%]
[INFO] ** i/f_dir:[1:99.99933%,0:0.00067%]
[INFO] ** i/f_name:[2:99.99933%,3:0.00067%]
[INFO] ** modbus_function_code:[0.02961:99.99866%,-33.760870000000004:0.00134%]
[INFO] ** modbus_function_description:[7:50.00033%,11:49.99833%,0:0.00134%]
[INFO] ** modbus_transaction_id:65536 (10.96297%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99883%,1:0.00067%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.3853%,20:25.97718%,13:18.1499%,6:17.48612%,17:0.00067%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.97667%,-0.32151:21.03183%,-1.27613:18.1494%,-0.23351:17.48545%,-0.33484:17.35347%,-71.33197:0.00067%,-0.24151:0.0005%,-0.08551:0.00033%,-1.27347:0.00033%,1.45709:0.00017%,1.47576:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,-64.19493:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:25.97634%,1:21.03166%,5:18.14923%,4:17.48529%,2:17.3533%,0:0.00418%]
[INFO] ** service:[0.0048200000000000005:99.99883%,-211.73542999999998:0.00067%,-186.43601999999998:0.00033%,-186.44547:0.00017%]
[INFO] ** src:[22:38.3853%,9:25.97718%,7:18.1499%,1:17.48612%,14:0.00067%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1623 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0791 - tp: 78375.0000 - fp: 1625.0000 - tn: 318375.0000 - fn: 1625.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9981 - val_loss: 0.0197 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0813 - tp: 78311.0000 - fp: 1689.0000 - tn: 318311.0000 - fn: 1689.0000 - accuracy: 0.9916 - precision: 0.9789 - recall: 0.9789 - auc: 0.9980 - val_loss: 0.0203 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0801 - tp: 78348.0000 - fp: 1652.0000 - tn: 318348.0000 - fn: 1652.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9980 - val_loss: 0.0204 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0803 - tp: 78342.0000 - fp: 1658.0000 - tn: 318342.0000 - fn: 1658.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9980 - val_loss: 0.0203 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0774 - tp: 78420.0000 - fp: 1580.0000 - tn: 318420.0000 - fn: 1580.0000 - accuracy: 0.9921 - precision: 0.9803 - recall: 0.9803 - auc: 0.9981 - val_loss: 0.0195 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/597794
[33m[INFO] loading file 37-37/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597794, 17)

[INFO] analyzing data
[INFO] 597794 rows
[INFO] ** appi_name:[21:99.99849%,30:0.00067%,31:0.00033%,33:0.00017%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:64.37686%,Single Stage Single Point:35.62314%]
[INFO] ** dst:[21:43.33767%,10:21.03701%,8:18.14036%,9:17.48278%,22:0.00067%,15:0.00067%,18:0.00033%,24:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99967%,0:0.00033%]
[INFO] ** i/f_name:[2:99.99933%,3:0.00067%]
[INFO] ** modbus_function_code:[0.02961:99.99849%,-33.760870000000004:0.00151%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99849%,0:0.00151%]
[INFO] ** modbus_transaction_id:65536 (10.96297%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99883%,1:0.00067%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.38346%,20:25.9914%,13:18.14036%,6:17.48295%,17:0.00067%,21:0.00033%,16:0.00033%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.99089%,-0.32151:21.03685%,-1.27613:18.14003%,-0.23351:17.48261%,-0.33484:17.34661%,-71.33197:0.00067%,-0.08551:0.00033%,-1.02014:0.00033%,-0.24151:0.00017%,14.4699:0.00017%,-1.2708:0.00017%,-71.14798:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:25.99056%,1:21.03685%,5:18.13986%,4:17.48244%,2:17.34644%,0:0.00385%]
[INFO] ** service:[0.0048200000000000005:99.99866%,-211.73542999999998:0.00067%,-186.43601999999998:0.00033%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.38346%,9:25.9914%,7:18.14036%,1:17.48295%,14:0.00067%,15:0.00033%,4:0.00033%,17:0.00017%,8:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99967%,1:0.00033%]
[INFO] ** unixtime:1624 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0787 - tp: 78385.0000 - fp: 1615.0000 - tn: 318385.0000 - fn: 1615.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9981 - val_loss: 0.0196 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0776 - tp: 78415.0000 - fp: 1585.0000 - tn: 318415.0000 - fn: 1585.0000 - accuracy: 0.9921 - precision: 0.9802 - recall: 0.9802 - auc: 0.9981 - val_loss: 0.0193 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0791 - tp: 78373.0000 - fp: 1627.0000 - tn: 318373.0000 - fn: 1627.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9981 - val_loss: 0.0199 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0800 - tp: 78351.0000 - fp: 1649.0000 - tn: 318351.0000 - fn: 1649.0000 - accuracy: 0.9918 - precision: 0.9794 - recall: 0.9794 - auc: 0.9981 - val_loss: 0.0199 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0775 - tp: 78417.0000 - fp: 1583.0000 - tn: 318417.0000 - fn: 1583.0000 - accuracy: 0.9921 - precision: 0.9802 - recall: 0.9802 - auc: 0.9981 - val_loss: 0.0194 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/597794
[33m[INFO] loading file 38-38/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597794, 17)

[INFO] analyzing data
[INFO] 597794 rows
[INFO] ** appi_name:[21:99.999%,30:0.00033%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.41048%,Single Stage Single Point:35.58952%]
[INFO] ** dst:[21:43.32379%,10:21.08469%,8:18.09486%,9:17.49482%,22:0.00084%,15:0.00033%,25:0.00017%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99983%,0:0.00017%]
[INFO] ** i/f_name:[2:99.99967%,3:0.00033%]
[INFO] ** modbus_function_code:[0.02961:99.999%,-33.760870000000004:0.001%]
[INFO] ** modbus_function_description:[7:49.99967%,11:49.99933%,0:0.001%]
[INFO] ** modbus_transaction_id:65536 (10.96297%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99933%,2:0.00033%,1:0.00033%]
[INFO] ** proxy_src_ip:[18:38.44669%,20:25.96246%,13:18.09469%,6:17.49499%,17:0.00033%,7:0.00033%,16:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.96162%,-0.32151:21.08452%,-1.27613:18.09453%,-0.23351:17.49449%,-0.33484:17.36217%,1.47576:0.00033%,-0.24151:0.00033%,-71.33197:0.00033%,1.45709:0.00033%,-1.27347:0.00017%,1.46509:0.00017%,-61.95768:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:25.96128%,1:21.08452%,5:18.09453%,4:17.49432%,2:17.362%,0:0.00335%]
[INFO] ** service:[0.0048200000000000005:99.99916%,-211.73542999999998:0.00033%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.44669%,9:25.96246%,7:18.09469%,1:17.49499%,21:0.00033%,14:0.00033%,16:0.00017%,15:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1624 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0771 - tp: 78430.0000 - fp: 1570.0000 - tn: 318430.0000 - fn: 1570.0000 - accuracy: 0.9921 - precision: 0.9804 - recall: 0.9804 - auc: 0.9982 - val_loss: 0.0192 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0780 - tp: 78401.0000 - fp: 1599.0000 - tn: 318401.0000 - fn: 1599.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9981 - val_loss: 0.0193 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0782 - tp: 78399.0000 - fp: 1601.0000 - tn: 318399.0000 - fn: 1601.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9981 - val_loss: 0.0194 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0803 - tp: 78341.0000 - fp: 1659.0000 - tn: 318341.0000 - fn: 1659.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9980 - val_loss: 0.0199 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0795 - tp: 78361.0000 - fp: 1639.0000 - tn: 318361.0000 - fn: 1639.0000 - accuracy: 0.9918 - precision: 0.9795 - recall: 0.9795 - auc: 0.9981 - val_loss: 0.0200 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/597794
[33m[INFO] loading file 39-39/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597794, 17)

[INFO] analyzing data
[INFO] 597794 rows
[INFO] ** appi_name:[21:99.99967%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.39593%,Single Stage Single Point:35.60407%]
[INFO] ** dst:[21:43.31158%,10:21.08302%,8:18.13668%,9:17.46722%,22:0.001%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99967%,-33.760870000000004:0.00033%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.9995%,0:0.00033%]
[INFO] ** modbus_transaction_id:65536 (10.96297%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.44451%,20:25.95058%,13:18.13685%,6:17.46722%,16:0.0005%,7:0.00033%]
[INFO] ** s_port:[1.45442:25.94991%,-0.32151:21.08302%,-1.27613:18.13652%,-0.23351:17.46705%,-0.33484:17.3615%,-1.02014:0.0005%,1.45709:0.00033%,-71.14798:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-0.24151:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.94957%,1:21.08285%,5:18.13635%,4:17.46705%,2:17.36133%,0:0.00284%]
[INFO] ** service:[0.0048200000000000005:99.99967%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.44451%,9:25.95058%,7:18.13685%,1:17.46722%,15:0.0005%,21:0.00033%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1622 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0784 - tp: 78394.0000 - fp: 1606.0000 - tn: 318394.0000 - fn: 1606.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9981 - val_loss: 0.0203 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0815 - tp: 78308.0000 - fp: 1692.0000 - tn: 318308.0000 - fn: 1692.0000 - accuracy: 0.9915 - precision: 0.9789 - recall: 0.9789 - auc: 0.9980 - val_loss: 0.0200 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0803 - tp: 78340.0000 - fp: 1660.0000 - tn: 318340.0000 - fn: 1660.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9980 - val_loss: 0.0199 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0809 - tp: 78323.0000 - fp: 1677.0000 - tn: 318323.0000 - fn: 1677.0000 - accuracy: 0.9916 - precision: 0.9790 - recall: 0.9790 - auc: 0.9980 - val_loss: 0.0203 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0787 - tp: 78385.0000 - fp: 1615.0000 - tn: 318385.0000 - fn: 1615.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9981 - val_loss: 0.0198 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/597794
[33m[INFO] loading file 40-40/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597794, 17)

[INFO] analyzing data
[INFO] 597794 rows
[INFO] ** appi_name:[21:99.99665%,30:0.00284%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.33253%,Single Stage Single Point:35.66747%]
[INFO] ** dst:[21:43.291%,10:21.03701%,8:18.20192%,9:17.46572%,15:0.00284%,22:0.00084%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99732%,0:0.00268%]
[INFO] ** i/f_name:[2:99.99716%,3:0.00284%]
[INFO] ** modbus_function_code:[0.02961:99.99665%,-33.760870000000004:0.00335%]
[INFO] ** modbus_function_description:[7:49.99933%,11:49.99732%,0:0.00335%]
[INFO] ** modbus_transaction_id:65536 (10.96297%)
[INFO] ** orig:[0:99.99967%,1:0.00033%]
[INFO] ** proto:[0:99.99665%,1:0.00284%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.35652%,20:25.97232%,13:18.20176%,6:17.46605%,17:0.00284%,14:0.0005%]
[INFO] ** s_port:[1.45442:25.97149%,-0.32151:21.03701%,-1.27613:18.20159%,-0.23351:17.46555%,-0.33484:17.31951%,-71.33197:0.00284%,1.45709:0.0005%,-0.24151:0.00033%,-71.14798:0.00017%,-1.27347:0.00017%,11.862:0.00017%,-0.24950999999999998:0.00017%,1.46509:0.00017%,1.47576:0.00017%,13.431270000000001:0.00017%]
[INFO] ** scada_tag:[3:25.97115%,1:21.03685%,5:18.20142%,4:17.46521%,2:17.31934%,0:0.00602%]
[INFO] ** service:[0.0048200000000000005:99.99665%,-211.73542999999998:0.00284%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.35652%,9:25.97232%,7:18.20176%,1:17.46605%,14:0.00284%,2:0.0005%]
[INFO] ** type:[0:99.99916%,1:0.00084%]
[INFO] ** unixtime:1625 (0.27183%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0797 - tp: 78361.0000 - fp: 1639.0000 - tn: 318361.0000 - fn: 1639.0000 - accuracy: 0.9918 - precision: 0.9795 - recall: 0.9795 - auc: 0.9981 - val_loss: 0.0200 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0788 - tp: 78382.0000 - fp: 1618.0000 - tn: 318382.0000 - fn: 1618.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9981 - val_loss: 0.0200 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0812 - tp: 78315.0000 - fp: 1685.0000 - tn: 318315.0000 - fn: 1685.0000 - accuracy: 0.9916 - precision: 0.9789 - recall: 0.9789 - auc: 0.9980 - val_loss: 0.0202 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0792 - tp: 78370.0000 - fp: 1630.0000 - tn: 318370.0000 - fn: 1630.0000 - accuracy: 0.9919 - precision: 0.9796 - recall: 0.9796 - auc: 0.9981 - val_loss: 0.0201 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0783 - tp: 78396.0000 - fp: 1604.0000 - tn: 318396.0000 - fn: 1604.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9981 - val_loss: 0.0199 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/597794
[33m[INFO] loading file 41-41/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (537952, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (537952, 17)

[INFO] analyzing data
[INFO] 537952 rows
[INFO] ** appi_name:[21:99.99684%,30:0.00093%,22:0.00074%,17:0.00074%,32:0.00019%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.38511%,Single Stage Single Point:35.61489%]
[INFO] ** dst:[21:43.32654%,10:21.05467%,8:18.14418%,9:17.47052%,16:0.00093%,15:0.00093%,6:0.00093%,22:0.00056%,24:0.00037%,17:0.00037%]
[INFO] ** i/f_dir:[1:99.99907%,0:0.00093%]
[INFO] ** i/f_name:[2:99.99907%,3:0.00093%]
[INFO] ** modbus_function_code:[0.02961:99.99684%,-33.760870000000004:0.00316%]
[INFO] ** modbus_function_description:[7:49.99907%,11:49.99777%,0:0.00316%]
[INFO] ** modbus_transaction_id:65536 (12.1825%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99796%,2:0.00112%,1:0.00093%]
[INFO] ** proxy_src_ip:[18:38.42425%,20:25.95715%,13:18.14437%,6:17.4707%,17:0.00093%,1:0.00074%,21:0.00037%,16:0.00037%,14:0.00037%,0:0.00037%,7:0.00019%,2:0.00019%]
[INFO] ** s_port:[1.45442:25.95678%,-0.32151:21.05467%,-1.27613:18.14381%,-0.23351:17.47033%,-0.33484:17.36958%,-71.33197:0.00093%,-71.14931:0.00074%,-1.27347:0.00037%,-1.02014:0.00037%,-0.24151:0.00019%,-5.1466400000000005:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,1.46509:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,-5.08665:0.00019%,-64.19226:0.00019%,-0.24950999999999998:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:25.95641%,1:21.05467%,5:18.14381%,4:17.47015%,2:17.36939%,0:0.00558%]
[INFO] ** service:[0.0048200000000000005:99.99684%,-211.73542999999998:0.00093%,-205.44247:0.00074%,-211.08818:0.00074%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%,89.64175:0.00019%]
[INFO] ** src:[22:38.42425%,9:25.95715%,7:18.14437%,1:17.4707%,14:0.00093%,3:0.00074%,15:0.00037%,8:0.00037%,4:0.00037%,2:0.00037%,21:0.00019%,17:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1459 (0.27121%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/537952
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0783 - tp: 78397.0000 - fp: 1603.0000 - tn: 318397.0000 - fn: 1603.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9981 - val_loss: 0.0197 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/537952
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0803 - tp: 78342.0000 - fp: 1658.0000 - tn: 318342.0000 - fn: 1658.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9980 - val_loss: 0.0201 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/537952
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0791 - tp: 78375.0000 - fp: 1625.0000 - tn: 318375.0000 - fn: 1625.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9981 - val_loss: 0.0198 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/537952
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0794 - tp: 78364.0000 - fp: 1636.0000 - tn: 318364.0000 - fn: 1636.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9981 - val_loss: 0.0198 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/537952
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0767 - tp: 78441.0000 - fp: 1559.0000 - tn: 318441.0000 - fn: 1559.0000 - accuracy: 0.9922 - precision: 0.9805 - recall: 0.9805 - auc: 0.9982 - val_loss: 0.0190 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-40-41-batch-400000-500000
[INFO] processing batch 500000-600000/537952
[33m[INFO] loading file 42-42/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (381466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (381466, 17)

[INFO] analyzing data
[INFO] 381466 rows
[INFO] ** appi_name:[21:99.99109%,30:0.00236%,17:0.00131%,31:0.00105%,26:0.00105%,7:0.00105%,22:0.00079%,28:0.00026%,27:0.00026%,9:0.00026%,8:0.00026%,0:0.00026%]
[INFO] ** classification:[normal:64.36563%,Single Stage Single Point:35.63437%]
[INFO] ** dst:[21:43.31159%,10:21.0446%,8:18.18511%,9:17.449%,16:0.00236%,6:0.0021%,18:0.00131%,2:0.00105%,22:0.00079%,15:0.00079%,17:0.00052%,25:0.00026%,7:0.00026%,0:0.00026%]
[INFO] ** i/f_dir:[1:99.99921%,0:0.00079%]
[INFO] ** i/f_name:[2:99.99921%,3:0.00079%]
[INFO] ** modbus_function_code:[0.02961:99.99109%,-33.760870000000004:0.00891%]
[INFO] ** modbus_function_description:[7:49.99633%,11:49.99476%,0:0.00891%]
[INFO] ** modbus_transaction_id:65536 (17.18004%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99528%,2:0.00393%,1:0.00079%]
[INFO] ** proxy_src_ip:[18:38.40395%,20:25.95251%,13:18.18537%,6:17.449%,17:0.00236%,1:0.00236%,14:0.00157%,21:0.00105%,7:0.00079%,0:0.00052%,16:0.00026%,2:0.00026%]
[INFO] ** s_port:[1.45442:25.95199%,-0.32151:21.0446%,-1.27613:18.18511%,-0.23351:17.44874%,-0.33484:17.35935%,-71.14931:0.00105%,-71.14798:0.00105%,-71.33197:0.00079%,-3.3787199999999995:0.00052%,-0.08551:0.00052%,11.57001:0.00052%,13.431270000000001:0.00026%,-5.1466400000000005:0.00026%,0.31847:0.00026%,-1.02014:0.00026%,-64.19493:0.00026%,-1.2708:0.00026%,-58.035180000000004:0.00026%,7.66617:0.00026%,-0.24151:0.00026%,1.47576:0.00026%,14.4699:0.00026%,15.912510000000001:0.00026%,14.191239999999999:0.00026%,7.9608300000000005:0.00026%,-5.08665:0.00026%,10.192739999999999:0.00026%,-3.0613900000000003:0.00026%,1.45709:0.00026%,2.05573:0.00026%,-43.76509:0.00026%,11.862:0.00026%,-58.032509999999995:0.00026%]
[INFO] ** scada_tag:[3:25.95146%,1:21.0446%,5:18.18484%,4:17.44874%,2:17.35908%,0:0.01127%]
[INFO] ** service:[0.0048200000000000005:99.99109%,-211.09762999999998:0.00184%,-205.44247:0.00131%,-186.43601999999998:0.00131%,-211.08346:0.00105%,-211.08818:0.00105%,-211.73542999999998:0.00079%,-211.35747999999998:0.00052%,-186.44547:0.00026%,-183.8612:0.00026%,-185.9872:0.00026%,-202.75898:0.00026%]
[INFO] ** src:[22:38.40395%,9:25.95251%,7:18.18537%,1:17.449%,3:0.00315%,2:0.00184%,4:0.00131%,21:0.00105%,14:0.00079%,8:0.00052%,17:0.00026%,15:0.00026%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1035 (0.27132%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/381466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0770 - tp: 78431.0000 - fp: 1569.0000 - tn: 318431.0000 - fn: 1569.0000 - accuracy: 0.9922 - precision: 0.9804 - recall: 0.9804 - auc: 0.9982 - val_loss: 0.0190 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/381466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0783 - tp: 78396.0000 - fp: 1604.0000 - tn: 318396.0000 - fn: 1604.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9981 - val_loss: 0.0195 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/381466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0784 - tp: 78393.0000 - fp: 1607.0000 - tn: 318393.0000 - fn: 1607.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9981 - val_loss: 0.0196 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/381466
[33m[INFO] loading file 43-43/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.9988%,30:0.00052%,26:0.00034%,8:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:64.39276%,Single Stage Single Point:35.60724%]
[INFO] ** dst:[21:43.32085%,10:21.06968%,8:18.13623%,9:17.47084%,22:0.00103%,15:0.00052%,6:0.00034%,2:0.00034%,24:0.00017%]
[INFO] ** i/f_dir:[1:99.99983%,0:0.00017%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.9988%,-33.760870000000004:0.0012%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.9988%,0:0.0012%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99914%,1:0.00052%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.4179%,20:25.97314%,13:18.1364%,6:17.47101%,17:0.00052%,1:0.00052%,16:0.00034%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.97246%,-0.32151:21.06968%,-1.27613:18.13606%,-0.23351:17.4705%,-0.33484:17.34822%,-71.33197:0.00052%,-71.14798:0.00034%,1.45709:0.00034%,1.47576:0.00034%,-0.24151:0.00034%,-1.02014:0.00034%,0.31847:0.00017%,-1.27347:0.00017%,-0.24950999999999998:0.00017%,-1.2708:0.00017%,-3.3787199999999995:0.00017%]
[INFO] ** scada_tag:[3:25.97211%,1:21.06968%,5:18.13588%,4:17.47015%,2:17.34805%,0:0.00413%]
[INFO] ** service:[0.0048200000000000005:99.9988%,-211.73542999999998:0.00052%,-211.08346:0.00034%,-211.09762999999998:0.00017%,-211.35747999999998:0.00017%]
[INFO] ** src:[22:38.4179%,9:25.97314%,7:18.1364%,1:17.47101%,14:0.00052%,3:0.00052%,15:0.00034%,21:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1581 (0.2719%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0770 - tp: 78433.0000 - fp: 1567.0000 - tn: 318433.0000 - fn: 1567.0000 - accuracy: 0.9922 - precision: 0.9804 - recall: 0.9804 - auc: 0.9982 - val_loss: 0.0190 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0787 - tp: 78384.0000 - fp: 1616.0000 - tn: 318384.0000 - fn: 1616.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9981 - val_loss: 0.0198 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0763 - tp: 78451.0000 - fp: 1549.0000 - tn: 318451.0000 - fn: 1549.0000 - accuracy: 0.9923 - precision: 0.9806 - recall: 0.9806 - auc: 0.9982 - val_loss: 0.0192 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0788 - tp: 78385.0000 - fp: 1615.0000 - tn: 318385.0000 - fn: 1615.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9981 - val_loss: 0.0193 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0764 - tp: 78448.0000 - fp: 1552.0000 - tn: 318448.0000 - fn: 1552.0000 - accuracy: 0.9922 - precision: 0.9806 - recall: 0.9806 - auc: 0.9982 - val_loss: 0.0189 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 44-44/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.99828%,30:0.00069%,31:0.00052%,0:0.00034%,22:0.00017%]
[INFO] ** classification:[normal:64.39345%,Single Stage Single Point:35.60655%]
[INFO] ** dst:[21:43.33512%,10:21.0554%,8:18.14981%,9:17.45657%,22:0.00103%,15:0.00069%,18:0.00052%,25:0.00034%,24:0.00034%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99931%,0:0.00069%]
[INFO] ** i/f_name:[2:99.99931%,3:0.00069%]
[INFO] ** modbus_function_code:[0.02961:99.99828%,-33.760870000000004:0.00172%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.99811%,0:0.00172%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99828%,2:0.00103%,1:0.00069%]
[INFO] ** proxy_src_ip:[18:38.4375%,20:25.95354%,13:18.14999%,6:17.45708%,17:0.00069%,7:0.00034%,16:0.00017%,5:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95285%,-0.32151:21.0554%,-1.27613:18.14947%,-0.23351:17.45639%,-0.33484:17.3821%,-71.33197:0.00069%,-0.24151:0.00052%,-0.08551:0.00034%,-64.19493:0.00034%,-1.27347:0.00034%,1.45709:0.00034%,-1.02014:0.00017%,-1.2708:0.00017%,1.47576:0.00017%,-71.14931:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,4.42897:0.00017%]
[INFO] ** scada_tag:[3:25.95233%,1:21.0554%,5:18.14947%,4:17.45605%,2:17.38193%,0:0.00482%]
[INFO] ** service:[0.0048200000000000005:99.99828%,-211.73542999999998:0.00069%,-186.43601999999998:0.00052%,-186.44547:0.00034%,-211.08818:0.00017%]
[INFO] ** src:[22:38.4375%,9:25.95354%,7:18.14999%,1:17.45708%,14:0.00069%,21:0.00034%,17:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1578 (0.27138%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0777 - tp: 78408.0000 - fp: 1592.0000 - tn: 318408.0000 - fn: 1592.0000 - accuracy: 0.9920 - precision: 0.9801 - recall: 0.9801 - auc: 0.9981 - val_loss: 0.0192 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0788 - tp: 78384.0000 - fp: 1616.0000 - tn: 318384.0000 - fn: 1616.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9981 - val_loss: 0.0193 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0802 - tp: 78345.0000 - fp: 1655.0000 - tn: 318345.0000 - fn: 1655.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9980 - val_loss: 0.0199 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0796 - tp: 78360.0000 - fp: 1640.0000 - tn: 318360.0000 - fn: 1640.0000 - accuracy: 0.9918 - precision: 0.9795 - recall: 0.9795 - auc: 0.9981 - val_loss: 0.0200 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0783 - tp: 78396.0000 - fp: 1604.0000 - tn: 318396.0000 - fn: 1604.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9981 - val_loss: 0.0196 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 45-45/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.9988%,30:0.00052%,31:0.00034%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:64.41649%,Single Stage Single Point:35.58351%]
[INFO] ** dst:[21:43.32308%,10:21.09066%,8:18.12832%,9:17.45536%,22:0.00138%,15:0.00052%,18:0.00034%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99966%,0:0.00034%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.9988%,-33.760870000000004:0.0012%]
[INFO] ** modbus_function_description:[7:50.00052%,11:49.99828%,0:0.0012%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99897%,2:0.00052%,1:0.00052%]
[INFO] ** proxy_src_ip:[18:38.48342%,20:25.93101%,13:18.12815%,6:17.45588%,17:0.00052%,16:0.00034%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.93032%,-0.32151:21.09066%,-1.27613:18.12815%,-0.23351:17.45519%,-0.33484:17.39276%,1.45709:0.00052%,-0.24151:0.00052%,-71.33197:0.00052%,-1.02014:0.00034%,-0.08551:0.00034%,-71.14798:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,14.4699:0.00017%]
[INFO] ** scada_tag:[3:25.92981%,1:21.09049%,5:18.12815%,4:17.45519%,2:17.39259%,0:0.00378%]
[INFO] ** service:[0.0048200000000000005:99.9988%,-211.73542999999998:0.00052%,-186.43601999999998:0.00034%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.48342%,9:25.93101%,7:18.12815%,1:17.45588%,14:0.00052%,15:0.00034%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1578 (0.27138%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0778 - tp: 78409.0000 - fp: 1591.0000 - tn: 318409.0000 - fn: 1591.0000 - accuracy: 0.9920 - precision: 0.9801 - recall: 0.9801 - auc: 0.9981 - val_loss: 0.0193 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0791 - tp: 78374.0000 - fp: 1626.0000 - tn: 318374.0000 - fn: 1626.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9981 - val_loss: 0.0195 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0782 - tp: 78398.0000 - fp: 1602.0000 - tn: 318398.0000 - fn: 1602.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9981 - val_loss: 0.0196 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0810 - tp: 78322.0000 - fp: 1678.0000 - tn: 318322.0000 - fn: 1678.0000 - accuracy: 0.9916 - precision: 0.9790 - recall: 0.9790 - auc: 0.9980 - val_loss: 0.0202 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0802 - tp: 78344.0000 - fp: 1656.0000 - tn: 318344.0000 - fn: 1656.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9980 - val_loss: 0.0203 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 46-46/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.99828%,30:0.00103%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.41924%,Single Stage Single Point:35.58076%]
[INFO] ** dst:[21:43.34578%,10:21.07088%,8:18.1082%,9:17.47256%,22:0.00103%,15:0.00103%,25:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99914%,0:0.00086%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.99828%,-33.760870000000004:0.00172%]
[INFO] ** modbus_function_description:[11:49.99931%,7:49.99897%,0:0.00172%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.99862%,1:0.00103%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.44163%,20:25.97504%,13:18.1082%,6:17.47308%,17:0.00103%,16:0.00034%,7:0.00034%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.97469%,-0.32151:21.07071%,-1.27613:18.10802%,-0.23351:17.47239%,-0.33484:17.37092%,-71.33197:0.00103%,-0.24151:0.00052%,-1.02014:0.00034%,-71.14798:0.00017%,1.45709:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,-61.95768:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:25.97435%,1:21.07054%,5:18.10785%,4:17.47204%,2:17.37092%,0:0.0043%]
[INFO] ** service:[0.0048200000000000005:99.99845%,-211.73542999999998:0.00103%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.44163%,9:25.97504%,7:18.1082%,1:17.47308%,14:0.00103%,21:0.00034%,15:0.00034%,16:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99914%,1:0.00086%]
[INFO] ** unixtime:1581 (0.2719%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0780 - tp: 78404.0000 - fp: 1596.0000 - tn: 318404.0000 - fn: 1596.0000 - accuracy: 0.9920 - precision: 0.9801 - recall: 0.9801 - auc: 0.9981 - val_loss: 0.0198 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0786 - tp: 78386.0000 - fp: 1614.0000 - tn: 318386.0000 - fn: 1614.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9981 - val_loss: 0.0198 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0821 - tp: 78292.0000 - fp: 1708.0000 - tn: 318292.0000 - fn: 1708.0000 - accuracy: 0.9915 - precision: 0.9786 - recall: 0.9786 - auc: 0.9980 - val_loss: 0.0207 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0784 - tp: 78394.0000 - fp: 1606.0000 - tn: 318394.0000 - fn: 1606.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9981 - val_loss: 0.0197 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0796 - tp: 78360.0000 - fp: 1640.0000 - tn: 318360.0000 - fn: 1640.0000 - accuracy: 0.9918 - precision: 0.9795 - recall: 0.9795 - auc: 0.9981 - val_loss: 0.0198 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 47-47/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.99948%,33:0.00017%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.39603%,Single Stage Single Point:35.60397%]
[INFO] ** dst:[21:43.31018%,10:21.08395%,8:18.1278%,9:17.47583%,22:0.00155%,24:0.00034%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99948%,-33.760870000000004:0.00052%]
[INFO] ** modbus_function_description:[7:50.00103%,11:49.99845%,0:0.00052%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.45401%,20:25.94081%,13:18.12815%,6:17.47617%,16:0.00034%,7:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.93995%,-0.32151:21.08395%,-1.27613:18.12763%,-0.23351:17.47566%,-0.33484:17.37006%,1.45709:0.00052%,-0.24151:0.00052%,-1.27347:0.00034%,-1.02014:0.00034%,-71.14798:0.00017%,-61.95635:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.93944%,1:21.08378%,5:18.12746%,4:17.47548%,2:17.36989%,0:0.00396%]
[INFO] ** service:[0.0048200000000000005:99.99966%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.45401%,9:25.94081%,7:18.12815%,1:17.47617%,21:0.00034%,15:0.00034%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1579 (0.27156%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0794 - tp: 78365.0000 - fp: 1635.0000 - tn: 318365.0000 - fn: 1635.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9981 - val_loss: 0.0201 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0806 - tp: 78330.0000 - fp: 1670.0000 - tn: 318330.0000 - fn: 1670.0000 - accuracy: 0.9917 - precision: 0.9791 - recall: 0.9791 - auc: 0.9980 - val_loss: 0.0204 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0774 - tp: 78419.0000 - fp: 1581.0000 - tn: 318419.0000 - fn: 1581.0000 - accuracy: 0.9921 - precision: 0.9802 - recall: 0.9802 - auc: 0.9982 - val_loss: 0.0193 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0781 - tp: 78402.0000 - fp: 1598.0000 - tn: 318402.0000 - fn: 1598.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9981 - val_loss: 0.0193 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0799 - tp: 78357.0000 - fp: 1643.0000 - tn: 318357.0000 - fn: 1643.0000 - accuracy: 0.9918 - precision: 0.9795 - recall: 0.9795 - auc: 0.9981 - val_loss: 0.0201 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 48-48/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.9969%,30:0.00241%,33:0.00017%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.42973%,Single Stage Single Point:35.57027%]
[INFO] ** dst:[21:43.33031%,10:21.09564%,8:18.10407%,9:17.46603%,15:0.00241%,22:0.00086%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99794%,0:0.00206%]
[INFO] ** i/f_name:[2:99.99759%,3:0.00241%]
[INFO] ** modbus_function_code:[0.02961:99.9969%,-33.760870000000004:0.0031%]
[INFO] ** modbus_function_description:[7:49.99897%,11:49.99794%,0:0.0031%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99708%,1:0.00241%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.47207%,20:25.95423%,13:18.10424%,6:17.46603%,17:0.00241%,14:0.00052%,16:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95371%,-0.32151:21.09564%,-1.27613:18.1039%,-0.23351:17.46585%,-0.33484:17.37642%,-71.33197:0.00241%,-1.02014:0.00034%,-1.2708:0.00017%,13.431270000000001:0.00017%,-0.24151:0.00017%,-71.14798:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-61.95635:0.00017%,1.45709:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.95337%,1:21.09547%,5:18.1039%,4:17.46585%,2:17.37625%,0:0.00516%]
[INFO] ** service:[0.0048200000000000005:99.99708%,-211.73542999999998:0.00241%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.47207%,9:25.95423%,7:18.10424%,1:17.46603%,14:0.00241%,2:0.00052%,15:0.00034%,8:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1578 (0.27138%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0792 - tp: 78369.0000 - fp: 1631.0000 - tn: 318369.0000 - fn: 1631.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9981 - val_loss: 0.0199 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0780 - tp: 78406.0000 - fp: 1594.0000 - tn: 318406.0000 - fn: 1594.0000 - accuracy: 0.9920 - precision: 0.9801 - recall: 0.9801 - auc: 0.9981 - val_loss: 0.0196 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0758 - tp: 78463.0000 - fp: 1537.0000 - tn: 318463.0000 - fn: 1537.0000 - accuracy: 0.9923 - precision: 0.9808 - recall: 0.9808 - auc: 0.9982 - val_loss: 0.0190 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0788 - tp: 78380.0000 - fp: 1620.0000 - tn: 318380.0000 - fn: 1620.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9981 - val_loss: 0.0197 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0775 - tp: 78417.0000 - fp: 1583.0000 - tn: 318417.0000 - fn: 1583.0000 - accuracy: 0.9921 - precision: 0.9802 - recall: 0.9802 - auc: 0.9981 - val_loss: 0.0193 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 49-49/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.99742%,30:0.00086%,17:0.00069%,26:0.00034%,22:0.00034%,28:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:64.38124%,Single Stage Single Point:35.61876%]
[INFO] ** dst:[21:43.31878%,10:21.05815%,8:18.12866%,9:17.48993%,22:0.00155%,15:0.00086%,16:0.00069%,6:0.00069%,24:0.00034%,17:0.00034%]
[INFO] ** i/f_dir:[1:99.99914%,0:0.00086%]
[INFO] ** i/f_name:[2:99.99914%,3:0.00086%]
[INFO] ** modbus_function_code:[0.02961:99.99742%,-33.760870000000004:0.00258%]
[INFO] ** modbus_function_description:[7:49.99983%,11:49.99759%,0:0.00258%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99845%,1:0.00086%,2:0.00069%]
[INFO] ** proxy_src_ip:[18:38.4234%,20:25.95423%,13:18.12883%,6:17.49062%,17:0.00086%,1:0.00069%,14:0.00052%,21:0.00034%,16:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95337%,-0.32151:21.05815%,-1.27613:18.12832%,-0.23351:17.48976%,-0.33484:17.36525%,-71.33197:0.00086%,-0.24151:0.00069%,1.45709:0.00052%,-1.27347:0.00034%,-71.14931:0.00034%,-1.02014:0.00034%,-71.14798:0.00034%,1.47576:0.00017%,-1.2708:0.00017%,-58.035180000000004:0.00017%,-58.032509999999995:0.00017%,1.46509:0.00017%,-43.76509:0.00017%,2.05573:0.00017%,-5.08665:0.00017%,-0.24950999999999998:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.95302%,1:21.05798%,5:18.12815%,4:17.48941%,2:17.36525%,0:0.00619%]
[INFO] ** service:[0.0048200000000000005:99.99742%,-211.73542999999998:0.00086%,-205.44247:0.00069%,-211.08346:0.00034%,-211.08818:0.00034%,-211.09762999999998:0.00017%,-185.9872:0.00017%]
[INFO] ** src:[22:38.4234%,9:25.95423%,7:18.12883%,1:17.49062%,14:0.00086%,3:0.00069%,2:0.00052%,15:0.00034%,4:0.00034%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1579 (0.27156%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0769 - tp: 78438.0000 - fp: 1562.0000 - tn: 318438.0000 - fn: 1562.0000 - accuracy: 0.9922 - precision: 0.9805 - recall: 0.9805 - auc: 0.9982 - val_loss: 0.0190 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0803 - tp: 78340.0000 - fp: 1660.0000 - tn: 318340.0000 - fn: 1660.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9980 - val_loss: 0.0200 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0781 - tp: 78403.0000 - fp: 1597.0000 - tn: 318403.0000 - fn: 1597.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9981 - val_loss: 0.0197 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0777 - tp: 78413.0000 - fp: 1587.0000 - tn: 318413.0000 - fn: 1587.0000 - accuracy: 0.9921 - precision: 0.9802 - recall: 0.9802 - auc: 0.9981 - val_loss: 0.0193 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0806 - tp: 78332.0000 - fp: 1668.0000 - tn: 318332.0000 - fn: 1668.0000 - accuracy: 0.9917 - precision: 0.9791 - recall: 0.9791 - auc: 0.9980 - val_loss: 0.0200 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 50-50/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (431448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (431448, 17)

[INFO] analyzing data
[INFO] 431448 rows
[INFO] ** appi_name:[21:99.99745%,30:0.00116%,7:0.0007%,31:0.00023%,22:0.00023%,8:0.00023%]
[INFO] ** classification:[normal:64.3132%,Single Stage Single Point:35.6868%]
[INFO] ** dst:[21:43.26593%,10:21.04402%,8:18.21425%,9:17.47233%,15:0.00116%,22:0.0007%,16:0.00046%,2:0.00046%,24:0.00023%,18:0.00023%,6:0.00023%]
[INFO] ** i/f_dir:[1:99.99884%,0:0.00116%]
[INFO] ** i/f_name:[2:99.99884%,3:0.00116%]
[INFO] ** modbus_function_code:[0.02961:99.99745%,-33.760870000000004:0.00255%]
[INFO] ** modbus_function_description:[7:49.99884%,11:49.99861%,0:0.00255%]
[INFO] ** modbus_transaction_id:65536 (15.18978%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99838%,1:0.00116%,2:0.00046%]
[INFO] ** proxy_src_ip:[18:38.3694%,20:25.94079%,13:18.21448%,6:17.47233%,17:0.00116%,1:0.0007%,16:0.00046%,21:0.00023%,14:0.00023%,7:0.00023%]
[INFO] ** s_port:[1.45442:25.94032%,-0.32151:21.04402%,-1.27613:18.21401%,-0.23351:17.47233%,-0.33484:17.32538%,-71.33197:0.00116%,-1.02014:0.00046%,-3.3787199999999995:0.00023%,4.33564:0.00023%,15.912510000000001:0.00023%,7.9608300000000005:0.00023%,1.46509:0.00023%,1.45709:0.00023%,-1.27347:0.00023%,-71.14931:0.00023%,-1.2708:0.00023%,0.31847:0.00023%]
[INFO] ** scada_tag:[3:25.94009%,1:21.04379%,5:18.21378%,4:17.47233%,2:17.32515%,0:0.00487%]
[INFO] ** service:[0.0048200000000000005:99.99745%,-211.73542999999998:0.00116%,-211.09762999999998:0.0007%,-186.43601999999998:0.00023%,-211.35747999999998:0.00023%,-211.08818:0.00023%]
[INFO] ** src:[22:38.3694%,9:25.94079%,7:18.21448%,1:17.47233%,14:0.00116%,3:0.0007%,15:0.00046%,21:0.00023%,4:0.00023%,2:0.00023%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1172 (0.27164%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/431448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0791 - tp: 78373.0000 - fp: 1627.0000 - tn: 318373.0000 - fn: 1627.0000 - accuracy: 0.9919 - precision: 0.9797 - recall: 0.9797 - auc: 0.9981 - val_loss: 0.0198 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/431448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0719 - tp: 78360.0000 - fp: 1640.0000 - tn: 318360.0000 - fn: 1640.0000 - accuracy: 0.9918 - precision: 0.9795 - recall: 0.9795 - auc: 0.9990 - val_loss: 4.8776e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/431448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0531 - tp: 78461.0000 - fp: 1539.0000 - tn: 318461.0000 - fn: 1539.0000 - accuracy: 0.9923 - precision: 0.9808 - recall: 0.9808 - auc: 0.9995 - val_loss: 2.2968e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/431448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0531 - tp: 78318.0000 - fp: 1682.0000 - tn: 318318.0000 - fn: 1682.0000 - accuracy: 0.9916 - precision: 0.9790 - recall: 0.9790 - auc: 0.9995 - val_loss: 9.6020e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-49-50-batch-300000-400000
[INFO] processing batch 400000-500000/431448
[33m[INFO] epoch 5/10[0m
[33m[INFO] loading file 1-1/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99323%,30:0.00113%,22:0.00094%,17:0.00075%,31:0.00056%,26:0.00056%,7:0.00056%,23:0.00038%,18:0.00038%,0:0.00038%,28:0.00019%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:78.41614%,Single Stage Single Point:21.58386%]
[INFO] ** dst:[21:43.27272%,10:21.04063%,8:18.16321%,9:17.51611%,6:0.00151%,22:0.00113%,16:0.00113%,15:0.00113%,18:0.00056%,26:0.00038%,25:0.00038%,19:0.00038%,17:0.00038%,24:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99887%,0:0.00113%]
[INFO] ** i/f_name:[2:99.99887%,3:0.00113%]
[INFO] ** modbus_function_code:[0.02961:99.99323%,-33.760870000000004:0.00659%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99755%,11:49.99567%,0:0.00659%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99624%,2:0.00263%,1:0.00113%]
[INFO] ** proxy_src_ip:[18:38.40413%,20:25.90884%,13:18.1634%,6:17.51648%,11:0.00132%,10:0.00132%,17:0.00113%,14:0.00094%,1:0.00094%,7:0.00056%,21:0.00038%,16:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.90827%,-0.32151:21.03988%,-1.27613:18.16302%,-0.23351:17.51592%,-0.33484:17.36426%,-71.33197:0.00113%,-71.14931:0.00094%,-2.1481:0.00075%,-0.24151:0.00056%,-71.14798:0.00056%,-1.02014:0.00038%,-64.19493:0.00038%,-2.42942:0.00038%,4.44364:0.00038%,-43.76509:0.00019%,10.67005:0.00019%,4.29964:0.00019%,-5.08665:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,1.47576:0.00019%,1.46509:0.00019%,4.076980000000001:0.00019%,-58.032509999999995:0.00019%,-58.035180000000004:0.00019%,-1.2708:0.00019%,-1.27347:0.00019%,-5.1466400000000005:0.00019%,-68.79874000000001:0.00019%,14.253910000000001:0.00019%,1.45709:0.00019%]
[INFO] ** scada_tag:[3:25.90809%,1:21.03969%,5:18.16264%,4:17.51573%,2:17.36407%,0:0.00978%]
[INFO] ** service:[0.0048200000000000005:99.99398%,-211.73542999999998:0.00113%,-211.08818:0.00094%,-205.44247:0.00075%,-211.07873999999998:0.00075%,-211.09762999999998:0.00056%,-211.08346:0.00056%,-186.43601999999998:0.00056%,-186.44547:0.00038%,-185.9872:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.40413%,9:25.90884%,7:18.1634%,1:17.51648%,11:0.00132%,10:0.00132%,14:0.00113%,3:0.00094%,2:0.00094%,21:0.00056%,15:0.00038%,4:0.00038%,8:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1442 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4705 - tp: 61070.0000 - fp: 18930.0000 - tn: 301070.0000 - fn: 18930.0000 - accuracy: 0.9053 - precision: 0.7634 - recall: 0.7634 - auc: 0.9720 - val_loss: 0.2968 - val_tp: 12828.0000 - val_fp: 7172.0000 - val_tn: 72828.0000 - val_fn: 7172.0000 - val_accuracy: 0.8566 - val_precision: 0.6414 - val_recall: 0.6414 - val_auc: 0.9679
[INFO] saving weights to checkpoints/lstm-epoch-5-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2101 - tp: 74390.0000 - fp: 5610.0000 - tn: 314390.0000 - fn: 5610.0000 - accuracy: 0.9719 - precision: 0.9299 - recall: 0.9299 - auc: 0.9974 - val_loss: 0.1368 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1148 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0863 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.9135 - tp: 60637.0000 - fp: 19363.0000 - tn: 300637.0000 - fn: 19363.0000 - accuracy: 0.9032 - precision: 0.7580 - recall: 0.7580 - auc: 0.9362 - val_loss: 0.2777 - val_tp: 19587.0000 - val_fp: 413.0000 - val_tn: 79587.0000 - val_fn: 413.0000 - val_accuracy: 0.9917 - val_precision: 0.9793 - val_recall: 0.9793 - val_auc: 0.9990
[INFO] saving weights to checkpoints/lstm-epoch-5-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2592 - tp: 72055.0000 - fp: 7945.0000 - tn: 312055.0000 - fn: 7945.0000 - accuracy: 0.9603 - precision: 0.9007 - recall: 0.9007 - auc: 0.9861 - val_loss: 0.0981 - val_tp: 19997.0000 - val_fp: 3.0000 - val_tn: 79997.0000 - val_fn: 3.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 2-2/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99868%,7:0.00056%,30:0.00038%,31:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:71.62432%,Single Stage Single Point:28.37568%]
[INFO] ** dst:[21:43.31186%,10:21.0267%,8:18.14759%,9:17.51159%,22:0.00075%,16:0.00038%,15:0.00038%,2:0.00038%,24:0.00019%,18:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99868%,-33.760870000000004:0.00132%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99868%,0:0.00132%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99944%,1:0.00038%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.37741%,20:25.96171%,13:18.14759%,6:17.51178%,1:0.00056%,17:0.00038%,16:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.96096%,-0.32151:21.0267%,-1.27613:18.14721%,-0.23351:17.5114%,-0.33484:17.35071%,-71.33197:0.00038%,1.45709:0.00038%,1.46509:0.00019%,1.47576:0.00019%,12.60597:0.00019%,10.67005:0.00019%,-0.24950999999999998:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,4.076980000000001:0.00019%,-3.3787199999999995:0.00019%,4.29964:0.00019%,-1.27347:0.00019%]
[INFO] ** scada_tag:[3:25.96058%,1:21.0267%,5:18.14721%,4:17.51121%,2:17.35052%,0:0.00376%]
[INFO] ** service:[0.0048200000000000005:99.99868%,-211.09762999999998:0.00056%,-211.73542999999998:0.00038%,-211.35747999999998:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.37741%,9:25.96171%,7:18.14759%,1:17.51178%,3:0.00056%,14:0.00038%,21:0.00019%,15:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1446 (0.27209%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1925 - tp: 74864.0000 - fp: 5136.0000 - tn: 314864.0000 - fn: 5136.0000 - accuracy: 0.9743 - precision: 0.9358 - recall: 0.9358 - auc: 0.9925 - val_loss: 0.0804 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5308 - tp: 62925.0000 - fp: 17075.0000 - tn: 302925.0000 - fn: 17075.0000 - accuracy: 0.9146 - precision: 0.7866 - recall: 0.7866 - auc: 0.9628 - val_loss: 0.5082 - val_tp: 12231.0000 - val_fp: 7769.0000 - val_tn: 72231.0000 - val_fn: 7769.0000 - val_accuracy: 0.8446 - val_precision: 0.6115 - val_recall: 0.6115 - val_auc: 0.9465
[INFO] saving weights to checkpoints/lstm-epoch-5-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1365 - tp: 79369.0000 - fp: 631.0000 - tn: 319369.0000 - fn: 631.0000 - accuracy: 0.9968 - precision: 0.9921 - recall: 0.9921 - auc: 0.9996 - val_loss: 0.3482 - val_tp: 17800.0000 - val_fp: 2200.0000 - val_tn: 77800.0000 - val_fn: 2200.0000 - val_accuracy: 0.9560 - val_precision: 0.8900 - val_recall: 0.8900 - val_auc: 0.9816
[INFO] saving weights to checkpoints/lstm-epoch-5-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4746 - tp: 63148.0000 - fp: 16852.0000 - tn: 303148.0000 - fn: 16852.0000 - accuracy: 0.9157 - precision: 0.7893 - recall: 0.7893 - auc: 0.9652 - val_loss: 0.0637 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4906 - tp: 63230.0000 - fp: 16770.0000 - tn: 303230.0000 - fn: 16770.0000 - accuracy: 0.9162 - precision: 0.7904 - recall: 0.7904 - auc: 0.9662 - val_loss: 0.5474 - val_tp: 10894.0000 - val_fp: 9106.0000 - val_tn: 70894.0000 - val_fn: 9106.0000 - val_accuracy: 0.8179 - val_precision: 0.5447 - val_recall: 0.5447 - val_auc: 0.9441
[INFO] saving weights to checkpoints/lstm-epoch-5-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 3-3/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99134%,30:0.00226%,22:0.00113%,31:0.00094%,26:0.00094%,17:0.00094%,7:0.00075%,27:0.00038%,0:0.00038%,28:0.00019%,23:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:87.49793%,Single Stage Single Point:12.50207%]
[INFO] ** dst:[21:43.3049%,10:21.08899%,8:18.15493%,9:17.44159%,6:0.00226%,15:0.00151%,18:0.00132%,16:0.00132%,22:0.00094%,2:0.00038%,7:0.00038%,25:0.00038%,17:0.00038%,12:0.00019%,24:0.00019%,19:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99849%,0:0.00151%]
[INFO] ** i/f_name:[2:99.99849%,3:0.00151%]
[INFO] ** modbus_function_code:[0.02961:99.99134%,-33.760870000000004:0.00847%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99642%,11:49.99492%,0:0.00847%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99887%,2:0.00113%]
[INFO] ** proto:[0:99.99398%,2:0.00452%,1:0.00151%]
[INFO] ** proxy_src_ip:[18:38.41731%,20:25.97695%,13:18.15512%,6:17.44197%,17:0.00226%,1:0.00151%,14:0.00132%,7:0.00094%,11:0.00075%,10:0.00075%,21:0.00056%,16:0.00019%,15:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.9762%,-0.32151:21.0888%,-1.27613:18.15455%,-0.23351:17.44141%,-0.33484:17.32851%,-71.33197:0.00151%,-71.14931:0.00113%,-71.14798:0.00113%,-64.19493:0.00038%,-0.08551:0.00038%,1.45709:0.00038%,-0.24151:0.00038%,14.4699:0.00019%,4.29964:0.00019%,4.90362:0.00019%,10.192739999999999:0.00019%,-3.3787199999999995:0.00019%,13.86459:0.00019%,4.44364:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-5.08665:0.00019%,-58.035180000000004:0.00019%,4.076980000000001:0.00019%,-58.032509999999995:0.00019%,-1.27347:0.00019%,-1.2708:0.00019%,-1.02014:0.00019%,-5.1466400000000005:0.00019%,13.431270000000001:0.00019%,12.60597:0.00019%,1.47576:0.00019%,1.46509:0.00019%,14.253910000000001:0.00019%,-68.79874000000001:0.00019%,-0.24950999999999998:0.00019%,-2.1481:0.00019%,10.67005:0.00019%,-68.36943000000001:0.00019%]
[INFO] ** scada_tag:[3:25.97582%,1:21.08861%,5:18.15436%,4:17.44122%,2:17.32832%,0:0.01167%]
[INFO] ** service:[0.0048200000000000005:99.99153%,-211.73542999999998:0.00151%,-186.43601999999998:0.00132%,-211.08346:0.00113%,-211.08818:0.00113%,-205.44247:0.00094%,-211.09762999999998:0.00075%,-202.75898:0.00038%,-186.44547:0.00038%,-183.8612:0.00019%,-185.9872:0.00019%,-201.23771000000002:0.00019%,-211.35747999999998:0.00019%,-211.07873999999998:0.00019%]
[INFO] ** src:[22:38.41731%,9:25.97695%,7:18.15512%,1:17.44197%,21:0.00207%,3:0.00169%,2:0.00132%,11:0.00075%,10:0.00075%,4:0.00075%,14:0.00038%,8:0.00038%,17:0.00019%,15:0.00019%,13:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1443 (0.27152%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3313 - tp: 69860.0000 - fp: 10140.0000 - tn: 309860.0000 - fn: 10140.0000 - accuracy: 0.9493 - precision: 0.8733 - recall: 0.8733 - auc: 0.9842 - val_loss: 0.1393 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1913 - tp: 76411.0000 - fp: 3589.0000 - tn: 316411.0000 - fn: 3589.0000 - accuracy: 0.9821 - precision: 0.9551 - recall: 0.9551 - auc: 0.9920 - val_loss: 3.1418 - val_tp: 10581.0000 - val_fp: 9419.0000 - val_tn: 70581.0000 - val_fn: 9419.0000 - val_accuracy: 0.8116 - val_precision: 0.5290 - val_recall: 0.5290 - val_auc: 0.7119
[INFO] saving weights to checkpoints/lstm-epoch-5-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1874 - tp: 78278.0000 - fp: 1722.0000 - tn: 318278.0000 - fn: 1722.0000 - accuracy: 0.9914 - precision: 0.9785 - recall: 0.9785 - auc: 0.9918 - val_loss: 0.0784 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0657 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0542 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0481 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0414 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 4-4/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99774%,30:0.00132%,31:0.00038%,33:0.00019%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:91.76213%,Single Stage Single Point:8.23787%]
[INFO] ** dst:[21:43.35118%,10:20.9409%,8:18.17694%,9:17.52759%,15:0.00132%,22:0.00113%,18:0.00038%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99887%,0:0.00113%]
[INFO] ** i/f_name:[2:99.99868%,3:0.00132%]
[INFO] ** modbus_function_code:[0.02961:99.99774%,-33.760870000000004:0.00226%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99812%,0:0.00226%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99887%,2:0.00113%]
[INFO] ** proto:[0:99.99812%,1:0.00132%,2:0.00056%]
[INFO] ** proxy_src_ip:[18:38.25398%,20:26.03848%,13:18.17694%,6:17.52796%,17:0.00132%,21:0.00038%,16:0.00038%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.03773%,-0.32151:20.94071%,-1.27613:18.17657%,-0.23351:17.5274%,-0.33484:17.31326%,-71.33197:0.00132%,-1.02014:0.00038%,1.45709:0.00038%,-0.08551:0.00038%,-0.24151:0.00038%,14.4699:0.00019%,-1.2708:0.00019%,-71.14798:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-49.275529999999996:0.00019%]
[INFO] ** scada_tag:[3:26.03754%,1:20.94052%,5:18.17657%,4:17.52702%,2:17.31308%,0:0.00527%]
[INFO] ** service:[0.0048200000000000005:99.99793%,-211.73542999999998:0.00132%,-186.43601999999998:0.00038%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.25398%,9:26.03848%,7:18.17694%,1:17.52796%,21:0.00113%,15:0.00038%,4:0.00038%,17:0.00019%,14:0.00019%,8:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1453 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0374 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0329 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0301 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0268 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0247 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0222 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.4724 - val_tp: 18508.0000 - val_fp: 1492.0000 - val_tn: 78508.0000 - val_fn: 1492.0000 - val_accuracy: 0.9702 - val_precision: 0.9254 - val_recall: 0.9254 - val_auc: 0.9715
[INFO] saving weights to checkpoints/lstm-epoch-5-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.6270 - tp: 37713.0000 - fp: 42287.0000 - tn: 277713.0000 - fn: 42287.0000 - accuracy: 0.7886 - precision: 0.4714 - recall: 0.4714 - auc: 0.8674 - val_loss: 0.0961 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 5-5/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99642%,30:0.00245%,37:0.00019%,26:0.00019%,12:0.00019%,9:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:89.39783%,Single Stage Single Point:10.60217%]
[INFO] ** dst:[21:43.36229%,10:20.76779%,8:18.24261%,9:17.62317%,15:0.00245%,22:0.00075%,25:0.00019%,24:0.00019%,6:0.00019%,2:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99793%,0:0.00207%]
[INFO] ** i/f_name:[2:99.99755%,3:0.00245%]
[INFO] ** modbus_function_code:[0.02961:99.99642%,-33.760870000000004:0.00358%]
[INFO] ** modbus_function_description:[7:49.99868%,11:49.99774%,0:0.00358%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99812%,2:0.00188%]
[INFO] ** proto:[0:99.99718%,1:0.00245%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:38.00108%,20:26.12899%,13:18.2428%,6:17.62336%,17:0.00245%,1:0.00038%,21:0.00019%,16:0.00019%,7:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.12861%,-0.32151:20.76741%,-1.27613:18.24261%,-0.23351:17.62298%,-0.33484:17.23367%,-71.33197:0.00245%,-0.24151:0.00038%,1.47576:0.00019%,-49.275529999999996:0.00019%,-1.27347:0.00019%,-61.95768:0.00019%,-1.02014:0.00019%,1.45709:0.00019%,2.22906:0.00019%,14.4699:0.00019%,-64.19493:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:26.12824%,1:20.76722%,5:18.24242%,4:17.62298%,2:17.23367%,0:0.00546%]
[INFO] ** service:[0.0048200000000000005:99.9968%,-211.73542999999998:0.00245%,-183.8612:0.00019%,-211.08346:0.00019%,-211.35747999999998:0.00019%,-186.44547:0.00019%]
[INFO] ** src:[22:38.00108%,9:26.12899%,7:18.2428%,1:17.62336%,21:0.00207%,14:0.00056%,3:0.00038%,16:0.00019%,15:0.00019%,8:0.00019%,4:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1453 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2743 - tp: 73737.0000 - fp: 6263.0000 - tn: 313737.0000 - fn: 6263.0000 - accuracy: 0.9687 - precision: 0.9217 - recall: 0.9217 - auc: 0.9803 - val_loss: 0.9225 - val_tp: 12817.0000 - val_fp: 7183.0000 - val_tn: 72817.0000 - val_fn: 7183.0000 - val_accuracy: 0.8563 - val_precision: 0.6409 - val_recall: 0.6409 - val_auc: 0.9031
[INFO] saving weights to checkpoints/lstm-epoch-5-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8487 - tp: 51350.0000 - fp: 28650.0000 - tn: 291350.0000 - fn: 28650.0000 - accuracy: 0.8568 - precision: 0.6419 - recall: 0.6419 - auc: 0.9122 - val_loss: 0.7853 - val_tp: 12803.0000 - val_fp: 7197.0000 - val_tn: 72803.0000 - val_fn: 7197.0000 - val_accuracy: 0.8561 - val_precision: 0.6402 - val_recall: 0.6402 - val_auc: 0.9057
[INFO] saving weights to checkpoints/lstm-epoch-5-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3084 - tp: 72944.0000 - fp: 7056.0000 - tn: 312944.0000 - fn: 7056.0000 - accuracy: 0.9647 - precision: 0.9118 - recall: 0.9118 - auc: 0.9776 - val_loss: 0.1412 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1226 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1052 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0927 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0813 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 6-6/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99567%,30:0.00339%,31:0.00019%,27:0.00019%,26:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:92.39719%,Single Stage Single Point:7.60281%]
[INFO] ** dst:[21:43.37903%,10:20.72846%,8:18.28288%,9:17.60473%,15:0.00339%,22:0.00038%,25:0.00019%,24:0.00019%,18:0.00019%,12:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.9968%,0:0.0032%]
[INFO] ** i/f_name:[2:99.99661%,3:0.00339%]
[INFO] ** modbus_function_code:[0.02961:99.99567%,-33.760870000000004:0.00433%]
[INFO] ** modbus_function_description:[7:49.99831%,11:49.99737%,0:0.00433%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99567%,1:0.00339%,2:0.00094%]
[INFO] ** proxy_src_ip:[18:37.94219%,20:26.1655%,13:18.28307%,6:17.60492%,17:0.00339%,14:0.00056%,16:0.00019%,11:0.00019%]
[INFO] ** s_port:[1.45442:26.16512%,-0.32151:20.72846%,-1.27613:18.2825%,-0.23351:17.60454%,-0.33484:17.21373%,-71.33197:0.00339%,-71.14798:0.00019%,-1.02014:0.00019%,-64.19493:0.00019%,4.90362:0.00019%,-1.2708:0.00019%,-0.24151:0.00019%,13.431270000000001:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-68.36943000000001:0.00019%]
[INFO] ** scada_tag:[3:26.16493%,1:20.72827%,5:18.28232%,4:17.60417%,2:17.21354%,0:0.00677%]
[INFO] ** service:[0.0048200000000000005:99.99567%,-211.73542999999998:0.00339%,-211.08346:0.00019%,-201.23771000000002:0.00019%,-202.75898:0.00019%,-186.44547:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:37.94219%,9:26.1655%,7:18.28307%,1:17.60492%,14:0.00339%,2:0.00056%,15:0.00019%,10:0.00019%]
[INFO] ** type:[0:99.99906%,1:0.00094%]
[INFO] ** unixtime:1455 (0.27378%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0707 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0650 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0575 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0499 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0443 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0399 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0371 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0337 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6510 - tp: 60504.0000 - fp: 19496.0000 - tn: 300504.0000 - fn: 19496.0000 - accuracy: 0.9025 - precision: 0.7563 - recall: 0.7563 - auc: 0.9505 - val_loss: 0.3427 - val_tp: 16890.0000 - val_fp: 3110.0000 - val_tn: 76890.0000 - val_fn: 3110.0000 - val_accuracy: 0.9378 - val_precision: 0.8445 - val_recall: 0.8445 - val_auc: 0.9832
[INFO] saving weights to checkpoints/lstm-epoch-5-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 7-7/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99511%,30:0.00169%,22:0.00094%,17:0.00075%,26:0.00056%,31:0.00038%,28:0.00019%,27:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:81.6046%,Single Stage Single Point:18.3954%]
[INFO] ** dst:[21:43.36134%,10:20.74408%,8:18.25353%,9:17.63427%,15:0.00169%,22:0.00151%,6:0.00151%,16:0.00075%,24:0.00038%,18:0.00038%,17:0.00038%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99831%,0:0.00169%]
[INFO] ** i/f_name:[2:99.99831%,3:0.00169%]
[INFO] ** modbus_function_code:[0.02961:99.99511%,-33.760870000000004:0.00489%]
[INFO] ** modbus_function_description:[7:49.99831%,11:49.9968%,0:0.00489%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99624%,2:0.00207%,1:0.00169%]
[INFO] ** proxy_src_ip:[18:37.96853%,20:26.13765%,13:18.2539%,6:17.63446%,17:0.00169%,11:0.00075%,1:0.00075%,21:0.00056%,16:0.00056%,14:0.00038%,7:0.00038%,10:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.13671%,-0.32151:20.74408%,-1.27613:18.25334%,-0.23351:17.63409%,-0.33484:17.22445%,-71.33197:0.00169%,-71.14931:0.00094%,-1.02014:0.00056%,-71.14798:0.00056%,1.45709:0.00056%,-0.24151:0.00038%,-1.27347:0.00038%,1.47576:0.00019%,1.46509:0.00019%,14.253910000000001:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,-68.79874000000001:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,6.1115699999999995:0.00019%,-5.08665:0.00019%,-5.1466400000000005:0.00019%]
[INFO] ** scada_tag:[3:26.13633%,1:20.74408%,5:18.25315%,4:17.6339%,2:17.22445%,0:0.00809%]
[INFO] ** service:[0.0048200000000000005:99.99511%,-211.73542999999998:0.00169%,-211.08818:0.00094%,-205.44247:0.00075%,-211.08346:0.00056%,-186.43601999999998:0.00038%,-211.09762999999998:0.00019%,-185.9872:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:37.96853%,9:26.13765%,7:18.2539%,1:17.63446%,14:0.00169%,10:0.00075%,3:0.00075%,15:0.00056%,4:0.00056%,21:0.00038%,2:0.00038%,11:0.00019%,8:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1452 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1566 - tp: 75932.0000 - fp: 4068.0000 - tn: 315932.0000 - fn: 4068.0000 - accuracy: 0.9797 - precision: 0.9492 - recall: 0.9492 - auc: 0.9947 - val_loss: 0.0398 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0697 - tp: 79025.0000 - fp: 975.0000 - tn: 319025.0000 - fn: 975.0000 - accuracy: 0.9951 - precision: 0.9878 - recall: 0.9878 - auc: 0.9979 - val_loss: 0.0329 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2758 - tp: 73809.0000 - fp: 6191.0000 - tn: 313809.0000 - fn: 6191.0000 - accuracy: 0.9690 - precision: 0.9226 - recall: 0.9226 - auc: 0.9856 - val_loss: 1.0007 - val_tp: 12857.0000 - val_fp: 7143.0000 - val_tn: 72857.0000 - val_fn: 7143.0000 - val_accuracy: 0.8571 - val_precision: 0.6428 - val_recall: 0.6428 - val_auc: 0.9382
[INFO] saving weights to checkpoints/lstm-epoch-5-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0796 - tp: 79001.0000 - fp: 999.0000 - tn: 319001.0000 - fn: 999.0000 - accuracy: 0.9950 - precision: 0.9875 - recall: 0.9875 - auc: 0.9981 - val_loss: 0.0399 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0360 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0316 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 8-8/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99699%,30:0.00113%,0:0.00056%,24:0.00019%,23:0.00019%,22:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:94.62262%,Single Stage Single Point:5.37738%]
[INFO] ** dst:[21:43.4272%,10:20.80975%,8:18.17901%,9:17.58027%,22:0.00132%,15:0.00113%,25:0.00056%,19:0.00038%,26:0.00019%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99925%,0:0.00075%]
[INFO] ** i/f_name:[2:99.99887%,3:0.00113%]
[INFO] ** modbus_function_code:[0.02961:99.99699%,-33.760870000000004:0.00282%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99737%,0:0.00282%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99962%,2:0.00038%]
[INFO] ** proto:[0:99.99812%,1:0.00113%,2:0.00075%]
[INFO] ** proxy_src_ip:[18:38.09686%,20:26.14066%,13:18.17826%,6:17.58065%,17:0.00113%,10:0.00113%,16:0.00056%,14:0.00038%,11:0.00019%,5:0.00019%]
[INFO] ** s_port:[1.45442:26.14009%,-0.32151:20.80975%,-1.27613:18.17807%,-0.23351:17.58008%,-0.33484:17.28711%,-71.33197:0.00113%,-15.039579999999999:0.00075%,-1.02014:0.00056%,-64.19493:0.00056%,1.45709:0.00038%,-0.24151:0.00038%,4.66896:0.00038%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-71.14931:0.00019%]
[INFO] ** scada_tag:[3:26.13972%,1:20.80956%,5:18.17807%,4:17.57989%,2:17.28692%,0:0.00583%]
[INFO] ** service:[0.0048200000000000005:99.99774%,-211.73542999999998:0.00113%,-186.44547:0.00056%,-211.07873999999998:0.00038%,-211.08818:0.00019%]
[INFO] ** src:[22:38.09686%,9:26.14066%,7:18.17826%,1:17.58065%,11:0.00113%,14:0.00075%,15:0.00056%,21:0.00038%,2:0.00038%,16:0.00019%,10:0.00019%]
[INFO] ** type:[0:99.99944%,1:0.00038%,2:0.00019%]
[INFO] ** unixtime:1456 (0.27397%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0293 - tp: 79994.0000 - fp: 6.0000 - tn: 319994.0000 - fn: 6.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 0.0260 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0240 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0215 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0181 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0725 - tp: 78864.0000 - fp: 1136.0000 - tn: 318864.0000 - fn: 1136.0000 - accuracy: 0.9943 - precision: 0.9858 - recall: 0.9858 - auc: 0.9970 - val_loss: 0.7114 - val_tp: 16406.0000 - val_fp: 3594.0000 - val_tn: 76406.0000 - val_fn: 3594.0000 - val_accuracy: 0.9281 - val_precision: 0.8203 - val_recall: 0.8203 - val_auc: 0.9628
[INFO] saving weights to checkpoints/lstm-epoch-5-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6299 - tp: 65463.0000 - fp: 14537.0000 - tn: 305463.0000 - fn: 14537.0000 - accuracy: 0.9273 - precision: 0.8183 - recall: 0.8183 - auc: 0.9619 - val_loss: 0.5552 - val_tp: 16381.0000 - val_fp: 3619.0000 - val_tn: 76381.0000 - val_fn: 3619.0000 - val_accuracy: 0.9276 - val_precision: 0.8191 - val_recall: 0.8191 - val_auc: 0.9625
[INFO] saving weights to checkpoints/lstm-epoch-5-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 9-9/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99831%,30:0.00094%,31:0.00038%,26:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:95.26332%,Single Stage Single Point:4.73668%]
[INFO] ** dst:[21:43.36341%,10:20.77776%,8:18.28646%,9:17.56973%,15:0.00094%,22:0.00075%,18:0.00038%,25:0.00019%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99906%,0:0.00094%]
[INFO] ** i/f_name:[2:99.99906%,3:0.00094%]
[INFO] ** modbus_function_code:[0.02961:99.99831%,-33.760870000000004:0.00169%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99849%,0:0.00169%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99981%,2:0.00019%]
[INFO] ** proto:[0:99.99831%,1:0.00094%,2:0.00075%]
[INFO] ** proxy_src_ip:[18:38.01407%,20:26.12767%,13:18.28664%,6:17.56992%,17:0.00094%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.12692%,-0.32151:20.77776%,-1.27613:18.28627%,-0.23351:17.56955%,-0.33484:17.23631%,-71.33197:0.00094%,1.45709:0.00038%,-0.24151:0.00038%,-0.08551:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:26.12654%,1:20.77757%,5:18.28627%,4:17.56936%,2:17.23631%,0:0.00395%]
[INFO] ** service:[0.0048200000000000005:99.99831%,-211.73542999999998:0.00094%,-186.43601999999998:0.00038%,-211.08346:0.00019%,-186.44547:0.00019%]
[INFO] ** src:[22:38.01407%,9:26.12767%,7:18.28664%,1:17.56992%,14:0.00075%,21:0.00019%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1454 (0.27359%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5165 - tp: 65399.0000 - fp: 14601.0000 - tn: 305399.0000 - fn: 14601.0000 - accuracy: 0.9270 - precision: 0.8175 - recall: 0.8175 - auc: 0.9617 - val_loss: 0.4871 - val_tp: 16305.0000 - val_fp: 3695.0000 - val_tn: 76305.0000 - val_fn: 3695.0000 - val_accuracy: 0.9261 - val_precision: 0.8152 - val_recall: 0.8152 - val_auc: 0.9614
[INFO] saving weights to checkpoints/lstm-epoch-5-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2776 - tp: 73121.0000 - fp: 6879.0000 - tn: 313121.0000 - fn: 6879.0000 - accuracy: 0.9656 - precision: 0.9140 - recall: 0.9140 - auc: 0.9820 - val_loss: 0.0934 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0762 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0611 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0521 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0440 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0387 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0336 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 10-10/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99605%,30:0.00188%,31:0.00038%,26:0.00019%,24:0.00019%,23:0.00019%,22:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:94.25174%,Single Stage Single Point:5.74826%]
[INFO] ** dst:[21:43.4097%,10:20.81107%,8:18.22605%,9:17.54904%,15:0.00188%,22:0.00056%,24:0.00038%,19:0.00038%,18:0.00038%,26:0.00019%,25:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99831%,0:0.00169%]
[INFO] ** i/f_name:[2:99.99812%,3:0.00188%]
[INFO] ** modbus_function_code:[0.02961:99.99605%,-33.760870000000004:0.00376%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99868%,11:49.99737%,0:0.00376%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99925%,1:0.00075%]
[INFO] ** proto:[0:99.99718%,1:0.00188%,2:0.00094%]
[INFO] ** proxy_src_ip:[18:38.09234%,20:26.1288%,13:18.22624%,6:17.54847%,17:0.00188%,10:0.00094%,14:0.00038%,21:0.00019%,16:0.00019%,5:0.00019%,2:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.12824%,-0.32151:20.81107%,-1.27613:18.22568%,-0.23351:17.5481%,-0.33484:17.28128%,-71.33197:0.00188%,-10.51843:0.00075%,-0.08551:0.00038%,-1.27347:0.00038%,5.71692:0.00038%,1.47576:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-71.14931:0.00019%,-64.19493:0.00019%,1.45709:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:26.12786%,1:20.81088%,5:18.22568%,4:17.54791%,2:17.28109%,0:0.00659%]
[INFO] ** service:[0.0048200000000000005:99.9968%,-211.73542999999998:0.00188%,-211.07873999999998:0.00038%,-186.43601999999998:0.00038%,-211.08346:0.00019%,-186.44547:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.09234%,9:26.1288%,7:18.22624%,1:17.54847%,14:0.00188%,11:0.00094%,2:0.00038%,17:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,4:0.00019%]
[INFO] ** type:[0:99.99849%,1:0.00132%,2:0.00019%]
[INFO] ** unixtime:1452 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0302 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0266 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0242 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0215 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6961 - tp: 62237.0000 - fp: 17763.0000 - tn: 302237.0000 - fn: 17763.0000 - accuracy: 0.9112 - precision: 0.7780 - recall: 0.7780 - auc: 0.9479 - val_loss: 0.2003 - val_tp: 18766.0000 - val_fp: 1234.0000 - val_tn: 78766.0000 - val_fn: 1234.0000 - val_accuracy: 0.9753 - val_precision: 0.9383 - val_recall: 0.9383 - val_auc: 0.9939
[INFO] saving weights to checkpoints/lstm-epoch-5-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0795 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9990 - val_loss: 0.0445 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0400 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0348 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 11-11/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99887%,31:0.00038%,30:0.00038%,26:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.38298%,10:20.87617%,8:18.20178%,9:17.53662%,22:0.00132%,18:0.00038%,15:0.00038%,25:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99887%,-33.760870000000004:0.00113%]
[INFO] ** modbus_function_description:[7:50.00056%,11:49.99831%,0:0.00113%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99887%,2:0.00075%,1:0.00038%]
[INFO] ** proxy_src_ip:[18:38.14371%,20:26.11582%,13:18.20178%,6:17.53699%,16:0.00056%,17:0.00038%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.11525%,-0.32151:20.87617%,-1.27613:18.20159%,-0.23351:17.53643%,-0.33484:17.26754%,-0.24151:0.00056%,-1.02014:0.00056%,-0.08551:0.00038%,-71.33197:0.00038%,-71.14798:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:26.11488%,1:20.87617%,5:18.2014%,4:17.53605%,2:17.26735%,0:0.00414%]
[INFO] ** service:[0.0048200000000000005:99.99887%,-211.73542999999998:0.00038%,-186.43601999999998:0.00038%,-211.08346:0.00019%,-186.44547:0.00019%]
[INFO] ** src:[22:38.14371%,9:26.11582%,7:18.20178%,1:17.53699%,15:0.00056%,14:0.00038%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1453 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0319 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0284 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0263 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0239 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0222 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0201 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0189 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0172 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0162 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0148 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 12-12/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99774%,30:0.00207%,9:0.00019%]
[INFO] ** classification:[normal:93.19011%,Single Stage Single Point:6.80989%]
[INFO] ** dst:[21:43.39672%,10:20.87542%,8:18.19011%,9:17.53455%,15:0.00207%,22:0.00056%,24:0.00038%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99831%,0:0.00169%]
[INFO] ** i/f_name:[2:99.99793%,3:0.00207%]
[INFO] ** modbus_function_code:[0.02961:99.99774%,-33.760870000000004:0.00226%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99812%,0:0.00226%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99831%,2:0.00169%]
[INFO] ** proto:[0:99.99793%,1:0.00207%]
[INFO] ** proxy_src_ip:[18:38.14729%,20:26.12523%,13:18.1903%,6:17.53474%,17:0.00207%,16:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:26.12466%,-0.32151:20.87542%,-1.27613:18.18974%,-0.23351:17.53436%,-0.33484:17.27187%,-71.33197:0.00207%,-1.27347:0.00038%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,14.4699:0.00019%]
[INFO] ** scada_tag:[3:26.12429%,1:20.87542%,5:18.18974%,4:17.53398%,2:17.27187%,0:0.0047%]
[INFO] ** service:[0.0048200000000000005:99.99774%,-211.73542999999998:0.00207%,-183.8612:0.00019%]
[INFO] ** src:[22:38.14729%,9:26.12523%,7:18.1903%,1:17.53474%,21:0.00169%,14:0.00038%,15:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1453 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0139 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0128 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0121 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0111 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5784 - tp: 63750.0000 - fp: 16250.0000 - tn: 303750.0000 - fn: 16250.0000 - accuracy: 0.9188 - precision: 0.7969 - recall: 0.7969 - auc: 0.9769 - val_loss: 0.1452 - val_tp: 19915.0000 - val_fp: 85.0000 - val_tn: 79915.0000 - val_fn: 85.0000 - val_accuracy: 0.9983 - val_precision: 0.9958 - val_recall: 0.9958 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2569 - tp: 70747.0000 - fp: 9253.0000 - tn: 310747.0000 - fn: 9253.0000 - accuracy: 0.9537 - precision: 0.8843 - recall: 0.8843 - auc: 0.9902 - val_loss: 0.0738 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0252 - tp: 79961.0000 - fp: 39.0000 - tn: 319961.0000 - fn: 39.0000 - accuracy: 0.9998 - precision: 0.9995 - recall: 0.9995 - auc: 1.0000 - val_loss: 0.0146 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 13-13/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99642%,31:0.00075%,26:0.00056%,0:0.00056%,30:0.00038%,22:0.00038%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:85.60292%,Single Stage Single Point:14.39708%]
[INFO] ** dst:[21:43.35457%,10:20.79921%,8:18.28025%,9:17.56183%,22:0.00113%,6:0.00094%,18:0.00075%,25:0.00056%,15:0.00038%,24:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99642%,-33.760870000000004:0.00339%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99868%,11:49.99774%,0:0.00339%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99718%,2:0.00245%,1:0.00038%]
[INFO] ** proxy_src_ip:[18:38.05114%,20:26.10302%,13:18.28043%,6:17.56127%,10:0.00113%,11:0.00094%,16:0.00056%,17:0.00038%,7:0.00038%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.10246%,-0.32151:20.79921%,-1.27613:18.28006%,-0.23351:17.56089%,-0.33484:17.25192%,-9.78512:0.00075%,-64.19493:0.00056%,-1.02014:0.00056%,-71.14798:0.00056%,-0.24151:0.00038%,-71.14931:0.00038%,-0.08551:0.00038%,-71.33197:0.00038%,1.47576:0.00019%,-1.27347:0.00019%,1.46509:0.00019%,-1.2708:0.00019%,-68.79874000000001:0.00019%,6.1115699999999995:0.00019%,14.540560000000001:0.00019%,1.45709:0.00019%]
[INFO] ** scada_tag:[3:26.10208%,1:20.79902%,5:18.28006%,4:17.56089%,2:17.25173%,0:0.00621%]
[INFO] ** service:[0.0048200000000000005:99.99718%,-186.43601999999998:0.00075%,-211.08346:0.00056%,-186.44547:0.00056%,-211.73542999999998:0.00038%,-211.08818:0.00038%,-202.75898:0.00019%]
[INFO] ** src:[22:38.05114%,9:26.10302%,7:18.28043%,1:17.56127%,11:0.00113%,10:0.00094%,15:0.00056%,21:0.00038%,14:0.00038%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1452 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0137 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0108 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0100 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0077 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0072 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0049 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5537 - tp: 64235.0000 - fp: 15765.0000 - tn: 304235.0000 - fn: 15765.0000 - accuracy: 0.9212 - precision: 0.8029 - recall: 0.8029 - auc: 0.9792 - val_loss: 0.1392 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0488 - tp: 78615.0000 - fp: 1385.0000 - tn: 318615.0000 - fn: 1385.0000 - accuracy: 0.9931 - precision: 0.9827 - recall: 0.9827 - auc: 0.9997 - val_loss: 3.3464e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 14-14/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99962%,30:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:94.60248%,Single Stage Single Point:5.39752%]
[INFO] ** dst:[21:43.34629%,10:20.80994%,8:18.26651%,9:17.57576%,22:0.00075%,24:0.00038%,15:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99962%,-33.760870000000004:0.00038%]
[INFO] ** modbus_function_description:[7:50.00075%,11:49.99887%,0:0.00038%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99981%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.04775%,20:26.10905%,13:18.2667%,6:17.57594%,17:0.00019%,16:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:26.10829%,-0.32151:20.80994%,-1.27613:18.26613%,-0.23351:17.57557%,-0.33484:17.23781%,-1.27347:0.00038%,1.45709:0.00038%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,14.4699:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:26.10792%,1:20.80994%,5:18.26595%,4:17.57519%,2:17.23762%,0:0.00339%]
[INFO] ** service:[0.0048200000000000005:99.99962%,-183.8612:0.00019%,-211.73542999999998:0.00019%]
[INFO] ** src:[22:38.04775%,9:26.10905%,7:18.2667%,1:17.57594%,15:0.00019%,14:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1452 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0342 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 5.5827 - val_tp: 12830.0000 - val_fp: 7170.0000 - val_tn: 72830.0000 - val_fn: 7170.0000 - val_accuracy: 0.8566 - val_precision: 0.6415 - val_recall: 0.6415 - val_auc: 0.7759
[INFO] saving weights to checkpoints/lstm-epoch-5-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2249 - tp: 77681.0000 - fp: 2319.0000 - tn: 317681.0000 - fn: 2319.0000 - accuracy: 0.9884 - precision: 0.9710 - recall: 0.9710 - auc: 0.9890 - val_loss: 0.0187 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0183 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0157 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0156 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0134 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0134 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0117 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 15-15/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99624%,30:0.00301%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:89.60764%,Single Stage Multi Point:10.39161%,Single Stage Single Point:0.00075%]
[INFO] ** dst:[21:43.29963%,10:20.774%,8:18.31355%,9:17.60756%,15:0.00301%,22:0.00151%,25:0.00019%,24:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99699%,0:0.00301%]
[INFO] ** i/f_name:[2:99.99699%,3:0.00301%]
[INFO] ** modbus_function_code:[0.02961:99.99624%,-33.760870000000004:0.00376%]
[INFO] ** modbus_function_description:[7:49.99906%,11:49.99718%,0:0.00376%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99718%,2:0.00282%]
[INFO] ** proto:[0:99.99661%,1:0.00301%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:38.00579%,20:26.0684%,13:18.31336%,6:17.60812%,17:0.00301%,16:0.00056%,7:0.00038%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.06765%,-0.32151:20.77381%,-1.27613:18.31317%,-0.23351:17.60737%,-0.33484:17.23198%,-71.33197:0.00301%,-0.24151:0.00056%,-1.02014:0.00056%,1.45709:0.00038%,1.46509:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,-61.95768:0.00019%,10.192739999999999:0.00019%,-64.19493:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:26.06727%,1:20.77362%,5:18.31317%,4:17.60699%,2:17.23179%,0:0.00715%]
[INFO] ** service:[0.0048200000000000005:99.99642%,-211.73542999999998:0.00301%,-211.08346:0.00019%,-205.44247:0.00019%,-186.44547:0.00019%]
[INFO] ** src:[22:38.00579%,9:26.0684%,7:18.31336%,1:17.60812%,21:0.0032%,15:0.00056%,16:0.00019%,14:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1461 (0.27491%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0121 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0103 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0103 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0098 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0091 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0079 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0078 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0067 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.2722 - tp: 48900.0000 - fp: 31100.0000 - tn: 288900.0000 - fn: 31100.0000 - accuracy: 0.8445 - precision: 0.6112 - recall: 0.6112 - auc: 0.7215 - val_loss: 7.5567 - val_tp: 10630.0000 - val_fp: 9370.0000 - val_tn: 70630.0000 - val_fn: 9370.0000 - val_accuracy: 0.8126 - val_precision: 0.5315 - val_recall: 0.5315 - val_auc: 0.6651
[INFO] saving weights to checkpoints/lstm-epoch-5-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 16-16/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (471138, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (471138, 17)

[INFO] analyzing data
[INFO] 471138 rows
[INFO] ** appi_name:[21:99.9983%,30:0.00149%,33:0.00021%]
[INFO] ** classification:[normal:82.32683%,Single Stage Multi Point:17.67317%]
[INFO] ** dst:[21:43.35312%,10:20.80049%,8:18.2507%,9:17.59272%,15:0.00149%,22:0.00127%,24:0.00021%]
[INFO] ** i/f_dir:[1:99.99851%,0:0.00149%]
[INFO] ** i/f_name:[2:99.99851%,3:0.00149%]
[INFO] ** modbus_function_code:[0.02961:99.9983%,-33.760870000000004:0.0017%]
[INFO] ** modbus_function_description:[7:50.00042%,11:49.99788%,0:0.0017%]
[INFO] ** modbus_transaction_id:65536 (13.91015%)
[INFO] ** orig:[0:99.99851%,2:0.00149%]
[INFO] ** proto:[0:99.99851%,1:0.00149%]
[INFO] ** proxy_src_ip:[18:38.0483%,20:26.10551%,13:18.25113%,6:17.59293%,17:0.00149%,16:0.00042%,21:0.00021%]
[INFO] ** s_port:[1.45442:26.10488%,-0.32151:20.80028%,-1.27613:18.2507%,-0.23351:17.59251%,-0.33484:17.24802%,-71.33197:0.00149%,1.45709:0.00042%,-0.24151:0.00042%,-1.02014:0.00042%,-1.27347:0.00021%,1.47576:0.00021%,-49.275529999999996:0.00021%,-1.2708:0.00021%]
[INFO] ** scada_tag:[3:26.10445%,1:20.80028%,5:18.25049%,4:17.59209%,2:17.24781%,0:0.00488%]
[INFO] ** service:[0.0048200000000000005:99.99851%,-211.73542999999998:0.00149%]
[INFO] ** src:[22:38.0483%,9:26.10551%,7:18.25113%,1:17.59293%,21:0.00149%,15:0.00042%,4:0.00021%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1289 (0.27359%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/471138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5667 - tp: 42469.0000 - fp: 37531.0000 - tn: 282469.0000 - fn: 37531.0000 - accuracy: 0.8123 - precision: 0.5309 - recall: 0.5309 - auc: 0.6644 - val_loss: 7.5469 - val_tp: 10641.0000 - val_fp: 9359.0000 - val_tn: 70641.0000 - val_fn: 9359.0000 - val_accuracy: 0.8128 - val_precision: 0.5321 - val_recall: 0.5321 - val_auc: 0.6656
[INFO] saving weights to checkpoints/lstm-epoch-5-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/471138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.3330 - tp: 43625.0000 - fp: 36375.0000 - tn: 283625.0000 - fn: 36375.0000 - accuracy: 0.8181 - precision: 0.5453 - recall: 0.5453 - auc: 0.6772 - val_loss: 0.0035 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/471138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0037 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0028 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/471138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0031 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0022 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/471138
[33m[INFO] loading file 17-17/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571138, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571138, 17)

[INFO] analyzing data
[INFO] 571138 rows
[INFO] ** appi_name:[21:99.9972%,7:0.00053%,26:0.00035%,0:0.00035%,33:0.00018%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:94.5985%,Multi Stage Multi Point:5.4015%]
[INFO] ** dst:[21:43.35257%,10:20.84172%,8:18.20348%,9:17.59942%,22:0.0007%,6:0.00053%,25:0.00035%,16:0.00035%,2:0.00035%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.9972%,-33.760870000000004:0.00263%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99965%,11:49.99755%,0:0.00263%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.47463%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99877%,2:0.00123%]
[INFO] ** proxy_src_ip:[18:38.07871%,20:26.11611%,13:18.20296%,6:17.59925%,10:0.00105%,11:0.00088%,1:0.00035%,21:0.00018%,16:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.11523%,-0.32151:20.84155%,-1.27613:18.20261%,-0.23351:17.59907%,-0.33484:17.23717%,6.0369:0.0007%,1.47576:0.00035%,-71.14798:0.00035%,1.45709:0.00035%,-64.19493:0.00035%,1.46509:0.00018%,-68.79874000000001:0.00018%,-49.275529999999996:0.00018%,-1.27347:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,6.15557:0.00018%,6.06224:0.00018%,8.55414:0.00018%,-3.3787199999999995:0.00018%,-4.3880099999999995:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.11505%,1:20.84137%,5:18.20243%,4:17.59855%,2:17.23717%,0:0.00543%]
[INFO] ** service:[0.0048200000000000005:99.99807%,-211.09762999999998:0.00053%,-211.08346:0.00035%,-186.44547:0.00035%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.07871%,9:26.11611%,7:18.20296%,1:17.59925%,11:0.00105%,10:0.00088%,3:0.00035%,21:0.00018%,15:0.00018%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1560 (0.27314%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0028 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0018 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0024 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0014 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0021 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0012 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.1415 - tp: 74342.0000 - fp: 5658.0000 - tn: 314342.0000 - fn: 5658.0000 - accuracy: 0.9717 - precision: 0.9293 - recall: 0.9293 - auc: 0.9563 - val_loss: 2.9372 - val_tp: 16356.0000 - val_fp: 3644.0000 - val_tn: 76356.0000 - val_fn: 3644.0000 - val_accuracy: 0.9271 - val_precision: 0.8178 - val_recall: 0.8178 - val_auc: 0.8874
[INFO] saving weights to checkpoints/lstm-epoch-5-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9179 - tp: 65522.0000 - fp: 14478.0000 - tn: 305522.0000 - fn: 14478.0000 - accuracy: 0.9276 - precision: 0.8190 - recall: 0.8190 - auc: 0.8884 - val_loss: 2.9227 - val_tp: 16374.0000 - val_fp: 3626.0000 - val_tn: 76374.0000 - val_fn: 3626.0000 - val_accuracy: 0.9275 - val_precision: 0.8187 - val_recall: 0.8187 - val_auc: 0.8877
[INFO] saving weights to checkpoints/lstm-epoch-5-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/571138
[33m[INFO] loading file 18-18/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571138, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571138, 17)

[INFO] analyzing data
[INFO] 571138 rows
[INFO] ** appi_name:[21:99.99825%,30:0.00053%,7:0.00053%,31:0.00018%,27:0.00018%,22:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:82.41371%,Multi Stage Multi Point:17.58629%]
[INFO] ** dst:[21:43.34224%,10:20.83279%,8:18.25881%,9:17.56336%,22:0.0007%,15:0.00053%,24:0.00035%,16:0.00035%,2:0.00035%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99947%,0:0.00053%]
[INFO] ** i/f_name:[2:99.99947%,3:0.00053%]
[INFO] ** modbus_function_code:[0.02961:99.99825%,-33.760870000000004:0.00175%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99825%,0:0.00175%]
[INFO] ** modbus_transaction_id:65536 (11.47463%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99895%,2:0.00053%,1:0.00053%]
[INFO] ** proxy_src_ip:[18:38.08029%,20:26.09527%,13:18.25916%,6:17.56353%,17:0.00053%,11:0.00053%,1:0.00035%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.09457%,-0.32151:20.83279%,-1.27613:18.25863%,-0.23351:17.56318%,-0.33484:17.2475%,-71.33197:0.00053%,-1.27347:0.00035%,1.45709:0.00035%,-0.24151:0.00035%,1.47576:0.00018%,1.46509:0.00018%,3.6236699999999997:0.00018%,-1.2708:0.00018%,-2.48275:0.00018%,6.06224:0.00018%,-3.3787199999999995:0.00018%,8.10082:0.00018%,6.45955:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.09422%,1:20.83262%,5:18.25846%,4:17.56301%,2:17.24732%,0:0.00438%]
[INFO] ** service:[0.0048200000000000005:99.99825%,-211.09762999999998:0.00053%,-211.73542999999998:0.00053%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.08029%,9:26.09527%,7:18.25916%,1:17.56353%,14:0.00053%,10:0.00053%,3:0.00035%,21:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1561 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6953 - tp: 76556.0000 - fp: 3444.0000 - tn: 316556.0000 - fn: 3444.0000 - accuracy: 0.9828 - precision: 0.9570 - recall: 0.9570 - auc: 0.9734 - val_loss: 2.8336 - val_tp: 16485.0000 - val_fp: 3515.0000 - val_tn: 76485.0000 - val_fn: 3515.0000 - val_accuracy: 0.9297 - val_precision: 0.8242 - val_recall: 0.8242 - val_auc: 0.8879
[INFO] saving weights to checkpoints/lstm-epoch-5-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1204 - tp: 49629.0000 - fp: 30371.0000 - tn: 289629.0000 - fn: 30371.0000 - accuracy: 0.8481 - precision: 0.6204 - recall: 0.6204 - auc: 0.7499 - val_loss: 6.1626 - val_tp: 12354.0000 - val_fp: 7646.0000 - val_tn: 72354.0000 - val_fn: 7646.0000 - val_accuracy: 0.8471 - val_precision: 0.6177 - val_recall: 0.6177 - val_auc: 0.7568
[INFO] saving weights to checkpoints/lstm-epoch-5-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1329 - tp: 49566.0000 - fp: 30434.0000 - tn: 289566.0000 - fn: 30434.0000 - accuracy: 0.8478 - precision: 0.6196 - recall: 0.6196 - auc: 0.7497 - val_loss: 6.0989 - val_tp: 12433.0000 - val_fp: 7567.0000 - val_tn: 72433.0000 - val_fn: 7567.0000 - val_accuracy: 0.8487 - val_precision: 0.6216 - val_recall: 0.6216 - val_auc: 0.7588
[INFO] saving weights to checkpoints/lstm-epoch-5-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.5199 - tp: 62535.0000 - fp: 17465.0000 - tn: 302535.0000 - fn: 17465.0000 - accuracy: 0.9127 - precision: 0.7817 - recall: 0.7817 - auc: 0.8564 - val_loss: 5.0719e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0010 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.6288e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/571138
[33m[INFO] loading file 19-19/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571138, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571138, 17)

[INFO] analyzing data
[INFO] 571138 rows
[INFO] ** appi_name:[21:99.99807%,26:0.00035%,0:0.00035%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:87.47063%,Single Stage Multi Point:12.52937%]
[INFO] ** dst:[21:43.39161%,10:20.82439%,8:18.20803%,9:17.57334%,22:0.00123%,6:0.00053%,25:0.00035%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99807%,-33.760870000000004:0.00175%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99807%,0:0.00175%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.47463%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99877%,2:0.00123%]
[INFO] ** proxy_src_ip:[18:38.1118%,20:26.10437%,13:18.20803%,6:17.57334%,10:0.00105%,11:0.00088%,16:0.00053%]
[INFO] ** s_port:[1.45442:26.10332%,-0.32151:20.82439%,-1.27613:18.20768%,-0.23351:17.57316%,-0.33484:17.28742%,-5.20264:0.0007%,1.45709:0.00053%,-1.02014:0.00053%,-64.19493:0.00035%,-71.14798:0.00035%,1.46509:0.00035%,-1.27347:0.00018%,-0.24151:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-71.14931:0.00018%,-68.79874000000001:0.00018%,0.75578:0.00018%]
[INFO] ** scada_tag:[3:26.10297%,1:20.82421%,5:18.20751%,4:17.57299%,2:17.28724%,0:0.00508%]
[INFO] ** service:[0.0048200000000000005:99.99877%,-211.08346:0.00035%,-186.44547:0.00035%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.1118%,9:26.10437%,7:18.20803%,1:17.57334%,11:0.00105%,10:0.00088%,15:0.00053%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1562 (0.27349%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.9273e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.0795e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.9326e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4983e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.8734e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0571e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1684e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9821 - val_tp: 16300.0000 - val_fp: 3700.0000 - val_tn: 76300.0000 - val_fn: 3700.0000 - val_accuracy: 0.9260 - val_precision: 0.8150 - val_recall: 0.8150 - val_auc: 0.8843
[INFO] saving weights to checkpoints/lstm-epoch-5-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.8234 - tp: 31244.0000 - fp: 48756.0000 - tn: 271244.0000 - fn: 48756.0000 - accuracy: 0.7562 - precision: 0.3905 - recall: 0.3905 - auc: 0.6188 - val_loss: 9.8668 - val_tp: 7757.0000 - val_fp: 12243.0000 - val_tn: 67757.0000 - val_fn: 12243.0000 - val_accuracy: 0.7551 - val_precision: 0.3878 - val_recall: 0.3878 - val_auc: 0.6174
[INFO] saving weights to checkpoints/lstm-epoch-5-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/571138
[33m[INFO] loading file 20-20/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571138, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571138, 17)

[INFO] analyzing data
[INFO] 571138 rows
[INFO] ** appi_name:[21:99.99667%,30:0.0028%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:91.62374%,Single Stage Multi Point:8.37626%]
[INFO] ** dst:[21:43.42313%,10:20.8377%,8:18.16006%,9:17.57421%,15:0.0028%,22:0.00123%,24:0.00035%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99755%,0:0.00245%]
[INFO] ** i/f_name:[2:99.9972%,3:0.0028%]
[INFO] ** modbus_function_code:[0.02961:99.99667%,-33.760870000000004:0.00333%]
[INFO] ** modbus_function_description:[7:49.99982%,11:49.99685%,0:0.00333%]
[INFO] ** modbus_transaction_id:65536 (11.47463%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99667%,1:0.0028%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.11303%,20:26.1485%,13:18.16023%,6:17.57474%,17:0.0028%,14:0.00053%,16:0.00018%]
[INFO] ** s_port:[1.45442:26.14762%,-0.32151:20.8377%,-1.27613:18.15971%,-0.23351:17.57404%,-0.33484:17.27533%,-71.33197:0.0028%,1.45709:0.00053%,-0.24151:0.00053%,-1.27347:0.00035%,13.431270000000001:0.00018%,-1.2708:0.00018%,-1.02014:0.00018%,-71.14798:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:26.1471%,1:20.83752%,5:18.15971%,4:17.57369%,2:17.27516%,0:0.00683%]
[INFO] ** service:[0.0048200000000000005:99.99667%,-211.73542999999998:0.0028%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.11303%,9:26.1485%,7:18.16023%,1:17.57474%,14:0.0028%,2:0.00053%,15:0.00018%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1561 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.3828 - tp: 73139.0000 - fp: 6861.0000 - tn: 313139.0000 - fn: 6861.0000 - accuracy: 0.9657 - precision: 0.9142 - recall: 0.9142 - auc: 0.9464 - val_loss: 2.1259e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.8863 - tp: 70639.0000 - fp: 9361.0000 - tn: 310639.0000 - fn: 9361.0000 - accuracy: 0.9532 - precision: 0.8830 - recall: 0.8830 - auc: 0.9269 - val_loss: 2.9223 - val_tp: 16374.0000 - val_fp: 3626.0000 - val_tn: 76374.0000 - val_fn: 3626.0000 - val_accuracy: 0.9275 - val_precision: 0.8187 - val_recall: 0.8187 - val_auc: 0.8867
[INFO] saving weights to checkpoints/lstm-epoch-5-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9571 - tp: 65324.0000 - fp: 14676.0000 - tn: 305324.0000 - fn: 14676.0000 - accuracy: 0.9266 - precision: 0.8166 - recall: 0.8166 - auc: 0.8854 - val_loss: 2.9078 - val_tp: 16392.0000 - val_fp: 3608.0000 - val_tn: 76392.0000 - val_fn: 3608.0000 - val_accuracy: 0.9278 - val_precision: 0.8196 - val_recall: 0.8196 - val_auc: 0.8873
[INFO] saving weights to checkpoints/lstm-epoch-5-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.9562 - tp: 70292.0000 - fp: 9708.0000 - tn: 310292.0000 - fn: 9708.0000 - accuracy: 0.9515 - precision: 0.8787 - recall: 0.8787 - auc: 0.9242 - val_loss: 1.7118e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.1647e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4249e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/571138
[33m[INFO] loading file 21-21/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571136, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571136, 17)

[INFO] analyzing data
[INFO] 571136 rows
[INFO] ** appi_name:[21:99.99615%,30:0.00105%,7:0.00053%,26:0.00035%,22:0.00035%,0:0.00035%,31:0.00018%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:98.93143%,Multi Stage Single Point:1.06857%]
[INFO] ** dst:[21:43.31718%,10:20.98029%,8:18.16275%,9:17.53505%,15:0.00105%,22:0.00088%,24:0.0007%,6:0.0007%,25:0.00035%,16:0.00035%,2:0.00035%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99895%,0:0.00105%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.99615%,-33.760870000000004:0.00368%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99912%,11:49.99702%,0:0.00368%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.47468%)
[INFO] ** orig:[0:99.9993%,2:0.0007%]
[INFO] ** proto:[0:99.99755%,2:0.0014%,1:0.00105%]
[INFO] ** proxy_src_ip:[18:38.30594%,20:25.99136%,13:18.16345%,6:17.53488%,17:0.00105%,10:0.00105%,11:0.00088%,16:0.00053%,1:0.00035%,21:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.99066%,-0.32151:20.97959%,-1.27613:18.16257%,-0.23351:17.5347%,-0.33484:17.32635%,-71.33197:0.00105%,-1.27347:0.0007%,-6.64392:0.0007%,-1.02014:0.00053%,-64.19493:0.00035%,-71.14931:0.00035%,-71.14798:0.00035%,1.47576:0.00035%,1.46509:0.00018%,-1.2708:0.00018%,6.62488:0.00018%,10.15141:0.00018%,-68.79874000000001:0.00018%,7.060860000000001:0.00018%,-3.3787199999999995:0.00018%,-2.2440900000000004:0.00018%,1.45709:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.99013%,1:20.97942%,5:18.1624%,4:17.53435%,2:17.32635%,0:0.00735%]
[INFO] ** service:[0.0048200000000000005:99.99685%,-211.73542999999998:0.00105%,-211.09762999999998:0.00053%,-211.08346:0.00035%,-186.44547:0.00035%,-211.08818:0.00035%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.30594%,9:25.99136%,7:18.16345%,1:17.53488%,11:0.00105%,21:0.00088%,10:0.00088%,15:0.00053%,14:0.00035%,3:0.00035%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1556 (0.27244%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571136
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.7304e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3217e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/571136
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.3988e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2614e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/571136
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.1490e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0688e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/571136
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.9179e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.8494e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/571136
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.6423e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.6218e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/571136
[33m[INFO] loading file 22-22/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (340177, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (340177, 17)

[INFO] analyzing data
[INFO] 340177 rows
[INFO] ** appi_name:[21:99.99265%,30:0.00647%,23:0.00029%,22:0.00029%,18:0.00029%]
[INFO] ** classification:[normal:61.0344%,Multi Stage Single Point:38.9656%]
[INFO] ** dst:[21:43.31392%,10:21.00171%,8:18.09911%,9:17.57673%,15:0.00647%,22:0.00118%,19:0.00059%,26:0.00029%]
[INFO] ** i/f_dir:[1:99.99383%,0:0.00617%]
[INFO] ** i/f_name:[2:99.99353%,3:0.00617%,0:0.00029%]
[INFO] ** modbus_function_code:[0.02961:99.99265%,-33.760870000000004:0.00735%]
[INFO] ** modbus_function_description:[7:49.99721%,11:49.99544%,0:0.00735%]
[INFO] ** modbus_transaction_id:65534 (19.26468%)
[INFO] ** orig:[0:99.995%,2:0.00441%,1:0.00059%]
[INFO] ** proto:[0:99.99324%,1:0.00647%,2:0.00029%]
[INFO] ** proxy_src_ip:[18:38.32622%,20:25.99029%,13:18.09852%,6:17.57761%,17:0.00647%,14:0.00059%,10:0.00029%]
[INFO] ** s_port:[1.45442:25.98941%,-0.32151:21.00171%,-1.27613:18.09852%,-0.23351:17.57673%,-0.33484:17.32451%,-71.33197:0.00647%,1.45709:0.00059%,-0.24151:0.00059%,7.228860000000001:0.00059%,-0.24950999999999998:0.00029%,1.46509:0.00029%,-71.14931:0.00029%]
[INFO] ** scada_tag:[3:25.98912%,1:21.00171%,5:18.09852%,4:17.57644%,2:17.32451%,0:0.0097%]
[INFO] ** service:[0.0048200000000000005:99.99265%,-211.73542999999998:0.00647%,-211.07873999999998:0.00059%,-211.08818:0.00029%]
[INFO] ** src:[22:38.32622%,9:25.99029%,7:18.09852%,1:17.57761%,21:0.00441%,14:0.00206%,2:0.00059%,11:0.00029%]
[INFO] ** type:[0:99.99824%,1:0.00176%]
[INFO] ** unixtime:939 (0.27603%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/340177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.0651 - tp: 69751.0000 - fp: 10249.0000 - tn: 309751.0000 - fn: 10249.0000 - accuracy: 0.9488 - precision: 0.8719 - recall: 0.8719 - auc: 0.9199 - val_loss: 7.5595 - val_tp: 10620.0000 - val_fp: 9380.0000 - val_tn: 70620.0000 - val_fn: 9380.0000 - val_accuracy: 0.8124 - val_precision: 0.5310 - val_recall: 0.5310 - val_auc: 0.7069
[INFO] saving weights to checkpoints/lstm-epoch-5-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/340177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5722 - tp: 42417.0000 - fp: 37583.0000 - tn: 282417.0000 - fn: 37583.0000 - accuracy: 0.8121 - precision: 0.5302 - recall: 0.5302 - auc: 0.7064 - val_loss: 7.5667 - val_tp: 10611.0000 - val_fp: 9389.0000 - val_tn: 70611.0000 - val_fn: 9389.0000 - val_accuracy: 0.8122 - val_precision: 0.5306 - val_recall: 0.5306 - val_auc: 0.7066
[INFO] saving weights to checkpoints/lstm-epoch-5-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/340177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5960 - tp: 42299.0000 - fp: 37701.0000 - tn: 282299.0000 - fn: 37701.0000 - accuracy: 0.8115 - precision: 0.5287 - recall: 0.5287 - auc: 0.7055 - val_loss: 7.5546 - val_tp: 10626.0000 - val_fp: 9374.0000 - val_tn: 70626.0000 - val_fn: 9374.0000 - val_accuracy: 0.8125 - val_precision: 0.5313 - val_recall: 0.5313 - val_auc: 0.7071
[INFO] saving weights to checkpoints/lstm-epoch-5-files-21-22-batch-200000-300000
[INFO] processing batch 300000-400000/340177
[33m[INFO] loading file 23-23/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540177, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540177, 17)

[INFO] analyzing data
[INFO] 540177 rows
[INFO] ** appi_name:[21:99.99889%,31:0.00037%,30:0.00037%,33:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:94.83299%,Multi Stage Single Point:5.16701%]
[INFO] ** dst:[21:43.33098%,10:21.00793%,8:18.13369%,9:17.52518%,22:0.00093%,24:0.00037%,18:0.00037%,15:0.00037%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99963%,3:0.00037%]
[INFO] ** modbus_function_code:[0.02961:99.99889%,-33.760870000000004:0.00111%]
[INFO] ** modbus_function_description:[7:50.00028%,11:49.99861%,0:0.00111%]
[INFO] ** modbus_transaction_id:65536 (12.13232%)
[INFO] ** orig:[0:99.99981%,2:0.00019%]
[INFO] ** proto:[0:99.99907%,2:0.00056%,1:0.00037%]
[INFO] ** proxy_src_ip:[18:38.35613%,20:25.98296%,13:18.13387%,6:17.52537%,16:0.00056%,17:0.00037%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.98241%,-0.32151:21.00774%,-1.27613:18.13332%,-0.23351:17.525%,-0.33484:17.34839%,-1.02014:0.00056%,-1.27347:0.00037%,-0.08551:0.00037%,-71.33197:0.00037%,1.45709:0.00019%,-0.24151:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,1.46509:0.00019%,-64.19493:0.00019%,-0.24950999999999998:0.00019%,-49.275529999999996:0.00019%]
[INFO] ** scada_tag:[3:25.98204%,1:21.00774%,5:18.13313%,4:17.52481%,2:17.3482%,0:0.00407%]
[INFO] ** service:[0.0048200000000000005:99.99907%,-211.73542999999998:0.00037%,-186.43601999999998:0.00037%,-186.44547:0.00019%]
[INFO] ** src:[22:38.35613%,9:25.98296%,7:18.13387%,1:17.52537%,15:0.00056%,21:0.00019%,17:0.00019%,14:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1469 (0.27195%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.6235 - tp: 52089.0000 - fp: 27911.0000 - tn: 292089.0000 - fn: 27911.0000 - accuracy: 0.8604 - precision: 0.6511 - recall: 0.6511 - auc: 0.7819 - val_loss: 5.7356e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.5195e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.3419e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.6296e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8590e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5492e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.0281e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.7891e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7473e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/540177
[33m[INFO] loading file 24-24/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540177, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540177, 17)

[INFO] analyzing data
[INFO] 540177 rows
[INFO] ** appi_name:[21:99.99315%,30:0.00333%,26:0.00056%,31:0.00037%,27:0.00037%,22:0.00037%,0:0.00037%,24:0.00019%,23:0.00019%,19:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,11:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:95.28303%,Multi Stage Single Point:4.71697%]
[INFO] ** dst:[21:43.35671%,10:21.02403%,8:18.10481%,9:17.50722%,15:0.00333%,22:0.00111%,6:0.00074%,25:0.00037%,24:0.00037%,19:0.00037%,18:0.00037%,7:0.00037%,26:0.00019%]
[INFO] ** i/f_dir:[1:99.99685%,0:0.00315%]
[INFO] ** i/f_name:[2:99.99667%,3:0.00333%]
[INFO] ** modbus_function_code:[0.02961:99.99315%,-33.760870000000004:0.00629%,-0.415:0.00019%,0.9188299999999999:0.00019%,0.47422:0.00019%]
[INFO] ** modbus_function_description:[7:49.9975%,11:49.99565%,0:0.00629%,15:0.00019%,10:0.00019%,2:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.13232%)
[INFO] ** orig:[0:99.99963%,1:0.00037%]
[INFO] ** proto:[0:99.99463%,1:0.00333%,2:0.00204%]
[INFO] ** proxy_src_ip:[18:38.40223%,20:25.97926%,13:18.10481%,6:17.50648%,17:0.00333%,10:0.0013%,14:0.00093%,11:0.00093%,21:0.00037%,16:0.00037%]
[INFO] ** s_port:[1.45442:25.97852%,-0.32151:21.02403%,-1.27613:18.10444%,-0.23351:17.50593%,-0.33484:17.37819%,-71.33197:0.00333%,-9.58113:0.00074%,-71.14798:0.00056%,-1.27347:0.00037%,1.45709:0.00037%,-0.24151:0.00037%,-1.02014:0.00037%,-31.55091:0.00037%,7.6315100000000005:0.00037%,-71.14931:0.00037%,-64.19493:0.00037%,-68.79874000000001:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,7.4901800000000005:0.00019%,13.431270000000001:0.00019%,11.862:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:25.97834%,1:21.02403%,5:18.10425%,4:17.50556%,2:17.37801%,0:0.00981%]
[INFO] ** service:[0.0048200000000000005:99.99426%,-211.73542999999998:0.00333%,-211.08346:0.00056%,-211.07873999999998:0.00037%,-202.75898:0.00037%,-186.44547:0.00037%,-186.43601999999998:0.00037%,-211.08818:0.00037%]
[INFO] ** src:[22:38.40223%,9:25.97926%,7:18.10481%,1:17.50648%,14:0.00333%,11:0.0013%,10:0.00093%,2:0.00093%,15:0.00037%,4:0.00037%]
[INFO] ** type:[0:99.9987%,1:0.00093%,2:0.00037%]
[INFO] ** unixtime:1467 (0.27158%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.0591e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4052e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.4168e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0100e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.7293e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6320e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.3754e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5537e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8325 - tp: 75868.0000 - fp: 4132.0000 - tn: 315868.0000 - fn: 4132.0000 - accuracy: 0.9793 - precision: 0.9484 - recall: 0.9484 - auc: 0.9677 - val_loss: 5.7106 - val_tp: 12914.0000 - val_fp: 7086.0000 - val_tn: 72914.0000 - val_fn: 7086.0000 - val_accuracy: 0.8583 - val_precision: 0.6457 - val_recall: 0.6457 - val_auc: 0.7786
[INFO] saving weights to checkpoints/lstm-epoch-5-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/540177
[33m[INFO] loading file 25-25/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540177, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540177, 17)

[INFO] analyzing data
[INFO] 540177 rows
[INFO] ** appi_name:[21:99.9963%,30:0.00111%,17:0.00074%,22:0.00056%,31:0.00037%,28:0.00019%,26:0.00019%,12:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** classification:[normal:64.34669%,Multi Stage Single Point:35.65331%]
[INFO] ** dst:[21:43.31932%,10:21.02292%,8:18.14424%,9:17.50908%,15:0.00111%,22:0.00093%,16:0.00074%,6:0.00074%,18:0.00037%,17:0.00037%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99889%,0:0.00111%]
[INFO] ** i/f_name:[2:99.99889%,3:0.00111%]
[INFO] ** modbus_function_code:[0.02961:99.9963%,-33.760870000000004:0.0037%]
[INFO] ** modbus_function_description:[7:49.99898%,11:49.99732%,0:0.0037%]
[INFO] ** modbus_transaction_id:65536 (12.13232%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99778%,2:0.00111%,1:0.00111%]
[INFO] ** proxy_src_ip:[18:38.38631%,20:25.95575%,13:18.14424%,6:17.50963%,17:0.00111%,1:0.00093%,21:0.00074%,16:0.00037%,14:0.00037%,7:0.00037%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95538%,-0.32151:21.02255%,-1.27613:18.14387%,-0.23351:17.50908%,-0.33484:17.36375%,-71.33197:0.00111%,-71.14931:0.00056%,-0.24151:0.00037%,-1.02014:0.00037%,-49.275529999999996:0.00037%,1.46509:0.00019%,-5.1466400000000005:0.00019%,-1.27347:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,-0.24950999999999998:0.00019%,2.52505:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,6.1115699999999995:0.00019%,-5.08665:0.00019%,1.45709:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:25.95501%,1:21.02237%,5:18.14368%,4:17.50889%,2:17.36357%,0:0.00648%]
[INFO] ** service:[0.0048200000000000005:99.99667%,-211.73542999999998:0.00111%,-205.44247:0.00074%,-211.08818:0.00056%,-186.43601999999998:0.00037%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.38631%,9:25.95575%,7:18.14424%,1:17.50963%,14:0.00111%,3:0.00093%,4:0.00074%,21:0.00037%,15:0.00037%,2:0.00037%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1468 (0.27176%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7421 - tp: 51500.0000 - fp: 28500.0000 - tn: 291500.0000 - fn: 28500.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.7773 - val_loss: 5.7614 - val_tp: 12851.0000 - val_fp: 7149.0000 - val_tn: 72851.0000 - val_fn: 7149.0000 - val_accuracy: 0.8570 - val_precision: 0.6425 - val_recall: 0.6425 - val_auc: 0.7766
[INFO] saving weights to checkpoints/lstm-epoch-5-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7487 - tp: 51467.0000 - fp: 28533.0000 - tn: 291467.0000 - fn: 28533.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.7771 - val_loss: 5.7219 - val_tp: 12900.0000 - val_fp: 7100.0000 - val_tn: 72900.0000 - val_fn: 7100.0000 - val_accuracy: 0.8580 - val_precision: 0.6450 - val_recall: 0.6450 - val_auc: 0.7781
[INFO] saving weights to checkpoints/lstm-epoch-5-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7473 - tp: 51474.0000 - fp: 28526.0000 - tn: 291474.0000 - fn: 28526.0000 - accuracy: 0.8574 - precision: 0.6434 - recall: 0.6434 - auc: 0.7771 - val_loss: 5.7671 - val_tp: 12844.0000 - val_fp: 7156.0000 - val_tn: 72844.0000 - val_fn: 7156.0000 - val_accuracy: 0.8569 - val_precision: 0.6422 - val_recall: 0.6422 - val_auc: 0.7764
[INFO] saving weights to checkpoints/lstm-epoch-5-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7415 - tp: 51503.0000 - fp: 28497.0000 - tn: 291503.0000 - fn: 28497.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.7774 - val_loss: 5.7646 - val_tp: 12847.0000 - val_fp: 7153.0000 - val_tn: 72847.0000 - val_fn: 7153.0000 - val_accuracy: 0.8569 - val_precision: 0.6424 - val_recall: 0.6424 - val_auc: 0.7765
[INFO] saving weights to checkpoints/lstm-epoch-5-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7497 - tp: 51462.0000 - fp: 28538.0000 - tn: 291462.0000 - fn: 28538.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.7770 - val_loss: 5.7421 - val_tp: 12875.0000 - val_fp: 7125.0000 - val_tn: 72875.0000 - val_fn: 7125.0000 - val_accuracy: 0.8575 - val_precision: 0.6438 - val_recall: 0.6438 - val_auc: 0.7773
[INFO] saving weights to checkpoints/lstm-epoch-5-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/540177
[33m[INFO] loading file 26-26/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540177, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540177, 17)

[INFO] analyzing data
[INFO] 540177 rows
[INFO] ** appi_name:[21:99.99852%,7:0.00056%,31:0.00019%,30:0.00019%,22:0.00019%,12:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:64.39963%,Single Stage Single Point:29.56661%,Multi Stage Single Point:6.03376%]
[INFO] ** dst:[21:43.31173%,10:21.08587%,8:18.11647%,9:17.48353%,22:0.00074%,24:0.00037%,16:0.00037%,2:0.00037%,18:0.00019%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99852%,-33.760870000000004:0.00148%]
[INFO] ** modbus_function_description:[7:49.99991%,11:49.99861%,0:0.00148%]
[INFO] ** modbus_transaction_id:65536 (12.13232%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99944%,2:0.00037%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.46721%,20:25.93057%,13:18.11684%,6:17.48353%,1:0.00056%,21:0.00037%,16:0.00037%,17:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.93002%,-0.32151:21.08568%,-1.27613:18.11628%,-0.23351:17.48334%,-0.33484:17.38152%,-1.27347:0.00037%,-1.02014:0.00037%,7.66617:0.00019%,-71.14931:0.00019%,11.57001:0.00019%,-3.3787199999999995:0.00019%,2.52505:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%,1.45709:0.00019%,-49.275529999999996:0.00019%,1.47576:0.00019%,1.46509:0.00019%,14.191239999999999:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.92965%,1:21.08568%,5:18.11628%,4:17.48316%,2:17.38152%,0:0.0037%]
[INFO] ** service:[0.0048200000000000005:99.9987%,-211.09762999999998:0.00056%,-211.35747999999998:0.00019%,-211.73542999999998:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.46721%,9:25.93057%,7:18.11684%,1:17.48353%,3:0.00056%,15:0.00037%,4:0.00037%,21:0.00019%,14:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1466 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7383 - tp: 51519.0000 - fp: 28481.0000 - tn: 291519.0000 - fn: 28481.0000 - accuracy: 0.8576 - precision: 0.6440 - recall: 0.6440 - auc: 0.7775 - val_loss: 5.5418 - val_tp: 12874.0000 - val_fp: 7126.0000 - val_tn: 72874.0000 - val_fn: 7126.0000 - val_accuracy: 0.8575 - val_precision: 0.6437 - val_recall: 0.6437 - val_auc: 0.7773
[INFO] saving weights to checkpoints/lstm-epoch-5-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2939 - tp: 58731.0000 - fp: 21269.0000 - tn: 298731.0000 - fn: 21269.0000 - accuracy: 0.8937 - precision: 0.7341 - recall: 0.7341 - auc: 0.8992 - val_loss: 0.0175 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1126 - tp: 77892.0000 - fp: 2108.0000 - tn: 317892.0000 - fn: 2108.0000 - accuracy: 0.9895 - precision: 0.9736 - recall: 0.9736 - auc: 0.9923 - val_loss: 3.1635e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0729 - tp: 79123.0000 - fp: 877.0000 - tn: 319123.0000 - fn: 877.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9932 - val_loss: 9.7702e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0738 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9928 - val_loss: 4.2188e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/540177
[33m[INFO] loading file 27-27/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (480307, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (480307, 17)

[INFO] analyzing data
[INFO] 480307 rows
[INFO] ** appi_name:[21:99.99938%,30:0.00062%]
[INFO] ** classification:[normal:64.33802%,Single Stage Single Point:35.66198%]
[INFO] ** dst:[21:43.27149%,10:21.06465%,8:18.18733%,9:17.47487%,22:0.00083%,15:0.00062%,24:0.00021%]
[INFO] ** i/f_dir:[1:99.99979%,0:0.00021%]
[INFO] ** i/f_name:[2:99.99938%,3:0.00062%]
[INFO] ** modbus_function_code:[0.02961:99.99938%,-33.760870000000004:0.00062%]
[INFO] ** modbus_function_description:[7:50.00031%,11:49.99906%,0:0.00062%]
[INFO] ** modbus_transaction_id:65536 (13.64461%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99938%,1:0.00062%]
[INFO] ** proxy_src_ip:[18:38.40585%,20:25.93092%,13:18.18712%,6:17.47507%,17:0.00062%,16:0.00042%]
[INFO] ** s_port:[1.45442:25.93029%,-0.32151:21.06465%,-1.27613:18.18691%,-0.23351:17.47466%,-0.33484:17.3412%,-71.33197:0.00062%,-1.02014:0.00042%,-1.27347:0.00021%,1.45709:0.00021%,-0.24950999999999998:0.00021%,1.46509:0.00021%,1.47576:0.00021%,-0.24151:0.00021%]
[INFO] ** scada_tag:[3:25.92987%,1:21.06444%,5:18.1867%,4:17.47445%,2:17.34099%,0:0.00354%]
[INFO] ** service:[0.0048200000000000005:99.99938%,-211.73542999999998:0.00062%]
[INFO] ** src:[22:38.40585%,9:25.93092%,7:18.18712%,1:17.47507%,14:0.00062%,15:0.00042%]
[INFO] ** type:[0:99.99958%,1:0.00042%]
[INFO] ** unixtime:1305 (0.2717%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/480307
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0752 - tp: 79045.0000 - fp: 955.0000 - tn: 319045.0000 - fn: 955.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9926 - val_loss: 4.2917e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/480307
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0738 - tp: 79049.0000 - fp: 951.0000 - tn: 319049.0000 - fn: 951.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9925 - val_loss: 2.1160e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/480307
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0677 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9929 - val_loss: 8.1983e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/480307
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0641 - tp: 79131.0000 - fp: 869.0000 - tn: 319131.0000 - fn: 869.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9932 - val_loss: 9.6238e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/480307
[33m[INFO] loading file 28-28/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (414223, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (414223, 17)

[INFO] analyzing data
[INFO] 414223 rows
[INFO] ** appi_name:[21:99.99276%,30:0.00169%,17:0.00121%,22:0.00097%,7:0.00097%,31:0.00072%,26:0.00072%,28:0.00024%,27:0.00024%,8:0.00024%,0:0.00024%]
[INFO] ** classification:[normal:64.31922%,Single Stage Single Point:35.68078%]
[INFO] ** dst:[21:43.28272%,10:21.02901%,8:18.20203%,9:17.47851%,6:0.00193%,16:0.00169%,18:0.00121%,15:0.00072%,22:0.00048%,17:0.00048%,2:0.00048%,25:0.00024%,7:0.00024%,0:0.00024%]
[INFO] ** i/f_dir:[1:99.99928%,0:0.00072%]
[INFO] ** i/f_name:[2:99.99928%,3:0.00072%]
[INFO] ** modbus_function_code:[0.02961:99.99276%,-33.760870000000004:0.00724%]
[INFO] ** modbus_function_description:[7:49.9965%,11:49.99626%,0:0.00724%]
[INFO] ** modbus_transaction_id:65536 (15.82143%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99565%,2:0.00362%,1:0.00072%]
[INFO] ** proxy_src_ip:[18:38.35132%,20:25.96041%,13:18.20227%,6:17.47875%,1:0.00193%,17:0.00169%,14:0.00145%,7:0.00121%,21:0.00072%,0:0.00024%]
[INFO] ** s_port:[1.45442:25.96017%,-0.32151:21.02901%,-1.27613:18.20203%,-0.23351:17.47827%,-0.33484:17.32231%,-71.14798:0.00097%,-71.14931:0.00097%,-71.33197:0.00072%,-0.08551:0.00048%,-0.24151:0.00048%,7.66617:0.00024%,-58.035180000000004:0.00024%,-1.2708:0.00024%,-64.19493:0.00024%,-5.1466400000000005:0.00024%,13.431270000000001:0.00024%,11.57001:0.00024%,14.4699:0.00024%,1.47576:0.00024%,14.191239999999999:0.00024%,-5.08665:0.00024%,10.192739999999999:0.00024%,-3.3787199999999995:0.00024%,6.1115699999999995:0.00024%,2.05573:0.00024%,-43.76509:0.00024%,2.52505:0.00024%,11.862:0.00024%,-58.032509999999995:0.00024%]
[INFO] ** scada_tag:[3:25.95993%,1:21.02877%,5:18.20203%,4:17.47778%,2:17.32231%,0:0.00917%]
[INFO] ** service:[0.0048200000000000005:99.99276%,-205.44247:0.00121%,-186.43601999999998:0.00121%,-211.09762999999998:0.00097%,-211.08346:0.00097%,-211.08818:0.00097%,-211.73542999999998:0.00072%,-186.44547:0.00024%,-183.8612:0.00024%,-185.9872:0.00024%,-211.35747999999998:0.00024%,-202.75898:0.00024%]
[INFO] ** src:[22:38.35132%,9:25.96041%,7:18.20227%,1:17.47875%,3:0.00217%,2:0.00145%,21:0.00121%,4:0.00097%,14:0.00072%,8:0.00048%,17:0.00024%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1126 (0.27183%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/414223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0627 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9931 - val_loss: 1.3867e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/414223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0640 - tp: 79075.0000 - fp: 925.0000 - tn: 319075.0000 - fn: 925.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9927 - val_loss: 5.3924e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/414223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0597 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9968 - val_loss: 1.3360e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/414223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0568 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 3.9945e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-27-28-batch-300000-400000
[INFO] processing batch 400000-500000/414223
[33m[INFO] loading file 29-29/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (514223, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (514223, 17)

[INFO] analyzing data
[INFO] 514223 rows
[INFO] ** appi_name:[21:99.99883%,30:0.00058%,26:0.00019%,9:0.00019%,3:0.00019%]
[INFO] ** classification:[normal:64.38666%,Single Stage Single Point:35.61334%]
[INFO] ** dst:[21:43.32809%,10:21.05721%,8:18.14602%,9:17.46694%,22:0.00058%,15:0.00058%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99942%,3:0.00058%]
[INFO] ** modbus_function_code:[0.02961:99.99883%,-33.760870000000004:0.00117%]
[INFO] ** modbus_function_description:[7:49.9999%,11:49.99893%,0:0.00117%]
[INFO] ** modbus_transaction_id:65536 (12.74467%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99922%,1:0.00058%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.43955%,20:25.94594%,13:18.14641%,6:17.46674%,17:0.00058%,21:0.00019%,16:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.94536%,-0.32151:21.05701%,-1.27613:18.14602%,-0.23351:17.46674%,-0.33484:17.38254%,-71.33197:0.00058%,1.45709:0.00039%,-71.14798:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-61.95768:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.94497%,1:21.05682%,5:18.14602%,4:17.46635%,2:17.38254%,0:0.00331%]
[INFO] ** service:[0.0048200000000000005:99.99903%,-211.73542999999998:0.00058%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.43955%,9:25.94594%,7:18.14641%,1:17.46674%,14:0.00058%,15:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1397 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0529 - tp: 79130.0000 - fp: 870.0000 - tn: 319130.0000 - fn: 870.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 3.3247e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0509 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.3606e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0462 - tp: 79152.0000 - fp: 848.0000 - tn: 319152.0000 - fn: 848.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 7.1304e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0452 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 4.7730e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0405 - tp: 79142.0000 - fp: 858.0000 - tn: 319142.0000 - fn: 858.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 6.3198e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/514223
[33m[INFO] loading file 30-30/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (514223, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (514223, 17)

[INFO] analyzing data
[INFO] 514223 rows
[INFO] ** appi_name:[21:99.99747%,30:0.00175%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.36779%,Single Stage Single Point:35.63221%]
[INFO] ** dst:[21:43.34034%,10:21.02434%,8:18.14407%,9:17.48774%,15:0.00175%,22:0.00078%,24:0.00039%,25:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99825%,0:0.00175%]
[INFO] ** i/f_name:[2:99.99825%,3:0.00175%]
[INFO] ** modbus_function_code:[0.02961:99.99747%,-33.760870000000004:0.00253%]
[INFO] ** modbus_function_description:[7:49.9999%,11:49.99757%,0:0.00253%]
[INFO] ** modbus_transaction_id:65536 (12.74467%)
[INFO] ** orig:[0:99.99903%,2:0.00058%,1:0.00039%]
[INFO] ** proto:[0:99.99786%,1:0.00175%,2:0.00039%]
[INFO] ** proxy_src_ip:[18:38.36487%,20:25.99961%,13:18.14446%,6:17.48833%,17:0.00175%,7:0.00039%,16:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.99942%,-0.32151:21.02415%,-1.27613:18.14388%,-0.23351:17.48755%,-0.33484:17.34073%,-71.33197:0.00175%,-0.24151:0.00058%,-1.27347:0.00039%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,10.192739999999999:0.00019%,1.47576:0.00019%,-61.95768:0.00019%,-1.02014:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.99903%,1:21.02415%,5:18.14368%,4:17.48735%,2:17.34053%,0:0.00525%]
[INFO] ** service:[0.0048200000000000005:99.99767%,-211.73542999999998:0.00175%,-186.44547:0.00019%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.36487%,9:25.99961%,7:18.14446%,1:17.48833%,14:0.00117%,21:0.00097%,16:0.00019%,15:0.00019%,8:0.00019%]
[INFO] ** type:[0:99.99922%,1:0.00078%]
[INFO] ** unixtime:1398 (0.27187%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0396 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 2.9432e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0357 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.7948e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0304 - tp: 79172.0000 - fp: 828.0000 - tn: 319172.0000 - fn: 828.0000 - accuracy: 0.9959 - precision: 0.9897 - recall: 0.9897 - auc: 0.9999 - val_loss: 8.0606e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0302 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.3836e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0262 - tp: 79139.0000 - fp: 861.0000 - tn: 319139.0000 - fn: 861.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.2890e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/514223
[33m[INFO] loading file 31-31/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (514223, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (514223, 17)

[INFO] analyzing data
[INFO] 514223 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.37674%,Single Stage Single Point:35.62326%]
[INFO] ** dst:[21:43.31642%,10:21.05915%,8:18.12521%,9:17.49786%,22:0.00097%,24:0.00039%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.0001%,11:49.9999%]
[INFO] ** modbus_transaction_id:65536 (12.74467%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.40688%,20:25.96947%,13:18.1254%,6:17.49786%,16:0.00039%]
[INFO] ** s_port:[1.45442:25.96869%,-0.32151:21.05915%,-1.27613:18.12502%,-0.23351:17.49766%,-0.33484:17.34773%,-1.27347:0.00039%,1.45709:0.00039%,-1.02014:0.00039%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.96831%,1:21.05896%,5:18.12482%,4:17.49747%,2:17.34753%,0:0.00292%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.40688%,9:25.96947%,7:18.1254%,1:17.49786%,15:0.00039%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1397 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0236 - tp: 79163.0000 - fp: 837.0000 - tn: 319163.0000 - fn: 837.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.2299e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0234 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1953e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0220 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0215 - tp: 79113.0000 - fp: 887.0000 - tn: 319113.0000 - fn: 887.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/514223
[33m[INFO] loading file 32-32/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (514223, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (514223, 17)

[INFO] analyzing data
[INFO] 514223 rows
[INFO] ** appi_name:[21:99.99611%,30:0.00331%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.37674%,Single Stage Single Point:35.62326%]
[INFO] ** dst:[21:43.3205%,10:21.05118%,8:18.16002%,9:17.46344%,15:0.00331%,22:0.00097%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99708%,0:0.00292%]
[INFO] ** i/f_name:[2:99.99669%,3:0.00331%]
[INFO] ** modbus_function_code:[0.02961:99.99611%,-33.760870000000004:0.00389%]
[INFO] ** modbus_function_description:[7:49.99893%,11:49.99718%,0:0.00389%]
[INFO] ** modbus_transaction_id:65536 (12.74467%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99611%,1:0.00331%,2:0.00058%]
[INFO] ** proxy_src_ip:[18:38.40999%,20:25.96208%,13:18.15983%,6:17.46402%,17:0.00331%,14:0.00058%,16:0.00019%]
[INFO] ** s_port:[1.45442:25.9615%,-0.32151:21.05118%,-1.27613:18.15963%,-0.23351:17.46324%,-0.33484:17.35881%,-71.33197:0.00331%,-0.24151:0.00058%,-71.14798:0.00019%,11.862:0.00019%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,13.431270000000001:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.96111%,1:21.05098%,5:18.15963%,4:17.46285%,2:17.35881%,0:0.00661%]
[INFO] ** service:[0.0048200000000000005:99.99611%,-211.73542999999998:0.00331%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.40999%,9:25.96208%,7:18.15983%,1:17.46402%,14:0.00331%,2:0.00058%,15:0.00019%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1396 (0.27148%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79149.0000 - fp: 851.0000 - tn: 319149.0000 - fn: 851.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79138.0000 - fp: 862.0000 - tn: 319138.0000 - fn: 862.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79137.0000 - fp: 863.0000 - tn: 319137.0000 - fn: 863.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/514223
[33m[INFO] loading file 33-33/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (514223, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (514223, 17)

[INFO] analyzing data
[INFO] 514223 rows
[INFO] ** appi_name:[21:99.99669%,30:0.00117%,17:0.00078%,22:0.00058%,31:0.00019%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.40008%,Single Stage Single Point:35.59992%]
[INFO] ** dst:[21:43.33587%,10:21.05915%,8:18.10985%,9:17.49008%,22:0.00136%,15:0.00117%,16:0.00078%,6:0.00078%,24:0.00039%,17:0.00039%,18:0.00019%]
[INFO] ** i/f_dir:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name:[2:99.99883%,3:0.00117%]
[INFO] ** modbus_function_code:[0.02961:99.99669%,-33.760870000000004:0.00331%]
[INFO] ** modbus_function_description:[7:49.99951%,11:49.99718%,0:0.00331%]
[INFO] ** modbus_transaction_id:65536 (12.74467%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99786%,1:0.00117%,2:0.00097%]
[INFO] ** proxy_src_ip:[18:38.42516%,20:25.97064%,13:18.10985%,6:17.49027%,17:0.00117%,16:0.00078%,1:0.00078%,21:0.00039%,14:0.00039%,7:0.00039%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.96986%,-0.32151:21.05915%,-1.27613:18.10946%,-0.23351:17.48988%,-0.33484:17.36601%,-71.33197:0.00117%,-1.02014:0.00078%,-71.14931:0.00058%,1.45709:0.00039%,-1.27347:0.00039%,-71.14798:0.00019%,-58.035180000000004:0.00019%,-5.1466400000000005:0.00019%,-0.24151:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-5.08665:0.00019%,-0.24950999999999998:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:25.96947%,1:21.05915%,5:18.10926%,4:17.48969%,2:17.36601%,0:0.00642%]
[INFO] ** service:[0.0048200000000000005:99.99669%,-211.73542999999998:0.00117%,-205.44247:0.00078%,-211.08818:0.00058%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.42516%,9:25.97064%,7:18.10985%,1:17.49027%,14:0.00117%,15:0.00078%,3:0.00078%,21:0.00039%,4:0.00039%,2:0.00039%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1399 (0.27206%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0196 - tp: 79164.0000 - fp: 836.0000 - tn: 319164.0000 - fn: 836.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79116.0000 - fp: 884.0000 - tn: 319116.0000 - fn: 884.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/514223
[33m[INFO] loading file 34-34/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (355656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (355656, 17)

[INFO] analyzing data
[INFO] 355656 rows
[INFO] ** appi_name:[21:99.99747%,7:0.00084%,30:0.00056%,31:0.00028%,22:0.00028%,8:0.00028%,6:0.00028%]
[INFO] ** classification:[normal:64.33014%,Single Stage Single Point:35.66986%]
[INFO] ** dst:[21:43.26934%,10:21.05771%,8:18.21564%,9:17.45423%,22:0.00084%,16:0.00056%,15:0.00056%,2:0.00056%,18:0.00028%,6:0.00028%]
[INFO] ** i/f_dir:[1:99.99944%,0:0.00056%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.99747%,-33.760870000000004:0.00253%]
[INFO] ** modbus_function_description:[7:49.99916%,11:49.99831%,0:0.00253%]
[INFO] ** modbus_transaction_id:65536 (18.42679%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99888%,2:0.00056%,1:0.00056%]
[INFO] ** proxy_src_ip:[18:38.3795%,20:25.94754%,13:18.21564%,6:17.45479%,1:0.00084%,21:0.00056%,17:0.00056%,14:0.00028%,7:0.00028%]
[INFO] ** s_port:[1.45442:25.94726%,-0.32151:21.05743%,-1.27613:18.21564%,-0.23351:17.45394%,-0.33484:17.32208%,-0.24151:0.00084%,-71.33197:0.00056%,-3.0613900000000003:0.00028%,-3.3787199999999995:0.00028%,14.191239999999999:0.00028%,1.47576:0.00028%,11.57001:0.00028%,-49.275529999999996:0.00028%,-71.14931:0.00028%,7.66617:0.00028%]
[INFO] ** scada_tag:[3:25.94698%,1:21.05715%,5:18.21535%,4:17.45366%,2:17.32208%,0:0.00478%]
[INFO] ** service:[0.0048200000000000005:99.99775%,-211.09762999999998:0.00084%,-211.73542999999998:0.00056%,-186.43601999999998:0.00028%,-211.35747999999998:0.00028%,-211.08818:0.00028%]
[INFO] ** src:[22:38.3795%,9:25.94754%,7:18.21564%,1:17.45479%,3:0.00084%,14:0.00056%,4:0.00056%,21:0.00028%,2:0.00028%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:966 (0.27161%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/355656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/355656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/355656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79134.0000 - fp: 866.0000 - tn: 319134.0000 - fn: 866.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/355656
[33m[INFO] loading file 35-35/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555656, 17)

[INFO] analyzing data
[INFO] 555656 rows
[INFO] ** appi_name:[21:99.99892%,30:0.00108%]
[INFO] ** classification:[normal:64.36716%,Single Stage Single Point:35.63284%]
[INFO] ** dst:[21:43.32771%,10:21.03694%,8:18.15782%,9:17.47538%,22:0.00108%,15:0.00108%]
[INFO] ** i/f_dir:[1:99.9991%,0:0.0009%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99892%,-33.760870000000004:0.00108%]
[INFO] ** modbus_function_description:[7:50.00036%,11:49.99856%,0:0.00108%]
[INFO] ** modbus_transaction_id:65536 (11.79435%)
[INFO] ** orig:[0:99.99964%,1:0.00036%]
[INFO] ** proto:[0:99.99892%,1:0.00108%]
[INFO] ** proxy_src_ip:[18:38.39714%,20:25.96804%,13:18.15746%,6:17.47556%,17:0.00108%,16:0.00072%]
[INFO] ** s_port:[1.45442:25.96751%,-0.32151:21.03694%,-1.27613:18.15746%,-0.23351:17.4752%,-0.33484:17.3602%,-71.33197:0.00108%,-1.02014:0.00072%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.96715%,1:21.03694%,5:18.15728%,4:17.47484%,2:17.3602%,0:0.0036%]
[INFO] ** service:[0.0048200000000000005:99.99892%,-211.73542999999998:0.00108%]
[INFO] ** src:[22:38.39714%,9:25.96804%,7:18.15746%,1:17.47556%,14:0.00108%,15:0.00072%]
[INFO] ** type:[0:99.9991%,1:0.0009%]
[INFO] ** unixtime:1508 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79124.0000 - fp: 876.0000 - tn: 319124.0000 - fn: 876.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79134.0000 - fp: 866.0000 - tn: 319134.0000 - fn: 866.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79054.0000 - fp: 946.0000 - tn: 319054.0000 - fn: 946.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/555656
[33m[INFO] loading file 36-36/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555656, 17)

[INFO] analyzing data
[INFO] 555656 rows
[INFO] ** appi_name:[21:99.99856%,30:0.00072%,31:0.00036%,33:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.36158%,Single Stage Single Point:35.63842%]
[INFO] ** dst:[21:43.33149%,10:21.02776%,8:18.14828%,9:17.48996%,22:0.0009%,15:0.00072%,24:0.00036%,18:0.00036%,25:0.00018%]
[INFO] ** i/f_dir:[1:99.99928%,0:0.00072%]
[INFO] ** i/f_name:[2:99.99928%,3:0.00072%]
[INFO] ** modbus_function_code:[0.02961:99.99856%,-33.760870000000004:0.00144%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99838%,0:0.00144%]
[INFO] ** modbus_transaction_id:65536 (11.79435%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99874%,1:0.00072%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.37734%,20:25.98208%,13:18.14846%,6:17.4905%,17:0.00072%,21:0.00018%,16:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.98154%,-0.32151:21.02758%,-1.27613:18.14792%,-0.23351:17.48978%,-0.33484:17.34976%,-71.33197:0.00072%,-0.24151:0.00054%,-0.08551:0.00036%,-1.27347:0.00036%,1.45709:0.00018%,1.47576:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,1.46509:0.00018%,-64.19493:0.00018%,-0.24950999999999998:0.00018%,-49.275529999999996:0.00018%]
[INFO] ** scada_tag:[3:25.98118%,1:21.0274%,5:18.14774%,4:17.4896%,2:17.34958%,0:0.0045%]
[INFO] ** service:[0.0048200000000000005:99.99874%,-211.73542999999998:0.00072%,-186.43601999999998:0.00036%,-186.44547:0.00018%]
[INFO] ** src:[22:38.37734%,9:25.98208%,7:18.14846%,1:17.4905%,14:0.00072%,17:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1509 (0.27157%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79052.0000 - fp: 948.0000 - tn: 319052.0000 - fn: 948.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79160.0000 - fp: 840.0000 - tn: 319160.0000 - fn: 840.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 2.4507e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/555656
[33m[INFO] loading file 37-37/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555656, 17)

[INFO] analyzing data
[INFO] 555656 rows
[INFO] ** appi_name:[21:99.99892%,30:0.00072%,26:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:64.37436%,Single Stage Single Point:35.62564%]
[INFO] ** dst:[21:43.33311%,10:21.03928%,8:18.13856%,9:17.48708%,22:0.00072%,15:0.00072%,24:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99928%,3:0.00072%]
[INFO] ** modbus_function_code:[0.02961:99.99892%,-33.760870000000004:0.00108%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99874%,0:0.00108%]
[INFO] ** modbus_transaction_id:65536 (11.79435%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9991%,1:0.00072%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.38634%,20:25.9864%,13:18.13856%,6:17.48726%,17:0.00072%,16:0.00036%,21:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:25.98586%,-0.32151:21.03928%,-1.27613:18.1382%,-0.23351:17.4869%,-0.33484:17.34706%,-71.33197:0.00072%,-1.02014:0.00036%,-71.14798:0.00018%,-1.27347:0.00018%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.2708:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.98568%,1:21.03928%,5:18.13802%,4:17.48672%,2:17.34688%,0:0.00342%]
[INFO] ** service:[0.0048200000000000005:99.99892%,-211.73542999999998:0.00072%,-183.8612:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.38634%,9:25.9864%,7:18.13856%,1:17.48726%,14:0.00072%,15:0.00036%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1509 (0.27157%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79123.0000 - fp: 877.0000 - tn: 319123.0000 - fn: 877.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79076.0000 - fp: 924.0000 - tn: 319076.0000 - fn: 924.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79130.0000 - fp: 870.0000 - tn: 319130.0000 - fn: 870.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/555656
[33m[INFO] loading file 38-38/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555656, 17)

[INFO] analyzing data
[INFO] 555656 rows
[INFO] ** appi_name:[21:99.9991%,30:0.00018%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.40981%,Single Stage Single Point:35.59019%]
[INFO] ** dst:[21:43.31889%,10:21.08895%,8:18.09681%,9:17.49356%,22:0.0009%,25:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99982%,0:0.00018%]
[INFO] ** i/f_name:[2:99.99982%,3:0.00018%]
[INFO] ** modbus_function_code:[0.02961:99.9991%,-33.760870000000004:0.0009%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.99946%,0:0.0009%]
[INFO] ** modbus_transaction_id:65536 (11.79435%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99946%,2:0.00036%,1:0.00018%]
[INFO] ** proxy_src_ip:[18:38.45689%,20:25.95149%,13:18.09663%,6:17.49392%,7:0.00036%,17:0.00018%,16:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95077%,-0.32151:21.08877%,-1.27613:18.09645%,-0.23351:17.49338%,-0.33484:17.36812%,-0.24151:0.00036%,1.45709:0.00036%,-64.19493:0.00018%,10.192739999999999:0.00018%,-1.02014:0.00018%,-71.14798:0.00018%,-61.95768:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-71.33197:0.00018%]
[INFO] ** scada_tag:[3:25.95041%,1:21.08877%,5:18.09645%,4:17.4932%,2:17.36812%,0:0.00306%]
[INFO] ** service:[0.0048200000000000005:99.99928%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%,-211.73542999999998:0.00018%]
[INFO] ** src:[22:38.45689%,9:25.95149%,7:18.09663%,1:17.49392%,21:0.00036%,16:0.00018%,15:0.00018%,14:0.00018%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1510 (0.27175%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79149.0000 - fp: 851.0000 - tn: 319149.0000 - fn: 851.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79152.0000 - fp: 848.0000 - tn: 319152.0000 - fn: 848.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79076.0000 - fp: 924.0000 - tn: 319076.0000 - fn: 924.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/555656
[33m[INFO] loading file 39-39/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555656, 17)

[INFO] analyzing data
[INFO] 555656 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.40208%,Single Stage Single Point:35.59792%]
[INFO] ** dst:[21:43.32177%,10:21.07941%,8:18.13316%,9:17.46458%,22:0.0009%,24:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99982%]
[INFO] ** modbus_transaction_id:65536 (11.79435%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.44807%,20:25.95347%,13:18.13334%,6:17.46458%,16:0.00054%]
[INFO] ** s_port:[1.45442:25.95293%,-0.32151:21.07941%,-1.27613:18.13298%,-0.23351:17.4644%,-0.33484:17.36866%,-1.02014:0.00054%,-1.27347:0.00018%,1.45709:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.2708:0.00018%]
[INFO] ** scada_tag:[3:25.95257%,1:21.07923%,5:18.1328%,4:17.4644%,2:17.36848%,0:0.00252%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.44807%,9:25.95347%,7:18.13334%,1:17.46458%,15:0.00054%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1508 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79145.0000 - fp: 855.0000 - tn: 319145.0000 - fn: 855.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79071.0000 - fp: 929.0000 - tn: 319071.0000 - fn: 929.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/555656
[33m[INFO] loading file 40-40/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555656, 17)

[INFO] analyzing data
[INFO] 555656 rows
[INFO] ** appi_name:[21:99.9964%,30:0.00306%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.33801%,Single Stage Single Point:35.66199%]
[INFO] ** dst:[21:43.29621%,10:21.03694%,8:18.19615%,9:17.46602%,15:0.00306%,22:0.0009%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99712%,0:0.00288%]
[INFO] ** i/f_name:[2:99.99694%,3:0.00306%]
[INFO] ** modbus_function_code:[0.02961:99.9964%,-33.760870000000004:0.0036%]
[INFO] ** modbus_function_description:[7:49.99928%,11:49.99712%,0:0.0036%]
[INFO] ** modbus_transaction_id:65536 (11.79435%)
[INFO] ** orig:[0:99.99964%,1:0.00036%]
[INFO] ** proto:[0:99.9964%,1:0.00306%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.35665%,20:25.9774%,13:18.19597%,6:17.46638%,17:0.00306%,14:0.00054%]
[INFO] ** s_port:[1.45442:25.9765%,-0.32151:21.03694%,-1.27613:18.19579%,-0.23351:17.46584%,-0.33484:17.31971%,-71.33197:0.00306%,1.45709:0.00054%,-0.24151:0.00036%,-71.14798:0.00018%,-1.27347:0.00018%,11.862:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,13.431270000000001:0.00018%]
[INFO] ** scada_tag:[3:25.97614%,1:21.03676%,5:18.19561%,4:17.46548%,2:17.31953%,0:0.00648%]
[INFO] ** service:[0.0048200000000000005:99.9964%,-211.73542999999998:0.00306%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.35665%,9:25.9774%,7:18.19597%,1:17.46638%,14:0.00306%,2:0.00054%]
[INFO] ** type:[0:99.9991%,1:0.0009%]
[INFO] ** unixtime:1511 (0.27193%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0217 - tp: 79035.0000 - fp: 965.0000 - tn: 319035.0000 - fn: 965.0000 - accuracy: 0.9952 - precision: 0.9879 - recall: 0.9879 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79063.0000 - fp: 937.0000 - tn: 319063.0000 - fn: 937.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79088.0000 - fp: 912.0000 - tn: 319088.0000 - fn: 912.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/555656
[33m[INFO] loading file 41-41/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (495814, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (495814, 17)

[INFO] analyzing data
[INFO] 495814 rows
[INFO] ** appi_name:[21:99.99657%,30:0.00101%,22:0.00081%,17:0.00081%,32:0.0002%,28:0.0002%,26:0.0002%,7:0.0002%]
[INFO] ** classification:[normal:64.38786%,Single Stage Single Point:35.61214%]
[INFO] ** dst:[21:43.32008%,10:21.06354%,8:18.14108%,9:17.47087%,16:0.00101%,15:0.00101%,6:0.00101%,22:0.00061%,24:0.0004%,17:0.0004%]
[INFO] ** i/f_dir:[1:99.99899%,0:0.00101%]
[INFO] ** i/f_name:[2:99.99899%,3:0.00101%]
[INFO] ** modbus_function_code:[0.02961:99.99657%,-33.760870000000004:0.00343%]
[INFO] ** modbus_function_description:[7:49.99899%,11:49.99758%,0:0.00343%]
[INFO] ** modbus_transaction_id:65536 (13.21786%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99778%,2:0.00121%,1:0.00101%]
[INFO] ** proxy_src_ip:[18:38.43256%,20:25.95126%,13:18.14128%,6:17.47107%,17:0.00101%,1:0.00081%,21:0.0004%,16:0.0004%,14:0.0004%,0:0.0004%,7:0.0002%,2:0.0002%]
[INFO] ** s_port:[1.45442:25.95086%,-0.32151:21.06354%,-1.27613:18.14067%,-0.23351:17.47066%,-0.33484:17.36901%,-71.33197:0.00101%,-71.14931:0.00081%,-1.02014:0.0004%,-1.27347:0.0004%,-71.14798:0.0002%,-0.24151:0.0002%,-58.035180000000004:0.0002%,-1.2708:0.0002%,-5.1466400000000005:0.0002%,1.47576:0.0002%,1.46509:0.0002%,-64.19226:0.0002%,-5.08665:0.0002%,-0.24950999999999998:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** scada_tag:[3:25.95066%,1:21.06354%,5:18.14067%,4:17.47046%,2:17.36901%,0:0.00565%]
[INFO] ** service:[0.0048200000000000005:99.99657%,-211.73542999999998:0.00101%,-205.44247:0.00081%,-211.08818:0.00081%,89.64175:0.0002%,-211.09762999999998:0.0002%,-211.08346:0.0002%,-185.9872:0.0002%]
[INFO] ** src:[22:38.43256%,9:25.95126%,7:18.14128%,1:17.47107%,14:0.00101%,3:0.00081%,15:0.0004%,8:0.0004%,4:0.0004%,2:0.0004%,21:0.0002%,17:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1345 (0.27127%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/495814
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79135.0000 - fp: 865.0000 - tn: 319135.0000 - fn: 865.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 2.1612e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/495814
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/495814
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/495814
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79088.0000 - fp: 912.0000 - tn: 319088.0000 - fn: 912.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 8.0603e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/495814
[33m[INFO] loading file 42-42/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (439328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (439328, 17)

[INFO] analyzing data
[INFO] 439328 rows
[INFO] ** appi_name:[21:99.99203%,30:0.00228%,17:0.00114%,31:0.00091%,26:0.00091%,7:0.00091%,22:0.00068%,28:0.00023%,27:0.00023%,9:0.00023%,8:0.00023%,0:0.00023%]
[INFO] ** classification:[normal:64.38037%,Single Stage Single Point:35.61963%]
[INFO] ** dst:[21:43.31843%,10:21.05329%,8:18.17139%,9:17.44778%,16:0.00205%,6:0.00182%,18:0.00114%,22:0.00091%,15:0.00091%,2:0.00091%,17:0.00046%,25:0.00023%,24:0.00023%,7:0.00023%,0:0.00023%]
[INFO] ** i/f_dir:[1:99.99909%,0:0.00091%]
[INFO] ** i/f_name:[2:99.99909%,3:0.00091%]
[INFO] ** modbus_function_code:[0.02961:99.99203%,-33.760870000000004:0.00797%]
[INFO] ** modbus_function_description:[7:49.99704%,11:49.99499%,0:0.00797%]
[INFO] ** modbus_transaction_id:65536 (14.91733%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99568%,2:0.00341%,1:0.00091%]
[INFO] ** proxy_src_ip:[18:38.41003%,20:25.96192%,13:18.17184%,6:17.44778%,17:0.00228%,1:0.00205%,14:0.00137%,21:0.00091%,7:0.00068%,16:0.00046%,0:0.00046%,2:0.00023%]
[INFO] ** s_port:[1.45442:25.96147%,-0.32151:21.05329%,-1.27613:18.17139%,-0.23351:17.44756%,-0.33484:17.35674%,-71.14798:0.00091%,-71.33197:0.00091%,-71.14931:0.00091%,11.57001:0.00046%,-0.08551:0.00046%,-3.3787199999999995:0.00046%,-1.02014:0.00046%,-5.1466400000000005:0.00023%,-0.24151:0.00023%,13.431270000000001:0.00023%,0.31847:0.00023%,-1.2708:0.00023%,-58.035180000000004:0.00023%,7.66617:0.00023%,-64.19493:0.00023%,1.47576:0.00023%,14.4699:0.00023%,15.912510000000001:0.00023%,14.191239999999999:0.00023%,7.9608300000000005:0.00023%,-5.08665:0.00023%,10.192739999999999:0.00023%,-3.0613900000000003:0.00023%,1.45709:0.00023%,2.05573:0.00023%,-43.76509:0.00023%,11.862:0.00023%,-1.27347:0.00023%,-58.032509999999995:0.00023%]
[INFO] ** scada_tag:[3:25.96101%,1:21.05329%,5:18.17116%,4:17.44756%,2:17.35651%,0:0.01047%]
[INFO] ** service:[0.0048200000000000005:99.99203%,-211.09762999999998:0.00159%,-205.44247:0.00114%,-186.43601999999998:0.00114%,-211.08346:0.00091%,-211.73542999999998:0.00091%,-211.08818:0.00091%,-211.35747999999998:0.00046%,-186.44547:0.00023%,-183.8612:0.00023%,-185.9872:0.00023%,-202.75898:0.00023%]
[INFO] ** src:[22:38.41003%,9:25.96192%,7:18.17184%,1:17.44778%,3:0.00273%,2:0.00159%,4:0.00114%,21:0.00091%,14:0.00091%,15:0.00046%,8:0.00046%,17:0.00023%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1192 (0.27132%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/439328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79152.0000 - fp: 848.0000 - tn: 319152.0000 - fn: 848.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/439328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79151.0000 - fp: 849.0000 - tn: 319151.0000 - fn: 849.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/439328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/439328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79089.0000 - fp: 911.0000 - tn: 319089.0000 - fn: 911.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-41-42-batch-300000-400000
[INFO] processing batch 400000-500000/439328
[33m[INFO] loading file 43-43/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99926%,30:0.00056%,26:0.00019%]
[INFO] ** classification:[normal:64.39569%,Single Stage Single Point:35.60431%]
[INFO] ** dst:[21:43.32688%,10:21.06714%,8:18.13182%,9:17.4723%,22:0.00093%,15:0.00056%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.99926%,-33.760870000000004:0.00074%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99907%,0:0.00074%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99926%,1:0.00056%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.41577%,20:25.97881%,13:18.13201%,6:17.4723%,17:0.00056%,16:0.00037%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.97807%,-0.32151:21.06714%,-1.27613:18.13164%,-0.23351:17.47193%,-0.33484:17.34863%,-71.33197:0.00056%,1.45709:0.00037%,1.47576:0.00037%,-1.02014:0.00037%,-71.14798:0.00019%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.9777%,1:21.06714%,5:18.13145%,4:17.47156%,2:17.34844%,0:0.00371%]
[INFO] ** service:[0.0048200000000000005:99.99926%,-211.73542999999998:0.00056%,-211.08346:0.00019%]
[INFO] ** src:[22:38.41577%,9:25.97881%,7:18.13201%,1:17.4723%,14:0.00056%,15:0.00037%,3:0.00019%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1467 (0.27201%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79082.0000 - fp: 918.0000 - tn: 319082.0000 - fn: 918.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79093.0000 - fp: 907.0000 - tn: 319093.0000 - fn: 907.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 44-44/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99815%,30:0.00074%,31:0.00056%,0:0.00037%,22:0.00019%]
[INFO] ** classification:[normal:64.38123%,Single Stage Single Point:35.61877%]
[INFO] ** dst:[21:43.33411%,10:21.04397%,8:18.15611%,9:17.46247%,22:0.00111%,15:0.00074%,18:0.00056%,25:0.00037%,24:0.00037%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99926%,0:0.00074%]
[INFO] ** i/f_name:[2:99.99926%,3:0.00074%]
[INFO] ** modbus_function_code:[0.02961:99.99815%,-33.760870000000004:0.00185%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99796%,0:0.00185%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99815%,2:0.00111%,1:0.00074%]
[INFO] ** proxy_src_ip:[18:38.42226%,20:25.95638%,13:18.1563%,6:17.46303%,17:0.00074%,7:0.00037%,16:0.00019%,5:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95563%,-0.32151:21.04397%,-1.27613:18.15574%,-0.23351:17.46229%,-0.33484:17.37829%,-71.33197:0.00074%,-0.24151:0.00056%,-0.08551:0.00037%,-64.19493:0.00037%,-1.27347:0.00037%,1.45709:0.00037%,-1.02014:0.00019%,-1.2708:0.00019%,1.47576:0.00019%,-71.14931:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,4.42897:0.00019%]
[INFO] ** scada_tag:[3:25.95508%,1:21.04397%,5:18.15574%,4:17.46192%,2:17.37811%,0:0.00519%]
[INFO] ** service:[0.0048200000000000005:99.99815%,-211.73542999999998:0.00074%,-186.43601999999998:0.00056%,-186.44547:0.00037%,-211.08818:0.00019%]
[INFO] ** src:[22:38.42226%,9:25.95638%,7:18.1563%,1:17.46303%,14:0.00074%,21:0.00037%,17:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1463 (0.27126%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79082.0000 - fp: 918.0000 - tn: 319082.0000 - fn: 918.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79106.0000 - fp: 894.0000 - tn: 319106.0000 - fn: 894.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79044.0000 - fp: 956.0000 - tn: 319044.0000 - fn: 956.0000 - accuracy: 0.9952 - precision: 0.9880 - recall: 0.9880 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 45-45/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99907%,30:0.00056%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.41813%,Single Stage Single Point:35.58187%]
[INFO] ** dst:[21:43.3254%,10:21.09032%,8:18.11884%,9:17.46321%,22:0.0013%,15:0.00056%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.99907%,-33.760870000000004:0.00093%]
[INFO] ** modbus_function_description:[7:50.00074%,11:49.99833%,0:0.00093%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99926%,1:0.00056%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.49012%,20:25.92634%,13:18.11866%,6:17.46358%,17:0.00056%,16:0.00037%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.9256%,-0.32151:21.09032%,-1.27613:18.11866%,-0.23351:17.46303%,-0.33484:17.3998%,1.45709:0.00056%,-71.33197:0.00056%,-0.24151:0.00037%,-1.02014:0.00037%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,14.4699:0.00019%]
[INFO] ** scada_tag:[3:25.92504%,1:21.09013%,5:18.11866%,4:17.46303%,2:17.39962%,0:0.00352%]
[INFO] ** service:[0.0048200000000000005:99.99907%,-211.73542999999998:0.00056%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.49012%,9:25.92634%,7:18.11866%,1:17.46358%,14:0.00056%,15:0.00037%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1463 (0.27126%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79106.0000 - fp: 894.0000 - tn: 319106.0000 - fn: 894.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79064.0000 - fp: 936.0000 - tn: 319064.0000 - fn: 936.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 46-46/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99815%,30:0.00111%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.42925%,Single Stage Single Point:35.57075%]
[INFO] ** dst:[21:43.35136%,10:21.07512%,8:18.09808%,9:17.47267%,22:0.00111%,15:0.00111%,25:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99907%,0:0.00093%]
[INFO] ** i/f_name:[2:99.99889%,3:0.00111%]
[INFO] ** modbus_function_code:[0.02961:99.99815%,-33.760870000000004:0.00185%]
[INFO] ** modbus_function_description:[11:49.99907%,7:49.99907%,0:0.00185%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:99.99963%,1:0.00037%]
[INFO] ** proto:[0:99.99852%,1:0.00111%,2:0.00037%]
[INFO] ** proxy_src_ip:[18:38.45452%,20:25.97195%,13:18.09808%,6:17.47323%,17:0.00111%,16:0.00037%,7:0.00037%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.97158%,-0.32151:21.07493%,-1.27613:18.09789%,-0.23351:17.47248%,-0.33484:17.37959%,-71.33197:0.00111%,-0.24151:0.00056%,-1.02014:0.00037%,-71.14798:0.00019%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-61.95768:0.00019%,-1.2708:0.00019%,10.192739999999999:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:25.97121%,1:21.07474%,5:18.09771%,4:17.47211%,2:17.37959%,0:0.00464%]
[INFO] ** service:[0.0048200000000000005:99.99833%,-211.73542999999998:0.00111%,-211.08346:0.00019%,-205.44247:0.00019%,-186.44547:0.00019%]
[INFO] ** src:[22:38.45452%,9:25.97195%,7:18.09808%,1:17.47323%,14:0.00111%,21:0.00037%,15:0.00037%,16:0.00019%,8:0.00019%]
[INFO] ** type:[0:99.99907%,1:0.00093%]
[INFO] ** unixtime:1466 (0.27182%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79060.0000 - fp: 940.0000 - tn: 319060.0000 - fn: 940.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79129.0000 - fp: 871.0000 - tn: 319129.0000 - fn: 871.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79067.0000 - fp: 933.0000 - tn: 319067.0000 - fn: 933.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 47-47/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99944%,33:0.00019%,26:0.00019%,17:0.00019%]
[INFO] ** classification:[normal:64.39458%,Single Stage Single Point:35.60542%]
[INFO] ** dst:[21:43.30704%,10:21.0855%,8:18.12719%,9:17.47786%,22:0.00167%,24:0.00037%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99944%,-33.760870000000004:0.00056%]
[INFO] ** modbus_function_description:[7:50.00111%,11:49.99833%,0:0.00056%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99981%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.45712%,20:25.93617%,13:18.12756%,6:17.47823%,16:0.00037%,7:0.00037%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.93524%,-0.32151:21.0855%,-1.27613:18.127%,-0.23351:17.47768%,-0.33484:17.37162%,1.45709:0.00056%,-0.24151:0.00056%,-1.27347:0.00037%,-1.02014:0.00037%,-71.14798:0.00019%,-61.95635:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,10.192739999999999:0.00019%]
[INFO] ** scada_tag:[3:25.93468%,1:21.08531%,5:18.12682%,4:17.47749%,2:17.37143%,0:0.00426%]
[INFO] ** service:[0.0048200000000000005:99.99963%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.45712%,9:25.93617%,7:18.12756%,1:17.47823%,21:0.00037%,15:0.00037%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1464 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79091.0000 - fp: 909.0000 - tn: 319091.0000 - fn: 909.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79137.0000 - fp: 863.0000 - tn: 319137.0000 - fn: 863.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79074.0000 - fp: 926.0000 - tn: 319074.0000 - fn: 926.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 48-48/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99666%,30:0.0026%,33:0.00019%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.42313%,Single Stage Single Point:35.57687%]
[INFO] ** dst:[21:43.33485%,10:21.08439%,8:18.11106%,9:17.46544%,15:0.0026%,22:0.00093%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99778%,0:0.00222%]
[INFO] ** i/f_name:[2:99.9974%,3:0.0026%]
[INFO] ** modbus_function_code:[0.02961:99.99666%,-33.760870000000004:0.00334%]
[INFO] ** modbus_function_description:[7:49.99889%,11:49.99778%,0:0.00334%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99685%,1:0.0026%,2:0.00056%]
[INFO] ** proxy_src_ip:[18:38.4586%,20:25.96083%,13:18.11143%,6:17.46544%,17:0.0026%,14:0.00056%,16:0.00037%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.96045%,-0.32151:21.08439%,-1.27613:18.11106%,-0.23351:17.46525%,-0.33484:17.37421%,-71.33197:0.0026%,-1.02014:0.00037%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,1.45709:0.00019%,-61.95635:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,13.431270000000001:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.96008%,1:21.08439%,5:18.11106%,4:17.46525%,2:17.37403%,0:0.00519%]
[INFO] ** service:[0.0048200000000000005:99.99685%,-211.73542999999998:0.0026%,-211.08346:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.4586%,9:25.96083%,7:18.11143%,1:17.46544%,14:0.0026%,2:0.00056%,15:0.00037%,8:0.00019%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1463 (0.27126%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79053.0000 - fp: 947.0000 - tn: 319053.0000 - fn: 947.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79142.0000 - fp: 858.0000 - tn: 319142.0000 - fn: 858.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79145.0000 - fp: 855.0000 - tn: 319145.0000 - fn: 855.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79088.0000 - fp: 912.0000 - tn: 319088.0000 - fn: 912.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 49-49/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99722%,30:0.00093%,17:0.00074%,26:0.00037%,22:0.00037%,28:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.37048%,Single Stage Single Point:35.62952%]
[INFO] ** dst:[21:43.30964%,10:21.05639%,8:18.13813%,9:17.4914%,22:0.0013%,15:0.00093%,16:0.00074%,6:0.00074%,24:0.00037%,17:0.00037%]
[INFO] ** i/f_dir:[1:99.99907%,0:0.00093%]
[INFO] ** i/f_name:[2:99.99907%,3:0.00093%]
[INFO] ** modbus_function_code:[0.02961:99.99722%,-33.760870000000004:0.00278%]
[INFO] ** modbus_function_description:[7:49.99944%,11:49.99778%,0:0.00278%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99833%,1:0.00093%,2:0.00074%]
[INFO] ** proxy_src_ip:[18:38.41762%,20:25.94914%,13:18.13813%,6:17.49195%,17:0.00093%,1:0.00074%,14:0.00056%,21:0.00037%,16:0.00037%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.9484%,-0.32151:21.05639%,-1.27613:18.13776%,-0.23351:17.49121%,-0.33484:17.36123%,-71.33197:0.00093%,-0.24151:0.00056%,-1.27347:0.00037%,-1.02014:0.00037%,1.45709:0.00037%,-71.14931:0.00037%,-71.14798:0.00037%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-5.1466400000000005:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,-5.08665:0.00019%]
[INFO] ** scada_tag:[3:25.94803%,1:21.0562%,5:18.13757%,4:17.49084%,2:17.36123%,0:0.00612%]
[INFO] ** service:[0.0048200000000000005:99.99722%,-211.73542999999998:0.00093%,-205.44247:0.00074%,-211.08346:0.00037%,-211.08818:0.00037%,-211.09762999999998:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.41762%,9:25.94914%,7:18.13813%,1:17.49195%,14:0.00093%,3:0.00074%,2:0.00056%,15:0.00037%,4:0.00037%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1465 (0.27163%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79083.0000 - fp: 917.0000 - tn: 319083.0000 - fn: 917.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79148.0000 - fp: 852.0000 - tn: 319148.0000 - fn: 852.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 50-50/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (389310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (389310, 17)

[INFO] analyzing data
[INFO] 389310 rows
[INFO] ** appi_name:[21:99.99743%,30:0.00103%,7:0.00077%,31:0.00026%,22:0.00026%,8:0.00026%]
[INFO] ** classification:[normal:64.30197%,Single Stage Single Point:35.69803%]
[INFO] ** dst:[21:43.25884%,10:21.04005%,8:18.22301%,9:17.47476%,15:0.00103%,22:0.00051%,16:0.00051%,2:0.00051%,24:0.00026%,18:0.00026%,6:0.00026%]
[INFO] ** i/f_dir:[1:99.99897%,0:0.00103%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.99743%,-33.760870000000004:0.00257%]
[INFO] ** modbus_function_description:[11:49.99872%,7:49.99872%,0:0.00257%]
[INFO] ** modbus_transaction_id:65536 (16.83389%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99846%,1:0.00103%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.36583%,20:25.93332%,13:18.22327%,6:17.47476%,17:0.00103%,1:0.00077%,21:0.00026%,16:0.00026%,14:0.00026%,7:0.00026%]
[INFO] ** s_port:[1.45442:25.9328%,-0.32151:21.04005%,-1.27613:18.22275%,-0.23351:17.47476%,-0.33484:17.32578%,-71.33197:0.00103%,-3.3787199999999995:0.00026%,4.33564:0.00026%,15.912510000000001:0.00026%,7.9608300000000005:0.00026%,1.46509:0.00026%,1.45709:0.00026%,-1.27347:0.00026%,-71.14931:0.00026%,-1.02014:0.00026%,-1.2708:0.00026%,0.31847:0.00026%]
[INFO] ** scada_tag:[3:25.93255%,1:21.03979%,5:18.2225%,4:17.47476%,2:17.32552%,0:0.00488%]
[INFO] ** service:[0.0048200000000000005:99.99743%,-211.73542999999998:0.00103%,-211.09762999999998:0.00077%,-186.43601999999998:0.00026%,-211.35747999999998:0.00026%,-211.08818:0.00026%]
[INFO] ** src:[22:38.36583%,9:25.93332%,7:18.22327%,1:17.47476%,14:0.00103%,3:0.00077%,21:0.00026%,15:0.00026%,4:0.00026%,2:0.00026%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1058 (0.27176%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/389310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79167.0000 - fp: 833.0000 - tn: 319167.0000 - fn: 833.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/389310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79078.0000 - fp: 922.0000 - tn: 319078.0000 - fn: 922.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/389310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/389310
[33m[INFO] epoch 6/10[0m
[33m[INFO] loading file 1-1/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99338%,22:0.00102%,30:0.00102%,7:0.00068%,17:0.00068%,31:0.00051%,26:0.00051%,23:0.00034%,18:0.00034%,0:0.00034%,24:0.00017%,27:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,28:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:77.01872%,Single Stage Single Point:22.98128%]
[INFO] ** dst:[21:43.27043%,10:21.02968%,8:18.17481%,9:17.51794%,6:0.00153%,22:0.00102%,16:0.00102%,15:0.00102%,18:0.00051%,26:0.00034%,25:0.00034%,19:0.00034%,17:0.00034%,2:0.00034%,24:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.99898%,0:0.00102%]
[INFO] ** i/f_name:[2:99.99898%,3:0.00102%]
[INFO] ** modbus_function_code:[0.02961:99.99338%,-33.760870000000004:0.00645%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99762%,11:49.99576%,0:0.00645%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99644%,2:0.00255%,1:0.00102%]
[INFO] ** proxy_src_ip:[18:38.38896%,20:25.91081%,13:18.17498%,6:17.51828%,11:0.00119%,10:0.00119%,1:0.00119%,17:0.00102%,14:0.00085%,21:0.00051%,7:0.00051%,16:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.9103%,-0.32151:21.029%,-1.27613:18.17464%,-0.23351:17.51778%,-0.33484:17.35996%,-71.33197:0.00102%,-71.14931:0.00102%,-2.1481:0.00068%,-71.14798:0.00051%,-0.24151:0.00051%,-64.19493:0.00034%,-2.42942:0.00034%,4.44364:0.00034%,-1.02014:0.00034%,1.47576:0.00017%,6.1115699999999995:0.00017%,-1.27347:0.00017%,10.67005:0.00017%,4.29964:0.00017%,-5.08665:0.00017%,-3.3787199999999995:0.00017%,1.45709:0.00017%,-68.79874000000001:0.00017%,2.05573:0.00017%,-5.1466400000000005:0.00017%,-43.76509:0.00017%,14.253910000000001:0.00017%,4.076980000000001:0.00017%,-58.032509999999995:0.00017%,-58.035180000000004:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,0.31847:0.00017%]
[INFO] ** scada_tag:[3:25.91013%,1:21.02883%,5:18.17431%,4:17.51761%,2:17.35979%,0:0.00933%]
[INFO] ** service:[0.0048200000000000005:99.99406%,-211.73542999999998:0.00102%,-211.08818:0.00102%,-211.09762999999998:0.00068%,-205.44247:0.00068%,-211.07873999999998:0.00068%,-211.08346:0.00051%,-186.43601999999998:0.00051%,-186.44547:0.00034%,-185.9872:0.00017%,-211.35747999999998:0.00017%,-202.75898:0.00017%]
[INFO] ** src:[22:38.38896%,9:25.91081%,7:18.17498%,1:17.51828%,11:0.00119%,10:0.00119%,3:0.00119%,14:0.00102%,2:0.00085%,21:0.00051%,4:0.00051%,15:0.00034%,8:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1599 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79145.0000 - fp: 855.0000 - tn: 319145.0000 - fn: 855.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 3.0479 - val_tp: 16218.0000 - val_fp: 3782.0000 - val_tn: 76218.0000 - val_fn: 3782.0000 - val_accuracy: 0.9244 - val_precision: 0.8109 - val_recall: 0.8109 - val_auc: 0.8818
[INFO] saving weights to checkpoints/lstm-epoch-6-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3758 - tp: 77859.0000 - fp: 2141.0000 - tn: 317859.0000 - fn: 2141.0000 - accuracy: 0.9893 - precision: 0.9732 - recall: 0.9732 - auc: 0.9845 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0072 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5230 - tp: 74753.0000 - fp: 5247.0000 - tn: 314753.0000 - fn: 5247.0000 - accuracy: 0.9738 - precision: 0.9344 - recall: 0.9344 - auc: 0.9779 - val_loss: 0.9472 - val_tp: 10573.0000 - val_fp: 9427.0000 - val_tn: 70573.0000 - val_fn: 9427.0000 - val_accuracy: 0.8115 - val_precision: 0.5286 - val_recall: 0.5286 - val_auc: 0.9445
[INFO] saving weights to checkpoints/lstm-epoch-6-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5620 - tp: 42475.0000 - fp: 37525.0000 - tn: 282475.0000 - fn: 37525.0000 - accuracy: 0.8124 - precision: 0.5309 - recall: 0.5309 - auc: 0.9406 - val_loss: 0.3597 - val_tp: 10611.0000 - val_fp: 9389.0000 - val_tn: 70611.0000 - val_fn: 9389.0000 - val_accuracy: 0.8122 - val_precision: 0.5306 - val_recall: 0.5306 - val_auc: 0.9449
[INFO] saving weights to checkpoints/lstm-epoch-6-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 2-2/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99864%,30:0.00051%,7:0.00051%,31:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:69.79943%,Single Stage Single Point:30.20057%]
[INFO] ** dst:[21:43.30895%,10:21.02985%,8:18.13579%,9:17.52304%,22:0.00085%,15:0.00051%,16:0.00034%,2:0.00034%,24:0.00017%,18:0.00017%]
[INFO] ** i/f_dir:[1:99.99949%,0:0.00051%]
[INFO] ** i/f_name:[2:99.99949%,3:0.00051%]
[INFO] ** modbus_function_code:[0.02961:99.99864%,-33.760870000000004:0.00136%]
[INFO] ** modbus_function_description:[7:49.99983%,11:49.99881%,0:0.00136%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99932%,1:0.00051%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.38336%,20:25.95595%,13:18.13579%,6:17.52337%,17:0.00051%,1:0.00051%,16:0.00017%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.95527%,-0.32151:21.02985%,-1.27613:18.13545%,-0.23351:17.52287%,-0.33484:17.35352%,-71.33197:0.00051%,-0.24151:0.00034%,1.45709:0.00034%,1.46509:0.00017%,1.47576:0.00017%,12.60597:0.00017%,10.67005:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,4.076980000000001:0.00017%,-3.3787199999999995:0.00017%,4.29964:0.00017%,-1.27347:0.00017%]
[INFO] ** scada_tag:[3:25.95493%,1:21.02985%,5:18.13545%,4:17.52253%,2:17.35335%,0:0.0039%]
[INFO] ** service:[0.0048200000000000005:99.99864%,-211.09762999999998:0.00051%,-211.73542999999998:0.00051%,-211.35747999999998:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.38336%,9:25.95595%,7:18.13579%,1:17.52337%,14:0.00051%,3:0.00051%,21:0.00017%,15:0.00017%,2:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1602 (0.27184%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3098 - tp: 71455.0000 - fp: 8545.0000 - tn: 311455.0000 - fn: 8545.0000 - accuracy: 0.9573 - precision: 0.8932 - recall: 0.8932 - auc: 0.9928 - val_loss: 0.2207 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2086 - tp: 78368.0000 - fp: 1632.0000 - tn: 318368.0000 - fn: 1632.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9978 - val_loss: 0.1508 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 3s - loss: 0.3931 - tp: 58503.0000 - fp: 21497.0000 - tn: 298503.0000 - fn: 21497.0000 - accuracy: 0.8925 - precision: 0.7313 - recall: 0.7313 - auc: 0.9702 - val_loss: 0.1703 - val_tp: 18820.0000 - val_fp: 1180.0000 - val_tn: 78820.0000 - val_fn: 1180.0000 - val_accuracy: 0.9764 - val_precision: 0.9410 - val_recall: 0.9410 - val_auc: 0.9991
[INFO] saving weights to checkpoints/lstm-epoch-6-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3389 - tp: 62386.0000 - fp: 17614.0000 - tn: 302386.0000 - fn: 17614.0000 - accuracy: 0.9119 - precision: 0.7798 - recall: 0.7798 - auc: 0.9753 - val_loss: 0.4134 - val_tp: 11846.0000 - val_fp: 8154.0000 - val_tn: 71846.0000 - val_fn: 8154.0000 - val_accuracy: 0.8369 - val_precision: 0.5923 - val_recall: 0.5923 - val_auc: 0.9462
[INFO] saving weights to checkpoints/lstm-epoch-6-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2264 - tp: 77956.0000 - fp: 2044.0000 - tn: 317956.0000 - fn: 2044.0000 - accuracy: 0.9898 - precision: 0.9744 - recall: 0.9744 - auc: 0.9974 - val_loss: 0.1617 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 3-3/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99219%,30:0.00204%,22:0.00102%,31:0.00085%,26:0.00085%,17:0.00085%,7:0.00068%,27:0.00034%,0:0.00034%,28:0.00017%,23:0.00017%,15:0.00017%,8:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:87.43514%,Single Stage Single Point:12.56486%]
[INFO] ** dst:[21:43.30794%,10:21.07804%,8:18.15971%,9:17.44566%,6:0.00204%,15:0.00136%,18:0.00119%,16:0.00119%,22:0.00085%,2:0.00034%,7:0.00034%,25:0.00034%,17:0.00034%,12:0.00017%,24:0.00017%,19:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99864%,0:0.00136%]
[INFO] ** i/f_name:[2:99.99864%,3:0.00136%]
[INFO] ** modbus_function_code:[0.02961:99.99219%,-33.760870000000004:0.00764%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99695%,11:49.99525%,0:0.00764%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99898%,2:0.00102%]
[INFO] ** proto:[0:99.99457%,2:0.00407%,1:0.00136%]
[INFO] ** proxy_src_ip:[18:38.40457%,20:25.98157%,13:18.16005%,6:17.446%,17:0.00204%,1:0.00136%,14:0.00119%,7:0.00085%,11:0.00068%,10:0.00068%,21:0.00051%,16:0.00017%,15:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.98089%,-0.32151:21.07787%,-1.27613:18.15937%,-0.23351:17.44549%,-0.33484:17.3267%,-71.33197:0.00136%,-71.14931:0.00102%,-71.14798:0.00102%,-64.19493:0.00034%,-1.2708:0.00034%,-0.08551:0.00034%,1.45709:0.00034%,-0.24151:0.00034%,13.86459:0.00017%,2.05573:0.00017%,6.1115699999999995:0.00017%,4.44364:0.00017%,-5.08665:0.00017%,-3.3787199999999995:0.00017%,10.192739999999999:0.00017%,4.29964:0.00017%,14.4699:0.00017%,-43.76509:0.00017%,-58.035180000000004:0.00017%,4.90362:0.00017%,4.076980000000001:0.00017%,-58.032509999999995:0.00017%,-1.27347:0.00017%,-1.02014:0.00017%,-5.1466400000000005:0.00017%,13.431270000000001:0.00017%,12.60597:0.00017%,1.47576:0.00017%,1.46509:0.00017%,14.253910000000001:0.00017%,-68.79874000000001:0.00017%,-0.24950999999999998:0.00017%,-2.1481:0.00017%,10.67005:0.00017%,-68.36943000000001:0.00017%]
[INFO] ** scada_tag:[3:25.98055%,1:21.0777%,5:18.1592%,4:17.44532%,2:17.32653%,0:0.01069%]
[INFO] ** service:[0.0048200000000000005:99.99236%,-211.73542999999998:0.00136%,-186.43601999999998:0.00119%,-211.08346:0.00102%,-211.08818:0.00102%,-205.44247:0.00085%,-211.09762999999998:0.00068%,-202.75898:0.00034%,-186.44547:0.00034%,-183.8612:0.00017%,-185.9872:0.00017%,-201.23771000000002:0.00017%,-211.35747999999998:0.00017%,-211.07873999999998:0.00017%]
[INFO] ** src:[22:38.40457%,9:25.98157%,7:18.16005%,1:17.446%,21:0.00187%,3:0.00153%,2:0.00119%,11:0.00068%,10:0.00068%,4:0.00068%,14:0.00034%,8:0.00034%,17:0.00017%,15:0.00017%,13:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1601 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4112 - tp: 54953.0000 - fp: 25047.0000 - tn: 294953.0000 - fn: 25047.0000 - accuracy: 0.8748 - precision: 0.6869 - recall: 0.6869 - auc: 0.9651 - val_loss: 0.2745 - val_tp: 16912.0000 - val_fp: 3088.0000 - val_tn: 76912.0000 - val_fn: 3088.0000 - val_accuracy: 0.9382 - val_precision: 0.8456 - val_recall: 0.8456 - val_auc: 0.9879
[INFO] saving weights to checkpoints/lstm-epoch-6-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2240 - tp: 78718.0000 - fp: 1282.0000 - tn: 318718.0000 - fn: 1282.0000 - accuracy: 0.9936 - precision: 0.9840 - recall: 0.9840 - auc: 0.9980 - val_loss: 0.1664 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3869 - tp: 58221.0000 - fp: 21779.0000 - tn: 298221.0000 - fn: 21779.0000 - accuracy: 0.8911 - precision: 0.7278 - recall: 0.7278 - auc: 0.9667 - val_loss: 0.4575 - val_tp: 10585.0000 - val_fp: 9415.0000 - val_tn: 70585.0000 - val_fn: 9415.0000 - val_accuracy: 0.8117 - val_precision: 0.5293 - val_recall: 0.5293 - val_auc: 0.9446
[INFO] saving weights to checkpoints/lstm-epoch-6-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0923 - tp: 72331.0000 - fp: 7669.0000 - tn: 312331.0000 - fn: 7669.0000 - accuracy: 0.9617 - precision: 0.9041 - recall: 0.9041 - auc: 0.9975 - val_loss: 1.2831e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0270 - tp: 77448.0000 - fp: 2552.0000 - tn: 317448.0000 - fn: 2552.0000 - accuracy: 0.9872 - precision: 0.9681 - recall: 0.9681 - auc: 0.9997 - val_loss: 1.7262e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 4-4/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99779%,30:0.00119%,31:0.00034%,33:0.00017%,26:0.00017%,23:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:92.57097%,Single Stage Single Point:7.42903%]
[INFO] ** dst:[21:43.35019%,10:20.95026%,8:18.17651%,9:17.51947%,22:0.00119%,15:0.00119%,24:0.00034%,18:0.00034%,19:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99898%,0:0.00102%]
[INFO] ** i/f_name:[2:99.99881%,3:0.00119%]
[INFO] ** modbus_function_code:[0.02961:99.99779%,-33.760870000000004:0.00221%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99779%,0:0.00221%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99898%,2:0.00102%]
[INFO] ** proto:[0:99.9983%,1:0.00119%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.26034%,20:26.04045%,13:18.17668%,6:17.51981%,17:0.00119%,16:0.00051%,21:0.00034%,14:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.03978%,-0.32151:20.95009%,-1.27613:18.17617%,-0.23351:17.5193%,-0.33484:17.31024%,-71.33197:0.00119%,-1.02014:0.00051%,1.45709:0.00034%,-0.08551:0.00034%,-1.27347:0.00034%,-0.24151:0.00034%,14.4699:0.00017%,4.44364:0.00017%,-71.14798:0.00017%,-1.2708:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:26.03944%,1:20.94992%,5:18.17617%,4:17.51896%,2:17.31007%,0:0.00543%]
[INFO] ** service:[0.0048200000000000005:99.99796%,-211.73542999999998:0.00119%,-186.43601999999998:0.00034%,-183.8612:0.00017%,-211.08346:0.00017%,-211.07873999999998:0.00017%]
[INFO] ** src:[22:38.26034%,9:26.04045%,7:18.17668%,1:17.51981%,21:0.00102%,15:0.00051%,4:0.00034%,17:0.00017%,14:0.00017%,8:0.00017%,3:0.00017%,2:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1611 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0245 - tp: 77554.0000 - fp: 2446.0000 - tn: 317554.0000 - fn: 2446.0000 - accuracy: 0.9878 - precision: 0.9694 - recall: 0.9694 - auc: 0.9998 - val_loss: 1.2816e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0239 - tp: 77471.0000 - fp: 2529.0000 - tn: 317471.0000 - fn: 2529.0000 - accuracy: 0.9874 - precision: 0.9684 - recall: 0.9684 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0219 - tp: 77816.0000 - fp: 2184.0000 - tn: 317816.0000 - fn: 2184.0000 - accuracy: 0.9891 - precision: 0.9727 - recall: 0.9727 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6944 - tp: 65003.0000 - fp: 14997.0000 - tn: 305003.0000 - fn: 14997.0000 - accuracy: 0.9250 - precision: 0.8125 - recall: 0.8125 - auc: 0.9511 - val_loss: 0.8827 - val_tp: 7812.0000 - val_fp: 12188.0000 - val_tn: 67812.0000 - val_fn: 12188.0000 - val_accuracy: 0.7562 - val_precision: 0.3906 - val_recall: 0.3906 - val_auc: 0.8844
[INFO] saving weights to checkpoints/lstm-epoch-6-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 5-5/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99627%,30:0.00272%,37:0.00017%,26:0.00017%,12:0.00017%,9:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:87.62298%,Single Stage Single Point:12.37702%]
[INFO] ** dst:[21:43.36224%,10:20.77005%,8:18.24252%,9:17.62078%,15:0.00272%,22:0.00085%,25:0.00017%,24:0.00017%,6:0.00017%,2:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99762%,0:0.00238%]
[INFO] ** i/f_name:[2:99.99728%,3:0.00272%]
[INFO] ** modbus_function_code:[0.02961:99.99627%,-33.760870000000004:0.00373%]
[INFO] ** modbus_function_description:[7:49.99864%,11:49.99762%,0:0.00373%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99779%,2:0.00221%]
[INFO] ** proto:[0:99.99695%,1:0.00272%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.00682%,20:26.12581%,13:18.24252%,6:17.62095%,17:0.00272%,1:0.00034%,21:0.00017%,16:0.00017%,7:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.12513%,-0.32151:20.76971%,-1.27613:18.24235%,-0.23351:17.62061%,-0.33484:17.23711%,-71.33197:0.00272%,-0.24151:0.00034%,1.45709:0.00034%,1.47576:0.00017%,1.46509:0.00017%,-49.275529999999996:0.00017%,-1.27347:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,2.22906:0.00017%,14.4699:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.12479%,1:20.76954%,5:18.24218%,4:17.62061%,2:17.23694%,0:0.00594%]
[INFO] ** service:[0.0048200000000000005:99.99661%,-211.73542999999998:0.00272%,-183.8612:0.00017%,-211.08346:0.00017%,-211.35747999999998:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.00682%,9:26.12581%,7:18.24252%,1:17.62095%,21:0.00238%,14:0.00051%,3:0.00034%,16:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1614 (0.27388%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4696 - tp: 63406.0000 - fp: 16594.0000 - tn: 303406.0000 - fn: 16594.0000 - accuracy: 0.9170 - precision: 0.7926 - recall: 0.7926 - auc: 0.9596 - val_loss: 0.2232 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3481 - tp: 63177.0000 - fp: 16823.0000 - tn: 303177.0000 - fn: 16823.0000 - accuracy: 0.9159 - precision: 0.7897 - recall: 0.7897 - auc: 0.9785 - val_loss: 0.1696 - val_tp: 19057.0000 - val_fp: 943.0000 - val_tn: 79057.0000 - val_fn: 943.0000 - val_accuracy: 0.9811 - val_precision: 0.9528 - val_recall: 0.9528 - val_auc: 0.9988
[INFO] saving weights to checkpoints/lstm-epoch-6-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1036 - tp: 77957.0000 - fp: 2043.0000 - tn: 317957.0000 - fn: 2043.0000 - accuracy: 0.9898 - precision: 0.9745 - recall: 0.9745 - auc: 0.9974 - val_loss: 1.3693 - val_tp: 12817.0000 - val_fp: 7183.0000 - val_tn: 72817.0000 - val_fn: 7183.0000 - val_accuracy: 0.8563 - val_precision: 0.6409 - val_recall: 0.6409 - val_auc: 0.9652
[INFO] saving weights to checkpoints/lstm-epoch-6-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1608 - tp: 75143.0000 - fp: 4857.0000 - tn: 315143.0000 - fn: 4857.0000 - accuracy: 0.9757 - precision: 0.9393 - recall: 0.9393 - auc: 0.9959 - val_loss: 0.0297 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 3s - loss: 0.0377 - tp: 79816.0000 - fp: 184.0000 - tn: 319816.0000 - fn: 184.0000 - accuracy: 0.9991 - precision: 0.9977 - recall: 0.9977 - auc: 1.0000 - val_loss: 0.0205 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 6-6/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.9961%,30:0.00305%,31:0.00017%,27:0.00017%,26:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:93.14368%,Single Stage Single Point:6.85632%]
[INFO] ** dst:[21:43.37785%,10:20.73221%,8:18.27833%,9:17.60703%,15:0.00305%,22:0.00051%,25:0.00017%,24:0.00017%,18:0.00017%,12:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99712%,0:0.00288%]
[INFO] ** i/f_name:[2:99.99695%,3:0.00305%]
[INFO] ** modbus_function_code:[0.02961:99.9961%,-33.760870000000004:0.0039%]
[INFO] ** modbus_function_description:[7:49.99864%,11:49.99745%,0:0.0039%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.9961%,1:0.00305%,2:0.00085%]
[INFO] ** proxy_src_ip:[18:37.95031%,20:26.15992%,13:18.2785%,6:17.6072%,17:0.00305%,14:0.00051%,16:0.00034%,11:0.00017%]
[INFO] ** s_port:[1.45442:26.15958%,-0.32151:20.73221%,-1.27613:18.27799%,-0.23351:17.60686%,-0.33484:17.2181%,-71.33197:0.00305%,-1.02014:0.00034%,-71.14798:0.00017%,-64.19493:0.00017%,4.90362:0.00017%,-1.2708:0.00017%,-0.24151:0.00017%,13.431270000000001:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-68.36943000000001:0.00017%]
[INFO] ** scada_tag:[3:26.15941%,1:20.73187%,5:18.27782%,4:17.60652%,2:17.21793%,0:0.00645%]
[INFO] ** service:[0.0048200000000000005:99.9961%,-211.73542999999998:0.00305%,-211.08346:0.00017%,-201.23771000000002:0.00017%,-202.75898:0.00017%,-186.44547:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:37.95031%,9:26.15992%,7:18.2785%,1:17.6072%,14:0.00305%,2:0.00051%,15:0.00034%,10:0.00017%]
[INFO] ** type:[0:99.99915%,1:0.00085%]
[INFO] ** unixtime:1613 (0.27371%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0281 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0167 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0234 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0139 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0195 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0118 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0166 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0094 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1207 - tp: 78956.0000 - fp: 1044.0000 - tn: 318956.0000 - fn: 1044.0000 - accuracy: 0.9948 - precision: 0.9869 - recall: 0.9869 - auc: 0.9957 - val_loss: 0.9548 - val_tp: 12837.0000 - val_fp: 7163.0000 - val_tn: 72837.0000 - val_fn: 7163.0000 - val_accuracy: 0.8567 - val_precision: 0.6418 - val_recall: 0.6418 - val_auc: 0.9632
[INFO] saving weights to checkpoints/lstm-epoch-6-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 7-7/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99525%,30:0.00187%,22:0.00085%,17:0.00068%,26:0.00051%,31:0.00034%,28:0.00017%,27:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:79.87188%,Single Stage Single Point:20.12812%]
[INFO] ** dst:[21:43.36275%,10:20.7278%,8:18.2583%,9:17.6447%,15:0.00187%,22:0.00136%,6:0.00136%,16:0.00068%,24:0.00034%,18:0.00034%,17:0.00034%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.99813%,0:0.00187%]
[INFO] ** i/f_name:[2:99.99813%,3:0.00187%]
[INFO] ** modbus_function_code:[0.02961:99.99525%,-33.760870000000004:0.00475%]
[INFO] ** modbus_function_description:[7:49.9983%,11:49.99695%,0:0.00475%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.99627%,2:0.00187%,1:0.00187%]
[INFO] ** proxy_src_ip:[18:37.94913%,20:26.1421%,13:18.25864%,6:17.64487%,17:0.00187%,11:0.00068%,1:0.00068%,21:0.00051%,16:0.00051%,14:0.00034%,7:0.00034%,10:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.14125%,-0.32151:20.7278%,-1.27613:18.25813%,-0.23351:17.64453%,-0.33484:17.22133%,-71.33197:0.00187%,-71.14931:0.00085%,-1.02014:0.00051%,-71.14798:0.00051%,1.45709:0.00051%,-0.24151:0.00034%,-1.27347:0.00034%,1.47576:0.00017%,1.46509:0.00017%,14.253910000000001:0.00017%,-1.2708:0.00017%,-58.035180000000004:0.00017%,-58.032509999999995:0.00017%,-68.79874000000001:0.00017%,-43.76509:0.00017%,2.05573:0.00017%,6.1115699999999995:0.00017%,-5.08665:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:26.14091%,1:20.7278%,5:18.25796%,4:17.64436%,2:17.22116%,0:0.00781%]
[INFO] ** service:[0.0048200000000000005:99.99525%,-211.73542999999998:0.00187%,-211.08818:0.00085%,-205.44247:0.00068%,-211.08346:0.00051%,-186.43601999999998:0.00034%,-211.09762999999998:0.00017%,-185.9872:0.00017%,-202.75898:0.00017%]
[INFO] ** src:[22:37.94913%,9:26.1421%,7:18.25864%,1:17.64487%,14:0.00187%,10:0.00068%,3:0.00068%,15:0.00051%,4:0.00051%,21:0.00034%,2:0.00034%,11:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99932%,1:0.00068%]
[INFO] ** unixtime:1611 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5040 - tp: 51163.0000 - fp: 28837.0000 - tn: 291163.0000 - fn: 28837.0000 - accuracy: 0.8558 - precision: 0.6395 - recall: 0.6395 - auc: 0.9650 - val_loss: 0.3363 - val_tp: 12812.0000 - val_fp: 7188.0000 - val_tn: 72812.0000 - val_fn: 7188.0000 - val_accuracy: 0.8562 - val_precision: 0.6406 - val_recall: 0.6406 - val_auc: 0.9677
[INFO] saving weights to checkpoints/lstm-epoch-6-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2812 - tp: 62199.0000 - fp: 17801.0000 - tn: 302199.0000 - fn: 17801.0000 - accuracy: 0.9110 - precision: 0.7775 - recall: 0.7775 - auc: 0.9759 - val_loss: 0.2083 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1871 - tp: 78419.0000 - fp: 1581.0000 - tn: 318419.0000 - fn: 1581.0000 - accuracy: 0.9921 - precision: 0.9802 - recall: 0.9802 - auc: 0.9983 - val_loss: 0.1196 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3020 - tp: 61431.0000 - fp: 18569.0000 - tn: 301431.0000 - fn: 18569.0000 - accuracy: 0.9072 - precision: 0.7679 - recall: 0.7679 - auc: 0.9776 - val_loss: 0.2510 - val_tp: 16778.0000 - val_fp: 3222.0000 - val_tn: 76778.0000 - val_fn: 3222.0000 - val_accuracy: 0.9356 - val_precision: 0.8389 - val_recall: 0.8389 - val_auc: 0.9840
[INFO] saving weights to checkpoints/lstm-epoch-6-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0975 - tp: 72411.0000 - fp: 7589.0000 - tn: 312411.0000 - fn: 7589.0000 - accuracy: 0.9621 - precision: 0.9051 - recall: 0.9051 - auc: 0.9974 - val_loss: 0.0376 - val_tp: 19095.0000 - val_fp: 905.0000 - val_tn: 79095.0000 - val_fn: 905.0000 - val_accuracy: 0.9819 - val_precision: 0.9548 - val_recall: 0.9548 - val_auc: 0.9995
[INFO] saving weights to checkpoints/lstm-epoch-6-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 8-8/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99678%,30:0.00102%,0:0.00051%,28:0.00017%,26:0.00017%,24:0.00017%,23:0.00017%,22:0.00017%,18:0.00017%,17:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:95.1506%,Single Stage Single Point:4.8494%]
[INFO] ** dst:[21:43.4162%,10:20.80179%,8:18.19535%,9:17.5826%,22:0.00136%,15:0.00102%,25:0.00051%,19:0.00034%,17:0.00034%,26:0.00017%,24:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99932%,0:0.00068%]
[INFO] ** i/f_name:[2:99.99898%,3:0.00102%]
[INFO] ** modbus_function_code:[0.02961:99.99678%,-33.760870000000004:0.00305%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99966%,11:49.99712%,0:0.00305%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99966%,2:0.00034%]
[INFO] ** proto:[0:99.99813%,1:0.00102%,2:0.00085%]
[INFO] ** proxy_src_ip:[18:38.08284%,20:26.13548%,13:18.19484%,6:17.58294%,17:0.00102%,10:0.00102%,16:0.00068%,1:0.00051%,14:0.00034%,11:0.00017%,5:0.00017%]
[INFO] ** s_port:[1.45442:26.13497%,-0.32151:20.80179%,-1.27613:18.1945%,-0.23351:17.58243%,-0.33484:17.28106%,-71.33197:0.00102%,-1.02014:0.00068%,-15.039579999999999:0.00068%,-64.19493:0.00051%,4.66896:0.00034%,-0.24151:0.00034%,1.45709:0.00034%,-5.1466400000000005:0.00017%,-1.27347:0.00017%,-1.2708:0.00017%,1.47576:0.00017%,-5.08665:0.00017%,-71.14931:0.00017%,-0.24950999999999998:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.13446%,1:20.80162%,5:18.1945%,4:17.58226%,2:17.28089%,0:0.00628%]
[INFO] ** service:[0.0048200000000000005:99.99745%,-211.73542999999998:0.00102%,-186.44547:0.00051%,-211.07873999999998:0.00034%,-211.08346:0.00017%,-185.9872:0.00017%,-205.44247:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.08284%,9:26.13548%,7:18.19484%,1:17.58294%,11:0.00102%,15:0.00068%,14:0.00068%,3:0.00051%,21:0.00034%,2:0.00034%,16:0.00017%,10:0.00017%]
[INFO] ** type:[0:99.99949%,1:0.00034%,2:0.00017%]
[INFO] ** unixtime:1613 (0.27371%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0555 - tp: 76496.0000 - fp: 3504.0000 - tn: 316496.0000 - fn: 3504.0000 - accuracy: 0.9825 - precision: 0.9562 - recall: 0.9562 - auc: 0.9991 - val_loss: 0.0316 - val_tp: 19803.0000 - val_fp: 197.0000 - val_tn: 79803.0000 - val_fn: 197.0000 - val_accuracy: 0.9961 - val_precision: 0.9901 - val_recall: 0.9901 - val_auc: 0.9998
[INFO] saving weights to checkpoints/lstm-epoch-6-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0450 - tp: 79757.0000 - fp: 243.0000 - tn: 319757.0000 - fn: 243.0000 - accuracy: 0.9988 - precision: 0.9970 - recall: 0.9970 - auc: 1.0000 - val_loss: 0.0195 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0294 - tp: 79908.0000 - fp: 92.0000 - tn: 319908.0000 - fn: 92.0000 - accuracy: 0.9995 - precision: 0.9988 - recall: 0.9988 - auc: 1.0000 - val_loss: 0.0054 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0155 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6884 - tp: 71224.0000 - fp: 8776.0000 - tn: 311224.0000 - fn: 8776.0000 - accuracy: 0.9561 - precision: 0.8903 - recall: 0.8903 - auc: 0.9698 - val_loss: 0.2892 - val_tp: 16394.0000 - val_fp: 3606.0000 - val_tn: 76394.0000 - val_fn: 3606.0000 - val_accuracy: 0.9279 - val_precision: 0.8197 - val_recall: 0.8197 - val_auc: 0.9832
[INFO] saving weights to checkpoints/lstm-epoch-6-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 9-9/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.9983%,30:0.00102%,31:0.00034%,26:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:93.94597%,Single Stage Single Point:6.05403%]
[INFO] ** dst:[21:43.38124%,10:20.77243%,8:18.27323%,9:17.57038%,15:0.00102%,22:0.00085%,18:0.00034%,25:0.00017%,24:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99898%,0:0.00102%]
[INFO] ** i/f_name:[2:99.99898%,3:0.00102%]
[INFO] ** modbus_function_code:[0.02961:99.9983%,-33.760870000000004:0.0017%]
[INFO] ** modbus_function_description:[7:49.99983%,11:49.99847%,0:0.0017%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99966%,2:0.00034%]
[INFO] ** proto:[0:99.9983%,1:0.00102%,2:0.00068%]
[INFO] ** proxy_src_ip:[18:38.01225%,20:26.14193%,13:18.27323%,6:17.57072%,17:0.00102%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.14125%,-0.32151:20.77243%,-1.27613:18.2729%,-0.23351:17.57021%,-0.33484:17.23982%,-71.33197:0.00102%,-0.24151:0.00034%,1.45709:0.00034%,-0.08551:0.00034%,1.46509:0.00017%,1.47576:0.00017%,-1.27347:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.14091%,1:20.77226%,5:18.2729%,4:17.57004%,2:17.23965%,0:0.00424%]
[INFO] ** service:[0.0048200000000000005:99.9983%,-211.73542999999998:0.00102%,-186.43601999999998:0.00034%,-211.08346:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.01225%,9:26.14193%,7:18.27323%,1:17.57072%,14:0.00068%,21:0.00034%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1614 (0.27388%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2782 - tp: 66074.0000 - fp: 13926.0000 - tn: 306074.0000 - fn: 13926.0000 - accuracy: 0.9304 - precision: 0.8259 - recall: 0.8259 - auc: 0.9824 - val_loss: 0.2504 - val_tp: 16746.0000 - val_fp: 3254.0000 - val_tn: 76746.0000 - val_fn: 3254.0000 - val_accuracy: 0.9349 - val_precision: 0.8373 - val_recall: 0.8373 - val_auc: 0.9851
[INFO] saving weights to checkpoints/lstm-epoch-6-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2597 - tp: 66460.0000 - fp: 13540.0000 - tn: 306460.0000 - fn: 13540.0000 - accuracy: 0.9323 - precision: 0.8307 - recall: 0.8307 - auc: 0.9839 - val_loss: 0.2298 - val_tp: 17149.0000 - val_fp: 2851.0000 - val_tn: 77149.0000 - val_fn: 2851.0000 - val_accuracy: 0.9430 - val_precision: 0.8575 - val_recall: 0.8575 - val_auc: 0.9904
[INFO] saving weights to checkpoints/lstm-epoch-6-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0790 - tp: 79539.0000 - fp: 461.0000 - tn: 319539.0000 - fn: 461.0000 - accuracy: 0.9977 - precision: 0.9942 - recall: 0.9942 - auc: 0.9999 - val_loss: 0.0248 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0354 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0178 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0265 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0142 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 10-10/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99644%,30:0.0017%,31:0.00034%,26:0.00017%,24:0.00017%,23:0.00017%,22:0.00017%,18:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:94.81614%,Single Stage Single Point:5.18386%]
[INFO] ** dst:[21:43.40924%,10:20.80891%,8:18.22793%,9:17.55002%,15:0.0017%,24:0.00051%,22:0.00051%,19:0.00034%,18:0.00034%,26:0.00017%,25:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99847%,0:0.00153%]
[INFO] ** i/f_name:[2:99.9983%,3:0.0017%]
[INFO] ** modbus_function_code:[0.02961:99.99644%,-33.760870000000004:0.00339%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99915%,11:49.99728%,0:0.00339%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99932%,1:0.00068%]
[INFO] ** proto:[0:99.99745%,1:0.0017%,2:0.00085%]
[INFO] ** proxy_src_ip:[18:38.08165%,20:26.13701%,13:18.22827%,6:17.54934%,17:0.0017%,10:0.00085%,14:0.00034%,21:0.00017%,16:0.00017%,5:0.00017%,2:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.13633%,-0.32151:20.80891%,-1.27613:18.22759%,-0.23351:17.549%,-0.33484:17.27274%,-71.33197:0.0017%,-10.51843:0.00068%,-1.27347:0.00051%,-0.08551:0.00034%,5.71692:0.00034%,1.47576:0.00034%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-71.14931:0.00017%,-64.19493:0.00017%,1.45709:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.13599%,1:20.80874%,5:18.22759%,4:17.54883%,2:17.27257%,0:0.00628%]
[INFO] ** service:[0.0048200000000000005:99.99712%,-211.73542999999998:0.0017%,-211.07873999999998:0.00034%,-186.43601999999998:0.00034%,-211.08346:0.00017%,-186.44547:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.08165%,9:26.13701%,7:18.22827%,1:17.54934%,14:0.0017%,11:0.00085%,2:0.00034%,17:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%]
[INFO] ** type:[0:99.99864%,1:0.00119%,2:0.00017%]
[INFO] ** unixtime:1610 (0.2732%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0129 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0175 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0096 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2040 - tp: 76098.0000 - fp: 3902.0000 - tn: 316098.0000 - fn: 3902.0000 - accuracy: 0.9805 - precision: 0.9512 - recall: 0.9512 - auc: 0.9925 - val_loss: 0.6746 - val_tp: 12829.0000 - val_fp: 7171.0000 - val_tn: 72829.0000 - val_fn: 7171.0000 - val_accuracy: 0.8566 - val_precision: 0.6414 - val_recall: 0.6414 - val_auc: 0.9679
[INFO] saving weights to checkpoints/lstm-epoch-6-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3606 - tp: 60524.0000 - fp: 19476.0000 - tn: 300524.0000 - fn: 19476.0000 - accuracy: 0.9026 - precision: 0.7566 - recall: 0.7566 - auc: 0.9772 - val_loss: 0.1741 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1399 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0951 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 11-11/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99898%,31:0.00034%,30:0.00034%,26:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.39465%,10:20.86983%,8:18.19331%,9:17.54%,22:0.00119%,18:0.00034%,15:0.00034%,25:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99966%,0:0.00034%]
[INFO] ** i/f_name:[2:99.99966%,3:0.00034%]
[INFO] ** modbus_function_code:[0.02961:99.99898%,-33.760870000000004:0.00102%]
[INFO] ** modbus_function_description:[7:50.00068%,11:49.9983%,0:0.00102%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99898%,2:0.00068%,1:0.00034%]
[INFO] ** proxy_src_ip:[18:38.14444%,20:26.12038%,13:18.19331%,6:17.54034%,16:0.00051%,17:0.00034%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.11987%,-0.32151:20.86983%,-1.27613:18.19314%,-0.23351:17.53983%,-0.33484:17.27461%,-0.24151:0.00051%,-1.02014:0.00051%,-0.08551:0.00034%,-71.33197:0.00034%,-71.14798:0.00017%,1.45709:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:26.11953%,1:20.86966%,5:18.19297%,4:17.5395%,2:17.27444%,0:0.0039%]
[INFO] ** service:[0.0048200000000000005:99.99898%,-211.73542999999998:0.00034%,-186.43601999999998:0.00034%,-211.08346:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.14444%,9:26.12038%,7:18.19331%,1:17.54034%,15:0.00051%,14:0.00034%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1610 (0.2732%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0478 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0114 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0167 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0093 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0149 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0086 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0134 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0076 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0114 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0059 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 12-12/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99728%,30:0.00204%,31:0.00034%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:93.85875%,Single Stage Single Point:6.14125%]
[INFO] ** dst:[21:43.40602%,10:20.88205%,8:18.17923%,9:17.52914%,15:0.00204%,22:0.00051%,24:0.00034%,18:0.00034%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.9983%,0:0.0017%]
[INFO] ** i/f_name:[2:99.99796%,3:0.00204%]
[INFO] ** modbus_function_code:[0.02961:99.99728%,-33.760870000000004:0.00272%]
[INFO] ** modbus_function_description:[7:49.99932%,11:49.99796%,0:0.00272%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99847%,2:0.00153%]
[INFO] ** proto:[0:99.99745%,1:0.00204%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.15309%,20:26.13531%,13:18.1794%,6:17.52931%,17:0.00204%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.1348%,-0.32151:20.88205%,-1.27613:18.17889%,-0.23351:17.52897%,-0.33484:17.27105%,-71.33197:0.00204%,-1.27347:0.00034%,-0.08551:0.00034%,1.46509:0.00017%,1.47576:0.00017%,-0.24950999999999998:0.00017%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,1.45709:0.00017%,14.4699:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.13446%,1:20.88205%,5:18.17889%,4:17.52864%,2:17.27105%,0:0.00492%]
[INFO] ** service:[0.0048200000000000005:99.99728%,-211.73542999999998:0.00204%,-186.43601999999998:0.00034%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.15309%,9:26.13531%,7:18.1794%,1:17.52931%,21:0.00153%,14:0.00051%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1611 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0096 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0036 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0082 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0026 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0070 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.1671 - val_tp: 12867.0000 - val_fp: 7133.0000 - val_tn: 72867.0000 - val_fn: 7133.0000 - val_accuracy: 0.8573 - val_precision: 0.6434 - val_recall: 0.6434 - val_auc: 0.8000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8291 - tp: 52430.0000 - fp: 27570.0000 - tn: 292430.0000 - fn: 27570.0000 - accuracy: 0.8621 - precision: 0.6554 - recall: 0.6554 - auc: 0.9554 - val_loss: 0.3271 - val_tp: 19063.0000 - val_fp: 937.0000 - val_tn: 79063.0000 - val_fn: 937.0000 - val_accuracy: 0.9813 - val_precision: 0.9531 - val_recall: 0.9531 - val_auc: 0.9838
[INFO] saving weights to checkpoints/lstm-epoch-6-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1178 - tp: 79850.0000 - fp: 150.0000 - tn: 319850.0000 - fn: 150.0000 - accuracy: 0.9992 - precision: 0.9981 - recall: 0.9981 - auc: 0.9994 - val_loss: 0.0179 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 13-13/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99661%,31:0.00068%,30:0.00051%,26:0.00051%,0:0.00051%,22:0.00034%,27:0.00017%,24:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:87.01651%,Single Stage Single Point:12.98349%]
[INFO] ** dst:[21:43.35766%,10:20.80908%,8:18.2729%,9:17.55646%,22:0.00102%,6:0.00085%,18:0.00068%,25:0.00051%,15:0.00051%,24:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.99966%,0:0.00034%]
[INFO] ** i/f_name:[2:99.99949%,3:0.00051%]
[INFO] ** modbus_function_code:[0.02961:99.99661%,-33.760870000000004:0.00322%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99881%,11:49.99779%,0:0.00322%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99728%,2:0.00221%,1:0.00051%]
[INFO] ** proxy_src_ip:[18:38.05433%,20:26.11274%,13:18.27307%,6:17.55596%,10:0.00102%,11:0.00085%,17:0.00051%,16:0.00051%,7:0.00034%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.11223%,-0.32151:20.80908%,-1.27613:18.27273%,-0.23351:17.55562%,-0.33484:17.24525%,-9.78512:0.00068%,-64.19493:0.00051%,-1.02014:0.00051%,-71.14798:0.00051%,-71.33197:0.00051%,-0.24151:0.00034%,-71.14931:0.00034%,-0.08551:0.00034%,1.47576:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-1.2708:0.00017%,-68.79874000000001:0.00017%,6.1115699999999995:0.00017%,14.540560000000001:0.00017%,1.45709:0.00017%]
[INFO] ** scada_tag:[3:26.11189%,1:20.80891%,5:18.27273%,4:17.55562%,2:17.24508%,0:0.00577%]
[INFO] ** service:[0.0048200000000000005:99.99728%,-186.43601999999998:0.00068%,-211.08346:0.00051%,-186.44547:0.00051%,-211.73542999999998:0.00051%,-211.08818:0.00034%,-202.75898:0.00017%]
[INFO] ** src:[22:38.05433%,9:26.11274%,7:18.27307%,1:17.55596%,11:0.00102%,10:0.00085%,15:0.00051%,14:0.00051%,21:0.00034%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99966%,2:0.00017%,1:0.00017%]
[INFO] ** unixtime:1610 (0.2732%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0305 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0075 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0169 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0059 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0131 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0038 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1442 - tp: 78410.0000 - fp: 1590.0000 - tn: 318410.0000 - fn: 1590.0000 - accuracy: 0.9921 - precision: 0.9801 - recall: 0.9801 - auc: 0.9948 - val_loss: 0.9739 - val_tp: 12841.0000 - val_fp: 7159.0000 - val_tn: 72841.0000 - val_fn: 7159.0000 - val_accuracy: 0.8568 - val_precision: 0.6421 - val_recall: 0.6421 - val_auc: 0.9673
[INFO] saving weights to checkpoints/lstm-epoch-6-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4655 - tp: 51326.0000 - fp: 28674.0000 - tn: 291326.0000 - fn: 28674.0000 - accuracy: 0.8566 - precision: 0.6416 - recall: 0.6416 - auc: 0.9657 - val_loss: 0.3168 - val_tp: 12860.0000 - val_fp: 7140.0000 - val_tn: 72860.0000 - val_fn: 7140.0000 - val_accuracy: 0.8572 - val_precision: 0.6430 - val_recall: 0.6430 - val_auc: 0.9681
[INFO] saving weights to checkpoints/lstm-epoch-6-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 14-14/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99898%,31:0.00034%,30:0.00034%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:91.61613%,Single Stage Single Point:8.38387%]
[INFO] ** dst:[21:43.35341%,10:20.80518%,8:18.26848%,9:17.57089%,22:0.00068%,24:0.00034%,18:0.00034%,15:0.00034%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99983%,0:0.00017%]
[INFO] ** i/f_name:[2:99.99966%,3:0.00034%]
[INFO] ** modbus_function_code:[0.02961:99.99898%,-33.760870000000004:0.00102%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.99881%,0:0.00102%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99915%,2:0.00051%,1:0.00034%]
[INFO] ** proxy_src_ip:[18:38.04297%,20:26.11614%,13:18.26865%,6:17.57106%,17:0.00034%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.11546%,-0.32151:20.80518%,-1.27613:18.26814%,-0.23351:17.57072%,-0.33484:17.23779%,-1.27347:0.00034%,-0.08551:0.00034%,-71.33197:0.00034%,1.45709:0.00034%,1.47576:0.00017%,1.46509:0.00017%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,-0.24950999999999998:0.00017%,14.4699:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.11512%,1:20.80518%,5:18.26797%,4:17.57038%,2:17.23762%,0:0.00373%]
[INFO] ** service:[0.0048200000000000005:99.99898%,-211.73542999999998:0.00034%,-186.43601999999998:0.00034%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.04297%,9:26.11614%,7:18.26865%,1:17.57106%,14:0.00034%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1610 (0.2732%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2720 - tp: 64398.0000 - fp: 15602.0000 - tn: 304398.0000 - fn: 15602.0000 - accuracy: 0.9220 - precision: 0.8050 - recall: 0.8050 - auc: 0.9801 - val_loss: 0.2010 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2714 - tp: 63247.0000 - fp: 16753.0000 - tn: 303247.0000 - fn: 16753.0000 - accuracy: 0.9162 - precision: 0.7906 - recall: 0.7906 - auc: 0.9797 - val_loss: 0.2704 - val_tp: 12997.0000 - val_fp: 7003.0000 - val_tn: 72997.0000 - val_fn: 7003.0000 - val_accuracy: 0.8599 - val_precision: 0.6499 - val_recall: 0.6499 - val_auc: 0.9682
[INFO] saving weights to checkpoints/lstm-epoch-6-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1231 - tp: 74748.0000 - fp: 5252.0000 - tn: 314748.0000 - fn: 5252.0000 - accuracy: 0.9737 - precision: 0.9344 - recall: 0.9344 - auc: 0.9980 - val_loss: 0.0122 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0372 - tp: 79975.0000 - fp: 25.0000 - tn: 319975.0000 - fn: 25.0000 - accuracy: 0.9999 - precision: 0.9997 - recall: 0.9997 - auc: 1.0000 - val_loss: 0.0052 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0283 - tp: 79989.0000 - fp: 11.0000 - tn: 319989.0000 - fn: 11.0000 - accuracy: 0.9999 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 7.6118e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 15-15/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99644%,30:0.00288%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:90.62802%,Single Stage Multi Point:9.3713%,Single Stage Single Point:0.00068%]
[INFO] ** dst:[21:43.30285%,10:20.78363%,8:18.31023%,9:17.59821%,15:0.00288%,22:0.00153%,25:0.00017%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99728%,0:0.00272%]
[INFO] ** i/f_name:[2:99.99712%,3:0.00288%]
[INFO] ** modbus_function_code:[0.02961:99.99644%,-33.760870000000004:0.00356%]
[INFO] ** modbus_function_description:[7:49.99915%,11:49.99728%,0:0.00356%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99745%,2:0.00255%]
[INFO] ** proto:[0:99.99678%,1:0.00288%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.01972%,20:26.06743%,13:18.30989%,6:17.59872%,17:0.00288%,16:0.00068%,7:0.00034%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.06659%,-0.32151:20.78346%,-1.27613:18.30972%,-0.23351:17.59804%,-0.33484:17.23626%,-71.33197:0.00288%,-1.02014:0.00068%,-0.24151:0.00051%,1.46509:0.00034%,1.45709:0.00034%,1.47576:0.00017%,-1.27347:0.00017%,-0.24950999999999998:0.00017%,-61.95768:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.06625%,1:20.78329%,5:18.30972%,4:17.5977%,2:17.23592%,0:0.00713%]
[INFO] ** service:[0.0048200000000000005:99.99661%,-211.73542999999998:0.00288%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.01972%,9:26.06743%,7:18.30989%,1:17.59872%,21:0.00288%,15:0.00068%,14:0.00034%,16:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1618 (0.27456%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0185 - tp: 79992.0000 - fp: 8.0000 - tn: 319992.0000 - fn: 8.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 8.0660e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0145 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9973e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0142 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3790e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0125 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2620e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8323 - tp: 75925.0000 - fp: 4075.0000 - tn: 315925.0000 - fn: 4075.0000 - accuracy: 0.9796 - precision: 0.9491 - recall: 0.9491 - auc: 0.9680 - val_loss: 7.5368 - val_tp: 10648.0000 - val_fp: 9352.0000 - val_tn: 70648.0000 - val_fn: 9352.0000 - val_accuracy: 0.8130 - val_precision: 0.5324 - val_recall: 0.5324 - val_auc: 0.7078
[INFO] saving weights to checkpoints/lstm-epoch-6-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 16-16/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529000, 17)

[INFO] analyzing data
[INFO] 529000 rows
[INFO] ** appi_name:[21:99.99792%,30:0.0017%,33:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:79.14783%,Single Stage Multi Point:20.85217%]
[INFO] ** dst:[21:43.33724%,10:20.79565%,8:18.26749%,9:17.59641%,15:0.0017%,22:0.00113%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.9983%,0:0.0017%]
[INFO] ** i/f_name:[2:99.9983%,3:0.0017%]
[INFO] ** modbus_function_code:[0.02961:99.99792%,-33.760870000000004:0.00208%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99792%,0:0.00208%]
[INFO] ** modbus_transaction_id:65536 (12.38866%)
[INFO] ** orig:[0:99.9983%,2:0.0017%]
[INFO] ** proto:[0:99.99811%,1:0.0017%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.04121%,20:26.09187%,13:18.26786%,6:17.5966%,17:0.0017%,16:0.00038%,21:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.0913%,-0.32151:20.79546%,-1.27613:18.26749%,-0.23351:17.59622%,-0.33484:17.24575%,-71.33197:0.0017%,1.45709:0.00038%,-0.24151:0.00038%,-1.02014:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,-49.275529999999996:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.09093%,1:20.79527%,5:18.2673%,4:17.59584%,2:17.24556%,0:0.0051%]
[INFO] ** service:[0.0048200000000000005:99.99811%,-211.73542999999998:0.0017%,-211.08346:0.00019%]
[INFO] ** src:[22:38.04121%,9:26.09187%,7:18.26786%,1:17.5966%,21:0.00189%,15:0.00038%,4:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1449 (0.27391%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5455 - tp: 42579.0000 - fp: 37421.0000 - tn: 282579.0000 - fn: 37421.0000 - accuracy: 0.8129 - precision: 0.5322 - recall: 0.5322 - auc: 0.7057 - val_loss: 7.5884 - val_tp: 10584.0000 - val_fp: 9416.0000 - val_tn: 70584.0000 - val_fn: 9416.0000 - val_accuracy: 0.8117 - val_precision: 0.5292 - val_recall: 0.5292 - val_auc: 0.7058
[INFO] saving weights to checkpoints/lstm-epoch-6-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5542 - tp: 42534.0000 - fp: 37466.0000 - tn: 282534.0000 - fn: 37466.0000 - accuracy: 0.8127 - precision: 0.5317 - recall: 0.5317 - auc: 0.7054 - val_loss: 7.5586 - val_tp: 10621.0000 - val_fp: 9379.0000 - val_tn: 70621.0000 - val_fn: 9379.0000 - val_accuracy: 0.8124 - val_precision: 0.5311 - val_recall: 0.5311 - val_auc: 0.7069
[INFO] saving weights to checkpoints/lstm-epoch-6-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.3578 - tp: 63374.0000 - fp: 16626.0000 - tn: 303374.0000 - fn: 16626.0000 - accuracy: 0.9169 - precision: 0.7922 - recall: 0.7922 - auc: 0.8693 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0092 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0080 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-15-16-batch-400000-500000
[INFO] processing batch 500000-600000/529000
[33m[INFO] loading file 17-17/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529000, 17)

[INFO] analyzing data
[INFO] 529000 rows
[INFO] ** appi_name:[21:99.99716%,7:0.00057%,26:0.00038%,0:0.00038%,31:0.00019%,27:0.00019%,24:0.00019%,22:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:94.16824%,Multi Stage Multi Point:5.83176%]
[INFO] ** dst:[21:43.34556%,10:20.84934%,8:18.20359%,9:17.59849%,22:0.00076%,6:0.00057%,25:0.00038%,16:0.00038%,2:0.00038%,24:0.00019%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99716%,-33.760870000000004:0.00265%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99754%,0:0.00265%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.38866%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99868%,2:0.00132%]
[INFO] ** proxy_src_ip:[18:38.08299%,20:26.11267%,13:18.20302%,6:17.5983%,10:0.00113%,11:0.00095%,1:0.00038%,16:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.11172%,-0.32151:20.84934%,-1.27613:18.20265%,-0.23351:17.59811%,-0.33484:17.23365%,6.0369:0.00076%,-71.14798:0.00038%,1.47576:0.00038%,-64.19493:0.00038%,1.45709:0.00038%,1.46509:0.00019%,-68.79874000000001:0.00019%,-1.27347:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,6.15557:0.00019%,6.06224:0.00019%,8.55414:0.00019%,-3.3787199999999995:0.00019%,-4.3880099999999995:0.00019%,-71.14931:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:26.11153%,1:20.84915%,5:18.20246%,4:17.59773%,2:17.23365%,0:0.00548%]
[INFO] ** service:[0.0048200000000000005:99.99792%,-211.09762999999998:0.00057%,-211.08346:0.00038%,-186.44547:0.00038%,-211.35747999999998:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.08299%,9:26.11267%,7:18.20302%,1:17.5983%,11:0.00113%,10:0.00095%,3:0.00038%,21:0.00019%,15:0.00019%,2:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1446 (0.27335%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0075 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0065 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0058 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.6953 - tp: 66644.0000 - fp: 13356.0000 - tn: 306644.0000 - fn: 13356.0000 - accuracy: 0.9332 - precision: 0.8331 - recall: 0.8331 - auc: 0.8950 - val_loss: 2.9005 - val_tp: 16401.0000 - val_fp: 3599.0000 - val_tn: 76401.0000 - val_fn: 3599.0000 - val_accuracy: 0.9280 - val_precision: 0.8201 - val_recall: 0.8201 - val_auc: 0.8875
[INFO] saving weights to checkpoints/lstm-epoch-6-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.8034 - tp: 66105.0000 - fp: 13895.0000 - tn: 306105.0000 - fn: 13895.0000 - accuracy: 0.9305 - precision: 0.8263 - recall: 0.8263 - auc: 0.8907 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/529000
[33m[INFO] loading file 18-18/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529000, 17)

[INFO] analyzing data
[INFO] 529000 rows
[INFO] ** appi_name:[21:99.99811%,30:0.00057%,7:0.00057%,31:0.00019%,27:0.00019%,22:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:81.66389%,Multi Stage Multi Point:18.33611%]
[INFO] ** dst:[21:43.33894%,10:20.83251%,8:18.26578%,9:17.55974%,22:0.00076%,15:0.00057%,24:0.00038%,16:0.00038%,2:0.00038%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99943%,0:0.00057%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99811%,-33.760870000000004:0.00189%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99811%,0:0.00189%]
[INFO] ** modbus_transaction_id:65536 (12.38866%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99887%,2:0.00057%,1:0.00057%]
[INFO] ** proxy_src_ip:[18:38.07524%,20:26.09679%,13:18.26616%,6:17.55992%,17:0.00057%,11:0.00057%,1:0.00038%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.09603%,-0.32151:20.83251%,-1.27613:18.2656%,-0.23351:17.55955%,-0.33484:17.24272%,-71.33197:0.00057%,-1.27347:0.00038%,1.45709:0.00038%,-0.24151:0.00038%,1.47576:0.00019%,1.46509:0.00019%,3.6236699999999997:0.00019%,-1.2708:0.00019%,-2.48275:0.00019%,6.06224:0.00019%,-3.3787199999999995:0.00019%,8.10082:0.00019%,6.45955:0.00019%,-71.14931:0.00019%]
[INFO] ** scada_tag:[3:26.09565%,1:20.83233%,5:18.26541%,4:17.55936%,2:17.24253%,0:0.00473%]
[INFO] ** service:[0.0048200000000000005:99.99811%,-211.09762999999998:0.00057%,-211.73542999999998:0.00057%,-211.35747999999998:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.07524%,9:26.09679%,7:18.26616%,1:17.55992%,14:0.00057%,10:0.00057%,3:0.00038%,21:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1446 (0.27335%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.4112 - tp: 68051.0000 - fp: 11949.0000 - tn: 308051.0000 - fn: 11949.0000 - accuracy: 0.9403 - precision: 0.8506 - recall: 0.8506 - auc: 0.9061 - val_loss: 6.1208 - val_tp: 12405.0000 - val_fp: 7595.0000 - val_tn: 72405.0000 - val_fn: 7595.0000 - val_accuracy: 0.8481 - val_precision: 0.6202 - val_recall: 0.6202 - val_auc: 0.7627
[INFO] saving weights to checkpoints/lstm-epoch-6-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1158 - tp: 49657.0000 - fp: 30343.0000 - tn: 289657.0000 - fn: 30343.0000 - accuracy: 0.8483 - precision: 0.6207 - recall: 0.6207 - auc: 0.7615 - val_loss: 6.1636 - val_tp: 12352.0000 - val_fp: 7648.0000 - val_tn: 72352.0000 - val_fn: 7648.0000 - val_accuracy: 0.8470 - val_precision: 0.6176 - val_recall: 0.6176 - val_auc: 0.7610
[INFO] saving weights to checkpoints/lstm-epoch-6-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1386 - tp: 49543.0000 - fp: 30457.0000 - tn: 289543.0000 - fn: 30457.0000 - accuracy: 0.8477 - precision: 0.6193 - recall: 0.6193 - auc: 0.7606 - val_loss: 6.1136 - val_tp: 12414.0000 - val_fp: 7586.0000 - val_tn: 72414.0000 - val_fn: 7586.0000 - val_accuracy: 0.8483 - val_precision: 0.6207 - val_recall: 0.6207 - val_auc: 0.7629
[INFO] saving weights to checkpoints/lstm-epoch-6-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2893 - tp: 78580.0000 - fp: 1420.0000 - tn: 318580.0000 - fn: 1420.0000 - accuracy: 0.9929 - precision: 0.9822 - recall: 0.9822 - auc: 0.9888 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0029 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/529000
[33m[INFO] loading file 19-19/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529000, 17)

[INFO] analyzing data
[INFO] 529000 rows
[INFO] ** appi_name:[21:99.99792%,26:0.00038%,0:0.00038%,31:0.00019%,27:0.00019%,24:0.00019%,22:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:86.47259%,Single Stage Multi Point:13.52741%]
[INFO] ** dst:[21:43.3811%,10:20.8259%,8:18.21739%,9:17.57278%,22:0.00132%,6:0.00057%,25:0.00038%,24:0.00019%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99792%,-33.760870000000004:0.00189%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99773%,0:0.00189%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.38866%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99868%,2:0.00132%]
[INFO] ** proxy_src_ip:[18:38.11304%,20:26.09414%,13:18.21739%,6:17.57278%,10:0.00113%,11:0.00095%,16:0.00057%]
[INFO] ** s_port:[1.45442:26.09301%,-0.32151:20.8259%,-1.27613:18.21701%,-0.23351:17.57259%,-0.33484:17.28715%,-5.20264:0.00076%,1.45709:0.00057%,-1.02014:0.00057%,-64.19493:0.00038%,-71.14798:0.00038%,1.46509:0.00038%,-1.27347:0.00019%,-0.24151:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-71.14931:0.00019%,-68.79874000000001:0.00019%,0.75578:0.00019%]
[INFO] ** scada_tag:[3:26.09263%,1:20.82571%,5:18.21682%,4:17.5724%,2:17.28696%,0:0.00548%]
[INFO] ** service:[0.0048200000000000005:99.99868%,-211.08346:0.00038%,-186.44547:0.00038%,-202.75898:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.11304%,9:26.09414%,7:18.21739%,1:17.57278%,11:0.00113%,10:0.00095%,15:0.00057%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1447 (0.27353%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0025 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0021 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0019 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.4574 - tp: 62846.0000 - fp: 17154.0000 - tn: 302846.0000 - fn: 17154.0000 - accuracy: 0.9142 - precision: 0.7856 - recall: 0.7856 - auc: 0.8652 - val_loss: 9.8095 - val_tp: 7828.0000 - val_fp: 12172.0000 - val_tn: 67828.0000 - val_fn: 12172.0000 - val_accuracy: 0.7566 - val_precision: 0.3914 - val_recall: 0.3914 - val_auc: 0.6196
[INFO] saving weights to checkpoints/lstm-epoch-6-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.5099 - tp: 37766.0000 - fp: 42234.0000 - tn: 277766.0000 - fn: 42234.0000 - accuracy: 0.7888 - precision: 0.4721 - recall: 0.4721 - auc: 0.6680 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/529000
[33m[INFO] loading file 20-20/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529000, 17)

[INFO] analyzing data
[INFO] 529000 rows
[INFO] ** appi_name:[21:99.99641%,30:0.00302%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:92.2535%,Single Stage Multi Point:7.7465%]
[INFO] ** dst:[21:43.42476%,10:20.83913%,8:18.16616%,9:17.56484%,15:0.00302%,22:0.00113%,24:0.00038%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99735%,0:0.00265%]
[INFO] ** i/f_name:[2:99.99698%,3:0.00302%]
[INFO] ** modbus_function_code:[0.02961:99.99641%,-33.760870000000004:0.00359%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99679%,0:0.00359%]
[INFO] ** modbus_transaction_id:65536 (12.38866%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99641%,1:0.00302%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.11739%,20:26.14707%,13:18.16635%,6:17.56541%,17:0.00302%,14:0.00057%,16:0.00019%]
[INFO] ** s_port:[1.45442:26.14631%,-0.32151:20.83913%,-1.27613:18.16578%,-0.23351:17.56465%,-0.33484:17.27826%,-71.33197:0.00302%,-0.24151:0.00057%,1.45709:0.00038%,-1.27347:0.00038%,13.431270000000001:0.00019%,-1.2708:0.00019%,-1.02014:0.00019%,-71.14798:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,11.862:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:26.14594%,1:20.83894%,5:18.16578%,4:17.56427%,2:17.27807%,0:0.00699%]
[INFO] ** service:[0.0048200000000000005:99.99641%,-211.73542999999998:0.00302%,-211.08346:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.11739%,9:26.14707%,7:18.16635%,1:17.56541%,14:0.00302%,2:0.00057%,15:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1446 (0.27335%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0014 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9559 - val_tp: 17573.0000 - val_fp: 2427.0000 - val_tn: 77573.0000 - val_fn: 2427.0000 - val_accuracy: 0.9515 - val_precision: 0.8787 - val_recall: 0.8787 - val_auc: 0.9242
[INFO] saving weights to checkpoints/lstm-epoch-6-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9451 - tp: 65387.0000 - fp: 14613.0000 - tn: 305387.0000 - fn: 14613.0000 - accuracy: 0.9269 - precision: 0.8173 - recall: 0.8173 - auc: 0.8852 - val_loss: 2.9327 - val_tp: 16361.0000 - val_fp: 3639.0000 - val_tn: 76361.0000 - val_fn: 3639.0000 - val_accuracy: 0.9272 - val_precision: 0.8181 - val_recall: 0.8181 - val_auc: 0.8863
[INFO] saving weights to checkpoints/lstm-epoch-6-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9503 - tp: 65361.0000 - fp: 14639.0000 - tn: 305361.0000 - fn: 14639.0000 - accuracy: 0.9268 - precision: 0.8170 - recall: 0.8170 - auc: 0.8849 - val_loss: 2.9222 - val_tp: 16374.0000 - val_fp: 3626.0000 - val_tn: 76374.0000 - val_fn: 3626.0000 - val_accuracy: 0.9275 - val_precision: 0.8187 - val_recall: 0.8187 - val_auc: 0.8867
[INFO] saving weights to checkpoints/lstm-epoch-6-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 3s - loss: 0.4109 - tp: 77965.0000 - fp: 2035.0000 - tn: 317965.0000 - fn: 2035.0000 - accuracy: 0.9898 - precision: 0.9746 - recall: 0.9746 - auc: 0.9840 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.3896e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/529000
[33m[INFO] loading file 21-21/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (528998, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (528998, 17)

[INFO] analyzing data
[INFO] 528998 rows
[INFO] ** appi_name:[21:99.99622%,30:0.00076%,7:0.00057%,26:0.00038%,22:0.00038%,0:0.00038%,31:0.00019%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:98.84631%,Multi Stage Single Point:1.15369%]
[INFO] ** dst:[21:43.30489%,10:20.99403%,8:18.16963%,9:17.5271%,22:0.00095%,15:0.00076%,6:0.00076%,25:0.00038%,24:0.00038%,16:0.00038%,2:0.00038%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99924%,0:0.00076%]
[INFO] ** i/f_name:[2:99.99924%,3:0.00076%]
[INFO] ** modbus_function_code:[0.02961:99.99622%,-33.760870000000004:0.00359%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99868%,11:49.99754%,0:0.00359%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.3887%)
[INFO] ** orig:[0:99.99924%,2:0.00076%]
[INFO] ** proto:[0:99.99773%,2:0.00151%,1:0.00076%]
[INFO] ** proxy_src_ip:[18:38.32529%,20:25.97344%,13:18.16982%,6:17.5271%,10:0.00113%,11:0.00095%,17:0.00076%,16:0.00057%,1:0.00038%,21:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.97288%,-0.32151:20.99327%,-1.27613:18.16944%,-0.23351:17.52691%,-0.33484:17.33201%,-71.33197:0.00076%,-6.64392:0.00076%,-1.02014:0.00057%,-1.27347:0.00038%,-64.19493:0.00038%,-71.14931:0.00038%,-71.14798:0.00038%,1.47576:0.00019%,1.46509:0.00019%,6.62488:0.00019%,10.15141:0.00019%,-68.79874000000001:0.00019%,7.060860000000001:0.00019%,-3.3787199999999995:0.00019%,-2.2440900000000004:0.00019%,1.45709:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.9725%,1:20.99309%,5:18.16926%,4:17.52672%,2:17.33201%,0:0.00643%]
[INFO] ** service:[0.0048200000000000005:99.99698%,-211.73542999999998:0.00076%,-211.09762999999998:0.00057%,-211.08346:0.00038%,-186.44547:0.00038%,-211.08818:0.00038%,-211.35747999999998:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.32529%,9:25.97344%,7:18.16982%,1:17.5271%,11:0.00113%,21:0.00095%,10:0.00095%,15:0.00057%,3:0.00038%,4:0.00019%,2:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1440 (0.27221%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/528998
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.2977e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/528998
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.3682e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/528998
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.5092e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/528998
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.0019e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/528998
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.3272e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/528998
[33m[INFO] loading file 22-22/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (298039, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (298039, 17)

[INFO] analyzing data
[INFO] 298039 rows
[INFO] ** appi_name:[21:99.99228%,30:0.00671%,23:0.00034%,22:0.00034%,18:0.00034%]
[INFO] ** classification:[normal:55.52528%,Multi Stage Single Point:44.47472%]
[INFO] ** dst:[21:43.3044%,10:21.00094%,8:18.11307%,9:17.57253%,15:0.00671%,22:0.00134%,19:0.00067%,26:0.00034%]
[INFO] ** i/f_dir:[1:99.99362%,0:0.00638%]
[INFO] ** i/f_name:[2:99.99329%,3:0.00638%,0:0.00034%]
[INFO] ** modbus_function_code:[0.02961:99.99228%,-33.760870000000004:0.00772%]
[INFO] ** modbus_function_description:[7:49.99715%,11:49.99513%,0:0.00772%]
[INFO] ** modbus_transaction_id:65534 (21.9884%)
[INFO] ** orig:[0:99.99497%,2:0.00436%,1:0.00067%]
[INFO] ** proto:[0:99.99295%,1:0.00671%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.32653%,20:25.97982%,13:18.11239%,6:17.57354%,17:0.00671%,14:0.00067%,10:0.00034%]
[INFO] ** s_port:[1.45442:25.97881%,-0.32151:21.00094%,-1.27613:18.11239%,-0.23351:17.57253%,-0.33484:17.32558%,-71.33197:0.00671%,1.45709:0.00067%,-0.24151:0.00067%,7.228860000000001:0.00067%,-0.24950999999999998:0.00034%,1.46509:0.00034%,-71.14931:0.00034%]
[INFO] ** scada_tag:[3:25.97848%,1:21.00094%,5:18.11239%,4:17.5722%,2:17.32558%,0:0.0104%]
[INFO] ** service:[0.0048200000000000005:99.99228%,-211.73542999999998:0.00671%,-211.07873999999998:0.00067%,-211.08818:0.00034%]
[INFO] ** src:[22:38.32653%,9:25.97982%,7:18.11239%,1:17.57354%,21:0.00436%,14:0.00235%,2:0.00067%,11:0.00034%]
[INFO] ** type:[0:99.99799%,1:0.00201%]
[INFO] ** unixtime:823 (0.27614%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/298039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.0516 - tp: 49965.0000 - fp: 30035.0000 - tn: 289965.0000 - fn: 30035.0000 - accuracy: 0.8498 - precision: 0.6246 - recall: 0.6246 - auc: 0.7638 - val_loss: 7.5473 - val_tp: 10635.0000 - val_fp: 9365.0000 - val_tn: 70635.0000 - val_fn: 9365.0000 - val_accuracy: 0.8127 - val_precision: 0.5318 - val_recall: 0.5318 - val_auc: 0.7073
[INFO] saving weights to checkpoints/lstm-epoch-6-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/298039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5862 - tp: 42348.0000 - fp: 37652.0000 - tn: 282348.0000 - fn: 37652.0000 - accuracy: 0.8117 - precision: 0.5293 - recall: 0.5293 - auc: 0.7041 - val_loss: 7.6061 - val_tp: 10562.0000 - val_fp: 9438.0000 - val_tn: 70562.0000 - val_fn: 9438.0000 - val_accuracy: 0.8112 - val_precision: 0.5281 - val_recall: 0.5281 - val_auc: 0.7051
[INFO] saving weights to checkpoints/lstm-epoch-6-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/298039
[33m[INFO] loading file 23-23/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598039, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598039, 17)

[INFO] analyzing data
[INFO] 598039 rows
[INFO] ** appi_name:[21:99.99816%,30:0.00117%,31:0.00033%,33:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:90.78706%,Multi Stage Single Point:9.21294%]
[INFO] ** dst:[21:43.32443%,10:21.00749%,8:18.1326%,9:17.53247%,15:0.00117%,22:0.001%,24:0.00033%,18:0.00033%,25:0.00017%]
[INFO] ** i/f_dir:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name:[2:99.99883%,3:0.00117%]
[INFO] ** modbus_function_code:[0.02961:99.99816%,-33.760870000000004:0.00184%]
[INFO] ** modbus_function_description:[7:50.00008%,11:49.99808%,0:0.00184%]
[INFO] ** modbus_transaction_id:65536 (10.95848%)
[INFO] ** orig:[0:99.99933%,2:0.00067%]
[INFO] ** proto:[0:99.99833%,1:0.00117%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.34967%,20:25.98275%,13:18.1326%,6:17.53264%,17:0.00117%,16:0.0005%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.98192%,-0.32151:21.00733%,-1.27613:18.1321%,-0.23351:17.5323%,-0.33484:17.34235%,-71.33197:0.00117%,-1.02014:0.0005%,-0.08551:0.00033%,-1.27347:0.00033%,1.45709:0.00033%,1.46509:0.00033%,-0.24151:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:25.98158%,1:21.00733%,5:18.13193%,4:17.53213%,2:17.34218%,0:0.00485%]
[INFO] ** service:[0.0048200000000000005:99.99833%,-211.73542999999998:0.00117%,-186.43601999999998:0.00033%,-186.44547:0.00017%]
[INFO] ** src:[22:38.34967%,9:25.98275%,7:18.1326%,1:17.53264%,21:0.00067%,15:0.0005%,14:0.0005%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99967%,1:0.00033%]
[INFO] ** unixtime:1629 (0.27239%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5805 - tp: 42376.0000 - fp: 37624.0000 - tn: 282376.0000 - fn: 37624.0000 - accuracy: 0.8119 - precision: 0.5297 - recall: 0.5297 - auc: 0.7042 - val_loss: 7.5400 - val_tp: 10644.0000 - val_fp: 9356.0000 - val_tn: 70644.0000 - val_fn: 9356.0000 - val_accuracy: 0.8129 - val_precision: 0.5322 - val_recall: 0.5322 - val_auc: 0.7076
[INFO] saving weights to checkpoints/lstm-epoch-6-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 3s - loss: 1.6356 - tp: 71883.0000 - fp: 8117.0000 - tn: 311883.0000 - fn: 8117.0000 - accuracy: 0.9594 - precision: 0.8985 - recall: 0.8985 - auc: 0.9362 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.6716e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.2269e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.9200e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/598039
[33m[INFO] loading file 24-24/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598039, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598039, 17)

[INFO] analyzing data
[INFO] 598039 rows
[INFO] ** appi_name:[21:99.99381%,30:0.00301%,26:0.0005%,31:0.00033%,27:0.00033%,22:0.00033%,0:0.00033%,24:0.00017%,23:0.00017%,19:0.00017%,18:0.00017%,16:0.00017%,15:0.00017%,11:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:95.73941%,Multi Stage Single Point:4.26059%]
[INFO] ** dst:[21:43.3669%,10:21.00749%,8:18.10267%,9:17.51625%,15:0.00301%,22:0.00117%,6:0.00067%,25:0.00033%,24:0.00033%,19:0.00033%,18:0.00033%,7:0.00033%,26:0.00017%]
[INFO] ** i/f_dir:[1:99.99716%,0:0.00284%]
[INFO] ** i/f_name:[2:99.99699%,3:0.00301%]
[INFO] ** modbus_function_code:[0.02961:99.99381%,-33.760870000000004:0.00569%,-0.415:0.00017%,0.9188299999999999:0.00017%,0.47422:0.00017%]
[INFO] ** modbus_function_description:[7:49.99808%,11:49.99574%,0:0.00569%,15:0.00017%,10:0.00017%,2:0.00017%]
[INFO] ** modbus_transaction_id:65536 (10.95848%)
[INFO] ** orig:[0:99.99967%,1:0.00033%]
[INFO] ** proto:[0:99.99515%,1:0.00301%,2:0.00184%]
[INFO] ** proxy_src_ip:[18:38.38111%,20:25.99429%,13:18.1025%,6:17.51558%,17:0.00301%,10:0.00117%,14:0.00084%,11:0.00084%,21:0.00033%,16:0.00033%]
[INFO] ** s_port:[1.45442:25.99329%,-0.32151:21.00749%,-1.27613:18.10216%,-0.23351:17.51491%,-0.33484:17.37362%,-71.33197:0.00301%,-9.58113:0.00067%,-71.14798:0.0005%,1.45709:0.0005%,-0.24950999999999998:0.00033%,-1.27347:0.00033%,-0.24151:0.00033%,-1.02014:0.00033%,-31.55091:0.00033%,7.6315100000000005:0.00033%,-71.14931:0.00033%,-64.19493:0.00033%,1.47576:0.00033%,-68.79874000000001:0.00017%,1.46509:0.00017%,7.4901800000000005:0.00017%,13.431270000000001:0.00017%,11.862:0.00017%]
[INFO] ** scada_tag:[3:25.99295%,1:21.00749%,5:18.102%,4:17.51441%,2:17.37345%,0:0.0097%]
[INFO] ** service:[0.0048200000000000005:99.99482%,-211.73542999999998:0.00301%,-211.08346:0.0005%,-211.07873999999998:0.00033%,-202.75898:0.00033%,-186.44547:0.00033%,-186.43601999999998:0.00033%,-211.08818:0.00033%]
[INFO] ** src:[22:38.38111%,9:25.99429%,7:18.1025%,1:17.51558%,14:0.00301%,11:0.00117%,10:0.00084%,2:0.00084%,15:0.00033%,4:0.00033%]
[INFO] ** type:[0:99.99883%,1:0.00084%,2:0.00033%]
[INFO] ** unixtime:1625 (0.27172%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.7367e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.5213e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2983e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.1499e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0596e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/598039
[33m[INFO] loading file 25-25/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598039, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598039, 17)

[INFO] analyzing data
[INFO] 598039 rows
[INFO] ** appi_name:[21:99.99666%,30:0.001%,17:0.00067%,22:0.0005%,31:0.00033%,28:0.00017%,26:0.00017%,12:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** classification:[normal:65.92045%,Multi Stage Single Point:34.07955%]
[INFO] ** dst:[21:43.32945%,10:21.03224%,8:18.12524%,9:17.50906%,15:0.001%,22:0.00084%,16:0.00067%,6:0.00067%,18:0.00033%,17:0.00033%,24:0.00017%]
[INFO] ** i/f_dir:[1:99.999%,0:0.001%]
[INFO] ** i/f_name:[2:99.999%,3:0.001%]
[INFO] ** modbus_function_code:[0.02961:99.99666%,-33.760870000000004:0.00334%]
[INFO] ** modbus_function_description:[7:49.99908%,11:49.99758%,0:0.00334%]
[INFO] ** modbus_transaction_id:65536 (10.95848%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99799%,2:0.001%,1:0.001%]
[INFO] ** proxy_src_ip:[18:38.39816%,20:25.96352%,13:18.12524%,6:17.50939%,17:0.001%,1:0.00084%,21:0.00067%,16:0.00033%,14:0.00033%,7:0.00033%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.96302%,-0.32151:21.03191%,-1.27613:18.1249%,-0.23351:17.50889%,-0.33484:17.36626%,-71.33197:0.001%,-71.14931:0.0005%,-49.275529999999996:0.00033%,-0.24151:0.00033%,-1.02014:0.00033%,-58.032509999999995:0.00017%,-5.08665:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,2.52505:0.00017%,-71.14798:0.00017%,-58.035180000000004:0.00017%,-1.2708:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.96269%,1:21.03174%,5:18.12474%,4:17.50872%,2:17.36609%,0:0.00602%]
[INFO] ** service:[0.0048200000000000005:99.99699%,-211.73542999999998:0.001%,-205.44247:0.00067%,-211.08818:0.0005%,-186.43601999999998:0.00033%,-211.09762999999998:0.00017%,-211.08346:0.00017%,-185.9872:0.00017%]
[INFO] ** src:[22:38.39816%,9:25.96352%,7:18.12524%,1:17.50939%,14:0.001%,3:0.00084%,4:0.00067%,21:0.00033%,15:0.00033%,2:0.00033%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1625 (0.27172%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.8394 - tp: 60944.0000 - fp: 19056.0000 - tn: 300944.0000 - fn: 19056.0000 - accuracy: 0.9047 - precision: 0.7618 - recall: 0.7618 - auc: 0.8511 - val_loss: 5.7421 - val_tp: 12875.0000 - val_fp: 7125.0000 - val_tn: 72875.0000 - val_fn: 7125.0000 - val_accuracy: 0.8575 - val_precision: 0.6438 - val_recall: 0.6438 - val_auc: 0.7773
[INFO] saving weights to checkpoints/lstm-epoch-6-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7560 - tp: 51431.0000 - fp: 28569.0000 - tn: 291431.0000 - fn: 28569.0000 - accuracy: 0.8572 - precision: 0.6429 - recall: 0.6429 - auc: 0.7768 - val_loss: 5.7614 - val_tp: 12851.0000 - val_fp: 7149.0000 - val_tn: 72851.0000 - val_fn: 7149.0000 - val_accuracy: 0.8570 - val_precision: 0.6425 - val_recall: 0.6425 - val_auc: 0.7766
[INFO] saving weights to checkpoints/lstm-epoch-6-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7407 - tp: 51507.0000 - fp: 28493.0000 - tn: 291507.0000 - fn: 28493.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.7774 - val_loss: 5.7896 - val_tp: 12816.0000 - val_fp: 7184.0000 - val_tn: 72816.0000 - val_fn: 7184.0000 - val_accuracy: 0.8563 - val_precision: 0.6408 - val_recall: 0.6408 - val_auc: 0.7755
[INFO] saving weights to checkpoints/lstm-epoch-6-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7435 - tp: 51493.0000 - fp: 28507.0000 - tn: 291493.0000 - fn: 28507.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.7773 - val_loss: 5.7227 - val_tp: 12899.0000 - val_fp: 7101.0000 - val_tn: 72899.0000 - val_fn: 7101.0000 - val_accuracy: 0.8580 - val_precision: 0.6449 - val_recall: 0.6449 - val_auc: 0.7781
[INFO] saving weights to checkpoints/lstm-epoch-6-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7568 - tp: 51427.0000 - fp: 28573.0000 - tn: 291427.0000 - fn: 28573.0000 - accuracy: 0.8571 - precision: 0.6428 - recall: 0.6428 - auc: 0.7768 - val_loss: 5.7227 - val_tp: 12899.0000 - val_fp: 7101.0000 - val_tn: 72899.0000 - val_fn: 7101.0000 - val_accuracy: 0.8580 - val_precision: 0.6449 - val_recall: 0.6449 - val_auc: 0.7781
[INFO] saving weights to checkpoints/lstm-epoch-6-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/598039
[33m[INFO] loading file 26-26/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598039, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598039, 17)

[INFO] analyzing data
[INFO] 598039 rows
[INFO] ** appi_name:[21:99.99833%,30:0.0005%,7:0.0005%,31:0.00017%,22:0.00017%,12:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:64.39329%,Single Stage Single Point:26.70595%,Multi Stage Single Point:8.90076%]
[INFO] ** dst:[21:43.30654%,10:21.08441%,8:18.12691%,9:17.47946%,22:0.00084%,15:0.0005%,24:0.00033%,16:0.00033%,2:0.00033%,18:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.9995%,0:0.0005%]
[INFO] ** i/f_name:[2:99.9995%,3:0.0005%]
[INFO] ** modbus_function_code:[0.02961:99.99833%,-33.760870000000004:0.00167%]
[INFO] ** modbus_function_description:[7:49.99975%,11:49.99858%,0:0.00167%]
[INFO] ** modbus_transaction_id:65536 (10.95848%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99916%,1:0.0005%,2:0.00033%]
[INFO] ** proxy_src_ip:[18:38.46054%,20:25.93058%,13:18.12725%,6:17.47963%,17:0.0005%,1:0.0005%,21:0.00033%,16:0.00033%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.93008%,-0.32151:21.08424%,-1.27613:18.12674%,-0.23351:17.47929%,-0.33484:17.37629%,-71.33197:0.0005%,-1.02014:0.00033%,-1.27347:0.00033%,-0.24151:0.00033%,-49.275529999999996:0.00017%,1.47576:0.00017%,1.45709:0.00017%,1.46509:0.00017%,-1.2708:0.00017%,14.191239999999999:0.00017%,2.52505:0.00017%,-3.3787199999999995:0.00017%,11.57001:0.00017%,-71.14931:0.00017%,7.66617:0.00017%]
[INFO] ** scada_tag:[3:25.92975%,1:21.08424%,5:18.12658%,4:17.47913%,2:17.37629%,0:0.00401%]
[INFO] ** service:[0.0048200000000000005:99.9985%,-211.09762999999998:0.0005%,-211.73542999999998:0.0005%,-211.35747999999998:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.46054%,9:25.93058%,7:18.12725%,1:17.47963%,14:0.0005%,3:0.0005%,15:0.00033%,4:0.00033%,21:0.00017%,2:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1623 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7419 - tp: 51501.0000 - fp: 28499.0000 - tn: 291501.0000 - fn: 28499.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.7774 - val_loss: 5.7638 - val_tp: 12848.0000 - val_fp: 7152.0000 - val_tn: 72848.0000 - val_fn: 7152.0000 - val_accuracy: 0.8570 - val_precision: 0.6424 - val_recall: 0.6424 - val_auc: 0.7765
[INFO] saving weights to checkpoints/lstm-epoch-6-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.2005 - tp: 53964.0000 - fp: 26036.0000 - tn: 293964.0000 - fn: 26036.0000 - accuracy: 0.8698 - precision: 0.6745 - recall: 0.6745 - auc: 0.8091 - val_loss: 0.0591 - val_tp: 19476.0000 - val_fp: 524.0000 - val_tn: 79476.0000 - val_fn: 524.0000 - val_accuracy: 0.9895 - val_precision: 0.9738 - val_recall: 0.9738 - val_auc: 0.9998
[INFO] saving weights to checkpoints/lstm-epoch-6-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0786 - tp: 78341.0000 - fp: 1659.0000 - tn: 318341.0000 - fn: 1659.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9993 - val_loss: 1.5632e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0566 - tp: 78971.0000 - fp: 1029.0000 - tn: 318971.0000 - fn: 1029.0000 - accuracy: 0.9949 - precision: 0.9871 - recall: 0.9871 - auc: 0.9997 - val_loss: 8.7819e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0533 - tp: 79077.0000 - fp: 923.0000 - tn: 319077.0000 - fn: 923.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9997 - val_loss: 6.0451e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/598039
[33m[INFO] loading file 27-27/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (538169, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (538169, 17)

[INFO] analyzing data
[INFO] 538169 rows
[INFO] ** appi_name:[21:99.99944%,30:0.00056%]
[INFO] ** classification:[normal:64.35283%,Single Stage Single Point:35.64717%]
[INFO] ** dst:[21:43.28399%,10:21.06717%,8:18.16994%,9:17.47741%,22:0.00074%,15:0.00056%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.99944%,-33.760870000000004:0.00056%]
[INFO] ** modbus_function_description:[7:50.00028%,11:49.99916%,0:0.00056%]
[INFO] ** modbus_transaction_id:65536 (12.17759%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99944%,1:0.00056%]
[INFO] ** proxy_src_ip:[18:38.41953%,20:25.93219%,13:18.16976%,6:17.4776%,17:0.00056%,16:0.00037%]
[INFO] ** s_port:[1.45442:25.93163%,-0.32151:21.06717%,-1.27613:18.16957%,-0.23351:17.47722%,-0.33484:17.35236%,-71.33197:0.00056%,-1.02014:0.00037%,-1.27347:0.00019%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.93126%,1:21.06699%,5:18.16939%,4:17.47704%,2:17.35217%,0:0.00316%]
[INFO] ** service:[0.0048200000000000005:99.99944%,-211.73542999999998:0.00056%]
[INFO] ** src:[22:38.41953%,9:25.93219%,7:18.16976%,1:17.4776%,14:0.00056%,15:0.00037%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1461 (0.27148%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/538169
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0535 - tp: 79028.0000 - fp: 972.0000 - tn: 319028.0000 - fn: 972.0000 - accuracy: 0.9951 - precision: 0.9879 - recall: 0.9879 - auc: 0.9997 - val_loss: 2.3994e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/538169
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0476 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9998 - val_loss: 1.3740e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/538169
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0419 - tp: 79179.0000 - fp: 821.0000 - tn: 319179.0000 - fn: 821.0000 - accuracy: 0.9959 - precision: 0.9897 - recall: 0.9897 - auc: 0.9998 - val_loss: 1.0466e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/538169
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0417 - tp: 79143.0000 - fp: 857.0000 - tn: 319143.0000 - fn: 857.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9998 - val_loss: 8.1385e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/538169
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0430 - tp: 79062.0000 - fp: 938.0000 - tn: 319062.0000 - fn: 938.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9998 - val_loss: 6.5121e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-26-27-batch-400000-500000
[INFO] processing batch 500000-600000/538169
[33m[INFO] loading file 28-28/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (372085, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (372085, 17)

[INFO] analyzing data
[INFO] 372085 rows
[INFO] ** appi_name:[21:99.99221%,30:0.00161%,17:0.00134%,22:0.00108%,7:0.00108%,31:0.00081%,26:0.00081%,28:0.00027%,27:0.00027%,8:0.00027%,0:0.00027%]
[INFO] ** classification:[normal:64.30654%,Single Stage Single Point:35.69346%]
[INFO] ** dst:[21:43.27775%,10:21.02073%,8:18.20821%,9:17.48498%,6:0.00215%,16:0.00188%,18:0.00134%,22:0.00054%,17:0.00054%,15:0.00054%,2:0.00054%,25:0.00027%,7:0.00027%,0:0.00027%]
[INFO] ** i/f_dir:[1:99.99946%,0:0.00054%]
[INFO] ** i/f_name:[2:99.99946%,3:0.00054%]
[INFO] ** modbus_function_code:[0.02961:99.99221%,-33.760870000000004:0.00779%]
[INFO] ** modbus_function_description:[11:49.9961%,7:49.9961%,0:0.00779%]
[INFO] ** modbus_transaction_id:65535 (17.61291%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99543%,2:0.00403%,1:0.00054%]
[INFO] ** proxy_src_ip:[18:38.3356%,20:25.96288%,13:18.20847%,6:17.48525%,1:0.00215%,17:0.00161%,14:0.00161%,7:0.00134%,21:0.00081%,0:0.00027%]
[INFO] ** s_port:[1.45442:25.96262%,-0.32151:21.02073%,-1.27613:18.20821%,-0.23351:17.48471%,-0.33484:17.31486%,-71.14798:0.00108%,-71.14931:0.00108%,-71.33197:0.00054%,-0.08551:0.00054%,-0.24151:0.00054%,7.66617:0.00027%,-58.035180000000004:0.00027%,-1.2708:0.00027%,-64.19493:0.00027%,-5.1466400000000005:0.00027%,13.431270000000001:0.00027%,11.57001:0.00027%,14.4699:0.00027%,1.47576:0.00027%,14.191239999999999:0.00027%,-5.08665:0.00027%,10.192739999999999:0.00027%,-3.3787199999999995:0.00027%,6.1115699999999995:0.00027%,2.05573:0.00027%,-43.76509:0.00027%,2.52505:0.00027%,11.862:0.00027%,-58.032509999999995:0.00027%]
[INFO] ** scada_tag:[3:25.96262%,1:21.02073%,5:18.20821%,4:17.48445%,2:17.31486%,0:0.00914%]
[INFO] ** service:[0.0048200000000000005:99.99221%,-205.44247:0.00134%,-186.43601999999998:0.00134%,-211.09762999999998:0.00108%,-211.08346:0.00108%,-211.08818:0.00108%,-211.73542999999998:0.00054%,-186.44547:0.00027%,-183.8612:0.00027%,-185.9872:0.00027%,-211.35747999999998:0.00027%,-202.75898:0.00027%]
[INFO] ** src:[22:38.3356%,9:25.96288%,7:18.20847%,1:17.48525%,3:0.00242%,2:0.00161%,21:0.00134%,4:0.00108%,14:0.00054%,8:0.00054%,17:0.00027%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1011 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/372085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0388 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9998 - val_loss: 8.8000e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/372085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0368 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9998 - val_loss: 4.4965e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/372085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0356 - tp: 79072.0000 - fp: 928.0000 - tn: 319072.0000 - fn: 928.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9998 - val_loss: 6.5078e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/372085
[33m[INFO] loading file 29-29/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (572085, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (572085, 17)

[INFO] analyzing data
[INFO] 572085 rows
[INFO] ** appi_name:[21:99.99878%,30:0.00052%,31:0.00017%,26:0.00017%,9:0.00017%,3:0.00017%]
[INFO] ** classification:[normal:64.38973%,Single Stage Single Point:35.61027%]
[INFO] ** dst:[21:43.32853%,10:21.05981%,8:18.14346%,9:17.46646%,22:0.00052%,15:0.00052%,24:0.00017%,18:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99965%,0:0.00035%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.99878%,-33.760870000000004:0.00122%]
[INFO] ** modbus_function_description:[7:49.99974%,11:49.99904%,0:0.00122%]
[INFO] ** modbus_transaction_id:65536 (11.45564%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99913%,1:0.00052%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.43502%,20:25.95349%,13:18.14381%,6:17.46629%,17:0.00052%,21:0.00017%,16:0.00017%,7:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95296%,-0.32151:21.05963%,-1.27613:18.14346%,-0.23351:17.46629%,-0.33484:17.37539%,-71.33197:0.00052%,1.45709:0.00035%,-71.14798:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,6.1115699999999995:0.00017%,14.4699:0.00017%]
[INFO] ** scada_tag:[3:25.95261%,1:21.05946%,5:18.14346%,4:17.46594%,2:17.37539%,0:0.00315%]
[INFO] ** service:[0.0048200000000000005:99.99895%,-211.73542999999998:0.00052%,-183.8612:0.00017%,-211.08346:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.43502%,9:25.95349%,7:18.14381%,1:17.46629%,14:0.00052%,21:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1554 (0.27164%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0326 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9998 - val_loss: 5.3466e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0294 - tp: 79147.0000 - fp: 853.0000 - tn: 319147.0000 - fn: 853.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9998 - val_loss: 3.4721e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0269 - tp: 79185.0000 - fp: 815.0000 - tn: 319185.0000 - fn: 815.0000 - accuracy: 0.9959 - precision: 0.9898 - recall: 0.9898 - auc: 0.9998 - val_loss: 8.0817e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0278 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.8527e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0273 - tp: 79075.0000 - fp: 925.0000 - tn: 319075.0000 - fn: 925.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.4754e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/572085
[33m[INFO] loading file 30-30/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (572085, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (572085, 17)

[INFO] analyzing data
[INFO] 572085 rows
[INFO] ** appi_name:[21:99.99755%,30:0.00175%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.36963%,Single Stage Single Point:35.63037%]
[INFO] ** dst:[21:43.33709%,10:21.02957%,8:18.14765%,9:17.48237%,15:0.00175%,22:0.0007%,24:0.00035%,25:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99843%,0:0.00157%]
[INFO] ** i/f_name:[2:99.99825%,3:0.00175%]
[INFO] ** modbus_function_code:[0.02961:99.99755%,-33.760870000000004:0.00245%]
[INFO] ** modbus_function_description:[7:49.99956%,11:49.99799%,0:0.00245%]
[INFO] ** modbus_transaction_id:65536 (11.45564%)
[INFO] ** orig:[0:99.99913%,2:0.00052%,1:0.00035%]
[INFO] ** proto:[0:99.9979%,1:0.00175%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.37192%,20:25.99456%,13:18.148%,6:17.48289%,17:0.00175%,7:0.00035%,16:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.99439%,-0.32151:21.02939%,-1.27613:18.14748%,-0.23351:17.48219%,-0.33484:17.34253%,-71.33197:0.00175%,-0.24151:0.00052%,-1.27347:0.00035%,-71.14798:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:25.99404%,1:21.02939%,5:18.1473%,4:17.48202%,2:17.34235%,0:0.00489%]
[INFO] ** service:[0.0048200000000000005:99.99773%,-211.73542999999998:0.00175%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.37192%,9:25.99456%,7:18.148%,1:17.48289%,14:0.00122%,21:0.00087%,16:0.00017%,15:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99913%,1:0.00087%]
[INFO] ** unixtime:1555 (0.27181%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0259 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 2.5969e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0254 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.4881e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0246 - tp: 79139.0000 - fp: 861.0000 - tn: 319139.0000 - fn: 861.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.5746e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0251 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.2071e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0251 - tp: 79066.0000 - fp: 934.0000 - tn: 319066.0000 - fn: 934.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/572085
[33m[INFO] loading file 31-31/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (572085, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (572085, 17)

[INFO] analyzing data
[INFO] 572085 rows
[INFO] ** appi_name:[21:99.99965%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.37575%,Single Stage Single Point:35.62425%]
[INFO] ** dst:[21:43.32468%,10:21.04949%,8:18.12003%,9:17.50404%,22:0.00105%,24:0.00035%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99965%,-33.760870000000004:0.00035%]
[INFO] ** modbus_function_description:[7:49.99991%,11:49.99974%,0:0.00035%]
[INFO] ** modbus_transaction_id:65536 (11.45564%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.39342%,20:25.98145%,13:18.12021%,6:17.50404%,16:0.00052%,7:0.00035%]
[INFO] ** s_port:[1.45442:25.98075%,-0.32151:21.04949%,-1.27613:18.11986%,-0.23351:17.50387%,-0.33484:17.34393%,-1.02014:0.00052%,-1.27347:0.00035%,1.45709:0.00035%,-71.14798:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-0.24151:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.98041%,1:21.04932%,5:18.11969%,4:17.50352%,2:17.34375%,0:0.00332%]
[INFO] ** service:[0.0048200000000000005:99.99965%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.39342%,9:25.98145%,7:18.12021%,1:17.50404%,15:0.00052%,21:0.00035%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1554 (0.27164%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0236 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0225 - tp: 79153.0000 - fp: 847.0000 - tn: 319153.0000 - fn: 847.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0237 - tp: 79106.0000 - fp: 894.0000 - tn: 319106.0000 - fn: 894.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0233 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0232 - tp: 79124.0000 - fp: 876.0000 - tn: 319124.0000 - fn: 876.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/572085
[33m[INFO] loading file 32-32/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (572085, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (572085, 17)

[INFO] analyzing data
[INFO] 572085 rows
[INFO] ** appi_name:[21:99.9965%,30:0.00297%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.38309%,Single Stage Single Point:35.61691%]
[INFO] ** dst:[21:43.32188%,10:21.05666%,8:18.15307%,9:17.46384%,15:0.00297%,22:0.00087%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99738%,0:0.00262%]
[INFO] ** i/f_name:[2:99.99703%,3:0.00297%]
[INFO] ** modbus_function_code:[0.02961:99.9965%,-33.760870000000004:0.0035%]
[INFO] ** modbus_function_description:[7:49.99904%,11:49.99747%,0:0.0035%]
[INFO] ** modbus_transaction_id:65536 (11.45564%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9965%,1:0.00297%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.42471%,20:25.95419%,13:18.15307%,6:17.46436%,17:0.00297%,14:0.00052%,16:0.00017%]
[INFO] ** s_port:[1.45442:25.95366%,-0.32151:21.05666%,-1.27613:18.15272%,-0.23351:17.46366%,-0.33484:17.36805%,-71.33197:0.00297%,-0.24151:0.00052%,-1.2708:0.00017%,-1.02014:0.00017%,13.431270000000001:0.00017%,-71.14798:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.95331%,1:21.05649%,5:18.15272%,4:17.46331%,2:17.36805%,0:0.00612%]
[INFO] ** service:[0.0048200000000000005:99.9965%,-211.73542999999998:0.00297%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.42471%,9:25.95419%,7:18.15307%,1:17.46436%,14:0.00297%,2:0.00052%,15:0.00017%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1552 (0.27129%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0238 - tp: 79068.0000 - fp: 932.0000 - tn: 319068.0000 - fn: 932.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0238 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0242 - tp: 79048.0000 - fp: 952.0000 - tn: 319048.0000 - fn: 952.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0235 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 0.0011 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-6-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0232 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/572085
[33m[INFO] loading file 33-33/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (572085, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (572085, 17)

[INFO] analyzing data
[INFO] 572085 rows
[INFO] ** appi_name:[21:99.99703%,30:0.00105%,17:0.0007%,22:0.00052%,31:0.00017%,28:0.00017%,26:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:64.39183%,Single Stage Single Point:35.60817%]
[INFO] ** dst:[21:43.32363%,10:21.06348%,8:18.1251%,9:17.48307%,22:0.0014%,15:0.00105%,16:0.0007%,6:0.0007%,24:0.00035%,17:0.00035%,18:0.00017%]
[INFO] ** i/f_dir:[1:99.99895%,0:0.00105%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.99703%,-33.760870000000004:0.00297%]
[INFO] ** modbus_function_description:[7:49.99956%,11:49.99747%,0:0.00297%]
[INFO] ** modbus_transaction_id:65536 (11.45564%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99808%,1:0.00105%,2:0.00087%]
[INFO] ** proxy_src_ip:[18:38.42104%,20:25.96695%,13:18.1251%,6:17.48324%,17:0.00105%,16:0.0007%,1:0.0007%,21:0.00035%,14:0.00035%,7:0.00035%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.96607%,-0.32151:21.06348%,-1.27613:18.12475%,-0.23351:17.48289%,-0.33484:17.35756%,-71.33197:0.00105%,-1.02014:0.0007%,1.45709:0.00052%,-71.14931:0.00052%,-1.27347:0.00035%,-5.08665:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,-71.14798:0.00017%,-58.032509999999995:0.00017%,-58.035180000000004:0.00017%,-0.24151:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.96572%,1:21.06348%,5:18.12458%,4:17.48272%,2:17.35756%,0:0.00594%]
[INFO] ** service:[0.0048200000000000005:99.99703%,-211.73542999999998:0.00105%,-205.44247:0.0007%,-211.08818:0.00052%,-211.09762999999998:0.00017%,-211.08346:0.00017%,-185.9872:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.42104%,9:25.96695%,7:18.1251%,1:17.48324%,14:0.00105%,15:0.0007%,3:0.0007%,21:0.00035%,4:0.00035%,2:0.00035%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1556 (0.27199%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0237 - tp: 79065.0000 - fp: 935.0000 - tn: 319065.0000 - fn: 935.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0236 - tp: 79094.0000 - fp: 906.0000 - tn: 319094.0000 - fn: 906.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0230 - tp: 79130.0000 - fp: 870.0000 - tn: 319130.0000 - fn: 870.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0236 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 5.5341e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0237 - tp: 79073.0000 - fp: 927.0000 - tn: 319073.0000 - fn: 927.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/572085
[33m[INFO] loading file 34-34/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (413518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (413518, 17)

[INFO] analyzing data
[INFO] 413518 rows
[INFO] ** appi_name:[21:99.99758%,30:0.00073%,7:0.00073%,31:0.00024%,22:0.00024%,8:0.00024%,6:0.00024%]
[INFO] ** classification:[normal:64.34061%,Single Stage Single Point:35.65939%]
[INFO] ** dst:[21:43.28228%,10:21.05519%,8:18.18929%,9:17.47034%,22:0.00073%,15:0.00073%,16:0.00048%,2:0.00048%,18:0.00024%,6:0.00024%]
[INFO] ** i/f_dir:[1:99.99927%,0:0.00073%]
[INFO] ** i/f_name:[2:99.99927%,3:0.00073%]
[INFO] ** modbus_function_code:[0.02961:99.99758%,-33.760870000000004:0.00242%]
[INFO] ** modbus_function_description:[7:49.99927%,11:49.99831%,0:0.00242%]
[INFO] ** modbus_transaction_id:65536 (15.8484%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99879%,1:0.00073%,2:0.00048%]
[INFO] ** proxy_src_ip:[18:38.38866%,20:25.94905%,13:18.18905%,6:17.47082%,17:0.00073%,1:0.00073%,21:0.00048%,14:0.00024%,7:0.00024%]
[INFO] ** s_port:[1.45442:25.94857%,-0.32151:21.05495%,-1.27613:18.18905%,-0.23351:17.4701%,-0.33484:17.33371%,-0.24151:0.00073%,-71.33197:0.00073%,-3.0613900000000003:0.00024%,-3.3787199999999995:0.00024%,14.191239999999999:0.00024%,1.46509:0.00024%,1.47576:0.00024%,11.57001:0.00024%,-49.275529999999996:0.00024%,-71.14931:0.00024%,7.66617:0.00024%]
[INFO] ** scada_tag:[3:25.94833%,1:21.05471%,5:18.18881%,4:17.46961%,2:17.33371%,0:0.00484%]
[INFO] ** service:[0.0048200000000000005:99.99782%,-211.09762999999998:0.00073%,-211.73542999999998:0.00073%,-186.43601999999998:0.00024%,-211.35747999999998:0.00024%,-211.08818:0.00024%]
[INFO] ** src:[22:38.38866%,9:25.94905%,7:18.18905%,1:17.47082%,14:0.00073%,3:0.00073%,4:0.00048%,21:0.00024%,2:0.00024%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1123 (0.27157%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/413518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0231 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1924e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/413518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0236 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/413518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0235 - tp: 79088.0000 - fp: 912.0000 - tn: 319088.0000 - fn: 912.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/413518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0236 - tp: 79054.0000 - fp: 946.0000 - tn: 319054.0000 - fn: 946.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-33-34-batch-300000-400000
[INFO] processing batch 400000-500000/413518
[33m[INFO] loading file 35-35/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513518, 17)

[INFO] analyzing data
[INFO] 513518 rows
[INFO] ** appi_name:[21:99.99883%,30:0.00117%]
[INFO] ** classification:[normal:64.38002%,Single Stage Single Point:35.61998%]
[INFO] ** dst:[21:43.33422%,10:21.04308%,8:18.14523%,9:17.47514%,22:0.00117%,15:0.00117%]
[INFO] ** i/f_dir:[1:99.99903%,0:0.00097%]
[INFO] ** i/f_name:[2:99.99883%,3:0.00117%]
[INFO] ** modbus_function_code:[0.02961:99.99883%,-33.760870000000004:0.00117%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99864%,0:0.00117%]
[INFO] ** modbus_transaction_id:65536 (12.76216%)
[INFO] ** orig:[0:99.99961%,1:0.00039%]
[INFO] ** proto:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip:[18:38.40897%,20:25.9689%,13:18.14484%,6:17.47534%,17:0.00117%,16:0.00078%]
[INFO] ** s_port:[1.45442:25.96832%,-0.32151:21.04308%,-1.27613:18.14484%,-0.23351:17.47495%,-0.33484:17.3659%,-71.33197:0.00117%,-1.02014:0.00078%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.96793%,1:21.04308%,5:18.14464%,4:17.47456%,2:17.3659%,0:0.00389%]
[INFO] ** service:[0.0048200000000000005:99.99883%,-211.73542999999998:0.00117%]
[INFO] ** src:[22:38.40897%,9:25.9689%,7:18.14484%,1:17.47534%,14:0.00117%,15:0.00078%]
[INFO] ** type:[0:99.99903%,1:0.00097%]
[INFO] ** unixtime:1394 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0234 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0231 - tp: 79135.0000 - fp: 865.0000 - tn: 319135.0000 - fn: 865.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0231 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0238 - tp: 79064.0000 - fp: 936.0000 - tn: 319064.0000 - fn: 936.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0229 - tp: 79123.0000 - fp: 877.0000 - tn: 319123.0000 - fn: 877.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/513518
[33m[INFO] loading file 36-36/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513518, 17)

[INFO] analyzing data
[INFO] 513518 rows
[INFO] ** appi_name:[21:99.99864%,30:0.00058%,31:0.00039%,33:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.36094%,Single Stage Single Point:35.63906%]
[INFO] ** dst:[21:43.33597%,10:21.02283%,8:18.15672%,9:17.48215%,22:0.00078%,15:0.00058%,24:0.00039%,18:0.00039%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99942%,0:0.00058%]
[INFO] ** i/f_name:[2:99.99942%,3:0.00058%]
[INFO] ** modbus_function_code:[0.02961:99.99864%,-33.760870000000004:0.00136%]
[INFO] ** modbus_function_description:[7:50.00039%,11:49.99825%,0:0.00136%]
[INFO] ** modbus_transaction_id:65536 (12.76216%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99883%,2:0.00058%,1:0.00058%]
[INFO] ** proxy_src_ip:[18:38.37509%,20:25.9839%,13:18.15691%,6:17.48274%,17:0.00058%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.98332%,-0.32151:21.02263%,-1.27613:18.15633%,-0.23351:17.48196%,-0.33484:17.35246%,-0.24151:0.00058%,-71.33197:0.00058%,-1.27347:0.00039%,-0.08551:0.00039%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-49.275529999999996:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.98293%,1:21.02244%,5:18.15613%,4:17.48176%,2:17.35226%,0:0.00448%]
[INFO] ** service:[0.0048200000000000005:99.99883%,-211.73542999999998:0.00058%,-186.43601999999998:0.00039%,-186.44547:0.00019%]
[INFO] ** src:[22:38.37509%,9:25.9839%,7:18.15691%,1:17.48274%,14:0.00058%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1395 (0.27166%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0230 - tp: 79130.0000 - fp: 870.0000 - tn: 319130.0000 - fn: 870.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0232 - tp: 79086.0000 - fp: 914.0000 - tn: 319086.0000 - fn: 914.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0235 - tp: 79116.0000 - fp: 884.0000 - tn: 319116.0000 - fn: 884.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0235 - tp: 79082.0000 - fp: 918.0000 - tn: 319082.0000 - fn: 918.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0228 - tp: 79145.0000 - fp: 855.0000 - tn: 319145.0000 - fn: 855.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/513518
[33m[INFO] loading file 37-37/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513518, 17)

[INFO] analyzing data
[INFO] 513518 rows
[INFO] ** appi_name:[21:99.99883%,30:0.00078%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.3884%,Single Stage Single Point:35.6116%]
[INFO] ** dst:[21:43.33811%,10:21.04834%,8:18.13198%,9:17.47943%,22:0.00078%,15:0.00078%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99922%,3:0.00078%]
[INFO] ** modbus_function_code:[0.02961:99.99883%,-33.760870000000004:0.00117%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99864%,0:0.00117%]
[INFO] ** modbus_transaction_id:65536 (12.76216%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99903%,1:0.00078%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.39515%,20:25.99169%,13:18.13218%,6:17.47943%,17:0.00078%,16:0.00039%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.9911%,-0.32151:21.04834%,-1.27613:18.13179%,-0.23351:17.47923%,-0.33484:17.34681%,-71.33197:0.00078%,-1.02014:0.00039%,-71.14798:0.00019%,-1.27347:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.99091%,1:21.04834%,5:18.13159%,4:17.47904%,2:17.34662%,0:0.00351%]
[INFO] ** service:[0.0048200000000000005:99.99883%,-211.73542999999998:0.00078%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.39515%,9:25.99169%,7:18.13218%,1:17.47943%,14:0.00078%,15:0.00039%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1395 (0.27166%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0234 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0236 - tp: 79083.0000 - fp: 917.0000 - tn: 319083.0000 - fn: 917.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0230 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0242 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0236 - tp: 79059.0000 - fp: 941.0000 - tn: 319059.0000 - fn: 941.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/513518
[33m[INFO] loading file 38-38/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513518, 17)

[INFO] analyzing data
[INFO] 513518 rows
[INFO] ** appi_name:[21:99.99903%,30:0.00019%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.40806%,Single Stage Single Point:35.59194%]
[INFO] ** dst:[21:43.31922%,10:21.0867%,8:18.09888%,9:17.49325%,22:0.00097%,25:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99903%,-33.760870000000004:0.00097%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99922%,0:0.00097%]
[INFO] ** modbus_transaction_id:65536 (12.76216%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99942%,2:0.00039%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.45513%,20:25.95138%,13:18.09868%,6:17.49364%,7:0.00039%,17:0.00019%,16:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.9506%,-0.32151:21.08651%,-1.27613:18.09849%,-0.23351:17.49306%,-0.33484:17.36862%,1.45709:0.00039%,-0.24151:0.00039%,-71.14798:0.00019%,-64.19493:0.00019%,-1.02014:0.00019%,-61.95768:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,10.192739999999999:0.00019%,-0.24950999999999998:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.95021%,1:21.08651%,5:18.09849%,4:17.49286%,2:17.36862%,0:0.00331%]
[INFO] ** service:[0.0048200000000000005:99.99922%,-186.44547:0.00019%,-211.08346:0.00019%,-211.73542999999998:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.45513%,9:25.95138%,7:18.09868%,1:17.49364%,21:0.00039%,16:0.00019%,15:0.00019%,14:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1396 (0.27185%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0227 - tp: 79148.0000 - fp: 852.0000 - tn: 319148.0000 - fn: 852.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0233 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0223 - tp: 79076.0000 - fp: 924.0000 - tn: 319076.0000 - fn: 924.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79053.0000 - fp: 947.0000 - tn: 319053.0000 - fn: 947.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/513518
[33m[INFO] loading file 39-39/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513518, 17)

[INFO] analyzing data
[INFO] 513518 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.41546%,Single Stage Single Point:35.58454%]
[INFO] ** dst:[21:43.32467%,10:21.09001%,8:18.13004%,9:17.45411%,22:0.00097%,24:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.00078%,11:49.99922%]
[INFO] ** modbus_transaction_id:65536 (12.76216%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.46311%,20:25.95177%,13:18.13043%,6:17.45411%,16:0.00058%]
[INFO] ** s_port:[1.45442:25.95138%,-0.32151:21.09001%,-1.27613:18.13004%,-0.23351:17.45392%,-0.33484:17.3731%,-1.02014:0.00058%,-1.27347:0.00019%,1.45709:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.95099%,1:21.08982%,5:18.12984%,4:17.45392%,2:17.37291%,0:0.00253%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.46311%,9:25.95177%,7:18.13043%,1:17.45411%,15:0.00058%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1394 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79083.0000 - fp: 917.0000 - tn: 319083.0000 - fn: 917.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79134.0000 - fp: 866.0000 - tn: 319134.0000 - fn: 866.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79149.0000 - fp: 851.0000 - tn: 319149.0000 - fn: 851.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79116.0000 - fp: 884.0000 - tn: 319116.0000 - fn: 884.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79083.0000 - fp: 917.0000 - tn: 319083.0000 - fn: 917.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/513518
[33m[INFO] loading file 40-40/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513518, 17)

[INFO] analyzing data
[INFO] 513518 rows
[INFO] ** appi_name:[21:99.99611%,30:0.00331%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.34516%,Single Stage Single Point:35.65484%]
[INFO] ** dst:[21:43.30559%,10:21.03451%,8:18.18281%,9:17.47222%,15:0.00331%,22:0.00078%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99688%,0:0.00312%]
[INFO] ** i/f_name:[2:99.99669%,3:0.00331%]
[INFO] ** modbus_function_code:[0.02961:99.99611%,-33.760870000000004:0.00389%]
[INFO] ** modbus_function_description:[7:49.99903%,11:49.99708%,0:0.00389%]
[INFO] ** modbus_transaction_id:65536 (12.76216%)
[INFO] ** orig:[0:99.99961%,1:0.00039%]
[INFO] ** proto:[0:99.99611%,1:0.00331%,2:0.00058%]
[INFO] ** proxy_src_ip:[18:38.35445%,20:25.98643%,13:18.18261%,6:17.47261%,17:0.00331%,14:0.00058%]
[INFO] ** s_port:[1.45442:25.98565%,-0.32151:21.03451%,-1.27613:18.18242%,-0.23351:17.47203%,-0.33484:17.31994%,-71.33197:0.00331%,1.45709:0.00039%,-0.24151:0.00039%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,13.431270000000001:0.00019%]
[INFO] ** scada_tag:[3:25.98526%,1:21.03432%,5:18.18223%,4:17.47164%,2:17.31974%,0:0.00682%]
[INFO] ** service:[0.0048200000000000005:99.99611%,-211.73542999999998:0.00331%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.35445%,9:25.98643%,7:18.18261%,1:17.47261%,14:0.00331%,2:0.00058%]
[INFO] ** type:[0:99.99903%,1:0.00097%]
[INFO] ** unixtime:1397 (0.27204%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79083.0000 - fp: 917.0000 - tn: 319083.0000 - fn: 917.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79139.0000 - fp: 861.0000 - tn: 319139.0000 - fn: 861.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79061.0000 - fp: 939.0000 - tn: 319061.0000 - fn: 939.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.2649e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79093.0000 - fp: 907.0000 - tn: 319093.0000 - fn: 907.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/513518
[33m[INFO] loading file 41-41/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (453676, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (453676, 17)

[INFO] analyzing data
[INFO] 453676 rows
[INFO] ** appi_name:[21:99.99625%,30:0.0011%,22:0.00088%,17:0.00088%,32:0.00022%,28:0.00022%,26:0.00022%,7:0.00022%]
[INFO] ** classification:[normal:64.40081%,Single Stage Single Point:35.59919%]
[INFO] ** dst:[21:43.32894%,10:21.06724%,8:18.13387%,9:17.46511%,16:0.0011%,15:0.0011%,6:0.0011%,22:0.00066%,24:0.00044%,17:0.00044%]
[INFO] ** i/f_dir:[1:99.9989%,0:0.0011%]
[INFO] ** i/f_name:[2:99.9989%,3:0.0011%]
[INFO] ** modbus_function_code:[0.02961:99.99625%,-33.760870000000004:0.00375%]
[INFO] ** modbus_function_description:[7:49.9989%,11:49.99735%,0:0.00375%]
[INFO] ** modbus_transaction_id:65536 (14.44555%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99758%,2:0.00132%,1:0.0011%]
[INFO] ** proxy_src_ip:[18:38.4466%,20:25.9498%,13:18.13409%,6:17.46533%,17:0.0011%,1:0.00088%,21:0.00044%,16:0.00044%,14:0.00044%,0:0.00044%,7:0.00022%,2:0.00022%]
[INFO] ** s_port:[1.45442:25.94936%,-0.32151:21.06724%,-1.27613:18.13343%,-0.23351:17.46489%,-0.33484:17.37936%,-71.33197:0.0011%,-71.14931:0.00088%,-1.02014:0.00044%,-1.27347:0.00044%,-71.14798:0.00022%,-0.24151:0.00022%,-58.035180000000004:0.00022%,-1.2708:0.00022%,-5.1466400000000005:0.00022%,1.47576:0.00022%,1.46509:0.00022%,-64.19226:0.00022%,-5.08665:0.00022%,-0.24950999999999998:0.00022%,2.05573:0.00022%,-43.76509:0.00022%,-58.032509999999995:0.00022%]
[INFO] ** scada_tag:[3:25.94914%,1:21.06724%,5:18.13343%,4:17.46467%,2:17.37936%,0:0.00617%]
[INFO] ** service:[0.0048200000000000005:99.99625%,-211.73542999999998:0.0011%,-205.44247:0.00088%,-211.08818:0.00088%,89.64175:0.00022%,-211.09762999999998:0.00022%,-211.08346:0.00022%,-185.9872:0.00022%]
[INFO] ** src:[22:38.4466%,9:25.9498%,7:18.13409%,1:17.46533%,14:0.0011%,3:0.00088%,15:0.00044%,8:0.00044%,4:0.00044%,2:0.00044%,21:0.00022%,17:0.00022%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1231 (0.27134%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/453676
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/453676
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79088.0000 - fp: 912.0000 - tn: 319088.0000 - fn: 912.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/453676
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79075.0000 - fp: 925.0000 - tn: 319075.0000 - fn: 925.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.2057e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/453676
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/453676
[33m[INFO] loading file 42-42/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (397190, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (397190, 17)

[INFO] analyzing data
[INFO] 397190 rows
[INFO] ** appi_name:[21:99.99144%,30:0.00227%,17:0.00126%,31:0.00101%,26:0.00101%,7:0.00101%,22:0.00076%,28:0.00025%,27:0.00025%,9:0.00025%,8:0.00025%,0:0.00025%]
[INFO] ** classification:[normal:64.37801%,Single Stage Single Point:35.62199%]
[INFO] ** dst:[21:43.31378%,10:21.05516%,8:18.17518%,9:17.44631%,16:0.00227%,6:0.00201%,18:0.00126%,2:0.00101%,22:0.00076%,15:0.00076%,17:0.0005%,25:0.00025%,24:0.00025%,7:0.00025%,0:0.00025%]
[INFO] ** i/f_dir:[1:99.99924%,0:0.00076%]
[INFO] ** i/f_name:[2:99.99924%,3:0.00076%]
[INFO] ** modbus_function_code:[0.02961:99.99144%,-33.760870000000004:0.00856%]
[INFO] ** modbus_function_description:[7:49.99648%,11:49.99496%,0:0.00856%]
[INFO] ** modbus_transaction_id:65536 (16.49991%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99547%,2:0.00378%,1:0.00076%]
[INFO] ** proxy_src_ip:[18:38.41763%,20:25.95156%,13:18.17568%,6:17.44631%,17:0.00227%,1:0.00227%,14:0.00151%,21:0.00101%,7:0.00076%,0:0.0005%,16:0.00025%,2:0.00025%]
[INFO] ** s_port:[1.45442:25.95106%,-0.32151:21.05516%,-1.27613:18.17518%,-0.23351:17.44606%,-0.33484:17.36247%,-71.14931:0.00101%,-71.14798:0.00101%,-71.33197:0.00076%,11.57001:0.0005%,-0.08551:0.0005%,-3.3787199999999995:0.0005%,-0.24151:0.00025%,13.431270000000001:0.00025%,-5.1466400000000005:0.00025%,0.31847:0.00025%,-1.02014:0.00025%,-1.2708:0.00025%,-58.035180000000004:0.00025%,7.66617:0.00025%,-64.19493:0.00025%,1.47576:0.00025%,14.4699:0.00025%,15.912510000000001:0.00025%,14.191239999999999:0.00025%,7.9608300000000005:0.00025%,-5.08665:0.00025%,10.192739999999999:0.00025%,-3.0613900000000003:0.00025%,1.45709:0.00025%,2.05573:0.00025%,-43.76509:0.00025%,11.862:0.00025%,-1.27347:0.00025%,-58.032509999999995:0.00025%]
[INFO] ** scada_tag:[3:25.95055%,1:21.05516%,5:18.17493%,4:17.44606%,2:17.36222%,0:0.01108%]
[INFO] ** service:[0.0048200000000000005:99.99144%,-211.09762999999998:0.00176%,-205.44247:0.00126%,-186.43601999999998:0.00126%,-211.08346:0.00101%,-211.08818:0.00101%,-211.73542999999998:0.00076%,-211.35747999999998:0.0005%,-186.44547:0.00025%,-183.8612:0.00025%,-185.9872:0.00025%,-202.75898:0.00025%]
[INFO] ** src:[22:38.41763%,9:25.95156%,7:18.17568%,1:17.44631%,3:0.00302%,2:0.00176%,4:0.00126%,21:0.00101%,14:0.00076%,8:0.0005%,17:0.00025%,15:0.00025%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1078 (0.27141%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/397190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79124.0000 - fp: 876.0000 - tn: 319124.0000 - fn: 876.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1976e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/397190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79129.0000 - fp: 871.0000 - tn: 319129.0000 - fn: 871.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1922e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/397190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/397190
[33m[INFO] loading file 43-43/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597190, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597190, 17)

[INFO] analyzing data
[INFO] 597190 rows
[INFO] ** appi_name:[21:99.99833%,30:0.0005%,7:0.0005%,26:0.00033%,22:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:64.38705%,Single Stage Single Point:35.61295%]
[INFO] ** dst:[21:43.31503%,10:21.06934%,8:18.14431%,9:17.46848%,22:0.001%,15:0.0005%,6:0.0005%,16:0.00033%,2:0.00033%,24:0.00017%]
[INFO] ** i/f_dir:[1:99.99983%,0:0.00017%]
[INFO] ** i/f_name:[2:99.9995%,3:0.0005%]
[INFO] ** modbus_function_code:[0.02961:99.99833%,-33.760870000000004:0.00167%]
[INFO] ** modbus_function_description:[7:49.99983%,11:49.99849%,0:0.00167%]
[INFO] ** modbus_transaction_id:65536 (10.97406%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.999%,2:0.0005%,1:0.0005%]
[INFO] ** proxy_src_ip:[18:38.41625%,20:25.96862%,13:18.14448%,6:17.46864%,17:0.0005%,1:0.0005%,16:0.00033%,7:0.00033%,21:0.00017%,14:0.00017%]
[INFO] ** s_port:[1.45442:25.96795%,-0.32151:21.06934%,-1.27613:18.14414%,-0.23351:17.46814%,-0.33484:17.34691%,-71.33197:0.0005%,1.47576:0.00033%,1.45709:0.00033%,-71.14798:0.00033%,-0.24151:0.00033%,-1.02014:0.00033%,-0.24950999999999998:0.00017%,-1.2708:0.00017%,-1.27347:0.00017%,-3.3787199999999995:0.00017%,7.9608300000000005:0.00017%,11.57001:0.00017%,-71.14931:0.00017%,0.31847:0.00017%]
[INFO] ** scada_tag:[3:25.96761%,1:21.06934%,5:18.14397%,4:17.46781%,2:17.34674%,0:0.00452%]
[INFO] ** service:[0.0048200000000000005:99.99833%,-211.09762999999998:0.0005%,-211.73542999999998:0.0005%,-211.08346:0.00033%,-211.35747999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.41625%,9:25.96862%,7:18.14448%,1:17.46864%,14:0.0005%,3:0.0005%,21:0.00033%,15:0.00033%,4:0.00017%,2:0.00017%]
[INFO] ** type:[0:99.99967%,1:0.00033%]
[INFO] ** unixtime:1623 (0.27177%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79141.0000 - fp: 859.0000 - tn: 319141.0000 - fn: 859.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79124.0000 - fp: 876.0000 - tn: 319124.0000 - fn: 876.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-6-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79127.0000 - fp: 873.0000 - tn: 319127.0000 - fn: 873.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79162.0000 - fp: 838.0000 - tn: 319162.0000 - fn: 838.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/597190
[33m[INFO] loading file 44-44/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597190, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597190, 17)

[INFO] analyzing data
[INFO] 597190 rows
[INFO] ** appi_name:[21:99.99833%,30:0.00067%,31:0.0005%,0:0.00033%,22:0.00017%]
[INFO] ** classification:[normal:64.39475%,Single Stage Single Point:35.60525%]
[INFO] ** dst:[21:43.33931%,10:21.0526%,8:18.14917%,9:17.45592%,22:0.001%,15:0.00067%,18:0.0005%,25:0.00033%,24:0.00033%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99933%,0:0.00067%]
[INFO] ** i/f_name:[2:99.99933%,3:0.00067%]
[INFO] ** modbus_function_code:[0.02961:99.99833%,-33.760870000000004:0.00167%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.99816%,0:0.00167%]
[INFO] ** modbus_transaction_id:65536 (10.97406%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99833%,2:0.001%,1:0.00067%]
[INFO] ** proxy_src_ip:[18:38.43232%,20:25.96008%,13:18.14933%,6:17.45642%,17:0.00067%,7:0.00033%,16:0.00017%,5:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95941%,-0.32151:21.0526%,-1.27613:18.14883%,-0.23351:17.45575%,-0.33484:17.37973%,-71.33197:0.00067%,-0.24151:0.0005%,-0.08551:0.00033%,-64.19493:0.00033%,-1.27347:0.00033%,1.45709:0.00033%,-1.02014:0.00017%,-1.2708:0.00017%,1.47576:0.00017%,-71.14931:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,4.42897:0.00017%]
[INFO] ** scada_tag:[3:25.95891%,1:21.0526%,5:18.14883%,4:17.45542%,2:17.37956%,0:0.00469%]
[INFO] ** service:[0.0048200000000000005:99.99833%,-211.73542999999998:0.00067%,-186.43601999999998:0.0005%,-186.44547:0.00033%,-211.08818:0.00017%]
[INFO] ** src:[22:38.43232%,9:25.96008%,7:18.14933%,1:17.45642%,14:0.00067%,21:0.00033%,17:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1621 (0.27144%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1945e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79146.0000 - fp: 854.0000 - tn: 319146.0000 - fn: 854.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79157.0000 - fp: 843.0000 - tn: 319157.0000 - fn: 843.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79081.0000 - fp: 919.0000 - tn: 319081.0000 - fn: 919.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/597190
[33m[INFO] loading file 45-45/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597190, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597190, 17)

[INFO] analyzing data
[INFO] 597190 rows
[INFO] ** appi_name:[21:99.99883%,30:0.0005%,31:0.00033%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:64.41183%,Single Stage Single Point:35.58817%]
[INFO] ** dst:[21:43.32239%,10:21.08676%,8:18.13393%,9:17.45441%,22:0.00134%,15:0.0005%,18:0.00033%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99967%,0:0.00033%]
[INFO] ** i/f_name:[2:99.9995%,3:0.0005%]
[INFO] ** modbus_function_code:[0.02961:99.99883%,-33.760870000000004:0.00117%]
[INFO] ** modbus_function_description:[7:50.0005%,11:49.99833%,0:0.00117%]
[INFO] ** modbus_transaction_id:65536 (10.97406%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.999%,2:0.0005%,1:0.0005%]
[INFO] ** proxy_src_ip:[18:38.47754%,20:25.93228%,13:18.13376%,6:17.45491%,17:0.0005%,16:0.00033%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.93161%,-0.32151:21.08676%,-1.27613:18.13376%,-0.23351:17.45424%,-0.33484:17.39078%,1.45709:0.0005%,-0.24151:0.0005%,-71.33197:0.0005%,-1.02014:0.00033%,-0.08551:0.00033%,-71.14798:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,14.4699:0.00017%]
[INFO] ** scada_tag:[3:25.93111%,1:21.08659%,5:18.13376%,4:17.45424%,2:17.39061%,0:0.00368%]
[INFO] ** service:[0.0048200000000000005:99.99883%,-211.73542999999998:0.0005%,-186.43601999999998:0.00033%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.47754%,9:25.93228%,7:18.13376%,1:17.45491%,14:0.0005%,15:0.00033%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1620 (0.27127%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79065.0000 - fp: 935.0000 - tn: 319065.0000 - fn: 935.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79134.0000 - fp: 866.0000 - tn: 319134.0000 - fn: 866.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0196 - tp: 79148.0000 - fp: 852.0000 - tn: 319148.0000 - fn: 852.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79131.0000 - fp: 869.0000 - tn: 319131.0000 - fn: 869.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/597190
[33m[INFO] loading file 46-46/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597190, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597190, 17)

[INFO] analyzing data
[INFO] 597190 rows
[INFO] ** appi_name:[21:99.99816%,30:0.001%,26:0.00017%,17:0.00017%,12:0.00017%,9:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.41334%,Single Stage Single Point:35.58666%]
[INFO] ** dst:[21:43.34198%,10:21.06867%,8:18.11166%,9:17.47501%,22:0.001%,15:0.001%,25:0.00017%,16:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99916%,0:0.00084%]
[INFO] ** i/f_name:[2:99.999%,3:0.001%]
[INFO] ** modbus_function_code:[0.02961:99.99816%,-33.760870000000004:0.00184%]
[INFO] ** modbus_function_description:[7:49.99916%,11:49.999%,0:0.00184%]
[INFO] ** modbus_transaction_id:65536 (10.97406%)
[INFO] ** orig:[0:99.99967%,1:0.00033%]
[INFO] ** proto:[0:99.99866%,1:0.001%,2:0.00033%]
[INFO] ** proxy_src_ip:[18:38.43701%,20:25.97364%,13:18.11166%,6:17.47551%,17:0.001%,16:0.00033%,7:0.00033%,5:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.97331%,-0.32151:21.0685%,-1.27613:18.11149%,-0.23351:17.47484%,-0.33484:17.36851%,-71.33197:0.001%,-0.24151:0.0005%,-1.02014:0.00033%,-64.19493:0.00017%,14.4699:0.00017%,10.192739999999999:0.00017%,-71.14798:0.00017%,-1.2708:0.00017%,1.45709:0.00017%,1.47576:0.00017%,-0.24950999999999998:0.00017%,-61.95768:0.00017%]
[INFO] ** scada_tag:[3:25.97281%,1:21.06834%,5:18.11132%,4:17.47451%,2:17.36851%,0:0.00452%]
[INFO] ** service:[0.0048200000000000005:99.99833%,-211.73542999999998:0.001%,-183.8612:0.00017%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.43701%,9:25.97364%,7:18.11166%,1:17.47551%,14:0.001%,21:0.00033%,15:0.00033%,16:0.00017%,8:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99916%,1:0.00084%]
[INFO] ** unixtime:1623 (0.27177%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79124.0000 - fp: 876.0000 - tn: 319124.0000 - fn: 876.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79162.0000 - fp: 838.0000 - tn: 319162.0000 - fn: 838.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1922e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/597190
[33m[INFO] loading file 47-47/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597190, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597190, 17)

[INFO] analyzing data
[INFO] 597190 rows
[INFO] ** appi_name:[21:99.9995%,33:0.00017%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.40262%,Single Stage Single Point:35.59738%]
[INFO] ** dst:[21:43.31385%,10:21.08692%,8:18.12288%,9:17.47417%,22:0.00151%,24:0.00033%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.9995%,-33.760870000000004:0.0005%]
[INFO] ** modbus_function_description:[7:50.00117%,11:49.99833%,0:0.0005%]
[INFO] ** modbus_transaction_id:65536 (10.97406%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.45811%,20:25.94333%,13:18.12321%,6:17.47451%,16:0.00033%,7:0.00033%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.9425%,-0.32151:21.08692%,-1.27613:18.12271%,-0.23351:17.474%,-0.33484:17.37119%,1.45709:0.0005%,-0.24151:0.0005%,-1.27347:0.00033%,-1.02014:0.00033%,-71.14798:0.00017%,-61.95635:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.942%,1:21.08676%,5:18.12254%,4:17.47384%,2:17.37102%,0:0.00385%]
[INFO] ** service:[0.0048200000000000005:99.99967%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.45811%,9:25.94333%,7:18.12321%,1:17.47451%,21:0.00033%,15:0.00033%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1621 (0.27144%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79061.0000 - fp: 939.0000 - tn: 319061.0000 - fn: 939.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0193 - tp: 79166.0000 - fp: 834.0000 - tn: 319166.0000 - fn: 834.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79153.0000 - fp: 847.0000 - tn: 319153.0000 - fn: 847.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/597190
[33m[INFO] loading file 48-48/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597190, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597190, 17)

[INFO] analyzing data
[INFO] 597190 rows
[INFO] ** appi_name:[21:99.99699%,30:0.00234%,33:0.00017%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.41903%,Single Stage Single Point:35.58097%]
[INFO] ** dst:[21:43.3234%,10:21.09195%,8:18.1145%,9:17.4663%,15:0.00234%,22:0.00084%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99799%,0:0.00201%]
[INFO] ** i/f_name:[2:99.99766%,3:0.00234%]
[INFO] ** modbus_function_code:[0.02961:99.99699%,-33.760870000000004:0.00301%]
[INFO] ** modbus_function_description:[7:49.99916%,11:49.99782%,0:0.00301%]
[INFO] ** modbus_transaction_id:65536 (10.97406%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99715%,1:0.00234%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.46163%,20:25.95405%,13:18.11467%,6:17.4663%,17:0.00234%,14:0.0005%,16:0.00033%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95355%,-0.32151:21.09195%,-1.27613:18.11434%,-0.23351:17.46613%,-0.33484:17.36968%,-71.33197:0.00234%,-1.02014:0.00033%,-1.2708:0.00017%,13.431270000000001:0.00017%,-0.24151:0.00017%,-71.14798:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-61.95635:0.00017%,1.45709:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.95321%,1:21.09178%,5:18.11434%,4:17.46613%,2:17.36951%,0:0.00502%]
[INFO] ** service:[0.0048200000000000005:99.99715%,-211.73542999999998:0.00234%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.46163%,9:25.95405%,7:18.11467%,1:17.4663%,14:0.00234%,2:0.0005%,15:0.00033%,8:0.00017%]
[INFO] ** type:[0:99.99967%,1:0.00033%]
[INFO] ** unixtime:1620 (0.27127%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79129.0000 - fp: 871.0000 - tn: 319129.0000 - fn: 871.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79060.0000 - fp: 940.0000 - tn: 319060.0000 - fn: 940.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79119.0000 - fp: 881.0000 - tn: 319119.0000 - fn: 881.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79128.0000 - fp: 872.0000 - tn: 319128.0000 - fn: 872.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/597190
[33m[INFO] loading file 49-49/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597190, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597190, 17)

[INFO] analyzing data
[INFO] 597190 rows
[INFO] ** appi_name:[21:99.99749%,30:0.00084%,17:0.00067%,26:0.00033%,22:0.00033%,28:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:64.3837%,Single Stage Single Point:35.6163%]
[INFO] ** dst:[21:43.3172%,10:21.06231%,8:18.12656%,9:17.48958%,22:0.00151%,15:0.00084%,16:0.00067%,6:0.00067%,24:0.00033%,17:0.00033%]
[INFO] ** i/f_dir:[1:99.99916%,0:0.00084%]
[INFO] ** i/f_name:[2:99.99916%,3:0.00084%]
[INFO] ** modbus_function_code:[0.02961:99.99749%,-33.760870000000004:0.00251%]
[INFO] ** modbus_function_description:[7:49.99967%,11:49.99782%,0:0.00251%]
[INFO] ** modbus_transaction_id:65536 (10.97406%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99849%,1:0.00084%,2:0.00067%]
[INFO] ** proxy_src_ip:[18:38.43065%,20:25.94953%,13:18.12673%,6:17.49025%,17:0.00084%,1:0.00067%,14:0.0005%,21:0.00033%,16:0.00033%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.94869%,-0.32151:21.06231%,-1.27613:18.12622%,-0.23351:17.48941%,-0.33484:17.36834%,-71.33197:0.00084%,-0.24151:0.00067%,1.45709:0.0005%,-1.27347:0.00033%,-71.14931:0.00033%,-1.02014:0.00033%,-71.14798:0.00033%,1.47576:0.00017%,-1.2708:0.00017%,-58.035180000000004:0.00017%,-58.032509999999995:0.00017%,1.46509:0.00017%,-43.76509:0.00017%,2.05573:0.00017%,-5.08665:0.00017%,-0.24950999999999998:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.94836%,1:21.06214%,5:18.12606%,4:17.48907%,2:17.36834%,0:0.00603%]
[INFO] ** service:[0.0048200000000000005:99.99749%,-211.73542999999998:0.00084%,-205.44247:0.00067%,-211.08346:0.00033%,-211.08818:0.00033%,-211.09762999999998:0.00017%,-185.9872:0.00017%]
[INFO] ** src:[22:38.43065%,9:25.94953%,7:18.12673%,1:17.49025%,14:0.00084%,3:0.00067%,2:0.0005%,15:0.00033%,4:0.00033%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1621 (0.27144%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79098.0000 - fp: 902.0000 - tn: 319098.0000 - fn: 902.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79079.0000 - fp: 921.0000 - tn: 319079.0000 - fn: 921.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79071.0000 - fp: 929.0000 - tn: 319071.0000 - fn: 929.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79106.0000 - fp: 894.0000 - tn: 319106.0000 - fn: 894.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/597190
[33m[INFO] loading file 50-50/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (447172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (447172, 17)

[INFO] analyzing data
[INFO] 447172 rows
[INFO] ** appi_name:[21:99.99732%,30:0.00112%,7:0.00067%,22:0.00045%,31:0.00022%,8:0.00022%]
[INFO] ** classification:[normal:64.31284%,Single Stage Single Point:35.68716%]
[INFO] ** dst:[21:43.26523%,10:21.04425%,8:18.20955%,9:17.47739%,15:0.00112%,22:0.00067%,16:0.00045%,6:0.00045%,2:0.00045%,24:0.00022%,18:0.00022%]
[INFO] ** i/f_dir:[1:99.99888%,0:0.00112%]
[INFO] ** i/f_name:[2:99.99888%,3:0.00112%]
[INFO] ** modbus_function_code:[0.02961:99.99732%,-33.760870000000004:0.00268%]
[INFO] ** modbus_function_description:[11:49.99888%,7:49.99843%,0:0.00268%]
[INFO] ** modbus_transaction_id:65536 (14.65566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99821%,1:0.00112%,2:0.00067%]
[INFO] ** proxy_src_ip:[18:38.36622%,20:25.94348%,13:18.20977%,6:17.47739%,17:0.00112%,1:0.00067%,16:0.00045%,14:0.00045%,21:0.00022%,7:0.00022%]
[INFO] ** s_port:[1.45442:25.94304%,-0.32151:21.04425%,-1.27613:18.20932%,-0.23351:17.47739%,-0.33484:17.32197%,-71.33197:0.00112%,-71.14931:0.00045%,-1.02014:0.00045%,-3.3787199999999995:0.00022%,4.33564:0.00022%,15.912510000000001:0.00022%,7.9608300000000005:0.00022%,1.46509:0.00022%,1.45709:0.00022%,-1.27347:0.00022%,-1.2708:0.00022%,0.31847:0.00022%]
[INFO] ** scada_tag:[3:25.94281%,1:21.04403%,5:18.2091%,4:17.47739%,2:17.32175%,0:0.00492%]
[INFO] ** service:[0.0048200000000000005:99.99732%,-211.73542999999998:0.00112%,-211.09762999999998:0.00067%,-211.08818:0.00045%,-186.43601999999998:0.00022%,-211.35747999999998:0.00022%]
[INFO] ** src:[22:38.36622%,9:25.94348%,7:18.20977%,1:17.47739%,14:0.00112%,3:0.00067%,15:0.00045%,2:0.00045%,21:0.00022%,4:0.00022%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1215 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/447172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79116.0000 - fp: 884.0000 - tn: 319116.0000 - fn: 884.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/447172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79078.0000 - fp: 922.0000 - tn: 319078.0000 - fn: 922.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/447172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79091.0000 - fp: 909.0000 - tn: 319091.0000 - fn: 909.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/447172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79072.0000 - fp: 928.0000 - tn: 319072.0000 - fn: 928.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-49-50-batch-300000-400000
[INFO] processing batch 400000-500000/447172
[33m[INFO] epoch 7/10[0m
[33m[INFO] loading file 1-1/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99342%,30:0.0011%,22:0.00091%,17:0.00073%,31:0.00055%,26:0.00055%,7:0.00055%,23:0.00037%,18:0.00037%,0:0.00037%,28:0.00018%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:78.00399%,Single Stage Single Point:21.99601%]
[INFO] ** dst:[21:43.27177%,10:21.0347%,8:18.16687%,9:17.51954%,6:0.00146%,22:0.0011%,16:0.0011%,15:0.0011%,18:0.00055%,26:0.00037%,25:0.00037%,19:0.00037%,17:0.00037%,24:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.9989%,0:0.0011%]
[INFO] ** i/f_name:[2:99.9989%,3:0.0011%]
[INFO] ** modbus_function_code:[0.02961:99.99342%,-33.760870000000004:0.0064%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99781%,11:49.99561%,0:0.0064%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99634%,2:0.00256%,1:0.0011%]
[INFO] ** proxy_src_ip:[18:38.3967%,20:25.9094%,13:18.16705%,6:17.5199%,11:0.00128%,10:0.00128%,17:0.0011%,14:0.00091%,1:0.00091%,7:0.00055%,21:0.00037%,16:0.00037%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.90885%,-0.32151:21.03397%,-1.27613:18.16668%,-0.23351:17.51935%,-0.33484:17.36273%,-71.33197:0.0011%,-71.14931:0.00091%,-2.1481:0.00073%,-0.24151:0.00055%,-71.14798:0.00055%,-1.02014:0.00037%,-64.19493:0.00037%,-2.42942:0.00037%,4.44364:0.00037%,-43.76509:0.00018%,10.67005:0.00018%,4.29964:0.00018%,-5.08665:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,1.47576:0.00018%,1.46509:0.00018%,4.076980000000001:0.00018%,-58.032509999999995:0.00018%,-58.035180000000004:0.00018%,-1.2708:0.00018%,-1.27347:0.00018%,-5.1466400000000005:0.00018%,-68.79874000000001:0.00018%,14.253910000000001:0.00018%,1.45709:0.00018%]
[INFO] ** scada_tag:[3:25.90867%,1:21.03379%,5:18.16632%,4:17.51917%,2:17.36255%,0:0.0095%]
[INFO] ** service:[0.0048200000000000005:99.99415%,-211.73542999999998:0.0011%,-211.08818:0.00091%,-205.44247:0.00073%,-211.07873999999998:0.00073%,-211.09762999999998:0.00055%,-211.08346:0.00055%,-186.43601999999998:0.00055%,-186.44547:0.00037%,-185.9872:0.00018%,-202.75898:0.00018%]
[INFO] ** src:[22:38.3967%,9:25.9094%,7:18.16705%,1:17.5199%,11:0.00128%,10:0.00128%,14:0.0011%,3:0.00091%,2:0.00091%,21:0.00055%,15:0.00037%,4:0.00037%,8:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1485 (0.2714%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8645 - tp: 73331.0000 - fp: 6669.0000 - tn: 313331.0000 - fn: 6669.0000 - accuracy: 0.9667 - precision: 0.9166 - recall: 0.9166 - auc: 0.9636 - val_loss: 0.3707 - val_tp: 19166.0000 - val_fp: 834.0000 - val_tn: 79166.0000 - val_fn: 834.0000 - val_accuracy: 0.9833 - val_precision: 0.9583 - val_recall: 0.9583 - val_auc: 0.9777
[INFO] saving weights to checkpoints/lstm-epoch-7-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0275 - tp: 79865.0000 - fp: 135.0000 - tn: 319865.0000 - fn: 135.0000 - accuracy: 0.9993 - precision: 0.9983 - recall: 0.9983 - auc: 0.9994 - val_loss: 0.0011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0076 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.6328e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.9922 - tp: 54946.0000 - fp: 25054.0000 - tn: 294946.0000 - fn: 25054.0000 - accuracy: 0.8747 - precision: 0.6868 - recall: 0.6868 - auc: 0.9199 - val_loss: 0.7004 - val_tp: 10608.0000 - val_fp: 9392.0000 - val_tn: 70608.0000 - val_fn: 9392.0000 - val_accuracy: 0.8122 - val_precision: 0.5304 - val_recall: 0.5304 - val_auc: 0.9144
[INFO] saving weights to checkpoints/lstm-epoch-7-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6234 - tp: 43258.0000 - fp: 36742.0000 - tn: 283258.0000 - fn: 36742.0000 - accuracy: 0.8163 - precision: 0.5407 - recall: 0.5407 - auc: 0.9060 - val_loss: 0.5665 - val_tp: 14806.0000 - val_fp: 5194.0000 - val_tn: 74806.0000 - val_fn: 5194.0000 - val_accuracy: 0.8961 - val_precision: 0.7403 - val_recall: 0.7403 - val_auc: 0.9450
[INFO] saving weights to checkpoints/lstm-epoch-7-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 2-2/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99872%,7:0.00055%,30:0.00037%,31:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:71.0877%,Single Stage Single Point:28.9123%]
[INFO] ** dst:[21:43.31289%,10:21.02922%,8:18.1442%,9:17.51131%,22:0.00091%,16:0.00037%,15:0.00037%,2:0.00037%,24:0.00018%,18:0.00018%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99963%,3:0.00037%]
[INFO] ** modbus_function_code:[0.02961:99.99872%,-33.760870000000004:0.00128%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99872%,0:0.00128%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99945%,1:0.00037%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.38172%,20:25.96094%,13:18.1442%,6:17.51168%,1:0.00055%,17:0.00037%,16:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.96021%,-0.32151:21.02922%,-1.27613:18.14384%,-0.23351:17.51113%,-0.33484:17.3525%,-0.24151:0.00037%,-71.33197:0.00037%,1.45709:0.00037%,1.47576:0.00018%,12.60597:0.00018%,10.67005:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,4.076980000000001:0.00018%,-3.3787199999999995:0.00018%,4.29964:0.00018%,-1.27347:0.00018%]
[INFO] ** scada_tag:[3:25.95984%,1:21.02922%,5:18.14384%,4:17.51076%,2:17.35231%,0:0.00402%]
[INFO] ** service:[0.0048200000000000005:99.99872%,-211.09762999999998:0.00055%,-211.73542999999998:0.00037%,-211.35747999999998:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.38172%,9:25.96094%,7:18.1442%,1:17.51168%,3:0.00055%,14:0.00037%,21:0.00018%,15:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1488 (0.27194%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5656 - tp: 55275.0000 - fp: 24725.0000 - tn: 295275.0000 - fn: 24725.0000 - accuracy: 0.8764 - precision: 0.6909 - recall: 0.6909 - auc: 0.9400 - val_loss: 0.5382 - val_tp: 14494.0000 - val_fp: 5506.0000 - val_tn: 74494.0000 - val_fn: 5506.0000 - val_accuracy: 0.8899 - val_precision: 0.7247 - val_recall: 0.7247 - val_auc: 0.9559
[INFO] saving weights to checkpoints/lstm-epoch-7-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5574 - tp: 54089.0000 - fp: 25911.0000 - tn: 294089.0000 - fn: 25911.0000 - accuracy: 0.8704 - precision: 0.6761 - recall: 0.6761 - auc: 0.9397 - val_loss: 0.5858 - val_tp: 10495.0000 - val_fp: 9505.0000 - val_tn: 70495.0000 - val_fn: 9505.0000 - val_accuracy: 0.8099 - val_precision: 0.5247 - val_recall: 0.5247 - val_auc: 0.9063
[INFO] saving weights to checkpoints/lstm-epoch-7-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1831 - tp: 73416.0000 - fp: 6584.0000 - tn: 313416.0000 - fn: 6584.0000 - accuracy: 0.9671 - precision: 0.9177 - recall: 0.9177 - auc: 0.9957 - val_loss: 0.0028 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7295 - tp: 46986.0000 - fp: 33014.0000 - tn: 286986.0000 - fn: 33014.0000 - accuracy: 0.8349 - precision: 0.5873 - recall: 0.5873 - auc: 0.9160 - val_loss: 0.5459 - val_tp: 10766.0000 - val_fp: 9234.0000 - val_tn: 70766.0000 - val_fn: 9234.0000 - val_accuracy: 0.8153 - val_precision: 0.5383 - val_recall: 0.5383 - val_auc: 0.9289
[INFO] saving weights to checkpoints/lstm-epoch-7-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5433 - tp: 56830.0000 - fp: 23170.0000 - tn: 296830.0000 - fn: 23170.0000 - accuracy: 0.8842 - precision: 0.7104 - recall: 0.7104 - auc: 0.9440 - val_loss: 0.5513 - val_tp: 10729.0000 - val_fp: 9271.0000 - val_tn: 70729.0000 - val_fn: 9271.0000 - val_accuracy: 0.8146 - val_precision: 0.5365 - val_recall: 0.5365 - val_auc: 0.9189
[INFO] saving weights to checkpoints/lstm-epoch-7-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 3-3/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99159%,30:0.00219%,22:0.0011%,31:0.00091%,26:0.00091%,17:0.00091%,7:0.00073%,27:0.00037%,0:0.00037%,28:0.00018%,23:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:87.8572%,Single Stage Single Point:12.1428%]
[INFO] ** dst:[21:43.30869%,10:21.08459%,8:18.1559%,9:17.4415%,6:0.00219%,15:0.00146%,18:0.00128%,16:0.00128%,22:0.00091%,2:0.00037%,7:0.00037%,25:0.00037%,17:0.00037%,12:0.00018%,24:0.00018%,19:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99854%,0:0.00146%]
[INFO] ** i/f_name:[2:99.99854%,3:0.00146%]
[INFO] ** modbus_function_code:[0.02961:99.99159%,-33.760870000000004:0.00822%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99634%,11:49.99525%,0:0.00822%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.9989%,2:0.0011%]
[INFO] ** proto:[0:99.99415%,2:0.00439%,1:0.00146%]
[INFO] ** proxy_src_ip:[18:38.40895%,20:25.9847%,13:18.15608%,6:17.44186%,17:0.00219%,1:0.00146%,14:0.00128%,7:0.00091%,11:0.00073%,10:0.00073%,21:0.00055%,16:0.00018%,15:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.98397%,-0.32151:21.08441%,-1.27613:18.15553%,-0.23351:17.44132%,-0.33484:17.32453%,-71.33197:0.00146%,-71.14931:0.0011%,-71.14798:0.0011%,-64.19493:0.00037%,-0.08551:0.00037%,1.45709:0.00037%,-0.24151:0.00037%,14.4699:0.00018%,4.29964:0.00018%,4.90362:0.00018%,10.192739999999999:0.00018%,-3.3787199999999995:0.00018%,13.86459:0.00018%,4.44364:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,-43.76509:0.00018%,-5.08665:0.00018%,-58.035180000000004:0.00018%,4.076980000000001:0.00018%,-58.032509999999995:0.00018%,-1.27347:0.00018%,-1.2708:0.00018%,-1.02014:0.00018%,-5.1466400000000005:0.00018%,13.431270000000001:0.00018%,12.60597:0.00018%,1.47576:0.00018%,1.46509:0.00018%,14.253910000000001:0.00018%,-68.79874000000001:0.00018%,-0.24950999999999998:0.00018%,-2.1481:0.00018%,10.67005:0.00018%,-68.36943000000001:0.00018%]
[INFO] ** scada_tag:[3:25.9836%,1:21.08423%,5:18.15535%,4:17.44113%,2:17.32435%,0:0.01133%]
[INFO] ** service:[0.0048200000000000005:99.99178%,-211.73542999999998:0.00146%,-186.43601999999998:0.00128%,-211.08346:0.0011%,-211.08818:0.0011%,-205.44247:0.00091%,-211.09762999999998:0.00073%,-202.75898:0.00037%,-186.44547:0.00037%,-183.8612:0.00018%,-185.9872:0.00018%,-201.23771000000002:0.00018%,-211.35747999999998:0.00018%,-211.07873999999998:0.00018%]
[INFO] ** src:[22:38.40895%,9:25.9847%,7:18.15608%,1:17.44186%,21:0.00201%,3:0.00164%,2:0.00128%,11:0.00073%,10:0.00073%,4:0.00073%,14:0.00037%,8:0.00037%,17:0.00018%,15:0.00018%,13:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1486 (0.27158%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4490 - tp: 61490.0000 - fp: 18510.0000 - tn: 301490.0000 - fn: 18510.0000 - accuracy: 0.9075 - precision: 0.7686 - recall: 0.7686 - auc: 0.9669 - val_loss: 0.6318 - val_tp: 10603.0000 - val_fp: 9397.0000 - val_tn: 70603.0000 - val_fn: 9397.0000 - val_accuracy: 0.8121 - val_precision: 0.5301 - val_recall: 0.5301 - val_auc: 0.9363
[INFO] saving weights to checkpoints/lstm-epoch-7-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4289 - tp: 57874.0000 - fp: 22126.0000 - tn: 297874.0000 - fn: 22126.0000 - accuracy: 0.8894 - precision: 0.7234 - recall: 0.7234 - auc: 0.9598 - val_loss: 0.3112 - val_tp: 17257.0000 - val_fp: 2743.0000 - val_tn: 77257.0000 - val_fn: 2743.0000 - val_accuracy: 0.9451 - val_precision: 0.8629 - val_recall: 0.8629 - val_auc: 0.9841
[INFO] saving weights to checkpoints/lstm-epoch-7-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1281 - tp: 69885.0000 - fp: 10115.0000 - tn: 309885.0000 - fn: 10115.0000 - accuracy: 0.9494 - precision: 0.8736 - recall: 0.8736 - auc: 0.9952 - val_loss: 0.0019 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0317 - tp: 76967.0000 - fp: 3033.0000 - tn: 316967.0000 - fn: 3033.0000 - accuracy: 0.9848 - precision: 0.9621 - recall: 0.9621 - auc: 0.9996 - val_loss: 0.0010 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0293 - tp: 78150.0000 - fp: 1850.0000 - tn: 318150.0000 - fn: 1850.0000 - accuracy: 0.9908 - precision: 0.9769 - recall: 0.9769 - auc: 0.9998 - val_loss: 5.9999e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 4-4/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99762%,30:0.00128%,31:0.00037%,33:0.00018%,26:0.00018%,23:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:91.99886%,Single Stage Single Point:8.00114%]
[INFO] ** dst:[21:43.35364%,10:20.94771%,8:18.17472%,9:17.52045%,15:0.00128%,22:0.0011%,18:0.00037%,24:0.00018%,19:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.9989%,0:0.0011%]
[INFO] ** i/f_name:[2:99.99872%,3:0.00128%]
[INFO] ** modbus_function_code:[0.02961:99.99762%,-33.760870000000004:0.00238%]
[INFO] ** modbus_function_description:[7:49.99982%,11:49.99781%,0:0.00238%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.9989%,2:0.0011%]
[INFO] ** proto:[0:99.99817%,1:0.00128%,2:0.00055%]
[INFO] ** proxy_src_ip:[18:38.26201%,20:26.03971%,13:18.17472%,6:17.52082%,17:0.00128%,21:0.00037%,16:0.00037%,14:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.03898%,-0.32151:20.94753%,-1.27613:18.17436%,-0.23351:17.52027%,-0.33484:17.31448%,-71.33197:0.00128%,1.45709:0.00037%,-0.08551:0.00037%,-0.24151:0.00037%,-1.02014:0.00037%,-1.2708:0.00018%,14.4699:0.00018%,4.44364:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-49.275529999999996:0.00018%]
[INFO] ** scada_tag:[3:26.0388%,1:20.94734%,5:18.17436%,4:17.5199%,2:17.3143%,0:0.0053%]
[INFO] ** service:[0.0048200000000000005:99.99781%,-211.73542999999998:0.00128%,-186.43601999999998:0.00037%,-183.8612:0.00018%,-211.08346:0.00018%,-211.07873999999998:0.00018%]
[INFO] ** src:[22:38.26201%,9:26.03971%,7:18.17472%,1:17.52082%,21:0.0011%,15:0.00037%,4:0.00037%,17:0.00018%,14:0.00018%,8:0.00018%,3:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1496 (0.27341%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0252 - tp: 79825.0000 - fp: 175.0000 - tn: 319825.0000 - fn: 175.0000 - accuracy: 0.9991 - precision: 0.9978 - recall: 0.9978 - auc: 1.0000 - val_loss: 3.1639e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0228 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.6415e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.7325e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0183 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9839e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2539 - tp: 54119.0000 - fp: 25881.0000 - tn: 294119.0000 - fn: 25881.0000 - accuracy: 0.8706 - precision: 0.6765 - recall: 0.6765 - auc: 0.9142 - val_loss: 0.5141 - val_tp: 10512.0000 - val_fp: 9488.0000 - val_tn: 70512.0000 - val_fn: 9488.0000 - val_accuracy: 0.8102 - val_precision: 0.5256 - val_recall: 0.5256 - val_auc: 0.9258
[INFO] saving weights to checkpoints/lstm-epoch-7-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 5-5/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99634%,30:0.00256%,37:0.00018%,26:0.00018%,12:0.00018%,9:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:89.70251%,Single Stage Single Point:10.29749%]
[INFO] ** dst:[21:43.36534%,10:20.76239%,8:18.2407%,9:17.62718%,15:0.00256%,22:0.00091%,25:0.00018%,24:0.00018%,6:0.00018%,2:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99781%,0:0.00219%]
[INFO] ** i/f_name:[2:99.99744%,3:0.00256%]
[INFO] ** modbus_function_code:[0.02961:99.99634%,-33.760870000000004:0.00366%]
[INFO] ** modbus_function_description:[7:49.99872%,11:49.99762%,0:0.00366%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.99799%,2:0.00201%]
[INFO] ** proto:[0:99.99708%,1:0.00256%,2:0.00037%]
[INFO] ** proxy_src_ip:[18:37.99884%,20:26.12908%,13:18.24088%,6:17.62736%,17:0.00256%,1:0.00037%,21:0.00018%,16:0.00018%,7:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.12853%,-0.32151:20.76203%,-1.27613:18.2407%,-0.23351:17.627%,-0.33484:17.23681%,-71.33197:0.00256%,-0.24151:0.00037%,1.45709:0.00037%,1.47576:0.00018%,-49.275529999999996:0.00018%,-1.27347:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,2.22906:0.00018%,14.4699:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.12816%,1:20.76184%,5:18.24052%,4:17.627%,2:17.23681%,0:0.00567%]
[INFO] ** service:[0.0048200000000000005:99.99671%,-211.73542999999998:0.00256%,-183.8612:0.00018%,-211.08346:0.00018%,-211.35747999999998:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:37.99884%,9:26.12908%,7:18.24088%,1:17.62736%,21:0.00219%,14:0.00055%,3:0.00037%,16:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1497 (0.27359%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2134 - tp: 67312.0000 - fp: 12688.0000 - tn: 307312.0000 - fn: 12688.0000 - accuracy: 0.9366 - precision: 0.8414 - recall: 0.8414 - auc: 0.9893 - val_loss: 1.7041 - val_tp: 12798.0000 - val_fp: 7202.0000 - val_tn: 72798.0000 - val_fn: 7202.0000 - val_accuracy: 0.8560 - val_precision: 0.6399 - val_recall: 0.6399 - val_auc: 0.8957
[INFO] saving weights to checkpoints/lstm-epoch-7-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3460 - tp: 71523.0000 - fp: 8477.0000 - tn: 311523.0000 - fn: 8477.0000 - accuracy: 0.9576 - precision: 0.8940 - recall: 0.8940 - auc: 0.9850 - val_loss: 0.1740 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2938 - tp: 61684.0000 - fp: 18316.0000 - tn: 301684.0000 - fn: 18316.0000 - accuracy: 0.9084 - precision: 0.7710 - recall: 0.7710 - auc: 0.9773 - val_loss: 0.2764 - val_tp: 13585.0000 - val_fp: 6415.0000 - val_tn: 73585.0000 - val_fn: 6415.0000 - val_accuracy: 0.8717 - val_precision: 0.6793 - val_recall: 0.6793 - val_auc: 0.9724
[INFO] saving weights to checkpoints/lstm-epoch-7-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1226 - tp: 74177.0000 - fp: 5823.0000 - tn: 314177.0000 - fn: 5823.0000 - accuracy: 0.9709 - precision: 0.9272 - recall: 0.9272 - auc: 0.9974 - val_loss: 0.0067 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0307 - tp: 79923.0000 - fp: 77.0000 - tn: 319923.0000 - fn: 77.0000 - accuracy: 0.9996 - precision: 0.9990 - recall: 0.9990 - auc: 1.0000 - val_loss: 0.0021 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 6-6/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.9958%,30:0.00329%,31:0.00018%,27:0.00018%,26:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:92.61567%,Single Stage Single Point:7.38433%]
[INFO] ** dst:[21:43.37082%,10:20.73224%,8:18.28328%,9:17.60872%,15:0.00329%,22:0.00055%,25:0.00018%,24:0.00018%,18:0.00018%,12:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99689%,0:0.00311%]
[INFO] ** i/f_name:[2:99.99671%,3:0.00329%]
[INFO] ** modbus_function_code:[0.02961:99.9958%,-33.760870000000004:0.0042%]
[INFO] ** modbus_function_description:[7:49.99854%,11:49.99726%,0:0.0042%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.99963%,1:0.00037%]
[INFO] ** proto:[0:99.9958%,1:0.00329%,2:0.00091%]
[INFO] ** proxy_src_ip:[18:37.94109%,20:26.16216%,13:18.28346%,6:17.60891%,17:0.00329%,14:0.00055%,16:0.00037%,11:0.00018%]
[INFO] ** s_port:[1.45442:26.16179%,-0.32151:20.73224%,-1.27613:18.28292%,-0.23351:17.60854%,-0.33484:17.20885%,-71.33197:0.00329%,-1.02014:0.00037%,-71.14798:0.00018%,-64.19493:0.00018%,4.90362:0.00018%,-1.2708:0.00018%,-0.24151:0.00018%,13.431270000000001:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-68.36943000000001:0.00018%]
[INFO] ** scada_tag:[3:26.16161%,1:20.73187%,5:18.28273%,4:17.60817%,2:17.20867%,0:0.00694%]
[INFO] ** service:[0.0048200000000000005:99.9958%,-211.73542999999998:0.00329%,-211.08346:0.00018%,-201.23771000000002:0.00018%,-202.75898:0.00018%,-186.44547:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:37.94109%,9:26.16216%,7:18.28346%,1:17.60891%,14:0.00329%,2:0.00055%,15:0.00037%,10:0.00018%]
[INFO] ** type:[0:99.99909%,1:0.00091%]
[INFO] ** unixtime:1498 (0.27377%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0242 - tp: 79951.0000 - fp: 49.0000 - tn: 319951.0000 - fn: 49.0000 - accuracy: 0.9998 - precision: 0.9994 - recall: 0.9994 - auc: 1.0000 - val_loss: 0.0011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79976.0000 - fp: 24.0000 - tn: 319976.0000 - fn: 24.0000 - accuracy: 0.9999 - precision: 0.9997 - recall: 0.9997 - auc: 1.0000 - val_loss: 3.2405e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0188 - tp: 79995.0000 - fp: 5.0000 - tn: 319995.0000 - fn: 5.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 1.1811e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0153 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.9274e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5160 - tp: 63770.0000 - fp: 16230.0000 - tn: 303770.0000 - fn: 16230.0000 - accuracy: 0.9189 - precision: 0.7971 - recall: 0.7971 - auc: 0.9705 - val_loss: 0.3109 - val_tp: 12809.0000 - val_fp: 7191.0000 - val_tn: 72809.0000 - val_fn: 7191.0000 - val_accuracy: 0.8562 - val_precision: 0.6405 - val_recall: 0.6405 - val_auc: 0.9677
[INFO] saving weights to checkpoints/lstm-epoch-7-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 7-7/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99525%,30:0.00164%,22:0.00091%,17:0.00073%,26:0.00055%,31:0.00037%,28:0.00018%,27:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:81.10229%,Single Stage Single Point:18.89771%]
[INFO] ** dst:[21:43.35986%,10:20.74613%,8:18.25386%,9:17.63358%,15:0.00164%,22:0.00146%,6:0.00146%,16:0.00073%,24:0.00037%,18:0.00037%,17:0.00037%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99836%,0:0.00164%]
[INFO] ** i/f_name:[2:99.99836%,3:0.00164%]
[INFO] ** modbus_function_code:[0.02961:99.99525%,-33.760870000000004:0.00475%]
[INFO] ** modbus_function_description:[7:49.99836%,11:49.99689%,0:0.00475%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99634%,2:0.00201%,1:0.00164%]
[INFO] ** proxy_src_ip:[18:37.96905%,20:26.13767%,13:18.25422%,6:17.63376%,17:0.00164%,11:0.00073%,1:0.00073%,21:0.00055%,16:0.00055%,14:0.00037%,7:0.00037%,10:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13675%,-0.32151:20.74613%,-1.27613:18.25368%,-0.23351:17.63339%,-0.33484:17.22292%,-71.33197:0.00164%,-71.14931:0.00091%,-1.02014:0.00055%,-71.14798:0.00055%,1.45709:0.00055%,-0.24151:0.00037%,-1.27347:0.00037%,1.47576:0.00018%,1.46509:0.00018%,14.253910000000001:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,-68.79874000000001:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,6.1115699999999995:0.00018%,-5.08665:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:26.13639%,1:20.74613%,5:18.25349%,4:17.63321%,2:17.22292%,0:0.00786%]
[INFO] ** service:[0.0048200000000000005:99.99525%,-211.73542999999998:0.00164%,-211.08818:0.00091%,-205.44247:0.00073%,-211.08346:0.00055%,-186.43601999999998:0.00037%,-211.09762999999998:0.00018%,-185.9872:0.00018%,-202.75898:0.00018%]
[INFO] ** src:[22:37.96905%,9:26.13767%,7:18.25422%,1:17.63376%,14:0.00164%,10:0.00073%,3:0.00073%,15:0.00055%,4:0.00055%,21:0.00037%,2:0.00037%,11:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1495 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2437 - tp: 71192.0000 - fp: 8808.0000 - tn: 311192.0000 - fn: 8808.0000 - accuracy: 0.9560 - precision: 0.8899 - recall: 0.8899 - auc: 0.9923 - val_loss: 0.1553 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1559 - tp: 78327.0000 - fp: 1673.0000 - tn: 318327.0000 - fn: 1673.0000 - accuracy: 0.9916 - precision: 0.9791 - recall: 0.9791 - auc: 0.9979 - val_loss: 0.1019 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1214 - tp: 78321.0000 - fp: 1679.0000 - tn: 318321.0000 - fn: 1679.0000 - accuracy: 0.9916 - precision: 0.9790 - recall: 0.9790 - auc: 0.9978 - val_loss: 0.3831 - val_tp: 15776.0000 - val_fp: 4224.0000 - val_tn: 75776.0000 - val_fn: 4224.0000 - val_accuracy: 0.9155 - val_precision: 0.7888 - val_recall: 0.7888 - val_auc: 0.9811
[INFO] saving weights to checkpoints/lstm-epoch-7-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3574 - tp: 59204.0000 - fp: 20796.0000 - tn: 299204.0000 - fn: 20796.0000 - accuracy: 0.8960 - precision: 0.7401 - recall: 0.7401 - auc: 0.9805 - val_loss: 0.0112 - val_tp: 19988.0000 - val_fp: 12.0000 - val_tn: 79988.0000 - val_fn: 12.0000 - val_accuracy: 0.9998 - val_precision: 0.9994 - val_recall: 0.9994 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0390 - tp: 77203.0000 - fp: 2797.0000 - tn: 317203.0000 - fn: 2797.0000 - accuracy: 0.9860 - precision: 0.9650 - recall: 0.9650 - auc: 0.9997 - val_loss: 6.0794e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 8-8/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99708%,30:0.0011%,0:0.00055%,24:0.00018%,23:0.00018%,22:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:94.77715%,Single Stage Single Point:5.22285%]
[INFO] ** dst:[21:43.42474%,10:20.80571%,8:18.1835%,9:17.58241%,22:0.00128%,15:0.0011%,25:0.00055%,19:0.00037%,26:0.00018%,24:0.00018%]
[INFO] ** i/f_dir:[1:99.99927%,0:0.00073%]
[INFO] ** i/f_name:[2:99.9989%,3:0.0011%]
[INFO] ** modbus_function_code:[0.02961:99.99708%,-33.760870000000004:0.00274%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99963%,11:49.99744%,0:0.00274%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.99963%,2:0.00037%]
[INFO] ** proto:[0:99.99817%,1:0.0011%,2:0.00073%]
[INFO] ** proxy_src_ip:[18:38.09131%,20:26.13968%,13:18.18277%,6:17.58277%,17:0.0011%,10:0.0011%,16:0.00055%,14:0.00037%,11:0.00018%,5:0.00018%]
[INFO] ** s_port:[1.45442:26.13913%,-0.32151:20.80571%,-1.27613:18.18258%,-0.23351:17.58222%,-0.33484:17.28561%,-71.33197:0.0011%,-15.039579999999999:0.00073%,-1.02014:0.00055%,-64.19493:0.00055%,1.45709:0.00037%,-0.24151:0.00037%,4.66896:0.00037%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.13858%,1:20.80552%,5:18.18258%,4:17.58204%,2:17.28542%,0:0.00585%]
[INFO] ** service:[0.0048200000000000005:99.99781%,-211.73542999999998:0.0011%,-186.44547:0.00055%,-211.07873999999998:0.00037%,-211.08818:0.00018%]
[INFO] ** src:[22:38.09131%,9:26.13968%,7:18.18277%,1:17.58277%,11:0.0011%,14:0.00073%,15:0.00055%,21:0.00037%,2:0.00037%,16:0.00018%,10:0.00018%]
[INFO] ** type:[0:99.99945%,1:0.00037%,2:0.00018%]
[INFO] ** unixtime:1498 (0.27377%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0317 - tp: 77411.0000 - fp: 2589.0000 - tn: 317411.0000 - fn: 2589.0000 - accuracy: 0.9871 - precision: 0.9676 - recall: 0.9676 - auc: 0.9997 - val_loss: 9.2977e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0279 - tp: 77505.0000 - fp: 2495.0000 - tn: 317505.0000 - fn: 2495.0000 - accuracy: 0.9875 - precision: 0.9688 - recall: 0.9688 - auc: 0.9998 - val_loss: 1.8081e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0256 - tp: 77532.0000 - fp: 2468.0000 - tn: 317532.0000 - fn: 2468.0000 - accuracy: 0.9877 - precision: 0.9692 - recall: 0.9692 - auc: 0.9998 - val_loss: 1.3193e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0245 - tp: 77450.0000 - fp: 2550.0000 - tn: 317450.0000 - fn: 2550.0000 - accuracy: 0.9872 - precision: 0.9681 - recall: 0.9681 - auc: 0.9997 - val_loss: 1.5400 - val_tp: 18082.0000 - val_fp: 1918.0000 - val_tn: 78082.0000 - val_fn: 1918.0000 - val_accuracy: 0.9616 - val_precision: 0.9041 - val_recall: 0.9041 - val_auc: 0.9401
[INFO] saving weights to checkpoints/lstm-epoch-7-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3826 - tp: 69186.0000 - fp: 10814.0000 - tn: 309186.0000 - fn: 10814.0000 - accuracy: 0.9459 - precision: 0.8648 - recall: 0.8648 - auc: 0.9818 - val_loss: 0.1924 - val_tp: 19274.0000 - val_fp: 726.0000 - val_tn: 79274.0000 - val_fn: 726.0000 - val_accuracy: 0.9855 - val_precision: 0.9637 - val_recall: 0.9637 - val_auc: 0.9982
[INFO] saving weights to checkpoints/lstm-epoch-7-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 9-9/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99817%,30:0.0011%,31:0.00037%,26:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:94.88113%,Single Stage Single Point:5.11887%]
[INFO] ** dst:[21:43.37174%,10:20.77647%,8:18.27908%,9:17.5698%,15:0.0011%,22:0.00091%,18:0.00037%,25:0.00018%,24:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.9989%,0:0.0011%]
[INFO] ** i/f_name:[2:99.9989%,3:0.0011%]
[INFO] ** modbus_function_code:[0.02961:99.99817%,-33.760870000000004:0.00183%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99799%,0:0.00183%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.99963%,2:0.00037%]
[INFO] ** proto:[0:99.99817%,1:0.0011%,2:0.00073%]
[INFO] ** proxy_src_ip:[18:38.01401%,20:26.13474%,13:18.27908%,6:17.57016%,17:0.0011%,21:0.00018%,16:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13401%,-0.32151:20.77647%,-1.27613:18.27871%,-0.23351:17.56961%,-0.33484:17.23754%,-71.33197:0.0011%,-0.24151:0.00037%,1.45709:0.00037%,-0.08551:0.00037%,1.46509:0.00018%,1.47576:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.13365%,1:20.77628%,5:18.27871%,4:17.56943%,2:17.23736%,0:0.00457%]
[INFO] ** service:[0.0048200000000000005:99.99817%,-211.73542999999998:0.0011%,-186.43601999999998:0.00037%,-211.08346:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.01401%,9:26.13474%,7:18.27908%,1:17.57016%,14:0.00073%,21:0.00037%,17:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1498 (0.27377%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1612 - tp: 75864.0000 - fp: 4136.0000 - tn: 315864.0000 - fn: 4136.0000 - accuracy: 0.9793 - precision: 0.9483 - recall: 0.9483 - auc: 0.9971 - val_loss: 0.0877 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1460 - tp: 73016.0000 - fp: 6984.0000 - tn: 313016.0000 - fn: 6984.0000 - accuracy: 0.9651 - precision: 0.9127 - recall: 0.9127 - auc: 0.9950 - val_loss: 0.1700 - val_tp: 16344.0000 - val_fp: 3656.0000 - val_tn: 76344.0000 - val_fn: 3656.0000 - val_accuracy: 0.9269 - val_precision: 0.8172 - val_recall: 0.8172 - val_auc: 0.9916
[INFO] saving weights to checkpoints/lstm-epoch-7-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0487 - tp: 75838.0000 - fp: 4162.0000 - tn: 315838.0000 - fn: 4162.0000 - accuracy: 0.9792 - precision: 0.9480 - recall: 0.9480 - auc: 0.9993 - val_loss: 4.6374e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0241 - tp: 77439.0000 - fp: 2561.0000 - tn: 317439.0000 - fn: 2561.0000 - accuracy: 0.9872 - precision: 0.9680 - recall: 0.9680 - auc: 0.9997 - val_loss: 2.3956e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79927.0000 - fp: 73.0000 - tn: 319927.0000 - fn: 73.0000 - accuracy: 0.9996 - precision: 0.9991 - recall: 0.9991 - auc: 1.0000 - val_loss: 8.2945e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 10-10/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99616%,30:0.00183%,31:0.00037%,26:0.00018%,24:0.00018%,23:0.00018%,22:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:94.41693%,Single Stage Single Point:5.58307%]
[INFO] ** dst:[21:43.41505%,10:20.80772%,8:18.22425%,9:17.54896%,15:0.00183%,22:0.00055%,24:0.00037%,19:0.00037%,18:0.00037%,26:0.00018%,25:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99836%,0:0.00164%]
[INFO] ** i/f_name:[2:99.99817%,3:0.00183%]
[INFO] ** modbus_function_code:[0.02961:99.99616%,-33.760870000000004:0.00366%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.9989%,11:49.99726%,0:0.00366%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.99927%,1:0.00073%]
[INFO] ** proto:[0:99.99726%,1:0.00183%,2:0.00091%]
[INFO] ** proxy_src_ip:[18:38.0904%,20:26.13292%,13:18.22443%,6:17.54823%,17:0.00183%,10:0.00091%,14:0.00037%,21:0.00018%,16:0.00018%,5:0.00018%,2:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13219%,-0.32151:20.80772%,-1.27613:18.22389%,-0.23351:17.54786%,-0.33484:17.28268%,-71.33197:0.00183%,-10.51843:0.00073%,-0.08551:0.00037%,-1.27347:0.00037%,5.71692:0.00037%,1.47576:0.00037%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-71.14931:0.00018%,-64.19493:0.00018%,1.45709:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.13182%,1:20.80753%,5:18.22389%,4:17.54768%,2:17.2825%,0:0.00658%]
[INFO] ** service:[0.0048200000000000005:99.99689%,-211.73542999999998:0.00183%,-211.07873999999998:0.00037%,-186.43601999999998:0.00037%,-211.08346:0.00018%,-186.44547:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.0904%,9:26.13292%,7:18.22443%,1:17.54823%,14:0.00183%,11:0.00091%,2:0.00037%,17:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%]
[INFO] ** type:[0:99.99854%,1:0.00128%,2:0.00018%]
[INFO] ** unixtime:1495 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0181 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.0919e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0164 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9807e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6731 - tp: 62252.0000 - fp: 17748.0000 - tn: 302252.0000 - fn: 17748.0000 - accuracy: 0.9113 - precision: 0.7782 - recall: 0.7782 - auc: 0.9620 - val_loss: 0.2382 - val_tp: 19283.0000 - val_fp: 717.0000 - val_tn: 79283.0000 - val_fn: 717.0000 - val_accuracy: 0.9857 - val_precision: 0.9642 - val_recall: 0.9642 - val_auc: 0.9948
[INFO] saving weights to checkpoints/lstm-epoch-7-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2079 - tp: 73774.0000 - fp: 6226.0000 - tn: 313774.0000 - fn: 6226.0000 - accuracy: 0.9689 - precision: 0.9222 - recall: 0.9222 - auc: 0.9941 - val_loss: 0.0896 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0345 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 11-11/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.9989%,31:0.00037%,30:0.00037%,26:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.38928%,10:20.87314%,8:18.1994%,9:17.5358%,22:0.00128%,18:0.00037%,15:0.00037%,25:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99963%,3:0.00037%]
[INFO] ** modbus_function_code:[0.02961:99.9989%,-33.760870000000004:0.0011%]
[INFO] ** modbus_function_description:[7:50.00073%,11:49.99817%,0:0.0011%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9989%,2:0.00073%,1:0.00037%]
[INFO] ** proxy_src_ip:[18:38.14596%,20:26.11683%,13:18.1994%,6:17.53617%,16:0.00055%,17:0.00037%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.11629%,-0.32151:20.87314%,-1.27613:18.19921%,-0.23351:17.53562%,-0.33484:17.27281%,-0.24151:0.00055%,-1.02014:0.00055%,-0.08551:0.00037%,-71.33197:0.00037%,-71.14798:0.00018%,1.45709:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:26.11592%,1:20.87314%,5:18.19903%,4:17.53525%,2:17.27263%,0:0.00402%]
[INFO] ** service:[0.0048200000000000005:99.9989%,-211.73542999999998:0.00037%,-186.43601999999998:0.00037%,-211.08346:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.14596%,9:26.11683%,7:18.1994%,1:17.53617%,15:0.00055%,14:0.00037%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1496 (0.27341%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0146 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3847e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0114 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5517e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0097 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4048e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0084 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7346e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0072 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6699e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 12-12/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99781%,30:0.00201%,9:0.00018%]
[INFO] ** classification:[normal:93.38581%,Single Stage Single Point:6.61419%]
[INFO] ** dst:[21:43.39623%,10:20.88228%,8:18.18496%,9:17.53343%,15:0.00201%,22:0.00055%,24:0.00037%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99836%,0:0.00164%]
[INFO] ** i/f_name:[2:99.99799%,3:0.00201%]
[INFO] ** modbus_function_code:[0.02961:99.99781%,-33.760870000000004:0.00219%]
[INFO] ** modbus_function_description:[7:49.99963%,11:49.99817%,0:0.00219%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.99836%,2:0.00164%]
[INFO] ** proto:[0:99.99799%,1:0.00201%]
[INFO] ** proxy_src_ip:[18:38.15235%,20:26.12652%,13:18.18514%,6:17.53361%,17:0.00201%,16:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:26.12597%,-0.32151:20.88228%,-1.27613:18.18459%,-0.23351:17.53324%,-0.33484:17.27007%,-71.33197:0.00201%,-1.27347:0.00037%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:26.12561%,1:20.88228%,5:18.18459%,4:17.53288%,2:17.27007%,0:0.00457%]
[INFO] ** service:[0.0048200000000000005:99.99781%,-211.73542999999998:0.00201%,-183.8612:0.00018%]
[INFO] ** src:[22:38.15235%,9:26.12652%,7:18.18514%,1:17.53361%,21:0.00164%,14:0.00037%,15:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1496 (0.27341%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0067 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2926e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0061 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.2059e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4823 - tp: 64944.0000 - fp: 15056.0000 - tn: 304944.0000 - fn: 15056.0000 - accuracy: 0.9247 - precision: 0.8118 - recall: 0.8118 - auc: 0.9735 - val_loss: 0.3720 - val_tp: 12818.0000 - val_fp: 7182.0000 - val_tn: 72818.0000 - val_fn: 7182.0000 - val_accuracy: 0.8564 - val_precision: 0.6409 - val_recall: 0.6409 - val_auc: 0.9678
[INFO] saving weights to checkpoints/lstm-epoch-7-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2666 - tp: 66044.0000 - fp: 13956.0000 - tn: 306044.0000 - fn: 13956.0000 - accuracy: 0.9302 - precision: 0.8256 - recall: 0.8256 - auc: 0.9834 - val_loss: 0.1941 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1397 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0900 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 13-13/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99653%,31:0.00073%,26:0.00055%,0:0.00055%,30:0.00037%,22:0.00037%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:86.01665%,Single Stage Single Point:13.98335%]
[INFO] ** dst:[21:43.35401%,10:20.80571%,8:18.2789%,9:17.55737%,22:0.0011%,6:0.00091%,18:0.00073%,25:0.00055%,15:0.00037%,24:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99963%,3:0.00037%]
[INFO] ** modbus_function_code:[0.02961:99.99653%,-33.760870000000004:0.00329%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.9989%,11:49.99762%,0:0.00329%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99726%,2:0.00238%,1:0.00037%]
[INFO] ** proxy_src_ip:[18:38.05239%,20:26.1077%,13:18.27908%,6:17.55682%,10:0.0011%,11:0.00091%,16:0.00055%,17:0.00037%,7:0.00037%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.10715%,-0.32151:20.80571%,-1.27613:18.27871%,-0.23351:17.55645%,-0.33484:17.24668%,-9.78512:0.00073%,-64.19493:0.00055%,-1.02014:0.00055%,-71.14798:0.00055%,-0.24151:0.00037%,-71.14931:0.00037%,-0.08551:0.00037%,-71.33197:0.00037%,1.47576:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-1.2708:0.00018%,-68.79874000000001:0.00018%,6.1115699999999995:0.00018%,14.540560000000001:0.00018%,1.45709:0.00018%]
[INFO] ** scada_tag:[3:26.10678%,1:20.80552%,5:18.27871%,4:17.55645%,2:17.2465%,0:0.00603%]
[INFO] ** service:[0.0048200000000000005:99.99726%,-186.43601999999998:0.00073%,-211.08346:0.00055%,-186.44547:0.00055%,-211.73542999999998:0.00037%,-211.08818:0.00037%,-202.75898:0.00018%]
[INFO] ** src:[22:38.05239%,9:26.1077%,7:18.27908%,1:17.55682%,11:0.0011%,10:0.00091%,15:0.00055%,21:0.00037%,14:0.00037%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1495 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0243 - tp: 79993.0000 - fp: 7.0000 - tn: 319993.0000 - fn: 7.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 1.1196e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0071 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5576e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0067 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4986e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4523 - tp: 63298.0000 - fp: 16702.0000 - tn: 303298.0000 - fn: 16702.0000 - accuracy: 0.9165 - precision: 0.7912 - recall: 0.7912 - auc: 0.9746 - val_loss: 0.3923 - val_tp: 12842.0000 - val_fp: 7158.0000 - val_tn: 72842.0000 - val_fn: 7158.0000 - val_accuracy: 0.8568 - val_precision: 0.6421 - val_recall: 0.6421 - val_auc: 0.9680
[INFO] saving weights to checkpoints/lstm-epoch-7-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2932 - tp: 62002.0000 - fp: 17998.0000 - tn: 302002.0000 - fn: 17998.0000 - accuracy: 0.9100 - precision: 0.7750 - recall: 0.7750 - auc: 0.9754 - val_loss: 0.1956 - val_tp: 19997.0000 - val_fp: 3.0000 - val_tn: 79997.0000 - val_fn: 3.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 14-14/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99963%,30:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:93.73049%,Single Stage Single Point:6.26951%]
[INFO] ** dst:[21:43.34633%,10:20.81283%,8:18.2661%,9:17.57327%,22:0.00073%,24:0.00037%,15:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:99.99982%,3:0.00018%]
[INFO] ** modbus_function_code:[0.02961:99.99963%,-33.760870000000004:0.00037%]
[INFO] ** modbus_function_description:[7:50.00073%,11:49.9989%,0:0.00037%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,1:0.00018%]
[INFO] ** proxy_src_ip:[18:38.05257%,20:26.10715%,13:18.26629%,6:17.57345%,17:0.00018%,16:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:26.10642%,-0.32151:20.81283%,-1.27613:18.26574%,-0.23351:17.57308%,-0.33484:17.23973%,-1.27347:0.00037%,1.45709:0.00037%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,14.4699:0.00018%,-71.33197:0.00018%]
[INFO] ** scada_tag:[3:26.10605%,1:20.81283%,5:18.26555%,4:17.57272%,2:17.23955%,0:0.00329%]
[INFO] ** service:[0.0048200000000000005:99.99963%,-183.8612:0.00018%,-211.73542999999998:0.00018%]
[INFO] ** src:[22:38.05257%,9:26.10715%,7:18.26629%,1:17.57345%,15:0.00018%,14:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1495 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1590 - tp: 78369.0000 - fp: 1631.0000 - tn: 318369.0000 - fn: 1631.0000 - accuracy: 0.9918 - precision: 0.9796 - recall: 0.9796 - auc: 0.9984 - val_loss: 0.2087 - val_tp: 18481.0000 - val_fp: 1519.0000 - val_tn: 78481.0000 - val_fn: 1519.0000 - val_accuracy: 0.9696 - val_precision: 0.9240 - val_recall: 0.9240 - val_auc: 0.9933
[INFO] saving weights to checkpoints/lstm-epoch-7-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3507 - tp: 54224.0000 - fp: 25776.0000 - tn: 294224.0000 - fn: 25776.0000 - accuracy: 0.8711 - precision: 0.6778 - recall: 0.6778 - auc: 0.9658 - val_loss: 0.2286 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1276 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0188 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0243 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8980e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0145 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3790e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 15-15/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99616%,30:0.00311%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:89.90628%,Single Stage Multi Point:10.09299%,Single Stage Single Point:0.00073%]
[INFO] ** dst:[21:43.30174%,10:20.77555%,8:18.31362%,9:17.60379%,15:0.00311%,22:0.00146%,25:0.00018%,24:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99708%,0:0.00292%]
[INFO] ** i/f_name:[2:99.99689%,3:0.00311%]
[INFO] ** modbus_function_code:[0.02961:99.99616%,-33.760870000000004:0.00384%]
[INFO] ** modbus_function_description:[7:49.9989%,11:49.99726%,0:0.00384%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.99726%,2:0.00274%]
[INFO] ** proto:[0:99.99653%,1:0.00311%,2:0.00037%]
[INFO] ** proxy_src_ip:[18:38.0098%,20:26.06804%,13:18.31344%,6:17.60434%,17:0.00311%,16:0.00055%,7:0.00037%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.06731%,-0.32151:20.77537%,-1.27613:18.31325%,-0.23351:17.60361%,-0.33484:17.23443%,-71.33197:0.00311%,-0.24151:0.00055%,-1.02014:0.00055%,1.45709:0.00037%,1.46509:0.00018%,1.47576:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-61.95768:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.06694%,1:20.77519%,5:18.31325%,4:17.60324%,2:17.23425%,0:0.00713%]
[INFO] ** service:[0.0048200000000000005:99.99634%,-211.73542999999998:0.00311%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.0098%,9:26.06804%,7:18.31344%,1:17.60434%,21:0.00311%,15:0.00055%,14:0.00037%,16:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1504 (0.27487%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0135 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.0603e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0126 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0120 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1924e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0111 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.7974 - tp: 56227.0000 - fp: 23773.0000 - tn: 296227.0000 - fn: 23773.0000 - accuracy: 0.8811 - precision: 0.7028 - recall: 0.7028 - auc: 0.8130 - val_loss: 7.5247 - val_tp: 10663.0000 - val_fp: 9337.0000 - val_tn: 70663.0000 - val_fn: 9337.0000 - val_accuracy: 0.8133 - val_precision: 0.5332 - val_recall: 0.5332 - val_auc: 0.7082
[INFO] saving weights to checkpoints/lstm-epoch-7-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 16-16/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (486862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (486862, 17)

[INFO] analyzing data
[INFO] 486862 rows
[INFO] ** appi_name:[21:99.99836%,30:0.00144%,33:0.00021%]
[INFO] ** classification:[normal:81.3859%,Single Stage Multi Point:18.6141%]
[INFO] ** dst:[21:43.35397%,10:20.79747%,8:18.25445%,9:17.59123%,15:0.00144%,22:0.00123%,24:0.00021%]
[INFO] ** i/f_dir:[1:99.99856%,0:0.00144%]
[INFO] ** i/f_name:[2:99.99856%,3:0.00144%]
[INFO] ** modbus_function_code:[0.02961:99.99836%,-33.760870000000004:0.00164%]
[INFO] ** modbus_function_description:[7:50.00041%,11:49.99795%,0:0.00164%]
[INFO] ** modbus_transaction_id:65536 (13.4609%)
[INFO] ** orig:[0:99.99856%,2:0.00144%]
[INFO] ** proto:[0:99.99856%,1:0.00144%]
[INFO] ** proxy_src_ip:[18:38.0463%,20:26.10534%,13:18.25486%,6:17.59143%,17:0.00144%,16:0.00041%,21:0.00021%]
[INFO] ** s_port:[1.45442:26.10473%,-0.32151:20.79727%,-1.27613:18.25445%,-0.23351:17.59102%,-0.33484:17.24904%,-71.33197:0.00144%,1.45709:0.00041%,-0.24151:0.00041%,-1.02014:0.00041%,-1.27347:0.00021%,1.47576:0.00021%,-49.275529999999996:0.00021%,-1.2708:0.00021%]
[INFO] ** scada_tag:[3:26.10432%,1:20.79727%,5:18.25425%,4:17.59061%,2:17.24883%,0:0.00472%]
[INFO] ** service:[0.0048200000000000005:99.99856%,-211.73542999999998:0.00144%]
[INFO] ** src:[22:38.0463%,9:26.10534%,7:18.25486%,1:17.59143%,21:0.00144%,15:0.00041%,4:0.00021%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1332 (0.27359%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/486862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5721 - tp: 42444.0000 - fp: 37556.0000 - tn: 282444.0000 - fn: 37556.0000 - accuracy: 0.8122 - precision: 0.5306 - recall: 0.5306 - auc: 0.7047 - val_loss: 7.5183 - val_tp: 10671.0000 - val_fp: 9329.0000 - val_tn: 70671.0000 - val_fn: 9329.0000 - val_accuracy: 0.8134 - val_precision: 0.5336 - val_recall: 0.5336 - val_auc: 0.7085
[INFO] saving weights to checkpoints/lstm-epoch-7-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/486862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5608 - tp: 42500.0000 - fp: 37500.0000 - tn: 282500.0000 - fn: 37500.0000 - accuracy: 0.8125 - precision: 0.5312 - recall: 0.5312 - auc: 0.7051 - val_loss: 5.0288 - val_tp: 13760.0000 - val_fp: 6240.0000 - val_tn: 73760.0000 - val_fn: 6240.0000 - val_accuracy: 0.8752 - val_precision: 0.6880 - val_recall: 0.6880 - val_auc: 0.8050
[INFO] saving weights to checkpoints/lstm-epoch-7-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/486862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0096 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/486862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0086 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/486862
[33m[INFO] loading file 17-17/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (586862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (586862, 17)

[INFO] analyzing data
[INFO] 586862 rows
[INFO] ** appi_name:[21:99.99727%,7:0.00051%,26:0.00034%,0:0.00034%,33:0.00017%,31:0.00017%,27:0.00017%,24:0.00017%,22:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:94.74323%,Multi Stage Multi Point:5.25677%]
[INFO] ** dst:[21:43.3521%,10:20.83744%,8:18.20922%,9:17.59835%,22:0.00085%,6:0.00051%,25:0.00034%,16:0.00034%,2:0.00034%,24:0.00017%,18:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99727%,-33.760870000000004:0.00256%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99966%,11:49.99761%,0:0.00256%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.16719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99881%,2:0.00119%]
[INFO] ** proxy_src_ip:[18:38.07437%,20:26.11585%,13:18.20871%,6:17.59817%,10:0.00102%,11:0.00085%,1:0.00034%,21:0.00017%,16:0.00017%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:26.11483%,-0.32151:20.83727%,-1.27613:18.20837%,-0.23351:17.598%,-0.33484:17.2371%,6.0369:0.00068%,1.45709:0.00051%,1.47576:0.00034%,-71.14798:0.00034%,-64.19493:0.00034%,1.46509:0.00017%,-49.275529999999996:0.00017%,-1.27347:0.00017%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,-68.79874000000001:0.00017%,6.15557:0.00017%,6.06224:0.00017%,8.55414:0.00017%,-3.3787199999999995:0.00017%,-4.3880099999999995:0.00017%,-71.14931:0.00017%]
[INFO] ** scada_tag:[3:26.11466%,1:20.8371%,5:18.2082%,4:17.59749%,2:17.2371%,0:0.00545%]
[INFO] ** service:[0.0048200000000000005:99.99813%,-211.09762999999998:0.00051%,-211.08346:0.00034%,-186.44547:0.00034%,-211.35747999999998:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.07437%,9:26.11585%,7:18.20871%,1:17.59817%,11:0.00102%,10:0.00085%,3:0.00034%,21:0.00017%,15:0.00017%,4:0.00017%,2:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1603 (0.27315%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0078 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0070 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0063 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5691 - tp: 77204.0000 - fp: 2796.0000 - tn: 317204.0000 - fn: 2796.0000 - accuracy: 0.9860 - precision: 0.9650 - recall: 0.9650 - auc: 0.9780 - val_loss: 2.9262 - val_tp: 16369.0000 - val_fp: 3631.0000 - val_tn: 76369.0000 - val_fn: 3631.0000 - val_accuracy: 0.9274 - val_precision: 0.8184 - val_recall: 0.8184 - val_auc: 0.8865
[INFO] saving weights to checkpoints/lstm-epoch-7-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9316 - tp: 65471.0000 - fp: 14529.0000 - tn: 305471.0000 - fn: 14529.0000 - accuracy: 0.9274 - precision: 0.8184 - recall: 0.8184 - auc: 0.8858 - val_loss: 2.9061 - val_tp: 16394.0000 - val_fp: 3606.0000 - val_tn: 76394.0000 - val_fn: 3606.0000 - val_accuracy: 0.9279 - val_precision: 0.8197 - val_recall: 0.8197 - val_auc: 0.8873
[INFO] saving weights to checkpoints/lstm-epoch-7-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/586862
[33m[INFO] loading file 18-18/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (586862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (586862, 17)

[INFO] analyzing data
[INFO] 586862 rows
[INFO] ** appi_name:[21:99.9983%,30:0.00051%,7:0.00051%,31:0.00017%,27:0.00017%,22:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:82.40029%,Multi Stage Multi Point:17.59971%]
[INFO] ** dst:[21:43.34154%,10:20.83403%,8:18.25421%,9:17.5675%,22:0.00068%,15:0.00051%,24:0.00034%,16:0.00034%,2:0.00034%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99949%,0:0.00051%]
[INFO] ** i/f_name:[2:99.99949%,3:0.00051%]
[INFO] ** modbus_function_code:[0.02961:99.9983%,-33.760870000000004:0.0017%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.9983%,0:0.0017%]
[INFO] ** modbus_transaction_id:65536 (11.16719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99898%,2:0.00051%,1:0.00051%]
[INFO] ** proxy_src_ip:[18:38.0834%,20:26.09268%,13:18.25455%,6:17.56767%,17:0.00051%,11:0.00051%,1:0.00034%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:26.09199%,-0.32151:20.83403%,-1.27613:18.25404%,-0.23351:17.56733%,-0.33484:17.24937%,-71.33197:0.00051%,-1.27347:0.00034%,1.45709:0.00034%,-0.24151:0.00034%,1.47576:0.00017%,1.46509:0.00017%,3.6236699999999997:0.00017%,-1.2708:0.00017%,-2.48275:0.00017%,6.06224:0.00017%,-3.3787199999999995:0.00017%,8.10082:0.00017%,6.45955:0.00017%,-71.14931:0.00017%]
[INFO] ** scada_tag:[3:26.09165%,1:20.83386%,5:18.25387%,4:17.56716%,2:17.2492%,0:0.00426%]
[INFO] ** service:[0.0048200000000000005:99.9983%,-211.09762999999998:0.00051%,-211.73542999999998:0.00051%,-211.35747999999998:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.0834%,9:26.09268%,7:18.25455%,1:17.56767%,14:0.00051%,10:0.00051%,3:0.00034%,21:0.00017%,2:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1603 (0.27315%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2713 - tp: 73712.0000 - fp: 6288.0000 - tn: 313712.0000 - fn: 6288.0000 - accuracy: 0.9686 - precision: 0.9214 - recall: 0.9214 - auc: 0.9505 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.6344 - tp: 52048.0000 - fp: 27952.0000 - tn: 292048.0000 - fn: 27952.0000 - accuracy: 0.8602 - precision: 0.6506 - recall: 0.6506 - auc: 0.7803 - val_loss: 6.1152 - val_tp: 12412.0000 - val_fp: 7588.0000 - val_tn: 72412.0000 - val_fn: 7588.0000 - val_accuracy: 0.8482 - val_precision: 0.6206 - val_recall: 0.6206 - val_auc: 0.7629
[INFO] saving weights to checkpoints/lstm-epoch-7-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1413 - tp: 49531.0000 - fp: 30469.0000 - tn: 289531.0000 - fn: 30469.0000 - accuracy: 0.8477 - precision: 0.6191 - recall: 0.6191 - auc: 0.7605 - val_loss: 6.1007 - val_tp: 12430.0000 - val_fp: 7570.0000 - val_tn: 72430.0000 - val_fn: 7570.0000 - val_accuracy: 0.8486 - val_precision: 0.6215 - val_recall: 0.6215 - val_auc: 0.7634
[INFO] saving weights to checkpoints/lstm-epoch-7-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.7209 - tp: 56581.0000 - fp: 23419.0000 - tn: 296581.0000 - fn: 23419.0000 - accuracy: 0.8829 - precision: 0.7073 - recall: 0.7073 - auc: 0.8160 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0032 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/586862
[33m[INFO] loading file 19-19/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (586862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (586862, 17)

[INFO] analyzing data
[INFO] 586862 rows
[INFO] ** appi_name:[21:99.99813%,26:0.00034%,0:0.00034%,31:0.00017%,27:0.00017%,24:0.00017%,22:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:87.80633%,Single Stage Multi Point:12.19367%]
[INFO] ** dst:[21:43.38874%,10:20.82943%,8:18.20769%,9:17.57159%,22:0.00119%,6:0.00051%,25:0.00034%,24:0.00017%,18:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99813%,-33.760870000000004:0.0017%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99813%,0:0.0017%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.16719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99881%,2:0.00119%]
[INFO] ** proxy_src_ip:[18:38.11782%,20:26.10051%,13:18.20769%,6:17.57159%,10:0.00102%,11:0.00085%,16:0.00051%]
[INFO] ** s_port:[1.45442:26.09949%,-0.32151:20.82943%,-1.27613:18.20735%,-0.23351:17.57142%,-0.33484:17.28839%,-5.20264:0.00068%,1.45709:0.00051%,-1.02014:0.00051%,-64.19493:0.00034%,-71.14798:0.00034%,1.46509:0.00034%,-1.27347:0.00017%,-0.24151:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,-71.14931:0.00017%,-68.79874000000001:0.00017%,0.75578:0.00017%]
[INFO] ** scada_tag:[3:26.09915%,1:20.82926%,5:18.20718%,4:17.57125%,2:17.28822%,0:0.00494%]
[INFO] ** service:[0.0048200000000000005:99.99881%,-211.08346:0.00034%,-186.44547:0.00034%,-202.75898:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.11782%,9:26.10051%,7:18.20769%,1:17.57159%,11:0.00102%,10:0.00085%,15:0.00051%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1605 (0.27349%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0029 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0026 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0022 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0019 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.6335 - tp: 37153.0000 - fp: 42847.0000 - tn: 277153.0000 - fn: 42847.0000 - accuracy: 0.7858 - precision: 0.4644 - recall: 0.4644 - auc: 0.6631 - val_loss: 9.8474 - val_tp: 7781.0000 - val_fp: 12219.0000 - val_tn: 67781.0000 - val_fn: 12219.0000 - val_accuracy: 0.7556 - val_precision: 0.3891 - val_recall: 0.3891 - val_auc: 0.6182
[INFO] saving weights to checkpoints/lstm-epoch-7-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/586862
[33m[INFO] loading file 20-20/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (586862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (586862, 17)

[INFO] analyzing data
[INFO] 586862 rows
[INFO] ** appi_name:[21:99.99676%,30:0.00273%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:90.20673%,Single Stage Multi Point:9.79327%]
[INFO] ** dst:[21:43.42827%,10:20.83659%,8:18.15418%,9:17.57619%,15:0.00273%,22:0.00119%,24:0.00034%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99761%,0:0.00239%]
[INFO] ** i/f_name:[2:99.99727%,3:0.00273%]
[INFO] ** modbus_function_code:[0.02961:99.99676%,-33.760870000000004:0.00324%]
[INFO] ** modbus_function_description:[7:49.99966%,11:49.9971%,0:0.00324%]
[INFO] ** modbus_transaction_id:65536 (11.16719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99676%,1:0.00273%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.11595%,20:26.14959%,13:18.15435%,6:17.5767%,17:0.00273%,14:0.00051%,16:0.00017%]
[INFO] ** s_port:[1.45442:26.14874%,-0.32151:20.83659%,-1.27613:18.15384%,-0.23351:17.57602%,-0.33484:17.27936%,-71.33197:0.00273%,1.45709:0.00051%,-0.24151:0.00051%,-1.27347:0.00034%,13.431270000000001:0.00017%,-1.2708:0.00017%,-1.02014:0.00017%,-71.14798:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:26.14823%,1:20.83641%,5:18.15384%,4:17.57568%,2:17.27919%,0:0.00665%]
[INFO] ** service:[0.0048200000000000005:99.99676%,-211.73542999999998:0.00273%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.11595%,9:26.14959%,7:18.15435%,1:17.5767%,14:0.00273%,2:0.00051%,15:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1604 (0.27332%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.3244 - tp: 63506.0000 - fp: 16494.0000 - tn: 303506.0000 - fn: 16494.0000 - accuracy: 0.9175 - precision: 0.7938 - recall: 0.7938 - auc: 0.8704 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.3077 - tp: 73516.0000 - fp: 6484.0000 - tn: 313516.0000 - fn: 6484.0000 - accuracy: 0.9676 - precision: 0.9190 - recall: 0.9190 - auc: 0.9490 - val_loss: 2.9561 - val_tp: 16332.0000 - val_fp: 3668.0000 - val_tn: 76332.0000 - val_fn: 3668.0000 - val_accuracy: 0.9266 - val_precision: 0.8166 - val_recall: 0.8166 - val_auc: 0.8854
[INFO] saving weights to checkpoints/lstm-epoch-7-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9462 - tp: 65382.0000 - fp: 14618.0000 - tn: 305382.0000 - fn: 14618.0000 - accuracy: 0.9269 - precision: 0.8173 - recall: 0.8173 - auc: 0.8851 - val_loss: 2.9585 - val_tp: 16329.0000 - val_fp: 3671.0000 - val_tn: 76329.0000 - val_fn: 3671.0000 - val_accuracy: 0.9266 - val_precision: 0.8164 - val_recall: 0.8164 - val_auc: 0.8853
[INFO] saving weights to checkpoints/lstm-epoch-7-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.5271 - tp: 67462.0000 - fp: 12538.0000 - tn: 307462.0000 - fn: 12538.0000 - accuracy: 0.9373 - precision: 0.8433 - recall: 0.8433 - auc: 0.9014 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.6350e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/586862
[33m[INFO] loading file 21-21/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (586860, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (586860, 17)

[INFO] analyzing data
[INFO] 586860 rows
[INFO] ** appi_name:[21:99.99625%,30:0.00102%,7:0.00051%,26:0.00034%,22:0.00034%,0:0.00034%,31:0.00017%,27:0.00017%,24:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:98.96006%,Multi Stage Single Point:1.03994%]
[INFO] ** dst:[21:43.32686%,10:20.97638%,8:18.16055%,9:17.53161%,15:0.00102%,22:0.00085%,24:0.00068%,6:0.00068%,25:0.00034%,16:0.00034%,2:0.00034%,18:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.99898%,0:0.00102%]
[INFO] ** i/f_name:[2:99.99898%,3:0.00102%]
[INFO] ** modbus_function_code:[0.02961:99.99625%,-33.760870000000004:0.00358%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99915%,11:49.9971%,0:0.00358%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.16723%)
[INFO] ** orig:[0:99.99932%,2:0.00068%]
[INFO] ** proto:[0:99.99761%,2:0.00136%,1:0.00102%]
[INFO] ** proxy_src_ip:[18:38.30624%,20:25.99683%,13:18.16123%,6:17.53144%,17:0.00102%,10:0.00102%,11:0.00085%,16:0.00051%,1:0.00034%,21:0.00017%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.99615%,-0.32151:20.9757%,-1.27613:18.16038%,-0.23351:17.53127%,-0.33484:17.33054%,-71.33197:0.00102%,-1.27347:0.00068%,-6.64392:0.00068%,-1.02014:0.00051%,-64.19493:0.00034%,-71.14931:0.00034%,-71.14798:0.00034%,1.47576:0.00034%,1.46509:0.00017%,-1.2708:0.00017%,6.62488:0.00017%,10.15141:0.00017%,-68.79874000000001:0.00017%,7.060860000000001:0.00017%,-3.3787199999999995:0.00017%,-2.2440900000000004:0.00017%,1.45709:0.00017%,-0.24151:0.00017%]
[INFO] ** scada_tag:[3:25.99564%,1:20.97553%,5:18.16021%,4:17.53093%,2:17.33054%,0:0.00716%]
[INFO] ** service:[0.0048200000000000005:99.99693%,-211.73542999999998:0.00102%,-211.09762999999998:0.00051%,-211.08346:0.00034%,-186.44547:0.00034%,-211.08818:0.00034%,-211.35747999999998:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.30624%,9:25.99683%,7:18.16123%,1:17.53144%,11:0.00102%,21:0.00085%,10:0.00085%,15:0.00051%,14:0.00034%,3:0.00034%,4:0.00017%,2:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1599 (0.27247%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/586860
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.7483e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/586860
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 3s - loss: 7.4989e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/586860
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.5380e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/586860
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7734e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/586860
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.0595e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/586860
[33m[INFO] loading file 22-22/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (355901, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (355901, 17)

[INFO] analyzing data
[INFO] 355901 rows
[INFO] ** appi_name:[21:99.99269%,30:0.00646%,23:0.00028%,22:0.00028%,18:0.00028%]
[INFO] ** classification:[normal:62.75593%,Multi Stage Single Point:37.24407%]
[INFO] ** dst:[21:43.31851%,10:21.00612%,8:18.09717%,9:17.56977%,15:0.00646%,22:0.00112%,19:0.00056%,26:0.00028%]
[INFO] ** i/f_dir:[1:99.99382%,0:0.00618%]
[INFO] ** i/f_name:[2:99.99354%,3:0.00618%,0:0.00028%]
[INFO] ** modbus_function_code:[0.02961:99.99269%,-33.760870000000004:0.00731%]
[INFO] ** modbus_function_description:[7:49.99705%,11:49.99564%,0:0.00731%]
[INFO] ** modbus_transaction_id:65534 (18.41355%)
[INFO] ** orig:[0:99.99494%,2:0.0045%,1:0.00056%]
[INFO] ** proto:[0:99.99326%,1:0.00646%,2:0.00028%]
[INFO] ** proxy_src_ip:[18:38.33313%,20:25.99234%,13:18.09661%,6:17.57062%,17:0.00646%,14:0.00056%,10:0.00028%]
[INFO] ** s_port:[1.45442:25.9915%,-0.32151:21.00612%,-1.27613:18.09661%,-0.23351:17.56977%,-0.33484:17.32701%,-71.33197:0.00646%,1.45709:0.00056%,-0.24151:0.00056%,7.228860000000001:0.00056%,-0.24950999999999998:0.00028%,1.46509:0.00028%,-71.14931:0.00028%]
[INFO] ** scada_tag:[3:25.99122%,1:21.00612%,5:18.09661%,4:17.56949%,2:17.32701%,0:0.00955%]
[INFO] ** service:[0.0048200000000000005:99.99269%,-211.73542999999998:0.00646%,-211.07873999999998:0.00056%,-211.08818:0.00028%]
[INFO] ** src:[22:38.33313%,9:25.99234%,7:18.09661%,1:17.57062%,21:0.0045%,14:0.00197%,2:0.00056%,11:0.00028%]
[INFO] ** type:[0:99.99831%,1:0.00169%]
[INFO] ** unixtime:983 (0.2762%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/355901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5821 - tp: 77113.0000 - fp: 2887.0000 - tn: 317113.0000 - fn: 2887.0000 - accuracy: 0.9856 - precision: 0.9639 - recall: 0.9639 - auc: 0.9773 - val_loss: 7.5513 - val_tp: 10630.0000 - val_fp: 9370.0000 - val_tn: 70630.0000 - val_fn: 9370.0000 - val_accuracy: 0.8126 - val_precision: 0.5315 - val_recall: 0.5315 - val_auc: 0.7072
[INFO] saving weights to checkpoints/lstm-epoch-7-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/355901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5663 - tp: 42447.0000 - fp: 37553.0000 - tn: 282447.0000 - fn: 37553.0000 - accuracy: 0.8122 - precision: 0.5306 - recall: 0.5306 - auc: 0.7048 - val_loss: 7.5666 - val_tp: 10611.0000 - val_fp: 9389.0000 - val_tn: 70611.0000 - val_fn: 9389.0000 - val_accuracy: 0.8122 - val_precision: 0.5306 - val_recall: 0.5306 - val_auc: 0.7066
[INFO] saving weights to checkpoints/lstm-epoch-7-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/355901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5999 - tp: 42280.0000 - fp: 37720.0000 - tn: 282280.0000 - fn: 37720.0000 - accuracy: 0.8114 - precision: 0.5285 - recall: 0.5285 - auc: 0.7034 - val_loss: 7.5634 - val_tp: 10615.0000 - val_fp: 9385.0000 - val_tn: 70615.0000 - val_fn: 9385.0000 - val_accuracy: 0.8123 - val_precision: 0.5307 - val_recall: 0.5307 - val_auc: 0.7067
[INFO] saving weights to checkpoints/lstm-epoch-7-files-21-22-batch-200000-300000
[INFO] processing batch 300000-400000/355901
[33m[INFO] loading file 23-23/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555901, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555901, 17)

[INFO] analyzing data
[INFO] 555901 rows
[INFO] ** appi_name:[21:99.99874%,30:0.00054%,31:0.00036%,33:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:93.65301%,Multi Stage Single Point:6.34699%]
[INFO] ** dst:[21:43.32714%,10:21.00032%,8:18.14028%,9:17.52974%,22:0.00108%,15:0.00054%,24:0.00036%,18:0.00036%,25:0.00018%]
[INFO] ** i/f_dir:[1:99.99946%,0:0.00054%]
[INFO] ** i/f_name:[2:99.99946%,3:0.00054%]
[INFO] ** modbus_function_code:[0.02961:99.99874%,-33.760870000000004:0.00126%]
[INFO] ** modbus_function_description:[7:50.00027%,11:49.99847%,0:0.00126%]
[INFO] ** modbus_transaction_id:65536 (11.78915%)
[INFO] ** orig:[0:99.99964%,2:0.00036%]
[INFO] ** proto:[0:99.99892%,2:0.00054%,1:0.00054%]
[INFO] ** proxy_src_ip:[18:38.34028%,20:25.98754%,13:18.14046%,6:17.52992%,17:0.00054%,16:0.00054%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.98682%,-0.32151:21.00014%,-1.27613:18.13992%,-0.23351:17.52956%,-0.33484:17.34014%,-71.33197:0.00054%,-1.02014:0.00054%,-0.08551:0.00036%,-1.27347:0.00036%,1.45709:0.00036%,-0.24151:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,1.46509:0.00018%,-64.19493:0.00018%,-0.24950999999999998:0.00018%,-49.275529999999996:0.00018%]
[INFO] ** scada_tag:[3:25.98646%,1:21.00014%,5:18.13974%,4:17.52938%,2:17.33996%,0:0.00432%]
[INFO] ** service:[0.0048200000000000005:99.99892%,-211.73542999999998:0.00054%,-186.43601999999998:0.00036%,-186.44547:0.00018%]
[INFO] ** src:[22:38.34028%,9:25.98754%,7:18.14046%,1:17.52992%,15:0.00054%,21:0.00036%,17:0.00018%,14:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1513 (0.27217%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.1089 - tp: 44717.0000 - fp: 35283.0000 - tn: 284717.0000 - fn: 35283.0000 - accuracy: 0.8236 - precision: 0.5590 - recall: 0.5590 - auc: 0.7227 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.1767e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.7572e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.4284e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1950e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.1309e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/555901
[33m[INFO] loading file 24-24/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555901, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555901, 17)

[INFO] analyzing data
[INFO] 555901 rows
[INFO] ** appi_name:[21:99.99334%,30:0.00324%,26:0.00054%,31:0.00036%,27:0.00036%,22:0.00036%,0:0.00036%,24:0.00018%,23:0.00018%,19:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,11:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:95.41645%,Multi Stage Single Point:4.58355%]
[INFO] ** dst:[21:43.36617%,10:21.01903%,8:18.10124%,9:17.50653%,15:0.00324%,22:0.00108%,6:0.00072%,25:0.00036%,24:0.00036%,19:0.00036%,18:0.00036%,7:0.00036%,26:0.00018%]
[INFO] ** i/f_dir:[1:99.99694%,0:0.00306%]
[INFO] ** i/f_name:[2:99.99676%,3:0.00324%]
[INFO] ** modbus_function_code:[0.02961:99.99334%,-33.760870000000004:0.00612%,-0.415:0.00018%,0.9188299999999999:0.00018%,0.47422:0.00018%]
[INFO] ** modbus_function_description:[7:49.99775%,11:49.99559%,0:0.00612%,15:0.00018%,10:0.00018%,2:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.78915%)
[INFO] ** orig:[0:99.99964%,1:0.00036%]
[INFO] ** proto:[0:99.99478%,1:0.00324%,2:0.00198%]
[INFO] ** proxy_src_ip:[18:38.39874%,20:25.98718%,13:18.10106%,6:17.50599%,17:0.00324%,10:0.00126%,14:0.0009%,11:0.0009%,21:0.00036%,16:0.00036%]
[INFO] ** s_port:[1.45442:25.98646%,-0.32151:21.01903%,-1.27613:18.1007%,-0.23351:17.50528%,-0.33484:17.37971%,-71.33197:0.00324%,-9.58113:0.00072%,-71.14798:0.00054%,-0.24950999999999998:0.00036%,-1.27347:0.00036%,1.45709:0.00036%,-0.24151:0.00036%,-1.02014:0.00036%,-31.55091:0.00036%,7.6315100000000005:0.00036%,-71.14931:0.00036%,-64.19493:0.00036%,-68.79874000000001:0.00018%,1.46509:0.00018%,7.4901800000000005:0.00018%,13.431270000000001:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:25.98628%,1:21.01903%,5:18.10053%,4:17.50492%,2:17.37953%,0:0.00971%]
[INFO] ** service:[0.0048200000000000005:99.99442%,-211.73542999999998:0.00324%,-211.08346:0.00054%,-211.07873999999998:0.00036%,-202.75898:0.00036%,-186.44547:0.00036%,-186.43601999999998:0.00036%,-211.08818:0.00036%]
[INFO] ** src:[22:38.39874%,9:25.98718%,7:18.10106%,1:17.50599%,14:0.00324%,11:0.00126%,10:0.0009%,2:0.0009%,15:0.00036%,4:0.00036%]
[INFO] ** type:[0:99.99874%,1:0.0009%,2:0.00036%]
[INFO] ** unixtime:1510 (0.27163%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.8130e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.5708e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.4145e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2201e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0666e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5558 - val_tp: 14347.0000 - val_fp: 5653.0000 - val_tn: 74347.0000 - val_fn: 5653.0000 - val_accuracy: 0.8869 - val_precision: 0.7174 - val_recall: 0.7174 - val_auc: 0.8233
[INFO] saving weights to checkpoints/lstm-epoch-7-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/555901
[33m[INFO] loading file 25-25/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555901, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555901, 17)

[INFO] analyzing data
[INFO] 555901 rows
[INFO] ** appi_name:[21:99.9964%,30:0.00108%,17:0.00072%,22:0.00054%,31:0.00036%,28:0.00018%,26:0.00018%,12:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** classification:[normal:64.35408%,Multi Stage Single Point:35.64592%]
[INFO] ** dst:[21:43.32444%,10:21.02533%,8:18.13326%,9:17.51265%,15:0.00108%,22:0.0009%,16:0.00072%,6:0.00072%,18:0.00036%,17:0.00036%,24:0.00018%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.9964%,-33.760870000000004:0.0036%]
[INFO] ** modbus_function_description:[7:49.99901%,11:49.99739%,0:0.0036%]
[INFO] ** modbus_transaction_id:65536 (11.78915%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99784%,2:0.00108%,1:0.00108%]
[INFO] ** proxy_src_ip:[18:38.39047%,20:25.95912%,13:18.13326%,6:17.51319%,17:0.00108%,1:0.0009%,21:0.00072%,16:0.00036%,14:0.00036%,7:0.00036%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95876%,-0.32151:21.02497%,-1.27613:18.1329%,-0.23351:17.51265%,-0.33484:17.3655%,-71.33197:0.00108%,-71.14931:0.00054%,-0.24151:0.00036%,-1.02014:0.00036%,-49.275529999999996:0.00036%,1.46509:0.00018%,-5.1466400000000005:0.00018%,-1.27347:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,-0.24950999999999998:0.00018%,2.52505:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,6.1115699999999995:0.00018%,-5.08665:0.00018%,1.45709:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:25.9584%,1:21.02479%,5:18.13273%,4:17.51247%,2:17.36532%,0:0.0063%]
[INFO] ** service:[0.0048200000000000005:99.99676%,-211.73542999999998:0.00108%,-205.44247:0.00072%,-211.08818:0.00054%,-186.43601999999998:0.00036%,-211.09762999999998:0.00018%,-211.08346:0.00018%,-185.9872:0.00018%]
[INFO] ** src:[22:38.39047%,9:25.95912%,7:18.13326%,1:17.51319%,14:0.00108%,3:0.0009%,4:0.00072%,21:0.00036%,15:0.00036%,2:0.00036%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1510 (0.27163%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7313 - tp: 51554.0000 - fp: 28446.0000 - tn: 291554.0000 - fn: 28446.0000 - accuracy: 0.8578 - precision: 0.6444 - recall: 0.6444 - auc: 0.7778 - val_loss: 5.7566 - val_tp: 12857.0000 - val_fp: 7143.0000 - val_tn: 72857.0000 - val_fn: 7143.0000 - val_accuracy: 0.8571 - val_precision: 0.6428 - val_recall: 0.6428 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-7-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7526 - tp: 51448.0000 - fp: 28552.0000 - tn: 291448.0000 - fn: 28552.0000 - accuracy: 0.8572 - precision: 0.6431 - recall: 0.6431 - auc: 0.7769 - val_loss: 5.7380 - val_tp: 12880.0000 - val_fp: 7120.0000 - val_tn: 72880.0000 - val_fn: 7120.0000 - val_accuracy: 0.8576 - val_precision: 0.6440 - val_recall: 0.6440 - val_auc: 0.7775
[INFO] saving weights to checkpoints/lstm-epoch-7-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7449 - tp: 51486.0000 - fp: 28514.0000 - tn: 291486.0000 - fn: 28514.0000 - accuracy: 0.8574 - precision: 0.6436 - recall: 0.6436 - auc: 0.7772 - val_loss: 5.7477 - val_tp: 12868.0000 - val_fp: 7132.0000 - val_tn: 72868.0000 - val_fn: 7132.0000 - val_accuracy: 0.8574 - val_precision: 0.6434 - val_recall: 0.6434 - val_auc: 0.7771
[INFO] saving weights to checkpoints/lstm-epoch-7-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7423 - tp: 51499.0000 - fp: 28501.0000 - tn: 291499.0000 - fn: 28501.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.7773 - val_loss: 5.7598 - val_tp: 12853.0000 - val_fp: 7147.0000 - val_tn: 72853.0000 - val_fn: 7147.0000 - val_accuracy: 0.8571 - val_precision: 0.6427 - val_recall: 0.6427 - val_auc: 0.7767
[INFO] saving weights to checkpoints/lstm-epoch-7-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7570 - tp: 51426.0000 - fp: 28574.0000 - tn: 291426.0000 - fn: 28574.0000 - accuracy: 0.8571 - precision: 0.6428 - recall: 0.6428 - auc: 0.7768 - val_loss: 5.7139 - val_tp: 12910.0000 - val_fp: 7090.0000 - val_tn: 72910.0000 - val_fn: 7090.0000 - val_accuracy: 0.8582 - val_precision: 0.6455 - val_recall: 0.6455 - val_auc: 0.7784
[INFO] saving weights to checkpoints/lstm-epoch-7-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/555901
[33m[INFO] loading file 26-26/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555901, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555901, 17)

[INFO] analyzing data
[INFO] 555901 rows
[INFO] ** appi_name:[21:99.99856%,7:0.00054%,31:0.00018%,30:0.00018%,22:0.00018%,12:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:64.3951%,Single Stage Single Point:28.7303%,Multi Stage Single Point:6.87461%]
[INFO] ** dst:[21:43.31023%,10:21.08289%,8:18.12337%,9:17.48117%,22:0.00072%,24:0.00036%,16:0.00036%,2:0.00036%,18:0.00018%,15:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99982%,0:0.00018%]
[INFO] ** i/f_name:[2:99.99982%,3:0.00018%]
[INFO] ** modbus_function_code:[0.02961:99.99856%,-33.760870000000004:0.00144%]
[INFO] ** modbus_function_description:[7:49.99991%,11:49.99865%,0:0.00144%]
[INFO] ** modbus_transaction_id:65536 (11.78915%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99946%,2:0.00036%,1:0.00018%]
[INFO] ** proxy_src_ip:[18:38.46314%,20:25.93016%,13:18.12373%,6:17.48117%,1:0.00054%,21:0.00036%,16:0.00036%,17:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.92962%,-0.32151:21.08271%,-1.27613:18.12319%,-0.23351:17.48099%,-0.33484:17.38043%,-1.27347:0.00036%,-1.02014:0.00036%,7.66617:0.00018%,-71.14931:0.00018%,11.57001:0.00018%,-3.3787199999999995:0.00018%,2.52505:0.00018%,-0.24151:0.00018%,-1.2708:0.00018%,1.45709:0.00018%,-49.275529999999996:0.00018%,1.47576:0.00018%,1.46509:0.00018%,14.191239999999999:0.00018%,-71.33197:0.00018%]
[INFO] ** scada_tag:[3:25.92926%,1:21.08271%,5:18.12319%,4:17.48081%,2:17.38043%,0:0.0036%]
[INFO] ** service:[0.0048200000000000005:99.99874%,-211.09762999999998:0.00054%,-211.35747999999998:0.00018%,-211.73542999999998:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.46314%,9:25.93016%,7:18.12373%,1:17.48117%,3:0.00054%,15:0.00036%,4:0.00036%,21:0.00018%,14:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1509 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7431 - tp: 51495.0000 - fp: 28505.0000 - tn: 291495.0000 - fn: 28505.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.7773 - val_loss: 5.7380 - val_tp: 12880.0000 - val_fp: 7120.0000 - val_tn: 72880.0000 - val_fn: 7120.0000 - val_accuracy: 0.8576 - val_precision: 0.6440 - val_recall: 0.6440 - val_auc: 0.7775
[INFO] saving weights to checkpoints/lstm-epoch-7-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.2271 - tp: 53172.0000 - fp: 26828.0000 - tn: 293172.0000 - fn: 26828.0000 - accuracy: 0.8659 - precision: 0.6647 - recall: 0.6647 - auc: 0.8553 - val_loss: 0.5352 - val_tp: 13280.0000 - val_fp: 6720.0000 - val_tn: 73280.0000 - val_fn: 6720.0000 - val_accuracy: 0.8656 - val_precision: 0.6640 - val_recall: 0.6640 - val_auc: 0.9626
[INFO] saving weights to checkpoints/lstm-epoch-7-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1711 - tp: 76401.0000 - fp: 3599.0000 - tn: 316401.0000 - fn: 3599.0000 - accuracy: 0.9820 - precision: 0.9550 - recall: 0.9550 - auc: 0.9930 - val_loss: 0.0120 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0649 - tp: 79063.0000 - fp: 937.0000 - tn: 319063.0000 - fn: 937.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9970 - val_loss: 0.0103 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0594 - tp: 79127.0000 - fp: 873.0000 - tn: 319127.0000 - fn: 873.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9973 - val_loss: 0.0095 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/555901
[33m[INFO] loading file 27-27/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (496031, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (496031, 17)

[INFO] analyzing data
[INFO] 496031 rows
[INFO] ** appi_name:[21:99.9994%,30:0.0006%]
[INFO] ** classification:[normal:64.35122%,Single Stage Single Point:35.64878%]
[INFO] ** dst:[21:43.28056%,10:21.06884%,8:18.1789%,9:17.47008%,22:0.00081%,15:0.0006%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.9998%,0:0.0002%]
[INFO] ** i/f_name:[2:99.9994%,3:0.0006%]
[INFO] ** modbus_function_code:[0.02961:99.9994%,-33.760870000000004:0.0006%]
[INFO] ** modbus_function_description:[7:50.0003%,11:49.99909%,0:0.0006%]
[INFO] ** modbus_transaction_id:65536 (13.21208%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9994%,1:0.0006%]
[INFO] ** proxy_src_ip:[18:38.42199%,20:25.92802%,13:18.1787%,6:17.47028%,17:0.0006%,16:0.0004%]
[INFO] ** s_port:[1.45442:25.92741%,-0.32151:21.06884%,-1.27613:18.1785%,-0.23351:17.46988%,-0.33484:17.35315%,-71.33197:0.0006%,-1.02014:0.0004%,-1.27347:0.0002%,1.45709:0.0002%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-0.24151:0.0002%]
[INFO] ** scada_tag:[3:25.92701%,1:21.06864%,5:18.1783%,4:17.46967%,2:17.35295%,0:0.00343%]
[INFO] ** service:[0.0048200000000000005:99.9994%,-211.73542999999998:0.0006%]
[INFO] ** src:[22:38.42199%,9:25.92802%,7:18.1787%,1:17.47028%,14:0.0006%,15:0.0004%]
[INFO] ** type:[0:99.9996%,1:0.0004%]
[INFO] ** unixtime:1347 (0.27156%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/496031
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0609 - tp: 79124.0000 - fp: 876.0000 - tn: 319124.0000 - fn: 876.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9974 - val_loss: 0.0089 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/496031
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0585 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9977 - val_loss: 0.0095 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/496031
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0607 - tp: 79073.0000 - fp: 927.0000 - tn: 319073.0000 - fn: 927.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9977 - val_loss: 0.0086 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/496031
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0584 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9980 - val_loss: 0.0086 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/496031
[33m[INFO] loading file 28-28/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (429947, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (429947, 17)

[INFO] analyzing data
[INFO] 429947 rows
[INFO] ** appi_name:[21:99.99302%,30:0.00163%,17:0.00116%,22:0.00093%,7:0.00093%,31:0.0007%,26:0.0007%,28:0.00023%,27:0.00023%,8:0.00023%,0:0.00023%]
[INFO] ** classification:[normal:64.32304%,Single Stage Single Point:35.67696%]
[INFO] ** dst:[21:43.28231%,10:21.03352%,8:18.19922%,9:17.4775%,6:0.00186%,16:0.00163%,18:0.00116%,15:0.0007%,22:0.00047%,17:0.00047%,2:0.00047%,25:0.00023%,7:0.00023%,0:0.00023%]
[INFO] ** i/f_dir:[1:99.9993%,0:0.0007%]
[INFO] ** i/f_name:[2:99.9993%,3:0.0007%]
[INFO] ** modbus_function_code:[0.02961:99.99302%,-33.760870000000004:0.00698%]
[INFO] ** modbus_function_description:[11:49.99663%,7:49.99639%,0:0.00698%]
[INFO] ** modbus_transaction_id:65536 (15.24281%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99581%,2:0.00349%,1:0.0007%]
[INFO] ** proxy_src_ip:[18:38.35333%,20:25.9625%,13:18.19945%,6:17.47774%,1:0.00186%,17:0.00163%,14:0.0014%,7:0.00116%,21:0.0007%,0:0.00023%]
[INFO] ** s_port:[1.45442:25.96227%,-0.32151:21.03352%,-1.27613:18.19922%,-0.23351:17.47727%,-0.33484:17.31981%,-71.14798:0.00093%,-71.14931:0.00093%,-71.33197:0.0007%,-0.08551:0.00047%,-0.24151:0.00047%,7.66617:0.00023%,-58.035180000000004:0.00023%,-1.2708:0.00023%,-64.19493:0.00023%,-5.1466400000000005:0.00023%,13.431270000000001:0.00023%,11.57001:0.00023%,14.4699:0.00023%,1.47576:0.00023%,14.191239999999999:0.00023%,-5.08665:0.00023%,10.192739999999999:0.00023%,-3.3787199999999995:0.00023%,6.1115699999999995:0.00023%,2.05573:0.00023%,-43.76509:0.00023%,2.52505:0.00023%,11.862:0.00023%,-58.032509999999995:0.00023%]
[INFO] ** scada_tag:[3:25.96204%,1:21.03329%,5:18.19922%,4:17.47681%,2:17.31981%,0:0.00884%]
[INFO] ** service:[0.0048200000000000005:99.99302%,-205.44247:0.00116%,-186.43601999999998:0.00116%,-211.09762999999998:0.00093%,-211.08346:0.00093%,-211.08818:0.00093%,-211.73542999999998:0.0007%,-186.44547:0.00023%,-183.8612:0.00023%,-185.9872:0.00023%,-211.35747999999998:0.00023%,-202.75898:0.00023%]
[INFO] ** src:[22:38.35333%,9:25.9625%,7:18.19945%,1:17.47774%,3:0.00209%,2:0.0014%,21:0.00116%,4:0.00093%,14:0.0007%,8:0.00047%,17:0.00023%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1168 (0.27166%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/429947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0577 - tp: 79116.0000 - fp: 884.0000 - tn: 319116.0000 - fn: 884.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9981 - val_loss: 0.0086 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/429947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0573 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9982 - val_loss: 0.0099 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-7-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/429947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0588 - tp: 79091.0000 - fp: 909.0000 - tn: 319091.0000 - fn: 909.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9981 - val_loss: 0.0104 - val_tp: 19997.0000 - val_fp: 3.0000 - val_tn: 79997.0000 - val_fn: 3.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-7-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/429947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0580 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9981 - val_loss: 0.0099 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-27-28-batch-300000-400000
[INFO] processing batch 400000-500000/429947
[33m[INFO] loading file 29-29/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529947, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529947, 17)

[INFO] analyzing data
[INFO] 529947 rows
[INFO] ** appi_name:[21:99.99887%,30:0.00057%,26:0.00019%,9:0.00019%,3:0.00019%]
[INFO] ** classification:[normal:64.38851%,Single Stage Single Point:35.61149%]
[INFO] ** dst:[21:43.32509%,10:21.06211%,8:18.14748%,9:17.46363%,22:0.00057%,15:0.00057%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99887%,-33.760870000000004:0.00113%]
[INFO] ** modbus_function_description:[7:49.99991%,11:49.99896%,0:0.00113%]
[INFO] ** modbus_transaction_id:65536 (12.36652%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99925%,1:0.00057%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.43988%,20:25.9475%,13:18.14785%,6:17.46344%,17:0.00057%,21:0.00019%,16:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.94693%,-0.32151:21.06192%,-1.27613:18.14748%,-0.23351:17.46344%,-0.33484:17.37796%,-71.33197:0.00057%,1.45709:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,-61.95768:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,14.4699:0.00019%]
[INFO] ** scada_tag:[3:25.94656%,1:21.06173%,5:18.14748%,4:17.46307%,2:17.37796%,0:0.00321%]
[INFO] ** service:[0.0048200000000000005:99.99906%,-211.73542999999998:0.00057%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.43988%,9:25.9475%,7:18.14785%,1:17.46344%,14:0.00057%,15:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1439 (0.27154%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0575 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9981 - val_loss: 0.0095 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0566 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9981 - val_loss: 0.0098 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0570 - tp: 79109.0000 - fp: 891.0000 - tn: 319109.0000 - fn: 891.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9976 - val_loss: 0.0098 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0569 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9974 - val_loss: 0.0101 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0594 - tp: 79059.0000 - fp: 941.0000 - tn: 319059.0000 - fn: 941.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9981 - val_loss: 0.0106 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/529947
[33m[INFO] loading file 30-30/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529947, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529947, 17)

[INFO] analyzing data
[INFO] 529947 rows
[INFO] ** appi_name:[21:99.99755%,30:0.0017%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.36719%,Single Stage Single Point:35.63281%]
[INFO] ** dst:[21:43.33773%,10:21.02644%,8:18.14615%,9:17.48628%,15:0.0017%,22:0.00075%,24:0.00038%,25:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.9983%,0:0.0017%]
[INFO] ** i/f_name:[2:99.9983%,3:0.0017%]
[INFO] ** modbus_function_code:[0.02961:99.99755%,-33.760870000000004:0.00245%]
[INFO] ** modbus_function_description:[7:49.99972%,11:49.99783%,0:0.00245%]
[INFO] ** modbus_transaction_id:65536 (12.36652%)
[INFO] ** orig:[0:99.99906%,2:0.00057%,1:0.00038%]
[INFO] ** proto:[0:99.99792%,1:0.0017%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:38.36874%,20:25.99524%,13:18.14653%,6:17.48684%,17:0.0017%,7:0.00038%,16:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.99505%,-0.32151:21.02625%,-1.27613:18.14597%,-0.23351:17.48609%,-0.33484:17.34249%,-71.33197:0.0017%,-0.24151:0.00057%,-1.27347:0.00038%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-61.95768:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,10.192739999999999:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:25.99467%,1:21.02625%,5:18.14578%,4:17.4859%,2:17.3423%,0:0.00509%]
[INFO] ** service:[0.0048200000000000005:99.99774%,-211.73542999999998:0.0017%,-211.08346:0.00019%,-205.44247:0.00019%,-186.44547:0.00019%]
[INFO] ** src:[22:38.36874%,9:25.99524%,7:18.14653%,1:17.48684%,14:0.00113%,21:0.00094%,16:0.00019%,15:0.00019%,8:0.00019%]
[INFO] ** type:[0:99.99925%,1:0.00075%]
[INFO] ** unixtime:1441 (0.27191%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0587 - tp: 79069.0000 - fp: 931.0000 - tn: 319069.0000 - fn: 931.0000 - accuracy: 0.9953 - precision: 0.9884 - recall: 0.9884 - auc: 0.9981 - val_loss: 0.0115 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0575 - tp: 79094.0000 - fp: 906.0000 - tn: 319094.0000 - fn: 906.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9981 - val_loss: 0.0108 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0570 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9982 - val_loss: 0.0111 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0570 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9982 - val_loss: 0.0109 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0590 - tp: 79054.0000 - fp: 946.0000 - tn: 319054.0000 - fn: 946.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9982 - val_loss: 0.0111 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/529947
[33m[INFO] loading file 31-31/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529947, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529947, 17)

[INFO] analyzing data
[INFO] 529947 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.37814%,Single Stage Single Point:35.62186%]
[INFO] ** dst:[21:43.32452%,10:21.05248%,8:18.12408%,9:17.4976%,22:0.00094%,24:0.00038%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.00009%,11:49.99991%]
[INFO] ** modbus_transaction_id:65536 (12.36652%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.3995%,20:25.97826%,13:18.12427%,6:17.4976%,16:0.00038%]
[INFO] ** s_port:[1.45442:25.9775%,-0.32151:21.05248%,-1.27613:18.12389%,-0.23351:17.49741%,-0.33484:17.34702%,-1.27347:0.00038%,1.45709:0.00038%,-1.02014:0.00038%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.97713%,1:21.05229%,5:18.1237%,4:17.49722%,2:17.34683%,0:0.00283%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.3995%,9:25.97826%,7:18.12427%,1:17.4976%,15:0.00038%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1440 (0.27173%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0571 - tp: 79088.0000 - fp: 912.0000 - tn: 319088.0000 - fn: 912.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9982 - val_loss: 0.0107 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0549 - tp: 79129.0000 - fp: 871.0000 - tn: 319129.0000 - fn: 871.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9983 - val_loss: 0.0106 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0546 - tp: 79136.0000 - fp: 864.0000 - tn: 319136.0000 - fn: 864.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9983 - val_loss: 0.0104 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0554 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9983 - val_loss: 0.0104 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0563 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9982 - val_loss: 0.0106 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/529947
[33m[INFO] loading file 32-32/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529947, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529947, 17)

[INFO] analyzing data
[INFO] 529947 rows
[INFO] ** appi_name:[21:99.99623%,30:0.00321%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.37172%,Single Stage Single Point:35.62828%]
[INFO] ** dst:[21:43.3198%,10:21.04701%,8:18.16634%,9:17.46193%,15:0.00321%,22:0.00094%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99717%,0:0.00283%]
[INFO] ** i/f_name:[2:99.99679%,3:0.00321%]
[INFO] ** modbus_function_code:[0.02961:99.99623%,-33.760870000000004:0.00377%]
[INFO] ** modbus_function_description:[7:49.99896%,11:49.99726%,0:0.00377%]
[INFO] ** modbus_transaction_id:65536 (12.36652%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99623%,1:0.00321%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.40724%,20:25.95995%,13:18.16634%,6:17.4625%,17:0.00321%,14:0.00057%,16:0.00019%]
[INFO] ** s_port:[1.45442:25.95939%,-0.32151:21.04701%,-1.27613:18.16597%,-0.23351:17.46175%,-0.33484:17.36023%,-71.33197:0.00321%,-0.24151:0.00057%,-1.2708:0.00019%,-1.02014:0.00019%,13.431270000000001:0.00019%,-71.14798:0.00019%,-1.27347:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,1.45709:0.00019%,11.862:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:25.95901%,1:21.04682%,5:18.16597%,4:17.46137%,2:17.36023%,0:0.0066%]
[INFO] ** service:[0.0048200000000000005:99.99623%,-211.73542999999998:0.00321%,-211.08346:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.40724%,9:25.95995%,7:18.16634%,1:17.4625%,14:0.00321%,2:0.00057%,15:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1438 (0.27135%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0559 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9983 - val_loss: 0.0122 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-7-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0568 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9982 - val_loss: 0.0106 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0555 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9983 - val_loss: 0.0105 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0590 - tp: 79050.0000 - fp: 950.0000 - tn: 319050.0000 - fn: 950.0000 - accuracy: 0.9953 - precision: 0.9881 - recall: 0.9881 - auc: 0.9981 - val_loss: 0.0108 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0578 - tp: 79072.0000 - fp: 928.0000 - tn: 319072.0000 - fn: 928.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9982 - val_loss: 0.0109 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/529947
[33m[INFO] loading file 33-33/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529947, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529947, 17)

[INFO] analyzing data
[INFO] 529947 rows
[INFO] ** appi_name:[21:99.99679%,30:0.00113%,17:0.00075%,22:0.00057%,31:0.00019%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.39852%,Single Stage Single Point:35.60148%]
[INFO] ** dst:[21:43.33698%,10:21.05663%,8:18.11106%,9:17.49043%,22:0.00132%,15:0.00113%,16:0.00075%,6:0.00075%,24:0.00038%,17:0.00038%,18:0.00019%]
[INFO] ** i/f_dir:[1:99.99887%,0:0.00113%]
[INFO] ** i/f_name:[2:99.99887%,3:0.00113%]
[INFO] ** modbus_function_code:[0.02961:99.99679%,-33.760870000000004:0.00321%]
[INFO] ** modbus_function_description:[7:49.99934%,11:49.99745%,0:0.00321%]
[INFO] ** modbus_transaction_id:65536 (12.36652%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99792%,1:0.00113%,2:0.00094%]
[INFO] ** proxy_src_ip:[18:38.42177%,20:25.9726%,13:18.11106%,6:17.49062%,17:0.00113%,16:0.00075%,1:0.00075%,21:0.00038%,14:0.00038%,7:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.97184%,-0.32151:21.05663%,-1.27613:18.11068%,-0.23351:17.49024%,-0.33484:17.36513%,-71.33197:0.00113%,-1.02014:0.00075%,-71.14931:0.00057%,1.45709:0.00038%,-1.27347:0.00038%,-5.08665:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-71.14798:0.00019%,-58.032509999999995:0.00019%,-58.035180000000004:0.00019%,-0.24151:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-5.1466400000000005:0.00019%]
[INFO] ** scada_tag:[3:25.97147%,1:21.05663%,5:18.11049%,4:17.49005%,2:17.36513%,0:0.00623%]
[INFO] ** service:[0.0048200000000000005:99.99679%,-211.73542999999998:0.00113%,-205.44247:0.00075%,-211.08818:0.00057%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.42177%,9:25.9726%,7:18.11106%,1:17.49062%,14:0.00113%,15:0.00075%,3:0.00075%,21:0.00038%,4:0.00038%,2:0.00038%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1441 (0.27191%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0558 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9983 - val_loss: 0.0106 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0560 - tp: 79106.0000 - fp: 894.0000 - tn: 319106.0000 - fn: 894.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9983 - val_loss: 0.0105 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0591 - tp: 79048.0000 - fp: 952.0000 - tn: 319048.0000 - fn: 952.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9981 - val_loss: 0.0109 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0535 - tp: 79158.0000 - fp: 842.0000 - tn: 319158.0000 - fn: 842.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9983 - val_loss: 0.0113 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-7-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0550 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9983 - val_loss: 0.0104 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/529947
[33m[INFO] loading file 34-34/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (371380, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (371380, 17)

[INFO] analyzing data
[INFO] 371380 rows
[INFO] ** appi_name:[21:99.99731%,30:0.00081%,7:0.00081%,31:0.00027%,22:0.00027%,8:0.00027%,6:0.00027%]
[INFO] ** classification:[normal:64.33464%,Single Stage Single Point:35.66536%]
[INFO] ** dst:[21:43.27212%,10:21.05929%,8:18.20561%,9:17.45974%,22:0.00081%,15:0.00081%,16:0.00054%,2:0.00054%,18:0.00027%,6:0.00027%]
[INFO] ** i/f_dir:[1:99.99919%,0:0.00081%]
[INFO] ** i/f_name:[2:99.99919%,3:0.00081%]
[INFO] ** modbus_function_code:[0.02961:99.99731%,-33.760870000000004:0.00269%]
[INFO] ** modbus_function_description:[7:49.99919%,11:49.99812%,0:0.00269%]
[INFO] ** modbus_transaction_id:65536 (17.64662%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99865%,1:0.00081%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.38683%,20:25.94459%,13:18.20561%,6:17.46028%,17:0.00081%,1:0.00081%,21:0.00054%,14:0.00027%,7:0.00027%]
[INFO] ** s_port:[1.45442:25.94432%,-0.32151:21.05902%,-1.27613:18.20561%,-0.23351:17.45948%,-0.33484:17.3278%,-0.24151:0.00081%,-71.33197:0.00081%,-3.0613900000000003:0.00027%,-3.3787199999999995:0.00027%,14.191239999999999:0.00027%,1.47576:0.00027%,11.57001:0.00027%,-49.275529999999996:0.00027%,-71.14931:0.00027%,7.66617:0.00027%]
[INFO] ** scada_tag:[3:25.94405%,1:21.05875%,5:18.20534%,4:17.45894%,2:17.3278%,0:0.00512%]
[INFO] ** service:[0.0048200000000000005:99.99758%,-211.09762999999998:0.00081%,-211.73542999999998:0.00081%,-186.43601999999998:0.00027%,-211.35747999999998:0.00027%,-211.08818:0.00027%]
[INFO] ** src:[22:38.38683%,9:25.94459%,7:18.20561%,1:17.46028%,14:0.00081%,3:0.00081%,4:0.00054%,21:0.00027%,2:0.00027%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1009 (0.27169%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/371380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0553 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9983 - val_loss: 0.0103 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/371380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0564 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9982 - val_loss: 0.0107 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/371380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0575 - tp: 79082.0000 - fp: 918.0000 - tn: 319082.0000 - fn: 918.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9982 - val_loss: 0.0115 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/371380
[33m[INFO] loading file 35-35/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571380, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571380, 17)

[INFO] analyzing data
[INFO] 571380 rows
[INFO] ** appi_name:[21:99.99895%,30:0.00105%]
[INFO] ** classification:[normal:64.3661%,Single Stage Single Point:35.6339%]
[INFO] ** dst:[21:43.32616%,10:21.03749%,8:18.15797%,9:17.47629%,22:0.00105%,15:0.00105%]
[INFO] ** i/f_dir:[1:99.99912%,0:0.00088%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.99895%,-33.760870000000004:0.00105%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99895%,0:0.00105%]
[INFO] ** modbus_transaction_id:65536 (11.46977%)
[INFO] ** orig:[0:99.99965%,1:0.00035%]
[INFO] ** proto:[0:99.99895%,1:0.00105%]
[INFO] ** proxy_src_ip:[18:38.39546%,20:25.96871%,13:18.15762%,6:17.47646%,17:0.00105%,16:0.0007%]
[INFO] ** s_port:[1.45442:25.96818%,-0.32151:21.03749%,-1.27613:18.15762%,-0.23351:17.47611%,-0.33484:17.35798%,-71.33197:0.00105%,-1.02014:0.0007%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.96783%,1:21.03749%,5:18.15744%,4:17.47576%,2:17.35798%,0:0.0035%]
[INFO] ** service:[0.0048200000000000005:99.99895%,-211.73542999999998:0.00105%]
[INFO] ** src:[22:38.39546%,9:25.96871%,7:18.15762%,1:17.47646%,14:0.00105%,15:0.0007%]
[INFO] ** type:[0:99.99912%,1:0.00088%]
[INFO] ** unixtime:1551 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0538 - tp: 79150.0000 - fp: 850.0000 - tn: 319150.0000 - fn: 850.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9984 - val_loss: 0.0111 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0549 - tp: 79129.0000 - fp: 871.0000 - tn: 319129.0000 - fn: 871.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9983 - val_loss: 0.0102 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0564 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9982 - val_loss: 0.0103 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0554 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9983 - val_loss: 0.0105 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0574 - tp: 79079.0000 - fp: 921.0000 - tn: 319079.0000 - fn: 921.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9982 - val_loss: 0.0106 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/571380
[33m[INFO] loading file 36-36/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571380, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571380, 17)

[INFO] analyzing data
[INFO] 571380 rows
[INFO] ** appi_name:[21:99.9986%,30:0.0007%,31:0.00035%,33:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.36277%,Single Stage Single Point:35.63723%]
[INFO] ** dst:[21:43.33106%,10:21.02944%,8:18.14939%,9:17.48766%,22:0.00088%,15:0.0007%,24:0.00035%,18:0.00035%,25:0.00018%]
[INFO] ** i/f_dir:[1:99.9993%,0:0.0007%]
[INFO] ** i/f_name:[2:99.9993%,3:0.0007%]
[INFO] ** modbus_function_code:[0.02961:99.9986%,-33.760870000000004:0.0014%]
[INFO] ** modbus_function_description:[7:50.00035%,11:49.99825%,0:0.0014%]
[INFO] ** modbus_transaction_id:65536 (11.46977%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99877%,1:0.0007%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.38024%,20:25.98043%,13:18.14957%,6:17.48819%,17:0.0007%,21:0.00018%,16:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.97991%,-0.32151:21.02926%,-1.27613:18.14904%,-0.23351:17.48749%,-0.33484:17.35097%,-71.33197:0.0007%,-0.24151:0.00053%,-0.08551:0.00035%,-1.27347:0.00035%,1.45709:0.00018%,1.47576:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,1.46509:0.00018%,-64.19493:0.00018%,-0.24950999999999998:0.00018%,-49.275529999999996:0.00018%]
[INFO] ** scada_tag:[3:25.97956%,1:21.02909%,5:18.14887%,4:17.48731%,2:17.3508%,0:0.00438%]
[INFO] ** service:[0.0048200000000000005:99.99877%,-211.73542999999998:0.0007%,-186.43601999999998:0.00035%,-186.44547:0.00018%]
[INFO] ** src:[22:38.38024%,9:25.98043%,7:18.14957%,1:17.48819%,14:0.0007%,17:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1552 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0566 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9982 - val_loss: 0.0107 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0547 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9983 - val_loss: 0.0103 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0586 - tp: 79058.0000 - fp: 942.0000 - tn: 319058.0000 - fn: 942.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9982 - val_loss: 0.0110 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0542 - tp: 79141.0000 - fp: 859.0000 - tn: 319141.0000 - fn: 859.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9983 - val_loss: 0.0103 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0538 - tp: 79150.0000 - fp: 850.0000 - tn: 319150.0000 - fn: 850.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9983 - val_loss: 0.0106 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/571380
[33m[INFO] loading file 37-37/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571380, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571380, 17)

[INFO] analyzing data
[INFO] 571380 rows
[INFO] ** appi_name:[21:99.99877%,30:0.0007%,33:0.00018%,26:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:64.37677%,Single Stage Single Point:35.62323%]
[INFO] ** dst:[21:43.33491%,10:21.03994%,8:18.13732%,9:17.48591%,22:0.0007%,15:0.0007%,24:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99965%,0:0.00035%]
[INFO] ** i/f_name:[2:99.9993%,3:0.0007%]
[INFO] ** modbus_function_code:[0.02961:99.99877%,-33.760870000000004:0.00123%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99877%,0:0.00123%]
[INFO] ** modbus_transaction_id:65536 (11.46977%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99912%,1:0.0007%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.38864%,20:25.98638%,13:18.13732%,6:17.48609%,17:0.0007%,21:0.00035%,16:0.00035%,1:0.00018%]
[INFO] ** s_port:[1.45442:25.98586%,-0.32151:21.03976%,-1.27613:18.13697%,-0.23351:17.48574%,-0.33484:17.34887%,-71.33197:0.0007%,-1.02014:0.00035%,1.46509:0.00018%,1.47576:0.00018%,-1.27347:0.00018%,-49.275529999999996:0.00018%,-0.24950999999999998:0.00018%,-0.24151:0.00018%,-1.2708:0.00018%,1.45709:0.00018%,14.4699:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:25.98568%,1:21.03976%,5:18.13679%,4:17.48556%,2:17.3487%,0:0.0035%]
[INFO] ** service:[0.0048200000000000005:99.99895%,-211.73542999999998:0.0007%,-183.8612:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.38864%,9:25.98638%,7:18.13732%,1:17.48609%,14:0.0007%,15:0.00035%,4:0.00035%,3:0.00018%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1552 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0561 - tp: 79106.0000 - fp: 894.0000 - tn: 319106.0000 - fn: 894.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9983 - val_loss: 0.0103 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0554 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9983 - val_loss: 0.0105 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0564 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9983 - val_loss: 0.0106 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0543 - tp: 79132.0000 - fp: 868.0000 - tn: 319132.0000 - fn: 868.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9984 - val_loss: 0.0106 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0556 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9984 - val_loss: 0.0107 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/571380
[33m[INFO] loading file 38-38/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571380, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571380, 17)

[INFO] analyzing data
[INFO] 571380 rows
[INFO] ** appi_name:[21:99.99895%,30:0.00035%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.40162%,Single Stage Single Point:35.59838%]
[INFO] ** dst:[21:43.31443%,10:21.08509%,8:18.10354%,9:17.49501%,22:0.00088%,15:0.00035%,25:0.00018%,24:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99982%,0:0.00018%]
[INFO] ** i/f_name:[2:99.99965%,3:0.00035%]
[INFO] ** modbus_function_code:[0.02961:99.99895%,-33.760870000000004:0.00105%]
[INFO] ** modbus_function_description:[7:49.99965%,11:49.9993%,0:0.00105%]
[INFO] ** modbus_transaction_id:65536 (11.46977%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9993%,2:0.00035%,1:0.00035%]
[INFO] ** proxy_src_ip:[18:38.44622%,20:25.95383%,13:18.10336%,6:17.49536%,17:0.00035%,7:0.00035%,16:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95313%,-0.32151:21.08492%,-1.27613:18.10319%,-0.23351:17.49484%,-0.33484:17.3613%,-0.24151:0.00035%,-71.33197:0.00035%,1.45709:0.00035%,1.47576:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-61.95768:0.00018%,-0.24950999999999998:0.00018%,-1.02014:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:25.95278%,1:21.08492%,5:18.10319%,4:17.49466%,2:17.3613%,0:0.00315%]
[INFO] ** service:[0.0048200000000000005:99.99912%,-211.73542999999998:0.00035%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.44622%,9:25.95383%,7:18.10336%,1:17.49536%,21:0.00035%,14:0.00035%,16:0.00018%,15:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1553 (0.2718%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0543 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9984 - val_loss: 0.0108 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0522 - tp: 79158.0000 - fp: 842.0000 - tn: 319158.0000 - fn: 842.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9985 - val_loss: 0.0100 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0530 - tp: 79135.0000 - fp: 865.0000 - tn: 319135.0000 - fn: 865.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9985 - val_loss: 0.0100 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0538 - tp: 79113.0000 - fp: 887.0000 - tn: 319113.0000 - fn: 887.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9984 - val_loss: 0.0104 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0532 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9986 - val_loss: 0.0106 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/571380
[33m[INFO] loading file 39-39/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571380, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571380, 17)

[INFO] analyzing data
[INFO] 571380 rows
[INFO] ** appi_name:[21:99.99965%,26:0.00018%,17:0.00018%]
[INFO] ** classification:[normal:64.39707%,Single Stage Single Point:35.60293%]
[INFO] ** dst:[21:43.31758%,10:21.07827%,8:18.13959%,9:17.46316%,22:0.00088%,24:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99965%,-33.760870000000004:0.00035%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99965%,0:0.00035%]
[INFO] ** modbus_transaction_id:65536 (11.46977%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.44237%,20:25.95383%,13:18.13977%,6:17.46316%,16:0.00053%,7:0.00035%]
[INFO] ** s_port:[1.45442:25.95331%,-0.32151:21.07827%,-1.27613:18.13942%,-0.23351:17.46298%,-0.33484:17.3641%,-1.02014:0.00053%,-71.14798:0.00018%,-1.27347:0.00018%,1.45709:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%]
[INFO] ** scada_tag:[3:25.95296%,1:21.07809%,5:18.13924%,4:17.46298%,2:17.36393%,0:0.0028%]
[INFO] ** service:[0.0048200000000000005:99.99965%,-211.08346:0.00018%,-205.44247:0.00018%]
[INFO] ** src:[22:38.44237%,9:25.95383%,7:18.13977%,1:17.46316%,15:0.00053%,21:0.00035%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1551 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0563 - tp: 79060.0000 - fp: 940.0000 - tn: 319060.0000 - fn: 940.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9985 - val_loss: 0.0110 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0517 - tp: 79152.0000 - fp: 848.0000 - tn: 319152.0000 - fn: 848.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9986 - val_loss: 0.0106 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0533 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9986 - val_loss: 0.0106 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0547 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9985 - val_loss: 0.0112 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0514 - tp: 79158.0000 - fp: 842.0000 - tn: 319158.0000 - fn: 842.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9986 - val_loss: 0.0104 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/571380
[33m[INFO] loading file 40-40/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571380, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571380, 17)

[INFO] analyzing data
[INFO] 571380 rows
[INFO] ** appi_name:[21:99.9965%,30:0.00298%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.33267%,Single Stage Single Point:35.66733%]
[INFO] ** dst:[21:43.29115%,10:21.03679%,8:18.20015%,9:17.46736%,15:0.00298%,22:0.00088%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.9972%,0:0.0028%]
[INFO] ** i/f_name:[2:99.99702%,3:0.00298%]
[INFO] ** modbus_function_code:[0.02961:99.9965%,-33.760870000000004:0.0035%]
[INFO] ** modbus_function_description:[7:49.99912%,11:49.99737%,0:0.0035%]
[INFO] ** modbus_transaction_id:65536 (11.46977%)
[INFO] ** orig:[0:99.99965%,1:0.00035%]
[INFO] ** proto:[0:99.9965%,1:0.00298%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.35346%,20:25.97536%,13:18.19997%,6:17.46771%,17:0.00298%,14:0.00053%]
[INFO] ** s_port:[1.45442:25.97448%,-0.32151:21.03679%,-1.27613:18.1998%,-0.23351:17.46718%,-0.33484:17.31667%,-71.33197:0.00298%,1.45709:0.00053%,-0.24151:0.00035%,-71.14798:0.00018%,-1.27347:0.00018%,11.862:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,13.431270000000001:0.00018%]
[INFO] ** scada_tag:[3:25.97413%,1:21.03661%,5:18.19962%,4:17.46683%,2:17.3165%,0:0.0063%]
[INFO] ** service:[0.0048200000000000005:99.9965%,-211.73542999999998:0.00298%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.35346%,9:25.97536%,7:18.19997%,1:17.46771%,14:0.00298%,2:0.00053%]
[INFO] ** type:[0:99.99912%,1:0.00088%]
[INFO] ** unixtime:1554 (0.27197%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0539 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9986 - val_loss: 0.0106 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0550 - tp: 79088.0000 - fp: 912.0000 - tn: 319088.0000 - fn: 912.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9985 - val_loss: 0.0109 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0537 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9986 - val_loss: 0.0111 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0524 - tp: 79135.0000 - fp: 865.0000 - tn: 319135.0000 - fn: 865.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9986 - val_loss: 0.0109 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0573 - tp: 79036.0000 - fp: 964.0000 - tn: 319036.0000 - fn: 964.0000 - accuracy: 0.9952 - precision: 0.9880 - recall: 0.9880 - auc: 0.9984 - val_loss: 0.0115 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/571380
[33m[INFO] loading file 41-41/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (511538, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (511538, 17)

[INFO] analyzing data
[INFO] 511538 rows
[INFO] ** appi_name:[21:99.99668%,30:0.00098%,22:0.00078%,17:0.00078%,32:0.0002%,28:0.0002%,26:0.0002%,7:0.0002%]
[INFO] ** classification:[normal:64.38994%,Single Stage Single Point:35.61006%]
[INFO] ** dst:[21:43.32503%,10:21.0608%,8:18.14352%,9:17.46635%,16:0.00098%,15:0.00098%,6:0.00098%,22:0.00059%,24:0.00039%,17:0.00039%]
[INFO] ** i/f_dir:[1:99.99902%,0:0.00098%]
[INFO] ** i/f_name:[2:99.99902%,3:0.00098%]
[INFO] ** modbus_function_code:[0.02961:99.99668%,-33.760870000000004:0.00332%]
[INFO] ** modbus_function_description:[7:49.99902%,11:49.99765%,0:0.00332%]
[INFO] ** modbus_transaction_id:65536 (12.81156%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99785%,2:0.00117%,1:0.00098%]
[INFO] ** proxy_src_ip:[18:38.43273%,20:25.9533%,13:18.14372%,6:17.46654%,17:0.00098%,1:0.00078%,21:0.00039%,16:0.00039%,14:0.00039%,0:0.00039%,7:0.0002%,2:0.0002%]
[INFO] ** s_port:[1.45442:25.95291%,-0.32151:21.0608%,-1.27613:18.14313%,-0.23351:17.46615%,-0.33484:17.37193%,-71.33197:0.00098%,-71.14931:0.00078%,-1.02014:0.00039%,-1.27347:0.00039%,-71.14798:0.0002%,-0.24151:0.0002%,-58.035180000000004:0.0002%,-1.2708:0.0002%,-5.1466400000000005:0.0002%,1.47576:0.0002%,1.46509:0.0002%,-64.19226:0.0002%,-5.08665:0.0002%,-0.24950999999999998:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** scada_tag:[3:25.95272%,1:21.0608%,5:18.14313%,4:17.46596%,2:17.37193%,0:0.00547%]
[INFO] ** service:[0.0048200000000000005:99.99668%,-211.73542999999998:0.00098%,-205.44247:0.00078%,-211.08818:0.00078%,89.64175:0.0002%,-211.09762999999998:0.0002%,-211.08346:0.0002%,-185.9872:0.0002%]
[INFO] ** src:[22:38.43273%,9:25.9533%,7:18.14372%,1:17.46654%,14:0.00098%,3:0.00078%,15:0.00039%,8:0.00039%,4:0.00039%,2:0.00039%,21:0.0002%,17:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1388 (0.27134%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/511538
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0549 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9985 - val_loss: 0.0113 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/511538
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0538 - tp: 79109.0000 - fp: 891.0000 - tn: 319109.0000 - fn: 891.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9986 - val_loss: 0.0118 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/511538
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0547 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9985 - val_loss: 0.0112 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/511538
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0550 - tp: 79085.0000 - fp: 915.0000 - tn: 319085.0000 - fn: 915.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9985 - val_loss: 0.0116 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/511538
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0551 - tp: 79082.0000 - fp: 918.0000 - tn: 319082.0000 - fn: 918.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9985 - val_loss: 0.0112 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-40-41-batch-400000-500000
[INFO] processing batch 500000-600000/511538
[33m[INFO] loading file 42-42/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (355052, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (355052, 17)

[INFO] analyzing data
[INFO] 355052 rows
[INFO] ** appi_name:[21:99.99042%,30:0.00253%,17:0.00141%,31:0.00113%,26:0.00113%,7:0.00113%,22:0.00084%,28:0.00028%,27:0.00028%,9:0.00028%,8:0.00028%,0:0.00028%]
[INFO] ** classification:[normal:64.34748%,Single Stage Single Point:35.65252%]
[INFO] ** dst:[21:43.29873%,10:21.03861%,8:18.20043%,9:17.45181%,16:0.00253%,6:0.00225%,18:0.00141%,2:0.00113%,22:0.00084%,15:0.00084%,17:0.00056%,25:0.00028%,7:0.00028%,0:0.00028%]
[INFO] ** i/f_dir:[1:99.99916%,0:0.00084%]
[INFO] ** i/f_name:[2:99.99916%,3:0.00084%]
[INFO] ** modbus_function_code:[0.02961:99.99042%,-33.760870000000004:0.00958%]
[INFO] ** modbus_function_description:[7:49.99606%,11:49.99437%,0:0.00958%]
[INFO] ** modbus_transaction_id:65536 (18.45814%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99493%,2:0.00422%,1:0.00084%]
[INFO] ** proxy_src_ip:[18:38.38733%,20:25.95028%,13:18.20071%,6:17.45181%,17:0.00253%,1:0.00253%,14:0.00169%,21:0.00113%,7:0.00084%,0:0.00056%,16:0.00028%,2:0.00028%]
[INFO] ** s_port:[1.45442:25.94972%,-0.32151:21.03861%,-1.27613:18.20043%,-0.23351:17.45153%,-0.33484:17.34873%,-71.14931:0.00113%,-71.14798:0.00113%,-71.33197:0.00084%,-3.3787199999999995:0.00056%,-0.08551:0.00056%,11.57001:0.00056%,13.431270000000001:0.00028%,-5.1466400000000005:0.00028%,0.31847:0.00028%,-1.02014:0.00028%,-64.19493:0.00028%,-1.2708:0.00028%,-58.035180000000004:0.00028%,7.66617:0.00028%,-0.24151:0.00028%,1.47576:0.00028%,14.4699:0.00028%,15.912510000000001:0.00028%,14.191239999999999:0.00028%,7.9608300000000005:0.00028%,-5.08665:0.00028%,10.192739999999999:0.00028%,-3.0613900000000003:0.00028%,1.45709:0.00028%,2.05573:0.00028%,-43.76509:0.00028%,11.862:0.00028%,-58.032509999999995:0.00028%]
[INFO] ** scada_tag:[3:25.94944%,1:21.03861%,5:18.20015%,4:17.45153%,2:17.34844%,0:0.01183%]
[INFO] ** service:[0.0048200000000000005:99.99042%,-211.09762999999998:0.00197%,-205.44247:0.00141%,-186.43601999999998:0.00141%,-211.08346:0.00113%,-211.08818:0.00113%,-211.73542999999998:0.00084%,-211.35747999999998:0.00056%,-186.44547:0.00028%,-183.8612:0.00028%,-185.9872:0.00028%,-202.75898:0.00028%]
[INFO] ** src:[22:38.38733%,9:25.95028%,7:18.20071%,1:17.45181%,3:0.00338%,2:0.00197%,4:0.00141%,21:0.00113%,14:0.00084%,8:0.00056%,17:0.00028%,15:0.00028%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:964 (0.27151%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/355052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0563 - tp: 79056.0000 - fp: 944.0000 - tn: 319056.0000 - fn: 944.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9985 - val_loss: 0.0113 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/355052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0569 - tp: 79045.0000 - fp: 955.0000 - tn: 319045.0000 - fn: 955.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9984 - val_loss: 0.0116 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/355052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0529 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9986 - val_loss: 0.0109 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/355052
[33m[INFO] loading file 43-43/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555052, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555052, 17)

[INFO] analyzing data
[INFO] 555052 rows
[INFO] ** appi_name:[21:99.9991%,30:0.00054%,26:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.39649%,Single Stage Single Point:35.60351%]
[INFO] ** dst:[21:43.32639%,10:21.06812%,8:18.13434%,9:17.46899%,22:0.00108%,15:0.00054%,24:0.00018%,6:0.00018%,2:0.00018%]
[INFO] ** i/f_dir:[1:99.99982%,0:0.00018%]
[INFO] ** i/f_name:[2:99.99946%,3:0.00054%]
[INFO] ** modbus_function_code:[0.02961:99.9991%,-33.760870000000004:0.0009%]
[INFO] ** modbus_function_description:[7:50.00036%,11:49.99874%,0:0.0009%]
[INFO] ** modbus_transaction_id:65536 (11.80718%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99928%,1:0.00054%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.41514%,20:25.97991%,13:18.13452%,6:17.46917%,17:0.00054%,16:0.00036%,1:0.00036%]
[INFO] ** s_port:[1.45442:25.97919%,-0.32151:21.06812%,-1.27613:18.13416%,-0.23351:17.46863%,-0.33484:17.34702%,-71.33197:0.00054%,1.45709:0.00036%,1.47576:0.00036%,-0.24151:0.00036%,-1.02014:0.00036%,0.31847:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-1.2708:0.00018%]
[INFO] ** scada_tag:[3:25.97883%,1:21.06812%,5:18.13398%,4:17.46827%,2:17.34684%,0:0.00396%]
[INFO] ** service:[0.0048200000000000005:99.9991%,-211.73542999999998:0.00054%,-211.09762999999998:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.41514%,9:25.97991%,7:18.13452%,1:17.46917%,14:0.00054%,15:0.00036%,3:0.00036%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1509 (0.27187%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0525 - tp: 79138.0000 - fp: 862.0000 - tn: 319138.0000 - fn: 862.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9986 - val_loss: 0.0107 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0535 - tp: 79113.0000 - fp: 887.0000 - tn: 319113.0000 - fn: 887.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9986 - val_loss: 0.0107 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0548 - tp: 79089.0000 - fp: 911.0000 - tn: 319089.0000 - fn: 911.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9985 - val_loss: 0.0111 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0528 - tp: 79129.0000 - fp: 871.0000 - tn: 319129.0000 - fn: 871.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9986 - val_loss: 0.0108 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0542 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9985 - val_loss: 0.0109 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/555052
[33m[INFO] loading file 44-44/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555052, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555052, 17)

[INFO] analyzing data
[INFO] 555052 rows
[INFO] ** appi_name:[21:99.9982%,30:0.00072%,31:0.00054%,0:0.00036%,22:0.00018%]
[INFO] ** classification:[normal:64.3873%,Single Stage Single Point:35.6127%]
[INFO] ** dst:[21:43.3336%,10:21.05064%,8:18.15307%,9:17.45945%,22:0.00108%,15:0.00072%,18:0.00054%,25:0.00036%,24:0.00036%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99928%,0:0.00072%]
[INFO] ** i/f_name:[2:99.99928%,3:0.00072%]
[INFO] ** modbus_function_code:[0.02961:99.9982%,-33.760870000000004:0.0018%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99802%,0:0.0018%]
[INFO] ** modbus_transaction_id:65536 (11.80718%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9982%,2:0.00108%,1:0.00072%]
[INFO] ** proxy_src_ip:[18:38.43189%,20:25.95288%,13:18.15325%,6:17.45999%,17:0.00072%,7:0.00036%,16:0.00018%,5:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95216%,-0.32151:21.05064%,-1.27613:18.15271%,-0.23351:17.45927%,-0.33484:17.38125%,-71.33197:0.00072%,-0.24151:0.00054%,-0.08551:0.00036%,-64.19493:0.00036%,-1.27347:0.00036%,1.45709:0.00036%,-1.02014:0.00018%,-1.2708:0.00018%,1.47576:0.00018%,-71.14931:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,4.42897:0.00018%]
[INFO] ** scada_tag:[3:25.95162%,1:21.05064%,5:18.15271%,4:17.4589%,2:17.38107%,0:0.00504%]
[INFO] ** service:[0.0048200000000000005:99.9982%,-211.73542999999998:0.00072%,-186.43601999999998:0.00054%,-186.44547:0.00036%,-211.08818:0.00018%]
[INFO] ** src:[22:38.43189%,9:25.95288%,7:18.15325%,1:17.45999%,14:0.00072%,21:0.00036%,17:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1506 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0542 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9985 - val_loss: 0.0109 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0535 - tp: 79113.0000 - fp: 887.0000 - tn: 319113.0000 - fn: 887.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9986 - val_loss: 0.0108 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0551 - tp: 79079.0000 - fp: 921.0000 - tn: 319079.0000 - fn: 921.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9985 - val_loss: 0.0112 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0531 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9986 - val_loss: 0.0118 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0549 - tp: 79086.0000 - fp: 914.0000 - tn: 319086.0000 - fn: 914.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9985 - val_loss: 0.0110 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/555052
[33m[INFO] loading file 45-45/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555052, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555052, 17)

[INFO] analyzing data
[INFO] 555052 rows
[INFO] ** appi_name:[21:99.99874%,30:0.00054%,31:0.00036%,26:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:64.41577%,Single Stage Single Point:35.58423%]
[INFO] ** dst:[21:43.32225%,10:21.09064%,8:18.12677%,9:17.45764%,22:0.00144%,15:0.00054%,18:0.00036%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99946%,3:0.00054%]
[INFO] ** modbus_function_code:[0.02961:99.99874%,-33.760870000000004:0.00126%]
[INFO] ** modbus_function_description:[7:50.00036%,11:49.99838%,0:0.00126%]
[INFO] ** modbus_transaction_id:65536 (11.80718%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99892%,2:0.00054%,1:0.00054%]
[INFO] ** proxy_src_ip:[18:38.48396%,20:25.92964%,13:18.12659%,6:17.45818%,17:0.00054%,16:0.00036%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.92892%,-0.32151:21.09064%,-1.27613:18.12659%,-0.23351:17.45746%,-0.33484:17.39333%,1.45709:0.00054%,-0.24151:0.00054%,-71.33197:0.00054%,-1.02014:0.00036%,-0.08551:0.00036%,-71.14798:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.92838%,1:21.09046%,5:18.12659%,4:17.45746%,2:17.39315%,0:0.00396%]
[INFO] ** service:[0.0048200000000000005:99.99874%,-211.73542999999998:0.00054%,-186.43601999999998:0.00036%,-183.8612:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.48396%,9:25.92964%,7:18.12659%,1:17.45818%,14:0.00054%,15:0.00036%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1506 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0552 - tp: 79086.0000 - fp: 914.0000 - tn: 319086.0000 - fn: 914.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9985 - val_loss: 0.0112 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0566 - tp: 79050.0000 - fp: 950.0000 - tn: 319050.0000 - fn: 950.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9985 - val_loss: 0.0115 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0546 - tp: 79091.0000 - fp: 909.0000 - tn: 319091.0000 - fn: 909.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9985 - val_loss: 0.0112 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0500 - tp: 79187.0000 - fp: 813.0000 - tn: 319187.0000 - fn: 813.0000 - accuracy: 0.9959 - precision: 0.9898 - recall: 0.9898 - auc: 0.9987 - val_loss: 0.0104 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0561 - tp: 79060.0000 - fp: 940.0000 - tn: 319060.0000 - fn: 940.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9985 - val_loss: 0.0111 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/555052
[33m[INFO] loading file 46-46/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555052, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555052, 17)

[INFO] analyzing data
[INFO] 555052 rows
[INFO] ** appi_name:[21:99.9982%,30:0.00108%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.4273%,Single Stage Single Point:35.5727%]
[INFO] ** dst:[21:43.34693%,10:21.07766%,8:18.10101%,9:17.4717%,22:0.00108%,15:0.00108%,25:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.9991%,0:0.0009%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.9982%,-33.760870000000004:0.0018%]
[INFO] ** modbus_function_description:[11:49.9991%,7:49.9991%,0:0.0018%]
[INFO] ** modbus_transaction_id:65536 (11.80718%)
[INFO] ** orig:[0:99.99964%,1:0.00036%]
[INFO] ** proto:[0:99.99856%,1:0.00108%,2:0.00036%]
[INFO] ** proxy_src_ip:[18:38.45009%,20:25.9745%,13:18.10101%,6:17.47224%,17:0.00108%,16:0.00036%,7:0.00036%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.97414%,-0.32151:21.07748%,-1.27613:18.10083%,-0.23351:17.47152%,-0.33484:17.37261%,-71.33197:0.00108%,-0.24151:0.00054%,-1.02014:0.00036%,-71.14798:0.00018%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:25.97378%,1:21.0773%,5:18.10065%,4:17.47116%,2:17.37261%,0:0.0045%]
[INFO] ** service:[0.0048200000000000005:99.99838%,-211.73542999999998:0.00108%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.45009%,9:25.9745%,7:18.10101%,1:17.47224%,14:0.00108%,21:0.00036%,15:0.00036%,16:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.9991%,1:0.0009%]
[INFO] ** unixtime:1509 (0.27187%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0519 - tp: 79148.0000 - fp: 852.0000 - tn: 319148.0000 - fn: 852.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9986 - val_loss: 0.0110 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0511 - tp: 79164.0000 - fp: 836.0000 - tn: 319164.0000 - fn: 836.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9987 - val_loss: 0.0105 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0535 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9986 - val_loss: 0.0106 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0497 - tp: 79196.0000 - fp: 804.0000 - tn: 319196.0000 - fn: 804.0000 - accuracy: 0.9960 - precision: 0.9900 - recall: 0.9900 - auc: 0.9987 - val_loss: 0.0101 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0538 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9986 - val_loss: 0.0106 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/555052
[33m[INFO] loading file 47-47/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555052, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555052, 17)

[INFO] analyzing data
[INFO] 555052 rows
[INFO] ** appi_name:[21:99.99946%,33:0.00018%,26:0.00018%,17:0.00018%]
[INFO] ** classification:[normal:64.39775%,Single Stage Single Point:35.60225%]
[INFO] ** dst:[21:43.31054%,10:21.08523%,8:18.12569%,9:17.4762%,22:0.00162%,24:0.00036%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99946%,-33.760870000000004:0.00054%]
[INFO] ** modbus_function_description:[7:50.0009%,11:49.99856%,0:0.00054%]
[INFO] ** modbus_transaction_id:65536 (11.80718%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.4573%,20:25.93919%,13:18.12605%,6:17.47656%,16:0.00036%,7:0.00036%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.93829%,-0.32151:21.08523%,-1.27613:18.12551%,-0.23351:17.47602%,-0.33484:17.37207%,1.45709:0.00054%,-0.24151:0.00054%,-1.27347:0.00036%,-1.02014:0.00036%,-71.14798:0.00018%,-61.95635:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%]
[INFO] ** scada_tag:[3:25.93775%,1:21.08505%,5:18.12533%,4:17.47584%,2:17.37189%,0:0.00414%]
[INFO] ** service:[0.0048200000000000005:99.99964%,-211.08346:0.00018%,-205.44247:0.00018%]
[INFO] ** src:[22:38.4573%,9:25.93919%,7:18.12605%,1:17.47656%,21:0.00036%,15:0.00036%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1507 (0.27151%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0543 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9985 - val_loss: 0.0107 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0514 - tp: 79157.0000 - fp: 843.0000 - tn: 319157.0000 - fn: 843.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9986 - val_loss: 0.0105 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0540 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9986 - val_loss: 0.0108 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0537 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9986 - val_loss: 0.0110 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0518 - tp: 79148.0000 - fp: 852.0000 - tn: 319148.0000 - fn: 852.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9986 - val_loss: 0.0105 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/555052
[33m[INFO] loading file 48-48/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555052, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555052, 17)

[INFO] analyzing data
[INFO] 555052 rows
[INFO] ** appi_name:[21:99.99676%,30:0.00252%,33:0.00018%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.42766%,Single Stage Single Point:35.57234%]
[INFO] ** dst:[21:43.33774%,10:21.08613%,8:18.10389%,9:17.46809%,15:0.00252%,22:0.0009%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99784%,0:0.00216%]
[INFO] ** i/f_name:[2:99.99748%,3:0.00252%]
[INFO] ** modbus_function_code:[0.02961:99.99676%,-33.760870000000004:0.00324%]
[INFO] ** modbus_function_description:[7:49.99892%,11:49.99784%,0:0.00324%]
[INFO] ** modbus_transaction_id:65536 (11.80718%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99694%,1:0.00252%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.46324%,20:25.96081%,13:18.10425%,6:17.46809%,17:0.00252%,14:0.00054%,16:0.00036%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.96045%,-0.32151:21.08613%,-1.27613:18.10389%,-0.23351:17.46791%,-0.33484:17.37711%,-71.33197:0.00252%,-1.02014:0.00036%,-71.14798:0.00018%,-1.27347:0.00018%,11.862:0.00018%,1.45709:0.00018%,-61.95635:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,13.431270000000001:0.00018%,-1.2708:0.00018%]
[INFO] ** scada_tag:[3:25.96009%,1:21.08613%,5:18.10389%,4:17.46791%,2:17.37693%,0:0.00504%]
[INFO] ** service:[0.0048200000000000005:99.99694%,-211.73542999999998:0.00252%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.46324%,9:25.96081%,7:18.10425%,1:17.46809%,14:0.00252%,2:0.00054%,15:0.00036%,8:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1506 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0533 - tp: 79119.0000 - fp: 881.0000 - tn: 319119.0000 - fn: 881.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9986 - val_loss: 0.0108 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 3s - loss: 0.0537 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9986 - val_loss: 0.0105 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0552 - tp: 79079.0000 - fp: 921.0000 - tn: 319079.0000 - fn: 921.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9985 - val_loss: 0.0112 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0557 - tp: 79070.0000 - fp: 930.0000 - tn: 319070.0000 - fn: 930.0000 - accuracy: 0.9953 - precision: 0.9884 - recall: 0.9884 - auc: 0.9985 - val_loss: 0.0111 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0530 - tp: 79124.0000 - fp: 876.0000 - tn: 319124.0000 - fn: 876.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9986 - val_loss: 0.0111 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/555052
[33m[INFO] loading file 49-49/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555052, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555052, 17)

[INFO] analyzing data
[INFO] 555052 rows
[INFO] ** appi_name:[21:99.9973%,30:0.0009%,17:0.00072%,26:0.00036%,22:0.00036%,28:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.36802%,Single Stage Single Point:35.63198%]
[INFO] ** dst:[21:43.30892%,10:21.05496%,8:18.14064%,9:17.49115%,22:0.00126%,15:0.0009%,16:0.00072%,6:0.00072%,24:0.00036%,17:0.00036%]
[INFO] ** i/f_dir:[1:99.9991%,0:0.0009%]
[INFO] ** i/f_name:[2:99.9991%,3:0.0009%]
[INFO] ** modbus_function_code:[0.02961:99.9973%,-33.760870000000004:0.0027%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.99766%,0:0.0027%]
[INFO] ** modbus_transaction_id:65536 (11.80718%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99838%,1:0.0009%,2:0.00072%]
[INFO] ** proxy_src_ip:[18:38.4164%,20:25.94802%,13:18.14082%,6:17.49169%,17:0.0009%,1:0.00072%,14:0.00054%,21:0.00036%,16:0.00036%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.9473%,-0.32151:21.05496%,-1.27613:18.14028%,-0.23351:17.49097%,-0.33484:17.36144%,-71.33197:0.0009%,-0.24151:0.00054%,-71.14931:0.00036%,-1.02014:0.00036%,-1.27347:0.00036%,-71.14798:0.00036%,1.45709:0.00036%,1.47576:0.00018%,1.46509:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,-0.24950999999999998:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,-5.08665:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:25.94694%,1:21.05478%,5:18.1401%,4:17.49061%,2:17.36144%,0:0.00613%]
[INFO] ** service:[0.0048200000000000005:99.9973%,-211.73542999999998:0.0009%,-205.44247:0.00072%,-211.08346:0.00036%,-211.08818:0.00036%,-211.09762999999998:0.00018%,-185.9872:0.00018%]
[INFO] ** src:[22:38.4164%,9:25.94802%,7:18.14082%,1:17.49169%,14:0.0009%,3:0.00072%,2:0.00054%,15:0.00036%,4:0.00036%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1507 (0.27151%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0528 - tp: 79128.0000 - fp: 872.0000 - tn: 319128.0000 - fn: 872.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9986 - val_loss: 0.0108 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0529 - tp: 79128.0000 - fp: 872.0000 - tn: 319128.0000 - fn: 872.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9986 - val_loss: 0.0107 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0562 - tp: 79064.0000 - fp: 936.0000 - tn: 319064.0000 - fn: 936.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9985 - val_loss: 0.0110 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0524 - tp: 79136.0000 - fp: 864.0000 - tn: 319136.0000 - fn: 864.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9986 - val_loss: 0.0110 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0518 - tp: 79153.0000 - fp: 847.0000 - tn: 319153.0000 - fn: 847.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9986 - val_loss: 0.0105 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/555052
[33m[INFO] loading file 50-50/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (405034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (405034, 17)

[INFO] analyzing data
[INFO] 405034 rows
[INFO] ** appi_name:[21:99.99753%,30:0.00099%,7:0.00074%,31:0.00025%,22:0.00025%,8:0.00025%]
[INFO] ** classification:[normal:64.31263%,Single Stage Single Point:35.68737%]
[INFO] ** dst:[21:43.26452%,10:21.04515%,8:18.21279%,9:17.47434%,15:0.00099%,22:0.00049%,16:0.00049%,2:0.00049%,24:0.00025%,18:0.00025%,6:0.00025%]
[INFO] ** i/f_dir:[1:99.99901%,0:0.00099%]
[INFO] ** i/f_name:[2:99.99901%,3:0.00099%]
[INFO] ** modbus_function_code:[0.02961:99.99753%,-33.760870000000004:0.00247%]
[INFO] ** modbus_function_description:[11:49.99901%,7:49.99852%,0:0.00247%]
[INFO] ** modbus_transaction_id:65536 (16.18037%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99852%,1:0.00099%,2:0.00049%]
[INFO] ** proxy_src_ip:[18:38.37382%,20:25.93609%,13:18.21304%,6:17.47434%,17:0.00099%,1:0.00074%,21:0.00025%,16:0.00025%,14:0.00025%,7:0.00025%]
[INFO] ** s_port:[1.45442:25.9356%,-0.32151:21.04515%,-1.27613:18.21255%,-0.23351:17.47434%,-0.33484:17.32867%,-71.33197:0.00099%,-3.3787199999999995:0.00025%,4.33564:0.00025%,15.912510000000001:0.00025%,7.9608300000000005:0.00025%,1.46509:0.00025%,1.45709:0.00025%,-1.27347:0.00025%,-71.14931:0.00025%,-1.02014:0.00025%,-1.2708:0.00025%,0.31847:0.00025%]
[INFO] ** scada_tag:[3:25.93535%,1:21.0449%,5:18.2123%,4:17.47434%,2:17.32842%,0:0.00469%]
[INFO] ** service:[0.0048200000000000005:99.99753%,-211.73542999999998:0.00099%,-211.09762999999998:0.00074%,-186.43601999999998:0.00025%,-211.35747999999998:0.00025%,-211.08818:0.00025%]
[INFO] ** src:[22:38.37382%,9:25.93609%,7:18.21304%,1:17.47434%,14:0.00099%,3:0.00074%,21:0.00025%,15:0.00025%,4:0.00025%,2:0.00025%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1101 (0.27183%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/405034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0499 - tp: 79188.0000 - fp: 812.0000 - tn: 319188.0000 - fn: 812.0000 - accuracy: 0.9959 - precision: 0.9898 - recall: 0.9898 - auc: 0.9987 - val_loss: 0.0102 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/405034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0544 - tp: 79094.0000 - fp: 906.0000 - tn: 319094.0000 - fn: 906.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9985 - val_loss: 0.0116 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/405034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0549 - tp: 79085.0000 - fp: 915.0000 - tn: 319085.0000 - fn: 915.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9985 - val_loss: 0.0110 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/405034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0533 - tp: 79119.0000 - fp: 881.0000 - tn: 319119.0000 - fn: 881.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9986 - val_loss: 0.0110 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-49-50-batch-300000-400000
[INFO] processing batch 400000-500000/405034
[33m[INFO] epoch 8/10[0m
[33m[INFO] loading file 1-1/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99287%,30:0.00119%,22:0.00099%,17:0.00079%,31:0.00059%,26:0.00059%,7:0.00059%,23:0.0004%,18:0.0004%,0:0.0004%,28:0.0002%,27:0.0002%,24:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** classification:[normal:79.14932%,Single Stage Single Point:20.85068%]
[INFO] ** dst:[21:43.26818%,10:21.04096%,8:18.16393%,9:17.51941%,6:0.00158%,16:0.00119%,15:0.00119%,22:0.00099%,18:0.00059%,26:0.0004%,25:0.0004%,19:0.0004%,17:0.0004%,24:0.0002%,7:0.0002%]
[INFO] ** i/f_dir:[1:99.99881%,0:0.00119%]
[INFO] ** i/f_name:[2:99.99881%,3:0.00119%]
[INFO] ** modbus_function_code:[0.02961:99.99287%,-33.760870000000004:0.00693%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.99743%,11:49.99545%,0:0.00693%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99604%,2:0.00277%,1:0.00119%]
[INFO] ** proxy_src_ip:[18:38.40652%,20:25.90202%,13:18.16412%,6:17.51981%,11:0.00139%,10:0.00139%,17:0.00119%,14:0.00099%,1:0.00099%,7:0.00059%,21:0.0004%,16:0.0004%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.90162%,-0.32151:21.04017%,-1.27613:18.16373%,-0.23351:17.51922%,-0.33484:17.36636%,-71.33197:0.00119%,-71.14931:0.00099%,-2.1481:0.00079%,-0.24151:0.00059%,-71.14798:0.00059%,-2.42942:0.0004%,4.44364:0.0004%,-1.02014:0.0004%,-64.19493:0.0004%,-5.1466400000000005:0.0002%,-1.2708:0.0002%,-58.035180000000004:0.0002%,4.076980000000001:0.0002%,-5.08665:0.0002%,1.47576:0.0002%,1.46509:0.0002%,4.29964:0.0002%,14.253910000000001:0.0002%,-68.79874000000001:0.0002%,6.1115699999999995:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,10.67005:0.0002%,-1.27347:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** scada_tag:[3:25.90142%,1:21.03997%,5:18.16353%,4:17.51902%,2:17.36616%,0:0.0099%]
[INFO] ** service:[0.0048200000000000005:99.99366%,-211.73542999999998:0.00119%,-211.08818:0.00099%,-205.44247:0.00079%,-211.07873999999998:0.00079%,-211.09762999999998:0.00059%,-211.08346:0.00059%,-186.43601999999998:0.00059%,-186.44547:0.0004%,-185.9872:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:38.40652%,9:25.90202%,7:18.16412%,1:17.51981%,11:0.00139%,10:0.00139%,14:0.00119%,3:0.00099%,2:0.00099%,21:0.00059%,15:0.0004%,4:0.0004%,8:0.0002%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** unixtime:1371 (0.27147%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3464 - tp: 76874.0000 - fp: 3126.0000 - tn: 316874.0000 - fn: 3126.0000 - accuracy: 0.9844 - precision: 0.9609 - recall: 0.9609 - auc: 0.9845 - val_loss: 0.0084 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 3s - loss: 0.0081 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0065 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0063 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3175 - val_tp: 12747.0000 - val_fp: 7253.0000 - val_tn: 72747.0000 - val_fn: 7253.0000 - val_accuracy: 0.8549 - val_precision: 0.6374 - val_recall: 0.6374 - val_auc: 0.8181
[INFO] saving weights to checkpoints/lstm-epoch-8-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.9384 - tp: 42410.0000 - fp: 37590.0000 - tn: 282410.0000 - fn: 37590.0000 - accuracy: 0.8120 - precision: 0.5301 - recall: 0.5301 - auc: 0.8675 - val_loss: 1.2527 - val_tp: 10632.0000 - val_fp: 9368.0000 - val_tn: 70632.0000 - val_fn: 9368.0000 - val_accuracy: 0.8126 - val_precision: 0.5316 - val_recall: 0.5316 - val_auc: 0.8819
[INFO] saving weights to checkpoints/lstm-epoch-8-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0904 - tp: 42428.0000 - fp: 37572.0000 - tn: 282428.0000 - fn: 37572.0000 - accuracy: 0.8121 - precision: 0.5304 - recall: 0.5304 - auc: 0.8829 - val_loss: 0.9541 - val_tp: 10650.0000 - val_fp: 9350.0000 - val_tn: 70650.0000 - val_fn: 9350.0000 - val_accuracy: 0.8130 - val_precision: 0.5325 - val_recall: 0.5325 - val_auc: 0.8807
[INFO] saving weights to checkpoints/lstm-epoch-8-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 2-2/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99881%,30:0.0004%,7:0.0004%,31:0.0002%,8:0.0002%]
[INFO] ** classification:[normal:72.58897%,Single Stage Single Point:27.41103%]
[INFO] ** dst:[21:43.31253%,10:21.03522%,8:18.13125%,9:17.51882%,22:0.00079%,15:0.0004%,2:0.0004%,24:0.0002%,18:0.0002%,16:0.0002%]
[INFO] ** i/f_dir:[1:99.9996%,0:0.0004%]
[INFO] ** i/f_name:[2:99.9996%,3:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.99881%,-33.760870000000004:0.00119%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.99901%,0:0.00119%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99941%,1:0.0004%,2:0.0002%]
[INFO] ** proxy_src_ip:[18:38.38613%,20:25.96201%,13:18.13145%,6:17.51902%,1:0.00059%,17:0.0004%,16:0.0002%,14:0.0002%]
[INFO] ** s_port:[1.45442:25.96142%,-0.32151:21.03522%,-1.27613:18.13106%,-0.23351:17.51862%,-0.33484:17.35091%,-71.33197:0.0004%,1.45709:0.0004%,-1.2708:0.0002%,-1.02014:0.0002%,-0.24151:0.0002%,4.076980000000001:0.0002%,12.60597:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,-3.3787199999999995:0.0002%,-0.24950999999999998:0.0002%,4.29964:0.0002%]
[INFO] ** scada_tag:[3:25.96102%,1:21.03522%,5:18.13106%,4:17.51842%,2:17.35071%,0:0.00356%]
[INFO] ** service:[0.0048200000000000005:99.99881%,-211.09762999999998:0.0004%,-211.73542999999998:0.0004%,-186.43601999999998:0.0002%,-211.35747999999998:0.0002%]
[INFO] ** src:[22:38.38613%,9:25.96201%,7:18.13145%,1:17.51902%,3:0.00059%,14:0.0004%,15:0.0002%,2:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1374 (0.27206%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8734 - tp: 42480.0000 - fp: 37520.0000 - tn: 282480.0000 - fn: 37520.0000 - accuracy: 0.8124 - precision: 0.5310 - recall: 0.5310 - auc: 0.8830 - val_loss: 0.8077 - val_tp: 10588.0000 - val_fp: 9412.0000 - val_tn: 70588.0000 - val_fn: 9412.0000 - val_accuracy: 0.8118 - val_precision: 0.5294 - val_recall: 0.5294 - val_auc: 0.8816
[INFO] saving weights to checkpoints/lstm-epoch-8-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4859 - tp: 65255.0000 - fp: 14745.0000 - tn: 305255.0000 - fn: 14745.0000 - accuracy: 0.9263 - precision: 0.8157 - recall: 0.8157 - auc: 0.9534 - val_loss: 0.2590 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3145 - tp: 74800.0000 - fp: 5200.0000 - tn: 314800.0000 - fn: 5200.0000 - accuracy: 0.9740 - precision: 0.9350 - recall: 0.9350 - auc: 0.9837 - val_loss: 0.9159 - val_tp: 10577.0000 - val_fp: 9423.0000 - val_tn: 70577.0000 - val_fn: 9423.0000 - val_accuracy: 0.8115 - val_precision: 0.5289 - val_recall: 0.5289 - val_auc: 0.8812
[INFO] saving weights to checkpoints/lstm-epoch-8-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8403 - tp: 42359.0000 - fp: 37641.0000 - tn: 282359.0000 - fn: 37641.0000 - accuracy: 0.8118 - precision: 0.5295 - recall: 0.5295 - auc: 0.8832 - val_loss: 0.7761 - val_tp: 10572.0000 - val_fp: 9428.0000 - val_tn: 70572.0000 - val_fn: 9428.0000 - val_accuracy: 0.8114 - val_precision: 0.5286 - val_recall: 0.5286 - val_auc: 0.8815
[INFO] saving weights to checkpoints/lstm-epoch-8-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4956 - tp: 65000.0000 - fp: 15000.0000 - tn: 305000.0000 - fn: 15000.0000 - accuracy: 0.9250 - precision: 0.8125 - recall: 0.8125 - auc: 0.9537 - val_loss: 0.2772 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 3-3/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99089%,30:0.00238%,22:0.00119%,31:0.00099%,26:0.00099%,17:0.00099%,7:0.00079%,27:0.0004%,0:0.0004%,28:0.0002%,23:0.0002%,15:0.0002%,8:0.0002%,5:0.0002%]
[INFO] ** classification:[normal:86.84405%,Single Stage Single Point:13.15595%]
[INFO] ** dst:[21:43.30223%,10:21.09026%,8:18.15442%,9:17.44298%,6:0.00238%,15:0.00158%,18:0.00139%,16:0.00139%,22:0.00099%,2:0.0004%,7:0.0004%,25:0.0004%,17:0.0004%,12:0.0002%,24:0.0002%,19:0.0002%,0:0.0002%]
[INFO] ** i/f_dir:[1:99.99842%,0:0.00158%]
[INFO] ** i/f_name:[2:99.99842%,3:0.00158%]
[INFO] ** modbus_function_code:[0.02961:99.99089%,-33.760870000000004:0.00891%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.99604%,11:49.99485%,0:0.00891%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:99.99881%,2:0.00119%]
[INFO] ** proto:[0:99.99366%,2:0.00475%,1:0.00158%]
[INFO] ** proxy_src_ip:[18:38.41979%,20:25.9731%,13:18.15462%,6:17.44338%,17:0.00238%,1:0.00158%,14:0.00139%,7:0.00099%,11:0.00079%,10:0.00079%,21:0.00059%,16:0.0002%,15:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.97231%,-0.32151:21.09007%,-1.27613:18.15403%,-0.23351:17.44279%,-0.33484:17.32972%,-71.33197:0.00158%,-71.14798:0.00119%,-71.14931:0.00119%,-64.19493:0.0004%,-0.08551:0.0004%,1.45709:0.0004%,-0.24151:0.0004%,13.431270000000001:0.0002%,14.4699:0.0002%,4.076980000000001:0.0002%,-5.1466400000000005:0.0002%,-1.02014:0.0002%,1.47576:0.0002%,-1.2708:0.0002%,-58.035180000000004:0.0002%,-58.032509999999995:0.0002%,12.60597:0.0002%,-5.08665:0.0002%,1.46509:0.0002%,-2.1481:0.0002%,-1.27347:0.0002%,10.67005:0.0002%,-43.76509:0.0002%,2.05573:0.0002%,6.1115699999999995:0.0002%,4.44364:0.0002%,13.86459:0.0002%,4.29964:0.0002%,-0.24950999999999998:0.0002%,-3.3787199999999995:0.0002%,10.192739999999999:0.0002%,-68.79874000000001:0.0002%,14.253910000000001:0.0002%,4.90362:0.0002%,-68.36943000000001:0.0002%]
[INFO] ** scada_tag:[3:25.97191%,1:21.08987%,5:18.15383%,4:17.44259%,2:17.32953%,0:0.01228%]
[INFO] ** service:[0.0048200000000000005:99.99109%,-211.73542999999998:0.00158%,-186.43601999999998:0.00139%,-211.08346:0.00119%,-211.08818:0.00119%,-205.44247:0.00099%,-211.09762999999998:0.00079%,-186.44547:0.0004%,-202.75898:0.0004%,-183.8612:0.0002%,-185.9872:0.0002%,-201.23771000000002:0.0002%,-211.35747999999998:0.0002%,-211.07873999999998:0.0002%]
[INFO] ** src:[22:38.41979%,9:25.9731%,7:18.15462%,1:17.44338%,21:0.00218%,3:0.00178%,2:0.00139%,11:0.00079%,10:0.00079%,4:0.00079%,14:0.0004%,8:0.0004%,17:0.0002%,15:0.0002%,13:0.0002%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** unixtime:1371 (0.27147%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7078 - tp: 47560.0000 - fp: 32440.0000 - tn: 287560.0000 - fn: 32440.0000 - accuracy: 0.8378 - precision: 0.5945 - recall: 0.5945 - auc: 0.9008 - val_loss: 0.7344 - val_tp: 10560.0000 - val_fp: 9440.0000 - val_tn: 70560.0000 - val_fn: 9440.0000 - val_accuracy: 0.8112 - val_precision: 0.5280 - val_recall: 0.5280 - val_auc: 0.8813
[INFO] saving weights to checkpoints/lstm-epoch-8-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6048 - tp: 55385.0000 - fp: 24615.0000 - tn: 295385.0000 - fn: 24615.0000 - accuracy: 0.8769 - precision: 0.6923 - recall: 0.6923 - auc: 0.9231 - val_loss: 0.3670 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2764 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.2063 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1685 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1383 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1181 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1009 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 4-4/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99762%,30:0.00139%,31:0.0004%,33:0.0002%,26:0.0002%,9:0.0002%]
[INFO] ** classification:[normal:91.33128%,Single Stage Single Point:8.66872%]
[INFO] ** dst:[21:43.35807%,10:20.93522%,8:18.17363%,9:17.52951%,15:0.00139%,22:0.00119%,18:0.0004%,24:0.0002%,6:0.0002%,0:0.0002%]
[INFO] ** i/f_dir:[1:99.99881%,0:0.00119%]
[INFO] ** i/f_name:[2:99.99861%,3:0.00139%]
[INFO] ** modbus_function_code:[0.02961:99.99762%,-33.760870000000004:0.00238%]
[INFO] ** modbus_function_description:[7:49.9996%,11:49.99802%,0:0.00238%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:99.99881%,2:0.00119%]
[INFO] ** proto:[0:99.99802%,1:0.00139%,2:0.00059%]
[INFO] ** proxy_src_ip:[18:38.25208%,20:26.04161%,13:18.17363%,6:17.52991%,17:0.00139%,21:0.0004%,16:0.0004%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:26.04082%,-0.32151:20.93503%,-1.27613:18.17323%,-0.23351:17.52931%,-0.33484:17.31705%,-71.33197:0.00139%,1.45709:0.0004%,-0.24151:0.0004%,-1.02014:0.0004%,-0.08551:0.0004%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,14.4699:0.0002%,-49.275529999999996:0.0002%,-1.2708:0.0002%,-71.14798:0.0002%]
[INFO] ** scada_tag:[3:26.04062%,1:20.93483%,5:18.17323%,4:17.52892%,2:17.31685%,0:0.00554%]
[INFO] ** service:[0.0048200000000000005:99.99782%,-211.73542999999998:0.00139%,-186.43601999999998:0.0004%,-183.8612:0.0002%,-211.08346:0.0002%]
[INFO] ** src:[22:38.25208%,9:26.04161%,7:18.17363%,1:17.52991%,21:0.00119%,15:0.0004%,4:0.0004%,17:0.0002%,14:0.0002%,8:0.0002%,3:0.0002%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** unixtime:1382 (0.27364%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0884 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0773 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0686 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0601 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0539 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0474 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2750 - tp: 74603.0000 - fp: 5397.0000 - tn: 314603.0000 - fn: 5397.0000 - accuracy: 0.9730 - precision: 0.9325 - recall: 0.9325 - auc: 0.9823 - val_loss: 2.0347 - val_tp: 7790.0000 - val_fp: 12210.0000 - val_tn: 67790.0000 - val_fn: 12210.0000 - val_accuracy: 0.7558 - val_precision: 0.3895 - val_recall: 0.3895 - val_auc: 0.8406
[INFO] saving weights to checkpoints/lstm-epoch-8-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8776 - tp: 53876.0000 - fp: 26124.0000 - tn: 293876.0000 - fn: 26124.0000 - accuracy: 0.8694 - precision: 0.6734 - recall: 0.6734 - auc: 0.9185 - val_loss: 0.1320 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 5-5/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99683%,30:0.00218%,37:0.0002%,26:0.0002%,12:0.0002%,6:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:88.84333%,Single Stage Single Point:11.15667%]
[INFO] ** dst:[21:43.36599%,10:20.76137%,8:18.24986%,9:17.61901%,15:0.00218%,22:0.00079%,25:0.0002%,24:0.0002%,6:0.0002%,2:0.0002%]
[INFO] ** i/f_dir:[1:99.99802%,0:0.00198%]
[INFO] ** i/f_name:[2:99.99782%,3:0.00218%]
[INFO] ** modbus_function_code:[0.02961:99.99683%,-33.760870000000004:0.00317%]
[INFO] ** modbus_function_description:[7:49.99881%,11:49.99802%,0:0.00317%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:99.99822%,2:0.00178%]
[INFO] ** proto:[0:99.99743%,1:0.00218%,2:0.0004%]
[INFO] ** proxy_src_ip:[18:37.98992%,20:26.13725%,13:18.25006%,6:17.61941%,17:0.00218%,21:0.0002%,16:0.0002%,7:0.0002%,5:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:26.13705%,-0.32151:20.76098%,-1.27613:18.24986%,-0.23351:17.61901%,-0.33484:17.22894%,-71.33197:0.00218%,-0.24151:0.0004%,-71.14798:0.0002%,-1.27347:0.0002%,1.45709:0.0002%,2.22906:0.0002%,-49.275529999999996:0.0002%,-61.95768:0.0002%,-1.02014:0.0002%,-64.19493:0.0002%]
[INFO] ** scada_tag:[3:26.13666%,1:20.76078%,5:18.24966%,4:17.61901%,2:17.22894%,0:0.00495%]
[INFO] ** service:[0.0048200000000000005:99.99723%,-211.73542999999998:0.00218%,-186.44547:0.0002%,-211.08346:0.0002%,-211.35747999999998:0.0002%]
[INFO] ** src:[22:37.98992%,9:26.13725%,7:18.25006%,1:17.61941%,21:0.00198%,14:0.0004%,16:0.0002%,15:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** unixtime:1380 (0.27325%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5050 - tp: 64349.0000 - fp: 15651.0000 - tn: 304349.0000 - fn: 15651.0000 - accuracy: 0.9217 - precision: 0.8044 - recall: 0.8044 - auc: 0.9518 - val_loss: 0.7732 - val_tp: 12834.0000 - val_fp: 7166.0000 - val_tn: 72834.0000 - val_fn: 7166.0000 - val_accuracy: 0.8567 - val_precision: 0.6417 - val_recall: 0.6417 - val_auc: 0.9135
[INFO] saving weights to checkpoints/lstm-epoch-8-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6882 - tp: 53735.0000 - fp: 26265.0000 - tn: 293735.0000 - fn: 26265.0000 - accuracy: 0.8687 - precision: 0.6717 - recall: 0.6717 - auc: 0.9200 - val_loss: 0.6311 - val_tp: 15497.0000 - val_fp: 4503.0000 - val_tn: 75497.0000 - val_fn: 4503.0000 - val_accuracy: 0.9099 - val_precision: 0.7749 - val_recall: 0.7749 - val_auc: 0.9383
[INFO] saving weights to checkpoints/lstm-epoch-8-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2024 - tp: 79851.0000 - fp: 149.0000 - tn: 319851.0000 - fn: 149.0000 - accuracy: 0.9993 - precision: 0.9981 - recall: 0.9981 - auc: 0.9988 - val_loss: 0.1457 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1205 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0997 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0850 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0682 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 6-6/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99545%,30:0.00356%,31:0.0002%,27:0.0002%,26:0.0002%,5:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:91.99955%,Single Stage Single Point:8.00045%]
[INFO] ** dst:[21:43.37589%,10:20.73187%,8:18.28669%,9:17.6004%,15:0.00356%,22:0.0004%,25:0.0002%,24:0.0002%,18:0.0002%,12:0.0002%,7:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99663%,0:0.00337%]
[INFO] ** i/f_name:[2:99.99644%,3:0.00356%]
[INFO] ** modbus_function_code:[0.02961:99.99545%,-33.760870000000004:0.00455%]
[INFO] ** modbus_function_description:[7:49.99822%,11:49.99723%,0:0.00455%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:99.9996%,1:0.0004%]
[INFO] ** proto:[0:99.99545%,1:0.00356%,2:0.00099%]
[INFO] ** proxy_src_ip:[18:37.94576%,20:26.1622%,13:18.28689%,6:17.6006%,17:0.00356%,14:0.00059%,16:0.0002%,11:0.0002%]
[INFO] ** s_port:[1.45442:26.1618%,-0.32151:20.73187%,-1.27613:18.28629%,-0.23351:17.6002%,-0.33484:17.21389%,-71.33197:0.00356%,-0.24151:0.0002%,-1.2708:0.0002%,-64.19493:0.0002%,-1.02014:0.0002%,13.431270000000001:0.0002%,4.90362:0.0002%,-71.14798:0.0002%,1.47576:0.0002%,1.46509:0.0002%,-0.24950999999999998:0.0002%,-1.27347:0.0002%,-68.36943000000001:0.0002%]
[INFO] ** scada_tag:[3:26.1616%,1:20.73167%,5:18.2861%,4:17.59981%,2:17.21369%,0:0.00713%]
[INFO] ** service:[0.0048200000000000005:99.99545%,-211.73542999999998:0.00356%,-186.44547:0.0002%,-211.08346:0.0002%,-186.43601999999998:0.0002%,-201.23771000000002:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:37.94576%,9:26.1622%,7:18.28689%,1:17.6006%,14:0.00356%,2:0.00059%,15:0.0002%,10:0.0002%]
[INFO] ** type:[0:99.99901%,1:0.00099%]
[INFO] ** unixtime:1383 (0.27384%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0125 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3706e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0026 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.1091e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0025 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2282e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0023 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0551 - val_tp: 17432.0000 - val_fp: 2568.0000 - val_tn: 77432.0000 - val_fn: 2568.0000 - val_accuracy: 0.9486 - val_precision: 0.8716 - val_recall: 0.8716 - val_auc: 0.9197
[INFO] saving weights to checkpoints/lstm-epoch-8-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.4751 - tp: 51188.0000 - fp: 28812.0000 - tn: 291188.0000 - fn: 28812.0000 - accuracy: 0.8559 - precision: 0.6399 - recall: 0.6399 - auc: 0.8943 - val_loss: 0.7424 - val_tp: 12793.0000 - val_fp: 7207.0000 - val_tn: 72793.0000 - val_fn: 7207.0000 - val_accuracy: 0.8559 - val_precision: 0.6396 - val_recall: 0.6396 - val_auc: 0.9383
[INFO] saving weights to checkpoints/lstm-epoch-8-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 7-7/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99525%,30:0.00139%,22:0.00099%,17:0.00079%,26:0.00059%,31:0.0004%,28:0.0002%,27:0.0002%,7:0.0002%]
[INFO] ** classification:[normal:82.5285%,Single Stage Single Point:17.4715%]
[INFO] ** dst:[21:43.35886%,10:20.75583%,8:18.24313%,9:17.63564%,6:0.00158%,22:0.00139%,15:0.00139%,16:0.00079%,24:0.0004%,18:0.0004%,17:0.0004%,7:0.0002%]
[INFO] ** i/f_dir:[1:99.99861%,0:0.00139%]
[INFO] ** i/f_name:[2:99.99861%,3:0.00139%]
[INFO] ** modbus_function_code:[0.02961:99.99525%,-33.760870000000004:0.00475%]
[INFO] ** modbus_function_description:[7:49.99842%,11:49.99683%,0:0.00475%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99644%,2:0.00218%,1:0.00139%]
[INFO] ** proxy_src_ip:[18:37.98378%,20:26.13171%,13:18.24352%,6:17.63584%,17:0.00139%,11:0.00079%,1:0.00079%,21:0.00059%,16:0.0004%,14:0.0004%,7:0.0004%,10:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:26.13072%,-0.32151:20.75583%,-1.27613:18.24293%,-0.23351:17.63545%,-0.33484:17.22795%,-71.33197:0.00139%,-71.14931:0.00099%,-71.14798:0.00059%,1.45709:0.00059%,-1.02014:0.0004%,-1.27347:0.0004%,-0.24151:0.0004%,-58.035180000000004:0.0002%,-1.2708:0.0002%,-5.1466400000000005:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-5.08665:0.0002%,14.253910000000001:0.0002%,-68.79874000000001:0.0002%,6.1115699999999995:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** scada_tag:[3:26.13032%,1:20.75583%,5:18.24293%,4:17.63525%,2:17.22795%,0:0.00772%]
[INFO] ** service:[0.0048200000000000005:99.99525%,-211.73542999999998:0.00139%,-211.08818:0.00099%,-205.44247:0.00079%,-211.08346:0.00059%,-186.43601999999998:0.0004%,-211.09762999999998:0.0002%,-185.9872:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:37.98378%,9:26.13171%,7:18.24352%,1:17.63584%,14:0.00139%,10:0.00079%,3:0.00079%,4:0.00059%,21:0.0004%,15:0.0004%,2:0.0004%,11:0.0002%,8:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1380 (0.27325%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4704 - tp: 62823.0000 - fp: 17177.0000 - tn: 302823.0000 - fn: 17177.0000 - accuracy: 0.9141 - precision: 0.7853 - recall: 0.7853 - auc: 0.9623 - val_loss: 0.1740 - val_tp: 19113.0000 - val_fp: 887.0000 - val_tn: 79113.0000 - val_fn: 887.0000 - val_accuracy: 0.9823 - val_precision: 0.9556 - val_recall: 0.9556 - val_auc: 0.9944
[INFO] saving weights to checkpoints/lstm-epoch-8-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1391 - tp: 75340.0000 - fp: 4660.0000 - tn: 315340.0000 - fn: 4660.0000 - accuracy: 0.9767 - precision: 0.9417 - recall: 0.9417 - auc: 0.9969 - val_loss: 0.0664 - val_tp: 19273.0000 - val_fp: 727.0000 - val_tn: 79273.0000 - val_fn: 727.0000 - val_accuracy: 0.9855 - val_precision: 0.9636 - val_recall: 0.9636 - val_auc: 0.9996
[INFO] saving weights to checkpoints/lstm-epoch-8-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4039 - tp: 65782.0000 - fp: 14218.0000 - tn: 305782.0000 - fn: 14218.0000 - accuracy: 0.9289 - precision: 0.8223 - recall: 0.8223 - auc: 0.9773 - val_loss: 0.2364 - val_tp: 17924.0000 - val_fp: 2076.0000 - val_tn: 77924.0000 - val_fn: 2076.0000 - val_accuracy: 0.9585 - val_precision: 0.8962 - val_recall: 0.8962 - val_auc: 0.9925
[INFO] saving weights to checkpoints/lstm-epoch-8-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0442 - tp: 79622.0000 - fp: 378.0000 - tn: 319622.0000 - fn: 378.0000 - accuracy: 0.9981 - precision: 0.9953 - recall: 0.9953 - auc: 0.9999 - val_loss: 0.0101 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0218 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0058 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 8-8/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99703%,30:0.00099%,0:0.00059%,24:0.0002%,23:0.0002%,22:0.0002%,18:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** classification:[normal:94.34137%,Single Stage Single Point:5.65863%]
[INFO] ** dst:[21:43.4343%,10:20.81365%,8:18.16927%,9:17.57901%,22:0.00139%,15:0.00099%,25:0.00059%,19:0.0004%,26:0.0002%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.99941%,0:0.00059%]
[INFO] ** i/f_name:[2:99.99901%,3:0.00099%]
[INFO] ** modbus_function_code:[0.02961:99.99703%,-33.760870000000004:0.00277%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9996%,11:49.99743%,0:0.00277%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:99.9996%,2:0.0004%]
[INFO] ** proto:[0:99.99822%,1:0.00099%,2:0.00079%]
[INFO] ** proxy_src_ip:[18:38.1008%,20:26.14774%,13:18.16848%,6:17.57941%,10:0.00119%,17:0.00099%,16:0.00059%,14:0.0004%,11:0.0002%,5:0.0002%]
[INFO] ** s_port:[1.45442:26.14715%,-0.32151:20.81365%,-1.27613:18.16828%,-0.23351:17.57882%,-0.33484:17.28715%,-71.33197:0.00099%,-15.039579999999999:0.00079%,-1.02014:0.00059%,-64.19493:0.00059%,1.45709:0.0004%,-0.24151:0.0004%,4.66896:0.0004%,-1.27347:0.0002%,-0.24950999999999998:0.0002%,1.47576:0.0002%,-71.14931:0.0002%]
[INFO] ** scada_tag:[3:26.14675%,1:20.81345%,5:18.16828%,4:17.57862%,2:17.28695%,0:0.00594%]
[INFO] ** service:[0.0048200000000000005:99.99782%,-211.73542999999998:0.00099%,-186.44547:0.00059%,-211.07873999999998:0.0004%,-211.08818:0.0002%]
[INFO] ** src:[22:38.1008%,9:26.14774%,7:18.16848%,1:17.57941%,11:0.00119%,15:0.00059%,14:0.00059%,21:0.0004%,2:0.0004%,16:0.0002%,10:0.0002%]
[INFO] ** type:[0:99.99941%,1:0.0004%,2:0.0002%]
[INFO] ** unixtime:1384 (0.27404%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0166 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0038 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0141 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0025 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0118 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0016 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2558 - tp: 74051.0000 - fp: 5949.0000 - tn: 314051.0000 - fn: 5949.0000 - accuracy: 0.9703 - precision: 0.9256 - recall: 0.9256 - auc: 0.9896 - val_loss: 0.3374 - val_tp: 16360.0000 - val_fp: 3640.0000 - val_tn: 76360.0000 - val_fn: 3640.0000 - val_accuracy: 0.9272 - val_precision: 0.8180 - val_recall: 0.8180 - val_auc: 0.9872
[INFO] saving weights to checkpoints/lstm-epoch-8-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2428 - tp: 70415.0000 - fp: 9585.0000 - tn: 310415.0000 - fn: 9585.0000 - accuracy: 0.9521 - precision: 0.8802 - recall: 0.8802 - auc: 0.9903 - val_loss: 0.1640 - val_tp: 18567.0000 - val_fp: 1433.0000 - val_tn: 78567.0000 - val_fn: 1433.0000 - val_accuracy: 0.9713 - val_precision: 0.9283 - val_recall: 0.9283 - val_auc: 0.9959
[INFO] saving weights to checkpoints/lstm-epoch-8-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 9-9/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99842%,30:0.00079%,31:0.0004%,26:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:95.96007%,Single Stage Single Point:4.03993%]
[INFO] ** dst:[21:43.36362%,10:20.76811%,8:18.29837%,9:17.56733%,22:0.00079%,15:0.00079%,18:0.0004%,25:0.0002%,24:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99921%,0:0.00079%]
[INFO] ** i/f_name:[2:99.99921%,3:0.00079%]
[INFO] ** modbus_function_code:[0.02961:99.99842%,-33.760870000000004:0.00158%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99842%,0:0.00158%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99842%,2:0.00079%,1:0.00079%]
[INFO] ** proxy_src_ip:[18:37.99863%,20:26.13369%,13:18.29857%,6:17.56753%,17:0.00079%,21:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:26.13289%,-0.32151:20.76811%,-1.27613:18.29817%,-0.23351:17.56713%,-0.33484:17.23052%,-71.33197:0.00079%,1.45709:0.0004%,-0.24151:0.0004%,-0.08551:0.0004%,-71.14798:0.0002%,-1.27347:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-64.19493:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:26.1325%,1:20.76811%,5:18.29817%,4:17.56694%,2:17.23052%,0:0.00376%]
[INFO] ** service:[0.0048200000000000005:99.99842%,-211.73542999999998:0.00079%,-186.43601999999998:0.0004%,-186.44547:0.0002%,-211.08346:0.0002%]
[INFO] ** src:[22:37.99863%,9:26.13369%,7:18.29857%,1:17.56753%,14:0.00079%,17:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1381 (0.27345%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1528 - tp: 75103.0000 - fp: 4897.0000 - tn: 315103.0000 - fn: 4897.0000 - accuracy: 0.9755 - precision: 0.9388 - recall: 0.9388 - auc: 0.9959 - val_loss: 0.0772 - val_tp: 19478.0000 - val_fp: 522.0000 - val_tn: 79478.0000 - val_fn: 522.0000 - val_accuracy: 0.9896 - val_precision: 0.9739 - val_recall: 0.9739 - val_auc: 0.9989
[INFO] saving weights to checkpoints/lstm-epoch-8-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1210 - tp: 77782.0000 - fp: 2218.0000 - tn: 317782.0000 - fn: 2218.0000 - accuracy: 0.9889 - precision: 0.9723 - recall: 0.9723 - auc: 0.9964 - val_loss: 0.0402 - val_tp: 19992.0000 - val_fp: 8.0000 - val_tn: 79992.0000 - val_fn: 8.0000 - val_accuracy: 0.9998 - val_precision: 0.9996 - val_recall: 0.9996 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0223 - tp: 79997.0000 - fp: 3.0000 - tn: 319997.0000 - fn: 3.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0048 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0109 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0031 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0088 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0021 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 10-10/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99644%,30:0.00198%,24:0.0002%,23:0.0002%,22:0.0002%,18:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:93.9511%,Single Stage Single Point:6.0489%]
[INFO] ** dst:[21:43.4147%,10:20.81206%,8:18.21917%,9:17.5503%,15:0.00198%,22:0.00059%,24:0.0004%,19:0.0004%,26:0.0002%,25:0.0002%]
[INFO] ** i/f_dir:[1:99.99822%,0:0.00178%]
[INFO] ** i/f_name:[2:99.99802%,3:0.00198%]
[INFO] ** modbus_function_code:[0.02961:99.99644%,-33.760870000000004:0.00337%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.99901%,11:49.99743%,0:0.00337%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:99.99921%,1:0.00079%]
[INFO] ** proto:[0:99.99762%,1:0.00198%,2:0.0004%]
[INFO] ** proxy_src_ip:[18:38.09843%,20:26.12874%,13:18.21937%,6:17.54971%,17:0.00198%,10:0.00099%,14:0.0004%,16:0.0002%,5:0.0002%]
[INFO] ** s_port:[1.45442:26.12814%,-0.32151:20.81206%,-1.27613:18.21877%,-0.23351:17.54931%,-0.33484:17.28636%,-71.33197:0.00198%,-10.51843:0.00079%,5.71692:0.0004%,-1.27347:0.0004%,1.46509:0.0002%,1.47576:0.0002%,-0.24950999999999998:0.0002%,1.45709:0.0002%,-0.24151:0.0002%,-71.14931:0.0002%,-1.02014:0.0002%,-64.19493:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:26.12775%,1:20.81187%,5:18.21877%,4:17.54912%,2:17.28616%,0:0.00634%]
[INFO] ** service:[0.0048200000000000005:99.99723%,-211.73542999999998:0.00198%,-211.07873999999998:0.0004%,-186.44547:0.0002%,-211.08818:0.0002%]
[INFO] ** src:[22:38.09843%,9:26.12874%,7:18.21937%,1:17.54971%,14:0.00198%,11:0.00099%,2:0.0004%,16:0.0002%,15:0.0002%]
[INFO] ** type:[0:99.99842%,1:0.00139%,2:0.0002%]
[INFO] ** unixtime:1380 (0.27325%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0069 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0015 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0045 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8199 - val_tp: 14586.0000 - val_fp: 5414.0000 - val_tn: 74586.0000 - val_fn: 5414.0000 - val_accuracy: 0.8917 - val_precision: 0.7293 - val_recall: 0.7293 - val_auc: 0.8462
[INFO] saving weights to checkpoints/lstm-epoch-8-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5652 - tp: 63574.0000 - fp: 16426.0000 - tn: 303574.0000 - fn: 16426.0000 - accuracy: 0.9179 - precision: 0.7947 - recall: 0.7947 - auc: 0.9716 - val_loss: 0.7581 - val_tp: 12863.0000 - val_fp: 7137.0000 - val_tn: 72863.0000 - val_fn: 7137.0000 - val_accuracy: 0.8573 - val_precision: 0.6431 - val_recall: 0.6431 - val_auc: 0.9675
[INFO] saving weights to checkpoints/lstm-epoch-8-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0526 - tp: 79106.0000 - fp: 894.0000 - tn: 319106.0000 - fn: 894.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9994 - val_loss: 0.0068 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0145 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0025 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 11-11/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99881%,31:0.0004%,30:0.0004%,26:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.38005%,10:20.87998%,8:18.20056%,9:17.53684%,22:0.00139%,18:0.0004%,15:0.0004%,25:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.9996%,0:0.0004%]
[INFO] ** i/f_name:[2:99.9996%,3:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.99881%,-33.760870000000004:0.00119%]
[INFO] ** modbus_function_description:[7:50.0004%,11:49.99842%,0:0.00119%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99881%,2:0.00079%,1:0.0004%]
[INFO] ** proxy_src_ip:[18:38.14733%,20:26.11329%,13:18.20036%,6:17.53724%,16:0.00059%,17:0.0004%,21:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:26.1127%,-0.32151:20.87998%,-1.27613:18.20036%,-0.23351:17.53664%,-0.33484:17.26735%,-0.24151:0.00059%,-1.02014:0.00059%,-0.08551:0.0004%,-71.33197:0.0004%,-71.14798:0.0002%,1.45709:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-64.19493:0.0002%]
[INFO] ** scada_tag:[3:26.1123%,1:20.87998%,5:18.20016%,4:17.53644%,2:17.26715%,0:0.00396%]
[INFO] ** service:[0.0048200000000000005:99.99881%,-211.73542999999998:0.0004%,-186.43601999999998:0.0004%,-186.44547:0.0002%,-211.08346:0.0002%]
[INFO] ** src:[22:38.14733%,9:26.11329%,7:18.20036%,1:17.53724%,15:0.00059%,14:0.0004%,17:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1381 (0.27345%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0085 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.3379e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0062 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3754e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0053 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1917e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0046 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0357e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0041 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7163e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 12-12/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99762%,30:0.00218%,9:0.0002%]
[INFO] ** classification:[normal:92.83395%,Single Stage Single Point:7.16605%]
[INFO] ** dst:[21:43.38876%,10:20.87305%,8:18.19541%,9:17.53941%,15:0.00218%,22:0.00059%,24:0.0004%,0:0.0002%]
[INFO] ** i/f_dir:[1:99.99822%,0:0.00178%]
[INFO] ** i/f_name:[2:99.99782%,3:0.00218%]
[INFO] ** modbus_function_code:[0.02961:99.99762%,-33.760870000000004:0.00238%]
[INFO] ** modbus_function_description:[7:49.9996%,11:49.99802%,0:0.00238%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:99.99822%,2:0.00178%]
[INFO] ** proto:[0:99.99782%,1:0.00218%]
[INFO] ** proxy_src_ip:[18:38.13822%,20:26.12398%,13:18.19561%,6:17.53961%,17:0.00218%,16:0.0002%,1:0.0002%]
[INFO] ** s_port:[1.45442:26.12339%,-0.32151:20.87305%,-1.27613:18.19501%,-0.23351:17.53922%,-0.33484:17.26517%,-71.33197:0.00218%,-1.27347:0.0004%,1.45709:0.0002%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,14.4699:0.0002%,-0.24151:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:26.12299%,1:20.87305%,5:18.19501%,4:17.53882%,2:17.26517%,0:0.00495%]
[INFO] ** service:[0.0048200000000000005:99.99762%,-211.73542999999998:0.00218%,-183.8612:0.0002%]
[INFO] ** src:[22:38.13822%,9:26.12398%,7:18.19561%,1:17.53961%,21:0.00178%,14:0.0004%,15:0.0002%,3:0.0002%]
[INFO] ** type:[0:99.9996%,1:0.0004%]
[INFO] ** unixtime:1381 (0.27345%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0040 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2957e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0038 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1713 - val_tp: 18489.0000 - val_fp: 1511.0000 - val_tn: 78489.0000 - val_fn: 1511.0000 - val_accuracy: 0.9698 - val_precision: 0.9244 - val_recall: 0.9244 - val_auc: 0.9528
[INFO] saving weights to checkpoints/lstm-epoch-8-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5344 - tp: 65780.0000 - fp: 14220.0000 - tn: 305780.0000 - fn: 14220.0000 - accuracy: 0.9289 - precision: 0.8223 - recall: 0.8223 - auc: 0.9733 - val_loss: 0.3204 - val_tp: 18924.0000 - val_fp: 1076.0000 - val_tn: 78924.0000 - val_fn: 1076.0000 - val_accuracy: 0.9785 - val_precision: 0.9462 - val_recall: 0.9462 - val_auc: 0.9812
[INFO] saving weights to checkpoints/lstm-epoch-8-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1233 - tp: 78048.0000 - fp: 1952.0000 - tn: 318048.0000 - fn: 1952.0000 - accuracy: 0.9902 - precision: 0.9756 - recall: 0.9756 - auc: 0.9946 - val_loss: 0.0035 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0150 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0014 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 13-13/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99624%,31:0.00079%,26:0.00059%,0:0.00059%,30:0.0004%,22:0.0004%,27:0.0002%,24:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** classification:[normal:84.84993%,Single Stage Single Point:15.15007%]
[INFO] ** dst:[21:43.36124%,10:20.80018%,8:18.27877%,9:17.55545%,22:0.00119%,6:0.00099%,18:0.00079%,25:0.00059%,15:0.0004%,24:0.0002%,7:0.0002%]
[INFO] ** i/f_dir:[1:99.9996%,0:0.0004%]
[INFO] ** i/f_name:[2:99.9996%,3:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.99624%,-33.760870000000004:0.00356%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.99881%,11:49.99743%,0:0.00356%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99703%,2:0.00257%,1:0.0004%]
[INFO] ** proxy_src_ip:[18:38.0515%,20:26.11032%,13:18.27897%,6:17.55486%,10:0.00119%,11:0.00099%,16:0.00059%,17:0.0004%,7:0.0004%,21:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:26.10973%,-0.32151:20.80018%,-1.27613:18.27857%,-0.23351:17.55446%,-0.33484:17.25131%,-9.78512:0.00079%,-71.14798:0.00059%,-64.19493:0.00059%,-1.02014:0.00059%,-0.08551:0.0004%,-71.14931:0.0004%,-0.24151:0.0004%,-71.33197:0.0004%,-1.27347:0.0002%,1.46509:0.0002%,-68.79874000000001:0.0002%,14.540560000000001:0.0002%,1.45709:0.0002%,-1.2708:0.0002%,6.1115699999999995:0.0002%,1.47576:0.0002%]
[INFO] ** scada_tag:[3:26.10933%,1:20.79999%,5:18.27857%,4:17.55446%,2:17.25112%,0:0.00653%]
[INFO] ** service:[0.0048200000000000005:99.99703%,-186.43601999999998:0.00079%,-186.44547:0.00059%,-211.08346:0.00059%,-211.73542999999998:0.0004%,-211.08818:0.0004%,-202.75898:0.0002%]
[INFO] ** src:[22:38.0515%,9:26.11032%,7:18.27897%,1:17.55486%,11:0.00119%,10:0.00099%,15:0.00059%,21:0.0004%,14:0.0004%,17:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** unixtime:1380 (0.27325%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0101 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.7804e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0079 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9189e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0065 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0836 - val_tp: 16864.0000 - val_fp: 3136.0000 - val_tn: 76864.0000 - val_fn: 3136.0000 - val_accuracy: 0.9373 - val_precision: 0.8432 - val_recall: 0.8432 - val_auc: 0.9020
[INFO] saving weights to checkpoints/lstm-epoch-8-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3612 - tp: 70487.0000 - fp: 9513.0000 - tn: 310487.0000 - fn: 9513.0000 - accuracy: 0.9524 - precision: 0.8811 - recall: 0.8811 - auc: 0.9828 - val_loss: 0.0100 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0659 - tp: 77508.0000 - fp: 2492.0000 - tn: 317508.0000 - fn: 2492.0000 - accuracy: 0.9875 - precision: 0.9689 - recall: 0.9689 - auc: 0.9995 - val_loss: 0.0016 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 14-14/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.9996%,30:0.0002%,9:0.0002%]
[INFO] ** classification:[normal:96.19234%,Single Stage Single Point:3.80766%]
[INFO] ** dst:[21:43.34441%,10:20.80929%,8:18.27204%,9:17.57268%,22:0.00079%,24:0.0004%,15:0.0002%,0:0.0002%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:99.9998%,3:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9996%,-33.760870000000004:0.0004%]
[INFO] ** modbus_function_description:[7:50.00059%,11:49.99901%,0:0.0004%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9998%,1:0.0002%]
[INFO] ** proxy_src_ip:[18:38.04635%,20:26.10795%,13:18.27224%,6:17.57288%,17:0.0002%,16:0.0002%,1:0.0002%]
[INFO] ** s_port:[1.45442:26.10715%,-0.32151:20.80929%,-1.27613:18.27164%,-0.23351:17.57248%,-0.33484:17.23706%,-1.27347:0.0004%,1.45709:0.0004%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,14.4699:0.0002%,-0.24151:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%,-71.33197:0.0002%]
[INFO] ** scada_tag:[3:26.10676%,1:20.80929%,5:18.27144%,4:17.57208%,2:17.23686%,0:0.00356%]
[INFO] ** service:[0.0048200000000000005:99.9996%,-183.8612:0.0002%,-211.73542999999998:0.0002%]
[INFO] ** src:[22:38.04635%,9:26.10795%,7:18.27224%,1:17.57288%,15:0.0002%,14:0.0002%,3:0.0002%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** unixtime:1380 (0.27325%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3312 - tp: 68004.0000 - fp: 11996.0000 - tn: 308004.0000 - fn: 11996.0000 - accuracy: 0.9400 - precision: 0.8500 - recall: 0.8500 - auc: 0.9827 - val_loss: 0.3580 - val_tp: 12928.0000 - val_fp: 7072.0000 - val_tn: 72928.0000 - val_fn: 7072.0000 - val_accuracy: 0.8586 - val_precision: 0.6464 - val_recall: 0.6464 - val_auc: 0.9676
[INFO] saving weights to checkpoints/lstm-epoch-8-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0457 - tp: 79247.0000 - fp: 753.0000 - tn: 319247.0000 - fn: 753.0000 - accuracy: 0.9962 - precision: 0.9906 - recall: 0.9906 - auc: 0.9999 - val_loss: 0.0033 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0131 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.4188e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0097 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9296e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0082 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5021e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 15-15/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99604%,30:0.00317%,26:0.0002%,17:0.0002%,12:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:89.0641%,Single Stage Multi Point:10.93511%,Single Stage Single Point:0.00079%]
[INFO] ** dst:[21:43.2953%,10:20.76949%,8:18.31797%,9:17.61169%,15:0.00317%,22:0.00158%,25:0.0002%,24:0.0002%,16:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99683%,0:0.00317%]
[INFO] ** i/f_name:[2:99.99683%,3:0.00317%]
[INFO] ** modbus_function_code:[0.02961:99.99604%,-33.760870000000004:0.00396%]
[INFO] ** modbus_function_description:[7:49.99901%,11:49.99703%,0:0.00396%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:99.99703%,2:0.00297%]
[INFO] ** proto:[0:99.99644%,1:0.00317%,2:0.0004%]
[INFO] ** proxy_src_ip:[18:38.00259%,20:26.0628%,13:18.31778%,6:17.61228%,17:0.00317%,16:0.00059%,7:0.0004%,5:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:26.06201%,-0.32151:20.76929%,-1.27613:18.31758%,-0.23351:17.61149%,-0.33484:17.2333%,-71.33197:0.00317%,-1.02014:0.00059%,-0.24151:0.00059%,1.45709:0.0004%,-64.19493:0.0002%,-61.95768:0.0002%,-71.14798:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,10.192739999999999:0.0002%,-0.24950999999999998:0.0002%,1.46509:0.0002%]
[INFO] ** scada_tag:[3:26.06161%,1:20.7691%,5:18.31758%,4:17.61109%,2:17.2331%,0:0.00752%]
[INFO] ** service:[0.0048200000000000005:99.99624%,-211.73542999999998:0.00317%,-186.44547:0.0002%,-211.08346:0.0002%,-205.44247:0.0002%]
[INFO] ** src:[22:38.00259%,9:26.0628%,7:18.31778%,1:17.61228%,21:0.00337%,15:0.00059%,16:0.0002%,14:0.0002%,8:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1388 (0.27483%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0074 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.5392e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0065 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2941e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0058 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3984e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0051 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8862 - val_tp: 13937.0000 - val_fp: 6063.0000 - val_tn: 73937.0000 - val_fn: 6063.0000 - val_accuracy: 0.8787 - val_precision: 0.6969 - val_recall: 0.6969 - val_auc: 0.8105
[INFO] saving weights to checkpoints/lstm-epoch-8-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5400 - tp: 42589.0000 - fp: 37411.0000 - tn: 282589.0000 - fn: 37411.0000 - accuracy: 0.8129 - precision: 0.5324 - recall: 0.5324 - auc: 0.7038 - val_loss: 7.5667 - val_tp: 10611.0000 - val_fp: 9389.0000 - val_tn: 70611.0000 - val_fn: 9389.0000 - val_accuracy: 0.8122 - val_precision: 0.5306 - val_recall: 0.5306 - val_auc: 0.7066
[INFO] saving weights to checkpoints/lstm-epoch-8-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 16-16/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (444724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (444724, 17)

[INFO] analyzing data
[INFO] 444724 rows
[INFO] ** appi_name:[21:99.99865%,30:0.00112%,33:0.00022%]
[INFO] ** classification:[normal:84.06382%,Single Stage Multi Point:15.93618%]
[INFO] ** dst:[21:43.35993%,10:20.79739%,8:18.24997%,9:17.59024%,22:0.00112%,15:0.00112%,24:0.00022%]
[INFO] ** i/f_dir:[1:99.99888%,0:0.00112%]
[INFO] ** i/f_name:[2:99.99888%,3:0.00112%]
[INFO] ** modbus_function_code:[0.02961:99.99865%,-33.760870000000004:0.00135%]
[INFO] ** modbus_function_description:[7:50.00045%,11:49.9982%,0:0.00135%]
[INFO] ** modbus_transaction_id:65536 (14.73633%)
[INFO] ** orig:[0:99.99888%,2:0.00112%]
[INFO] ** proto:[0:99.99888%,1:0.00112%]
[INFO] ** proxy_src_ip:[18:38.04967%,20:26.10788%,13:18.25042%,6:17.59024%,17:0.00112%,16:0.00045%,21:0.00022%]
[INFO] ** s_port:[1.45442:26.1072%,-0.32151:20.79717%,-1.27613:18.24997%,-0.23351:17.59001%,-0.33484:17.2525%,-71.33197:0.00112%,1.45709:0.00045%,-1.02014:0.00045%,-1.27347:0.00022%,1.47576:0.00022%,-49.275529999999996:0.00022%,-0.24151:0.00022%,-1.2708:0.00022%]
[INFO] ** scada_tag:[3:26.10675%,1:20.79717%,5:18.24975%,4:17.58956%,2:17.2525%,0:0.00427%]
[INFO] ** service:[0.0048200000000000005:99.99888%,-211.73542999999998:0.00112%]
[INFO] ** src:[22:38.04967%,9:26.10788%,7:18.25042%,1:17.59024%,21:0.00112%,15:0.00045%,4:0.00022%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1215 (0.2732%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/444724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5608 - tp: 42485.0000 - fp: 37515.0000 - tn: 282485.0000 - fn: 37515.0000 - accuracy: 0.8124 - precision: 0.5311 - recall: 0.5311 - auc: 0.7036 - val_loss: 7.5505 - val_tp: 10631.0000 - val_fp: 9369.0000 - val_tn: 70631.0000 - val_fn: 9369.0000 - val_accuracy: 0.8126 - val_precision: 0.5315 - val_recall: 0.5315 - val_auc: 0.7072
[INFO] saving weights to checkpoints/lstm-epoch-8-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/444724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.8360 - tp: 56012.0000 - fp: 23988.0000 - tn: 296012.0000 - fn: 23988.0000 - accuracy: 0.8801 - precision: 0.7002 - recall: 0.7002 - auc: 0.8109 - val_loss: 4.1667e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/444724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0037 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4875e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/444724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0034 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5179e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/444724
[33m[INFO] loading file 17-17/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544724, 17)

[INFO] analyzing data
[INFO] 544724 rows
[INFO] ** appi_name:[21:99.99706%,7:0.00055%,26:0.00037%,0:0.00037%,33:0.00018%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:94.33658%,Multi Stage Multi Point:5.66342%]
[INFO] ** dst:[21:43.34654%,10:20.85038%,8:18.20059%,9:17.59956%,22:0.00073%,6:0.00055%,25:0.00037%,16:0.00037%,2:0.00037%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99706%,-33.760870000000004:0.00275%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99945%,11:49.99761%,0:0.00275%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (12.03105%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99871%,2:0.00129%]
[INFO] ** proxy_src_ip:[18:38.08387%,20:26.11359%,13:18.20004%,6:17.59937%,10:0.0011%,11:0.00092%,1:0.00037%,21:0.00018%,16:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.11267%,-0.32151:20.85019%,-1.27613:18.19968%,-0.23351:17.59919%,-0.33484:17.23368%,6.0369:0.00073%,1.47576:0.00037%,-71.14798:0.00037%,1.45709:0.00037%,-64.19493:0.00037%,1.46509:0.00018%,-68.79874000000001:0.00018%,-49.275529999999996:0.00018%,-1.27347:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,6.15557:0.00018%,6.06224:0.00018%,8.55414:0.00018%,-3.3787199999999995:0.00018%,-4.3880099999999995:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.11249%,1:20.85001%,5:18.19949%,4:17.59882%,2:17.23368%,0:0.00551%]
[INFO] ** service:[0.0048200000000000005:99.99798%,-211.09762999999998:0.00055%,-211.08346:0.00037%,-186.44547:0.00037%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.08387%,9:26.11359%,7:18.20004%,1:17.59937%,11:0.0011%,10:0.00092%,3:0.00037%,21:0.00018%,15:0.00018%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1488 (0.27317%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0031 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.1307e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0027 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.1205e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0024 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.0477e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.1118 - tp: 69528.0000 - fp: 10472.0000 - tn: 309528.0000 - fn: 10472.0000 - accuracy: 0.9476 - precision: 0.8691 - recall: 0.8691 - auc: 0.9177 - val_loss: 2.9456 - val_tp: 16345.0000 - val_fp: 3655.0000 - val_tn: 76345.0000 - val_fn: 3655.0000 - val_accuracy: 0.9269 - val_precision: 0.8173 - val_recall: 0.8173 - val_auc: 0.8858
[INFO] saving weights to checkpoints/lstm-epoch-8-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9145 - tp: 65542.0000 - fp: 14458.0000 - tn: 305542.0000 - fn: 14458.0000 - accuracy: 0.9277 - precision: 0.8193 - recall: 0.8193 - auc: 0.8864 - val_loss: 1.8254 - val_tp: 17735.0000 - val_fp: 2265.0000 - val_tn: 77735.0000 - val_fn: 2265.0000 - val_accuracy: 0.9547 - val_precision: 0.8867 - val_recall: 0.8867 - val_auc: 0.9292
[INFO] saving weights to checkpoints/lstm-epoch-8-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/544724
[33m[INFO] loading file 18-18/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544724, 17)

[INFO] analyzing data
[INFO] 544724 rows
[INFO] ** appi_name:[21:99.99816%,30:0.00055%,7:0.00055%,31:0.00018%,27:0.00018%,22:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:82.19318%,Multi Stage Multi Point:17.80682%]
[INFO] ** dst:[21:43.33791%,10:20.83349%,8:18.26448%,9:17.56119%,22:0.00073%,15:0.00055%,24:0.00037%,16:0.00037%,2:0.00037%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99945%,0:0.00055%]
[INFO] ** i/f_name:[2:99.99945%,3:0.00055%]
[INFO] ** modbus_function_code:[0.02961:99.99816%,-33.760870000000004:0.00184%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99798%,0:0.00184%]
[INFO] ** modbus_transaction_id:65536 (12.03105%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9989%,2:0.00055%,1:0.00055%]
[INFO] ** proxy_src_ip:[18:38.07469%,20:26.09725%,13:18.26485%,6:17.56137%,17:0.00055%,11:0.00055%,1:0.00037%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.09652%,-0.32151:20.83349%,-1.27613:18.2643%,-0.23351:17.561%,-0.33484:17.24121%,-71.33197:0.00055%,-1.27347:0.00037%,1.45709:0.00037%,-0.24151:0.00037%,1.47576:0.00018%,1.46509:0.00018%,3.6236699999999997:0.00018%,-1.2708:0.00018%,-2.48275:0.00018%,6.06224:0.00018%,-3.3787199999999995:0.00018%,8.10082:0.00018%,6.45955:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.09615%,1:20.8333%,5:18.26411%,4:17.56082%,2:17.24102%,0:0.00459%]
[INFO] ** service:[0.0048200000000000005:99.99816%,-211.09762999999998:0.00055%,-211.73542999999998:0.00055%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.07469%,9:26.09725%,7:18.26485%,1:17.56137%,14:0.00055%,10:0.00055%,3:0.00037%,21:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1489 (0.27335%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2002 - tp: 74051.0000 - fp: 5949.0000 - tn: 314051.0000 - fn: 5949.0000 - accuracy: 0.9703 - precision: 0.9256 - recall: 0.9256 - auc: 0.9532 - val_loss: 6.1499 - val_tp: 12369.0000 - val_fp: 7631.0000 - val_tn: 72369.0000 - val_fn: 7631.0000 - val_accuracy: 0.8474 - val_precision: 0.6184 - val_recall: 0.6184 - val_auc: 0.7615
[INFO] saving weights to checkpoints/lstm-epoch-8-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1102 - tp: 49678.0000 - fp: 30322.0000 - tn: 289678.0000 - fn: 30322.0000 - accuracy: 0.8484 - precision: 0.6210 - recall: 0.6210 - auc: 0.7616 - val_loss: 6.1450 - val_tp: 12375.0000 - val_fp: 7625.0000 - val_tn: 72375.0000 - val_fn: 7625.0000 - val_accuracy: 0.8475 - val_precision: 0.6187 - val_recall: 0.6187 - val_auc: 0.7617
[INFO] saving weights to checkpoints/lstm-epoch-8-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1391 - tp: 49534.0000 - fp: 30466.0000 - tn: 289534.0000 - fn: 30466.0000 - accuracy: 0.8477 - precision: 0.6192 - recall: 0.6192 - auc: 0.7605 - val_loss: 6.1378 - val_tp: 12384.0000 - val_fp: 7616.0000 - val_tn: 72384.0000 - val_fn: 7616.0000 - val_accuracy: 0.8477 - val_precision: 0.6192 - val_recall: 0.6192 - val_auc: 0.7620
[INFO] saving weights to checkpoints/lstm-epoch-8-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.4900 - tp: 72611.0000 - fp: 7389.0000 - tn: 312611.0000 - fn: 7389.0000 - accuracy: 0.9631 - precision: 0.9076 - recall: 0.9076 - auc: 0.9419 - val_loss: 1.5886e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0012 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4547e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/544724
[33m[INFO] loading file 19-19/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544724, 17)

[INFO] analyzing data
[INFO] 544724 rows
[INFO] ** appi_name:[21:99.99798%,26:0.00037%,0:0.00037%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:86.86307%,Single Stage Multi Point:13.13693%]
[INFO] ** dst:[21:43.38234%,10:20.82486%,8:18.21877%,9:17.57128%,22:0.00129%,6:0.00055%,25:0.00037%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99798%,-33.760870000000004:0.00184%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99798%,0:0.00184%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (12.03105%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99871%,2:0.00129%]
[INFO] ** proxy_src_ip:[18:38.11141%,20:26.09597%,13:18.21877%,6:17.57128%,10:0.0011%,11:0.00092%,16:0.00055%]
[INFO] ** s_port:[1.45442:26.09487%,-0.32151:20.82486%,-1.27613:18.2184%,-0.23351:17.5711%,-0.33484:17.28655%,-5.20264:0.00073%,1.45709:0.00055%,-1.02014:0.00055%,-64.19493:0.00037%,-71.14798:0.00037%,1.46509:0.00037%,-1.27347:0.00018%,-0.24151:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-71.14931:0.00018%,-68.79874000000001:0.00018%,0.75578:0.00018%]
[INFO] ** scada_tag:[3:26.0945%,1:20.82467%,5:18.21822%,4:17.57092%,2:17.28637%,0:0.00532%]
[INFO] ** service:[0.0048200000000000005:99.99871%,-211.08346:0.00037%,-186.44547:0.00037%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.11141%,9:26.09597%,7:18.21877%,1:17.57128%,11:0.0011%,10:0.00092%,15:0.00055%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1490 (0.27353%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0010 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3961e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.6755e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3184e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.9288e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2684e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.5345 - tp: 72387.0000 - fp: 7613.0000 - tn: 312387.0000 - fn: 7613.0000 - accuracy: 0.9619 - precision: 0.9048 - recall: 0.9048 - auc: 0.9402 - val_loss: 9.7821 - val_tp: 7862.0000 - val_fp: 12138.0000 - val_tn: 67862.0000 - val_fn: 12138.0000 - val_accuracy: 0.7572 - val_precision: 0.3931 - val_recall: 0.3931 - val_auc: 0.6207
[INFO] saving weights to checkpoints/lstm-epoch-8-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.8428 - tp: 31148.0000 - fp: 48852.0000 - tn: 271148.0000 - fn: 48852.0000 - accuracy: 0.7557 - precision: 0.3893 - recall: 0.3893 - auc: 0.6160 - val_loss: 2.3831 - val_tp: 17043.0000 - val_fp: 2957.0000 - val_tn: 77043.0000 - val_fn: 2957.0000 - val_accuracy: 0.9409 - val_precision: 0.8522 - val_recall: 0.8522 - val_auc: 0.9076
[INFO] saving weights to checkpoints/lstm-epoch-8-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/544724
[33m[INFO] loading file 20-20/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544724, 17)

[INFO] analyzing data
[INFO] 544724 rows
[INFO] ** appi_name:[21:99.99651%,30:0.00294%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:92.47711%,Single Stage Multi Point:7.52289%]
[INFO] ** dst:[21:43.42621%,10:20.83569%,8:18.16424%,9:17.5689%,15:0.00294%,22:0.0011%,24:0.00037%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99743%,0:0.00257%]
[INFO] ** i/f_name:[2:99.99706%,3:0.00294%]
[INFO] ** modbus_function_code:[0.02961:99.99651%,-33.760870000000004:0.00349%]
[INFO] ** modbus_function_description:[7:49.99982%,11:49.9967%,0:0.00349%]
[INFO] ** modbus_transaction_id:65536 (12.03105%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99651%,1:0.00294%,2:0.00055%]
[INFO] ** proxy_src_ip:[18:38.11471%,20:26.14774%,13:18.16443%,6:17.56945%,17:0.00294%,14:0.00055%,16:0.00018%]
[INFO] ** s_port:[1.45442:26.147%,-0.32151:20.83569%,-1.27613:18.16388%,-0.23351:17.56871%,-0.33484:17.27903%,-71.33197:0.00294%,-0.24151:0.00055%,1.45709:0.00037%,-1.27347:0.00037%,13.431270000000001:0.00018%,-1.2708:0.00018%,-1.02014:0.00018%,-71.14798:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:26.14664%,1:20.83551%,5:18.16388%,4:17.56835%,2:17.27884%,0:0.00679%]
[INFO] ** service:[0.0048200000000000005:99.99651%,-211.73542999999998:0.00294%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.11471%,9:26.14774%,7:18.16443%,1:17.56945%,14:0.00294%,2:0.00055%,15:0.00018%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1489 (0.27335%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1687e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2183e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.8544 - tp: 65835.0000 - fp: 14165.0000 - tn: 305835.0000 - fn: 14165.0000 - accuracy: 0.9292 - precision: 0.8229 - recall: 0.8229 - auc: 0.8886 - val_loss: 2.9343 - val_tp: 16359.0000 - val_fp: 3641.0000 - val_tn: 76359.0000 - val_fn: 3641.0000 - val_accuracy: 0.9272 - val_precision: 0.8180 - val_recall: 0.8180 - val_auc: 0.8862
[INFO] saving weights to checkpoints/lstm-epoch-8-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9554 - tp: 65333.0000 - fp: 14667.0000 - tn: 305333.0000 - fn: 14667.0000 - accuracy: 0.9267 - precision: 0.8167 - recall: 0.8167 - auc: 0.8847 - val_loss: 2.9166 - val_tp: 16381.0000 - val_fp: 3619.0000 - val_tn: 76381.0000 - val_fn: 3619.0000 - val_accuracy: 0.9276 - val_precision: 0.8191 - val_recall: 0.8191 - val_auc: 0.8869
[INFO] saving weights to checkpoints/lstm-epoch-8-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.9850 - tp: 75113.0000 - fp: 4887.0000 - tn: 315113.0000 - fn: 4887.0000 - accuracy: 0.9756 - precision: 0.9389 - recall: 0.9389 - auc: 0.9616 - val_loss: 1.1989e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.7215e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1933e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/544724
[33m[INFO] loading file 21-21/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544722, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544722, 17)

[INFO] analyzing data
[INFO] 544722 rows
[INFO] ** appi_name:[21:99.99614%,30:0.00092%,7:0.00055%,26:0.00037%,22:0.00037%,0:0.00037%,31:0.00018%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:98.87961%,Multi Stage Single Point:1.12039%]
[INFO] ** dst:[21:43.30503%,10:20.98538%,8:18.17019%,9:17.53463%,22:0.00092%,15:0.00092%,24:0.00073%,6:0.00073%,25:0.00037%,16:0.00037%,2:0.00037%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99908%,0:0.00092%]
[INFO] ** i/f_name:[2:99.99908%,3:0.00092%]
[INFO] ** modbus_function_code:[0.02961:99.99614%,-33.760870000000004:0.00367%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.9989%,11:49.99725%,0:0.00367%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (12.03109%)
[INFO] ** orig:[0:99.99927%,2:0.00073%]
[INFO] ** proto:[0:99.99761%,2:0.00147%,1:0.00092%]
[INFO] ** proxy_src_ip:[18:38.31165%,20:25.97857%,13:18.17074%,6:17.53463%,10:0.0011%,17:0.00092%,11:0.00092%,16:0.00055%,1:0.00037%,21:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.97802%,-0.32151:20.98465%,-1.27613:18.17%,-0.23351:17.53445%,-0.33484:17.327%,-71.33197:0.00092%,-1.27347:0.00073%,-6.64392:0.00073%,-1.02014:0.00055%,-64.19493:0.00037%,-71.14931:0.00037%,-71.14798:0.00037%,1.47576:0.00018%,1.46509:0.00018%,6.62488:0.00018%,10.15141:0.00018%,-68.79874000000001:0.00018%,7.060860000000001:0.00018%,-3.3787199999999995:0.00018%,-2.2440900000000004:0.00018%,1.45709:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.97765%,1:20.98447%,5:18.16982%,4:17.53408%,2:17.327%,0:0.00698%]
[INFO] ** service:[0.0048200000000000005:99.99688%,-211.73542999999998:0.00092%,-211.09762999999998:0.00055%,-211.08346:0.00037%,-186.44547:0.00037%,-211.08818:0.00037%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.31165%,9:25.97857%,7:18.17074%,1:17.53463%,11:0.0011%,21:0.00092%,10:0.00092%,15:0.00055%,3:0.00037%,14:0.00018%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1483 (0.27225%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544722
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.3334e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/544722
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9605e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/544722
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.5937e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/544722
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.1506e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/544722
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.8684e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/544722
[33m[INFO] loading file 22-22/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (313763, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (313763, 17)

[INFO] analyzing data
[INFO] 313763 rows
[INFO] ** appi_name:[21:99.99235%,30:0.00669%,23:0.00032%,22:0.00032%,18:0.00032%]
[INFO] ** classification:[normal:57.7541%,Multi Stage Single Point:42.2459%]
[INFO] ** dst:[21:43.29892%,10:21.00726%,8:18.11208%,9:17.57282%,15:0.00669%,22:0.00127%,19:0.00064%,26:0.00032%]
[INFO] ** i/f_dir:[1:99.99363%,0:0.00637%]
[INFO] ** i/f_name:[2:99.99331%,3:0.00637%,0:0.00032%]
[INFO] ** modbus_function_code:[0.02961:99.99235%,-33.760870000000004:0.00765%]
[INFO] ** modbus_function_description:[7:49.99697%,11:49.99538%,0:0.00765%]
[INFO] ** modbus_transaction_id:65534 (20.88647%)
[INFO] ** orig:[0:99.9949%,2:0.00446%,1:0.00064%]
[INFO] ** proto:[0:99.99299%,1:0.00669%,2:0.00032%]
[INFO] ** proxy_src_ip:[18:38.33371%,20:25.97343%,13:18.11144%,6:17.57377%,17:0.00669%,14:0.00064%,10:0.00032%]
[INFO] ** s_port:[1.45442:25.97247%,-0.32151:21.00726%,-1.27613:18.11144%,-0.23351:17.57282%,-0.33484:17.32645%,-71.33197:0.00669%,1.45709:0.00064%,-0.24151:0.00064%,7.228860000000001:0.00064%,-0.24950999999999998:0.00032%,1.46509:0.00032%,-71.14931:0.00032%]
[INFO] ** scada_tag:[3:25.97215%,1:21.00726%,5:18.11144%,4:17.5725%,2:17.32645%,0:0.0102%]
[INFO] ** service:[0.0048200000000000005:99.99235%,-211.73542999999998:0.00669%,-211.07873999999998:0.00064%,-211.08818:0.00032%]
[INFO] ** src:[22:38.33371%,9:25.97343%,7:18.11144%,1:17.57377%,21:0.00446%,14:0.00223%,2:0.00064%,11:0.00032%]
[INFO] ** type:[0:99.99809%,1:0.00191%]
[INFO] ** unixtime:866 (0.276%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/313763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.5567 - tp: 57384.0000 - fp: 22616.0000 - tn: 297384.0000 - fn: 22616.0000 - accuracy: 0.8869 - precision: 0.7173 - recall: 0.7173 - auc: 0.8222 - val_loss: 7.5836 - val_tp: 10590.0000 - val_fp: 9410.0000 - val_tn: 70590.0000 - val_fn: 9410.0000 - val_accuracy: 0.8118 - val_precision: 0.5295 - val_recall: 0.5295 - val_auc: 0.7059
[INFO] saving weights to checkpoints/lstm-epoch-8-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/313763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5744 - tp: 42406.0000 - fp: 37594.0000 - tn: 282406.0000 - fn: 37594.0000 - accuracy: 0.8120 - precision: 0.5301 - recall: 0.5301 - auc: 0.7046 - val_loss: 7.6190 - val_tp: 10546.0000 - val_fp: 9454.0000 - val_tn: 70546.0000 - val_fn: 9454.0000 - val_accuracy: 0.8109 - val_precision: 0.5273 - val_recall: 0.5273 - val_auc: 0.7046
[INFO] saving weights to checkpoints/lstm-epoch-8-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/313763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5808 - tp: 42374.0000 - fp: 37626.0000 - tn: 282374.0000 - fn: 37626.0000 - accuracy: 0.8119 - precision: 0.5297 - recall: 0.5297 - auc: 0.7060 - val_loss: 7.5811 - val_tp: 10593.0000 - val_fp: 9407.0000 - val_tn: 70593.0000 - val_fn: 9407.0000 - val_accuracy: 0.8119 - val_precision: 0.5296 - val_recall: 0.5296 - val_auc: 0.7060
[INFO] saving weights to checkpoints/lstm-epoch-8-files-21-22-batch-200000-300000
[INFO] processing batch 300000-400000/313763
[33m[INFO] loading file 23-23/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513763, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513763, 17)

[INFO] analyzing data
[INFO] 513763 rows
[INFO] ** appi_name:[21:99.99903%,31:0.00039%,33:0.00019%,30:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:96.98694%,Multi Stage Single Point:3.01306%]
[INFO] ** dst:[21:43.33652%,10:20.99645%,8:18.13832%,9:17.52656%,22:0.00097%,24:0.00039%,18:0.00039%,25:0.00019%,15:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99903%,-33.760870000000004:0.00097%]
[INFO] ** modbus_function_description:[7:50.00049%,11:49.99854%,0:0.00097%]
[INFO] ** modbus_transaction_id:65536 (12.75608%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99922%,2:0.00058%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.34239%,20:25.99078%,13:18.13852%,6:17.52676%,16:0.00058%,21:0.00019%,17:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.99019%,-0.32151:20.99626%,-1.27613:18.13794%,-0.23351:17.52637%,-0.33484:17.34613%,-1.02014:0.00058%,-0.08551:0.00039%,-1.27347:0.00039%,1.47576:0.00019%,-49.275529999999996:0.00019%,1.46509:0.00019%,-0.24151:0.00019%,-0.24950999999999998:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%,1.45709:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.9898%,1:20.99626%,5:18.13774%,4:17.52617%,2:17.34594%,0:0.00409%]
[INFO] ** service:[0.0048200000000000005:99.99922%,-186.43601999999998:0.00039%,-186.44547:0.00019%,-211.73542999999998:0.00019%]
[INFO] ** src:[22:38.34239%,9:25.99078%,7:18.13852%,1:17.52676%,15:0.00058%,17:0.00019%,14:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1397 (0.27192%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.1190 - tp: 64520.0000 - fp: 15480.0000 - tn: 304520.0000 - fn: 15480.0000 - accuracy: 0.9226 - precision: 0.8065 - recall: 0.8065 - auc: 0.8791 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2007e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0453e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.2863e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.8999e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/513763
[33m[INFO] loading file 24-24/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513763, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513763, 17)

[INFO] analyzing data
[INFO] 513763 rows
[INFO] ** appi_name:[21:99.9928%,30:0.0035%,26:0.00058%,31:0.00039%,27:0.00039%,22:0.00039%,0:0.00039%,24:0.00019%,23:0.00019%,19:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,11:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:95.04051%,Multi Stage Single Point:4.95949%]
[INFO] ** dst:[21:43.3661%,10:21.03188%,8:18.09083%,9:17.50379%,15:0.0035%,22:0.00117%,6:0.00078%,25:0.00039%,19:0.00039%,18:0.00039%,7:0.00039%,26:0.00019%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99669%,0:0.00331%]
[INFO] ** i/f_name:[2:99.9965%,3:0.0035%]
[INFO] ** modbus_function_code:[0.02961:99.9928%,-33.760870000000004:0.00662%,0.47422:0.00019%,-0.415:0.00019%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99737%,11:49.99543%,0:0.00662%,15:0.00019%,10:0.00019%,2:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.75608%)
[INFO] ** orig:[0:99.99961%,1:0.00039%]
[INFO] ** proto:[0:99.99436%,1:0.0035%,2:0.00214%]
[INFO] ** proxy_src_ip:[18:38.41947%,20:25.97929%,13:18.09064%,6:17.50301%,17:0.0035%,10:0.00136%,14:0.00097%,11:0.00097%,21:0.00039%,16:0.00039%]
[INFO] ** s_port:[1.45442:25.97852%,-0.32151:21.03188%,-1.27613:18.09044%,-0.23351:17.50243%,-0.33484:17.38759%,-71.33197:0.0035%,-9.58113:0.00078%,-71.14798:0.00058%,7.6315100000000005:0.00039%,-64.19493:0.00039%,-1.02014:0.00039%,-71.14931:0.00039%,-0.24151:0.00039%,1.45709:0.00039%,-31.55091:0.00039%,7.4901800000000005:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,1.46509:0.00019%,13.431270000000001:0.00019%,-68.79874000000001:0.00019%,-0.24950999999999998:0.00019%,11.862:0.00019%]
[INFO] ** scada_tag:[3:25.97832%,1:21.03188%,5:18.09025%,4:17.50204%,2:17.38739%,0:0.01012%]
[INFO] ** service:[0.0048200000000000005:99.99397%,-211.73542999999998:0.0035%,-211.08346:0.00058%,-186.44547:0.00039%,-186.43601999999998:0.00039%,-211.07873999999998:0.00039%,-211.08818:0.00039%,-202.75898:0.00039%]
[INFO] ** src:[22:38.41947%,9:25.97929%,7:18.09064%,1:17.50301%,14:0.0035%,11:0.00136%,10:0.00097%,2:0.00097%,15:0.00039%,4:0.00039%]
[INFO] ** type:[0:99.99864%,1:0.00097%,2:0.00039%]
[INFO] ** unixtime:1396 (0.27172%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.4031e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.4195e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.4894e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2977e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.9271e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.7159 - tp: 66520.0000 - fp: 13480.0000 - tn: 306520.0000 - fn: 13480.0000 - accuracy: 0.9326 - precision: 0.8315 - recall: 0.8315 - auc: 0.8947 - val_loss: 5.7243 - val_tp: 12897.0000 - val_fp: 7103.0000 - val_tn: 72897.0000 - val_fn: 7103.0000 - val_accuracy: 0.8579 - val_precision: 0.6449 - val_recall: 0.6449 - val_auc: 0.7780
[INFO] saving weights to checkpoints/lstm-epoch-8-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/513763
[33m[INFO] loading file 25-25/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513763, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513763, 17)

[INFO] analyzing data
[INFO] 513763 rows
[INFO] ** appi_name:[21:99.99611%,30:0.00117%,17:0.00078%,22:0.00058%,31:0.00039%,28:0.00019%,26:0.00019%,12:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** classification:[normal:64.33647%,Multi Stage Single Point:35.66353%]
[INFO] ** dst:[21:43.30927%,10:21.02273%,8:18.1539%,9:17.50944%,15:0.00117%,22:0.00097%,16:0.00078%,6:0.00078%,18:0.00039%,17:0.00039%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name:[2:99.99883%,3:0.00117%]
[INFO] ** modbus_function_code:[0.02961:99.99611%,-33.760870000000004:0.00389%]
[INFO] ** modbus_function_description:[7:49.99873%,11:49.99737%,0:0.00389%]
[INFO] ** modbus_transaction_id:65536 (12.75608%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99766%,2:0.00117%,1:0.00117%]
[INFO] ** proxy_src_ip:[18:38.3819%,20:25.94971%,13:18.15409%,6:17.51002%,17:0.00117%,1:0.00097%,21:0.00078%,16:0.00039%,14:0.00039%,7:0.00039%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.94951%,-0.32151:21.02234%,-1.27613:18.1537%,-0.23351:17.50944%,-0.33484:17.35956%,-71.33197:0.00117%,-71.14931:0.00058%,-1.02014:0.00039%,-0.24151:0.00039%,-49.275529999999996:0.00039%,-71.14798:0.00019%,-58.035180000000004:0.00019%,-1.2708:0.00019%,-5.1466400000000005:0.00019%,-5.08665:0.00019%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,1.45709:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,2.52505:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:25.94912%,1:21.02214%,5:18.15351%,4:17.50924%,2:17.35937%,0:0.00662%]
[INFO] ** service:[0.0048200000000000005:99.9965%,-211.73542999999998:0.00117%,-205.44247:0.00078%,-211.08818:0.00058%,-186.43601999999998:0.00039%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.3819%,9:25.94971%,7:18.15409%,1:17.51002%,14:0.00117%,3:0.00097%,4:0.00078%,21:0.00039%,15:0.00039%,2:0.00039%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1396 (0.27172%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7570 - tp: 51426.0000 - fp: 28574.0000 - tn: 291426.0000 - fn: 28574.0000 - accuracy: 0.8571 - precision: 0.6428 - recall: 0.6428 - auc: 0.7768 - val_loss: 5.7493 - val_tp: 12866.0000 - val_fp: 7134.0000 - val_tn: 72866.0000 - val_fn: 7134.0000 - val_accuracy: 0.8573 - val_precision: 0.6433 - val_recall: 0.6433 - val_auc: 0.7771
[INFO] saving weights to checkpoints/lstm-epoch-8-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7435 - tp: 51493.0000 - fp: 28507.0000 - tn: 291493.0000 - fn: 28507.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.7773 - val_loss: 5.7453 - val_tp: 12871.0000 - val_fp: 7129.0000 - val_tn: 72871.0000 - val_fn: 7129.0000 - val_accuracy: 0.8574 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.7772
[INFO] saving weights to checkpoints/lstm-epoch-8-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7518 - tp: 51452.0000 - fp: 28548.0000 - tn: 291452.0000 - fn: 28548.0000 - accuracy: 0.8573 - precision: 0.6431 - recall: 0.6431 - auc: 0.7770 - val_loss: 5.7413 - val_tp: 12876.0000 - val_fp: 7124.0000 - val_tn: 72876.0000 - val_fn: 7124.0000 - val_accuracy: 0.8575 - val_precision: 0.6438 - val_recall: 0.6438 - val_auc: 0.7774
[INFO] saving weights to checkpoints/lstm-epoch-8-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7471 - tp: 51475.0000 - fp: 28525.0000 - tn: 291475.0000 - fn: 28525.0000 - accuracy: 0.8574 - precision: 0.6434 - recall: 0.6434 - auc: 0.7771 - val_loss: 5.7630 - val_tp: 12849.0000 - val_fp: 7151.0000 - val_tn: 72849.0000 - val_fn: 7151.0000 - val_accuracy: 0.8570 - val_precision: 0.6424 - val_recall: 0.6424 - val_auc: 0.7765
[INFO] saving weights to checkpoints/lstm-epoch-8-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7417 - tp: 51502.0000 - fp: 28498.0000 - tn: 291502.0000 - fn: 28498.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.7774 - val_loss: 5.7227 - val_tp: 12899.0000 - val_fp: 7101.0000 - val_tn: 72899.0000 - val_fn: 7101.0000 - val_accuracy: 0.8580 - val_precision: 0.6449 - val_recall: 0.6449 - val_auc: 0.7781
[INFO] saving weights to checkpoints/lstm-epoch-8-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/513763
[33m[INFO] loading file 26-26/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513763, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513763, 17)

[INFO] analyzing data
[INFO] 513763 rows
[INFO] ** appi_name:[21:99.99883%,7:0.00058%,30:0.00019%,22:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:64.39487%,Single Stage Single Point:31.08671%,Multi Stage Single Point:4.51843%]
[INFO] ** dst:[21:43.30888%,10:21.08404%,8:18.1212%,9:17.48355%,22:0.00078%,24:0.00039%,16:0.00039%,2:0.00039%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99883%,-33.760870000000004:0.00117%]
[INFO] ** modbus_function_description:[7:49.9999%,11:49.99893%,0:0.00117%]
[INFO] ** modbus_transaction_id:65536 (12.75608%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99961%,2:0.00019%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.46599%,20:25.92732%,13:18.12159%,6:17.48355%,16:0.00039%,1:0.00039%,21:0.00019%,17:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.92674%,-0.32151:21.08404%,-1.27613:18.121%,-0.23351:17.48335%,-0.33484:17.38194%,-1.27347:0.00039%,-1.02014:0.00039%,7.66617:0.00019%,-1.2708:0.00019%,-71.14931:0.00019%,-0.24151:0.00019%,11.57001:0.00019%,1.47576:0.00019%,1.46509:0.00019%,14.191239999999999:0.00019%,-3.3787199999999995:0.00019%,1.45709:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.92635%,1:21.08404%,5:18.121%,4:17.48316%,2:17.38194%,0:0.0035%]
[INFO] ** service:[0.0048200000000000005:99.99883%,-211.09762999999998:0.00058%,-211.73542999999998:0.00019%,-211.35747999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.46599%,9:25.92732%,7:18.12159%,1:17.48355%,15:0.00039%,3:0.00039%,21:0.00019%,14:0.00019%,4:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1394 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.8357 - tp: 54870.0000 - fp: 25130.0000 - tn: 294870.0000 - fn: 25130.0000 - accuracy: 0.8743 - precision: 0.6859 - recall: 0.6859 - auc: 0.8103 - val_loss: 6.2499e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0779 - tp: 78798.0000 - fp: 1202.0000 - tn: 318798.0000 - fn: 1202.0000 - accuracy: 0.9940 - precision: 0.9850 - recall: 0.9850 - auc: 0.9928 - val_loss: 4.5693e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0577 - tp: 79119.0000 - fp: 881.0000 - tn: 319119.0000 - fn: 881.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9960 - val_loss: 3.5059e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0518 - tp: 79171.0000 - fp: 829.0000 - tn: 319171.0000 - fn: 829.0000 - accuracy: 0.9959 - precision: 0.9896 - recall: 0.9896 - auc: 0.9998 - val_loss: 1.8517e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0509 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9998 - val_loss: 1.3997e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/513763
[33m[INFO] loading file 27-27/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (453893, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (453893, 17)

[INFO] analyzing data
[INFO] 453893 rows
[INFO] ** appi_name:[21:99.99934%,30:0.00066%]
[INFO] ** classification:[normal:64.33917%,Single Stage Single Point:35.66083%]
[INFO] ** dst:[21:43.27121%,10:21.06598%,8:18.19041%,9:17.47064%,22:0.00088%,15:0.00066%,24:0.00022%]
[INFO] ** i/f_dir:[1:99.99978%,0:0.00022%]
[INFO] ** i/f_name:[2:99.99934%,3:0.00066%]
[INFO] ** modbus_function_code:[0.02961:99.99934%,-33.760870000000004:0.00066%]
[INFO] ** modbus_function_description:[7:50.00033%,11:49.99901%,0:0.00066%]
[INFO] ** modbus_transaction_id:65536 (14.43865%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99934%,1:0.00066%]
[INFO] ** proxy_src_ip:[18:38.40729%,20:25.93056%,13:18.19019%,6:17.47086%,17:0.00066%,16:0.00044%]
[INFO] ** s_port:[1.45442:25.9299%,-0.32151:21.06598%,-1.27613:18.18997%,-0.23351:17.47042%,-0.33484:17.34131%,-71.33197:0.00066%,-1.02014:0.00044%,-1.27347:0.00022%,1.45709:0.00022%,-0.24950999999999998:0.00022%,1.46509:0.00022%,1.47576:0.00022%,-0.24151:0.00022%]
[INFO] ** scada_tag:[3:25.92946%,1:21.06576%,5:18.18975%,4:17.4702%,2:17.34109%,0:0.00375%]
[INFO] ** service:[0.0048200000000000005:99.99934%,-211.73542999999998:0.00066%]
[INFO] ** src:[22:38.40729%,9:25.93056%,7:18.19019%,1:17.47086%,14:0.00066%,15:0.00044%]
[INFO] ** type:[0:99.99956%,1:0.00044%]
[INFO] ** unixtime:1233 (0.27165%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/453893
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0498 - tp: 79047.0000 - fp: 953.0000 - tn: 319047.0000 - fn: 953.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9998 - val_loss: 6.9151e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/453893
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0422 - tp: 79119.0000 - fp: 881.0000 - tn: 319119.0000 - fn: 881.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 3.0754e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/453893
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0386 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.0445e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/453893
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0339 - tp: 79132.0000 - fp: 868.0000 - tn: 319132.0000 - fn: 868.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.2822e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/453893
[33m[INFO] loading file 28-28/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (387809, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (387809, 17)

[INFO] analyzing data
[INFO] 387809 rows
[INFO] ** appi_name:[21:99.99226%,30:0.00181%,17:0.00129%,22:0.00103%,7:0.00103%,31:0.00077%,26:0.00077%,28:0.00026%,27:0.00026%,8:0.00026%,0:0.00026%]
[INFO] ** classification:[normal:64.30743%,Single Stage Single Point:35.69257%]
[INFO] ** dst:[21:43.28084%,10:21.01859%,8:18.20613%,9:17.48619%,6:0.00206%,16:0.00181%,18:0.00129%,15:0.00077%,22:0.00052%,17:0.00052%,2:0.00052%,25:0.00026%,7:0.00026%,0:0.00026%]
[INFO] ** i/f_dir:[1:99.99923%,0:0.00077%]
[INFO] ** i/f_name:[2:99.99923%,3:0.00077%]
[INFO] ** modbus_function_code:[0.02961:99.99226%,-33.760870000000004:0.00774%]
[INFO] ** modbus_function_description:[7:49.99626%,11:49.996%,0:0.00774%]
[INFO] ** modbus_transaction_id:65536 (16.89904%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99536%,2:0.00387%,1:0.00077%]
[INFO] ** proxy_src_ip:[18:38.33614%,20:25.9633%,13:18.20639%,6:17.48644%,1:0.00206%,17:0.00181%,14:0.00155%,7:0.00129%,21:0.00077%,0:0.00026%]
[INFO] ** s_port:[1.45442:25.96304%,-0.32151:21.01859%,-1.27613:18.20613%,-0.23351:17.48593%,-0.33484:17.31755%,-71.14798:0.00103%,-71.14931:0.00103%,-71.33197:0.00077%,-0.08551:0.00052%,-0.24151:0.00052%,7.66617:0.00026%,-58.035180000000004:0.00026%,-1.2708:0.00026%,-64.19493:0.00026%,-5.1466400000000005:0.00026%,13.431270000000001:0.00026%,11.57001:0.00026%,14.4699:0.00026%,1.47576:0.00026%,14.191239999999999:0.00026%,-5.08665:0.00026%,10.192739999999999:0.00026%,-3.3787199999999995:0.00026%,6.1115699999999995:0.00026%,2.05573:0.00026%,-43.76509:0.00026%,2.52505:0.00026%,11.862:0.00026%,-58.032509999999995:0.00026%]
[INFO] ** scada_tag:[3:25.96278%,1:21.01859%,5:18.20613%,4:17.48567%,2:17.31755%,0:0.00928%]
[INFO] ** service:[0.0048200000000000005:99.99226%,-205.44247:0.00129%,-186.43601999999998:0.00129%,-211.09762999999998:0.00103%,-211.08346:0.00103%,-211.08818:0.00103%,-211.73542999999998:0.00077%,-186.44547:0.00026%,-183.8612:0.00026%,-185.9872:0.00026%,-211.35747999999998:0.00026%,-202.75898:0.00026%]
[INFO] ** src:[22:38.33614%,9:25.9633%,7:18.20639%,1:17.48644%,3:0.00232%,2:0.00155%,21:0.00129%,4:0.00103%,14:0.00077%,8:0.00052%,17:0.00026%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1054 (0.27178%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/387809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0333 - tp: 79054.0000 - fp: 946.0000 - tn: 319054.0000 - fn: 946.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.4193e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/387809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0292 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 0.0017 - val_tp: 19994.0000 - val_fp: 6.0000 - val_tn: 79994.0000 - val_fn: 6.0000 - val_accuracy: 0.9999 - val_precision: 0.9997 - val_recall: 0.9997 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-8-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/387809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0251 - tp: 79143.0000 - fp: 857.0000 - tn: 319143.0000 - fn: 857.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/387809
[33m[INFO] loading file 29-29/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587809, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587809, 17)

[INFO] analyzing data
[INFO] 587809 rows
[INFO] ** appi_name:[21:99.99881%,30:0.00051%,31:0.00017%,26:0.00017%,9:0.00017%,3:0.00017%]
[INFO] ** classification:[normal:64.38401%,Single Stage Single Point:35.61599%]
[INFO] ** dst:[21:43.32087%,10:21.06177%,8:18.14586%,9:17.46979%,22:0.00051%,15:0.00051%,24:0.00017%,18:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99966%,0:0.00034%]
[INFO] ** i/f_name:[2:99.99949%,3:0.00051%]
[INFO] ** modbus_function_code:[0.02961:99.99881%,-33.760870000000004:0.00119%]
[INFO] ** modbus_function_description:[7:49.99974%,11:49.99906%,0:0.00119%]
[INFO] ** modbus_transaction_id:65536 (11.1492%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99915%,1:0.00051%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.43561%,20:25.9472%,13:18.1462%,6:17.46962%,17:0.00051%,21:0.00017%,16:0.00017%,7:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.94669%,-0.32151:21.0616%,-1.27613:18.14586%,-0.23351:17.46962%,-0.33484:17.37401%,-71.33197:0.00051%,1.45709:0.00034%,-71.14798:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,6.1115699999999995:0.00017%,14.4699:0.00017%]
[INFO] ** scada_tag:[3:25.94635%,1:21.06143%,5:18.14586%,4:17.46928%,2:17.37401%,0:0.00306%]
[INFO] ** service:[0.0048200000000000005:99.99898%,-211.73542999999998:0.00051%,-183.8612:0.00017%,-211.08346:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.43561%,9:25.9472%,7:18.1462%,1:17.46962%,14:0.00051%,21:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1596 (0.27152%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0232 - tp: 79116.0000 - fp: 884.0000 - tn: 319116.0000 - fn: 884.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0215 - tp: 79136.0000 - fp: 864.0000 - tn: 319136.0000 - fn: 864.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0219 - tp: 79089.0000 - fp: 911.0000 - tn: 319089.0000 - fn: 911.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1991e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/587809
[33m[INFO] loading file 30-30/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587809, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587809, 17)

[INFO] analyzing data
[INFO] 587809 rows
[INFO] ** appi_name:[21:99.99745%,30:0.0017%,26:0.00017%,17:0.00017%,12:0.00017%,3:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.37601%,Single Stage Single Point:35.62399%]
[INFO] ** dst:[21:43.3435%,10:21.02962%,8:18.1428%,9:17.48085%,15:0.0017%,22:0.00068%,24:0.00034%,25:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99847%,0:0.00153%]
[INFO] ** i/f_name:[2:99.9983%,3:0.0017%]
[INFO] ** modbus_function_code:[0.02961:99.99745%,-33.760870000000004:0.00255%]
[INFO] ** modbus_function_description:[7:49.99957%,11:49.99787%,0:0.00255%]
[INFO] ** modbus_transaction_id:65536 (11.1492%)
[INFO] ** orig:[0:99.99915%,2:0.00051%,1:0.00034%]
[INFO] ** proto:[0:99.99796%,1:0.0017%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.37624%,20:25.99654%,13:18.14314%,6:17.48136%,17:0.0017%,7:0.00034%,0:0.00034%,16:0.00017%,5:0.00017%]
[INFO] ** s_port:[1.45442:25.99637%,-0.32151:21.02928%,-1.27613:18.14263%,-0.23351:17.48068%,-0.33484:17.34696%,-71.33197:0.0017%,-0.24151:0.00051%,-1.27347:0.00034%,-61.95768:0.00034%,-71.14798:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:25.99603%,1:21.02928%,5:18.14246%,4:17.48051%,2:17.34679%,0:0.00493%]
[INFO] ** service:[0.0048200000000000005:99.99779%,-211.73542999999998:0.0017%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.37624%,9:25.99654%,7:18.14314%,1:17.48136%,14:0.00119%,21:0.00085%,8:0.00034%,16:0.00017%,15:0.00017%]
[INFO] ** type:[0:99.99915%,1:0.00085%]
[INFO] ** unixtime:1598 (0.27186%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79075.0000 - fp: 925.0000 - tn: 319075.0000 - fn: 925.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 4.1008e-04 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79055.0000 - fp: 945.0000 - tn: 319055.0000 - fn: 945.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 2.9889e-04 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79147.0000 - fp: 853.0000 - tn: 319147.0000 - fn: 853.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79132.0000 - fp: 868.0000 - tn: 319132.0000 - fn: 868.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/587809
[33m[INFO] loading file 31-31/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587809, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587809, 17)

[INFO] analyzing data
[INFO] 587809 rows
[INFO] ** appi_name:[21:99.99966%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.3784%,Single Stage Single Point:35.6216%]
[INFO] ** dst:[21:43.32581%,10:21.05123%,8:18.12051%,9:17.50075%,22:0.00102%,24:0.00034%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99966%,-33.760870000000004:0.00034%]
[INFO] ** modbus_function_description:[7:50.00009%,11:49.99957%,0:0.00034%]
[INFO] ** modbus_transaction_id:65536 (11.1492%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.39938%,20:25.97817%,13:18.12085%,6:17.50075%,16:0.00051%,7:0.00034%]
[INFO] ** s_port:[1.45442:25.97749%,-0.32151:21.05123%,-1.27613:18.12034%,-0.23351:17.50058%,-0.33484:17.34815%,-1.02014:0.00051%,-1.27347:0.00034%,1.45709:0.00034%,-71.14798:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-0.24151:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.97715%,1:21.05106%,5:18.12017%,4:17.50024%,2:17.34798%,0:0.0034%]
[INFO] ** service:[0.0048200000000000005:99.99966%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.39938%,9:25.97817%,7:18.12085%,1:17.50075%,15:0.00051%,21:0.00034%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1597 (0.27169%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79077.0000 - fp: 923.0000 - tn: 319077.0000 - fn: 923.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79140.0000 - fp: 860.0000 - tn: 319140.0000 - fn: 860.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79131.0000 - fp: 869.0000 - tn: 319131.0000 - fn: 869.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/587809
[33m[INFO] loading file 32-32/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587809, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587809, 17)

[INFO] analyzing data
[INFO] 587809 rows
[INFO] ** appi_name:[21:99.9966%,30:0.00289%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.38197%,Single Stage Single Point:35.61803%]
[INFO] ** dst:[21:43.32104%,10:21.0565%,8:18.15301%,9:17.46503%,15:0.00289%,22:0.00085%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99745%,0:0.00255%]
[INFO] ** i/f_name:[2:99.99711%,3:0.00289%]
[INFO] ** modbus_function_code:[0.02961:99.9966%,-33.760870000000004:0.0034%]
[INFO] ** modbus_function_description:[7:49.99906%,11:49.99753%,0:0.0034%]
[INFO] ** modbus_transaction_id:65536 (11.1492%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9966%,1:0.00289%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.42473%,20:25.95316%,13:18.15301%,6:17.46554%,17:0.00289%,14:0.00051%,16:0.00017%]
[INFO] ** s_port:[1.45442:25.95265%,-0.32151:21.0565%,-1.27613:18.15267%,-0.23351:17.46486%,-0.33484:17.36823%,-71.33197:0.00289%,-0.24151:0.00051%,-1.2708:0.00017%,-1.02014:0.00017%,13.431270000000001:0.00017%,-71.14798:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.95231%,1:21.05633%,5:18.15267%,4:17.46452%,2:17.36823%,0:0.00595%]
[INFO] ** service:[0.0048200000000000005:99.9966%,-211.73542999999998:0.00289%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.42473%,9:25.95316%,7:18.15301%,1:17.46554%,14:0.00289%,2:0.00051%,15:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1595 (0.27135%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79132.0000 - fp: 868.0000 - tn: 319132.0000 - fn: 868.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 3.1586e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79148.0000 - fp: 852.0000 - tn: 319148.0000 - fn: 852.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79070.0000 - fp: 930.0000 - tn: 319070.0000 - fn: 930.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 0.0021 - val_tp: 19989.0000 - val_fp: 11.0000 - val_tn: 79989.0000 - val_fn: 11.0000 - val_accuracy: 0.9998 - val_precision: 0.9995 - val_recall: 0.9995 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79106.0000 - fp: 894.0000 - tn: 319106.0000 - fn: 894.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/587809
[33m[INFO] loading file 33-33/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587809, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587809, 17)

[INFO] analyzing data
[INFO] 587809 rows
[INFO] ** appi_name:[21:99.99711%,30:0.00102%,17:0.00068%,22:0.00051%,31:0.00017%,28:0.00017%,26:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:64.39371%,Single Stage Single Point:35.60629%]
[INFO] ** dst:[21:43.32632%,10:21.06279%,8:18.12374%,9:17.48255%,22:0.00136%,15:0.00102%,16:0.00068%,6:0.00068%,24:0.00034%,17:0.00034%,18:0.00017%]
[INFO] ** i/f_dir:[1:99.99898%,0:0.00102%]
[INFO] ** i/f_name:[2:99.99898%,3:0.00102%]
[INFO] ** modbus_function_code:[0.02961:99.99711%,-33.760870000000004:0.00289%]
[INFO] ** modbus_function_description:[7:49.99957%,11:49.99753%,0:0.00289%]
[INFO] ** modbus_transaction_id:65536 (11.1492%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99813%,1:0.00102%,2:0.00085%]
[INFO] ** proxy_src_ip:[18:38.42286%,20:25.96711%,13:18.12374%,6:17.48272%,17:0.00102%,16:0.00068%,1:0.00068%,21:0.00034%,14:0.00034%,7:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.96626%,-0.32151:21.06279%,-1.27613:18.1234%,-0.23351:17.48238%,-0.33484:17.36006%,-71.33197:0.00102%,-1.02014:0.00068%,1.45709:0.00051%,-71.14931:0.00051%,-1.27347:0.00034%,-5.08665:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,-71.14798:0.00017%,-58.032509999999995:0.00017%,-58.035180000000004:0.00017%,-0.24151:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.96592%,1:21.06262%,5:18.12323%,4:17.48221%,2:17.36006%,0:0.00595%]
[INFO] ** service:[0.0048200000000000005:99.99711%,-211.73542999999998:0.00102%,-205.44247:0.00068%,-211.08818:0.00051%,-211.09762999999998:0.00017%,-211.08346:0.00017%,-185.9872:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.42286%,9:25.96711%,7:18.12374%,1:17.48272%,14:0.00102%,15:0.00068%,3:0.00068%,21:0.00034%,4:0.00034%,2:0.00034%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1598 (0.27186%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79140.0000 - fp: 860.0000 - tn: 319140.0000 - fn: 860.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 2.5040e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79163.0000 - fp: 837.0000 - tn: 319163.0000 - fn: 837.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 2.6148e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79099.0000 - fp: 901.0000 - tn: 319099.0000 - fn: 901.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/587809
[33m[INFO] loading file 34-34/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (429242, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (429242, 17)

[INFO] analyzing data
[INFO] 429242 rows
[INFO] ** appi_name:[21:99.99767%,30:0.0007%,7:0.0007%,31:0.00023%,22:0.00023%,8:0.00023%,6:0.00023%]
[INFO] ** classification:[normal:64.35134%,Single Stage Single Point:35.64866%]
[INFO] ** dst:[21:43.2905%,10:21.05782%,8:18.18461%,9:17.46427%,22:0.0007%,15:0.0007%,16:0.00047%,2:0.00047%,18:0.00023%,6:0.00023%]
[INFO] ** i/f_dir:[1:99.9993%,0:0.0007%]
[INFO] ** i/f_name:[2:99.9993%,3:0.0007%]
[INFO] ** modbus_function_code:[0.02961:99.99767%,-33.760870000000004:0.00233%]
[INFO] ** modbus_function_description:[7:49.9993%,11:49.99837%,0:0.00233%]
[INFO] ** modbus_transaction_id:65536 (15.26784%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99884%,1:0.0007%,2:0.00047%]
[INFO] ** proxy_src_ip:[18:38.39629%,20:25.95226%,13:18.18438%,6:17.46474%,17:0.0007%,1:0.0007%,21:0.00047%,14:0.00023%,7:0.00023%]
[INFO] ** s_port:[1.45442:25.95179%,-0.32151:21.05759%,-1.27613:18.18438%,-0.23351:17.46404%,-0.33484:17.3387%,-0.24151:0.0007%,-71.33197:0.0007%,-3.0613900000000003:0.00023%,-3.3787199999999995:0.00023%,14.191239999999999:0.00023%,1.46509:0.00023%,1.47576:0.00023%,11.57001:0.00023%,-49.275529999999996:0.00023%,-71.14931:0.00023%,7.66617:0.00023%]
[INFO] ** scada_tag:[3:25.95156%,1:21.05735%,5:18.18415%,4:17.46358%,2:17.3387%,0:0.00466%]
[INFO] ** service:[0.0048200000000000005:99.9979%,-211.09762999999998:0.0007%,-211.73542999999998:0.0007%,-186.43601999999998:0.00023%,-211.35747999999998:0.00023%,-211.08818:0.00023%]
[INFO] ** src:[22:38.39629%,9:25.95226%,7:18.18438%,1:17.46474%,14:0.0007%,3:0.0007%,4:0.00047%,21:0.00023%,2:0.00023%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1166 (0.27164%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/429242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 9.2605e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/429242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79056.0000 - fp: 944.0000 - tn: 319056.0000 - fn: 944.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 2.8190e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/429242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79106.0000 - fp: 894.0000 - tn: 319106.0000 - fn: 894.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.0737e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/429242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79077.0000 - fp: 923.0000 - tn: 319077.0000 - fn: 923.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-33-34-batch-300000-400000
[INFO] processing batch 400000-500000/429242
[33m[INFO] loading file 35-35/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529242, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529242, 17)

[INFO] analyzing data
[INFO] 529242 rows
[INFO] ** appi_name:[21:99.99887%,30:0.00113%]
[INFO] ** classification:[normal:64.37452%,Single Stage Single Point:35.62548%]
[INFO] ** dst:[21:43.33462%,10:21.03726%,8:18.1469%,9:17.47896%,22:0.00113%,15:0.00113%]
[INFO] ** i/f_dir:[1:99.99906%,0:0.00094%]
[INFO] ** i/f_name:[2:99.99887%,3:0.00113%]
[INFO] ** modbus_function_code:[0.02961:99.99887%,-33.760870000000004:0.00113%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99887%,0:0.00113%]
[INFO] ** modbus_transaction_id:65536 (12.38299%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99887%,1:0.00113%]
[INFO] ** proxy_src_ip:[18:38.40096%,20:25.97148%,13:18.14652%,6:17.47915%,17:0.00113%,16:0.00076%]
[INFO] ** s_port:[1.45442:25.97092%,-0.32151:21.03726%,-1.27613:18.14652%,-0.23351:17.47877%,-0.33484:17.3637%,-71.33197:0.00113%,-1.02014:0.00076%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.97054%,1:21.03726%,5:18.14633%,4:17.47839%,2:17.3637%,0:0.00378%]
[INFO] ** service:[0.0048200000000000005:99.99887%,-211.73542999999998:0.00113%]
[INFO] ** src:[22:38.40096%,9:25.97148%,7:18.14652%,1:17.47915%,14:0.00113%,15:0.00076%]
[INFO] ** type:[0:99.99906%,1:0.00094%]
[INFO] ** unixtime:1437 (0.27152%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79075.0000 - fp: 925.0000 - tn: 319075.0000 - fn: 925.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79180.0000 - fp: 820.0000 - tn: 319180.0000 - fn: 820.0000 - accuracy: 0.9959 - precision: 0.9898 - recall: 0.9898 - auc: 0.9999 - val_loss: 8.0799e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/529242
[33m[INFO] loading file 36-36/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529242, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529242, 17)

[INFO] analyzing data
[INFO] 529242 rows
[INFO] ** appi_name:[21:99.99868%,30:0.00057%,31:0.00038%,33:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.35222%,Single Stage Single Point:35.64778%]
[INFO] ** dst:[21:43.32952%,10:21.02063%,8:18.16107%,9:17.48652%,22:0.00076%,15:0.00057%,24:0.00038%,18:0.00038%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99943%,0:0.00057%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99868%,-33.760870000000004:0.00132%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99849%,0:0.00132%]
[INFO] ** modbus_transaction_id:65536 (12.38299%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99887%,2:0.00057%,1:0.00057%]
[INFO] ** proxy_src_ip:[18:38.36808%,20:25.98225%,13:18.16126%,6:17.48709%,17:0.00057%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.98169%,-0.32151:21.02044%,-1.27613:18.16069%,-0.23351:17.48633%,-0.33484:17.34764%,-0.24151:0.00057%,-71.33197:0.00057%,-1.27347:0.00038%,-0.08551:0.00038%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-49.275529999999996:0.00019%,-1.2708:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:25.98131%,1:21.02025%,5:18.1605%,4:17.48614%,2:17.34745%,0:0.00435%]
[INFO] ** service:[0.0048200000000000005:99.99887%,-211.73542999999998:0.00057%,-186.43601999999998:0.00038%,-186.44547:0.00019%]
[INFO] ** src:[22:38.36808%,9:25.98225%,7:18.16126%,1:17.48709%,14:0.00057%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1438 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79142.0000 - fp: 858.0000 - tn: 319142.0000 - fn: 858.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79123.0000 - fp: 877.0000 - tn: 319123.0000 - fn: 877.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79140.0000 - fp: 860.0000 - tn: 319140.0000 - fn: 860.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 5.9170e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0216 - tp: 79055.0000 - fp: 945.0000 - tn: 319055.0000 - fn: 945.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/529242
[33m[INFO] loading file 37-37/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529242, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529242, 17)

[INFO] analyzing data
[INFO] 529242 rows
[INFO] ** appi_name:[21:99.99887%,30:0.00076%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.38472%,Single Stage Single Point:35.61528%]
[INFO] ** dst:[21:43.33783%,10:21.045%,8:18.1348%,9:17.48028%,22:0.00076%,15:0.00076%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99924%,3:0.00076%]
[INFO] ** modbus_function_code:[0.02961:99.99887%,-33.760870000000004:0.00113%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99887%,0:0.00113%]
[INFO] ** modbus_transaction_id:65536 (12.38299%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99906%,1:0.00076%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.39794%,20:25.98528%,13:18.13499%,6:17.48028%,17:0.00076%,16:0.00038%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.98471%,-0.32151:21.045%,-1.27613:18.13462%,-0.23351:17.48009%,-0.33484:17.35293%,-71.33197:0.00076%,-1.02014:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%,14.4699:0.00019%]
[INFO] ** scada_tag:[3:25.98452%,1:21.045%,5:18.13443%,4:17.47991%,2:17.35274%,0:0.0034%]
[INFO] ** service:[0.0048200000000000005:99.99887%,-211.73542999999998:0.00076%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.39794%,9:25.98528%,7:18.13499%,1:17.48028%,14:0.00076%,15:0.00038%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1438 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79132.0000 - fp: 868.0000 - tn: 319132.0000 - fn: 868.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0215 - tp: 79044.0000 - fp: 956.0000 - tn: 319044.0000 - fn: 956.0000 - accuracy: 0.9952 - precision: 0.9880 - recall: 0.9880 - auc: 0.9999 - val_loss: 9.2689e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79151.0000 - fp: 849.0000 - tn: 319151.0000 - fn: 849.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79161.0000 - fp: 839.0000 - tn: 319161.0000 - fn: 839.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 3.3053e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0217 - tp: 79045.0000 - fp: 955.0000 - tn: 319045.0000 - fn: 955.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/529242
[33m[INFO] loading file 38-38/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529242, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529242, 17)

[INFO] analyzing data
[INFO] 529242 rows
[INFO] ** appi_name:[21:99.99906%,30:0.00019%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.41061%,Single Stage Single Point:35.58939%]
[INFO] ** dst:[21:43.32139%,10:21.08714%,8:18.09664%,9:17.49294%,22:0.00094%,25:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99906%,-33.760870000000004:0.00094%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99943%,0:0.00094%]
[INFO] ** modbus_transaction_id:65536 (12.38299%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99943%,2:0.00038%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.45519%,20:25.95391%,13:18.09645%,6:17.49332%,7:0.00038%,17:0.00019%,16:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95316%,-0.32151:21.08695%,-1.27613:18.09626%,-0.23351:17.49275%,-0.33484:17.36824%,-0.24151:0.00038%,1.45709:0.00038%,-64.19493:0.00019%,10.192739999999999:0.00019%,-1.02014:0.00019%,-71.14798:0.00019%,-61.95768:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.95278%,1:21.08695%,5:18.09626%,4:17.49256%,2:17.36824%,0:0.00321%]
[INFO] ** service:[0.0048200000000000005:99.99924%,-211.08346:0.00019%,-205.44247:0.00019%,-186.44547:0.00019%,-211.73542999999998:0.00019%]
[INFO] ** src:[22:38.45519%,9:25.95391%,7:18.09645%,1:17.49332%,21:0.00038%,16:0.00019%,15:0.00019%,14:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1438 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 2.5673e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 4.3524e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0217 - tp: 79023.0000 - fp: 977.0000 - tn: 319023.0000 - fn: 977.0000 - accuracy: 0.9951 - precision: 0.9878 - recall: 0.9878 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/529242
[33m[INFO] loading file 39-39/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529242, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529242, 17)

[INFO] analyzing data
[INFO] 529242 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.41288%,Single Stage Single Point:35.58712%]
[INFO] ** dst:[21:43.32517%,10:21.08695%,8:18.12762%,9:17.45912%,22:0.00094%,24:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.00057%,11:49.99943%]
[INFO] ** modbus_transaction_id:65536 (12.38299%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.45972%,20:25.95259%,13:18.128%,6:17.45912%,16:0.00057%]
[INFO] ** s_port:[1.45442:25.95221%,-0.32151:21.08695%,-1.27613:18.12762%,-0.23351:17.45893%,-0.33484:17.37277%,-1.02014:0.00057%,-1.27347:0.00019%,1.45709:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.95183%,1:21.08676%,5:18.12744%,4:17.45893%,2:17.37258%,0:0.00246%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.45972%,9:25.95259%,7:18.128%,1:17.45912%,15:0.00057%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1437 (0.27152%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79086.0000 - fp: 914.0000 - tn: 319086.0000 - fn: 914.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 2.0187e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79086.0000 - fp: 914.0000 - tn: 319086.0000 - fn: 914.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79128.0000 - fp: 872.0000 - tn: 319128.0000 - fn: 872.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79088.0000 - fp: 912.0000 - tn: 319088.0000 - fn: 912.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79150.0000 - fp: 850.0000 - tn: 319150.0000 - fn: 850.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/529242
[33m[INFO] loading file 40-40/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529242, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529242, 17)

[INFO] analyzing data
[INFO] 529242 rows
[INFO] ** appi_name:[21:99.99622%,30:0.00321%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.33371%,Single Stage Single Point:35.66629%]
[INFO] ** dst:[21:43.29097%,10:21.03763%,8:18.19451%,9:17.47197%,15:0.00321%,22:0.00094%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99698%,0:0.00302%]
[INFO] ** i/f_name:[2:99.99679%,3:0.00321%]
[INFO] ** modbus_function_code:[0.02961:99.99622%,-33.760870000000004:0.00378%]
[INFO] ** modbus_function_description:[7:49.99924%,11:49.99698%,0:0.00378%]
[INFO] ** modbus_transaction_id:65536 (12.38299%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99622%,1:0.00321%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.3524%,20:25.97715%,13:18.19432%,6:17.47235%,17:0.00321%,14:0.00057%]
[INFO] ** s_port:[1.45442:25.97621%,-0.32151:21.03763%,-1.27613:18.19413%,-0.23351:17.47178%,-0.33484:17.31476%,-71.33197:0.00321%,1.45709:0.00057%,-0.24151:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,13.431270000000001:0.00019%]
[INFO] ** scada_tag:[3:25.97583%,1:21.03745%,5:18.19395%,4:17.4714%,2:17.31457%,0:0.0068%]
[INFO] ** service:[0.0048200000000000005:99.99622%,-211.73542999999998:0.00321%,-211.08346:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.3524%,9:25.97715%,7:18.19432%,1:17.47235%,14:0.00321%,2:0.00057%]
[INFO] ** type:[0:99.99906%,1:0.00094%]
[INFO] ** unixtime:1439 (0.2719%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79079.0000 - fp: 921.0000 - tn: 319079.0000 - fn: 921.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0194 - tp: 79171.0000 - fp: 829.0000 - tn: 319171.0000 - fn: 829.0000 - accuracy: 0.9959 - precision: 0.9896 - recall: 0.9896 - auc: 0.9999 - val_loss: 8.2084e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/529242
[33m[INFO] loading file 41-41/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (469400, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (469400, 17)

[INFO] analyzing data
[INFO] 469400 rows
[INFO] ** appi_name:[21:99.99638%,30:0.00107%,22:0.00085%,17:0.00085%,32:0.00021%,28:0.00021%,26:0.00021%,7:0.00021%]
[INFO] ** classification:[normal:64.3905%,Single Stage Single Point:35.6095%]
[INFO] ** dst:[21:43.32318%,10:21.06285%,8:18.13975%,9:17.46954%,16:0.00107%,15:0.00107%,6:0.00107%,22:0.00064%,24:0.00043%,17:0.00043%]
[INFO] ** i/f_dir:[1:99.99893%,0:0.00107%]
[INFO] ** i/f_name:[2:99.99893%,3:0.00107%]
[INFO] ** modbus_function_code:[0.02961:99.99638%,-33.760870000000004:0.00362%]
[INFO] ** modbus_function_description:[7:49.99915%,11:49.99723%,0:0.00362%]
[INFO] ** modbus_transaction_id:65536 (13.96165%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99766%,2:0.00128%,1:0.00107%]
[INFO] ** proxy_src_ip:[18:38.43822%,20:25.94802%,13:18.13997%,6:17.46975%,17:0.00107%,1:0.00085%,21:0.00043%,16:0.00043%,14:0.00043%,0:0.00043%,7:0.00021%,2:0.00021%]
[INFO] ** s_port:[1.45442:25.94759%,-0.32151:21.06285%,-1.27613:18.13933%,-0.23351:17.46932%,-0.33484:17.37537%,-71.33197:0.00107%,-71.14931:0.00085%,-1.02014:0.00043%,-1.27347:0.00043%,-71.14798:0.00021%,-0.24151:0.00021%,-58.035180000000004:0.00021%,-1.2708:0.00021%,-5.1466400000000005:0.00021%,1.47576:0.00021%,1.46509:0.00021%,-64.19226:0.00021%,-5.08665:0.00021%,-0.24950999999999998:0.00021%,2.05573:0.00021%,-43.76509:0.00021%,-58.032509999999995:0.00021%]
[INFO] ** scada_tag:[3:25.94738%,1:21.06285%,5:18.13933%,4:17.46911%,2:17.37537%,0:0.00597%]
[INFO] ** service:[0.0048200000000000005:99.99638%,-211.73542999999998:0.00107%,-205.44247:0.00085%,-211.08818:0.00085%,89.64175:0.00021%,-211.09762999999998:0.00021%,-211.08346:0.00021%,-185.9872:0.00021%]
[INFO] ** src:[22:38.43822%,9:25.94802%,7:18.13997%,1:17.46975%,14:0.00107%,3:0.00085%,15:0.00043%,8:0.00043%,4:0.00043%,2:0.00043%,21:0.00021%,17:0.00021%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1273 (0.2712%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/469400
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79146.0000 - fp: 854.0000 - tn: 319146.0000 - fn: 854.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 2.3791e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/469400
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79080.0000 - fp: 920.0000 - tn: 319080.0000 - fn: 920.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 2.4037e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/469400
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/469400
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 8.2915e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/469400
[33m[INFO] loading file 42-42/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (412914, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (412914, 17)

[INFO] analyzing data
[INFO] 412914 rows
[INFO] ** appi_name:[21:99.99177%,30:0.00218%,17:0.00121%,31:0.00097%,26:0.00097%,7:0.00097%,22:0.00073%,28:0.00024%,27:0.00024%,9:0.00024%,8:0.00024%,0:0.00024%]
[INFO] ** classification:[normal:64.37927%,Single Stage Single Point:35.62073%]
[INFO] ** dst:[21:43.31653%,10:21.05402%,8:18.17618%,9:17.44407%,16:0.00218%,6:0.00194%,18:0.00121%,2:0.00097%,22:0.00073%,15:0.00073%,17:0.00048%,25:0.00024%,24:0.00024%,7:0.00024%,0:0.00024%]
[INFO] ** i/f_dir:[1:99.99927%,0:0.00073%]
[INFO] ** i/f_name:[2:99.99927%,3:0.00073%]
[INFO] ** modbus_function_code:[0.02961:99.99177%,-33.760870000000004:0.00823%]
[INFO] ** modbus_function_description:[7:49.99661%,11:49.99516%,0:0.00823%]
[INFO] ** modbus_transaction_id:65536 (15.87159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99564%,2:0.00363%,1:0.00073%]
[INFO] ** proxy_src_ip:[18:38.41357%,20:25.95722%,13:18.17667%,6:17.44407%,17:0.00218%,1:0.00218%,14:0.00145%,21:0.00097%,7:0.00073%,0:0.00048%,16:0.00024%,2:0.00024%]
[INFO] ** s_port:[1.45442:25.95674%,-0.32151:21.05402%,-1.27613:18.17618%,-0.23351:17.44383%,-0.33484:17.35955%,-71.14931:0.00097%,-71.14798:0.00097%,-71.33197:0.00073%,11.57001:0.00048%,-0.08551:0.00048%,-3.3787199999999995:0.00048%,-0.24151:0.00024%,13.431270000000001:0.00024%,-5.1466400000000005:0.00024%,0.31847:0.00024%,-1.02014:0.00024%,-1.2708:0.00024%,-58.035180000000004:0.00024%,7.66617:0.00024%,-64.19493:0.00024%,1.47576:0.00024%,14.4699:0.00024%,15.912510000000001:0.00024%,14.191239999999999:0.00024%,7.9608300000000005:0.00024%,-5.08665:0.00024%,10.192739999999999:0.00024%,-3.0613900000000003:0.00024%,1.45709:0.00024%,2.05573:0.00024%,-43.76509:0.00024%,11.862:0.00024%,-1.27347:0.00024%,-58.032509999999995:0.00024%]
[INFO] ** scada_tag:[3:25.95625%,1:21.05402%,5:18.17594%,4:17.44383%,2:17.3593%,0:0.01066%]
[INFO] ** service:[0.0048200000000000005:99.99177%,-211.09762999999998:0.0017%,-205.44247:0.00121%,-186.43601999999998:0.00121%,-211.08346:0.00097%,-211.08818:0.00097%,-211.73542999999998:0.00073%,-211.35747999999998:0.00048%,-186.44547:0.00024%,-183.8612:0.00024%,-185.9872:0.00024%,-202.75898:0.00024%]
[INFO] ** src:[22:38.41357%,9:25.95722%,7:18.17667%,1:17.44407%,3:0.00291%,2:0.0017%,4:0.00121%,21:0.00097%,14:0.00073%,8:0.00048%,17:0.00024%,15:0.00024%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1121 (0.27149%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/412914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.4643e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/412914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 4.3663e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/412914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79077.0000 - fp: 923.0000 - tn: 319077.0000 - fn: 923.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/412914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-41-42-batch-300000-400000
[INFO] processing batch 400000-500000/412914
[33m[INFO] loading file 43-43/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (512914, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (512914, 17)

[INFO] analyzing data
[INFO] 512914 rows
[INFO] ** appi_name:[21:99.99922%,30:0.00058%,26:0.00019%]
[INFO] ** classification:[normal:64.39949%,Single Stage Single Point:35.60051%]
[INFO] ** dst:[21:43.33085%,10:21.06688%,8:18.12936%,9:17.47096%,22:0.00097%,15:0.00058%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99942%,3:0.00058%]
[INFO] ** modbus_function_code:[0.02961:99.99922%,-33.760870000000004:0.00078%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99903%,0:0.00078%]
[INFO] ** modbus_transaction_id:65536 (12.77719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99922%,1:0.00058%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.42087%,20:25.97726%,13:18.12955%,6:17.47116%,17:0.00058%,16:0.00039%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.97667%,-0.32151:21.06688%,-1.27613:18.12916%,-0.23351:17.47077%,-0.33484:17.35398%,-71.33197:0.00058%,1.45709:0.00039%,-1.02014:0.00039%,-71.14798:0.00019%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.97628%,1:21.06688%,5:18.12897%,4:17.47038%,2:17.35379%,0:0.0037%]
[INFO] ** service:[0.0048200000000000005:99.99922%,-211.73542999999998:0.00058%,-211.08346:0.00019%]
[INFO] ** src:[22:38.42087%,9:25.97726%,7:18.12955%,1:17.47116%,14:0.00058%,15:0.00039%,3:0.00019%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1395 (0.27198%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79082.0000 - fp: 918.0000 - tn: 319082.0000 - fn: 918.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 9.6456e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79172.0000 - fp: 828.0000 - tn: 319172.0000 - fn: 828.0000 - accuracy: 0.9959 - precision: 0.9897 - recall: 0.9897 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79142.0000 - fp: 858.0000 - tn: 319142.0000 - fn: 858.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79077.0000 - fp: 923.0000 - tn: 319077.0000 - fn: 923.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/512914
[33m[INFO] loading file 44-44/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (512914, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (512914, 17)

[INFO] analyzing data
[INFO] 512914 rows
[INFO] ** appi_name:[21:99.99805%,30:0.00078%,31:0.00058%,0:0.00039%,22:0.00019%]
[INFO] ** classification:[normal:64.36498%,Single Stage Single Point:35.63502%]
[INFO] ** dst:[21:43.32052%,10:21.04134%,8:18.1703%,9:17.46453%,22:0.00097%,15:0.00078%,18:0.00058%,25:0.00039%,24:0.00039%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name:[2:99.99922%,3:0.00078%]
[INFO] ** modbus_function_code:[0.02961:99.99805%,-33.760870000000004:0.00195%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99786%,0:0.00195%]
[INFO] ** modbus_transaction_id:65536 (12.77719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99805%,2:0.00117%,1:0.00078%]
[INFO] ** proxy_src_ip:[18:38.41034%,20:25.95191%,13:18.17049%,6:17.46511%,17:0.00078%,7:0.00039%,16:0.00019%,5:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95133%,-0.32151:21.04134%,-1.27613:18.16991%,-0.23351:17.46433%,-0.33484:17.36899%,-71.33197:0.00078%,-0.24151:0.00058%,-64.19493:0.00039%,-0.08551:0.00039%,-1.27347:0.00039%,1.46509:0.00019%,1.47576:0.00019%,-0.24950999999999998:0.00019%,1.45709:0.00019%,4.42897:0.00019%,-71.14931:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.95094%,1:21.04134%,5:18.16991%,4:17.46394%,2:17.3688%,0:0.00507%]
[INFO] ** service:[0.0048200000000000005:99.99805%,-211.73542999999998:0.00078%,-186.43601999999998:0.00058%,-186.44547:0.00039%,-211.08818:0.00019%]
[INFO] ** src:[22:38.41034%,9:25.95191%,7:18.17049%,1:17.46511%,14:0.00078%,21:0.00039%,17:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1391 (0.2712%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 2.6695e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79054.0000 - fp: 946.0000 - tn: 319054.0000 - fn: 946.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 9.2652e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/512914
[33m[INFO] loading file 45-45/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (512914, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (512914, 17)

[INFO] analyzing data
[INFO] 512914 rows
[INFO] ** appi_name:[21:99.99903%,30:0.00058%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.42074%,Single Stage Single Point:35.57926%]
[INFO] ** dst:[21:43.32481%,10:21.09359%,8:18.11746%,9:17.46199%,22:0.00117%,15:0.00058%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99942%,3:0.00058%]
[INFO] ** modbus_function_code:[0.02961:99.99903%,-33.760870000000004:0.00097%]
[INFO] ** modbus_function_description:[7:50.00039%,11:49.99864%,0:0.00097%]
[INFO] ** modbus_transaction_id:65536 (12.77719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99922%,1:0.00058%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.48715%,20:25.93183%,13:18.11727%,6:17.46238%,17:0.00058%,16:0.00039%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.93125%,-0.32151:21.09359%,-1.27613:18.11727%,-0.23351:17.46199%,-0.33484:17.39356%,1.45709:0.00058%,-71.33197:0.00058%,-1.02014:0.00039%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,14.4699:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.93086%,1:21.0934%,5:18.11727%,4:17.46199%,2:17.39336%,0:0.00312%]
[INFO] ** service:[0.0048200000000000005:99.99903%,-211.73542999999998:0.00058%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.48715%,9:25.93183%,7:18.11727%,1:17.46238%,14:0.00058%,15:0.00039%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1392 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79153.0000 - fp: 847.0000 - tn: 319153.0000 - fn: 847.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79062.0000 - fp: 938.0000 - tn: 319062.0000 - fn: 938.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79140.0000 - fp: 860.0000 - tn: 319140.0000 - fn: 860.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79116.0000 - fp: 884.0000 - tn: 319116.0000 - fn: 884.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 6.7300e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/512914
[33m[INFO] loading file 46-46/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (512914, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (512914, 17)

[INFO] analyzing data
[INFO] 512914 rows
[INFO] ** appi_name:[21:99.99825%,30:0.00097%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.42756%,Single Stage Single Point:35.57244%]
[INFO] ** dst:[21:43.3521%,10:21.07293%,8:18.10342%,9:17.46901%,22:0.00097%,15:0.00097%,25:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99903%,0:0.00097%]
[INFO] ** i/f_name:[2:99.99903%,3:0.00097%]
[INFO] ** modbus_function_code:[0.02961:99.99825%,-33.760870000000004:0.00175%]
[INFO] ** modbus_function_description:[11:49.99922%,7:49.99903%,0:0.00175%]
[INFO] ** modbus_transaction_id:65536 (12.77719%)
[INFO] ** orig:[0:99.99961%,1:0.00039%]
[INFO] ** proto:[0:99.99864%,1:0.00097%,2:0.00039%]
[INFO] ** proxy_src_ip:[18:38.44933%,20:25.9755%,13:18.10342%,6:17.4696%,17:0.00097%,16:0.00039%,7:0.00039%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.97531%,-0.32151:21.07273%,-1.27613:18.10323%,-0.23351:17.46882%,-0.33484:17.3766%,-71.33197:0.00097%,-0.24151:0.00058%,-1.02014:0.00039%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,10.192739999999999:0.00019%,1.47576:0.00019%,-61.95768:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.97492%,1:21.07254%,5:18.10303%,4:17.46843%,2:17.3766%,0:0.00448%]
[INFO] ** service:[0.0048200000000000005:99.99844%,-211.73542999999998:0.00097%,-186.44547:0.00019%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.44933%,9:25.9755%,7:18.10342%,1:17.4696%,14:0.00097%,21:0.00039%,15:0.00039%,16:0.00019%,8:0.00019%]
[INFO] ** type:[0:99.99922%,1:0.00078%]
[INFO] ** unixtime:1395 (0.27198%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79138.0000 - fp: 862.0000 - tn: 319138.0000 - fn: 862.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79142.0000 - fp: 858.0000 - tn: 319142.0000 - fn: 858.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79138.0000 - fp: 862.0000 - tn: 319138.0000 - fn: 862.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.6520e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79143.0000 - fp: 857.0000 - tn: 319143.0000 - fn: 857.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 3.7845e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/512914
[33m[INFO] loading file 47-47/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (512914, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (512914, 17)

[INFO] analyzing data
[INFO] 512914 rows
[INFO] ** appi_name:[21:99.99981%,33:0.00019%]
[INFO] ** classification:[normal:64.3913%,Single Stage Single Point:35.6087%]
[INFO] ** dst:[21:43.30219%,10:21.08736%,8:18.12643%,9:17.48188%,22:0.00175%,24:0.00039%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99981%,-33.760870000000004:0.00019%]
[INFO] ** modbus_function_description:[7:50.00136%,11:49.99844%,0:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.77719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.45771%,20:25.93261%,13:18.12682%,6:17.48227%,16:0.00039%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.93164%,-0.32151:21.08736%,-1.27613:18.12624%,-0.23351:17.48168%,-0.33484:17.37036%,1.45709:0.00058%,-0.24151:0.00058%,-1.27347:0.00039%,-1.02014:0.00039%,-61.95635:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.93105%,1:21.08716%,5:18.12604%,4:17.48149%,2:17.37016%,0:0.00409%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.45771%,9:25.93261%,7:18.12682%,1:17.48227%,15:0.00039%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1392 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79063.0000 - fp: 937.0000 - tn: 319063.0000 - fn: 937.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.2661e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79067.0000 - fp: 933.0000 - tn: 319067.0000 - fn: 933.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79086.0000 - fp: 914.0000 - tn: 319086.0000 - fn: 914.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/512914
[33m[INFO] loading file 48-48/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (512914, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (512914, 17)

[INFO] analyzing data
[INFO] 512914 rows
[INFO] ** appi_name:[21:99.99669%,30:0.00273%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.41801%,Single Stage Single Point:35.58199%]
[INFO] ** dst:[21:43.33222%,10:21.0819%,8:18.11103%,9:17.47057%,15:0.00273%,22:0.00078%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99766%,0:0.00234%]
[INFO] ** i/f_name:[2:99.99727%,3:0.00273%]
[INFO] ** modbus_function_code:[0.02961:99.99669%,-33.760870000000004:0.00331%]
[INFO] ** modbus_function_description:[7:49.99903%,11:49.99766%,0:0.00331%]
[INFO] ** modbus_transaction_id:65536 (12.77719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99669%,1:0.00273%,2:0.00058%]
[INFO] ** proxy_src_ip:[18:38.45381%,20:25.96049%,13:18.11142%,6:17.47057%,17:0.00273%,14:0.00058%,16:0.00039%]
[INFO] ** s_port:[1.45442:25.9601%,-0.32151:21.0819%,-1.27613:18.11103%,-0.23351:17.47038%,-0.33484:17.37192%,-71.33197:0.00273%,-1.02014:0.00039%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,1.45709:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,13.431270000000001:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.95971%,1:21.0819%,5:18.11103%,4:17.47038%,2:17.37172%,0:0.00526%]
[INFO] ** service:[0.0048200000000000005:99.99669%,-211.73542999999998:0.00273%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.45381%,9:25.96049%,7:18.11142%,1:17.47057%,14:0.00273%,2:0.00058%,15:0.00039%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1392 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79041.0000 - fp: 959.0000 - tn: 319041.0000 - fn: 959.0000 - accuracy: 0.9952 - precision: 0.9880 - recall: 0.9880 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79098.0000 - fp: 902.0000 - tn: 319098.0000 - fn: 902.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79137.0000 - fp: 863.0000 - tn: 319137.0000 - fn: 863.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/512914
[33m[INFO] loading file 49-49/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (512914, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (512914, 17)

[INFO] analyzing data
[INFO] 512914 rows
[INFO] ** appi_name:[21:99.99727%,30:0.00097%,17:0.00078%,22:0.00039%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.36401%,Single Stage Single Point:35.63599%]
[INFO] ** dst:[21:43.2979%,10:21.06162%,8:18.14534%,9:17.49085%,22:0.00136%,15:0.00097%,16:0.00078%,6:0.00058%,17:0.00039%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99903%,0:0.00097%]
[INFO] ** i/f_name:[2:99.99903%,3:0.00097%]
[INFO] ** modbus_function_code:[0.02961:99.99727%,-33.760870000000004:0.00273%]
[INFO] ** modbus_function_description:[7:49.99942%,11:49.99786%,0:0.00273%]
[INFO] ** modbus_transaction_id:65536 (12.77719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99844%,1:0.00097%,2:0.00058%]
[INFO] ** proxy_src_ip:[18:38.41814%,20:25.94217%,13:18.14515%,6:17.49143%,17:0.00097%,1:0.00078%,21:0.00039%,16:0.00039%,14:0.00039%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.94139%,-0.32151:21.06162%,-1.27613:18.14495%,-0.23351:17.49065%,-0.33484:17.35652%,-71.33197:0.00097%,-0.24151:0.00058%,1.45709:0.00039%,-1.02014:0.00039%,-71.14931:0.00039%,-71.14798:0.00019%,-58.035180000000004:0.00019%,-5.1466400000000005:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,-5.08665:0.00019%,-0.24950999999999998:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:25.941%,1:21.06143%,5:18.14476%,4:17.49026%,2:17.35652%,0:0.00604%]
[INFO] ** service:[0.0048200000000000005:99.99727%,-211.73542999999998:0.00097%,-205.44247:0.00078%,-211.08818:0.00039%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.41814%,9:25.94217%,7:18.14515%,1:17.49143%,14:0.00097%,3:0.00078%,15:0.00039%,4:0.00039%,2:0.00039%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1393 (0.27159%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79143.0000 - fp: 857.0000 - tn: 319143.0000 - fn: 857.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79085.0000 - fp: 915.0000 - tn: 319085.0000 - fn: 915.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 8.0659e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0195 - tp: 79148.0000 - fp: 852.0000 - tn: 319148.0000 - fn: 852.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.2854e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/512914
[33m[INFO] loading file 50-50/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (362896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (362896, 17)

[INFO] analyzing data
[INFO] 362896 rows
[INFO] ** appi_name:[21:99.99752%,30:0.00083%,7:0.00083%,31:0.00028%,22:0.00028%,8:0.00028%]
[INFO] ** classification:[normal:64.2917%,Single Stage Single Point:35.7083%]
[INFO] ** dst:[21:43.24793%,10:21.04074%,8:18.22836%,9:17.47966%,15:0.00083%,22:0.00055%,16:0.00055%,2:0.00055%,24:0.00028%,18:0.00028%,6:0.00028%]
[INFO] ** i/f_dir:[1:99.99917%,0:0.00083%]
[INFO] ** i/f_name:[2:99.99917%,3:0.00083%]
[INFO] ** modbus_function_code:[0.02961:99.99752%,-33.760870000000004:0.00248%]
[INFO] ** modbus_function_description:[7:49.9989%,11:49.99862%,0:0.00248%]
[INFO] ** modbus_transaction_id:65535 (18.05889%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99862%,1:0.00083%,2:0.00055%]
[INFO] ** proxy_src_ip:[18:38.36113%,20:25.92781%,13:18.22864%,6:17.47966%,17:0.00083%,1:0.00083%,21:0.00028%,16:0.00028%,14:0.00028%,7:0.00028%]
[INFO] ** s_port:[1.45442:25.92726%,-0.32151:21.04074%,-1.27613:18.22809%,-0.23351:17.47966%,-0.33484:17.32039%,-71.33197:0.00083%,-3.3787199999999995:0.00028%,4.33564:0.00028%,15.912510000000001:0.00028%,7.9608300000000005:0.00028%,1.46509:0.00028%,1.45709:0.00028%,-1.27347:0.00028%,-71.14931:0.00028%,-1.02014:0.00028%,-1.2708:0.00028%,0.31847:0.00028%]
[INFO] ** scada_tag:[3:25.92699%,1:21.04046%,5:18.22781%,4:17.47966%,2:17.32011%,0:0.00496%]
[INFO] ** service:[0.0048200000000000005:99.99752%,-211.09762999999998:0.00083%,-211.73542999999998:0.00083%,-186.43601999999998:0.00028%,-211.35747999999998:0.00028%,-211.08818:0.00028%]
[INFO] ** src:[22:38.36113%,9:25.92781%,7:18.22864%,1:17.47966%,14:0.00083%,3:0.00083%,21:0.00028%,15:0.00028%,4:0.00028%,2:0.00028%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:986 (0.2717%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/362896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/362896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/362896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.5014e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/362896
[33m[INFO] epoch 9/10[0m
[33m[INFO] loading file 1-1/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.9936%,30:0.00107%,22:0.00089%,17:0.00071%,31:0.00053%,26:0.00053%,7:0.00053%,23:0.00036%,18:0.00036%,0:0.00036%,28:0.00018%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:77.62002%,Single Stage Single Point:22.37998%]
[INFO] ** dst:[21:43.26785%,10:21.03728%,8:18.16854%,9:17.5194%,6:0.00142%,22:0.00107%,16:0.00107%,15:0.00107%,18:0.00053%,26:0.00036%,25:0.00036%,19:0.00036%,17:0.00036%,24:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99893%,0:0.00107%]
[INFO] ** i/f_name:[2:99.99893%,3:0.00107%]
[INFO] ** modbus_function_code:[0.02961:99.9936%,-33.760870000000004:0.00622%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99769%,11:49.99591%,0:0.00622%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99645%,2:0.00249%,1:0.00107%]
[INFO] ** proxy_src_ip:[18:38.39875%,20:25.90603%,13:18.16872%,6:17.51975%,11:0.00124%,10:0.00124%,17:0.00107%,14:0.00089%,1:0.00089%,7:0.00053%,21:0.00036%,16:0.00036%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.9055%,-0.32151:21.03657%,-1.27613:18.16837%,-0.23351:17.51922%,-0.33484:17.36218%,-71.33197:0.00107%,-71.14931:0.00089%,-2.1481:0.00071%,-0.24151:0.00053%,-71.14798:0.00053%,-1.02014:0.00036%,-64.19493:0.00036%,-2.42942:0.00036%,4.44364:0.00036%,-43.76509:0.00018%,10.67005:0.00018%,4.29964:0.00018%,-5.08665:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,1.47576:0.00018%,1.46509:0.00018%,4.076980000000001:0.00018%,-58.032509999999995:0.00018%,-58.035180000000004:0.00018%,-1.2708:0.00018%,-1.27347:0.00018%,-5.1466400000000005:0.00018%,-68.79874000000001:0.00018%,14.253910000000001:0.00018%,1.45709:0.00018%]
[INFO] ** scada_tag:[3:25.90532%,1:21.03639%,5:18.16801%,4:17.51904%,2:17.362%,0:0.00924%]
[INFO] ** service:[0.0048200000000000005:99.99432%,-211.73542999999998:0.00107%,-211.08818:0.00089%,-205.44247:0.00071%,-211.07873999999998:0.00071%,-211.09762999999998:0.00053%,-211.08346:0.00053%,-186.43601999999998:0.00053%,-186.44547:0.00036%,-185.9872:0.00018%,-202.75898:0.00018%]
[INFO] ** src:[22:38.39875%,9:25.90603%,7:18.16872%,1:17.51975%,11:0.00124%,10:0.00124%,14:0.00107%,3:0.00089%,2:0.00089%,21:0.00053%,15:0.00036%,4:0.00036%,8:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1528 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4302 - tp: 75366.0000 - fp: 4634.0000 - tn: 315366.0000 - fn: 4634.0000 - accuracy: 0.9768 - precision: 0.9421 - recall: 0.9421 - auc: 0.9821 - val_loss: 0.5862 - val_tp: 18773.0000 - val_fp: 1227.0000 - val_tn: 78773.0000 - val_fn: 1227.0000 - val_accuracy: 0.9755 - val_precision: 0.9387 - val_recall: 0.9387 - val_auc: 0.9636
[INFO] saving weights to checkpoints/lstm-epoch-9-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0393 - tp: 79673.0000 - fp: 327.0000 - tn: 319673.0000 - fn: 327.0000 - accuracy: 0.9984 - precision: 0.9959 - recall: 0.9959 - auc: 0.9987 - val_loss: 1.3172e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0067 - tp: 79995.0000 - fp: 5.0000 - tn: 319995.0000 - fn: 5.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 1.1947e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.8156 - tp: 61771.0000 - fp: 18229.0000 - tn: 301771.0000 - fn: 18229.0000 - accuracy: 0.9089 - precision: 0.7721 - recall: 0.7721 - auc: 0.8775 - val_loss: 1.8329 - val_tp: 13529.0000 - val_fp: 6471.0000 - val_tn: 73529.0000 - val_fn: 6471.0000 - val_accuracy: 0.8706 - val_precision: 0.6765 - val_recall: 0.6765 - val_auc: 0.8926
[INFO] saving weights to checkpoints/lstm-epoch-9-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1552 - tp: 76353.0000 - fp: 3647.0000 - tn: 316353.0000 - fn: 3647.0000 - accuracy: 0.9818 - precision: 0.9544 - recall: 0.9544 - auc: 0.9948 - val_loss: 0.0015 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 2-2/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99858%,30:0.00053%,7:0.00053%,31:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:70.58124%,Single Stage Single Point:29.41876%]
[INFO] ** dst:[21:43.3112%,10:21.02982%,8:18.14154%,9:17.51496%,22:0.00089%,15:0.00053%,16:0.00036%,2:0.00036%,24:0.00018%,18:0.00018%]
[INFO] ** i/f_dir:[1:99.99947%,0:0.00053%]
[INFO] ** i/f_name:[2:99.99947%,3:0.00053%]
[INFO] ** modbus_function_code:[0.02961:99.99858%,-33.760870000000004:0.00142%]
[INFO] ** modbus_function_description:[7:49.99982%,11:49.99876%,0:0.00142%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99929%,1:0.00053%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.37974%,20:25.96181%,13:18.14154%,6:17.51531%,17:0.00053%,1:0.00053%,16:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.9611%,-0.32151:21.02982%,-1.27613:18.14118%,-0.23351:17.51478%,-0.33484:17.34992%,-71.33197:0.00053%,-0.24151:0.00036%,1.45709:0.00036%,1.46509:0.00018%,1.47576:0.00018%,12.60597:0.00018%,10.67005:0.00018%,-0.24950999999999998:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,4.076980000000001:0.00018%,-3.3787199999999995:0.00018%,4.29964:0.00018%,-1.27347:0.00018%]
[INFO] ** scada_tag:[3:25.96075%,1:21.02982%,5:18.14118%,4:17.51443%,2:17.34974%,0:0.00409%]
[INFO] ** service:[0.0048200000000000005:99.99858%,-211.09762999999998:0.00053%,-211.73542999999998:0.00053%,-211.35747999999998:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.37974%,9:25.96181%,7:18.14154%,1:17.51531%,14:0.00053%,3:0.00053%,21:0.00018%,15:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1531 (0.27199%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0476 - tp: 78319.0000 - fp: 1681.0000 - tn: 318319.0000 - fn: 1681.0000 - accuracy: 0.9916 - precision: 0.9790 - recall: 0.9790 - auc: 0.9994 - val_loss: 7.4350e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0335 - tp: 78626.0000 - fp: 1374.0000 - tn: 318626.0000 - fn: 1374.0000 - accuracy: 0.9931 - precision: 0.9828 - recall: 0.9828 - auc: 0.9998 - val_loss: 3.8974 - val_tp: 14966.0000 - val_fp: 5034.0000 - val_tn: 74966.0000 - val_fn: 5034.0000 - val_accuracy: 0.8993 - val_precision: 0.7483 - val_recall: 0.7483 - val_auc: 0.8406
[INFO] saving weights to checkpoints/lstm-epoch-9-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5009 - tp: 76670.0000 - fp: 3330.0000 - tn: 316670.0000 - fn: 3330.0000 - accuracy: 0.9833 - precision: 0.9584 - recall: 0.9584 - auc: 0.9775 - val_loss: 2.5115e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2944 - tp: 60377.0000 - fp: 19623.0000 - tn: 300377.0000 - fn: 19623.0000 - accuracy: 0.9019 - precision: 0.7547 - recall: 0.7547 - auc: 0.9244 - val_loss: 0.3241 - val_tp: 16627.0000 - val_fp: 3373.0000 - val_tn: 76627.0000 - val_fn: 3373.0000 - val_accuracy: 0.9325 - val_precision: 0.8314 - val_recall: 0.8314 - val_auc: 0.9827
[INFO] saving weights to checkpoints/lstm-epoch-9-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1133 - tp: 76497.0000 - fp: 3503.0000 - tn: 316497.0000 - fn: 3503.0000 - accuracy: 0.9825 - precision: 0.9562 - recall: 0.9562 - auc: 0.9988 - val_loss: 2.3615 - val_tp: 15220.0000 - val_fp: 4780.0000 - val_tn: 75220.0000 - val_fn: 4780.0000 - val_accuracy: 0.9044 - val_precision: 0.7610 - val_recall: 0.7610 - val_auc: 0.8510
[INFO] saving weights to checkpoints/lstm-epoch-9-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 3-3/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99183%,30:0.00213%,22:0.00107%,31:0.00089%,26:0.00089%,17:0.00089%,7:0.00071%,27:0.00036%,0:0.00036%,28:0.00018%,23:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:88.1964%,Single Stage Single Point:11.8036%]
[INFO] ** dst:[21:43.31102%,10:21.0808%,8:18.15451%,9:17.44461%,6:0.00213%,15:0.00142%,18:0.00124%,16:0.00124%,22:0.00089%,2:0.00036%,7:0.00036%,25:0.00036%,17:0.00036%,12:0.00018%,24:0.00018%,19:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99858%,0:0.00142%]
[INFO] ** i/f_name:[2:99.99858%,3:0.00142%]
[INFO] ** modbus_function_code:[0.02961:99.99183%,-33.760870000000004:0.00799%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99662%,11:49.9952%,0:0.00799%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.99893%,2:0.00107%]
[INFO] ** proto:[0:99.99432%,2:0.00426%,1:0.00142%]
[INFO] ** proxy_src_ip:[18:38.40514%,20:25.98704%,13:18.15469%,6:17.44496%,17:0.00213%,1:0.00142%,14:0.00124%,7:0.00089%,11:0.00071%,10:0.00071%,21:0.00053%,16:0.00018%,15:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.98633%,-0.32151:21.08063%,-1.27613:18.15415%,-0.23351:17.44443%,-0.33484:17.32451%,-71.33197:0.00142%,-71.14931:0.00107%,-71.14798:0.00107%,-64.19493:0.00036%,-0.08551:0.00036%,1.45709:0.00036%,-0.24151:0.00036%,14.4699:0.00018%,4.29964:0.00018%,4.90362:0.00018%,10.192739999999999:0.00018%,-3.3787199999999995:0.00018%,13.86459:0.00018%,4.44364:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,-43.76509:0.00018%,-5.08665:0.00018%,-58.035180000000004:0.00018%,4.076980000000001:0.00018%,-58.032509999999995:0.00018%,-1.27347:0.00018%,-1.2708:0.00018%,-1.02014:0.00018%,-5.1466400000000005:0.00018%,13.431270000000001:0.00018%,12.60597:0.00018%,1.47576:0.00018%,1.46509:0.00018%,14.253910000000001:0.00018%,-68.79874000000001:0.00018%,-0.24950999999999998:0.00018%,-2.1481:0.00018%,10.67005:0.00018%,-68.36943000000001:0.00018%]
[INFO] ** scada_tag:[3:25.98597%,1:21.08045%,5:18.15398%,4:17.44425%,2:17.32434%,0:0.01101%]
[INFO] ** service:[0.0048200000000000005:99.99201%,-211.73542999999998:0.00142%,-186.43601999999998:0.00124%,-211.08346:0.00107%,-211.08818:0.00107%,-205.44247:0.00089%,-211.09762999999998:0.00071%,-202.75898:0.00036%,-186.44547:0.00036%,-183.8612:0.00018%,-185.9872:0.00018%,-201.23771000000002:0.00018%,-211.35747999999998:0.00018%,-211.07873999999998:0.00018%]
[INFO] ** src:[22:38.40514%,9:25.98704%,7:18.15469%,1:17.44496%,21:0.00195%,3:0.0016%,2:0.00124%,11:0.00071%,10:0.00071%,4:0.00071%,14:0.00036%,8:0.00036%,17:0.00018%,15:0.00018%,13:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1529 (0.27163%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4145 - tp: 73332.0000 - fp: 6668.0000 - tn: 313332.0000 - fn: 6668.0000 - accuracy: 0.9667 - precision: 0.9166 - recall: 0.9166 - auc: 0.9742 - val_loss: 1.1652 - val_tp: 10575.0000 - val_fp: 9425.0000 - val_tn: 70575.0000 - val_fn: 9425.0000 - val_accuracy: 0.8115 - val_precision: 0.5288 - val_recall: 0.5288 - val_auc: 0.9138
[INFO] saving weights to checkpoints/lstm-epoch-9-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7330 - tp: 42841.0000 - fp: 37159.0000 - tn: 282841.0000 - fn: 37159.0000 - accuracy: 0.8142 - precision: 0.5355 - recall: 0.5355 - auc: 0.9093 - val_loss: 0.5772 - val_tp: 11319.0000 - val_fp: 8681.0000 - val_tn: 71319.0000 - val_fn: 8681.0000 - val_accuracy: 0.8264 - val_precision: 0.5659 - val_recall: 0.5659 - val_auc: 0.9350
[INFO] saving weights to checkpoints/lstm-epoch-9-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2897 - tp: 75035.0000 - fp: 4965.0000 - tn: 315035.0000 - fn: 4965.0000 - accuracy: 0.9752 - precision: 0.9379 - recall: 0.9379 - auc: 0.9894 - val_loss: 0.0883 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0484 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0023 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0173 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0357e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 4-4/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99769%,30:0.00124%,31:0.00036%,33:0.00018%,26:0.00018%,23:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:92.22236%,Single Stage Single Point:7.77764%]
[INFO] ** dst:[21:43.35206%,10:20.94703%,8:18.17725%,9:17.52011%,22:0.00124%,15:0.00124%,18:0.00036%,24:0.00018%,19:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99893%,0:0.00107%]
[INFO] ** i/f_name:[2:99.99876%,3:0.00124%]
[INFO] ** modbus_function_code:[0.02961:99.99769%,-33.760870000000004:0.00231%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.99805%,0:0.00231%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.99893%,2:0.00107%]
[INFO] ** proto:[0:99.99822%,1:0.00124%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.26071%,20:26.03874%,13:18.17725%,6:17.52047%,17:0.00124%,16:0.00053%,21:0.00036%,14:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.03802%,-0.32151:20.94685%,-1.27613:18.17689%,-0.23351:17.51993%,-0.33484:17.31386%,-71.33197:0.00124%,-1.02014:0.00053%,1.45709:0.00036%,-0.08551:0.00036%,-0.24151:0.00036%,-1.2708:0.00018%,14.4699:0.00018%,4.44364:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-49.275529999999996:0.00018%]
[INFO] ** scada_tag:[3:26.03785%,1:20.94668%,5:18.17689%,4:17.51958%,2:17.31368%,0:0.00533%]
[INFO] ** service:[0.0048200000000000005:99.99787%,-211.73542999999998:0.00124%,-186.43601999999998:0.00036%,-183.8612:0.00018%,-211.08346:0.00018%,-211.07873999999998:0.00018%]
[INFO] ** src:[22:38.26071%,9:26.03874%,7:18.17725%,1:17.52047%,21:0.00107%,15:0.00053%,4:0.00036%,17:0.00018%,14:0.00018%,8:0.00018%,3:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1539 (0.27341%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0138 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.6966e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0111 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5550e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0102 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3232e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0087 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.7006e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.9535 - tp: 48908.0000 - fp: 31092.0000 - tn: 288908.0000 - fn: 31092.0000 - accuracy: 0.8445 - precision: 0.6113 - recall: 0.6113 - auc: 0.9033 - val_loss: 0.7720 - val_tp: 7832.0000 - val_fp: 12168.0000 - val_tn: 67832.0000 - val_fn: 12168.0000 - val_accuracy: 0.7566 - val_precision: 0.3916 - val_recall: 0.3916 - val_auc: 0.8909
[INFO] saving weights to checkpoints/lstm-epoch-9-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 5-5/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99645%,30:0.00249%,37:0.00018%,26:0.00018%,12:0.00018%,9:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:89.89796%,Single Stage Single Point:10.10204%]
[INFO] ** dst:[21:43.36343%,10:20.76689%,8:18.23996%,9:17.62546%,15:0.00249%,22:0.00089%,25:0.00018%,24:0.00018%,6:0.00018%,2:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99787%,0:0.00213%]
[INFO] ** i/f_name:[2:99.99751%,3:0.00249%]
[INFO] ** modbus_function_code:[0.02961:99.99645%,-33.760870000000004:0.00355%]
[INFO] ** modbus_function_description:[7:49.99893%,11:49.99751%,0:0.00355%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.99805%,2:0.00195%]
[INFO] ** proto:[0:99.99716%,1:0.00249%,2:0.00036%]
[INFO] ** proxy_src_ip:[18:38.00382%,20:26.12685%,13:18.23996%,6:17.62564%,17:0.00249%,1:0.00036%,21:0.00018%,16:0.00018%,7:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.12614%,-0.32151:20.76654%,-1.27613:18.23978%,-0.23351:17.62528%,-0.33484:17.23729%,-71.33197:0.00249%,-0.24151:0.00036%,1.45709:0.00036%,1.47576:0.00018%,1.46509:0.00018%,-49.275529999999996:0.00018%,-1.27347:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,2.22906:0.00018%,14.4699:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.12579%,1:20.76636%,5:18.2396%,4:17.62528%,2:17.23729%,0:0.00568%]
[INFO] ** service:[0.0048200000000000005:99.9968%,-211.73542999999998:0.00249%,-183.8612:0.00018%,-211.08346:0.00018%,-211.35747999999998:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.00382%,9:26.12685%,7:18.23996%,1:17.62564%,21:0.00213%,14:0.00053%,3:0.00036%,16:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1540 (0.27359%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1876 - tp: 79481.0000 - fp: 519.0000 - tn: 319481.0000 - fn: 519.0000 - accuracy: 0.9974 - precision: 0.9935 - recall: 0.9935 - auc: 0.9985 - val_loss: 0.4321 - val_tp: 17868.0000 - val_fp: 2132.0000 - val_tn: 77868.0000 - val_fn: 2132.0000 - val_accuracy: 0.9574 - val_precision: 0.8934 - val_recall: 0.8934 - val_auc: 0.9661
[INFO] saving weights to checkpoints/lstm-epoch-9-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5558 - tp: 52368.0000 - fp: 27632.0000 - tn: 292368.0000 - fn: 27632.0000 - accuracy: 0.8618 - precision: 0.6546 - recall: 0.6546 - auc: 0.9576 - val_loss: 0.3432 - val_tp: 13579.0000 - val_fp: 6421.0000 - val_tn: 73579.0000 - val_fn: 6421.0000 - val_accuracy: 0.8716 - val_precision: 0.6790 - val_recall: 0.6790 - val_auc: 0.9742
[INFO] saving weights to checkpoints/lstm-epoch-9-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3135 - tp: 62367.0000 - fp: 17633.0000 - tn: 302367.0000 - fn: 17633.0000 - accuracy: 0.9118 - precision: 0.7796 - recall: 0.7796 - auc: 0.9790 - val_loss: 0.2435 - val_tp: 19257.0000 - val_fp: 743.0000 - val_tn: 79257.0000 - val_fn: 743.0000 - val_accuracy: 0.9851 - val_precision: 0.9628 - val_recall: 0.9628 - val_auc: 0.9937
[INFO] saving weights to checkpoints/lstm-epoch-9-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1023 - tp: 79643.0000 - fp: 357.0000 - tn: 319643.0000 - fn: 357.0000 - accuracy: 0.9982 - precision: 0.9955 - recall: 0.9955 - auc: 0.9998 - val_loss: 0.0031 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0217 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0010 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 6-6/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99591%,30:0.0032%,31:0.00018%,27:0.00018%,26:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:92.82194%,Single Stage Single Point:7.17806%]
[INFO] ** dst:[21:43.37764%,10:20.73154%,8:18.27602%,9:17.61%,15:0.0032%,22:0.00053%,25:0.00018%,24:0.00018%,18:0.00018%,12:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99698%,0:0.00302%]
[INFO] ** i/f_name:[2:99.9968%,3:0.0032%]
[INFO] ** modbus_function_code:[0.02961:99.99591%,-33.760870000000004:0.00409%]
[INFO] ** modbus_function_description:[7:49.99858%,11:49.99734%,0:0.00409%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.99964%,1:0.00036%]
[INFO] ** proto:[0:99.99591%,1:0.0032%,2:0.00089%]
[INFO] ** proxy_src_ip:[18:37.94253%,20:26.16682%,13:18.2762%,6:17.61018%,17:0.0032%,14:0.00053%,16:0.00036%,11:0.00018%]
[INFO] ** s_port:[1.45442:26.16647%,-0.32151:20.73154%,-1.27613:18.27567%,-0.23351:17.60982%,-0.33484:17.21099%,-71.33197:0.0032%,-1.02014:0.00036%,-71.14798:0.00018%,-64.19493:0.00018%,4.90362:0.00018%,-1.2708:0.00018%,-0.24151:0.00018%,13.431270000000001:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-68.36943000000001:0.00018%]
[INFO] ** scada_tag:[3:26.16629%,1:20.73118%,5:18.27549%,4:17.60947%,2:17.21082%,0:0.00675%]
[INFO] ** service:[0.0048200000000000005:99.99591%,-211.73542999999998:0.0032%,-211.08346:0.00018%,-201.23771000000002:0.00018%,-202.75898:0.00018%,-186.44547:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:37.94253%,9:26.16682%,7:18.2762%,1:17.61018%,14:0.0032%,2:0.00053%,15:0.00036%,10:0.00018%]
[INFO] ** type:[0:99.99911%,1:0.00089%]
[INFO] ** unixtime:1541 (0.27376%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0176 - tp: 79991.0000 - fp: 9.0000 - tn: 319991.0000 - fn: 9.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 7.0527e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0149 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7527e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0135 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7011e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0119 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0121e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3436 - tp: 69469.0000 - fp: 10531.0000 - tn: 309469.0000 - fn: 10531.0000 - accuracy: 0.9473 - precision: 0.8684 - recall: 0.8684 - auc: 0.9825 - val_loss: 0.4358 - val_tp: 12752.0000 - val_fp: 7248.0000 - val_tn: 72752.0000 - val_fn: 7248.0000 - val_accuracy: 0.8550 - val_precision: 0.6376 - val_recall: 0.6376 - val_auc: 0.9672
[INFO] saving weights to checkpoints/lstm-epoch-9-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 7-7/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99538%,30:0.0016%,22:0.00089%,17:0.00071%,26:0.00053%,31:0.00036%,28:0.00018%,27:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:80.62484%,Single Stage Single Point:19.37516%]
[INFO] ** dst:[21:43.35934%,10:20.74397%,8:18.25168%,9:17.6386%,15:0.0016%,22:0.00142%,6:0.00142%,16:0.00071%,24:0.00036%,18:0.00036%,17:0.00036%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.9984%,0:0.0016%]
[INFO] ** i/f_name:[2:99.9984%,3:0.0016%]
[INFO] ** modbus_function_code:[0.02961:99.99538%,-33.760870000000004:0.00462%]
[INFO] ** modbus_function_description:[7:49.9984%,11:49.99698%,0:0.00462%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99645%,2:0.00195%,1:0.0016%]
[INFO] ** proxy_src_ip:[18:37.96758%,20:26.13644%,13:18.25204%,6:17.63878%,17:0.0016%,11:0.00071%,1:0.00071%,21:0.00053%,16:0.00053%,14:0.00036%,7:0.00036%,10:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13556%,-0.32151:20.74397%,-1.27613:18.25151%,-0.23351:17.63843%,-0.33484:17.22361%,-71.33197:0.0016%,-71.14931:0.00089%,-1.02014:0.00053%,-71.14798:0.00053%,1.45709:0.00053%,-0.24151:0.00036%,-1.27347:0.00036%,1.47576:0.00018%,1.46509:0.00018%,14.253910000000001:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,-68.79874000000001:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,6.1115699999999995:0.00018%,-5.08665:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:26.1352%,1:20.74397%,5:18.25133%,4:17.63825%,2:17.22361%,0:0.00764%]
[INFO] ** service:[0.0048200000000000005:99.99538%,-211.73542999999998:0.0016%,-211.08818:0.00089%,-205.44247:0.00071%,-211.08346:0.00053%,-186.43601999999998:0.00036%,-211.09762999999998:0.00018%,-185.9872:0.00018%,-202.75898:0.00018%]
[INFO] ** src:[22:37.96758%,9:26.13644%,7:18.25204%,1:17.63878%,14:0.0016%,10:0.00071%,3:0.00071%,15:0.00053%,4:0.00053%,21:0.00036%,2:0.00036%,11:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1538 (0.27323%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2786 - tp: 63598.0000 - fp: 16402.0000 - tn: 303598.0000 - fn: 16402.0000 - accuracy: 0.9180 - precision: 0.7950 - recall: 0.7950 - auc: 0.9810 - val_loss: 0.1352 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1047 - tp: 78275.0000 - fp: 1725.0000 - tn: 318275.0000 - fn: 1725.0000 - accuracy: 0.9914 - precision: 0.9784 - recall: 0.9784 - auc: 0.9992 - val_loss: 0.0032 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0475 - tp: 78330.0000 - fp: 1670.0000 - tn: 318330.0000 - fn: 1670.0000 - accuracy: 0.9917 - precision: 0.9791 - recall: 0.9791 - auc: 0.9997 - val_loss: 1.0008e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3869 - tp: 66811.0000 - fp: 13189.0000 - tn: 306811.0000 - fn: 13189.0000 - accuracy: 0.9341 - precision: 0.8351 - recall: 0.8351 - auc: 0.9787 - val_loss: 0.0365 - val_tp: 19967.0000 - val_fp: 33.0000 - val_tn: 79967.0000 - val_fn: 33.0000 - val_accuracy: 0.9993 - val_precision: 0.9984 - val_recall: 0.9984 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0289 - tp: 79994.0000 - fp: 6.0000 - tn: 319994.0000 - fn: 6.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 5.5633e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 8-8/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99716%,30:0.00107%,0:0.00053%,24:0.00018%,23:0.00018%,22:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:94.92304%,Single Stage Single Point:5.07696%]
[INFO] ** dst:[21:43.42081%,10:20.79905%,8:18.19537%,9:17.58122%,22:0.00124%,15:0.00107%,25:0.00053%,19:0.00036%,26:0.00018%,24:0.00018%]
[INFO] ** i/f_dir:[1:99.99929%,0:0.00071%]
[INFO] ** i/f_name:[2:99.99893%,3:0.00107%]
[INFO] ** modbus_function_code:[0.02961:99.99716%,-33.760870000000004:0.00266%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.99751%,0:0.00266%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.99964%,2:0.00036%]
[INFO] ** proto:[0:99.99822%,1:0.00107%,2:0.00071%]
[INFO] ** proxy_src_ip:[18:38.08075%,20:26.13964%,13:18.19466%,6:17.58158%,17:0.00107%,10:0.00107%,16:0.00053%,14:0.00036%,11:0.00018%,5:0.00018%]
[INFO] ** s_port:[1.45442:26.13911%,-0.32151:20.79905%,-1.27613:18.19448%,-0.23351:17.58105%,-0.33484:17.2817%,-71.33197:0.00107%,-15.039579999999999:0.00071%,-1.02014:0.00053%,-64.19493:0.00053%,1.45709:0.00036%,-0.24151:0.00036%,4.66896:0.00036%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.13858%,1:20.79887%,5:18.19448%,4:17.58087%,2:17.28152%,0:0.00568%]
[INFO] ** service:[0.0048200000000000005:99.99787%,-211.73542999999998:0.00107%,-186.44547:0.00053%,-211.07873999999998:0.00036%,-211.08818:0.00018%]
[INFO] ** src:[22:38.08075%,9:26.13964%,7:18.19466%,1:17.58158%,11:0.00107%,14:0.00071%,15:0.00053%,21:0.00036%,2:0.00036%,16:0.00018%,10:0.00018%]
[INFO] ** type:[0:99.99947%,1:0.00036%,2:0.00018%]
[INFO] ** unixtime:1541 (0.27376%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0193 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2432e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0162 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0640e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0155 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.9817e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0132 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6432e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4755 - tp: 66394.0000 - fp: 13606.0000 - tn: 306394.0000 - fn: 13606.0000 - accuracy: 0.9320 - precision: 0.8299 - recall: 0.8299 - auc: 0.9731 - val_loss: 0.2620 - val_tp: 16362.0000 - val_fp: 3638.0000 - val_tn: 76362.0000 - val_fn: 3638.0000 - val_accuracy: 0.9272 - val_precision: 0.8181 - val_recall: 0.8181 - val_auc: 0.9837
[INFO] saving weights to checkpoints/lstm-epoch-9-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 9-9/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99822%,30:0.00107%,31:0.00036%,26:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:94.51106%,Single Stage Single Point:5.48894%]
[INFO] ** dst:[21:43.3732%,10:20.77133%,8:18.28153%,9:17.5711%,15:0.00107%,22:0.00089%,18:0.00036%,25:0.00018%,24:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99893%,0:0.00107%]
[INFO] ** i/f_name:[2:99.99893%,3:0.00107%]
[INFO] ** modbus_function_code:[0.02961:99.99822%,-33.760870000000004:0.00178%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99822%,0:0.00178%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.99964%,2:0.00036%]
[INFO] ** proto:[0:99.99822%,1:0.00107%,2:0.00071%]
[INFO] ** proxy_src_ip:[18:38.00755%,20:26.13751%,13:18.28153%,6:17.57145%,17:0.00107%,21:0.00018%,16:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.1368%,-0.32151:20.77133%,-1.27613:18.28117%,-0.23351:17.57092%,-0.33484:17.23622%,-71.33197:0.00107%,-0.24151:0.00036%,1.45709:0.00036%,-0.08551:0.00036%,1.46509:0.00018%,1.47576:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.13644%,1:20.77115%,5:18.28117%,4:17.57074%,2:17.23604%,0:0.00444%]
[INFO] ** service:[0.0048200000000000005:99.99822%,-211.73542999999998:0.00107%,-186.43601999999998:0.00036%,-211.08346:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.00755%,9:26.13751%,7:18.28153%,1:17.57145%,14:0.00071%,21:0.00036%,17:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1541 (0.27376%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1652 - tp: 73520.0000 - fp: 6480.0000 - tn: 313520.0000 - fn: 6480.0000 - accuracy: 0.9676 - precision: 0.9190 - recall: 0.9190 - auc: 0.9956 - val_loss: 0.0501 - val_tp: 19505.0000 - val_fp: 495.0000 - val_tn: 79505.0000 - val_fn: 495.0000 - val_accuracy: 0.9901 - val_precision: 0.9753 - val_recall: 0.9753 - val_auc: 0.9996
[INFO] saving weights to checkpoints/lstm-epoch-9-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1377 - tp: 76646.0000 - fp: 3354.0000 - tn: 316646.0000 - fn: 3354.0000 - accuracy: 0.9832 - precision: 0.9581 - recall: 0.9581 - auc: 0.9964 - val_loss: 0.4049 - val_tp: 16364.0000 - val_fp: 3636.0000 - val_tn: 76364.0000 - val_fn: 3636.0000 - val_accuracy: 0.9273 - val_precision: 0.8182 - val_recall: 0.8182 - val_auc: 0.9891
[INFO] saving weights to checkpoints/lstm-epoch-9-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0290 - tp: 79726.0000 - fp: 274.0000 - tn: 319726.0000 - fn: 274.0000 - accuracy: 0.9986 - precision: 0.9966 - recall: 0.9966 - auc: 0.9999 - val_loss: 9.4892e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0140 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0353e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0114 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4060e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 10-10/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99627%,30:0.00178%,31:0.00036%,26:0.00018%,24:0.00018%,23:0.00018%,22:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:94.57289%,Single Stage Single Point:5.42711%]
[INFO] ** dst:[21:43.41353%,10:20.80526%,8:18.22433%,9:17.55298%,15:0.00178%,22:0.00053%,24:0.00036%,19:0.00036%,18:0.00036%,26:0.00018%,25:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.9984%,0:0.0016%]
[INFO] ** i/f_name:[2:99.99822%,3:0.00178%]
[INFO] ** modbus_function_code:[0.02961:99.99627%,-33.760870000000004:0.00355%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99876%,11:49.99751%,0:0.00355%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.99929%,1:0.00071%]
[INFO] ** proto:[0:99.99734%,1:0.00178%,2:0.00089%]
[INFO] ** proxy_src_ip:[18:38.08217%,20:26.13715%,13:18.2245%,6:17.55227%,17:0.00178%,10:0.00089%,14:0.00036%,21:0.00018%,16:0.00018%,5:0.00018%,2:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13644%,-0.32151:20.80526%,-1.27613:18.22397%,-0.23351:17.55191%,-0.33484:17.2769%,-71.33197:0.00178%,-10.51843:0.00071%,-0.08551:0.00036%,-1.27347:0.00036%,5.71692:0.00036%,1.47576:0.00036%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-71.14931:0.00018%,-64.19493:0.00018%,1.45709:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.13609%,1:20.80509%,5:18.22397%,4:17.55173%,2:17.27673%,0:0.0064%]
[INFO] ** service:[0.0048200000000000005:99.99698%,-211.73542999999998:0.00178%,-211.07873999999998:0.00036%,-186.43601999999998:0.00036%,-211.08346:0.00018%,-186.44547:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.08217%,9:26.13715%,7:18.2245%,1:17.55227%,14:0.00178%,11:0.00089%,2:0.00036%,17:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%]
[INFO] ** type:[0:99.99858%,1:0.00124%,2:0.00018%]
[INFO] ** unixtime:1538 (0.27323%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0097 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3481e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0082 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.8257e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3476 - tp: 66551.0000 - fp: 13449.0000 - tn: 306551.0000 - fn: 13449.0000 - accuracy: 0.9328 - precision: 0.8319 - recall: 0.8319 - auc: 0.9810 - val_loss: 0.3079 - val_tp: 12834.0000 - val_fp: 7166.0000 - val_tn: 72834.0000 - val_fn: 7166.0000 - val_accuracy: 0.8567 - val_precision: 0.6417 - val_recall: 0.6417 - val_auc: 0.9679
[INFO] saving weights to checkpoints/lstm-epoch-9-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2432 - tp: 69808.0000 - fp: 10192.0000 - tn: 309808.0000 - fn: 10192.0000 - accuracy: 0.9490 - precision: 0.8726 - recall: 0.8726 - auc: 0.9887 - val_loss: 0.1463 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0819 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0025 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 11-11/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99893%,31:0.00036%,30:0.00036%,26:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.39221%,10:20.87455%,8:18.19484%,9:17.5361%,22:0.00124%,18:0.00036%,15:0.00036%,25:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99964%,3:0.00036%]
[INFO] ** modbus_function_code:[0.02961:99.99893%,-33.760870000000004:0.00107%]
[INFO] ** modbus_function_description:[7:50.00071%,11:49.99822%,0:0.00107%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99893%,2:0.00071%,1:0.00036%]
[INFO] ** proxy_src_ip:[18:38.14843%,20:26.11868%,13:18.19484%,6:17.53645%,16:0.00053%,17:0.00036%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.11815%,-0.32151:20.87455%,-1.27613:18.19466%,-0.23351:17.53592%,-0.33484:17.27388%,-0.24151:0.00053%,-1.02014:0.00053%,-0.08551:0.00036%,-71.33197:0.00036%,-71.14798:0.00018%,1.45709:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:26.11779%,1:20.87437%,5:18.19448%,4:17.53557%,2:17.27371%,0:0.00409%]
[INFO] ** service:[0.0048200000000000005:99.99893%,-211.73542999999998:0.00036%,-186.43601999999998:0.00036%,-211.08346:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.14843%,9:26.11868%,7:18.19484%,1:17.53645%,15:0.00053%,14:0.00036%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1538 (0.27323%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0076 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0017 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0063 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.5876e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0055 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.2154e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0049 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3945e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0044 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2224e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 12-12/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99787%,30:0.00195%,9:0.00018%]
[INFO] ** classification:[normal:93.57057%,Single Stage Single Point:6.42943%]
[INFO] ** dst:[21:43.40447%,10:20.88254%,8:18.17654%,9:17.53343%,15:0.00195%,22:0.00053%,24:0.00036%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.9984%,0:0.0016%]
[INFO] ** i/f_name:[2:99.99805%,3:0.00195%]
[INFO] ** modbus_function_code:[0.02961:99.99787%,-33.760870000000004:0.00213%]
[INFO] ** modbus_function_description:[7:49.99982%,11:49.99805%,0:0.00213%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.9984%,2:0.0016%]
[INFO] ** proto:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip:[18:38.15536%,20:26.132%,13:18.17671%,6:17.53361%,17:0.00195%,16:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:26.13147%,-0.32151:20.88254%,-1.27613:18.17618%,-0.23351:17.53326%,-0.33484:17.27282%,-71.33197:0.00195%,-1.27347:0.00036%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:26.13111%,1:20.88254%,5:18.17618%,4:17.5329%,2:17.27282%,0:0.00444%]
[INFO] ** service:[0.0048200000000000005:99.99787%,-211.73542999999998:0.00195%,-183.8612:0.00018%]
[INFO] ** src:[22:38.15536%,9:26.132%,7:18.17671%,1:17.53361%,21:0.0016%,14:0.00036%,15:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1539 (0.27341%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0041 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3549e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0036 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3696e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3898 - tp: 70580.0000 - fp: 9420.0000 - tn: 310580.0000 - fn: 9420.0000 - accuracy: 0.9529 - precision: 0.8823 - recall: 0.8823 - auc: 0.9816 - val_loss: 0.5705 - val_tp: 12828.0000 - val_fp: 7172.0000 - val_tn: 72828.0000 - val_fn: 7172.0000 - val_accuracy: 0.8566 - val_precision: 0.6414 - val_recall: 0.6414 - val_auc: 0.9678
[INFO] saving weights to checkpoints/lstm-epoch-9-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2965 - tp: 65060.0000 - fp: 14940.0000 - tn: 305060.0000 - fn: 14940.0000 - accuracy: 0.9253 - precision: 0.8133 - recall: 0.8133 - auc: 0.9825 - val_loss: 0.3544 - val_tp: 12849.0000 - val_fp: 7151.0000 - val_tn: 72849.0000 - val_fn: 7151.0000 - val_accuracy: 0.8570 - val_precision: 0.6424 - val_recall: 0.6424 - val_auc: 0.9680
[INFO] saving weights to checkpoints/lstm-epoch-9-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1263 - tp: 78682.0000 - fp: 1318.0000 - tn: 318682.0000 - fn: 1318.0000 - accuracy: 0.9934 - precision: 0.9835 - recall: 0.9835 - auc: 0.9995 - val_loss: 0.0672 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 13-13/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99662%,31:0.00071%,26:0.00053%,0:0.00053%,30:0.00036%,22:0.00036%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:86.40726%,Single Stage Single Point:13.59274%]
[INFO] ** dst:[21:43.35881%,10:20.8058%,8:18.27442%,9:17.55706%,22:0.00107%,6:0.00089%,18:0.00071%,25:0.00053%,15:0.00036%,24:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99964%,3:0.00036%]
[INFO] ** modbus_function_code:[0.02961:99.99662%,-33.760870000000004:0.0032%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99876%,11:49.99787%,0:0.0032%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99734%,2:0.00231%,1:0.00036%]
[INFO] ** proxy_src_ip:[18:38.05392%,20:26.11104%,13:18.2746%,6:17.55653%,10:0.00107%,11:0.00089%,16:0.00053%,17:0.00036%,7:0.00036%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.11051%,-0.32151:20.8058%,-1.27613:18.27425%,-0.23351:17.55617%,-0.33484:17.24812%,-9.78512:0.00071%,-64.19493:0.00053%,-1.02014:0.00053%,-71.14798:0.00053%,-0.24151:0.00036%,-71.14931:0.00036%,-0.08551:0.00036%,-71.33197:0.00036%,1.47576:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-1.2708:0.00018%,-68.79874000000001:0.00018%,6.1115699999999995:0.00018%,14.540560000000001:0.00018%,1.45709:0.00018%]
[INFO] ** scada_tag:[3:26.11015%,1:20.80562%,5:18.27425%,4:17.55617%,2:17.24795%,0:0.00586%]
[INFO] ** service:[0.0048200000000000005:99.99734%,-186.43601999999998:0.00071%,-211.08346:0.00053%,-186.44547:0.00053%,-211.73542999999998:0.00036%,-211.08818:0.00036%,-202.75898:0.00018%]
[INFO] ** src:[22:38.05392%,9:26.11104%,7:18.2746%,1:17.55653%,11:0.00107%,10:0.00089%,15:0.00053%,21:0.00036%,14:0.00036%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1538 (0.27323%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0502 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0190 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0142 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4557e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0048 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.0475e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4103 - tp: 68883.0000 - fp: 11117.0000 - tn: 308883.0000 - fn: 11117.0000 - accuracy: 0.9444 - precision: 0.8610 - recall: 0.8610 - auc: 0.9819 - val_loss: 0.5610 - val_tp: 12826.0000 - val_fp: 7174.0000 - val_tn: 72826.0000 - val_fn: 7174.0000 - val_accuracy: 0.8565 - val_precision: 0.6413 - val_recall: 0.6413 - val_auc: 0.9678
[INFO] saving weights to checkpoints/lstm-epoch-9-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1999 - tp: 69516.0000 - fp: 10484.0000 - tn: 309516.0000 - fn: 10484.0000 - accuracy: 0.9476 - precision: 0.8690 - recall: 0.8690 - auc: 0.9932 - val_loss: 0.0070 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-9-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 14-14/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99947%,30:0.00018%,26:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:92.90757%,Single Stage Single Point:7.09243%]
[INFO] ** dst:[21:43.35188%,10:20.81024%,8:18.26323%,9:17.57305%,22:0.00071%,24:0.00036%,15:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:99.99982%,3:0.00018%]
[INFO] ** modbus_function_code:[0.02961:99.99947%,-33.760870000000004:0.00053%]
[INFO] ** modbus_function_description:[7:50.00053%,11:49.99893%,0:0.00053%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99964%,2:0.00018%,1:0.00018%]
[INFO] ** proxy_src_ip:[18:38.05126%,20:26.1114%,13:18.26341%,6:17.57323%,21:0.00018%,17:0.00018%,16:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:26.11068%,-0.32151:20.81024%,-1.27613:18.26288%,-0.23351:17.57287%,-0.33484:17.24102%,-1.27347:0.00036%,1.45709:0.00036%,-71.14798:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,14.4699:0.00018%,-71.33197:0.00018%]
[INFO] ** scada_tag:[3:26.11033%,1:20.81024%,5:18.2627%,4:17.57252%,2:17.24084%,0:0.00338%]
[INFO] ** service:[0.0048200000000000005:99.99947%,-183.8612:0.00018%,-211.08346:0.00018%,-211.73542999999998:0.00018%]
[INFO] ** src:[22:38.05126%,9:26.1114%,7:18.26341%,1:17.57323%,15:0.00018%,14:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1538 (0.27323%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0300 - tp: 78909.0000 - fp: 1091.0000 - tn: 318909.0000 - fn: 1091.0000 - accuracy: 0.9945 - precision: 0.9864 - recall: 0.9864 - auc: 0.9999 - val_loss: 6.1156e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5069 - tp: 73289.0000 - fp: 6711.0000 - tn: 313289.0000 - fn: 6711.0000 - accuracy: 0.9664 - precision: 0.9161 - recall: 0.9161 - auc: 0.9766 - val_loss: 0.0756 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0366 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0070 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0129 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0021 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0092 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.5937e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 15-15/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99627%,30:0.00302%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:90.18824%,Single Stage Multi Point:9.81105%,Single Stage Single Point:0.00071%]
[INFO] ** dst:[21:43.30462%,10:20.77684%,8:18.31209%,9:17.60112%,15:0.00302%,22:0.0016%,25:0.00018%,24:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99716%,0:0.00284%]
[INFO] ** i/f_name:[2:99.99698%,3:0.00302%]
[INFO] ** modbus_function_code:[0.02961:99.99627%,-33.760870000000004:0.00373%]
[INFO] ** modbus_function_description:[7:49.99911%,11:49.99716%,0:0.00373%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.99734%,2:0.00266%]
[INFO] ** proto:[0:99.99662%,1:0.00302%,2:0.00036%]
[INFO] ** proxy_src_ip:[18:38.01093%,20:26.07125%,13:18.31173%,6:17.60165%,17:0.00302%,16:0.00071%,7:0.00036%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.07036%,-0.32151:20.77666%,-1.27613:18.31155%,-0.23351:17.60094%,-0.33484:17.23427%,-71.33197:0.00302%,-1.02014:0.00071%,-0.24151:0.00053%,1.46509:0.00036%,1.45709:0.00036%,1.47576:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-61.95768:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.07%,1:20.77648%,5:18.31155%,4:17.60059%,2:17.23409%,0:0.00728%]
[INFO] ** service:[0.0048200000000000005:99.99645%,-211.73542999999998:0.00302%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.01093%,9:26.07125%,7:18.31173%,1:17.60165%,21:0.00302%,15:0.00071%,14:0.00036%,16:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1547 (0.27483%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0082 - tp: 79986.0000 - fp: 14.0000 - tn: 319986.0000 - fn: 14.0000 - accuracy: 0.9999 - precision: 0.9998 - recall: 0.9998 - auc: 1.0000 - val_loss: 5.3614e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0068 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6785e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0061 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6152e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0052 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.2107e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.3155 - tp: 63563.0000 - fp: 16437.0000 - tn: 303563.0000 - fn: 16437.0000 - accuracy: 0.9178 - precision: 0.7945 - recall: 0.7945 - auc: 0.8700 - val_loss: 7.5232 - val_tp: 10665.0000 - val_fp: 9335.0000 - val_tn: 70665.0000 - val_fn: 9335.0000 - val_accuracy: 0.8133 - val_precision: 0.5332 - val_recall: 0.5332 - val_auc: 0.7083
[INFO] saving weights to checkpoints/lstm-epoch-9-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 16-16/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (502586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (502586, 17)

[INFO] analyzing data
[INFO] 502586 rows
[INFO] ** appi_name:[21:99.99821%,30:0.00159%,33:0.0002%]
[INFO] ** classification:[normal:80.50821%,Single Stage Multi Point:19.49179%]
[INFO] ** dst:[21:43.34661%,10:20.79465%,8:18.26155%,9:17.5942%,15:0.00159%,22:0.00119%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.99841%,0:0.00159%]
[INFO] ** i/f_name:[2:99.99841%,3:0.00159%]
[INFO] ** modbus_function_code:[0.02961:99.99821%,-33.760870000000004:0.00179%]
[INFO] ** modbus_function_description:[7:50.0004%,11:49.99781%,0:0.00179%]
[INFO] ** modbus_transaction_id:65536 (13.03976%)
[INFO] ** orig:[0:99.99841%,2:0.00159%]
[INFO] ** proto:[0:99.99841%,1:0.00159%]
[INFO] ** proxy_src_ip:[18:38.04065%,20:26.10081%,13:18.26195%,6:17.5944%,17:0.00159%,16:0.0004%,21:0.0002%]
[INFO] ** s_port:[1.45442:26.10021%,-0.32151:20.79445%,-1.27613:18.26155%,-0.23351:17.594%,-0.33484:17.2462%,-71.33197:0.00159%,1.45709:0.0004%,-0.24151:0.0004%,-1.02014:0.0004%,-1.27347:0.0002%,1.47576:0.0002%,-49.275529999999996:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:26.09981%,1:20.79425%,5:18.26135%,4:17.59361%,2:17.246%,0:0.00497%]
[INFO] ** service:[0.0048200000000000005:99.99841%,-211.73542999999998:0.00159%]
[INFO] ** src:[22:38.04065%,9:26.10081%,7:18.26195%,1:17.5944%,21:0.00159%,15:0.0004%,4:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1376 (0.27378%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5606 - tp: 42486.0000 - fp: 37514.0000 - tn: 282486.0000 - fn: 37514.0000 - accuracy: 0.8124 - precision: 0.5311 - recall: 0.5311 - auc: 0.7041 - val_loss: 7.5490 - val_tp: 10633.0000 - val_fp: 9367.0000 - val_tn: 70633.0000 - val_fn: 9367.0000 - val_accuracy: 0.8127 - val_precision: 0.5317 - val_recall: 0.5317 - val_auc: 0.7073
[INFO] saving weights to checkpoints/lstm-epoch-9-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5493 - tp: 42542.0000 - fp: 37458.0000 - tn: 282542.0000 - fn: 37458.0000 - accuracy: 0.8127 - precision: 0.5318 - recall: 0.5318 - auc: 0.7043 - val_loss: 7.5731 - val_tp: 10603.0000 - val_fp: 9397.0000 - val_tn: 70603.0000 - val_fn: 9397.0000 - val_accuracy: 0.8121 - val_precision: 0.5301 - val_recall: 0.5301 - val_auc: 0.7063
[INFO] saving weights to checkpoints/lstm-epoch-9-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8554 - tp: 75773.0000 - fp: 4227.0000 - tn: 315773.0000 - fn: 4227.0000 - accuracy: 0.9789 - precision: 0.9472 - recall: 0.9472 - auc: 0.9667 - val_loss: 2.2518e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0037 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5872e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0034 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.3545e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-15-16-batch-400000-500000
[INFO] processing batch 500000-600000/502586
[33m[INFO] loading file 17-17/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (502586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (502586, 17)

[INFO] analyzing data
[INFO] 502586 rows
[INFO] ** appi_name:[21:99.99702%,7:0.0006%,26:0.0004%,0:0.0004%,31:0.0002%,27:0.0002%,24:0.0002%,22:0.0002%,16:0.0002%,15:0.0002%,8:0.0002%,5:0.0002%]
[INFO] ** classification:[normal:93.86175%,Multi Stage Multi Point:6.13825%]
[INFO] ** dst:[21:43.35298%,10:20.85195%,8:18.19171%,9:17.60017%,22:0.0008%,6:0.0006%,25:0.0004%,16:0.0004%,2:0.0004%,24:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99702%,-33.760870000000004:0.00279%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9994%,11:49.99761%,0:0.00279%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.03976%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99861%,2:0.00139%]
[INFO] ** proxy_src_ip:[18:38.08841%,20:26.11712%,13:18.19112%,6:17.60017%,10:0.00119%,11:0.00099%,1:0.0004%,16:0.0002%,14:0.0002%,7:0.0002%]
[INFO] ** s_port:[1.45442:26.11633%,-0.32151:20.85195%,-1.27613:18.19072%,-0.23351:17.59997%,-0.33484:17.23645%,6.0369:0.0008%,-64.19493:0.0004%,-71.14798:0.0004%,1.45709:0.0004%,-3.3787199999999995:0.0002%,-68.79874000000001:0.0002%,-1.27347:0.0002%,1.46509:0.0002%,1.47576:0.0002%,8.55414:0.0002%,6.06224:0.0002%,-4.3880099999999995:0.0002%,-0.24151:0.0002%,-71.14931:0.0002%,-1.02014:0.0002%,6.15557:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:26.11613%,1:20.85175%,5:18.19052%,4:17.59957%,2:17.23645%,0:0.00557%]
[INFO] ** service:[0.0048200000000000005:99.99781%,-211.09762999999998:0.0006%,-186.44547:0.0004%,-211.08346:0.0004%,-186.43601999999998:0.0002%,-211.35747999999998:0.0002%,-211.08818:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:38.08841%,9:26.11712%,7:18.19112%,1:17.60017%,11:0.00119%,10:0.00099%,3:0.0004%,21:0.0002%,15:0.0002%,2:0.0002%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** unixtime:1374 (0.27339%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0030 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.8204e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0026 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.9930e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0024 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8940 - val_tp: 16409.0000 - val_fp: 3591.0000 - val_tn: 76409.0000 - val_fn: 3591.0000 - val_accuracy: 0.9282 - val_precision: 0.8205 - val_recall: 0.8205 - val_auc: 0.8878
[INFO] saving weights to checkpoints/lstm-epoch-9-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9266 - tp: 65483.0000 - fp: 14517.0000 - tn: 305483.0000 - fn: 14517.0000 - accuracy: 0.9274 - precision: 0.8185 - recall: 0.8185 - auc: 0.8859 - val_loss: 2.9045 - val_tp: 16396.0000 - val_fp: 3604.0000 - val_tn: 76396.0000 - val_fn: 3604.0000 - val_accuracy: 0.9279 - val_precision: 0.8198 - val_recall: 0.8198 - val_auc: 0.8874
[INFO] saving weights to checkpoints/lstm-epoch-9-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.8429 - tp: 70862.0000 - fp: 9138.0000 - tn: 310862.0000 - fn: 9138.0000 - accuracy: 0.9543 - precision: 0.8858 - recall: 0.8858 - auc: 0.9281 - val_loss: 2.1040e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/502586
[33m[INFO] loading file 18-18/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (502586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (502586, 17)

[INFO] analyzing data
[INFO] 502586 rows
[INFO] ** appi_name:[21:99.99801%,30:0.0006%,7:0.0006%,31:0.0002%,27:0.0002%,22:0.0002%,8:0.0002%]
[INFO] ** classification:[normal:80.70022%,Multi Stage Multi Point:19.29978%]
[INFO] ** dst:[21:43.34243%,10:20.8235%,8:18.27488%,9:17.5562%,22:0.0006%,15:0.0006%,24:0.0004%,16:0.0004%,2:0.0004%,18:0.0002%,7:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.9994%,0:0.0006%]
[INFO] ** i/f_name:[2:99.9994%,3:0.0006%]
[INFO] ** modbus_function_code:[0.02961:99.99801%,-33.760870000000004:0.00199%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.99821%,0:0.00199%]
[INFO] ** modbus_transaction_id:65536 (13.03976%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99881%,2:0.0006%,1:0.0006%]
[INFO] ** proxy_src_ip:[18:38.06274%,20:26.10379%,13:18.27528%,6:17.5562%,17:0.0006%,11:0.0006%,1:0.0004%,14:0.0002%,7:0.0002%]
[INFO] ** s_port:[1.45442:26.103%,-0.32151:20.8235%,-1.27613:18.27468%,-0.23351:17.556%,-0.33484:17.23924%,-71.33197:0.0006%,1.45709:0.0004%,-1.27347:0.0004%,-1.2708:0.0002%,-71.14931:0.0002%,-0.24151:0.0002%,6.45955:0.0002%,-2.48275:0.0002%,1.47576:0.0002%,1.46509:0.0002%,-3.3787199999999995:0.0002%,3.6236699999999997:0.0002%,6.06224:0.0002%,8.10082:0.0002%]
[INFO] ** scada_tag:[3:26.1026%,1:20.8233%,5:18.27448%,4:17.5558%,2:17.23904%,0:0.00478%]
[INFO] ** service:[0.0048200000000000005:99.99801%,-211.09762999999998:0.0006%,-211.73542999999998:0.0006%,-186.43601999999998:0.0002%,-211.35747999999998:0.0002%,-211.08818:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:38.06274%,9:26.10379%,7:18.27528%,1:17.5562%,14:0.0006%,10:0.0006%,3:0.0004%,21:0.0002%,2:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1374 (0.27339%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.4302 - tp: 58018.0000 - fp: 21982.0000 - tn: 298018.0000 - fn: 21982.0000 - accuracy: 0.8901 - precision: 0.7252 - recall: 0.7252 - auc: 0.8271 - val_loss: 6.1039 - val_tp: 12426.0000 - val_fp: 7574.0000 - val_tn: 72426.0000 - val_fn: 7574.0000 - val_accuracy: 0.8485 - val_precision: 0.6213 - val_recall: 0.6213 - val_auc: 0.7633
[INFO] saving weights to checkpoints/lstm-epoch-9-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1342 - tp: 49559.0000 - fp: 30441.0000 - tn: 289559.0000 - fn: 30441.0000 - accuracy: 0.8478 - precision: 0.6195 - recall: 0.6195 - auc: 0.7606 - val_loss: 6.1426 - val_tp: 12378.0000 - val_fp: 7622.0000 - val_tn: 72378.0000 - val_fn: 7622.0000 - val_accuracy: 0.8476 - val_precision: 0.6189 - val_recall: 0.6189 - val_auc: 0.7618
[INFO] saving weights to checkpoints/lstm-epoch-9-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.9202 - tp: 50621.0000 - fp: 29379.0000 - tn: 290621.0000 - fn: 29379.0000 - accuracy: 0.8531 - precision: 0.6328 - recall: 0.6328 - auc: 0.7690 - val_loss: 9.4178e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0014 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.3503e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0013 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.9669e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/502586
[33m[INFO] loading file 19-19/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (502586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (502586, 17)

[INFO] analyzing data
[INFO] 502586 rows
[INFO] ** appi_name:[21:99.99781%,26:0.0004%,0:0.0004%,31:0.0002%,27:0.0002%,24:0.0002%,22:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** classification:[normal:85.76164%,Single Stage Multi Point:14.23836%]
[INFO] ** dst:[21:43.38302%,10:20.82947%,8:18.21101%,9:17.57351%,22:0.00139%,6:0.0006%,25:0.0004%,24:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99781%,-33.760870000000004:0.00199%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.99801%,0:0.00199%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.03976%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99861%,2:0.00139%]
[INFO] ** proxy_src_ip:[18:38.11825%,20:26.09424%,13:18.21121%,6:17.57351%,10:0.00119%,11:0.00099%,16:0.0006%]
[INFO] ** s_port:[1.45442:26.09325%,-0.32151:20.82947%,-1.27613:18.21081%,-0.23351:17.57331%,-0.33484:17.28878%,-5.20264:0.0008%,1.45709:0.0006%,-1.02014:0.0006%,-64.19493:0.0004%,-71.14798:0.0004%,-1.27347:0.0002%,1.47576:0.0002%,-0.24151:0.0002%,-71.14931:0.0002%,1.46509:0.0002%,-68.79874000000001:0.0002%,-1.2708:0.0002%,0.75578:0.0002%]
[INFO] ** scada_tag:[3:26.09285%,1:20.82927%,5:18.21061%,4:17.57311%,2:17.28878%,0:0.00537%]
[INFO] ** service:[0.0048200000000000005:99.99861%,-186.44547:0.0004%,-211.08346:0.0004%,-186.43601999999998:0.0002%,-211.08818:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:38.11825%,9:26.09424%,7:18.21121%,1:17.57351%,11:0.00119%,10:0.00099%,15:0.0006%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** unixtime:1375 (0.27359%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0011 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3417e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.6681e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7303e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.4592e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7286e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.6997 - tp: 46749.0000 - fp: 33251.0000 - tn: 286749.0000 - fn: 33251.0000 - accuracy: 0.8337 - precision: 0.5844 - recall: 0.5844 - auc: 0.7386 - val_loss: 9.8425 - val_tp: 7787.0000 - val_fp: 12213.0000 - val_tn: 67787.0000 - val_fn: 12213.0000 - val_accuracy: 0.7557 - val_precision: 0.3893 - val_recall: 0.3893 - val_auc: 0.6183
[INFO] saving weights to checkpoints/lstm-epoch-9-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.2582 - tp: 53904.0000 - fp: 26096.0000 - tn: 293904.0000 - fn: 26096.0000 - accuracy: 0.8695 - precision: 0.6738 - recall: 0.6738 - auc: 0.7949 - val_loss: 2.5045e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/502586
[33m[INFO] loading file 20-20/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (502586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (502586, 17)

[INFO] analyzing data
[INFO] 502586 rows
[INFO] ** appi_name:[21:99.99622%,30:0.00318%,31:0.0002%,27:0.0002%,26:0.0002%]
[INFO] ** classification:[normal:91.84637%,Single Stage Multi Point:8.15363%]
[INFO] ** dst:[21:43.42401%,10:20.83663%,8:18.16684%,9:17.56714%,15:0.00318%,22:0.00119%,24:0.0004%,18:0.0002%,7:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99721%,0:0.00279%]
[INFO] ** i/f_name:[2:99.99682%,3:0.00318%]
[INFO] ** modbus_function_code:[0.02961:99.99622%,-33.760870000000004:0.00378%]
[INFO] ** modbus_function_description:[7:49.9996%,11:49.99662%,0:0.00378%]
[INFO] ** modbus_transaction_id:65536 (13.03976%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99622%,1:0.00318%,2:0.0006%]
[INFO] ** proxy_src_ip:[18:38.11746%,20:26.14378%,13:18.16704%,6:17.56774%,17:0.00318%,14:0.0006%,16:0.0002%]
[INFO] ** s_port:[1.45442:26.14299%,-0.32151:20.83663%,-1.27613:18.16644%,-0.23351:17.56694%,-0.33484:17.28082%,-71.33197:0.00318%,-0.24151:0.0006%,1.45709:0.0004%,-1.27347:0.0004%,-1.2708:0.0002%,-1.02014:0.0002%,13.431270000000001:0.0002%,-71.14798:0.0002%,1.47576:0.0002%,-0.24950999999999998:0.0002%,11.862:0.0002%,1.46509:0.0002%]
[INFO] ** scada_tag:[3:26.14259%,1:20.83643%,5:18.16644%,4:17.56655%,2:17.28062%,0:0.00736%]
[INFO] ** service:[0.0048200000000000005:99.99622%,-211.73542999999998:0.00318%,-211.08346:0.0002%,-186.43601999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:38.11746%,9:26.14378%,7:18.16704%,1:17.56774%,14:0.00318%,2:0.0006%,15:0.0002%]
[INFO] ** type:[0:99.9996%,1:0.0004%]
[INFO] ** unixtime:1374 (0.27339%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.7215 - tp: 76422.0000 - fp: 3578.0000 - tn: 316422.0000 - fn: 3578.0000 - accuracy: 0.9821 - precision: 0.9553 - recall: 0.9553 - auc: 0.9719 - val_loss: 2.9665 - val_tp: 16319.0000 - val_fp: 3681.0000 - val_tn: 76319.0000 - val_fn: 3681.0000 - val_accuracy: 0.9264 - val_precision: 0.8159 - val_recall: 0.8159 - val_auc: 0.8850
[INFO] saving weights to checkpoints/lstm-epoch-9-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9412 - tp: 65404.0000 - fp: 14596.0000 - tn: 305404.0000 - fn: 14596.0000 - accuracy: 0.9270 - precision: 0.8176 - recall: 0.8176 - auc: 0.8853 - val_loss: 2.9754 - val_tp: 16308.0000 - val_fp: 3692.0000 - val_tn: 76308.0000 - val_fn: 3692.0000 - val_accuracy: 0.9262 - val_precision: 0.8154 - val_recall: 0.8154 - val_auc: 0.8846
[INFO] saving weights to checkpoints/lstm-epoch-9-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9355 - tp: 65432.0000 - fp: 14568.0000 - tn: 305432.0000 - fn: 14568.0000 - accuracy: 0.9272 - precision: 0.8179 - recall: 0.8179 - auc: 0.8855 - val_loss: 0.6963 - val_tp: 19136.0000 - val_fp: 864.0000 - val_tn: 79136.0000 - val_fn: 864.0000 - val_accuracy: 0.9827 - val_precision: 0.9568 - val_recall: 0.9568 - val_auc: 0.9730
[INFO] saving weights to checkpoints/lstm-epoch-9-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.5299e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5711e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.0416e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4755e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/502586
[33m[INFO] loading file 21-21/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (502584, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (502584, 17)

[INFO] analyzing data
[INFO] 502584 rows
[INFO] ** appi_name:[21:99.99602%,30:0.0008%,7:0.0006%,26:0.0004%,22:0.0004%,0:0.0004%,31:0.0002%,27:0.0002%,24:0.0002%,16:0.0002%,15:0.0002%,8:0.0002%,5:0.0002%]
[INFO] ** classification:[normal:98.78568%,Multi Stage Single Point:1.21432%]
[INFO] ** dst:[21:43.30281%,10:21.00544%,8:18.16234%,9:17.52483%,22:0.00099%,15:0.0008%,6:0.0008%,25:0.0004%,24:0.0004%,16:0.0004%,2:0.0004%,18:0.0002%,7:0.0002%]
[INFO] ** i/f_dir:[1:99.9992%,0:0.0008%]
[INFO] ** i/f_name:[2:99.9992%,3:0.0008%]
[INFO] ** modbus_function_code:[0.02961:99.99602%,-33.760870000000004:0.00378%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.99861%,11:49.99741%,0:0.00378%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.03981%)
[INFO] ** orig:[0:99.9992%,2:0.0008%]
[INFO] ** proto:[0:99.99761%,2:0.00159%,1:0.0008%]
[INFO] ** proxy_src_ip:[18:38.33906%,20:25.96899%,13:18.16254%,6:17.52483%,10:0.00119%,11:0.00099%,17:0.0008%,16:0.0006%,1:0.0004%,21:0.0002%,14:0.0002%,7:0.0002%]
[INFO] ** s_port:[1.45442:25.9684%,-0.32151:21.00465%,-1.27613:18.16214%,-0.23351:17.52463%,-0.33484:17.33442%,-6.64392:0.0008%,-71.33197:0.0008%,-1.02014:0.0006%,-1.27347:0.0004%,-71.14931:0.0004%,-71.14798:0.0004%,-64.19493:0.0004%,1.45709:0.0002%,-2.2440900000000004:0.0002%,-3.3787199999999995:0.0002%,-68.79874000000001:0.0002%,10.15141:0.0002%,1.46509:0.0002%,1.47576:0.0002%,7.060860000000001:0.0002%,-0.24151:0.0002%,6.62488:0.0002%]
[INFO] ** scada_tag:[3:25.968%,1:21.00445%,5:18.16194%,4:17.52443%,2:17.33442%,0:0.00677%]
[INFO] ** service:[0.0048200000000000005:99.99682%,-211.73542999999998:0.0008%,-211.09762999999998:0.0006%,-186.44547:0.0004%,-211.08346:0.0004%,-211.08818:0.0004%,-186.43601999999998:0.0002%,-211.35747999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:38.33906%,9:25.96899%,7:18.16254%,1:17.52483%,11:0.00119%,21:0.00099%,10:0.00099%,15:0.0006%,3:0.0004%,4:0.0002%,2:0.0002%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** unixtime:1368 (0.27219%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/502584
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.5556e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3952e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/502584
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.0705e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3449e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/502584
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.7133e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3246e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/502584
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.3442e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2839e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/502584
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.0647e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9449 - val_tp: 15105.0000 - val_fp: 4895.0000 - val_tn: 75105.0000 - val_fn: 4895.0000 - val_accuracy: 0.9021 - val_precision: 0.7552 - val_recall: 0.7552 - val_auc: 0.8470
[INFO] saving weights to checkpoints/lstm-epoch-9-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/502584
[33m[INFO] loading file 22-22/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (271625, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (271625, 17)

[INFO] analyzing data
[INFO] 271625 rows
[INFO] ** appi_name:[21:99.9919%,30:0.00699%,23:0.00037%,22:0.00037%,18:0.00037%]
[INFO] ** classification:[normal:53.00249%,Multi Stage Single Point:46.99751%]
[INFO] ** dst:[21:43.30897%,10:21.00948%,8:18.10179%,9:17.57018%,15:0.00699%,22:0.00147%,19:0.00074%,26:0.00037%]
[INFO] ** i/f_dir:[1:99.99337%,0:0.00663%]
[INFO] ** i/f_name:[2:99.99301%,3:0.00663%,0:0.00037%]
[INFO] ** modbus_function_code:[0.02961:99.9919%,-33.760870000000004:0.0081%]
[INFO] ** modbus_function_description:[7:49.99724%,11:49.99466%,0:0.0081%]
[INFO] ** modbus_transaction_id:64487 (23.74119%)
[INFO] ** orig:[0:99.99485%,2:0.00442%,1:0.00074%]
[INFO] ** proto:[0:99.99264%,1:0.00699%,2:0.00037%]
[INFO] ** proxy_src_ip:[18:38.33152%,20:25.98803%,13:18.10106%,6:17.57128%,17:0.00699%,14:0.00074%,10:0.00037%]
[INFO] ** s_port:[1.45442:25.98693%,-0.32151:21.00948%,-1.27613:18.10106%,-0.23351:17.57018%,-0.33484:17.32204%,-71.33197:0.00699%,1.45709:0.00074%,-0.24151:0.00074%,7.228860000000001:0.00074%,-0.24950999999999998:0.00037%,1.46509:0.00037%,-71.14931:0.00037%]
[INFO] ** scada_tag:[3:25.98656%,1:21.00948%,5:18.10106%,4:17.56981%,2:17.32204%,0:0.01104%]
[INFO] ** service:[0.0048200000000000005:99.9919%,-211.73542999999998:0.00699%,-211.07873999999998:0.00074%,-211.08818:0.00037%]
[INFO] ** src:[22:38.33152%,9:25.98803%,7:18.10106%,1:17.57128%,21:0.00442%,14:0.00258%,2:0.00074%,11:0.00037%]
[INFO] ** type:[0:99.99779%,1:0.00221%]
[INFO] ** unixtime:750 (0.27612%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/271625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5615 - tp: 42470.0000 - fp: 37530.0000 - tn: 282470.0000 - fn: 37530.0000 - accuracy: 0.8123 - precision: 0.5309 - recall: 0.5309 - auc: 0.7049 - val_loss: 7.5771 - val_tp: 10598.0000 - val_fp: 9402.0000 - val_tn: 70598.0000 - val_fn: 9402.0000 - val_accuracy: 0.8120 - val_precision: 0.5299 - val_recall: 0.5299 - val_auc: 0.7062
[INFO] saving weights to checkpoints/lstm-epoch-9-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/271625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5941 - tp: 42308.0000 - fp: 37692.0000 - tn: 282308.0000 - fn: 37692.0000 - accuracy: 0.8115 - precision: 0.5289 - recall: 0.5289 - auc: 0.7037 - val_loss: 7.5828 - val_tp: 10591.0000 - val_fp: 9409.0000 - val_tn: 70591.0000 - val_fn: 9409.0000 - val_accuracy: 0.8118 - val_precision: 0.5296 - val_recall: 0.5296 - val_auc: 0.7060
[INFO] saving weights to checkpoints/lstm-epoch-9-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/271625
[33m[INFO] loading file 23-23/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571625, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571625, 17)

[INFO] analyzing data
[INFO] 571625 rows
[INFO] ** appi_name:[21:99.9986%,30:0.0007%,31:0.00035%,33:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:92.53724%,Multi Stage Single Point:7.46276%]
[INFO] ** dst:[21:43.32368%,10:20.99856%,8:18.14091%,9:17.53422%,22:0.00105%,15:0.0007%,24:0.00035%,18:0.00035%,25:0.00017%]
[INFO] ** i/f_dir:[1:99.9993%,0:0.0007%]
[INFO] ** i/f_name:[2:99.9993%,3:0.0007%]
[INFO] ** modbus_function_code:[0.02961:99.9986%,-33.760870000000004:0.0014%]
[INFO] ** modbus_function_description:[7:50.00044%,11:49.99816%,0:0.0014%]
[INFO] ** modbus_transaction_id:65536 (11.46486%)
[INFO] ** orig:[0:99.99948%,2:0.00052%]
[INFO] ** proto:[0:99.99878%,1:0.0007%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.33562%,20:25.98714%,13:18.14091%,6:17.5344%,17:0.0007%,16:0.00052%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.98627%,-0.32151:20.99838%,-1.27613:18.14039%,-0.23351:17.53405%,-0.33484:17.33724%,-71.33197:0.0007%,-1.02014:0.00052%,-0.08551:0.00035%,-1.27347:0.00035%,1.45709:0.00035%,1.46509:0.00035%,-0.24151:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:25.98592%,1:20.99838%,5:18.14021%,4:17.53387%,2:17.33707%,0:0.00455%]
[INFO] ** service:[0.0048200000000000005:99.99878%,-211.73542999999998:0.0007%,-186.43601999999998:0.00035%,-186.44547:0.00017%]
[INFO] ** src:[22:38.33562%,9:25.98714%,7:18.14091%,1:17.5344%,21:0.00052%,15:0.00052%,17:0.00017%,14:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1557 (0.27238%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5631 - tp: 42462.0000 - fp: 37538.0000 - tn: 282462.0000 - fn: 37538.0000 - accuracy: 0.8123 - precision: 0.5308 - recall: 0.5308 - auc: 0.7055 - val_loss: 4.1270 - val_tp: 14879.0000 - val_fp: 5121.0000 - val_tn: 74879.0000 - val_fn: 5121.0000 - val_accuracy: 0.8976 - val_precision: 0.7440 - val_recall: 0.7440 - val_auc: 0.8400
[INFO] saving weights to checkpoints/lstm-epoch-9-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.4469e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1981e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2346e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0602e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1923e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.7223e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1922e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/571625
[33m[INFO] loading file 24-24/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571625, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571625, 17)

[INFO] analyzing data
[INFO] 571625 rows
[INFO] ** appi_name:[21:99.99353%,30:0.00315%,26:0.00052%,31:0.00035%,27:0.00035%,22:0.00035%,0:0.00035%,24:0.00017%,23:0.00017%,19:0.00017%,18:0.00017%,16:0.00017%,15:0.00017%,11:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:95.54253%,Multi Stage Single Point:4.45747%]
[INFO] ** dst:[21:43.37022%,10:21.01465%,8:18.0977%,9:17.51061%,15:0.00315%,22:0.00105%,6:0.0007%,25:0.00035%,24:0.00035%,19:0.00035%,18:0.00035%,7:0.00035%,26:0.00017%]
[INFO] ** i/f_dir:[1:99.99703%,0:0.00297%]
[INFO] ** i/f_name:[2:99.99685%,3:0.00315%]
[INFO] ** modbus_function_code:[0.02961:99.99353%,-33.760870000000004:0.00595%,-0.415:0.00017%,0.9188299999999999:0.00017%,0.47422:0.00017%]
[INFO] ** modbus_function_description:[7:49.99781%,11:49.99571%,0:0.00595%,15:0.00017%,10:0.00017%,2:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.46486%)
[INFO] ** orig:[0:99.99965%,1:0.00035%]
[INFO] ** proto:[0:99.99493%,1:0.00315%,2:0.00192%]
[INFO] ** proxy_src_ip:[18:38.39545%,20:25.99029%,13:18.09753%,6:17.50991%,17:0.00315%,10:0.00122%,14:0.00087%,11:0.00087%,21:0.00035%,16:0.00035%]
[INFO] ** s_port:[1.45442:25.98942%,-0.32151:21.01465%,-1.27613:18.09718%,-0.23351:17.50921%,-0.33484:17.3808%,-71.33197:0.00315%,-9.58113:0.0007%,-71.14798:0.00052%,-0.24950999999999998:0.00035%,-1.27347:0.00035%,1.45709:0.00035%,-0.24151:0.00035%,-1.02014:0.00035%,-31.55091:0.00035%,7.6315100000000005:0.00035%,-71.14931:0.00035%,-64.19493:0.00035%,1.47576:0.00035%,-68.79874000000001:0.00017%,1.46509:0.00017%,7.4901800000000005:0.00017%,13.431270000000001:0.00017%,11.862:0.00017%]
[INFO] ** scada_tag:[3:25.98924%,1:21.01465%,5:18.097%,4:17.50886%,2:17.38063%,0:0.00962%]
[INFO] ** service:[0.0048200000000000005:99.99458%,-211.73542999999998:0.00315%,-211.08346:0.00052%,-211.07873999999998:0.00035%,-202.75898:0.00035%,-186.44547:0.00035%,-186.43601999999998:0.00035%,-211.08818:0.00035%]
[INFO] ** src:[22:38.39545%,9:25.99029%,7:18.09753%,1:17.50991%,14:0.00315%,11:0.00122%,10:0.00087%,2:0.00087%,15:0.00035%,4:0.00035%]
[INFO] ** type:[0:99.99878%,1:0.00087%,2:0.00035%]
[INFO] ** unixtime:1553 (0.27168%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.5397e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.2738e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.3502e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.8300e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.9115e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0314 - val_tp: 19961.0000 - val_fp: 39.0000 - val_tn: 79961.0000 - val_fn: 39.0000 - val_accuracy: 0.9992 - val_precision: 0.9980 - val_recall: 0.9980 - val_auc: 0.9988
[INFO] saving weights to checkpoints/lstm-epoch-9-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/571625
[33m[INFO] loading file 25-25/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571625, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571625, 17)

[INFO] analyzing data
[INFO] 571625 rows
[INFO] ** appi_name:[21:99.9965%,30:0.00105%,17:0.0007%,22:0.00052%,31:0.00035%,28:0.00017%,26:0.00017%,12:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** classification:[normal:64.3525%,Multi Stage Single Point:35.6475%]
[INFO] ** dst:[21:43.32141%,10:21.0269%,8:18.13147%,9:17.51603%,15:0.00105%,22:0.00087%,16:0.0007%,6:0.0007%,18:0.00035%,17:0.00035%,24:0.00017%]
[INFO] ** i/f_dir:[1:99.99895%,0:0.00105%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.9965%,-33.760870000000004:0.0035%]
[INFO] ** modbus_function_description:[7:49.99904%,11:49.99746%,0:0.0035%]
[INFO] ** modbus_transaction_id:65536 (11.46486%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9979%,2:0.00105%,1:0.00105%]
[INFO] ** proxy_src_ip:[18:38.39178%,20:25.95635%,13:18.13147%,6:17.51655%,17:0.00105%,1:0.00087%,21:0.0007%,16:0.00035%,14:0.00035%,7:0.00035%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.956%,-0.32151:21.02655%,-1.27613:18.13112%,-0.23351:17.51603%,-0.33484:17.36523%,-71.33197:0.00105%,-71.14931:0.00052%,-0.24151:0.00035%,-1.02014:0.00035%,-49.275529999999996:0.00035%,1.46509:0.00017%,-5.1466400000000005:0.00017%,-1.27347:0.00017%,-1.2708:0.00017%,-58.035180000000004:0.00017%,-58.032509999999995:0.00017%,-0.24950999999999998:0.00017%,2.52505:0.00017%,-43.76509:0.00017%,2.05573:0.00017%,6.1115699999999995:0.00017%,-5.08665:0.00017%,1.45709:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:25.95565%,1:21.02637%,5:18.13094%,4:17.51585%,2:17.36506%,0:0.00612%]
[INFO] ** service:[0.0048200000000000005:99.99685%,-211.73542999999998:0.00105%,-205.44247:0.0007%,-211.08818:0.00052%,-186.43601999999998:0.00035%,-211.09762999999998:0.00017%,-211.08346:0.00017%,-185.9872:0.00017%]
[INFO] ** src:[22:38.39178%,9:25.95635%,7:18.13147%,1:17.51655%,14:0.00105%,3:0.00087%,4:0.0007%,21:0.00035%,15:0.00035%,2:0.00035%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1553 (0.27168%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7284 - tp: 51568.0000 - fp: 28432.0000 - tn: 291568.0000 - fn: 28432.0000 - accuracy: 0.8578 - precision: 0.6446 - recall: 0.6446 - auc: 0.7779 - val_loss: 5.7550 - val_tp: 12859.0000 - val_fp: 7141.0000 - val_tn: 72859.0000 - val_fn: 7141.0000 - val_accuracy: 0.8572 - val_precision: 0.6429 - val_recall: 0.6429 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-9-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7548 - tp: 51437.0000 - fp: 28563.0000 - tn: 291437.0000 - fn: 28563.0000 - accuracy: 0.8572 - precision: 0.6430 - recall: 0.6430 - auc: 0.7769 - val_loss: 5.7566 - val_tp: 12857.0000 - val_fp: 7143.0000 - val_tn: 72857.0000 - val_fn: 7143.0000 - val_accuracy: 0.8571 - val_precision: 0.6428 - val_recall: 0.6428 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-9-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7504 - tp: 51459.0000 - fp: 28541.0000 - tn: 291459.0000 - fn: 28541.0000 - accuracy: 0.8573 - precision: 0.6432 - recall: 0.6432 - auc: 0.7770 - val_loss: 5.7163 - val_tp: 12907.0000 - val_fp: 7093.0000 - val_tn: 72907.0000 - val_fn: 7093.0000 - val_accuracy: 0.8581 - val_precision: 0.6453 - val_recall: 0.6453 - val_auc: 0.7783
[INFO] saving weights to checkpoints/lstm-epoch-9-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7520 - tp: 51451.0000 - fp: 28549.0000 - tn: 291451.0000 - fn: 28549.0000 - accuracy: 0.8573 - precision: 0.6431 - recall: 0.6431 - auc: 0.7770 - val_loss: 5.7066 - val_tp: 12919.0000 - val_fp: 7081.0000 - val_tn: 72919.0000 - val_fn: 7081.0000 - val_accuracy: 0.8584 - val_precision: 0.6460 - val_recall: 0.6460 - val_auc: 0.7787
[INFO] saving weights to checkpoints/lstm-epoch-9-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7552 - tp: 51435.0000 - fp: 28565.0000 - tn: 291435.0000 - fn: 28565.0000 - accuracy: 0.8572 - precision: 0.6429 - recall: 0.6429 - auc: 0.7768 - val_loss: 5.7566 - val_tp: 12857.0000 - val_fp: 7143.0000 - val_tn: 72857.0000 - val_fn: 7143.0000 - val_accuracy: 0.8571 - val_precision: 0.6428 - val_recall: 0.6428 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-9-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/571625
[33m[INFO] loading file 26-26/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571625, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571625, 17)

[INFO] analyzing data
[INFO] 571625 rows
[INFO] ** appi_name:[21:99.99825%,30:0.00052%,7:0.00052%,31:0.00017%,22:0.00017%,12:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:64.39799%,Single Stage Single Point:27.94%,Multi Stage Single Point:7.66202%]
[INFO] ** dst:[21:43.30654%,10:21.08918%,8:18.12167%,9:17.47999%,22:0.0007%,15:0.00052%,24:0.00035%,16:0.00035%,2:0.00035%,18:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99948%,0:0.00052%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.99825%,-33.760870000000004:0.00175%]
[INFO] ** modbus_function_description:[7:49.99956%,11:49.99869%,0:0.00175%]
[INFO] ** modbus_transaction_id:65536 (11.46486%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99913%,1:0.00052%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.46753%,20:25.92836%,13:18.12202%,6:17.47999%,17:0.00052%,1:0.00052%,21:0.00035%,16:0.00035%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.92784%,-0.32151:21.089%,-1.27613:18.1215%,-0.23351:17.47982%,-0.33484:17.37853%,-71.33197:0.00052%,-1.02014:0.00035%,-1.27347:0.00035%,-49.275529999999996:0.00017%,1.47576:0.00017%,1.45709:0.00017%,1.46509:0.00017%,-1.2708:0.00017%,14.191239999999999:0.00017%,2.52505:0.00017%,-3.3787199999999995:0.00017%,11.57001:0.00017%,-71.14931:0.00017%,7.66617:0.00017%,-0.24151:0.00017%]
[INFO] ** scada_tag:[3:25.92749%,1:21.089%,5:18.12132%,4:17.47964%,2:17.37853%,0:0.00402%]
[INFO] ** service:[0.0048200000000000005:99.99843%,-211.09762999999998:0.00052%,-211.73542999999998:0.00052%,-211.35747999999998:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.46753%,9:25.92836%,7:18.12202%,1:17.47999%,14:0.00052%,3:0.00052%,15:0.00035%,4:0.00035%,21:0.00017%,2:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1551 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7433 - tp: 51494.0000 - fp: 28506.0000 - tn: 291494.0000 - fn: 28506.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.7773 - val_loss: 5.7445 - val_tp: 12872.0000 - val_fp: 7128.0000 - val_tn: 72872.0000 - val_fn: 7128.0000 - val_accuracy: 0.8574 - val_precision: 0.6436 - val_recall: 0.6436 - val_auc: 0.7772
[INFO] saving weights to checkpoints/lstm-epoch-9-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.4888 - tp: 62034.0000 - fp: 17966.0000 - tn: 302034.0000 - fn: 17966.0000 - accuracy: 0.9102 - precision: 0.7754 - recall: 0.7754 - auc: 0.8784 - val_loss: 0.0104 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0770 - tp: 78713.0000 - fp: 1287.0000 - tn: 318713.0000 - fn: 1287.0000 - accuracy: 0.9936 - precision: 0.9839 - recall: 0.9839 - auc: 0.9927 - val_loss: 6.7299e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0638 - tp: 79055.0000 - fp: 945.0000 - tn: 319055.0000 - fn: 945.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9930 - val_loss: 2.5754e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0589 - tp: 79144.0000 - fp: 856.0000 - tn: 319144.0000 - fn: 856.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9933 - val_loss: 1.1781e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/571625
[33m[INFO] loading file 27-27/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (511755, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (511755, 17)

[INFO] analyzing data
[INFO] 511755 rows
[INFO] ** appi_name:[21:99.99941%,30:0.00059%]
[INFO] ** classification:[normal:64.35814%,Single Stage Single Point:35.64186%]
[INFO] ** dst:[21:43.2879%,10:21.06848%,8:18.17413%,9:17.46793%,22:0.00078%,15:0.00059%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.9998%,0:0.0002%]
[INFO] ** i/f_name:[2:99.99941%,3:0.00059%]
[INFO] ** modbus_function_code:[0.02961:99.99941%,-33.760870000000004:0.00059%]
[INFO] ** modbus_function_description:[7:50.00029%,11:49.99912%,0:0.00059%]
[INFO] ** modbus_transaction_id:65536 (12.80613%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99941%,1:0.00059%]
[INFO] ** proxy_src_ip:[18:38.42346%,20:25.9335%,13:18.17393%,6:17.46812%,17:0.00059%,16:0.00039%]
[INFO] ** s_port:[1.45442:25.93292%,-0.32151:21.06848%,-1.27613:18.17374%,-0.23351:17.46773%,-0.33484:17.35498%,-71.33197:0.00059%,-1.02014:0.00039%,-1.27347:0.0002%,1.45709:0.0002%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-0.24151:0.0002%]
[INFO] ** scada_tag:[3:25.93253%,1:21.06828%,5:18.17354%,4:17.46754%,2:17.35479%,0:0.00332%]
[INFO] ** service:[0.0048200000000000005:99.99941%,-211.73542999999998:0.00059%]
[INFO] ** src:[22:38.42346%,9:25.9335%,7:18.17393%,1:17.46812%,14:0.00059%,15:0.00039%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1390 (0.27161%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/511755
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0916 - tp: 78770.0000 - fp: 1230.0000 - tn: 318770.0000 - fn: 1230.0000 - accuracy: 0.9938 - precision: 0.9846 - recall: 0.9846 - auc: 0.9942 - val_loss: 8.1182e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/511755
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0610 - tp: 79067.0000 - fp: 933.0000 - tn: 319067.0000 - fn: 933.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9998 - val_loss: 8.1166e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/511755
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0541 - tp: 79141.0000 - fp: 859.0000 - tn: 319141.0000 - fn: 859.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 6.0515e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/511755
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0539 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 6.5537e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/511755
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0546 - tp: 79068.0000 - fp: 932.0000 - tn: 319068.0000 - fn: 932.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 8.1292e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-26-27-batch-400000-500000
[INFO] processing batch 500000-600000/511755
[33m[INFO] loading file 28-28/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (345671, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (345671, 17)

[INFO] analyzing data
[INFO] 345671 rows
[INFO] ** appi_name:[21:99.99161%,30:0.00174%,17:0.00145%,22:0.00116%,7:0.00116%,31:0.00087%,26:0.00087%,28:0.00029%,27:0.00029%,8:0.00029%,0:0.00029%]
[INFO] ** classification:[normal:64.3071%,Single Stage Single Point:35.6929%]
[INFO] ** dst:[21:43.2822%,10:21.01652%,8:18.20401%,9:17.48859%,6:0.00231%,16:0.00203%,18:0.00145%,17:0.00058%,15:0.00058%,2:0.00058%,25:0.00029%,22:0.00029%,7:0.00029%,0:0.00029%]
[INFO] ** i/f_dir:[1:99.99942%,0:0.00058%]
[INFO] ** i/f_name:[2:99.99942%,3:0.00058%]
[INFO] ** modbus_function_code:[0.02961:99.99161%,-33.760870000000004:0.00839%]
[INFO] ** modbus_function_description:[11:49.99581%,7:49.99581%,0:0.00839%]
[INFO] ** modbus_transaction_id:65535 (18.95878%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99508%,2:0.00434%,1:0.00058%]
[INFO] ** proxy_src_ip:[18:38.33501%,20:25.96371%,13:18.2043%,6:17.48859%,1:0.00231%,17:0.00174%,14:0.00174%,7:0.00145%,21:0.00087%,0:0.00029%]
[INFO] ** s_port:[1.45442:25.96342%,-0.32151:21.01652%,-1.27613:18.20401%,-0.23351:17.48831%,-0.33484:17.31849%,-71.14798:0.00116%,-71.14931:0.00116%,-71.33197:0.00058%,-0.08551:0.00058%,7.66617:0.00029%,-58.035180000000004:0.00029%,-1.2708:0.00029%,-64.19493:0.00029%,-5.1466400000000005:0.00029%,13.431270000000001:0.00029%,-0.24151:0.00029%,11.57001:0.00029%,14.4699:0.00029%,1.47576:0.00029%,14.191239999999999:0.00029%,-5.08665:0.00029%,10.192739999999999:0.00029%,-3.3787199999999995:0.00029%,6.1115699999999995:0.00029%,2.05573:0.00029%,-43.76509:0.00029%,2.52505:0.00029%,11.862:0.00029%,-58.032509999999995:0.00029%]
[INFO] ** scada_tag:[3:25.96342%,1:21.01652%,5:18.20401%,4:17.48802%,2:17.31849%,0:0.00955%]
[INFO] ** service:[0.0048200000000000005:99.99161%,-205.44247:0.00145%,-186.43601999999998:0.00145%,-211.09762999999998:0.00116%,-211.08346:0.00116%,-211.08818:0.00116%,-211.73542999999998:0.00058%,-186.44547:0.00029%,-183.8612:0.00029%,-185.9872:0.00029%,-211.35747999999998:0.00029%,-202.75898:0.00029%]
[INFO] ** src:[22:38.33501%,9:25.96371%,7:18.2043%,1:17.48859%,3:0.0026%,2:0.00174%,21:0.00145%,4:0.00116%,14:0.00058%,8:0.00058%,17:0.00029%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:940 (0.27193%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/345671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0507 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.1345e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/345671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0489 - tp: 79094.0000 - fp: 906.0000 - tn: 319094.0000 - fn: 906.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-9-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/345671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0481 - tp: 79051.0000 - fp: 949.0000 - tn: 319051.0000 - fn: 949.0000 - accuracy: 0.9953 - precision: 0.9881 - recall: 0.9881 - auc: 0.9999 - val_loss: 9.8909e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/345671
[33m[INFO] loading file 29-29/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (545671, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (545671, 17)

[INFO] analyzing data
[INFO] 545671 rows
[INFO] ** appi_name:[21:99.99872%,30:0.00055%,31:0.00018%,26:0.00018%,9:0.00018%,3:0.00018%]
[INFO] ** classification:[normal:64.39228%,Single Stage Single Point:35.60772%]
[INFO] ** dst:[21:43.32922%,10:21.06159%,8:18.14427%,9:17.46309%,22:0.00055%,15:0.00055%,24:0.00018%,18:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99945%,3:0.00055%]
[INFO] ** modbus_function_code:[0.02961:99.99872%,-33.760870000000004:0.00128%]
[INFO] ** modbus_function_description:[7:49.99973%,11:49.99899%,0:0.00128%]
[INFO] ** modbus_transaction_id:65536 (12.01017%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99908%,1:0.00055%,2:0.00037%]
[INFO] ** proxy_src_ip:[18:38.438%,20:25.953%,13:18.14463%,6:17.4629%,17:0.00055%,21:0.00018%,16:0.00018%,7:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95245%,-0.32151:21.06141%,-1.27613:18.14427%,-0.23351:17.4629%,-0.33484:17.37659%,-71.33197:0.00055%,1.45709:0.00037%,-71.14798:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,6.1115699999999995:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.95208%,1:21.06123%,5:18.14427%,4:17.46254%,2:17.37659%,0:0.0033%]
[INFO] ** service:[0.0048200000000000005:99.9989%,-211.73542999999998:0.00055%,-183.8612:0.00018%,-211.08346:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.438%,9:25.953%,7:18.14463%,1:17.4629%,14:0.00055%,21:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1482 (0.27159%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0426 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 9.9081e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0389 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 9.2035e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0380 - tp: 79079.0000 - fp: 921.0000 - tn: 319079.0000 - fn: 921.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 8.1910e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0343 - tp: 79091.0000 - fp: 909.0000 - tn: 319091.0000 - fn: 909.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 6.2557e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0295 - tp: 79148.0000 - fp: 852.0000 - tn: 319148.0000 - fn: 852.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 4.5192e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/545671
[33m[INFO] loading file 30-30/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (545671, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (545671, 17)

[INFO] analyzing data
[INFO] 545671 rows
[INFO] ** appi_name:[21:99.99743%,30:0.00183%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.36809%,Single Stage Single Point:35.63191%]
[INFO] ** dst:[21:43.33564%,10:21.02934%,8:18.14738%,9:17.48416%,15:0.00183%,22:0.00073%,24:0.00037%,25:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99835%,0:0.00165%]
[INFO] ** i/f_name:[2:99.99817%,3:0.00183%]
[INFO] ** modbus_function_code:[0.02961:99.99743%,-33.760870000000004:0.00257%]
[INFO] ** modbus_function_description:[7:49.99973%,11:49.99771%,0:0.00257%]
[INFO] ** modbus_transaction_id:65536 (12.01017%)
[INFO] ** orig:[0:99.99908%,2:0.00055%,1:0.00037%]
[INFO] ** proto:[0:99.9978%,1:0.00183%,2:0.00037%]
[INFO] ** proxy_src_ip:[18:38.36799%,20:25.9968%,13:18.14775%,6:17.48471%,17:0.00183%,7:0.00037%,16:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.99662%,-0.32151:21.02915%,-1.27613:18.1472%,-0.23351:17.48398%,-0.33484:17.33884%,-71.33197:0.00183%,-0.24151:0.00055%,-1.27347:0.00037%,-71.14798:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:25.99625%,1:21.02915%,5:18.14702%,4:17.4838%,2:17.33865%,0:0.00513%]
[INFO] ** service:[0.0048200000000000005:99.99762%,-211.73542999999998:0.00183%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.36799%,9:25.9968%,7:18.14775%,1:17.48471%,14:0.00128%,21:0.00092%,16:0.00018%,15:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99908%,1:0.00092%]
[INFO] ** unixtime:1483 (0.27178%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0286 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 2.7442e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0268 - tp: 79119.0000 - fp: 881.0000 - tn: 319119.0000 - fn: 881.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 5.0341e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0243 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 8.0646e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0234 - tp: 79089.0000 - fp: 911.0000 - tn: 319089.0000 - fn: 911.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 8.0645e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0224 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 2.1108e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/545671
[33m[INFO] loading file 31-31/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (545671, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (545671, 17)

[INFO] analyzing data
[INFO] 545671 rows
[INFO] ** appi_name:[21:99.99963%,26:0.00018%,17:0.00018%]
[INFO] ** classification:[normal:64.37304%,Single Stage Single Point:35.62696%]
[INFO] ** dst:[21:43.31749%,10:21.05408%,8:18.12631%,9:17.50047%,22:0.00092%,24:0.00037%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99963%,-33.760870000000004:0.00037%]
[INFO] ** modbus_function_description:[7:49.99991%,11:49.99973%,0:0.00037%]
[INFO] ** modbus_transaction_id:65536 (12.01017%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.39511%,20:25.97719%,13:18.12649%,6:17.50047%,16:0.00037%,7:0.00037%]
[INFO] ** s_port:[1.45442:25.97646%,-0.32151:21.05408%,-1.27613:18.12612%,-0.23351:17.50029%,-0.33484:17.34104%,-1.27347:0.00037%,1.45709:0.00037%,-1.02014:0.00037%,-71.14798:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,10.192739999999999:0.00018%]
[INFO] ** scada_tag:[3:25.97609%,1:21.0539%,5:18.12594%,4:17.50011%,2:17.34085%,0:0.00312%]
[INFO] ** service:[0.0048200000000000005:99.99963%,-211.08346:0.00018%,-205.44247:0.00018%]
[INFO] ** src:[22:38.39511%,9:25.97719%,7:18.12649%,1:17.50047%,21:0.00037%,15:0.00037%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1483 (0.27178%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0215 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.4288e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0215 - tp: 79057.0000 - fp: 943.0000 - tn: 319057.0000 - fn: 943.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.2233e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79106.0000 - fp: 894.0000 - tn: 319106.0000 - fn: 894.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1925e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79075.0000 - fp: 925.0000 - tn: 319075.0000 - fn: 925.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1973e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/545671
[33m[INFO] loading file 32-32/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (545671, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (545671, 17)

[INFO] analyzing data
[INFO] 545671 rows
[INFO] ** appi_name:[21:99.99633%,30:0.00312%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.3767%,Single Stage Single Point:35.6233%]
[INFO] ** dst:[21:43.32134%,10:21.0506%,8:18.16094%,9:17.46235%,15:0.00312%,22:0.00092%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99725%,0:0.00275%]
[INFO] ** i/f_name:[2:99.99688%,3:0.00312%]
[INFO] ** modbus_function_code:[0.02961:99.99633%,-33.760870000000004:0.00367%]
[INFO] ** modbus_function_description:[7:49.99918%,11:49.99716%,0:0.00367%]
[INFO] ** modbus_transaction_id:65536 (12.01017%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99633%,1:0.00312%,2:0.00055%]
[INFO] ** proxy_src_ip:[18:38.41509%,20:25.95722%,13:18.16094%,6:17.4629%,17:0.00312%,14:0.00055%,16:0.00018%]
[INFO] ** s_port:[1.45442:25.95667%,-0.32151:21.0506%,-1.27613:18.16058%,-0.23351:17.46217%,-0.33484:17.36449%,-71.33197:0.00312%,-0.24151:0.00055%,-1.2708:0.00018%,-1.02014:0.00018%,13.431270000000001:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,1.45709:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:25.9563%,1:21.05041%,5:18.16058%,4:17.4618%,2:17.36449%,0:0.00641%]
[INFO] ** service:[0.0048200000000000005:99.99633%,-211.73542999999998:0.00312%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.41509%,9:25.95722%,7:18.16094%,1:17.4629%,14:0.00312%,2:0.00055%,15:0.00018%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1481 (0.27141%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0215 - tp: 79038.0000 - fp: 962.0000 - tn: 319038.0000 - fn: 962.0000 - accuracy: 0.9952 - precision: 0.9880 - recall: 0.9880 - auc: 0.9999 - val_loss: 1.2017e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79085.0000 - fp: 915.0000 - tn: 319085.0000 - fn: 915.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79067.0000 - fp: 933.0000 - tn: 319067.0000 - fn: 933.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0236 - tp: 79080.0000 - fp: 920.0000 - tn: 319080.0000 - fn: 920.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9998 - val_loss: 0.0024 - val_tp: 19997.0000 - val_fp: 3.0000 - val_tn: 79997.0000 - val_fn: 3.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-9-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/545671
[33m[INFO] loading file 33-33/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (545671, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (545671, 17)

[INFO] analyzing data
[INFO] 545671 rows
[INFO] ** appi_name:[21:99.99688%,30:0.0011%,17:0.00073%,22:0.00055%,31:0.00018%,28:0.00018%,26:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.39448%,Single Stage Single Point:35.60552%]
[INFO] ** dst:[21:43.32831%,10:21.06123%,8:18.12044%,9:17.48508%,22:0.00147%,15:0.0011%,16:0.00073%,6:0.00073%,24:0.00037%,17:0.00037%,18:0.00018%]
[INFO] ** i/f_dir:[1:99.9989%,0:0.0011%]
[INFO] ** i/f_name:[2:99.9989%,3:0.0011%]
[INFO] ** modbus_function_code:[0.02961:99.99688%,-33.760870000000004:0.00312%]
[INFO] ** modbus_function_description:[7:49.99954%,11:49.99734%,0:0.00312%]
[INFO] ** modbus_transaction_id:65536 (12.01017%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99798%,1:0.0011%,2:0.00092%]
[INFO] ** proxy_src_ip:[18:38.4226%,20:25.96785%,13:18.12044%,6:17.48526%,17:0.0011%,16:0.00073%,1:0.00073%,21:0.00037%,14:0.00037%,7:0.00037%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.96693%,-0.32151:21.06123%,-1.27613:18.12008%,-0.23351:17.48489%,-0.33484:17.36138%,-71.33197:0.0011%,-1.02014:0.00073%,1.45709:0.00055%,-71.14931:0.00055%,-1.27347:0.00037%,-5.08665:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,-43.76509:0.00018%,-71.14798:0.00018%,-58.032509999999995:0.00018%,-58.035180000000004:0.00018%,-0.24151:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:25.96656%,1:21.06123%,5:18.11989%,4:17.48471%,2:17.36138%,0:0.00623%]
[INFO] ** service:[0.0048200000000000005:99.99688%,-211.73542999999998:0.0011%,-205.44247:0.00073%,-211.08818:0.00055%,-211.09762999999998:0.00018%,-211.08346:0.00018%,-185.9872:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.4226%,9:25.96785%,7:18.12044%,1:17.48526%,14:0.0011%,15:0.00073%,3:0.00073%,21:0.00037%,4:0.00037%,2:0.00037%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1484 (0.27196%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0196 - tp: 79206.0000 - fp: 794.0000 - tn: 319206.0000 - fn: 794.0000 - accuracy: 0.9960 - precision: 0.9901 - recall: 0.9901 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79089.0000 - fp: 911.0000 - tn: 319089.0000 - fn: 911.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79152.0000 - fp: 848.0000 - tn: 319152.0000 - fn: 848.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0217 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 0.0017 - val_tp: 19997.0000 - val_fp: 3.0000 - val_tn: 79997.0000 - val_fn: 3.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-9-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79153.0000 - fp: 847.0000 - tn: 319153.0000 - fn: 847.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/545671
[33m[INFO] loading file 34-34/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (387104, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (387104, 17)

[INFO] analyzing data
[INFO] 387104 rows
[INFO] ** appi_name:[21:99.99742%,30:0.00077%,7:0.00077%,31:0.00026%,22:0.00026%,8:0.00026%,6:0.00026%]
[INFO] ** classification:[normal:64.34369%,Single Stage Single Point:35.65631%]
[INFO] ** dst:[21:43.28553%,10:21.05507%,8:18.19718%,9:17.45913%,22:0.00077%,15:0.00077%,16:0.00052%,2:0.00052%,18:0.00026%,6:0.00026%]
[INFO] ** i/f_dir:[1:99.99923%,0:0.00077%]
[INFO] ** i/f_name:[2:99.99923%,3:0.00077%]
[INFO] ** modbus_function_code:[0.02961:99.99742%,-33.760870000000004:0.00258%]
[INFO] ** modbus_function_description:[7:49.99923%,11:49.99819%,0:0.00258%]
[INFO] ** modbus_transaction_id:65536 (16.92982%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99871%,1:0.00077%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.38968%,20:25.95091%,13:18.19718%,6:17.45965%,17:0.00077%,1:0.00077%,21:0.00052%,14:0.00026%,7:0.00026%]
[INFO] ** s_port:[1.45442:25.95065%,-0.32151:21.05481%,-1.27613:18.19718%,-0.23351:17.45887%,-0.33484:17.33488%,-0.24151:0.00077%,-71.33197:0.00077%,-3.0613900000000003:0.00026%,-3.3787199999999995:0.00026%,14.191239999999999:0.00026%,1.47576:0.00026%,11.57001:0.00026%,-49.275529999999996:0.00026%,-71.14931:0.00026%,7.66617:0.00026%]
[INFO] ** scada_tag:[3:25.95039%,1:21.05455%,5:18.19692%,4:17.45836%,2:17.33488%,0:0.00491%]
[INFO] ** service:[0.0048200000000000005:99.99768%,-211.09762999999998:0.00077%,-211.73542999999998:0.00077%,-186.43601999999998:0.00026%,-211.35747999999998:0.00026%,-211.08818:0.00026%]
[INFO] ** src:[22:38.38968%,9:25.95091%,7:18.19718%,1:17.45965%,14:0.00077%,3:0.00077%,4:0.00052%,21:0.00026%,2:0.00026%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1051 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/387104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/387104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79113.0000 - fp: 887.0000 - tn: 319113.0000 - fn: 887.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/387104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79085.0000 - fp: 915.0000 - tn: 319085.0000 - fn: 915.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 7.6653e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/387104
[33m[INFO] loading file 35-35/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587104, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587104, 17)

[INFO] analyzing data
[INFO] 587104 rows
[INFO] ** appi_name:[21:99.99898%,30:0.00102%]
[INFO] ** classification:[normal:64.3627%,Single Stage Single Point:35.6373%]
[INFO] ** dst:[21:43.32231%,10:21.03784%,8:18.16424%,9:17.47339%,22:0.00119%,15:0.00102%]
[INFO] ** i/f_dir:[1:99.99915%,0:0.00085%]
[INFO] ** i/f_name:[2:99.99898%,3:0.00102%]
[INFO] ** modbus_function_code:[0.02961:99.99898%,-33.760870000000004:0.00102%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.99881%,0:0.00102%]
[INFO] ** modbus_transaction_id:65536 (11.16259%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.99898%,1:0.00102%]
[INFO] ** proxy_src_ip:[18:38.39354%,20:25.96712%,13:18.1639%,6:17.47374%,17:0.00102%,16:0.00068%]
[INFO] ** s_port:[1.45442:25.96661%,-0.32151:21.03784%,-1.27613:18.1639%,-0.23351:17.47322%,-0.33484:17.3557%,-71.33197:0.00102%,-1.02014:0.00068%,-0.24151:0.00034%,1.45709:0.00017%,-0.24950999999999998:0.00017%,1.46509:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.96627%,1:21.03784%,5:18.16373%,4:17.47288%,2:17.3557%,0:0.00358%]
[INFO] ** service:[0.0048200000000000005:99.99898%,-211.73542999999998:0.00102%]
[INFO] ** src:[22:38.39354%,9:25.96712%,7:18.1639%,1:17.47374%,14:0.00102%,15:0.00068%]
[INFO] ** type:[0:99.99915%,1:0.00085%]
[INFO] ** unixtime:1594 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79098.0000 - fp: 902.0000 - tn: 319098.0000 - fn: 902.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79160.0000 - fp: 840.0000 - tn: 319160.0000 - fn: 840.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0195 - tp: 79154.0000 - fp: 846.0000 - tn: 319154.0000 - fn: 846.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/587104
[33m[INFO] loading file 36-36/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587104, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587104, 17)

[INFO] analyzing data
[INFO] 587104 rows
[INFO] ** appi_name:[21:99.99864%,30:0.00068%,31:0.00034%,33:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.36185%,Single Stage Single Point:35.63815%]
[INFO] ** dst:[21:43.32895%,10:21.03069%,8:18.15113%,9:17.48685%,22:0.00085%,15:0.00068%,24:0.00034%,18:0.00034%,25:0.00017%]
[INFO] ** i/f_dir:[1:99.99932%,0:0.00068%]
[INFO] ** i/f_name:[2:99.99932%,3:0.00068%]
[INFO] ** modbus_function_code:[0.02961:99.99864%,-33.760870000000004:0.00136%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.99847%,0:0.00136%]
[INFO] ** modbus_transaction_id:65536 (11.16259%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99881%,1:0.00068%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.38162%,20:25.97819%,13:18.1513%,6:17.48736%,17:0.00068%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.97768%,-0.32151:21.03052%,-1.27613:18.15079%,-0.23351:17.48668%,-0.33484:17.3511%,-71.33197:0.00068%,-0.24151:0.00051%,-0.08551:0.00034%,-1.27347:0.00034%,1.45709:0.00017%,1.47576:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,-64.19493:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:25.97734%,1:21.03035%,5:18.15062%,4:17.48651%,2:17.35093%,0:0.00426%]
[INFO] ** service:[0.0048200000000000005:99.99881%,-211.73542999999998:0.00068%,-186.43601999999998:0.00034%,-186.44547:0.00017%]
[INFO] ** src:[22:38.38162%,9:25.97819%,7:18.1513%,1:17.48736%,14:0.00068%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1594 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79131.0000 - fp: 869.0000 - tn: 319131.0000 - fn: 869.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79157.0000 - fp: 843.0000 - tn: 319157.0000 - fn: 843.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 9.8147e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/587104
[33m[INFO] loading file 37-37/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587104, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587104, 17)

[INFO] analyzing data
[INFO] 587104 rows
[INFO] ** appi_name:[21:99.99881%,30:0.00068%,33:0.00017%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:64.37974%,Single Stage Single Point:35.62026%]
[INFO] ** dst:[21:43.33968%,10:21.03818%,8:18.13733%,9:17.48293%,22:0.00068%,15:0.00068%,24:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99966%,0:0.00034%]
[INFO] ** i/f_name:[2:99.99932%,3:0.00068%]
[INFO] ** modbus_function_code:[0.02961:99.99881%,-33.760870000000004:0.00119%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99881%,0:0.00119%]
[INFO] ** modbus_transaction_id:65536 (11.16259%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99915%,1:0.00068%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.3869%,20:25.99114%,13:18.13733%,6:17.4831%,17:0.00068%,21:0.00034%,16:0.00034%,1:0.00017%]
[INFO] ** s_port:[1.45442:25.99063%,-0.32151:21.03801%,-1.27613:18.13699%,-0.23351:17.48276%,-0.33484:17.34889%,-71.33197:0.00068%,-1.02014:0.00034%,1.46509:0.00017%,1.47576:0.00017%,-1.27347:0.00017%,-49.275529999999996:0.00017%,-0.24950999999999998:0.00017%,-0.24151:0.00017%,-1.2708:0.00017%,1.45709:0.00017%,14.4699:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:25.99045%,1:21.03801%,5:18.13682%,4:17.48259%,2:17.34872%,0:0.00341%]
[INFO] ** service:[0.0048200000000000005:99.99898%,-211.73542999999998:0.00068%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.3869%,9:25.99114%,7:18.13733%,1:17.4831%,14:0.00068%,15:0.00034%,4:0.00034%,3:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1595 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79088.0000 - fp: 912.0000 - tn: 319088.0000 - fn: 912.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79093.0000 - fp: 907.0000 - tn: 319093.0000 - fn: 907.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79086.0000 - fp: 914.0000 - tn: 319086.0000 - fn: 914.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79134.0000 - fp: 866.0000 - tn: 319134.0000 - fn: 866.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79055.0000 - fp: 945.0000 - tn: 319055.0000 - fn: 945.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/587104
[33m[INFO] loading file 38-38/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587104, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587104, 17)

[INFO] analyzing data
[INFO] 587104 rows
[INFO] ** appi_name:[21:99.99898%,30:0.00034%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.4075%,Single Stage Single Point:35.5925%]
[INFO] ** dst:[21:43.3206%,10:21.08485%,8:18.09782%,9:17.49486%,22:0.00085%,15:0.00034%,25:0.00017%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99983%,0:0.00017%]
[INFO] ** i/f_name:[2:99.99966%,3:0.00034%]
[INFO] ** modbus_function_code:[0.02961:99.99898%,-33.760870000000004:0.00102%]
[INFO] ** modbus_function_description:[7:49.99966%,11:49.99932%,0:0.00102%]
[INFO] ** modbus_transaction_id:65536 (11.16259%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99932%,2:0.00034%,1:0.00034%]
[INFO] ** proxy_src_ip:[18:38.44549%,20:25.96065%,13:18.09765%,6:17.49503%,17:0.00034%,7:0.00034%,16:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.9598%,-0.32151:21.08468%,-1.27613:18.09748%,-0.23351:17.49452%,-0.33484:17.36081%,1.47576:0.00034%,-0.24151:0.00034%,-71.33197:0.00034%,1.45709:0.00034%,-1.27347:0.00017%,1.46509:0.00017%,-61.95768:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:25.95946%,1:21.08468%,5:18.09748%,4:17.49435%,2:17.36064%,0:0.00341%]
[INFO] ** service:[0.0048200000000000005:99.99915%,-211.73542999999998:0.00034%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.44549%,9:25.96065%,7:18.09765%,1:17.49503%,21:0.00034%,14:0.00034%,16:0.00017%,15:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1595 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79142.0000 - fp: 858.0000 - tn: 319142.0000 - fn: 858.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79076.0000 - fp: 924.0000 - tn: 319076.0000 - fn: 924.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79093.0000 - fp: 907.0000 - tn: 319093.0000 - fn: 907.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/587104
[33m[INFO] loading file 39-39/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587104, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587104, 17)

[INFO] analyzing data
[INFO] 587104 rows
[INFO] ** appi_name:[21:99.99966%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.39643%,Single Stage Single Point:35.60357%]
[INFO] ** dst:[21:43.31379%,10:21.08144%,8:18.13818%,9:17.46522%,22:0.00085%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99966%,-33.760870000000004:0.00034%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99966%,0:0.00034%]
[INFO] ** modbus_transaction_id:65536 (11.16259%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.4431%,20:25.95247%,13:18.13835%,6:17.46522%,16:0.00051%,7:0.00034%]
[INFO] ** s_port:[1.45442:25.95196%,-0.32151:21.08144%,-1.27613:18.13801%,-0.23351:17.46505%,-0.33484:17.36166%,-1.02014:0.00051%,-71.14798:0.00017%,-1.27347:0.00017%,1.45709:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-0.24151:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.95162%,1:21.08127%,5:18.13784%,4:17.46505%,2:17.36149%,0:0.00273%]
[INFO] ** service:[0.0048200000000000005:99.99966%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.4431%,9:25.95247%,7:18.13835%,1:17.46522%,15:0.00051%,21:0.00034%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1593 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79069.0000 - fp: 931.0000 - tn: 319069.0000 - fn: 931.0000 - accuracy: 0.9953 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0194 - tp: 79149.0000 - fp: 851.0000 - tn: 319149.0000 - fn: 851.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79077.0000 - fp: 923.0000 - tn: 319077.0000 - fn: 923.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79069.0000 - fp: 931.0000 - tn: 319069.0000 - fn: 931.0000 - accuracy: 0.9953 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/587104
[33m[INFO] loading file 40-40/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587104, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587104, 17)

[INFO] analyzing data
[INFO] 587104 rows
[INFO] ** appi_name:[21:99.99659%,30:0.0029%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.33937%,Single Stage Single Point:35.66063%]
[INFO] ** dst:[21:43.29488%,10:21.03988%,8:18.19558%,9:17.46522%,15:0.0029%,22:0.00085%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99727%,0:0.00273%]
[INFO] ** i/f_name:[2:99.9971%,3:0.0029%]
[INFO] ** modbus_function_code:[0.02961:99.99659%,-33.760870000000004:0.00341%]
[INFO] ** modbus_function_description:[7:49.99932%,11:49.99727%,0:0.00341%]
[INFO] ** modbus_transaction_id:65536 (11.16259%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.99659%,1:0.0029%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.35947%,20:25.97615%,13:18.19541%,6:17.46556%,17:0.0029%,14:0.00051%]
[INFO] ** s_port:[1.45442:25.9753%,-0.32151:21.03988%,-1.27613:18.19524%,-0.23351:17.46505%,-0.33484:17.31959%,-71.33197:0.0029%,1.45709:0.00051%,-0.24151:0.00034%,-71.14798:0.00017%,-1.27347:0.00017%,11.862:0.00017%,-0.24950999999999998:0.00017%,1.46509:0.00017%,1.47576:0.00017%,13.431270000000001:0.00017%]
[INFO] ** scada_tag:[3:25.97496%,1:21.03971%,5:18.19507%,4:17.46471%,2:17.31942%,0:0.00613%]
[INFO] ** service:[0.0048200000000000005:99.99659%,-211.73542999999998:0.0029%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.35947%,9:25.97615%,7:18.19541%,1:17.46556%,14:0.0029%,2:0.00051%]
[INFO] ** type:[0:99.99915%,1:0.00085%]
[INFO] ** unixtime:1596 (0.27184%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79140.0000 - fp: 860.0000 - tn: 319140.0000 - fn: 860.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-9-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0234 - tp: 79054.0000 - fp: 946.0000 - tn: 319054.0000 - fn: 946.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79127.0000 - fp: 873.0000 - tn: 319127.0000 - fn: 873.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/587104
[33m[INFO] loading file 41-41/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (527262, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (527262, 17)

[INFO] analyzing data
[INFO] 527262 rows
[INFO] ** appi_name:[21:99.99678%,30:0.00095%,22:0.00076%,17:0.00076%,32:0.00019%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.38526%,Single Stage Single Point:35.61474%]
[INFO] ** dst:[21:43.32343%,10:21.05784%,8:18.14639%,9:17.46817%,16:0.00095%,15:0.00095%,6:0.00095%,22:0.00057%,24:0.00038%,17:0.00038%]
[INFO] ** i/f_dir:[1:99.99905%,0:0.00095%]
[INFO] ** i/f_name:[2:99.99905%,3:0.00095%]
[INFO] ** modbus_function_code:[0.02961:99.99678%,-33.760870000000004:0.00322%]
[INFO] ** modbus_function_description:[7:49.99905%,11:49.99772%,0:0.00322%]
[INFO] ** modbus_transaction_id:65536 (12.42949%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99791%,2:0.00114%,1:0.00095%]
[INFO] ** proxy_src_ip:[18:38.42701%,20:25.95446%,13:18.14658%,6:17.46836%,17:0.00095%,1:0.00076%,21:0.00038%,16:0.00038%,14:0.00038%,0:0.00038%,7:0.00019%,2:0.00019%]
[INFO] ** s_port:[1.45442:25.95408%,-0.32151:21.05784%,-1.27613:18.14601%,-0.23351:17.46798%,-0.33484:17.36916%,-71.33197:0.00095%,-71.14931:0.00076%,-1.27347:0.00038%,-1.02014:0.00038%,-0.24151:0.00019%,-5.1466400000000005:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,1.46509:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,-5.08665:0.00019%,-64.19226:0.00019%,-0.24950999999999998:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:25.95389%,1:21.05784%,5:18.14601%,4:17.46779%,2:17.36897%,0:0.0055%]
[INFO] ** service:[0.0048200000000000005:99.99678%,-211.73542999999998:0.00095%,-205.44247:0.00076%,-211.08818:0.00076%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%,89.64175:0.00019%]
[INFO] ** src:[22:38.42701%,9:25.95446%,7:18.14658%,1:17.46836%,14:0.00095%,3:0.00076%,15:0.00038%,8:0.00038%,4:0.00038%,2:0.00038%,21:0.00019%,17:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1430 (0.27121%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/527262
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79091.0000 - fp: 909.0000 - tn: 319091.0000 - fn: 909.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/527262
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/527262
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79093.0000 - fp: 907.0000 - tn: 319093.0000 - fn: 907.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/527262
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79084.0000 - fp: 916.0000 - tn: 319084.0000 - fn: 916.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-9-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/527262
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79155.0000 - fp: 845.0000 - tn: 319155.0000 - fn: 845.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-40-41-batch-400000-500000
[INFO] processing batch 500000-600000/527262
[33m[INFO] loading file 42-42/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (370776, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (370776, 17)

[INFO] analyzing data
[INFO] 370776 rows
[INFO] ** appi_name:[21:99.99083%,30:0.00243%,17:0.00135%,31:0.00108%,26:0.00108%,7:0.00108%,22:0.00081%,28:0.00027%,27:0.00027%,9:0.00027%,8:0.00027%,0:0.00027%]
[INFO] ** classification:[normal:64.3553%,Single Stage Single Point:35.6447%]
[INFO] ** dst:[21:43.30485%,10:21.04074%,8:18.19589%,9:17.44854%,16:0.00243%,6:0.00216%,18:0.00135%,2:0.00108%,22:0.00081%,15:0.00081%,17:0.00054%,25:0.00027%,7:0.00027%,0:0.00027%]
[INFO] ** i/f_dir:[1:99.99919%,0:0.00081%]
[INFO] ** i/f_name:[2:99.99919%,3:0.00081%]
[INFO] ** modbus_function_code:[0.02961:99.99083%,-33.760870000000004:0.00917%]
[INFO] ** modbus_function_description:[7:49.99595%,11:49.99488%,0:0.00917%]
[INFO] ** modbus_transaction_id:65536 (17.67536%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99515%,2:0.00405%,1:0.00081%]
[INFO] ** proxy_src_ip:[18:38.39461%,20:25.95125%,13:18.19616%,6:17.44854%,17:0.00243%,1:0.00243%,14:0.00162%,21:0.00108%,7:0.00081%,0:0.00054%,16:0.00027%,2:0.00027%]
[INFO] ** s_port:[1.45442:25.95071%,-0.32151:21.04074%,-1.27613:18.19589%,-0.23351:17.44827%,-0.33484:17.35387%,-71.14931:0.00108%,-71.14798:0.00108%,-71.33197:0.00081%,-3.3787199999999995:0.00054%,-0.08551:0.00054%,11.57001:0.00054%,13.431270000000001:0.00027%,-5.1466400000000005:0.00027%,0.31847:0.00027%,-1.02014:0.00027%,-64.19493:0.00027%,-1.2708:0.00027%,-58.035180000000004:0.00027%,7.66617:0.00027%,-0.24151:0.00027%,1.47576:0.00027%,14.4699:0.00027%,15.912510000000001:0.00027%,14.191239999999999:0.00027%,7.9608300000000005:0.00027%,-5.08665:0.00027%,10.192739999999999:0.00027%,-3.0613900000000003:0.00027%,1.45709:0.00027%,2.05573:0.00027%,-43.76509:0.00027%,11.862:0.00027%,-58.032509999999995:0.00027%]
[INFO] ** scada_tag:[3:25.95044%,1:21.04074%,5:18.19562%,4:17.44827%,2:17.3536%,0:0.01133%]
[INFO] ** service:[0.0048200000000000005:99.99083%,-211.09762999999998:0.00189%,-205.44247:0.00135%,-186.43601999999998:0.00135%,-211.08346:0.00108%,-211.08818:0.00108%,-211.73542999999998:0.00081%,-211.35747999999998:0.00054%,-186.44547:0.00027%,-183.8612:0.00027%,-185.9872:0.00027%,-202.75898:0.00027%]
[INFO] ** src:[22:38.39461%,9:25.95125%,7:18.19616%,1:17.44854%,3:0.00324%,2:0.00189%,4:0.00135%,21:0.00108%,14:0.00081%,8:0.00054%,17:0.00027%,15:0.00027%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1007 (0.27159%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/370776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0219 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 8.0625e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/370776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0215 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-9-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/370776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79147.0000 - fp: 853.0000 - tn: 319147.0000 - fn: 853.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/370776
[33m[INFO] loading file 43-43/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (570776, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (570776, 17)

[INFO] analyzing data
[INFO] 570776 rows
[INFO] ** appi_name:[21:99.99877%,30:0.00053%,26:0.00035%,8:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.39847%,Single Stage Single Point:35.60153%]
[INFO] ** dst:[21:43.32523%,10:21.07096%,8:18.13005%,9:17.4713%,22:0.00105%,15:0.00053%,6:0.00035%,2:0.00035%,24:0.00018%]
[INFO] ** i/f_dir:[1:99.99982%,0:0.00018%]
[INFO] ** i/f_name:[2:99.99947%,3:0.00053%]
[INFO] ** modbus_function_code:[0.02961:99.99877%,-33.760870000000004:0.00123%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99877%,0:0.00123%]
[INFO] ** modbus_transaction_id:65536 (11.48191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99912%,1:0.00053%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.42068%,20:25.97604%,13:18.13023%,6:17.47148%,17:0.00053%,1:0.00053%,16:0.00035%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.97534%,-0.32151:21.07096%,-1.27613:18.12988%,-0.23351:17.47095%,-0.33484:17.34971%,-71.33197:0.00053%,-71.14798:0.00035%,1.45709:0.00035%,1.47576:0.00035%,-0.24151:0.00035%,-1.02014:0.00035%,0.31847:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-1.2708:0.00018%,-3.3787199999999995:0.00018%]
[INFO] ** scada_tag:[3:25.97499%,1:21.07096%,5:18.1297%,4:17.4706%,2:17.34954%,0:0.0042%]
[INFO] ** service:[0.0048200000000000005:99.99877%,-211.73542999999998:0.00053%,-211.08346:0.00035%,-211.09762999999998:0.00018%,-211.35747999999998:0.00018%]
[INFO] ** src:[22:38.42068%,9:25.97604%,7:18.13023%,1:17.47148%,14:0.00053%,3:0.00053%,15:0.00035%,21:0.00018%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1552 (0.27191%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79184.0000 - fp: 816.0000 - tn: 319184.0000 - fn: 816.0000 - accuracy: 0.9959 - precision: 0.9898 - recall: 0.9898 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79106.0000 - fp: 894.0000 - tn: 319106.0000 - fn: 894.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79167.0000 - fp: 833.0000 - tn: 319167.0000 - fn: 833.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/570776
[33m[INFO] loading file 44-44/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (570776, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (570776, 17)

[INFO] analyzing data
[INFO] 570776 rows
[INFO] ** appi_name:[21:99.99825%,30:0.0007%,31:0.00053%,0:0.00035%,22:0.00018%]
[INFO] ** classification:[normal:64.39461%,Single Stage Single Point:35.60539%]
[INFO] ** dst:[21:43.33679%,10:21.05484%,8:18.14915%,9:17.45606%,22:0.00105%,15:0.0007%,18:0.00053%,25:0.00035%,24:0.00035%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.9993%,0:0.0007%]
[INFO] ** i/f_name:[2:99.9993%,3:0.0007%]
[INFO] ** modbus_function_code:[0.02961:99.99825%,-33.760870000000004:0.00175%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99825%,0:0.00175%]
[INFO] ** modbus_transaction_id:65536 (11.48191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99825%,2:0.00105%,1:0.0007%]
[INFO] ** proxy_src_ip:[18:38.43627%,20:25.95589%,13:18.14933%,6:17.45659%,17:0.0007%,7:0.00035%,16:0.00018%,5:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95519%,-0.32151:21.05484%,-1.27613:18.1488%,-0.23351:17.45588%,-0.33484:17.38142%,-71.33197:0.0007%,-0.24151:0.00053%,-0.08551:0.00035%,-64.19493:0.00035%,-1.27347:0.00035%,1.45709:0.00035%,-1.02014:0.00018%,-1.2708:0.00018%,1.47576:0.00018%,-71.14931:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,4.42897:0.00018%]
[INFO] ** scada_tag:[3:25.95467%,1:21.05484%,5:18.1488%,4:17.45553%,2:17.38125%,0:0.00491%]
[INFO] ** service:[0.0048200000000000005:99.99825%,-211.73542999999998:0.0007%,-186.43601999999998:0.00053%,-186.44547:0.00035%,-211.08818:0.00018%]
[INFO] ** src:[22:38.43627%,9:25.95589%,7:18.14933%,1:17.45659%,14:0.0007%,21:0.00035%,17:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1549 (0.27138%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 0.0024 - val_tp: 19997.0000 - val_fp: 3.0000 - val_tn: 79997.0000 - val_fn: 3.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-9-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79129.0000 - fp: 871.0000 - tn: 319129.0000 - fn: 871.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79149.0000 - fp: 851.0000 - tn: 319149.0000 - fn: 851.0000 - accuracy: 0.9957 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/570776
[33m[INFO] loading file 45-45/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (570776, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (570776, 17)

[INFO] analyzing data
[INFO] 570776 rows
[INFO] ** appi_name:[21:99.99877%,30:0.00053%,31:0.00035%,26:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:64.41389%,Single Stage Single Point:35.58611%]
[INFO] ** dst:[21:43.32295%,10:21.08813%,8:18.13023%,9:17.45606%,22:0.0014%,15:0.00053%,18:0.00035%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99965%,0:0.00035%]
[INFO] ** i/f_name:[2:99.99947%,3:0.00053%]
[INFO] ** modbus_function_code:[0.02961:99.99877%,-33.760870000000004:0.00123%]
[INFO] ** modbus_function_description:[7:50.00035%,11:49.99842%,0:0.00123%]
[INFO] ** modbus_transaction_id:65536 (11.48191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99895%,2:0.00053%,1:0.00053%]
[INFO] ** proxy_src_ip:[18:38.48235%,20:25.92944%,13:18.13005%,6:17.45659%,17:0.00053%,16:0.00035%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.92874%,-0.32151:21.08813%,-1.27613:18.13005%,-0.23351:17.45588%,-0.33484:17.39421%,1.45709:0.00053%,-0.24151:0.00053%,-71.33197:0.00053%,-1.02014:0.00035%,-0.08551:0.00035%,-71.14798:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.92821%,1:21.08796%,5:18.13005%,4:17.45588%,2:17.39404%,0:0.00385%]
[INFO] ** service:[0.0048200000000000005:99.99877%,-211.73542999999998:0.00053%,-186.43601999999998:0.00035%,-183.8612:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.48235%,9:25.92944%,7:18.13005%,1:17.45659%,14:0.00053%,15:0.00035%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1549 (0.27138%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79128.0000 - fp: 872.0000 - tn: 319128.0000 - fn: 872.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79087.0000 - fp: 913.0000 - tn: 319087.0000 - fn: 913.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79078.0000 - fp: 922.0000 - tn: 319078.0000 - fn: 922.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1935e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79127.0000 - fp: 873.0000 - tn: 319127.0000 - fn: 873.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.2278e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/570776
[33m[INFO] loading file 46-46/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (570776, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (570776, 17)

[INFO] analyzing data
[INFO] 570776 rows
[INFO] ** appi_name:[21:99.99825%,30:0.00105%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.42405%,Single Stage Single Point:35.57595%]
[INFO] ** dst:[21:43.348%,10:21.07342%,8:18.1036%,9:17.47235%,22:0.00105%,15:0.00105%,25:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99912%,0:0.00088%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.99825%,-33.760870000000004:0.00175%]
[INFO] ** modbus_function_description:[11:49.99912%,7:49.99912%,0:0.00175%]
[INFO] ** modbus_transaction_id:65536 (11.48191%)
[INFO] ** orig:[0:99.99965%,1:0.00035%]
[INFO] ** proto:[0:99.9986%,1:0.00105%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.44626%,20:25.97516%,13:18.1036%,6:17.47288%,17:0.00105%,16:0.00035%,7:0.00035%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.97481%,-0.32151:21.07324%,-1.27613:18.10342%,-0.23351:17.47218%,-0.33484:17.37301%,-71.33197:0.00105%,-0.24151:0.00053%,-1.02014:0.00035%,-71.14798:0.00018%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:25.97446%,1:21.07307%,5:18.10325%,4:17.47183%,2:17.37301%,0:0.00438%]
[INFO] ** service:[0.0048200000000000005:99.99842%,-211.73542999999998:0.00105%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.44626%,9:25.97516%,7:18.1036%,1:17.47288%,14:0.00105%,21:0.00035%,15:0.00035%,16:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99912%,1:0.00088%]
[INFO] ** unixtime:1552 (0.27191%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0218 - tp: 79143.0000 - fp: 857.0000 - tn: 319143.0000 - fn: 857.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79138.0000 - fp: 862.0000 - tn: 319138.0000 - fn: 862.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/570776
[33m[INFO] loading file 47-47/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (570776, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (570776, 17)

[INFO] analyzing data
[INFO] 570776 rows
[INFO] ** appi_name:[21:99.99947%,33:0.00018%,26:0.00018%,17:0.00018%]
[INFO] ** classification:[normal:64.39321%,Single Stage Single Point:35.60679%]
[INFO] ** dst:[21:43.30911%,10:21.08218%,8:18.13023%,9:17.47621%,22:0.00158%,24:0.00035%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99947%,-33.760870000000004:0.00053%]
[INFO] ** modbus_function_description:[7:50.00088%,11:49.9986%,0:0.00053%]
[INFO] ** modbus_transaction_id:65536 (11.48191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.45081%,20:25.94117%,13:18.13058%,6:17.47656%,16:0.00035%,7:0.00035%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.9403%,-0.32151:21.08218%,-1.27613:18.13005%,-0.23351:17.47603%,-0.33484:17.36863%,1.45709:0.00053%,-0.24151:0.00053%,-1.27347:0.00035%,-1.02014:0.00035%,-71.14798:0.00018%,-61.95635:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%]
[INFO] ** scada_tag:[3:25.93977%,1:21.082%,5:18.12988%,4:17.47586%,2:17.36846%,0:0.00403%]
[INFO] ** service:[0.0048200000000000005:99.99965%,-211.08346:0.00018%,-205.44247:0.00018%]
[INFO] ** src:[22:38.45081%,9:25.94117%,7:18.13058%,1:17.47656%,21:0.00035%,15:0.00035%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1549 (0.27138%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79163.0000 - fp: 837.0000 - tn: 319163.0000 - fn: 837.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0216 - tp: 79045.0000 - fp: 955.0000 - tn: 319045.0000 - fn: 955.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79082.0000 - fp: 918.0000 - tn: 319082.0000 - fn: 918.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79072.0000 - fp: 928.0000 - tn: 319072.0000 - fn: 928.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/570776
[33m[INFO] loading file 48-48/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (570776, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (570776, 17)

[INFO] analyzing data
[INFO] 570776 rows
[INFO] ** appi_name:[21:99.99685%,30:0.00245%,33:0.00018%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.43246%,Single Stage Single Point:35.56754%]
[INFO] ** dst:[21:43.33364%,10:21.09497%,8:18.09974%,9:17.46762%,15:0.00245%,22:0.00088%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.9979%,0:0.0021%]
[INFO] ** i/f_name:[2:99.99755%,3:0.00245%]
[INFO] ** modbus_function_code:[0.02961:99.99685%,-33.760870000000004:0.00315%]
[INFO] ** modbus_function_description:[7:49.99912%,11:49.99772%,0:0.00315%]
[INFO] ** modbus_transaction_id:65536 (11.48191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99702%,1:0.00245%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.47254%,20:25.95642%,13:18.09992%,6:17.46762%,17:0.00245%,14:0.00053%,16:0.00035%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95589%,-0.32151:21.09497%,-1.27613:18.09957%,-0.23351:17.46745%,-0.33484:17.37757%,-71.33197:0.00245%,-1.02014:0.00035%,-1.2708:0.00018%,13.431270000000001:0.00018%,-0.24151:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-61.95635:0.00018%,1.45709:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:25.95554%,1:21.09479%,5:18.09957%,4:17.46745%,2:17.37739%,0:0.00526%]
[INFO] ** service:[0.0048200000000000005:99.99702%,-211.73542999999998:0.00245%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.47254%,9:25.95642%,7:18.09992%,1:17.46762%,14:0.00245%,2:0.00053%,15:0.00035%,8:0.00018%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1548 (0.27121%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79093.0000 - fp: 907.0000 - tn: 319093.0000 - fn: 907.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79082.0000 - fp: 918.0000 - tn: 319082.0000 - fn: 918.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79136.0000 - fp: 864.0000 - tn: 319136.0000 - fn: 864.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79098.0000 - fp: 902.0000 - tn: 319098.0000 - fn: 902.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 0.0097 - val_tp: 19988.0000 - val_fp: 12.0000 - val_tn: 79988.0000 - val_fn: 12.0000 - val_accuracy: 0.9998 - val_precision: 0.9994 - val_recall: 0.9994 - val_auc: 0.9996
[INFO] saving weights to checkpoints/lstm-epoch-9-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79094.0000 - fp: 906.0000 - tn: 319094.0000 - fn: 906.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/570776
[33m[INFO] loading file 49-49/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (570776, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (570776, 17)

[INFO] analyzing data
[INFO] 570776 rows
[INFO] ** appi_name:[21:99.99737%,30:0.00088%,17:0.0007%,26:0.00035%,22:0.00035%,28:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.37674%,Single Stage Single Point:35.62326%]
[INFO] ** dst:[21:43.31419%,10:21.05835%,8:18.13408%,9:17.489%,22:0.0014%,15:0.00088%,16:0.0007%,6:0.0007%,24:0.00035%,17:0.00035%]
[INFO] ** i/f_dir:[1:99.99912%,0:0.00088%]
[INFO] ** i/f_name:[2:99.99912%,3:0.00088%]
[INFO] ** modbus_function_code:[0.02961:99.99737%,-33.760870000000004:0.00263%]
[INFO] ** modbus_function_description:[7:49.99982%,11:49.99755%,0:0.00263%]
[INFO] ** modbus_transaction_id:65536 (11.48191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99842%,1:0.00088%,2:0.0007%]
[INFO] ** proxy_src_ip:[18:38.42208%,20:25.95116%,13:18.13426%,6:17.48952%,17:0.00088%,1:0.0007%,14:0.00053%,21:0.00035%,16:0.00035%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95029%,-0.32151:21.05835%,-1.27613:18.13373%,-0.23351:17.48882%,-0.33484:17.36373%,-71.33197:0.00088%,1.45709:0.00053%,-0.24151:0.00053%,-1.27347:0.00035%,-71.14931:0.00035%,-1.02014:0.00035%,-71.14798:0.00035%,1.47576:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,1.46509:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,-5.08665:0.00018%,-0.24950999999999998:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:25.94993%,1:21.05817%,5:18.13356%,4:17.48847%,2:17.36373%,0:0.00613%]
[INFO] ** service:[0.0048200000000000005:99.99737%,-211.73542999999998:0.00088%,-205.44247:0.0007%,-211.08346:0.00035%,-211.08818:0.00035%,-211.09762999999998:0.00018%,-185.9872:0.00018%]
[INFO] ** src:[22:38.42208%,9:25.95116%,7:18.13426%,1:17.48952%,14:0.00088%,3:0.0007%,2:0.00053%,15:0.00035%,4:0.00035%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1550 (0.27156%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79124.0000 - fp: 876.0000 - tn: 319124.0000 - fn: 876.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79097.0000 - fp: 903.0000 - tn: 319097.0000 - fn: 903.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0214 - tp: 79043.0000 - fp: 957.0000 - tn: 319043.0000 - fn: 957.0000 - accuracy: 0.9952 - precision: 0.9880 - recall: 0.9880 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79084.0000 - fp: 916.0000 - tn: 319084.0000 - fn: 916.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-9-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0219 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9998 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/570776
[33m[INFO] loading file 50-50/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (420758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (420758, 17)

[INFO] analyzing data
[INFO] 420758 rows
[INFO] ** appi_name:[21:99.99739%,30:0.00119%,7:0.00071%,31:0.00024%,22:0.00024%,8:0.00024%]
[INFO] ** classification:[normal:64.30727%,Single Stage Single Point:35.69273%]
[INFO] ** dst:[21:43.25931%,10:21.04464%,8:18.21997%,9:17.47251%,15:0.00119%,22:0.00071%,16:0.00048%,2:0.00048%,24:0.00024%,18:0.00024%,6:0.00024%]
[INFO] ** i/f_dir:[1:99.99881%,0:0.00119%]
[INFO] ** i/f_name:[2:99.99881%,3:0.00119%]
[INFO] ** modbus_function_code:[0.02961:99.99739%,-33.760870000000004:0.00261%]
[INFO] ** modbus_function_description:[7:49.99881%,11:49.99857%,0:0.00261%]
[INFO] ** modbus_transaction_id:65536 (15.5757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99834%,1:0.00119%,2:0.00048%]
[INFO] ** proxy_src_ip:[18:38.36885%,20:25.93534%,13:18.22021%,6:17.47251%,17:0.00119%,1:0.00071%,16:0.00048%,21:0.00024%,14:0.00024%,7:0.00024%]
[INFO] ** s_port:[1.45442:25.93486%,-0.32151:21.04464%,-1.27613:18.21974%,-0.23351:17.47251%,-0.33484:17.32421%,-71.33197:0.00119%,-1.02014:0.00048%,-3.3787199999999995:0.00024%,4.33564:0.00024%,15.912510000000001:0.00024%,7.9608300000000005:0.00024%,1.46509:0.00024%,1.45709:0.00024%,-1.27347:0.00024%,-71.14931:0.00024%,-1.2708:0.00024%,0.31847:0.00024%]
[INFO] ** scada_tag:[3:25.93462%,1:21.0444%,5:18.2195%,4:17.47251%,2:17.32397%,0:0.00499%]
[INFO] ** service:[0.0048200000000000005:99.99739%,-211.73542999999998:0.00119%,-211.09762999999998:0.00071%,-186.43601999999998:0.00024%,-211.35747999999998:0.00024%,-211.08818:0.00024%]
[INFO] ** src:[22:38.36885%,9:25.93534%,7:18.22021%,1:17.47251%,14:0.00119%,3:0.00071%,15:0.00048%,21:0.00024%,4:0.00024%,2:0.00024%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1143 (0.27165%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/420758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79085.0000 - fp: 915.0000 - tn: 319085.0000 - fn: 915.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/420758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79078.0000 - fp: 922.0000 - tn: 319078.0000 - fn: 922.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/420758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0215 - tp: 79050.0000 - fp: 950.0000 - tn: 319050.0000 - fn: 950.0000 - accuracy: 0.9952 - precision: 0.9881 - recall: 0.9881 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/420758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-49-50-batch-300000-400000
[INFO] processing batch 400000-500000/420758
[33m[INFO] epoch 10/10[0m
[33m[INFO] loading file 1-1/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99309%,30:0.00115%,22:0.00096%,17:0.00077%,31:0.00058%,26:0.00058%,7:0.00058%,23:0.00038%,18:0.00038%,0:0.00038%,28:0.00019%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:78.70162%,Single Stage Single Point:21.29838%]
[INFO] ** dst:[21:43.26482%,10:21.04471%,8:18.16852%,9:17.51466%,6:0.00154%,16:0.00115%,15:0.00115%,22:0.00096%,18:0.00058%,26:0.00038%,25:0.00038%,19:0.00038%,17:0.00038%,24:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99885%,0:0.00115%]
[INFO] ** i/f_name:[2:99.99885%,3:0.00115%]
[INFO] ** modbus_function_code:[0.02961:99.99309%,-33.760870000000004:0.00672%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.9975%,11:49.99558%,0:0.00672%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99616%,2:0.00269%,1:0.00115%]
[INFO] ** proxy_src_ip:[18:38.4044%,20:25.90455%,13:18.16871%,6:17.51505%,11:0.00134%,10:0.00134%,17:0.00115%,14:0.00096%,1:0.00096%,7:0.00058%,21:0.00038%,16:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.90416%,-0.32151:21.04394%,-1.27613:18.16832%,-0.23351:17.51447%,-0.33484:17.36046%,-71.33197:0.00115%,-71.14931:0.00096%,-2.1481:0.00077%,-0.24151:0.00058%,-71.14798:0.00058%,-2.42942:0.00038%,4.44364:0.00038%,-1.02014:0.00038%,-64.19493:0.00038%,-5.1466400000000005:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,4.076980000000001:0.00019%,-5.08665:0.00019%,1.47576:0.00019%,1.46509:0.00019%,4.29964:0.00019%,14.253910000000001:0.00019%,-68.79874000000001:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,10.67005:0.00019%,-1.27347:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:25.90397%,1:21.04375%,5:18.16794%,4:17.51428%,2:17.36027%,0:0.00979%]
[INFO] ** service:[0.0048200000000000005:99.99386%,-211.73542999999998:0.00115%,-211.08818:0.00096%,-205.44247:0.00077%,-211.07873999999998:0.00077%,-211.09762999999998:0.00058%,-211.08346:0.00058%,-186.43601999999998:0.00058%,-186.44547:0.00038%,-185.9872:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.4044%,9:25.90455%,7:18.16871%,1:17.51505%,11:0.00134%,10:0.00134%,14:0.00115%,3:0.00096%,2:0.00096%,21:0.00058%,15:0.00038%,4:0.00038%,8:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1413 (0.27134%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3348 - tp: 75992.0000 - fp: 4008.0000 - tn: 315992.0000 - fn: 4008.0000 - accuracy: 0.9800 - precision: 0.9499 - recall: 0.9499 - auc: 0.9859 - val_loss: 0.0348 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0283 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0146 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0151 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0080 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.3536 - tp: 58211.0000 - fp: 21789.0000 - tn: 298211.0000 - fn: 21789.0000 - accuracy: 0.8911 - precision: 0.7276 - recall: 0.7276 - auc: 0.9176 - val_loss: 0.3649 - val_tp: 15827.0000 - val_fp: 4173.0000 - val_tn: 75827.0000 - val_fn: 4173.0000 - val_accuracy: 0.9165 - val_precision: 0.7914 - val_recall: 0.7914 - val_auc: 0.9755
[INFO] saving weights to checkpoints/lstm-epoch-10-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4057 - tp: 63409.0000 - fp: 16591.0000 - tn: 303409.0000 - fn: 16591.0000 - accuracy: 0.9170 - precision: 0.7926 - recall: 0.7926 - auc: 0.9718 - val_loss: 0.3568 - val_tp: 15861.0000 - val_fp: 4139.0000 - val_tn: 75861.0000 - val_fn: 4139.0000 - val_accuracy: 0.9172 - val_precision: 0.7930 - val_recall: 0.7930 - val_auc: 0.9758
[INFO] saving weights to checkpoints/lstm-epoch-10-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 2-2/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99866%,7:0.00058%,30:0.00038%,31:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:72.00254%,Single Stage Single Point:27.99746%]
[INFO] ** dst:[21:43.31378%,10:21.02954%,8:18.13971%,9:17.51466%,22:0.00077%,16:0.00038%,15:0.00038%,2:0.00038%,24:0.00019%,18:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99866%,-33.760870000000004:0.00134%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99885%,0:0.00134%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99942%,1:0.00038%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.38117%,20:25.96273%,13:18.13971%,6:17.51485%,1:0.00058%,17:0.00038%,16:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.96196%,-0.32151:21.02954%,-1.27613:18.13933%,-0.23351:17.51447%,-0.33484:17.35163%,-71.33197:0.00038%,1.45709:0.00038%,12.60597:0.00019%,-1.2708:0.00019%,-1.02014:0.00019%,-0.24151:0.00019%,4.076980000000001:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-1.27347:0.00019%,-3.3787199999999995:0.00019%,-0.24950999999999998:0.00019%,10.67005:0.00019%,4.29964:0.00019%]
[INFO] ** scada_tag:[3:25.96158%,1:21.02954%,5:18.13933%,4:17.51428%,2:17.35144%,0:0.00384%]
[INFO] ** service:[0.0048200000000000005:99.99866%,-211.09762999999998:0.00058%,-211.73542999999998:0.00038%,-186.43601999999998:0.00019%,-211.35747999999998:0.00019%]
[INFO] ** src:[22:38.38117%,9:25.96273%,7:18.13971%,1:17.51485%,3:0.00058%,14:0.00038%,21:0.00019%,15:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1416 (0.27191%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4792 - tp: 60753.0000 - fp: 19247.0000 - tn: 300753.0000 - fn: 19247.0000 - accuracy: 0.9038 - precision: 0.7594 - recall: 0.7594 - auc: 0.9637 - val_loss: 0.3553 - val_tp: 16003.0000 - val_fp: 3997.0000 - val_tn: 76003.0000 - val_fn: 3997.0000 - val_accuracy: 0.9201 - val_precision: 0.8001 - val_recall: 0.8001 - val_auc: 0.9780
[INFO] saving weights to checkpoints/lstm-epoch-10-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5266 - tp: 58588.0000 - fp: 21412.0000 - tn: 298588.0000 - fn: 21412.0000 - accuracy: 0.8929 - precision: 0.7323 - recall: 0.7323 - auc: 0.9574 - val_loss: 0.3728 - val_tp: 17302.0000 - val_fp: 2698.0000 - val_tn: 77302.0000 - val_fn: 2698.0000 - val_accuracy: 0.9460 - val_precision: 0.8651 - val_recall: 0.8651 - val_auc: 0.9881
[INFO] saving weights to checkpoints/lstm-epoch-10-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1052 - tp: 79817.0000 - fp: 183.0000 - tn: 319817.0000 - fn: 183.0000 - accuracy: 0.9991 - precision: 0.9977 - recall: 0.9977 - auc: 1.0000 - val_loss: 1.0217 - val_tp: 12788.0000 - val_fp: 7212.0000 - val_tn: 72788.0000 - val_fn: 7212.0000 - val_accuracy: 0.8558 - val_precision: 0.6394 - val_recall: 0.6394 - val_auc: 0.9099
[INFO] saving weights to checkpoints/lstm-epoch-10-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.8998 - tp: 49081.0000 - fp: 30919.0000 - tn: 289081.0000 - fn: 30919.0000 - accuracy: 0.8454 - precision: 0.6135 - recall: 0.6135 - auc: 0.9004 - val_loss: 0.1726 - val_tp: 19578.0000 - val_fp: 422.0000 - val_tn: 79578.0000 - val_fn: 422.0000 - val_accuracy: 0.9916 - val_precision: 0.9789 - val_recall: 0.9789 - val_auc: 0.9997
[INFO] saving weights to checkpoints/lstm-epoch-10-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5036 - tp: 60366.0000 - fp: 19634.0000 - tn: 300366.0000 - fn: 19634.0000 - accuracy: 0.9018 - precision: 0.7546 - recall: 0.7546 - auc: 0.9641 - val_loss: 0.4686 - val_tp: 12983.0000 - val_fp: 7017.0000 - val_tn: 72983.0000 - val_fn: 7017.0000 - val_accuracy: 0.8597 - val_precision: 0.6492 - val_recall: 0.6492 - val_auc: 0.9565
[INFO] saving weights to checkpoints/lstm-epoch-10-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 3-3/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99117%,30:0.0023%,22:0.00115%,31:0.00096%,26:0.00096%,17:0.00096%,7:0.00077%,27:0.00038%,0:0.00038%,28:0.00019%,23:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:87.24129%,Single Stage Single Point:12.75871%]
[INFO] ** dst:[21:43.30438%,10:21.08753%,8:18.15507%,9:17.44323%,6:0.0023%,15:0.00154%,18:0.00134%,16:0.00134%,22:0.00096%,2:0.00038%,7:0.00038%,25:0.00038%,17:0.00038%,12:0.00019%,24:0.00019%,19:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99846%,0:0.00154%]
[INFO] ** i/f_name:[2:99.99846%,3:0.00154%]
[INFO] ** modbus_function_code:[0.02961:99.99117%,-33.760870000000004:0.00864%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99616%,11:49.99501%,0:0.00864%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99885%,2:0.00115%]
[INFO] ** proto:[0:99.99386%,2:0.00461%,1:0.00154%]
[INFO] ** proxy_src_ip:[18:38.41804%,20:25.97425%,13:18.15527%,6:17.44361%,17:0.0023%,1:0.00154%,14:0.00134%,7:0.00096%,11:0.00077%,10:0.00077%,21:0.00058%,16:0.00019%,15:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.97348%,-0.32151:21.08734%,-1.27613:18.15469%,-0.23351:17.44303%,-0.33484:17.3307%,-71.33197:0.00154%,-71.14798:0.00115%,-71.14931:0.00115%,-64.19493:0.00038%,-0.08551:0.00038%,1.45709:0.00038%,-0.24151:0.00038%,13.431270000000001:0.00019%,14.4699:0.00019%,4.076980000000001:0.00019%,-5.1466400000000005:0.00019%,-1.02014:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,12.60597:0.00019%,-5.08665:0.00019%,1.46509:0.00019%,-2.1481:0.00019%,-1.27347:0.00019%,10.67005:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,6.1115699999999995:0.00019%,4.44364:0.00019%,13.86459:0.00019%,4.29964:0.00019%,-0.24950999999999998:0.00019%,-3.3787199999999995:0.00019%,10.192739999999999:0.00019%,-68.79874000000001:0.00019%,14.253910000000001:0.00019%,4.90362:0.00019%,-68.36943000000001:0.00019%]
[INFO] ** scada_tag:[3:25.9731%,1:21.08715%,5:18.1545%,4:17.44284%,2:17.33051%,0:0.01191%]
[INFO] ** service:[0.0048200000000000005:99.99136%,-211.73542999999998:0.00154%,-186.43601999999998:0.00134%,-211.08346:0.00115%,-211.08818:0.00115%,-205.44247:0.00096%,-211.09762999999998:0.00077%,-186.44547:0.00038%,-202.75898:0.00038%,-183.8612:0.00019%,-185.9872:0.00019%,-201.23771000000002:0.00019%,-211.35747999999998:0.00019%,-211.07873999999998:0.00019%]
[INFO] ** src:[22:38.41804%,9:25.97425%,7:18.15527%,1:17.44361%,21:0.00211%,3:0.00173%,2:0.00134%,11:0.00077%,10:0.00077%,4:0.00077%,14:0.00038%,8:0.00038%,17:0.00019%,15:0.00019%,13:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1414 (0.27153%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4965 - tp: 58949.0000 - fp: 21051.0000 - tn: 298949.0000 - fn: 21051.0000 - accuracy: 0.8947 - precision: 0.7369 - recall: 0.7369 - auc: 0.9612 - val_loss: 0.3966 - val_tp: 15004.0000 - val_fp: 4996.0000 - val_tn: 75004.0000 - val_fn: 4996.0000 - val_accuracy: 0.9001 - val_precision: 0.7502 - val_recall: 0.7502 - val_auc: 0.9768
[INFO] saving weights to checkpoints/lstm-epoch-10-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3774 - tp: 69029.0000 - fp: 10971.0000 - tn: 309029.0000 - fn: 10971.0000 - accuracy: 0.9451 - precision: 0.8629 - recall: 0.8629 - auc: 0.9769 - val_loss: 0.8653 - val_tp: 10570.0000 - val_fp: 9430.0000 - val_tn: 70570.0000 - val_fn: 9430.0000 - val_accuracy: 0.8114 - val_precision: 0.5285 - val_recall: 0.5285 - val_auc: 0.9255
[INFO] saving weights to checkpoints/lstm-epoch-10-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1277 - tp: 79316.0000 - fp: 684.0000 - tn: 319316.0000 - fn: 684.0000 - accuracy: 0.9966 - precision: 0.9915 - recall: 0.9915 - auc: 0.9990 - val_loss: 0.0900 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0764 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0650 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0568 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0497 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 4-4/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.9977%,30:0.00134%,31:0.00038%,33:0.00019%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:91.59302%,Single Stage Single Point:8.40698%]
[INFO] ** dst:[21:43.35545%,10:20.94024%,8:18.1714%,9:17.52945%,15:0.00134%,22:0.00115%,18:0.00038%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99885%,0:0.00115%]
[INFO] ** i/f_name:[2:99.99866%,3:0.00134%]
[INFO] ** modbus_function_code:[0.02961:99.9977%,-33.760870000000004:0.0023%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99808%,0:0.0023%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99885%,2:0.00115%]
[INFO] ** proto:[0:99.99808%,1:0.00134%,2:0.00058%]
[INFO] ** proxy_src_ip:[18:38.25846%,20:26.03762%,13:18.1714%,6:17.52983%,17:0.00134%,21:0.00038%,16:0.00038%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.03685%,-0.32151:20.94005%,-1.27613:18.17101%,-0.23351:17.52926%,-0.33484:17.31841%,-71.33197:0.00134%,1.45709:0.00038%,-0.24151:0.00038%,-1.02014:0.00038%,-0.08551:0.00038%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,14.4699:0.00019%,-49.275529999999996:0.00019%,-1.2708:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:26.03666%,1:20.93986%,5:18.17101%,4:17.52887%,2:17.31822%,0:0.00538%]
[INFO] ** service:[0.0048200000000000005:99.99789%,-211.73542999999998:0.00134%,-186.43601999999998:0.00038%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.25846%,9:26.03762%,7:18.1714%,1:17.52983%,21:0.00115%,15:0.00038%,4:0.00038%,17:0.00019%,14:0.00019%,8:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1424 (0.27345%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0476 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0387 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0350 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0316 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0288 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0262 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0241 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5446 - val_tp: 11993.0000 - val_fp: 8007.0000 - val_tn: 71993.0000 - val_fn: 8007.0000 - val_accuracy: 0.8399 - val_precision: 0.5997 - val_recall: 0.5997 - val_auc: 0.8999
[INFO] saving weights to checkpoints/lstm-epoch-10-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.4055 - tp: 44228.0000 - fp: 35772.0000 - tn: 284228.0000 - fn: 35772.0000 - accuracy: 0.8211 - precision: 0.5529 - recall: 0.5529 - auc: 0.8883 - val_loss: 0.0854 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 5-5/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99674%,30:0.0023%,37:0.00019%,26:0.00019%,12:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:89.1802%,Single Stage Single Point:10.8198%]
[INFO] ** dst:[21:43.36563%,10:20.76358%,8:18.24667%,9:17.62028%,15:0.0023%,22:0.00077%,25:0.00019%,24:0.00019%,6:0.00019%,2:0.00019%]
[INFO] ** i/f_dir:[1:99.99808%,0:0.00192%]
[INFO] ** i/f_name:[2:99.9977%,3:0.0023%]
[INFO] ** modbus_function_code:[0.02961:99.99674%,-33.760870000000004:0.00326%]
[INFO] ** modbus_function_description:[7:49.99904%,11:49.9977%,0:0.00326%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99827%,2:0.00173%]
[INFO] ** proto:[0:99.99731%,1:0.0023%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:37.99442%,20:26.13479%,13:18.24686%,6:17.62047%,17:0.0023%,21:0.00019%,16:0.00019%,7:0.00019%,5:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.1344%,-0.32151:20.7632%,-1.27613:18.24667%,-0.23351:17.62008%,-0.33484:17.23123%,-71.33197:0.0023%,-0.24151:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,1.45709:0.00019%,1.47576:0.00019%,2.22906:0.00019%,-49.275529999999996:0.00019%,-61.95768:0.00019%,-1.02014:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:26.13402%,1:20.763%,5:18.24648%,4:17.62008%,2:17.23123%,0:0.00518%]
[INFO] ** service:[0.0048200000000000005:99.99712%,-211.73542999999998:0.0023%,-186.44547:0.00019%,-211.08346:0.00019%,-211.35747999999998:0.00019%]
[INFO] ** src:[22:37.99442%,9:26.13479%,7:18.24686%,1:17.62047%,21:0.00192%,14:0.00058%,16:0.00019%,15:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1423 (0.27326%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3892 - tp: 69908.0000 - fp: 10092.0000 - tn: 309908.0000 - fn: 10092.0000 - accuracy: 0.9495 - precision: 0.8738 - recall: 0.8738 - auc: 0.9668 - val_loss: 0.9193 - val_tp: 12815.0000 - val_fp: 7185.0000 - val_tn: 72815.0000 - val_fn: 7185.0000 - val_accuracy: 0.8563 - val_precision: 0.6407 - val_recall: 0.6407 - val_auc: 0.9099
[INFO] saving weights to checkpoints/lstm-epoch-10-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6701 - tp: 57565.0000 - fp: 22435.0000 - tn: 297565.0000 - fn: 22435.0000 - accuracy: 0.8878 - precision: 0.7196 - recall: 0.7196 - auc: 0.9310 - val_loss: 0.0998 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2811 - tp: 76083.0000 - fp: 3917.0000 - tn: 316083.0000 - fn: 3917.0000 - accuracy: 0.9804 - precision: 0.9510 - recall: 0.9510 - auc: 0.9837 - val_loss: 0.1111 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0970 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0843 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0748 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0662 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 6-6/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99558%,30:0.00346%,31:0.00019%,27:0.00019%,26:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:92.24112%,Single Stage Single Point:7.75888%]
[INFO] ** dst:[21:43.37735%,10:20.73036%,8:18.28335%,9:17.60395%,15:0.00346%,22:0.00038%,25:0.00019%,24:0.00019%,18:0.00019%,12:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99674%,0:0.00326%]
[INFO] ** i/f_name:[2:99.99654%,3:0.00346%]
[INFO] ** modbus_function_code:[0.02961:99.99558%,-33.760870000000004:0.00442%]
[INFO] ** modbus_function_description:[7:49.99846%,11:49.99712%,0:0.00442%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99558%,1:0.00346%,2:0.00096%]
[INFO] ** proxy_src_ip:[18:37.94622%,20:26.16167%,13:18.28354%,6:17.60415%,17:0.00346%,14:0.00058%,16:0.00019%,11:0.00019%]
[INFO] ** s_port:[1.45442:26.16129%,-0.32151:20.73036%,-1.27613:18.28296%,-0.23351:17.60376%,-0.33484:17.21587%,-71.33197:0.00346%,-0.24151:0.00019%,-1.2708:0.00019%,-64.19493:0.00019%,-1.02014:0.00019%,13.431270000000001:0.00019%,4.90362:0.00019%,-71.14798:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-1.27347:0.00019%,-68.36943000000001:0.00019%]
[INFO] ** scada_tag:[3:26.1611%,1:20.73017%,5:18.28277%,4:17.60338%,2:17.21567%,0:0.00691%]
[INFO] ** service:[0.0048200000000000005:99.99558%,-211.73542999999998:0.00346%,-186.44547:0.00019%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-201.23771000000002:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:37.94622%,9:26.16167%,7:18.28354%,1:17.60415%,14:0.00346%,2:0.00058%,15:0.00019%,10:0.00019%]
[INFO] ** type:[0:99.99904%,1:0.00096%]
[INFO] ** unixtime:1426 (0.27383%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0596 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0534 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0485 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0439 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0402 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0366 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0337 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0309 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.9751 - tp: 54359.0000 - fp: 25641.0000 - tn: 294359.0000 - fn: 25641.0000 - accuracy: 0.8718 - precision: 0.6795 - recall: 0.6795 - auc: 0.9209 - val_loss: 0.5896 - val_tp: 14484.0000 - val_fp: 5516.0000 - val_tn: 74484.0000 - val_fn: 5516.0000 - val_accuracy: 0.8897 - val_precision: 0.7242 - val_recall: 0.7242 - val_auc: 0.9583
[INFO] saving weights to checkpoints/lstm-epoch-10-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 7-7/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99539%,30:0.00134%,22:0.00096%,17:0.00077%,26:0.00058%,31:0.00038%,28:0.00019%,27:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:81.9636%,Single Stage Single Point:18.0364%]
[INFO] ** dst:[21:43.36083%,10:20.74495%,8:18.25186%,9:17.63602%,6:0.00154%,22:0.00134%,15:0.00134%,16:0.00077%,24:0.00038%,18:0.00038%,17:0.00038%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99866%,0:0.00134%]
[INFO] ** i/f_name:[2:99.99866%,3:0.00134%]
[INFO] ** modbus_function_code:[0.02961:99.99539%,-33.760870000000004:0.00461%]
[INFO] ** modbus_function_description:[7:49.99827%,11:49.99712%,0:0.00461%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99654%,2:0.00211%,1:0.00134%]
[INFO] ** proxy_src_ip:[18:37.9685%,20:26.13805%,13:18.25224%,6:17.63621%,17:0.00134%,11:0.00077%,1:0.00077%,21:0.00058%,16:0.00038%,14:0.00038%,7:0.00038%,10:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.13709%,-0.32151:20.74495%,-1.27613:18.25166%,-0.23351:17.63583%,-0.33484:17.22355%,-71.33197:0.00134%,-71.14931:0.00096%,-71.14798:0.00058%,1.45709:0.00058%,-1.02014:0.00038%,-1.27347:0.00038%,-0.24151:0.00038%,-58.035180000000004:0.00019%,-1.2708:0.00019%,-5.1466400000000005:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-5.08665:0.00019%,14.253910000000001:0.00019%,-68.79874000000001:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:26.13671%,1:20.74495%,5:18.25166%,4:17.63564%,2:17.22355%,0:0.00749%]
[INFO] ** service:[0.0048200000000000005:99.99539%,-211.73542999999998:0.00134%,-211.08818:0.00096%,-205.44247:0.00077%,-211.08346:0.00058%,-186.43601999999998:0.00038%,-211.09762999999998:0.00019%,-185.9872:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:37.9685%,9:26.13805%,7:18.25224%,1:17.63621%,14:0.00134%,10:0.00077%,3:0.00077%,4:0.00058%,21:0.00038%,15:0.00038%,2:0.00038%,11:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1423 (0.27326%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1058 - tp: 76616.0000 - fp: 3384.0000 - tn: 316616.0000 - fn: 3384.0000 - accuracy: 0.9831 - precision: 0.9577 - recall: 0.9577 - auc: 0.9983 - val_loss: 0.0020 - val_tp: 19997.0000 - val_fp: 3.0000 - val_tn: 79997.0000 - val_fn: 3.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-10-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0299 - tp: 79127.0000 - fp: 873.0000 - tn: 319127.0000 - fn: 873.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 8.1928e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3316 - tp: 69425.0000 - fp: 10575.0000 - tn: 309425.0000 - fn: 10575.0000 - accuracy: 0.9471 - precision: 0.8678 - recall: 0.8678 - auc: 0.9858 - val_loss: 0.4376 - val_tp: 12827.0000 - val_fp: 7173.0000 - val_tn: 72827.0000 - val_fn: 7173.0000 - val_accuracy: 0.8565 - val_precision: 0.6413 - val_recall: 0.6413 - val_auc: 0.9678
[INFO] saving weights to checkpoints/lstm-epoch-10-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0565 - tp: 79357.0000 - fp: 643.0000 - tn: 319357.0000 - fn: 643.0000 - accuracy: 0.9968 - precision: 0.9920 - recall: 0.9920 - auc: 0.9997 - val_loss: 0.0275 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0062 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 8-8/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99693%,30:0.00115%,0:0.00058%,24:0.00019%,23:0.00019%,22:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:94.51223%,Single Stage Single Point:5.48777%]
[INFO] ** dst:[21:43.43361%,10:20.81139%,8:18.17255%,9:17.57861%,22:0.00134%,15:0.00115%,25:0.00058%,19:0.00038%,26:0.00019%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99923%,0:0.00077%]
[INFO] ** i/f_name:[2:99.99885%,3:0.00115%]
[INFO] ** modbus_function_code:[0.02961:99.99693%,-33.760870000000004:0.00288%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99942%,11:49.9975%,0:0.00288%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99962%,2:0.00038%]
[INFO] ** proto:[0:99.99808%,1:0.00115%,2:0.00077%]
[INFO] ** proxy_src_ip:[18:38.10081%,20:26.14477%,13:18.17178%,6:17.57899%,17:0.00115%,10:0.00115%,16:0.00058%,14:0.00038%,11:0.00019%,5:0.00019%]
[INFO] ** s_port:[1.45442:26.1442%,-0.32151:20.81139%,-1.27613:18.17159%,-0.23351:17.57841%,-0.33484:17.28941%,-71.33197:0.00115%,-15.039579999999999:0.00077%,-1.02014:0.00058%,-64.19493:0.00058%,1.45709:0.00038%,-0.24151:0.00038%,4.66896:0.00038%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-71.14931:0.00019%]
[INFO] ** scada_tag:[3:26.14381%,1:20.8112%,5:18.17159%,4:17.57822%,2:17.28922%,0:0.00595%]
[INFO] ** service:[0.0048200000000000005:99.9977%,-211.73542999999998:0.00115%,-186.44547:0.00058%,-211.07873999999998:0.00038%,-211.08818:0.00019%]
[INFO] ** src:[22:38.10081%,9:26.14477%,7:18.17178%,1:17.57899%,11:0.00115%,14:0.00077%,15:0.00058%,21:0.00038%,2:0.00038%,16:0.00019%,10:0.00019%]
[INFO] ** type:[0:99.99942%,1:0.00038%,2:0.00019%]
[INFO] ** unixtime:1427 (0.27402%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0073 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0013 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0042 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.1706e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0034 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0514e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1558 - tp: 76928.0000 - fp: 3072.0000 - tn: 316928.0000 - fn: 3072.0000 - accuracy: 0.9846 - precision: 0.9616 - recall: 0.9616 - auc: 0.9946 - val_loss: 0.4941 - val_tp: 16374.0000 - val_fp: 3626.0000 - val_tn: 76374.0000 - val_fn: 3626.0000 - val_accuracy: 0.9275 - val_precision: 0.8187 - val_recall: 0.8187 - val_auc: 0.9846
[INFO] saving weights to checkpoints/lstm-epoch-10-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3886 - tp: 65937.0000 - fp: 14063.0000 - tn: 305937.0000 - fn: 14063.0000 - accuracy: 0.9297 - precision: 0.8242 - recall: 0.8242 - auc: 0.9833 - val_loss: 0.1519 - val_tp: 17831.0000 - val_fp: 2169.0000 - val_tn: 77831.0000 - val_fn: 2169.0000 - val_accuracy: 0.9566 - val_precision: 0.8916 - val_recall: 0.8916 - val_auc: 0.9964
[INFO] saving weights to checkpoints/lstm-epoch-10-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 9-9/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99827%,30:0.00096%,31:0.00038%,26:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:95.53708%,Single Stage Single Point:4.46292%]
[INFO] ** dst:[21:43.36064%,10:20.77491%,8:18.29084%,9:17.57093%,15:0.00096%,22:0.00077%,18:0.00038%,25:0.00019%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99904%,0:0.00096%]
[INFO] ** i/f_name:[2:99.99904%,3:0.00096%]
[INFO] ** modbus_function_code:[0.02961:99.99827%,-33.760870000000004:0.00173%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99846%,0:0.00173%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99981%,2:0.00019%]
[INFO] ** proto:[0:99.99827%,1:0.00096%,2:0.00077%]
[INFO] ** proxy_src_ip:[18:38.00825%,20:26.12788%,13:18.29103%,6:17.57112%,17:0.00096%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.12711%,-0.32151:20.77491%,-1.27613:18.29065%,-0.23351:17.57073%,-0.33484:17.23334%,-71.33197:0.00096%,1.45709:0.00038%,-0.24151:0.00038%,-0.08551:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.12672%,1:20.77472%,5:18.29065%,4:17.57054%,2:17.23334%,0:0.00403%]
[INFO] ** service:[0.0048200000000000005:99.99827%,-211.73542999999998:0.00096%,-186.43601999999998:0.00038%,-186.44547:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.00825%,9:26.12788%,7:18.29103%,1:17.57112%,14:0.00077%,21:0.00019%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1425 (0.27364%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0380 - tp: 78818.0000 - fp: 1182.0000 - tn: 318818.0000 - fn: 1182.0000 - accuracy: 0.9941 - precision: 0.9852 - recall: 0.9852 - auc: 0.9998 - val_loss: 2.2438e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1759 - tp: 74432.0000 - fp: 5568.0000 - tn: 314432.0000 - fn: 5568.0000 - accuracy: 0.9722 - precision: 0.9304 - recall: 0.9304 - auc: 0.9944 - val_loss: 0.0678 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0162 - tp: 79966.0000 - fp: 34.0000 - tn: 319966.0000 - fn: 34.0000 - accuracy: 0.9998 - precision: 0.9996 - recall: 0.9996 - auc: 1.0000 - val_loss: 3.5395e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0059 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6566e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0054 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1529e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 10-10/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99654%,30:0.00192%,24:0.00019%,23:0.00019%,22:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:94.13374%,Single Stage Single Point:5.86626%]
[INFO] ** dst:[21:43.41153%,10:20.81178%,8:18.22478%,9:17.54827%,15:0.00192%,22:0.00058%,24:0.00038%,19:0.00038%,26:0.00019%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99827%,0:0.00173%]
[INFO] ** i/f_name:[2:99.99808%,3:0.00192%]
[INFO] ** modbus_function_code:[0.02961:99.99654%,-33.760870000000004:0.00326%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99904%,11:49.9975%,0:0.00326%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99923%,1:0.00077%]
[INFO] ** proto:[0:99.9977%,1:0.00192%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:38.09389%,20:26.1298%,13:18.22497%,6:17.54769%,17:0.00192%,10:0.00096%,14:0.00038%,16:0.00019%,5:0.00019%]
[INFO] ** s_port:[1.45442:26.12922%,-0.32151:20.81178%,-1.27613:18.2244%,-0.23351:17.54731%,-0.33484:17.28212%,-71.33197:0.00192%,-10.51843:0.00077%,5.71692:0.00038%,-1.27347:0.00038%,1.46509:0.00019%,1.47576:0.00019%,-0.24950999999999998:0.00019%,1.45709:0.00019%,-0.24151:0.00019%,-71.14931:0.00019%,-1.02014:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.12884%,1:20.81159%,5:18.2244%,4:17.54711%,2:17.28192%,0:0.00614%]
[INFO] ** service:[0.0048200000000000005:99.99731%,-211.73542999999998:0.00192%,-211.07873999999998:0.00038%,-186.44547:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.09389%,9:26.1298%,7:18.22497%,1:17.54769%,14:0.00192%,11:0.00096%,2:0.00038%,16:0.00019%,15:0.00019%]
[INFO] ** type:[0:99.99846%,1:0.00134%,2:0.00019%]
[INFO] ** unixtime:1423 (0.27326%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0050 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2842e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0046 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1713e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3148 - tp: 74256.0000 - fp: 5744.0000 - tn: 314256.0000 - fn: 5744.0000 - accuracy: 0.9713 - precision: 0.9282 - recall: 0.9282 - auc: 0.9847 - val_loss: 2.2832 - val_tp: 14926.0000 - val_fp: 5074.0000 - val_tn: 74926.0000 - val_fn: 5074.0000 - val_accuracy: 0.8985 - val_precision: 0.7463 - val_recall: 0.7463 - val_auc: 0.8329
[INFO] saving weights to checkpoints/lstm-epoch-10-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1262 - tp: 78284.0000 - fp: 1716.0000 - tn: 318284.0000 - fn: 1716.0000 - accuracy: 0.9914 - precision: 0.9786 - recall: 0.9786 - auc: 0.9942 - val_loss: 0.0065 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0120 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0037 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 11-11/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99885%,31:0.00038%,30:0.00038%,26:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.38407%,10:20.87822%,8:18.19982%,9:17.5354%,22:0.00134%,18:0.00038%,15:0.00038%,25:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99885%,-33.760870000000004:0.00115%]
[INFO] ** modbus_function_description:[7:50.00058%,11:49.99827%,0:0.00115%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99885%,2:0.00077%,1:0.00038%]
[INFO] ** proxy_src_ip:[18:38.14689%,20:26.11578%,13:18.19982%,6:17.53578%,16:0.00058%,17:0.00038%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.1152%,-0.32151:20.87822%,-1.27613:18.19962%,-0.23351:17.53521%,-0.33484:17.26867%,-0.24151:0.00058%,-1.02014:0.00058%,-0.08551:0.00038%,-71.33197:0.00038%,-71.14798:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.11482%,1:20.87822%,5:18.19943%,4:17.53482%,2:17.26848%,0:0.00422%]
[INFO] ** service:[0.0048200000000000005:99.99885%,-211.73542999999998:0.00038%,-186.43601999999998:0.00038%,-186.44547:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.14689%,9:26.11578%,7:18.19982%,1:17.53578%,15:0.00058%,14:0.00038%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1423 (0.27326%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0093 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0026 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0077 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0021 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0066 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0017 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0058 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0014 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0050 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0012 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 12-12/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.9977%,30:0.00211%,9:0.00019%]
[INFO] ** classification:[normal:93.05032%,Single Stage Single Point:6.94968%]
[INFO] ** dst:[21:43.39367%,10:20.87284%,8:18.19156%,9:17.53866%,15:0.00211%,22:0.00058%,24:0.00038%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99827%,0:0.00173%]
[INFO] ** i/f_name:[2:99.99789%,3:0.00211%]
[INFO] ** modbus_function_code:[0.02961:99.9977%,-33.760870000000004:0.0023%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99808%,0:0.0023%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99827%,2:0.00173%]
[INFO] ** proto:[0:99.99789%,1:0.00211%]
[INFO] ** proxy_src_ip:[18:38.14094%,20:26.12595%,13:18.19175%,6:17.53886%,17:0.00211%,16:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:26.12538%,-0.32151:20.87284%,-1.27613:18.19118%,-0.23351:17.53847%,-0.33484:17.2681%,-71.33197:0.00211%,-1.27347:0.00038%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.12499%,1:20.87284%,5:18.19118%,4:17.53809%,2:17.2681%,0:0.0048%]
[INFO] ** service:[0.0048200000000000005:99.9977%,-211.73542999999998:0.00211%,-183.8612:0.00019%]
[INFO] ** src:[22:38.14094%,9:26.12595%,7:18.19175%,1:17.53886%,21:0.00173%,14:0.00038%,15:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1423 (0.27326%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0044 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.7189e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0039 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.3675e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.4702 - tp: 67582.0000 - fp: 12418.0000 - tn: 307582.0000 - fn: 12418.0000 - accuracy: 0.9379 - precision: 0.8448 - recall: 0.8448 - auc: 0.9730 - val_loss: 0.0697 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.1841 - tp: 74672.0000 - fp: 5328.0000 - tn: 314672.0000 - fn: 5328.0000 - accuracy: 0.9734 - precision: 0.9334 - recall: 0.9334 - auc: 0.9941 - val_loss: 0.0620 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0323 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0086 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 13-13/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99635%,31:0.00077%,26:0.00058%,0:0.00058%,30:0.00038%,22:0.00038%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:85.30738%,Single Stage Single Point:14.69262%]
[INFO] ** dst:[21:43.35392%,10:20.79968%,8:18.2797%,9:17.56248%,22:0.00115%,6:0.00096%,18:0.00077%,25:0.00058%,15:0.00038%,24:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99635%,-33.760870000000004:0.00346%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99904%,11:49.99731%,0:0.00346%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99712%,2:0.0025%,1:0.00038%]
[INFO] ** proxy_src_ip:[18:38.05184%,20:26.10214%,13:18.27989%,6:17.5619%,10:0.00115%,11:0.00096%,16:0.00058%,17:0.00038%,7:0.00038%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.10157%,-0.32151:20.79968%,-1.27613:18.27951%,-0.23351:17.56152%,-0.33484:17.25216%,-9.78512:0.00077%,-71.14798:0.00058%,-64.19493:0.00058%,-1.02014:0.00058%,-0.08551:0.00038%,-71.14931:0.00038%,-0.24151:0.00038%,-71.33197:0.00038%,-1.27347:0.00019%,1.46509:0.00019%,-68.79874000000001:0.00019%,14.540560000000001:0.00019%,1.45709:0.00019%,-1.2708:0.00019%,6.1115699999999995:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:26.10118%,1:20.79949%,5:18.27951%,4:17.56152%,2:17.25197%,0:0.00634%]
[INFO] ** service:[0.0048200000000000005:99.99712%,-186.43601999999998:0.00077%,-186.44547:0.00058%,-211.08346:0.00058%,-211.73542999999998:0.00038%,-211.08818:0.00038%,-202.75898:0.00019%]
[INFO] ** src:[22:38.05184%,9:26.10214%,7:18.27989%,1:17.5619%,11:0.00115%,10:0.00096%,15:0.00058%,21:0.00038%,14:0.00038%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1423 (0.27326%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0104 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0014 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0058 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.1009e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0044 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3075e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.5376 - tp: 61199.0000 - fp: 18801.0000 - tn: 301199.0000 - fn: 18801.0000 - accuracy: 0.9060 - precision: 0.7650 - recall: 0.7650 - auc: 0.9701 - val_loss: 0.0446 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0422 - tp: 78964.0000 - fp: 1036.0000 - tn: 318964.0000 - fn: 1036.0000 - accuracy: 0.9948 - precision: 0.9870 - recall: 0.9870 - auc: 0.9998 - val_loss: 6.2544e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 14-14/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99962%,30:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:95.22542%,Single Stage Single Point:4.77458%]
[INFO] ** dst:[21:43.34566%,10:20.80851%,8:18.26875%,9:17.57553%,22:0.00077%,24:0.00038%,15:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99962%,-33.760870000000004:0.00038%]
[INFO] ** modbus_function_description:[7:50.00058%,11:49.99904%,0:0.00038%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99981%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.04627%,20:26.10848%,13:18.26895%,6:17.57573%,17:0.00019%,16:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:26.10771%,-0.32151:20.80851%,-1.27613:18.26837%,-0.23351:17.57534%,-0.33484:17.23776%,-1.27347:0.00038%,1.45709:0.00038%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:26.10733%,1:20.80851%,5:18.26818%,4:17.57496%,2:17.23757%,0:0.00346%]
[INFO] ** service:[0.0048200000000000005:99.99962%,-183.8612:0.00019%,-211.73542999999998:0.00019%]
[INFO] ** src:[22:38.04627%,9:26.10848%,7:18.26895%,1:17.57573%,15:0.00019%,14:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1423 (0.27326%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.2070 - tp: 74438.0000 - fp: 5562.0000 - tn: 314438.0000 - fn: 5562.0000 - accuracy: 0.9722 - precision: 0.9305 - recall: 0.9305 - auc: 0.9926 - val_loss: 0.6672 - val_tp: 12816.0000 - val_fp: 7184.0000 - val_tn: 72816.0000 - val_fn: 7184.0000 - val_accuracy: 0.8563 - val_precision: 0.6408 - val_recall: 0.6408 - val_auc: 0.9677
[INFO] saving weights to checkpoints/lstm-epoch-10-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0734 - tp: 78661.0000 - fp: 1339.0000 - tn: 318661.0000 - fn: 1339.0000 - accuracy: 0.9933 - precision: 0.9833 - recall: 0.9833 - auc: 0.9993 - val_loss: 0.0078 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0125 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.2497e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0083 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2189e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0068 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.3762e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 15-15/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99616%,30:0.00307%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:89.39431%,Single Stage Multi Point:10.60493%,Single Stage Single Point:0.00077%]
[INFO] ** dst:[21:43.29746%,10:20.77395%,8:18.31407%,9:17.60914%,15:0.00307%,22:0.00154%,25:0.00019%,24:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99693%,0:0.00307%]
[INFO] ** i/f_name:[2:99.99693%,3:0.00307%]
[INFO] ** modbus_function_code:[0.02961:99.99616%,-33.760870000000004:0.00384%]
[INFO] ** modbus_function_description:[7:49.99904%,11:49.99712%,0:0.00384%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99712%,2:0.00288%]
[INFO] ** proto:[0:99.99654%,1:0.00307%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:38.00249%,20:26.0695%,13:18.31388%,6:17.60972%,17:0.00307%,16:0.00058%,7:0.00038%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.06873%,-0.32151:20.77376%,-1.27613:18.31369%,-0.23351:17.60895%,-0.33484:17.22873%,-71.33197:0.00307%,-1.02014:0.00058%,-0.24151:0.00058%,1.45709:0.00038%,-64.19493:0.00019%,-61.95768:0.00019%,-71.14798:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,10.192739999999999:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%]
[INFO] ** scada_tag:[3:26.06835%,1:20.77356%,5:18.31369%,4:17.60856%,2:17.22854%,0:0.0073%]
[INFO] ** service:[0.0048200000000000005:99.99635%,-211.73542999999998:0.00307%,-186.44547:0.00019%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.00249%,9:26.0695%,7:18.31388%,1:17.60972%,21:0.00326%,15:0.00058%,16:0.00019%,14:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1431 (0.27479%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0066 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.6390e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0056 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.4168e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0051 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6888e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0048 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1853e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.2798 - tp: 43880.0000 - fp: 36120.0000 - tn: 283880.0000 - fn: 36120.0000 - accuracy: 0.8194 - precision: 0.5485 - recall: 0.5485 - auc: 0.7151 - val_loss: 7.5570 - val_tp: 10623.0000 - val_fp: 9377.0000 - val_tn: 70623.0000 - val_fn: 9377.0000 - val_accuracy: 0.8125 - val_precision: 0.5311 - val_recall: 0.5311 - val_auc: 0.7070
[INFO] saving weights to checkpoints/lstm-epoch-10-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 16-16/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (460448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (460448, 17)

[INFO] analyzing data
[INFO] 460448 rows
[INFO] ** appi_name:[21:99.99848%,30:0.0013%,33:0.00022%]
[INFO] ** classification:[normal:83.00829%,Single Stage Multi Point:16.99171%]
[INFO] ** dst:[21:43.3569%,10:20.7967%,8:18.25266%,9:17.59091%,22:0.0013%,15:0.0013%,24:0.00022%]
[INFO] ** i/f_dir:[1:99.9987%,0:0.0013%]
[INFO] ** i/f_name:[2:99.9987%,3:0.0013%]
[INFO] ** modbus_function_code:[0.02961:99.99848%,-33.760870000000004:0.00152%]
[INFO] ** modbus_function_description:[7:50.00065%,11:49.99783%,0:0.00152%]
[INFO] ** modbus_transaction_id:65536 (14.23309%)
[INFO] ** orig:[0:99.9987%,2:0.0013%]
[INFO] ** proto:[0:99.9987%,1:0.0013%]
[INFO] ** proxy_src_ip:[18:38.04729%,20:26.10653%,13:18.25309%,6:17.59113%,17:0.0013%,16:0.00043%,21:0.00022%]
[INFO] ** s_port:[1.45442:26.10588%,-0.32151:20.79649%,-1.27613:18.25266%,-0.23351:17.59069%,-0.33484:17.25081%,-71.33197:0.0013%,1.45709:0.00043%,-0.24151:0.00043%,-1.02014:0.00043%,-1.27347:0.00022%,1.47576:0.00022%,-49.275529999999996:0.00022%,-1.2708:0.00022%]
[INFO] ** scada_tag:[3:26.10545%,1:20.79649%,5:18.25244%,4:17.59026%,2:17.25059%,0:0.00478%]
[INFO] ** service:[0.0048200000000000005:99.9987%,-211.73542999999998:0.0013%]
[INFO] ** src:[22:38.04729%,9:26.10653%,7:18.25309%,1:17.59113%,21:0.0013%,15:0.00043%,4:0.00022%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1259 (0.27343%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/460448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5585 - tp: 42496.0000 - fp: 37504.0000 - tn: 282496.0000 - fn: 37504.0000 - accuracy: 0.8125 - precision: 0.5312 - recall: 0.5312 - auc: 0.7043 - val_loss: 7.5554 - val_tp: 10625.0000 - val_fp: 9375.0000 - val_tn: 70625.0000 - val_fn: 9375.0000 - val_accuracy: 0.8125 - val_precision: 0.5312 - val_recall: 0.5312 - val_auc: 0.7070
[INFO] saving weights to checkpoints/lstm-epoch-10-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/460448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.3206 - tp: 48641.0000 - fp: 31359.0000 - tn: 288641.0000 - fn: 31359.0000 - accuracy: 0.8432 - precision: 0.6080 - recall: 0.6080 - auc: 0.7530 - val_loss: 4.4604e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/460448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0038 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4597e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/460448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0034 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3282e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/460448
[33m[INFO] loading file 17-17/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (560448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (560448, 17)

[INFO] analyzing data
[INFO] 560448 rows
[INFO] ** appi_name:[21:99.99715%,7:0.00054%,26:0.00036%,0:0.00036%,33:0.00018%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:94.49548%,Multi Stage Multi Point:5.50452%]
[INFO] ** dst:[21:43.34943%,10:20.84422%,8:18.20544%,9:17.59806%,22:0.00071%,6:0.00054%,25:0.00036%,16:0.00036%,2:0.00036%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99715%,-33.760870000000004:0.00268%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.9975%,0:0.00268%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.6935%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99875%,2:0.00125%]
[INFO] ** proxy_src_ip:[18:38.07811%,20:26.11607%,13:18.2049%,6:17.59789%,10:0.00107%,11:0.00089%,1:0.00036%,21:0.00018%,16:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.11518%,-0.32151:20.84404%,-1.27613:18.20454%,-0.23351:17.59771%,-0.33484:17.23407%,6.0369:0.00071%,1.47576:0.00036%,-71.14798:0.00036%,1.45709:0.00036%,-64.19493:0.00036%,1.46509:0.00018%,-68.79874000000001:0.00018%,-49.275529999999996:0.00018%,-1.27347:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,6.15557:0.00018%,6.06224:0.00018%,8.55414:0.00018%,-3.3787199999999995:0.00018%,-4.3880099999999995:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.115%,1:20.84386%,5:18.20437%,4:17.59717%,2:17.23407%,0:0.00553%]
[INFO] ** service:[0.0048200000000000005:99.99804%,-211.09762999999998:0.00054%,-211.08346:0.00036%,-186.44547:0.00036%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.07811%,9:26.11607%,7:18.2049%,1:17.59789%,11:0.00107%,10:0.00089%,3:0.00036%,21:0.00018%,15:0.00018%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1531 (0.27317%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0031 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7710e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0029 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1203e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0026 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0764e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.5346 - tp: 72394.0000 - fp: 7606.0000 - tn: 312394.0000 - fn: 7606.0000 - accuracy: 0.9620 - precision: 0.9049 - recall: 0.9049 - auc: 0.9403 - val_loss: 2.9335 - val_tp: 16360.0000 - val_fp: 3640.0000 - val_tn: 76360.0000 - val_fn: 3640.0000 - val_accuracy: 0.9272 - val_precision: 0.8180 - val_recall: 0.8180 - val_auc: 0.8863
[INFO] saving weights to checkpoints/lstm-epoch-10-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9230 - tp: 65501.0000 - fp: 14499.0000 - tn: 305501.0000 - fn: 14499.0000 - accuracy: 0.9275 - precision: 0.8188 - recall: 0.8188 - auc: 0.8861 - val_loss: 2.9166 - val_tp: 16381.0000 - val_fp: 3619.0000 - val_tn: 76381.0000 - val_fn: 3619.0000 - val_accuracy: 0.9276 - val_precision: 0.8191 - val_recall: 0.8191 - val_auc: 0.8869
[INFO] saving weights to checkpoints/lstm-epoch-10-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/560448
[33m[INFO] loading file 18-18/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (560448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (560448, 17)

[INFO] analyzing data
[INFO] 560448 rows
[INFO] ** appi_name:[21:99.99822%,30:0.00054%,7:0.00054%,31:0.00018%,27:0.00018%,22:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:82.42763%,Multi Stage Multi Point:17.57237%]
[INFO] ** dst:[21:43.34354%,10:20.83387%,8:18.25772%,9:17.56202%,22:0.00071%,15:0.00054%,24:0.00036%,16:0.00036%,2:0.00036%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99946%,0:0.00054%]
[INFO] ** i/f_name:[2:99.99946%,3:0.00054%]
[INFO] ** modbus_function_code:[0.02961:99.99822%,-33.760870000000004:0.00178%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99804%,0:0.00178%]
[INFO] ** modbus_transaction_id:65536 (11.6935%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99893%,2:0.00054%,1:0.00054%]
[INFO] ** proxy_src_ip:[18:38.07954%,20:26.09841%,13:18.25807%,6:17.5622%,17:0.00054%,11:0.00054%,1:0.00036%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.09769%,-0.32151:20.83387%,-1.27613:18.25754%,-0.23351:17.56184%,-0.33484:17.24567%,-71.33197:0.00054%,-1.27347:0.00036%,1.45709:0.00036%,-0.24151:0.00036%,1.47576:0.00018%,1.46509:0.00018%,3.6236699999999997:0.00018%,-1.2708:0.00018%,-2.48275:0.00018%,6.06224:0.00018%,-3.3787199999999995:0.00018%,8.10082:0.00018%,6.45955:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.09734%,1:20.83369%,5:18.25736%,4:17.56166%,2:17.24549%,0:0.00446%]
[INFO] ** service:[0.0048200000000000005:99.99822%,-211.09762999999998:0.00054%,-211.73542999999998:0.00054%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.07954%,9:26.09841%,7:18.25807%,1:17.5622%,14:0.00054%,10:0.00054%,3:0.00036%,21:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1532 (0.27335%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.3014 - tp: 78514.0000 - fp: 1486.0000 - tn: 318514.0000 - fn: 1486.0000 - accuracy: 0.9926 - precision: 0.9814 - recall: 0.9814 - auc: 0.9883 - val_loss: 6.1088 - val_tp: 12420.0000 - val_fp: 7580.0000 - val_tn: 72420.0000 - val_fn: 7580.0000 - val_accuracy: 0.8484 - val_precision: 0.6210 - val_recall: 0.6210 - val_auc: 0.7631
[INFO] saving weights to checkpoints/lstm-epoch-10-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1250 - tp: 49605.0000 - fp: 30395.0000 - tn: 289605.0000 - fn: 30395.0000 - accuracy: 0.8480 - precision: 0.6201 - recall: 0.6201 - auc: 0.7610 - val_loss: 6.0781 - val_tp: 12458.0000 - val_fp: 7542.0000 - val_tn: 72458.0000 - val_fn: 7542.0000 - val_accuracy: 0.8492 - val_precision: 0.6229 - val_recall: 0.6229 - val_auc: 0.7643
[INFO] saving weights to checkpoints/lstm-epoch-10-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1455 - tp: 49503.0000 - fp: 30497.0000 - tn: 289503.0000 - fn: 30497.0000 - accuracy: 0.8475 - precision: 0.6188 - recall: 0.6188 - auc: 0.7602 - val_loss: 6.1281 - val_tp: 12396.0000 - val_fp: 7604.0000 - val_tn: 72396.0000 - val_fn: 7604.0000 - val_accuracy: 0.8479 - val_precision: 0.6198 - val_recall: 0.6198 - val_auc: 0.7624
[INFO] saving weights to checkpoints/lstm-epoch-10-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.6971 - tp: 66620.0000 - fp: 13380.0000 - tn: 306620.0000 - fn: 13380.0000 - accuracy: 0.9331 - precision: 0.8328 - recall: 0.8328 - auc: 0.8948 - val_loss: 3.5868e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0014 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1372e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/560448
[33m[INFO] loading file 19-19/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (560448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (560448, 17)

[INFO] analyzing data
[INFO] 560448 rows
[INFO] ** appi_name:[21:99.99804%,26:0.00036%,0:0.00036%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:87.23164%,Single Stage Multi Point:12.76836%]
[INFO] ** dst:[21:43.38815%,10:20.82566%,8:18.20883%,9:17.57469%,22:0.00125%,6:0.00054%,25:0.00036%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99804%,-33.760870000000004:0.00178%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99804%,0:0.00178%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.6935%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99875%,2:0.00125%]
[INFO] ** proxy_src_ip:[18:38.11415%,20:26.09983%,13:18.20883%,6:17.57469%,10:0.00107%,11:0.00089%,16:0.00054%]
[INFO] ** s_port:[1.45442:26.09876%,-0.32151:20.82566%,-1.27613:18.20847%,-0.23351:17.57451%,-0.33484:17.28849%,-5.20264:0.00071%,1.45709:0.00054%,-1.02014:0.00054%,-64.19493:0.00036%,-71.14798:0.00036%,1.46509:0.00036%,-1.27347:0.00018%,-0.24151:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-71.14931:0.00018%,-68.79874000000001:0.00018%,0.75578:0.00018%]
[INFO] ** scada_tag:[3:26.09841%,1:20.82548%,5:18.20829%,4:17.57433%,2:17.28831%,0:0.00517%]
[INFO] ** service:[0.0048200000000000005:99.99875%,-211.08346:0.00036%,-186.44547:0.00036%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.11415%,9:26.09983%,7:18.20883%,1:17.57469%,11:0.00107%,10:0.00089%,15:0.00054%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1533 (0.27353%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0013 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5953e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0011 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1742e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.6750e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0443e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.8041e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.2404 - val_tp: 9775.0000 - val_fp: 10225.0000 - val_tn: 69775.0000 - val_fn: 10225.0000 - val_accuracy: 0.7955 - val_precision: 0.4888 - val_recall: 0.4888 - val_auc: 0.6805
[INFO] saving weights to checkpoints/lstm-epoch-10-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 9.8271 - tp: 31226.0000 - fp: 48774.0000 - tn: 271226.0000 - fn: 48774.0000 - accuracy: 0.7561 - precision: 0.3903 - recall: 0.3903 - auc: 0.6166 - val_loss: 9.8385 - val_tp: 7792.0000 - val_fp: 12208.0000 - val_tn: 67792.0000 - val_fn: 12208.0000 - val_accuracy: 0.7558 - val_precision: 0.3896 - val_recall: 0.3896 - val_auc: 0.6185
[INFO] saving weights to checkpoints/lstm-epoch-10-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/560448
[33m[INFO] loading file 20-20/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (560448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (560448, 17)

[INFO] analyzing data
[INFO] 560448 rows
[INFO] ** appi_name:[21:99.99661%,30:0.00285%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:92.62519%,Single Stage Multi Point:7.37481%]
[INFO] ** dst:[21:43.42544%,10:20.83762%,8:18.15797%,9:17.57415%,15:0.00285%,22:0.00107%,24:0.00036%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.9975%,0:0.0025%]
[INFO] ** i/f_name:[2:99.99715%,3:0.00285%]
[INFO] ** modbus_function_code:[0.02961:99.99661%,-33.760870000000004:0.00339%]
[INFO] ** modbus_function_description:[7:49.99946%,11:49.99715%,0:0.00339%]
[INFO] ** modbus_transaction_id:65536 (11.6935%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99661%,1:0.00285%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.11594%,20:26.14765%,13:18.15815%,6:17.57469%,17:0.00285%,14:0.00054%,16:0.00018%]
[INFO] ** s_port:[1.45442:26.14694%,-0.32151:20.83762%,-1.27613:18.15762%,-0.23351:17.57398%,-0.33484:17.27832%,-71.33197:0.00285%,-0.24151:0.00054%,1.45709:0.00036%,-1.27347:0.00036%,13.431270000000001:0.00018%,-1.2708:0.00018%,-1.02014:0.00018%,-71.14798:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:26.1464%,1:20.83744%,5:18.15762%,4:17.57362%,2:17.27814%,0:0.00678%]
[INFO] ** service:[0.0048200000000000005:99.99661%,-211.73542999999998:0.00285%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.11594%,9:26.14765%,7:18.15815%,1:17.57469%,14:0.00285%,2:0.00054%,15:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1532 (0.27335%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0719 - tp: 79647.0000 - fp: 353.0000 - tn: 319647.0000 - fn: 353.0000 - accuracy: 0.9982 - precision: 0.9956 - recall: 0.9956 - auc: 0.9972 - val_loss: 1.5774e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.2754 - tp: 68709.0000 - fp: 11291.0000 - tn: 308709.0000 - fn: 11291.0000 - accuracy: 0.9435 - precision: 0.8589 - recall: 0.8589 - auc: 0.9112 - val_loss: 2.9407 - val_tp: 16351.0000 - val_fp: 3649.0000 - val_tn: 76351.0000 - val_fn: 3649.0000 - val_accuracy: 0.9270 - val_precision: 0.8176 - val_recall: 0.8176 - val_auc: 0.8860
[INFO] saving weights to checkpoints/lstm-epoch-10-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.9495 - tp: 65363.0000 - fp: 14637.0000 - tn: 305363.0000 - fn: 14637.0000 - accuracy: 0.9268 - precision: 0.8170 - recall: 0.8170 - auc: 0.8850 - val_loss: 2.9480 - val_tp: 16342.0000 - val_fp: 3658.0000 - val_tn: 76342.0000 - val_fn: 3658.0000 - val_accuracy: 0.9268 - val_precision: 0.8171 - val_recall: 0.8171 - val_auc: 0.8857
[INFO] saving weights to checkpoints/lstm-epoch-10-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.5607 - tp: 72256.0000 - fp: 7744.0000 - tn: 312256.0000 - fn: 7744.0000 - accuracy: 0.9613 - precision: 0.9032 - recall: 0.9032 - auc: 0.9391 - val_loss: 1.4179e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.7027e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3828e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/560448
[33m[INFO] loading file 21-21/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (560446, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (560446, 17)

[INFO] analyzing data
[INFO] 560446 rows
[INFO] ** appi_name:[21:99.99607%,30:0.00107%,7:0.00054%,26:0.00036%,22:0.00036%,0:0.00036%,31:0.00018%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:98.91105%,Multi Stage Single Point:1.08895%]
[INFO] ** dst:[21:43.31283%,10:20.98293%,8:18.16535%,9:17.53407%,15:0.00107%,22:0.00089%,24:0.00071%,6:0.00071%,25:0.00036%,16:0.00036%,2:0.00036%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99893%,0:0.00107%]
[INFO] ** i/f_name:[2:99.99893%,3:0.00107%]
[INFO] ** modbus_function_code:[0.02961:99.99607%,-33.760870000000004:0.00375%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99893%,11:49.99715%,0:0.00375%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.69354%)
[INFO] ** orig:[0:99.99929%,2:0.00071%]
[INFO] ** proto:[0:99.9975%,2:0.00143%,1:0.00107%]
[INFO] ** proxy_src_ip:[18:38.30985%,20:25.98555%,13:18.16607%,6:17.53407%,17:0.00107%,10:0.00107%,11:0.00089%,16:0.00054%,1:0.00036%,21:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.98502%,-0.32151:20.98222%,-1.27613:18.16518%,-0.23351:17.53389%,-0.33484:17.32763%,-71.33197:0.00107%,-1.27347:0.00071%,-6.64392:0.00071%,-1.02014:0.00054%,-64.19493:0.00036%,-71.14931:0.00036%,-71.14798:0.00036%,1.47576:0.00018%,1.46509:0.00018%,-1.2708:0.00018%,6.62488:0.00018%,10.15141:0.00018%,-68.79874000000001:0.00018%,7.060860000000001:0.00018%,-3.3787199999999995:0.00018%,-2.2440900000000004:0.00018%,1.45709:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.98448%,1:20.98204%,5:18.165%,4:17.53354%,2:17.32763%,0:0.00732%]
[INFO] ** service:[0.0048200000000000005:99.99679%,-211.73542999999998:0.00107%,-211.09762999999998:0.00054%,-211.08346:0.00036%,-186.44547:0.00036%,-211.08818:0.00036%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.30985%,9:25.98555%,7:18.16607%,1:17.53407%,11:0.00107%,21:0.00089%,10:0.00089%,15:0.00054%,14:0.00036%,3:0.00036%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1527 (0.27246%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/560446
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.1347e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3238e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/560446
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.7187e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3211e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/560446
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.1381e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2633e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/560446
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.8559e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2451e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/560446
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.4129e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2373e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/560446
[33m[INFO] loading file 22-22/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (329487, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (329487, 17)

[INFO] analyzing data
[INFO] 329487 rows
[INFO] ** appi_name:[21:99.99241%,30:0.00668%,23:0.0003%,22:0.0003%,18:0.0003%]
[INFO] ** classification:[normal:59.77019%,Multi Stage Single Point:40.22981%]
[INFO] ** dst:[21:43.3137%,10:21.00356%,8:18.09965%,9:17.57429%,15:0.00668%,22:0.00121%,19:0.00061%,26:0.0003%]
[INFO] ** i/f_dir:[1:99.99363%,0:0.00637%]
[INFO] ** i/f_name:[2:99.99332%,3:0.00637%,0:0.0003%]
[INFO] ** modbus_function_code:[0.02961:99.99241%,-33.760870000000004:0.00759%]
[INFO] ** modbus_function_description:[7:49.99712%,11:49.9953%,0:0.00759%]
[INFO] ** modbus_transaction_id:65534 (19.88971%)
[INFO] ** orig:[0:99.99484%,2:0.00455%,1:0.00061%]
[INFO] ** proto:[0:99.99302%,1:0.00668%,2:0.0003%]
[INFO] ** proxy_src_ip:[18:38.32959%,20:25.98858%,13:18.09904%,6:17.5752%,17:0.00668%,14:0.00061%,10:0.0003%]
[INFO] ** s_port:[1.45442:25.98767%,-0.32151:21.00356%,-1.27613:18.09904%,-0.23351:17.57429%,-0.33484:17.32603%,-71.33197:0.00668%,1.45709:0.00061%,-0.24151:0.00061%,7.228860000000001:0.00061%,-0.24950999999999998:0.0003%,1.46509:0.0003%,-71.14931:0.0003%]
[INFO] ** scada_tag:[3:25.98737%,1:21.00356%,5:18.09904%,4:17.57399%,2:17.32603%,0:0.01002%]
[INFO] ** service:[0.0048200000000000005:99.99241%,-211.73542999999998:0.00668%,-211.07873999999998:0.00061%,-211.08818:0.0003%]
[INFO] ** src:[22:38.32959%,9:25.98858%,7:18.09904%,1:17.5752%,21:0.00455%,14:0.00212%,2:0.00061%,11:0.0003%]
[INFO] ** type:[0:99.99818%,1:0.00182%]
[INFO] ** unixtime:910 (0.27619%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/329487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 3.0761 - tp: 64733.0000 - fp: 15267.0000 - tn: 304733.0000 - fn: 15267.0000 - accuracy: 0.9237 - precision: 0.8092 - recall: 0.8092 - auc: 0.8800 - val_loss: 7.5546 - val_tp: 10626.0000 - val_fp: 9374.0000 - val_tn: 70626.0000 - val_fn: 9374.0000 - val_accuracy: 0.8125 - val_precision: 0.5313 - val_recall: 0.5313 - val_auc: 0.7071
[INFO] saving weights to checkpoints/lstm-epoch-10-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/329487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5716 - tp: 42420.0000 - fp: 37580.0000 - tn: 282420.0000 - fn: 37580.0000 - accuracy: 0.8121 - precision: 0.5303 - recall: 0.5303 - auc: 0.7046 - val_loss: 7.5779 - val_tp: 10597.0000 - val_fp: 9403.0000 - val_tn: 70597.0000 - val_fn: 9403.0000 - val_accuracy: 0.8119 - val_precision: 0.5299 - val_recall: 0.5299 - val_auc: 0.7062
[INFO] saving weights to checkpoints/lstm-epoch-10-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/329487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 7.5943 - tp: 42307.0000 - fp: 37693.0000 - tn: 282307.0000 - fn: 37693.0000 - accuracy: 0.8115 - precision: 0.5288 - recall: 0.5288 - auc: 0.7037 - val_loss: 7.5836 - val_tp: 10590.0000 - val_fp: 9410.0000 - val_tn: 70590.0000 - val_fn: 9410.0000 - val_accuracy: 0.8118 - val_precision: 0.5295 - val_recall: 0.5295 - val_auc: 0.7059
[INFO] saving weights to checkpoints/lstm-epoch-10-files-21-22-batch-200000-300000
[INFO] processing batch 300000-400000/329487
[33m[INFO] loading file 23-23/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529487, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529487, 17)

[INFO] analyzing data
[INFO] 529487 rows
[INFO] ** appi_name:[21:99.99887%,31:0.00038%,30:0.00038%,33:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:95.68261%,Multi Stage Single Point:4.31739%]
[INFO] ** dst:[21:43.3293%,10:21.00373%,8:18.1385%,9:17.52621%,22:0.00094%,24:0.00038%,18:0.00038%,15:0.00038%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99887%,-33.760870000000004:0.00113%]
[INFO] ** modbus_function_description:[7:50.00047%,11:49.99839%,0:0.00113%]
[INFO] ** modbus_transaction_id:65536 (12.37726%)
[INFO] ** orig:[0:99.99981%,2:0.00019%]
[INFO] ** proto:[0:99.99906%,2:0.00057%,1:0.00038%]
[INFO] ** proxy_src_ip:[18:38.35127%,20:25.98194%,13:18.13869%,6:17.5264%,16:0.00057%,17:0.00038%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.98137%,-0.32151:21.00354%,-1.27613:18.13812%,-0.23351:17.52602%,-0.33484:17.34773%,-1.02014:0.00057%,-1.27347:0.00038%,-0.08551:0.00038%,-71.33197:0.00038%,1.45709:0.00019%,-0.24151:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,1.46509:0.00019%,-64.19493:0.00019%,-0.24950999999999998:0.00019%,-49.275529999999996:0.00019%]
[INFO] ** scada_tag:[3:25.981%,1:21.00354%,5:18.13793%,4:17.52583%,2:17.34755%,0:0.00415%]
[INFO] ** service:[0.0048200000000000005:99.99906%,-211.73542999999998:0.00038%,-186.43601999999998:0.00038%,-186.44547:0.00019%]
[INFO] ** src:[22:38.35127%,9:25.98194%,7:18.13869%,1:17.5264%,15:0.00057%,21:0.00019%,17:0.00019%,14:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1440 (0.27196%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 4.6059 - tp: 57140.0000 - fp: 22860.0000 - tn: 297140.0000 - fn: 22860.0000 - accuracy: 0.8857 - precision: 0.7143 - recall: 0.7143 - auc: 0.8202 - val_loss: 1.2013e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.4959e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1979e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.2922e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1982e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.1267e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1952e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.0291e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1941e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/529487
[33m[INFO] loading file 24-24/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529487, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529487, 17)

[INFO] analyzing data
[INFO] 529487 rows
[INFO] ** appi_name:[21:99.99301%,30:0.0034%,26:0.00057%,31:0.00038%,27:0.00038%,22:0.00038%,0:0.00038%,24:0.00019%,23:0.00019%,19:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,11:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:95.18779%,Multi Stage Single Point:4.81221%]
[INFO] ** dst:[21:43.3597%,10:21.02393%,8:18.09959%,9:17.5094%,15:0.0034%,22:0.00113%,6:0.00076%,25:0.00038%,24:0.00038%,19:0.00038%,18:0.00038%,7:0.00038%,26:0.00019%]
[INFO] ** i/f_dir:[1:99.99679%,0:0.00321%]
[INFO] ** i/f_name:[2:99.9966%,3:0.0034%]
[INFO] ** modbus_function_code:[0.02961:99.99301%,-33.760870000000004:0.00642%,-0.415:0.00019%,0.9188299999999999:0.00019%,0.47422:0.00019%]
[INFO] ** modbus_function_description:[7:49.99745%,11:49.99556%,0:0.00642%,15:0.00019%,10:0.00019%,2:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.37726%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99452%,1:0.0034%,2:0.00208%]
[INFO] ** proxy_src_ip:[18:38.40283%,20:25.98156%,13:18.09959%,6:17.50865%,17:0.0034%,10:0.00132%,14:0.00094%,11:0.00094%,21:0.00038%,16:0.00038%]
[INFO] ** s_port:[1.45442:25.98081%,-0.32151:21.02393%,-1.27613:18.09922%,-0.23351:17.50808%,-0.33484:17.3789%,-71.33197:0.0034%,-9.58113:0.00076%,-71.14798:0.00057%,-1.27347:0.00038%,1.45709:0.00038%,-0.24151:0.00038%,-1.02014:0.00038%,-31.55091:0.00038%,7.6315100000000005:0.00038%,-71.14931:0.00038%,-64.19493:0.00038%,-68.79874000000001:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,7.4901800000000005:0.00019%,13.431270000000001:0.00019%,11.862:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:25.98062%,1:21.02393%,5:18.09903%,4:17.5077%,2:17.37871%,0:0.01001%]
[INFO] ** service:[0.0048200000000000005:99.99415%,-211.73542999999998:0.0034%,-211.08346:0.00057%,-211.07873999999998:0.00038%,-202.75898:0.00038%,-186.44547:0.00038%,-186.43601999999998:0.00038%,-211.08818:0.00038%]
[INFO] ** src:[22:38.40283%,9:25.98156%,7:18.09959%,1:17.50865%,14:0.0034%,11:0.00132%,10:0.00094%,2:0.00094%,15:0.00038%,4:0.00038%]
[INFO] ** type:[0:99.99868%,1:0.00094%,2:0.00038%]
[INFO] ** unixtime:1438 (0.27158%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.9200e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1943e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 8.1273e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1929e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.8603e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.0475e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1923e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.5931 - tp: 72093.0000 - fp: 7907.0000 - tn: 312093.0000 - fn: 7907.0000 - accuracy: 0.9605 - precision: 0.9012 - recall: 0.9012 - auc: 0.9382 - val_loss: 5.7171 - val_tp: 12906.0000 - val_fp: 7094.0000 - val_tn: 72906.0000 - val_fn: 7094.0000 - val_accuracy: 0.8581 - val_precision: 0.6453 - val_recall: 0.6453 - val_auc: 0.7783
[INFO] saving weights to checkpoints/lstm-epoch-10-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/529487
[33m[INFO] loading file 25-25/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529487, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529487, 17)

[INFO] analyzing data
[INFO] 529487 rows
[INFO] ** appi_name:[21:99.99622%,30:0.00113%,17:0.00076%,22:0.00057%,31:0.00038%,28:0.00019%,26:0.00019%,12:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** classification:[normal:64.34133%,Multi Stage Single Point:35.65867%]
[INFO] ** dst:[21:43.31627%,10:21.02053%,8:18.14775%,9:17.51091%,15:0.00113%,22:0.00094%,16:0.00076%,6:0.00076%,18:0.00038%,17:0.00038%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99887%,0:0.00113%]
[INFO] ** i/f_name:[2:99.99887%,3:0.00113%]
[INFO] ** modbus_function_code:[0.02961:99.99622%,-33.760870000000004:0.00378%]
[INFO] ** modbus_function_description:[7:49.99896%,11:49.99726%,0:0.00378%]
[INFO] ** modbus_transaction_id:65536 (12.37726%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99773%,2:0.00113%,1:0.00113%]
[INFO] ** proxy_src_ip:[18:38.38111%,20:25.9555%,13:18.14775%,6:17.51148%,17:0.00113%,1:0.00094%,21:0.00076%,16:0.00038%,14:0.00038%,7:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95512%,-0.32151:21.02016%,-1.27613:18.14738%,-0.23351:17.51091%,-0.33484:17.36096%,-71.33197:0.00113%,-71.14931:0.00057%,-0.24151:0.00038%,-1.02014:0.00038%,-49.275529999999996:0.00038%,1.46509:0.00019%,-5.1466400000000005:0.00019%,-1.27347:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,-0.24950999999999998:0.00019%,2.52505:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,6.1115699999999995:0.00019%,-5.08665:0.00019%,1.45709:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:25.95474%,1:21.01997%,5:18.14719%,4:17.51072%,2:17.36077%,0:0.00661%]
[INFO] ** service:[0.0048200000000000005:99.9966%,-211.73542999999998:0.00113%,-205.44247:0.00076%,-211.08818:0.00057%,-186.43601999999998:0.00038%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.38111%,9:25.9555%,7:18.14775%,1:17.51148%,14:0.00113%,3:0.00094%,4:0.00076%,21:0.00038%,15:0.00038%,2:0.00038%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1439 (0.27177%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7479 - tp: 51471.0000 - fp: 28529.0000 - tn: 291471.0000 - fn: 28529.0000 - accuracy: 0.8574 - precision: 0.6434 - recall: 0.6434 - auc: 0.7771 - val_loss: 5.7646 - val_tp: 12847.0000 - val_fp: 7153.0000 - val_tn: 72847.0000 - val_fn: 7153.0000 - val_accuracy: 0.8569 - val_precision: 0.6424 - val_recall: 0.6424 - val_auc: 0.7765
[INFO] saving weights to checkpoints/lstm-epoch-10-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7455 - tp: 51483.0000 - fp: 28517.0000 - tn: 291483.0000 - fn: 28517.0000 - accuracy: 0.8574 - precision: 0.6435 - recall: 0.6435 - auc: 0.7772 - val_loss: 5.7308 - val_tp: 12889.0000 - val_fp: 7111.0000 - val_tn: 72889.0000 - val_fn: 7111.0000 - val_accuracy: 0.8578 - val_precision: 0.6445 - val_recall: 0.6445 - val_auc: 0.7778
[INFO] saving weights to checkpoints/lstm-epoch-10-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7516 - tp: 51453.0000 - fp: 28547.0000 - tn: 291453.0000 - fn: 28547.0000 - accuracy: 0.8573 - precision: 0.6432 - recall: 0.6432 - auc: 0.7770 - val_loss: 5.7550 - val_tp: 12859.0000 - val_fp: 7141.0000 - val_tn: 72859.0000 - val_fn: 7141.0000 - val_accuracy: 0.8572 - val_precision: 0.6429 - val_recall: 0.6429 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-10-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7389 - tp: 51516.0000 - fp: 28484.0000 - tn: 291516.0000 - fn: 28484.0000 - accuracy: 0.8576 - precision: 0.6439 - recall: 0.6439 - auc: 0.7775 - val_loss: 5.7872 - val_tp: 12819.0000 - val_fp: 7181.0000 - val_tn: 72819.0000 - val_fn: 7181.0000 - val_accuracy: 0.8564 - val_precision: 0.6410 - val_recall: 0.6410 - val_auc: 0.7756
[INFO] saving weights to checkpoints/lstm-epoch-10-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7411 - tp: 51505.0000 - fp: 28495.0000 - tn: 291505.0000 - fn: 28495.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.7774 - val_loss: 5.7501 - val_tp: 12865.0000 - val_fp: 7135.0000 - val_tn: 72865.0000 - val_fn: 7135.0000 - val_accuracy: 0.8573 - val_precision: 0.6432 - val_recall: 0.6432 - val_auc: 0.7770
[INFO] saving weights to checkpoints/lstm-epoch-10-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/529487
[33m[INFO] loading file 26-26/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529487, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529487, 17)

[INFO] analyzing data
[INFO] 529487 rows
[INFO] ** appi_name:[21:99.99849%,7:0.00057%,31:0.00019%,30:0.00019%,22:0.00019%,12:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:64.39837%,Single Stage Single Point:30.16354%,Multi Stage Single Point:5.43809%]
[INFO] ** dst:[21:43.31079%,10:21.0855%,8:18.11867%,9:17.48258%,22:0.00076%,24:0.00038%,16:0.00038%,2:0.00038%,18:0.00019%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99849%,-33.760870000000004:0.00151%]
[INFO] ** modbus_function_description:[7:49.99972%,11:49.99877%,0:0.00151%]
[INFO] ** modbus_transaction_id:65536 (12.37726%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99943%,2:0.00038%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.4678%,20:25.92868%,13:18.11905%,6:17.48258%,1:0.00057%,21:0.00038%,16:0.00038%,17:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.92812%,-0.32151:21.08531%,-1.27613:18.11848%,-0.23351:17.48239%,-0.33484:17.38249%,-1.27347:0.00038%,-1.02014:0.00038%,7.66617:0.00019%,-71.14931:0.00019%,11.57001:0.00019%,-3.3787199999999995:0.00019%,2.52505:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%,1.45709:0.00019%,-49.275529999999996:0.00019%,1.47576:0.00019%,1.46509:0.00019%,14.191239999999999:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.92774%,1:21.08531%,5:18.11848%,4:17.4822%,2:17.38249%,0:0.00378%]
[INFO] ** service:[0.0048200000000000005:99.99868%,-211.09762999999998:0.00057%,-211.35747999999998:0.00019%,-211.73542999999998:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.4678%,9:25.92868%,7:18.11905%,1:17.48258%,3:0.00057%,15:0.00038%,4:0.00038%,21:0.00019%,14:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1437 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 5.7397 - tp: 51512.0000 - fp: 28488.0000 - tn: 291512.0000 - fn: 28488.0000 - accuracy: 0.8576 - precision: 0.6439 - recall: 0.6439 - auc: 0.7774 - val_loss: 5.7308 - val_tp: 12889.0000 - val_fp: 7111.0000 - val_tn: 72889.0000 - val_fn: 7111.0000 - val_accuracy: 0.8578 - val_precision: 0.6445 - val_recall: 0.6445 - val_auc: 0.7778
[INFO] saving weights to checkpoints/lstm-epoch-10-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.6446 - tp: 74010.0000 - fp: 5990.0000 - tn: 314010.0000 - fn: 5990.0000 - accuracy: 0.9701 - precision: 0.9251 - recall: 0.9251 - auc: 0.9613 - val_loss: 0.0017 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0689 - tp: 79124.0000 - fp: 876.0000 - tn: 319124.0000 - fn: 876.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9931 - val_loss: 6.9207e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0638 - tp: 79171.0000 - fp: 829.0000 - tn: 319171.0000 - fn: 829.0000 - accuracy: 0.9959 - precision: 0.9896 - recall: 0.9896 - auc: 0.9935 - val_loss: 6.2657e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0650 - tp: 79134.0000 - fp: 866.0000 - tn: 319134.0000 - fn: 866.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9932 - val_loss: 6.4534e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/529487
[33m[INFO] loading file 27-27/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (469617, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (469617, 17)

[INFO] analyzing data
[INFO] 469617 rows
[INFO] ** appi_name:[21:99.99936%,30:0.00064%]
[INFO] ** classification:[normal:64.33796%,Single Stage Single Point:35.66204%]
[INFO] ** dst:[21:43.27314%,10:21.06291%,8:18.1878%,9:17.47445%,22:0.00085%,15:0.00064%,24:0.00021%]
[INFO] ** i/f_dir:[1:99.99979%,0:0.00021%]
[INFO] ** i/f_name:[2:99.99936%,3:0.00064%]
[INFO] ** modbus_function_code:[0.02961:99.99936%,-33.760870000000004:0.00064%]
[INFO] ** modbus_function_description:[7:50.00032%,11:49.99904%,0:0.00064%]
[INFO] ** modbus_transaction_id:65536 (13.9552%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99936%,1:0.00064%]
[INFO] ** proxy_src_ip:[18:38.40257%,20:25.93411%,13:18.18759%,6:17.47467%,17:0.00064%,16:0.00043%]
[INFO] ** s_port:[1.45442:25.93347%,-0.32151:21.06291%,-1.27613:18.18737%,-0.23351:17.47424%,-0.33484:17.33966%,-71.33197:0.00064%,-1.02014:0.00043%,-1.27347:0.00021%,1.45709:0.00021%,-0.24950999999999998:0.00021%,1.46509:0.00021%,1.47576:0.00021%,-0.24151:0.00021%]
[INFO] ** scada_tag:[3:25.93305%,1:21.0627%,5:18.18716%,4:17.47403%,2:17.33945%,0:0.00362%]
[INFO] ** service:[0.0048200000000000005:99.99936%,-211.73542999999998:0.00064%]
[INFO] ** src:[22:38.40257%,9:25.93411%,7:18.18759%,1:17.47467%,14:0.00064%,15:0.00043%]
[INFO] ** type:[0:99.99957%,1:0.00043%]
[INFO] ** unixtime:1276 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/469617
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0790 - tp: 78896.0000 - fp: 1104.0000 - tn: 318896.0000 - fn: 1104.0000 - accuracy: 0.9945 - precision: 0.9862 - recall: 0.9862 - auc: 0.9919 - val_loss: 0.0016 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/469617
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0656 - tp: 79079.0000 - fp: 921.0000 - tn: 319079.0000 - fn: 921.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9928 - val_loss: 7.5793e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/469617
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0614 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9930 - val_loss: 7.0955e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/469617
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0587 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9990 - val_loss: 6.5775e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/469617
[33m[INFO] loading file 28-28/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (403533, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (403533, 17)

[INFO] analyzing data
[INFO] 403533 rows
[INFO] ** appi_name:[21:99.99257%,30:0.00173%,17:0.00124%,22:0.00099%,7:0.00099%,31:0.00074%,26:0.00074%,28:0.00025%,27:0.00025%,8:0.00025%,0:0.00025%]
[INFO] ** classification:[normal:64.31172%,Single Stage Single Point:35.68828%]
[INFO] ** dst:[21:43.28345%,10:21.02059%,8:18.20495%,9:17.48308%,6:0.00198%,16:0.00173%,18:0.00124%,15:0.00074%,22:0.0005%,17:0.0005%,2:0.0005%,25:0.00025%,7:0.00025%,0:0.00025%]
[INFO] ** i/f_dir:[1:99.99926%,0:0.00074%]
[INFO] ** i/f_name:[2:99.99926%,3:0.00074%]
[INFO] ** modbus_function_code:[0.02961:99.99257%,-33.760870000000004:0.00743%]
[INFO] ** modbus_function_description:[11:49.99641%,7:49.99616%,0:0.00743%]
[INFO] ** modbus_transaction_id:65536 (16.24056%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99554%,2:0.00372%,1:0.00074%]
[INFO] ** proxy_src_ip:[18:38.34259%,20:25.96145%,13:18.2052%,6:17.48333%,1:0.00198%,17:0.00173%,14:0.00149%,7:0.00124%,21:0.00074%,0:0.00025%]
[INFO] ** s_port:[1.45442:25.9612%,-0.32151:21.02059%,-1.27613:18.20495%,-0.23351:17.48283%,-0.33484:17.322%,-71.14798:0.00099%,-71.14931:0.00099%,-71.33197:0.00074%,-0.08551:0.0005%,-0.24151:0.0005%,7.66617:0.00025%,-58.035180000000004:0.00025%,-1.2708:0.00025%,-64.19493:0.00025%,-5.1466400000000005:0.00025%,13.431270000000001:0.00025%,11.57001:0.00025%,14.4699:0.00025%,1.47576:0.00025%,14.191239999999999:0.00025%,-5.08665:0.00025%,10.192739999999999:0.00025%,-3.3787199999999995:0.00025%,6.1115699999999995:0.00025%,2.05573:0.00025%,-43.76509:0.00025%,2.52505:0.00025%,11.862:0.00025%,-58.032509999999995:0.00025%]
[INFO] ** scada_tag:[3:25.96095%,1:21.02059%,5:18.20495%,4:17.48259%,2:17.322%,0:0.00892%]
[INFO] ** service:[0.0048200000000000005:99.99257%,-205.44247:0.00124%,-186.43601999999998:0.00124%,-211.09762999999998:0.00099%,-211.08346:0.00099%,-211.08818:0.00099%,-211.73542999999998:0.00074%,-186.44547:0.00025%,-183.8612:0.00025%,-185.9872:0.00025%,-211.35747999999998:0.00025%,-202.75898:0.00025%]
[INFO] ** src:[22:38.34259%,9:25.96145%,7:18.2052%,1:17.48333%,3:0.00223%,2:0.00149%,21:0.00124%,4:0.00099%,14:0.00074%,8:0.0005%,17:0.00025%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1097 (0.27185%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/403533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0586 - tp: 79083.0000 - fp: 917.0000 - tn: 319083.0000 - fn: 917.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 0.0023 - val_tp: 19997.0000 - val_fp: 3.0000 - val_tn: 79997.0000 - val_fn: 3.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-10-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/403533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0515 - tp: 79161.0000 - fp: 839.0000 - tn: 319161.0000 - fn: 839.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9998 - val_loss: 5.7330e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/403533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0535 - tp: 79089.0000 - fp: 911.0000 - tn: 319089.0000 - fn: 911.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9998 - val_loss: 4.4260e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/403533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 3s - loss: 0.0512 - tp: 79060.0000 - fp: 940.0000 - tn: 319060.0000 - fn: 940.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 3.0935e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-27-28-batch-300000-400000
[INFO] processing batch 400000-500000/403533
[33m[INFO] loading file 29-29/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (503533, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (503533, 17)

[INFO] analyzing data
[INFO] 503533 rows
[INFO] ** appi_name:[21:99.99881%,30:0.0006%,26:0.0002%,9:0.0002%,3:0.0002%]
[INFO] ** classification:[normal:64.38863%,Single Stage Single Point:35.61137%]
[INFO] ** dst:[21:43.32626%,10:21.06098%,8:18.14538%,9:17.46559%,22:0.0006%,15:0.0006%,24:0.0002%,6:0.0002%,0:0.0002%]
[INFO] ** i/f_dir:[1:99.9996%,0:0.0004%]
[INFO] ** i/f_name:[2:99.9994%,3:0.0006%]
[INFO] ** modbus_function_code:[0.02961:99.99881%,-33.760870000000004:0.00119%]
[INFO] ** modbus_function_description:[7:49.9997%,11:49.99911%,0:0.00119%]
[INFO] ** modbus_transaction_id:65536 (13.01523%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99921%,1:0.0006%,2:0.0002%]
[INFO] ** proxy_src_ip:[18:38.44237%,20:25.94507%,13:18.14578%,6:17.46539%,17:0.0006%,21:0.0002%,16:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.94448%,-0.32151:21.06078%,-1.27613:18.14538%,-0.23351:17.46539%,-0.33484:17.38158%,-71.33197:0.0006%,1.45709:0.0004%,-71.14798:0.0002%,-1.27347:0.0002%,1.47576:0.0002%,14.4699:0.0002%,-61.95768:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.94408%,1:21.06059%,5:18.14538%,4:17.46499%,2:17.38158%,0:0.00338%]
[INFO] ** service:[0.0048200000000000005:99.99901%,-211.73542999999998:0.0006%,-183.8612:0.0002%,-211.08346:0.0002%]
[INFO] ** src:[22:38.44237%,9:25.94507%,7:18.14578%,1:17.46539%,14:0.0006%,15:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** unixtime:1368 (0.27168%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0892 - tp: 78191.0000 - fp: 1809.0000 - tn: 318191.0000 - fn: 1809.0000 - accuracy: 0.9910 - precision: 0.9774 - recall: 0.9774 - auc: 0.9994 - val_loss: 3.0483e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0421 - tp: 79065.0000 - fp: 935.0000 - tn: 319065.0000 - fn: 935.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 9.7328e-04 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0365 - tp: 79123.0000 - fp: 877.0000 - tn: 319123.0000 - fn: 877.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 5.2158e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0343 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 2.8501e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0322 - tp: 79084.0000 - fp: 916.0000 - tn: 319084.0000 - fn: 916.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.5127e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/503533
[33m[INFO] loading file 30-30/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (503533, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (503533, 17)

[INFO] analyzing data
[INFO] 503533 rows
[INFO] ** appi_name:[21:99.99742%,30:0.00179%,26:0.0002%,17:0.0002%,12:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:64.36559%,Single Stage Single Point:35.63441%]
[INFO] ** dst:[21:43.33956%,10:21.02285%,8:18.14658%,9:17.48743%,15:0.00179%,22:0.00079%,24:0.0004%,25:0.0002%,16:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99821%,0:0.00179%]
[INFO] ** i/f_name:[2:99.99821%,3:0.00179%]
[INFO] ** modbus_function_code:[0.02961:99.99742%,-33.760870000000004:0.00258%]
[INFO] ** modbus_function_description:[7:49.9997%,11:49.99772%,0:0.00258%]
[INFO] ** modbus_transaction_id:65536 (13.01523%)
[INFO] ** orig:[0:99.99901%,2:0.0006%,1:0.0004%]
[INFO] ** proto:[0:99.99782%,1:0.00179%,2:0.0004%]
[INFO] ** proxy_src_ip:[18:38.36253%,20:25.99969%,13:18.14697%,6:17.48803%,17:0.00179%,7:0.0004%,16:0.0002%,5:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.99949%,-0.32151:21.02265%,-1.27613:18.14638%,-0.23351:17.48724%,-0.33484:17.33988%,-71.33197:0.00179%,-0.24151:0.0006%,-1.27347:0.0004%,-71.14798:0.0002%,-0.24950999999999998:0.0002%,10.192739999999999:0.0002%,1.47576:0.0002%,-61.95768:0.0002%,-1.02014:0.0002%,-64.19493:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.99909%,1:21.02265%,5:18.14618%,4:17.48704%,2:17.33968%,0:0.00536%]
[INFO] ** service:[0.0048200000000000005:99.99762%,-211.73542999999998:0.00179%,-186.44547:0.0002%,-211.08346:0.0002%,-205.44247:0.0002%]
[INFO] ** src:[22:38.36253%,9:25.99969%,7:18.14697%,1:17.48803%,14:0.00119%,21:0.00099%,16:0.0002%,15:0.0002%,8:0.0002%]
[INFO] ** type:[0:99.99921%,1:0.00079%]
[INFO] ** unixtime:1369 (0.27188%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0378 - tp: 78933.0000 - fp: 1067.0000 - tn: 318933.0000 - fn: 1067.0000 - accuracy: 0.9947 - precision: 0.9867 - recall: 0.9867 - auc: 0.9997 - val_loss: 8.8354e-04 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0261 - tp: 79133.0000 - fp: 867.0000 - tn: 319133.0000 - fn: 867.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 2.0621e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0264 - tp: 79069.0000 - fp: 931.0000 - tn: 319069.0000 - fn: 931.0000 - accuracy: 0.9953 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 2.7719e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0235 - tp: 79098.0000 - fp: 902.0000 - tn: 319098.0000 - fn: 902.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1085e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79165.0000 - fp: 835.0000 - tn: 319165.0000 - fn: 835.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9999 - val_loss: 6.4759e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/503533
[33m[INFO] loading file 31-31/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (503533, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (503533, 17)

[INFO] analyzing data
[INFO] 503533 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.37592%,Single Stage Single Point:35.62408%]
[INFO] ** dst:[21:43.31871%,10:21.05622%,8:18.12612%,9:17.49776%,22:0.00079%,24:0.0004%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[11:50.0001%,7:49.9999%]
[INFO] ** modbus_transaction_id:65536 (13.01523%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.40602%,20:25.9697%,13:18.12632%,6:17.49756%,16:0.0004%]
[INFO] ** s_port:[1.45442:25.9689%,-0.32151:21.05622%,-1.27613:18.12592%,-0.23351:17.49756%,-0.33484:17.34981%,-1.27347:0.0004%,1.45709:0.0004%,-1.02014:0.0004%,1.46509:0.0002%,1.47576:0.0002%]
[INFO] ** scada_tag:[3:25.96851%,1:21.05602%,5:18.12572%,4:17.49736%,2:17.34961%,0:0.00278%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.40602%,9:25.9697%,7:18.12632%,1:17.49756%,15:0.0004%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1368 (0.27168%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0303 - tp: 79062.0000 - fp: 938.0000 - tn: 319062.0000 - fn: 938.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9998 - val_loss: 4.1610e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79140.0000 - fp: 860.0000 - tn: 319140.0000 - fn: 860.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.3294e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.8400e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79103.0000 - fp: 897.0000 - tn: 319103.0000 - fn: 897.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.4404e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0196 - tp: 79170.0000 - fp: 830.0000 - tn: 319170.0000 - fn: 830.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9999 - val_loss: 3.0884e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/503533
[33m[INFO] loading file 32-32/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (503533, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (503533, 17)

[INFO] analyzing data
[INFO] 503533 rows
[INFO] ** appi_name:[21:99.99603%,30:0.00338%,31:0.0002%,27:0.0002%,26:0.0002%]
[INFO] ** classification:[normal:64.38744%,Single Stage Single Point:35.61256%]
[INFO] ** dst:[21:43.32943%,10:21.05284%,8:18.15134%,9:17.46142%,15:0.00338%,22:0.00099%,18:0.0002%,7:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99702%,0:0.00298%]
[INFO] ** i/f_name:[2:99.99662%,3:0.00338%]
[INFO] ** modbus_function_code:[0.02961:99.99603%,-33.760870000000004:0.00397%]
[INFO] ** modbus_function_description:[7:49.99871%,11:49.99732%,0:0.00397%]
[INFO] ** modbus_transaction_id:65536 (13.01523%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99603%,1:0.00338%,2:0.0006%]
[INFO] ** proxy_src_ip:[18:38.41695%,20:25.96553%,13:18.15114%,6:17.46221%,17:0.00338%,14:0.0006%,16:0.0002%]
[INFO] ** s_port:[1.45442:25.96513%,-0.32151:21.05284%,-1.27613:18.15095%,-0.23351:17.46142%,-0.33484:17.36411%,-71.33197:0.00338%,-0.24151:0.0006%,-71.14798:0.0002%,11.862:0.0002%,1.45709:0.0002%,-0.24950999999999998:0.0002%,1.46509:0.0002%,13.431270000000001:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.96473%,1:21.05264%,5:18.15095%,4:17.46102%,2:17.36411%,0:0.00655%]
[INFO] ** service:[0.0048200000000000005:99.99603%,-211.73542999999998:0.00338%,-211.08346:0.0002%,-186.43601999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:38.41695%,9:25.96553%,7:18.15114%,1:17.46221%,14:0.00338%,2:0.0006%,15:0.0002%]
[INFO] ** type:[0:99.9996%,1:0.0004%]
[INFO] ** unixtime:1367 (0.27148%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0304 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9998 - val_loss: 1.2123e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79130.0000 - fp: 870.0000 - tn: 319130.0000 - fn: 870.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1986e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0217 - tp: 79062.0000 - fp: 938.0000 - tn: 319062.0000 - fn: 938.0000 - accuracy: 0.9953 - precision: 0.9883 - recall: 0.9883 - auc: 0.9999 - val_loss: 1.6278e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0229 - tp: 79071.0000 - fp: 929.0000 - tn: 319071.0000 - fn: 929.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9998 - val_loss: 1.1952e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79072.0000 - fp: 928.0000 - tn: 319072.0000 - fn: 928.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1922e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/503533
[33m[INFO] loading file 33-33/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (503533, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (503533, 17)

[INFO] analyzing data
[INFO] 503533 rows
[INFO] ** appi_name:[21:99.99662%,30:0.00119%,17:0.00079%,22:0.0006%,31:0.0002%,28:0.0002%,26:0.0002%,7:0.0002%]
[INFO] ** classification:[normal:64.39379%,Single Stage Single Point:35.60621%]
[INFO] ** dst:[21:43.33499%,10:21.05383%,8:18.11401%,9:17.4922%,22:0.00119%,15:0.00119%,16:0.00079%,6:0.00079%,24:0.0004%,17:0.0004%,18:0.0002%]
[INFO] ** i/f_dir:[1:99.99881%,0:0.00119%]
[INFO] ** i/f_name:[2:99.99881%,3:0.00119%]
[INFO] ** modbus_function_code:[0.02961:99.99662%,-33.760870000000004:0.00338%]
[INFO] ** modbus_function_description:[7:49.9995%,11:49.99712%,0:0.00338%]
[INFO] ** modbus_transaction_id:65536 (13.01523%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99782%,1:0.00119%,2:0.00099%]
[INFO] ** proxy_src_ip:[18:38.41536%,20:25.97427%,13:18.11401%,6:17.4924%,17:0.00119%,1:0.00079%,16:0.0006%,21:0.0004%,14:0.0004%,7:0.0004%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.97347%,-0.32151:21.05383%,-1.27613:18.11361%,-0.23351:17.492%,-0.33484:17.36152%,-71.33197:0.00119%,-1.02014:0.0006%,-71.14931:0.0006%,1.45709:0.0004%,-1.27347:0.0004%,-71.14798:0.0002%,-58.035180000000004:0.0002%,-5.1466400000000005:0.0002%,-0.24151:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-5.08665:0.0002%,-0.24950999999999998:0.0002%,6.1115699999999995:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** scada_tag:[3:25.97307%,1:21.05383%,5:18.11341%,4:17.4918%,2:17.36152%,0:0.00636%]
[INFO] ** service:[0.0048200000000000005:99.99662%,-211.73542999999998:0.00119%,-205.44247:0.00079%,-211.08818:0.0006%,-211.09762999999998:0.0002%,-211.08346:0.0002%,-185.9872:0.0002%,-186.43601999999998:0.0002%]
[INFO] ** src:[22:38.41536%,9:25.97427%,7:18.11401%,1:17.4924%,14:0.00119%,3:0.00079%,15:0.0006%,21:0.0004%,4:0.0004%,2:0.0004%,8:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1370 (0.27208%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0295 - tp: 79138.0000 - fp: 862.0000 - tn: 319138.0000 - fn: 862.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9998 - val_loss: 3.9959e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1923e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79113.0000 - fp: 887.0000 - tn: 319113.0000 - fn: 887.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 2.3245e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 9.6506e-04 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/503533
[33m[INFO] loading file 34-34/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (344966, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (344966, 17)

[INFO] analyzing data
[INFO] 344966 rows
[INFO] ** appi_name:[21:99.99768%,7:0.00087%,31:0.00029%,30:0.00029%,22:0.00029%,8:0.00029%,6:0.00029%]
[INFO] ** classification:[normal:64.33504%,Single Stage Single Point:35.66496%]
[INFO] ** dst:[21:43.27006%,10:21.06208%,8:18.21368%,9:17.45129%,22:0.00087%,16:0.00058%,2:0.00058%,18:0.00029%,15:0.00029%,6:0.00029%]
[INFO] ** i/f_dir:[1:99.99971%,0:0.00029%]
[INFO] ** i/f_name:[2:99.99971%,3:0.00029%]
[INFO] ** modbus_function_code:[0.02961:99.99768%,-33.760870000000004:0.00232%]
[INFO] ** modbus_function_description:[7:49.99913%,11:49.99855%,0:0.00232%]
[INFO] ** modbus_transaction_id:65536 (18.99781%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99913%,2:0.00058%,1:0.00029%]
[INFO] ** proxy_src_ip:[18:38.38465%,20:25.94748%,13:18.21368%,6:17.45186%,1:0.00087%,21:0.00058%,17:0.00029%,14:0.00029%,7:0.00029%]
[INFO] ** s_port:[1.45442:25.94719%,-0.32151:21.06179%,-1.27613:18.21368%,-0.23351:17.451%,-0.33484:17.32287%,-0.24151:0.00087%,-3.0613900000000003:0.00029%,-3.3787199999999995:0.00029%,14.191239999999999:0.00029%,1.47576:0.00029%,11.57001:0.00029%,-49.275529999999996:0.00029%,-71.14931:0.00029%,7.66617:0.00029%,-71.33197:0.00029%]
[INFO] ** scada_tag:[3:25.9469%,1:21.0615%,5:18.21339%,4:17.45071%,2:17.32287%,0:0.00464%]
[INFO] ** service:[0.0048200000000000005:99.99797%,-211.09762999999998:0.00087%,-211.73542999999998:0.00029%,-186.43601999999998:0.00029%,-211.35747999999998:0.00029%,-211.08818:0.00029%]
[INFO] ** src:[22:38.38465%,9:25.94748%,7:18.21368%,1:17.45186%,3:0.00087%,4:0.00058%,21:0.00029%,14:0.00029%,2:0.00029%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:937 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/344966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79098.0000 - fp: 902.0000 - tn: 319098.0000 - fn: 902.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/344966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79089.0000 - fp: 911.0000 - tn: 319089.0000 - fn: 911.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 8.2001e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/344966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79138.0000 - fp: 862.0000 - tn: 319138.0000 - fn: 862.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/344966
[33m[INFO] loading file 35-35/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544966, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544966, 17)

[INFO] analyzing data
[INFO] 544966 rows
[INFO] ** appi_name:[21:99.9989%,30:0.0011%]
[INFO] ** classification:[normal:64.3697%,Single Stage Single Point:35.6303%]
[INFO] ** dst:[21:43.33371%,10:21.03342%,8:18.15508%,9:17.47559%,22:0.0011%,15:0.0011%]
[INFO] ** i/f_dir:[1:99.99908%,0:0.00092%]
[INFO] ** i/f_name:[2:99.9989%,3:0.0011%]
[INFO] ** modbus_function_code:[0.02961:99.9989%,-33.760870000000004:0.0011%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99872%,0:0.0011%]
[INFO] ** modbus_transaction_id:65536 (12.0257%)
[INFO] ** orig:[0:99.99963%,1:0.00037%]
[INFO] ** proto:[0:99.9989%,1:0.0011%]
[INFO] ** proxy_src_ip:[18:38.39873%,20:25.96896%,13:18.15471%,6:17.47577%,17:0.0011%,16:0.00073%]
[INFO] ** s_port:[1.45442:25.96841%,-0.32151:21.03342%,-1.27613:18.15471%,-0.23351:17.4754%,-0.33484:17.3653%,-71.33197:0.0011%,-1.02014:0.00073%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.96804%,1:21.03342%,5:18.15453%,4:17.47504%,2:17.3653%,0:0.00367%]
[INFO] ** service:[0.0048200000000000005:99.9989%,-211.73542999999998:0.0011%]
[INFO] ** src:[22:38.39873%,9:25.96896%,7:18.15471%,1:17.47577%,14:0.0011%,15:0.00073%]
[INFO] ** type:[0:99.99908%,1:0.00092%]
[INFO] ** unixtime:1479 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79138.0000 - fp: 862.0000 - tn: 319138.0000 - fn: 862.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79126.0000 - fp: 874.0000 - tn: 319126.0000 - fn: 874.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79146.0000 - fp: 854.0000 - tn: 319146.0000 - fn: 854.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0196 - tp: 79164.0000 - fp: 836.0000 - tn: 319164.0000 - fn: 836.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79110.0000 - fp: 890.0000 - tn: 319110.0000 - fn: 890.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/544966
[33m[INFO] loading file 36-36/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544966, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544966, 17)

[INFO] analyzing data
[INFO] 544966 rows
[INFO] ** appi_name:[21:99.99872%,30:0.00055%,31:0.00037%,33:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.35612%,Single Stage Single Point:35.64388%]
[INFO] ** dst:[21:43.33041%,10:21.0237%,8:18.15636%,9:17.48733%,22:0.00073%,15:0.00055%,24:0.00037%,18:0.00037%,25:0.00018%]
[INFO] ** i/f_dir:[1:99.99945%,0:0.00055%]
[INFO] ** i/f_name:[2:99.99945%,3:0.00055%]
[INFO] ** modbus_function_code:[0.02961:99.99872%,-33.760870000000004:0.00128%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99853%,0:0.00128%]
[INFO] ** modbus_transaction_id:65536 (12.0257%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9989%,2:0.00055%,1:0.00055%]
[INFO] ** proxy_src_ip:[18:38.37267%,20:25.98162%,13:18.15655%,6:17.48788%,17:0.00055%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.98107%,-0.32151:21.02351%,-1.27613:18.156%,-0.23351:17.48715%,-0.33484:17.34916%,-0.24151:0.00055%,-71.33197:0.00055%,-1.27347:0.00037%,-0.08551:0.00037%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-49.275529999999996:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:25.9807%,1:21.02333%,5:18.15581%,4:17.48696%,2:17.34897%,0:0.00422%]
[INFO] ** service:[0.0048200000000000005:99.9989%,-211.73542999999998:0.00055%,-186.43601999999998:0.00037%,-186.44547:0.00018%]
[INFO] ** src:[22:38.37267%,9:25.98162%,7:18.15655%,1:17.48788%,14:0.00055%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1480 (0.27158%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79127.0000 - fp: 873.0000 - tn: 319127.0000 - fn: 873.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 9.5382e-04 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79129.0000 - fp: 871.0000 - tn: 319129.0000 - fn: 871.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.0492e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/544966
[33m[INFO] loading file 37-37/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544966, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544966, 17)

[INFO] analyzing data
[INFO] 544966 rows
[INFO] ** appi_name:[21:99.9989%,30:0.00073%,26:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:64.37943%,Single Stage Single Point:35.62057%]
[INFO] ** dst:[21:43.33518%,10:21.04241%,8:18.13581%,9:17.48458%,22:0.00073%,15:0.00073%,24:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99927%,3:0.00073%]
[INFO] ** modbus_function_code:[0.02961:99.9989%,-33.760870000000004:0.0011%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99872%,0:0.0011%]
[INFO] ** modbus_transaction_id:65536 (12.0257%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99908%,1:0.00073%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.39139%,20:25.98658%,13:18.13599%,6:17.48458%,17:0.00073%,16:0.00037%,21:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:25.98602%,-0.32151:21.04241%,-1.27613:18.13563%,-0.23351:17.48439%,-0.33484:17.34897%,-71.33197:0.00073%,-1.02014:0.00037%,-71.14798:0.00018%,-1.27347:0.00018%,1.45709:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.2708:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.98584%,1:21.04241%,5:18.13544%,4:17.48421%,2:17.34879%,0:0.0033%]
[INFO] ** service:[0.0048200000000000005:99.9989%,-211.73542999999998:0.00073%,-183.8612:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.39139%,9:25.98658%,7:18.13599%,1:17.48458%,14:0.00073%,15:0.00037%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1480 (0.27158%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79051.0000 - fp: 949.0000 - tn: 319051.0000 - fn: 949.0000 - accuracy: 0.9953 - precision: 0.9881 - recall: 0.9881 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79091.0000 - fp: 909.0000 - tn: 319091.0000 - fn: 909.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79143.0000 - fp: 857.0000 - tn: 319143.0000 - fn: 857.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 2.2786e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/544966
[33m[INFO] loading file 38-38/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544966, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544966, 17)

[INFO] analyzing data
[INFO] 544966 rows
[INFO] ** appi_name:[21:99.99908%,30:0.00018%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.41264%,Single Stage Single Point:35.58736%]
[INFO] ** dst:[21:43.32197%,10:21.08866%,8:18.09507%,9:17.49247%,22:0.00092%,25:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99982%,0:0.00018%]
[INFO] ** i/f_name:[2:99.99982%,3:0.00018%]
[INFO] ** modbus_function_code:[0.02961:99.99908%,-33.760870000000004:0.00092%]
[INFO] ** modbus_function_description:[7:49.99963%,11:49.99945%,0:0.00092%]
[INFO] ** modbus_transaction_id:65536 (12.0257%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99945%,2:0.00037%,1:0.00018%]
[INFO] ** proxy_src_ip:[18:38.45946%,20:25.95171%,13:18.09489%,6:17.49283%,7:0.00037%,17:0.00018%,16:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95098%,-0.32151:21.08847%,-1.27613:18.09471%,-0.23351:17.49228%,-0.33484:17.37099%,-0.24151:0.00037%,1.45709:0.00037%,-64.19493:0.00018%,10.192739999999999:0.00018%,-1.02014:0.00018%,-71.14798:0.00018%,-61.95768:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-71.33197:0.00018%]
[INFO] ** scada_tag:[3:25.95061%,1:21.08847%,5:18.09471%,4:17.4921%,2:17.37099%,0:0.00312%]
[INFO] ** service:[0.0048200000000000005:99.99927%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%,-211.73542999999998:0.00018%]
[INFO] ** src:[22:38.45946%,9:25.95171%,7:18.09489%,1:17.49283%,21:0.00037%,16:0.00018%,15:0.00018%,14:0.00018%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1481 (0.27176%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79158.0000 - fp: 842.0000 - tn: 319158.0000 - fn: 842.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79096.0000 - fp: 904.0000 - tn: 319096.0000 - fn: 904.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79159.0000 - fp: 841.0000 - tn: 319159.0000 - fn: 841.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79119.0000 - fp: 881.0000 - tn: 319119.0000 - fn: 881.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 8.0665e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/544966
[33m[INFO] loading file 39-39/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544966, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544966, 17)

[INFO] analyzing data
[INFO] 544966 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.41007%,Single Stage Single Point:35.58993%]
[INFO] ** dst:[21:43.32472%,10:21.08443%,8:18.1292%,9:17.46054%,22:0.00092%,24:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99982%]
[INFO] ** modbus_transaction_id:65536 (12.0257%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.45561%,20:25.95391%,13:18.12939%,6:17.46054%,16:0.00055%]
[INFO] ** s_port:[1.45442:25.95336%,-0.32151:21.08443%,-1.27613:18.12902%,-0.23351:17.46036%,-0.33484:17.37118%,-1.02014:0.00055%,-1.27347:0.00018%,1.45709:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.2708:0.00018%]
[INFO] ** scada_tag:[3:25.953%,1:21.08425%,5:18.12884%,4:17.46036%,2:17.37099%,0:0.00257%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.45561%,9:25.95391%,7:18.12939%,1:17.46054%,15:0.00055%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1479 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1925e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79143.0000 - fp: 857.0000 - tn: 319143.0000 - fn: 857.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79094.0000 - fp: 906.0000 - tn: 319094.0000 - fn: 906.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79070.0000 - fp: 930.0000 - tn: 319070.0000 - fn: 930.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/544966
[33m[INFO] loading file 40-40/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544966, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544966, 17)

[INFO] analyzing data
[INFO] 544966 rows
[INFO] ** appi_name:[21:99.99633%,30:0.00312%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.33851%,Single Stage Single Point:35.66149%]
[INFO] ** dst:[21:43.29408%,10:21.03948%,8:18.19325%,9:17.46843%,15:0.00312%,22:0.00092%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99706%,0:0.00294%]
[INFO] ** i/f_name:[2:99.99688%,3:0.00312%]
[INFO] ** modbus_function_code:[0.02961:99.99633%,-33.760870000000004:0.00367%]
[INFO] ** modbus_function_description:[7:49.99927%,11:49.99706%,0:0.00367%]
[INFO] ** modbus_transaction_id:65536 (12.0257%)
[INFO] ** orig:[0:99.99963%,1:0.00037%]
[INFO] ** proto:[0:99.99633%,1:0.00312%,2:0.00055%]
[INFO] ** proxy_src_ip:[18:38.35652%,20:25.97795%,13:18.19306%,6:17.4688%,17:0.00312%,14:0.00055%]
[INFO] ** s_port:[1.45442:25.97703%,-0.32151:21.03948%,-1.27613:18.19288%,-0.23351:17.46825%,-0.33484:17.31704%,-71.33197:0.00312%,1.45709:0.00055%,-0.24151:0.00037%,-71.14798:0.00018%,-1.27347:0.00018%,11.862:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,13.431270000000001:0.00018%]
[INFO] ** scada_tag:[3:25.97667%,1:21.03929%,5:18.19269%,4:17.46788%,2:17.31686%,0:0.00661%]
[INFO] ** service:[0.0048200000000000005:99.99633%,-211.73542999999998:0.00312%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.35652%,9:25.97795%,7:18.19306%,1:17.4688%,14:0.00312%,2:0.00055%]
[INFO] ** type:[0:99.99908%,1:0.00092%]
[INFO] ** unixtime:1482 (0.27194%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79111.0000 - fp: 889.0000 - tn: 319111.0000 - fn: 889.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0214 - tp: 79056.0000 - fp: 944.0000 - tn: 319056.0000 - fn: 944.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0199 - tp: 79170.0000 - fp: 830.0000 - tn: 319170.0000 - fn: 830.0000 - accuracy: 0.9958 - precision: 0.9896 - recall: 0.9896 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/544966
[33m[INFO] loading file 41-41/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (485124, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (485124, 17)

[INFO] analyzing data
[INFO] 485124 rows
[INFO] ** appi_name:[21:99.9965%,30:0.00103%,22:0.00082%,17:0.00082%,32:0.00021%,28:0.00021%,26:0.00021%,7:0.00021%]
[INFO] ** classification:[normal:64.38581%,Single Stage Single Point:35.61419%]
[INFO] ** dst:[21:43.32047%,10:21.06101%,8:18.14031%,9:17.47368%,16:0.00103%,15:0.00103%,6:0.00103%,22:0.00062%,24:0.00041%,17:0.00041%]
[INFO] ** i/f_dir:[1:99.99897%,0:0.00103%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.9965%,-33.760870000000004:0.0035%]
[INFO] ** modbus_function_description:[7:49.99897%,11:49.99753%,0:0.0035%]
[INFO] ** modbus_transaction_id:65536 (13.50912%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99773%,2:0.00124%,1:0.00103%]
[INFO] ** proxy_src_ip:[18:38.42997%,20:25.95172%,13:18.14052%,6:17.47388%,17:0.00103%,1:0.00082%,21:0.00041%,16:0.00041%,14:0.00041%,0:0.00041%,7:0.00021%,2:0.00021%]
[INFO] ** s_port:[1.45442:25.9513%,-0.32151:21.06101%,-1.27613:18.1399%,-0.23351:17.47347%,-0.33484:17.36896%,-71.33197:0.00103%,-71.14931:0.00082%,-1.02014:0.00041%,-1.27347:0.00041%,-71.14798:0.00021%,-0.24151:0.00021%,-58.035180000000004:0.00021%,-1.2708:0.00021%,-5.1466400000000005:0.00021%,1.47576:0.00021%,1.46509:0.00021%,-64.19226:0.00021%,-5.08665:0.00021%,-0.24950999999999998:0.00021%,2.05573:0.00021%,-43.76509:0.00021%,-58.032509999999995:0.00021%]
[INFO] ** scada_tag:[3:25.9511%,1:21.06101%,5:18.1399%,4:17.47326%,2:17.36896%,0:0.00577%]
[INFO] ** service:[0.0048200000000000005:99.9965%,-211.73542999999998:0.00103%,-205.44247:0.00082%,-211.08818:0.00082%,89.64175:0.00021%,-211.09762999999998:0.00021%,-211.08346:0.00021%,-185.9872:0.00021%]
[INFO] ** src:[22:38.42997%,9:25.95172%,7:18.14052%,1:17.47388%,14:0.00103%,3:0.00082%,15:0.00041%,8:0.00041%,4:0.00041%,2:0.00041%,21:0.00021%,17:0.00021%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1316 (0.27127%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/485124
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79112.0000 - fp: 888.0000 - tn: 319112.0000 - fn: 888.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 8.1419e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/485124
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79147.0000 - fp: 853.0000 - tn: 319147.0000 - fn: 853.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/485124
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0213 - tp: 79108.0000 - fp: 892.0000 - tn: 319108.0000 - fn: 892.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/485124
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79150.0000 - fp: 850.0000 - tn: 319150.0000 - fn: 850.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-10-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/485124
[33m[INFO] loading file 42-42/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (428638, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (428638, 17)

[INFO] analyzing data
[INFO] 428638 rows
[INFO] ** appi_name:[21:99.99207%,30:0.0021%,17:0.00117%,31:0.00093%,26:0.00093%,7:0.00093%,22:0.0007%,28:0.00023%,27:0.00023%,9:0.00023%,8:0.00023%,0:0.00023%]
[INFO] ** classification:[normal:64.38417%,Single Stage Single Point:35.61583%]
[INFO] ** dst:[21:43.32187%,10:21.05366%,8:18.16848%,9:17.44689%,16:0.0021%,6:0.00187%,18:0.00117%,22:0.00093%,2:0.00093%,15:0.0007%,17:0.00047%,25:0.00023%,24:0.00023%,7:0.00023%,0:0.00023%]
[INFO] ** i/f_dir:[1:99.9993%,0:0.0007%]
[INFO] ** i/f_name:[2:99.9993%,3:0.0007%]
[INFO] ** modbus_function_code:[0.02961:99.99207%,-33.760870000000004:0.00793%]
[INFO] ** modbus_function_description:[7:49.99697%,11:49.9951%,0:0.00793%]
[INFO] ** modbus_transaction_id:65536 (15.28936%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9958%,2:0.0035%,1:0.0007%]
[INFO] ** proxy_src_ip:[18:38.4133%,20:25.96247%,13:18.16894%,6:17.44689%,17:0.0021%,1:0.0021%,14:0.0014%,21:0.00093%,7:0.0007%,16:0.00047%,0:0.00047%,2:0.00023%]
[INFO] ** s_port:[1.45442:25.962%,-0.32151:21.05366%,-1.27613:18.16848%,-0.23351:17.44666%,-0.33484:17.35964%,-71.14798:0.00093%,-71.14931:0.00093%,-71.33197:0.0007%,11.57001:0.00047%,-0.08551:0.00047%,-3.3787199999999995:0.00047%,-1.02014:0.00047%,-5.1466400000000005:0.00023%,-0.24151:0.00023%,13.431270000000001:0.00023%,0.31847:0.00023%,-1.2708:0.00023%,-58.035180000000004:0.00023%,7.66617:0.00023%,-64.19493:0.00023%,1.47576:0.00023%,14.4699:0.00023%,15.912510000000001:0.00023%,14.191239999999999:0.00023%,7.9608300000000005:0.00023%,-5.08665:0.00023%,10.192739999999999:0.00023%,-3.0613900000000003:0.00023%,1.45709:0.00023%,2.05573:0.00023%,-43.76509:0.00023%,11.862:0.00023%,-1.27347:0.00023%,-58.032509999999995:0.00023%]
[INFO] ** scada_tag:[3:25.96153%,1:21.05366%,5:18.16824%,4:17.44666%,2:17.3594%,0:0.0105%]
[INFO] ** service:[0.0048200000000000005:99.99207%,-211.09762999999998:0.00163%,-205.44247:0.00117%,-186.43601999999998:0.00117%,-211.08346:0.00093%,-211.08818:0.00093%,-211.73542999999998:0.0007%,-211.35747999999998:0.00047%,-186.44547:0.00023%,-183.8612:0.00023%,-185.9872:0.00023%,-202.75898:0.00023%]
[INFO] ** src:[22:38.4133%,9:25.96247%,7:18.16894%,1:17.44689%,3:0.0028%,2:0.00163%,4:0.00117%,21:0.00093%,14:0.0007%,15:0.00047%,8:0.00047%,17:0.00023%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1163 (0.27132%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/428638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 9.1651e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/428638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 8.0621e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/428638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0201 - tp: 79140.0000 - fp: 860.0000 - tn: 319140.0000 - fn: 860.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/428638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79122.0000 - fp: 878.0000 - tn: 319122.0000 - fn: 878.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 8.1738e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-41-42-batch-300000-400000
[INFO] processing batch 400000-500000/428638
[33m[INFO] loading file 43-43/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (528638, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (528638, 17)

[INFO] analyzing data
[INFO] 528638 rows
[INFO] ** appi_name:[21:99.99924%,30:0.00057%,26:0.00019%]
[INFO] ** classification:[normal:64.39984%,Single Stage Single Point:35.60016%]
[INFO] ** dst:[21:43.33154%,10:21.06659%,8:18.13074%,9:17.46923%,22:0.00095%,15:0.00057%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99924%,-33.760870000000004:0.00076%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99905%,0:0.00076%]
[INFO] ** modbus_transaction_id:65536 (12.39714%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99924%,1:0.00057%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.41892%,20:25.97959%,13:18.13093%,6:17.46942%,17:0.00057%,16:0.00038%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.97903%,-0.32151:21.06659%,-1.27613:18.13055%,-0.23351:17.46904%,-0.33484:17.35233%,-71.33197:0.00057%,1.45709:0.00038%,-1.02014:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.97865%,1:21.06659%,5:18.13037%,4:17.46866%,2:17.35214%,0:0.00359%]
[INFO] ** service:[0.0048200000000000005:99.99924%,-211.73542999999998:0.00057%,-211.08346:0.00019%]
[INFO] ** src:[22:38.41892%,9:25.97959%,7:18.13093%,1:17.46942%,14:0.00057%,15:0.00038%,3:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1437 (0.27183%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79090.0000 - fp: 910.0000 - tn: 319090.0000 - fn: 910.0000 - accuracy: 0.9955 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79164.0000 - fp: 836.0000 - tn: 319164.0000 - fn: 836.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0202 - tp: 79114.0000 - fp: 886.0000 - tn: 319114.0000 - fn: 886.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/528638
[33m[INFO] loading file 44-44/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (528638, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (528638, 17)

[INFO] analyzing data
[INFO] 528638 rows
[INFO] ** appi_name:[21:99.99811%,30:0.00076%,31:0.00057%,0:0.00038%,22:0.00019%]
[INFO] ** classification:[normal:64.37089%,Single Stage Single Point:35.62911%]
[INFO] ** dst:[21:43.32303%,10:21.04465%,8:18.16479%,9:17.46412%,22:0.00113%,15:0.00076%,18:0.00057%,25:0.00038%,24:0.00038%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99924%,0:0.00076%]
[INFO] ** i/f_name:[2:99.99924%,3:0.00076%]
[INFO] ** modbus_function_code:[0.02961:99.99811%,-33.760870000000004:0.00189%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99792%,0:0.00189%]
[INFO] ** modbus_transaction_id:65536 (12.39714%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99811%,2:0.00113%,1:0.00076%]
[INFO] ** proxy_src_ip:[18:38.41627%,20:25.95197%,13:18.16498%,6:17.46469%,17:0.00076%,7:0.00038%,16:0.00019%,5:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95122%,-0.32151:21.04465%,-1.27613:18.16441%,-0.23351:17.46394%,-0.33484:17.37162%,-71.33197:0.00076%,-0.24151:0.00057%,-0.08551:0.00038%,-64.19493:0.00038%,-1.27347:0.00038%,1.45709:0.00038%,-1.02014:0.00019%,-1.2708:0.00019%,1.47576:0.00019%,-71.14931:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,4.42897:0.00019%]
[INFO] ** scada_tag:[3:25.95065%,1:21.04465%,5:18.16441%,4:17.46356%,2:17.37143%,0:0.0053%]
[INFO] ** service:[0.0048200000000000005:99.99811%,-211.73542999999998:0.00076%,-186.43601999999998:0.00057%,-186.44547:0.00038%,-211.08818:0.00019%]
[INFO] ** src:[22:38.41627%,9:25.95197%,7:18.16498%,1:17.46469%,14:0.00076%,21:0.00038%,17:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1434 (0.27126%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0211 - tp: 79080.0000 - fp: 920.0000 - tn: 319080.0000 - fn: 920.0000 - accuracy: 0.9954 - precision: 0.9885 - recall: 0.9885 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79109.0000 - fp: 891.0000 - tn: 319109.0000 - fn: 891.0000 - accuracy: 0.9955 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0198 - tp: 79132.0000 - fp: 868.0000 - tn: 319132.0000 - fn: 868.0000 - accuracy: 0.9957 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 5.8203e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79107.0000 - fp: 893.0000 - tn: 319107.0000 - fn: 893.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 2.1504e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/528638
[33m[INFO] loading file 45-45/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (528638, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (528638, 17)

[INFO] analyzing data
[INFO] 528638 rows
[INFO] ** appi_name:[21:99.99905%,30:0.00057%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.41024%,Single Stage Single Point:35.58976%]
[INFO] ** dst:[21:43.32095%,10:21.08702%,8:18.12564%,9:17.46431%,22:0.00113%,15:0.00057%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99905%,-33.760870000000004:0.00095%]
[INFO] ** modbus_function_description:[7:50.00038%,11:49.99868%,0:0.00095%]
[INFO] ** modbus_transaction_id:65536 (12.39714%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99924%,1:0.00057%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.4804%,20:25.92833%,13:18.12545%,6:17.4645%,17:0.00057%,16:0.00038%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.92757%,-0.32151:21.08702%,-1.27613:18.12545%,-0.23351:17.46412%,-0.33484:17.39338%,1.45709:0.00057%,-71.33197:0.00057%,-1.02014:0.00038%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,14.4699:0.00019%]
[INFO] ** scada_tag:[3:25.927%,1:21.08683%,5:18.12545%,4:17.46412%,2:17.39319%,0:0.0034%]
[INFO] ** service:[0.0048200000000000005:99.99905%,-211.73542999999998:0.00057%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.4804%,9:25.92833%,7:18.12545%,1:17.4645%,14:0.00057%,15:0.00038%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1435 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0215 - tp: 79052.0000 - fp: 948.0000 - tn: 319052.0000 - fn: 948.0000 - accuracy: 0.9953 - precision: 0.9882 - recall: 0.9882 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79137.0000 - fp: 863.0000 - tn: 319137.0000 - fn: 863.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 1.1964e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79092.0000 - fp: 908.0000 - tn: 319092.0000 - fn: 908.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0194 - tp: 79150.0000 - fp: 850.0000 - tn: 319150.0000 - fn: 850.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/528638
[33m[INFO] loading file 46-46/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (528638, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (528638, 17)

[INFO] analyzing data
[INFO] 528638 rows
[INFO] ** appi_name:[21:99.99811%,30:0.00113%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.42291%,Single Stage Single Point:35.57709%]
[INFO] ** dst:[21:43.34705%,10:21.07302%,8:18.10445%,9:17.47264%,22:0.00113%,15:0.00113%,25:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99905%,0:0.00095%]
[INFO] ** i/f_name:[2:99.99887%,3:0.00113%]
[INFO] ** modbus_function_code:[0.02961:99.99811%,-33.760870000000004:0.00189%]
[INFO] ** modbus_function_description:[11:49.99905%,7:49.99905%,0:0.00189%]
[INFO] ** modbus_transaction_id:65536 (12.39714%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99849%,1:0.00113%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:38.44635%,20:25.97373%,13:18.10445%,6:17.4732%,17:0.00113%,16:0.00038%,7:0.00038%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.97335%,-0.32151:21.07283%,-1.27613:18.10426%,-0.23351:17.47245%,-0.33484:17.37351%,-71.33197:0.00113%,-0.24151:0.00057%,-1.02014:0.00038%,-71.14798:0.00019%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-61.95768:0.00019%,-1.2708:0.00019%,10.192739999999999:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:25.97297%,1:21.07264%,5:18.10407%,4:17.47207%,2:17.37351%,0:0.00473%]
[INFO] ** service:[0.0048200000000000005:99.9983%,-211.73542999999998:0.00113%,-211.08346:0.00019%,-205.44247:0.00019%,-186.44547:0.00019%]
[INFO] ** src:[22:38.44635%,9:25.97373%,7:18.10445%,1:17.4732%,14:0.00113%,21:0.00038%,15:0.00038%,16:0.00019%,8:0.00019%]
[INFO] ** type:[0:99.99905%,1:0.00095%]
[INFO] ** unixtime:1437 (0.27183%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0208 - tp: 79135.0000 - fp: 865.0000 - tn: 319135.0000 - fn: 865.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79161.0000 - fp: 839.0000 - tn: 319161.0000 - fn: 839.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79125.0000 - fp: 875.0000 - tn: 319125.0000 - fn: 875.0000 - accuracy: 0.9956 - precision: 0.9891 - recall: 0.9891 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79105.0000 - fp: 895.0000 - tn: 319105.0000 - fn: 895.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 2.5552e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/528638
[33m[INFO] loading file 47-47/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (528638, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (528638, 17)

[INFO] analyzing data
[INFO] 528638 rows
[INFO] ** appi_name:[21:99.99943%,33:0.00019%,26:0.00019%,17:0.00019%]
[INFO] ** classification:[normal:64.39435%,Single Stage Single Point:35.60565%]
[INFO] ** dst:[21:43.30619%,10:21.08607%,8:18.1281%,9:17.47718%,22:0.0017%,24:0.00038%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99943%,-33.760870000000004:0.00057%]
[INFO] ** modbus_function_description:[7:50.00132%,11:49.99811%,0:0.00057%]
[INFO] ** modbus_transaction_id:65536 (12.39714%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99981%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.45656%,20:25.93646%,13:18.12847%,6:17.47756%,16:0.00038%,7:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.93552%,-0.32151:21.08607%,-1.27613:18.12791%,-0.23351:17.47699%,-0.33484:17.37049%,1.45709:0.00057%,-0.24151:0.00057%,-1.27347:0.00038%,-1.02014:0.00038%,-71.14798:0.00019%,-61.95635:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,10.192739999999999:0.00019%]
[INFO] ** scada_tag:[3:25.93495%,1:21.08588%,5:18.12772%,4:17.4768%,2:17.3703%,0:0.00435%]
[INFO] ** service:[0.0048200000000000005:99.99962%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.45656%,9:25.93646%,7:18.12847%,1:17.47756%,21:0.00038%,15:0.00038%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1435 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0203 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0197 - tp: 79156.0000 - fp: 844.0000 - tn: 319156.0000 - fn: 844.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79100.0000 - fp: 900.0000 - tn: 319100.0000 - fn: 900.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0204 - tp: 79106.0000 - fp: 894.0000 - tn: 319106.0000 - fn: 894.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/528638
[33m[INFO] loading file 48-48/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (528638, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (528638, 17)

[INFO] analyzing data
[INFO] 528638 rows
[INFO] ** appi_name:[21:99.9966%,30:0.00265%,33:0.00019%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.41762%,Single Stage Single Point:35.58238%]
[INFO] ** dst:[21:43.33079%,10:21.08286%,8:18.11391%,9:17.4681%,15:0.00265%,22:0.00095%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99773%,0:0.00227%]
[INFO] ** i/f_name:[2:99.99735%,3:0.00265%]
[INFO] ** modbus_function_code:[0.02961:99.9966%,-33.760870000000004:0.0034%]
[INFO] ** modbus_function_description:[7:49.99887%,11:49.99773%,0:0.0034%]
[INFO] ** modbus_transaction_id:65536 (12.39714%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99678%,1:0.00265%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.45278%,20:25.96105%,13:18.11429%,6:17.4681%,17:0.00265%,14:0.00057%,16:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.96068%,-0.32151:21.08286%,-1.27613:18.11391%,-0.23351:17.46791%,-0.33484:17.36992%,-71.33197:0.00265%,-1.02014:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,1.45709:0.00019%,-61.95635:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,13.431270000000001:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.9603%,1:21.08286%,5:18.11391%,4:17.46791%,2:17.36973%,0:0.0053%]
[INFO] ** service:[0.0048200000000000005:99.99678%,-211.73542999999998:0.00265%,-211.08346:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.45278%,9:25.96105%,7:18.11429%,1:17.4681%,14:0.00265%,2:0.00057%,15:0.00038%,8:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1434 (0.27126%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0196 - tp: 79164.0000 - fp: 836.0000 - tn: 319164.0000 - fn: 836.0000 - accuracy: 0.9958 - precision: 0.9895 - recall: 0.9895 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0196 - tp: 79172.0000 - fp: 828.0000 - tn: 319172.0000 - fn: 828.0000 - accuracy: 0.9959 - precision: 0.9897 - recall: 0.9897 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0210 - tp: 79075.0000 - fp: 925.0000 - tn: 319075.0000 - fn: 925.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0220 - tp: 79104.0000 - fp: 896.0000 - tn: 319104.0000 - fn: 896.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 6.4955e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0207 - tp: 79102.0000 - fp: 898.0000 - tn: 319102.0000 - fn: 898.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/528638
[33m[INFO] loading file 49-49/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (528638, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (528638, 17)

[INFO] analyzing data
[INFO] 528638 rows
[INFO] ** appi_name:[21:99.99735%,30:0.00095%,17:0.00076%,22:0.00038%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.36862%,Single Stage Single Point:35.63138%]
[INFO] ** dst:[21:43.30336%,10:21.06092%,8:18.14153%,9:17.48985%,22:0.00132%,15:0.00095%,16:0.00076%,6:0.00057%,24:0.00038%,17:0.00038%]
[INFO] ** i/f_dir:[1:99.99905%,0:0.00095%]
[INFO] ** i/f_name:[2:99.99905%,3:0.00095%]
[INFO] ** modbus_function_code:[0.02961:99.99735%,-33.760870000000004:0.00265%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99773%,0:0.00265%]
[INFO] ** modbus_transaction_id:65536 (12.39714%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99849%,1:0.00095%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.42138%,20:25.94365%,13:18.14153%,6:17.49042%,17:0.00095%,1:0.00076%,21:0.00038%,16:0.00038%,14:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.94289%,-0.32151:21.06092%,-1.27613:18.14115%,-0.23351:17.48966%,-0.33484:17.36046%,-71.33197:0.00095%,-0.24151:0.00057%,-1.27347:0.00038%,-1.02014:0.00038%,1.45709:0.00038%,-71.14931:0.00038%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-5.1466400000000005:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,-5.08665:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:25.94252%,1:21.06073%,5:18.14096%,4:17.48928%,2:17.36046%,0:0.00605%]
[INFO] ** service:[0.0048200000000000005:99.99735%,-211.73542999999998:0.00095%,-205.44247:0.00076%,-211.08818:0.00038%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.42138%,9:25.94365%,7:18.14153%,1:17.49042%,14:0.00095%,3:0.00076%,15:0.00038%,4:0.00038%,2:0.00038%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1435 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79115.0000 - fp: 885.0000 - tn: 319115.0000 - fn: 885.0000 - accuracy: 0.9956 - precision: 0.9889 - recall: 0.9889 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0205 - tp: 79120.0000 - fp: 880.0000 - tn: 319120.0000 - fn: 880.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79140.0000 - fp: 860.0000 - tn: 319140.0000 - fn: 860.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0209 - tp: 79121.0000 - fp: 879.0000 - tn: 319121.0000 - fn: 879.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-10-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79072.0000 - fp: 928.0000 - tn: 319072.0000 - fn: 928.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 1.1921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/528638
[33m[INFO] loading file 50-50/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (378620, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (378620, 17)

[INFO] analyzing data
[INFO] 378620 rows
[INFO] ** appi_name:[21:99.99736%,30:0.00106%,7:0.00079%,31:0.00026%,22:0.00026%,8:0.00026%]
[INFO] ** classification:[normal:64.2956%,Single Stage Single Point:35.7044%]
[INFO] ** dst:[21:43.25181%,10:21.04062%,8:18.22725%,9:17.47689%,15:0.00106%,22:0.00053%,16:0.00053%,2:0.00053%,24:0.00026%,18:0.00026%,6:0.00026%]
[INFO] ** i/f_dir:[1:99.99894%,0:0.00106%]
[INFO] ** i/f_name:[2:99.99894%,3:0.00106%]
[INFO] ** modbus_function_code:[0.02961:99.99736%,-33.760870000000004:0.00264%]
[INFO] ** modbus_function_description:[11:49.99894%,7:49.99842%,0:0.00264%]
[INFO] ** modbus_transaction_id:65535 (17.30891%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99842%,1:0.00106%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.36115%,20:25.93154%,13:18.22751%,6:17.47689%,17:0.00106%,1:0.00079%,21:0.00026%,16:0.00026%,14:0.00026%,7:0.00026%]
[INFO] ** s_port:[1.45442:25.93101%,-0.32151:21.04062%,-1.27613:18.22698%,-0.23351:17.47689%,-0.33484:17.32053%,-71.33197:0.00106%,-3.3787199999999995:0.00026%,4.33564:0.00026%,15.912510000000001:0.00026%,7.9608300000000005:0.00026%,1.46509:0.00026%,1.45709:0.00026%,-1.27347:0.00026%,-71.14931:0.00026%,-1.02014:0.00026%,-1.2708:0.00026%,0.31847:0.00026%]
[INFO] ** scada_tag:[3:25.93075%,1:21.04036%,5:18.22672%,4:17.47689%,2:17.32027%,0:0.00502%]
[INFO] ** service:[0.0048200000000000005:99.99736%,-211.73542999999998:0.00106%,-211.09762999999998:0.00079%,-186.43601999999998:0.00026%,-211.35747999999998:0.00026%,-211.08818:0.00026%]
[INFO] ** src:[22:38.36115%,9:25.93154%,7:18.22751%,1:17.47689%,14:0.00106%,3:0.00079%,21:0.00026%,15:0.00026%,4:0.00026%,2:0.00026%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1029 (0.27178%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/378620
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0212 - tp: 79084.0000 - fp: 916.0000 - tn: 319084.0000 - fn: 916.0000 - accuracy: 0.9954 - precision: 0.9886 - recall: 0.9886 - auc: 0.9999 - val_loss: 2.1830e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/378620
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0200 - tp: 79116.0000 - fp: 884.0000 - tn: 319116.0000 - fn: 884.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9999 - val_loss: 8.0602e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/378620
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 0.0206 - tp: 79072.0000 - fp: 928.0000 - tn: 319072.0000 - fn: 928.0000 - accuracy: 0.9954 - precision: 0.9884 - recall: 0.9884 - auc: 0.9999 - val_loss: 8.1659e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
Using TensorFlow backend.
train.py:159: FutureWarning: Sorting because non-concatenation axis is not aligned. A future version
of pandas will change to not sort by default.

To accept the future behavior, pass 'sort=False'.

To retain the current behavior and silence the warning, pass 'sort=True'.

  df = pd.concat(df_from_each_file, ignore_index=True)
[INFO] saving weights to checkpoints/lstm-epoch-10-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/378620
2020-02-02 20:44:15.950442: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory
2020-02-02 20:44:15.950588: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory
2020-02-02 20:44:15.950603: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-02-02 20:44:16.746754: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory
2020-02-02 20:44:16.746786: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-02-02 20:44:16.746816: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (bastia): /proc/driver/nvidia/version does not exist
2020-02-02 20:44:16.746985: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-02-02 20:44:16.756346: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2112050000 Hz
2020-02-02 20:44:16.757809: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56951d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-02-02 20:44:16.757836: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-02-02 20:44:19.573367: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-02 20:44:19.577491: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 20:44:19.579331: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 20:44:19.592943: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-02 20:44:19.593862: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-02 20:44:19.595177: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 20:44:19.596505: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 20:44:19.599676: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
Date: 2020-02-02 20:44:16.741441
[INFO] input_shape (10, 16)
[INFO] LSTM first and last layer neurons: 5
adding core layer 0
[INFO] created DNN
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2015-12-31_130240_112.log.part10_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1364 (0.2728%)
[INFO] ** orig:[0:99.9992%,1:0.0008%]
[INFO] ** type:[0:99.9984%,1:0.0014%,2:0.0002%]
[INFO] ** i/f_name:[2:99.9984%,3:0.0016%]
[INFO] ** i/f_dir:[1:99.9986%,0:0.0014%]
[INFO] ** src:[22:38.114%,9:26.0964%,7:18.2424%,1:17.543%,14:0.0016%,11:0.0012%,10:0.001%,15:0.0004%]
[INFO] ** dst:[21:43.3686%,10:20.8412%,8:18.2422%,9:17.5434%,15:0.0016%,22:0.0014%,6:0.0006%,25:0.0004%,24:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** proto:[0:99.997%,1:0.0016%,2:0.0014%]
[INFO] ** appi_name:[21:99.9962%,30:0.0016%,26:0.0004%,0:0.0004%,31:0.0002%,27:0.0002%,24:0.0002%,22:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.114%,20:26.0964%,13:18.2424%,6:17.543%,17:0.0016%,10:0.0012%,11:0.001%,16:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.9962%,-33.760870000000004:0.0036%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9988%,11:49.9974%,0:0.0036%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.0954%,1:20.841%,5:18.242%,4:17.5424%,2:17.2726%,0:0.0066%]
[INFO] ** service:[0.0048200000000000005:99.997%,-211.73542999999998:0.0016%,-186.44547:0.0004%,-211.08346:0.0004%,-186.43601999999998:0.0002%,-211.08818:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:26.0956%,-0.32151:20.8412%,-1.27613:18.242%,-0.23351:17.5424%,-0.33484:17.2728%,-71.33197:0.0016%,-9.54647:0.0008%,-0.24151:0.0006%,-64.19493:0.0004%,-1.02014:0.0004%,-71.14798:0.0004%,1.45709:0.0004%,-1.27347:0.0002%,1.46509:0.0002%,-68.79874000000001:0.0002%,-71.14931:0.0002%,-3.22139:0.0002%,-1.2708:0.0002%,1.47576:0.0002%]
[INFO] ** classification:[normal:79.7796%,Single Stage Single Point:20.2204%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7327352e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.7327352e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.7327352e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [-1.0388781e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.0388781e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0388781e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 1 1 ... 1 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[7.6437213e-02 9.2356277e-01 1.0281898e-09 1.3295006e-09 1.0882200e-09]
  [7.6377859e-15 1.0000000e+00 3.7379389e-16 2.4683953e-15 3.7969766e-16]
  [1.6151828e-19 1.0000000e+00 1.8838658e-18 2.1969085e-17 2.0508541e-18]
  ...
  [4.0285802e-03 9.9597138e-01 2.6210606e-10 4.1085907e-10 3.0974606e-10]
  [6.2523741e-01 3.7476254e-01 1.8709541e-09 2.0525184e-09 1.8998050e-09]
  [5.9099150e-01 4.0900853e-01 1.8928925e-09 2.0895781e-09 1.9064983e-09]]

 [[6.3925064e-13 1.0000000e+00 3.2262545e-15 1.5209381e-14 2.6549382e-15]
  [1.7146686e-03 9.9828535e-01 1.6913149e-10 2.7718136e-10 1.9978759e-10]
  [6.8907225e-01 3.1092772e-01 1.7869787e-09 1.9288744e-09 1.8091019e-09]
  ...
  [3.6337089e-05 9.9996364e-01 2.6021721e-11 5.3710255e-11 3.3670369e-11]
  [1.8105321e-01 8.1894678e-01 1.5054827e-09 1.8549640e-09 1.5757324e-09]
  [5.6233960e-01 4.3766037e-01 1.9132858e-09 2.1272388e-09 1.9350450e-09]]

 [[2.5179232e-09 1.0000000e+00 1.9622699e-13 6.2237823e-13 1.7505965e-13]
  [3.4084454e-17 1.0000000e+00 2.6294154e-17 2.3165075e-16 2.7489577e-17]
  [5.3937727e-04 9.9946064e-01 9.8092291e-11 1.7297427e-10 1.2271749e-10]
  ...
  [3.4650441e-15 1.0000000e+00 2.5592735e-16 1.8022898e-15 2.6769031e-16]
  [4.7450317e-08 1.0000000e+00 9.6289795e-13 2.8746220e-12 1.3069124e-12]
  [1.1410685e-16 1.0000000e+00 4.7818788e-17 4.0542761e-16 5.1571280e-17]]

 ...

 [[2.0444548e-02 9.7955543e-01 5.4868859e-10 7.6534679e-10 5.8740302e-10]
  [3.3754709e-01 6.6245288e-01 1.8384564e-09 2.1581108e-09 1.9103032e-09]
  [2.8011121e-10 1.0000000e+00 6.6575685e-14 2.5034418e-13 6.5449829e-14]
  ...
  [2.9011616e-07 9.9999976e-01 2.3450835e-12 6.3070525e-12 3.1286497e-12]
  [1.4444959e-01 8.5555035e-01 1.3883024e-09 1.7433150e-09 1.4847085e-09]
  [7.0736861e-01 2.9263142e-01 1.7520789e-09 1.8800794e-09 1.7606786e-09]]

 [[2.3684929e-01 7.6315075e-01 1.6417789e-09 1.9732298e-09 1.7116860e-09]
  [2.6927396e-14 1.0000000e+00 6.9369780e-16 4.2758702e-15 6.9676364e-16]
  [7.9240675e-07 9.9999917e-01 3.8717740e-12 9.8434559e-12 5.1744091e-12]
  ...
  [1.3082678e-04 9.9986911e-01 4.8280414e-11 9.2058743e-11 6.0117696e-11]
  [1.9941619e-02 9.8005843e-01 5.4974780e-10 7.7457846e-10 5.8987432e-10]
  [6.7116141e-01 3.2883862e-01 1.8127222e-09 1.9649309e-09 1.8305600e-09]]

 [[2.0151608e-02 9.7984844e-01 5.4483196e-10 7.6057777e-10 5.8331423e-10]
  [3.3347979e-01 6.6652018e-01 1.8331032e-09 2.1540731e-09 1.9053150e-09]
  [7.0593202e-09 1.0000000e+00 3.3005494e-13 1.0413495e-12 3.2891496e-13]
  ...
  [8.3079481e-18 1.0000000e+00 1.3190901e-17 1.2815047e-16 1.4447303e-17]
  [1.9505966e-10 1.0000000e+00 6.2979597e-14 2.5458886e-13 8.5516351e-14]
  [3.7384976e-02 9.6261507e-01 7.6204854e-10 1.0443720e-09 8.4400975e-10]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[7.6437213e-02 9.2356277e-01 1.0281898e-09 1.3295006e-09 1.0882200e-09]
 [7.6377859e-15 1.0000000e+00 3.7379389e-16 2.4683953e-15 3.7969766e-16]
 [1.6151828e-19 1.0000000e+00 1.8838658e-18 2.1969085e-17 2.0508541e-18]
 ...
 [8.3079481e-18 1.0000000e+00 1.3190901e-17 1.2815047e-16 1.4447303e-17]
 [1.9505966e-10 1.0000000e+00 6.2979597e-14 2.5458886e-13 8.5516351e-14]
 [3.7384976e-02 9.6261507e-01 7.6204854e-10 1.0443720e-09 8.4400975e-10]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  2.6409692218780516
tp :  57224.0
fp :  42776.0
tn :  357224.0
fn :  42776.0
accuracy :  0.8288974761962891
precision :  0.5722399950027466
recall :  0.5722399950027466
auc :  0.8291519284248352

y_eval {0: 64261, 1: 35739}
pred {0: 21485, 1: 78515}
[INFO] confusion matrix for file 
[[21485 42776     0     0     0]
 [    0 35739     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[21485 42776     0     0     0]
 [    0 35739     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0388781e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.0388781e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0388781e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-3.4502095e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-3.4502095e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-3.4502095e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 1 1] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[2.15238363e-01 7.84761608e-01 1.58353830e-09 1.91310168e-09
   1.63335034e-09]
  [3.41438532e-01 6.58561409e-01 1.83881088e-09 2.15496043e-09
   1.91252392e-09]
  [6.66307747e-01 3.33692282e-01 1.81577664e-09 1.96930849e-09
   1.82964455e-09]
  ...
  [5.60779569e-18 1.00000000e+00 1.08656989e-17 1.07416146e-16
   1.18751455e-17]
  [2.57331885e-05 9.99974251e-01 2.21177590e-11 4.66870292e-11
   2.93278804e-11]
  [3.30079883e-01 6.69920087e-01 1.83333237e-09 2.15865725e-09
   1.90138905e-09]]

 [[9.26909483e-09 1.00000000e+00 3.75566765e-13 1.11741584e-12
   3.41923511e-13]
  [2.61881039e-03 9.97381151e-01 2.07188627e-10 3.30070665e-10
   2.38429887e-10]
  [7.83837438e-01 2.16162533e-01 1.58421265e-09 1.66189118e-09
   1.58691327e-09]
  ...
  [6.85698986e-01 3.14301044e-01 1.78664483e-09 1.92752858e-09
   1.79348714e-09]
  [7.55840723e-09 1.00000000e+00 3.38797078e-13 1.06250013e-12
   3.32112349e-13]
  [1.87727809e-02 9.81227279e-01 5.48698087e-10 7.82631793e-10
   6.15285600e-10]]

 [[2.30838786e-12 1.00000000e+00 6.08981537e-15 2.70267038e-14
   5.04441832e-15]
  [2.68865824e-06 9.99997258e-01 6.75220340e-12 1.57273066e-11
   7.70329113e-12]
  [5.05856514e-01 4.94143516e-01 1.94646321e-09 2.19944796e-09
   2.00872941e-09]
  ...
  [2.78597437e-14 1.00000000e+00 7.20855743e-16 4.52516934e-15
   7.51320448e-16]
  [2.32320055e-02 9.76768017e-01 6.14648610e-10 8.69759598e-10
   7.01471603e-10]
  [3.88005350e-10 1.00000000e+00 7.84637383e-14 2.90737405e-13
   7.66508032e-14]]

 ...

 [[1.36663904e-02 9.86333668e-01 4.49642323e-10 6.40657138e-10
   4.78739437e-10]
  [2.17297324e-15 1.00000000e+00 2.01662054e-16 1.42576111e-15
   2.06620823e-16]
  [6.19845530e-20 1.00000000e+00 1.17335218e-18 1.42881968e-17
   1.27214195e-18]
  ...
  [7.74629712e-01 2.25370228e-01 1.60657110e-09 1.68955283e-09
   1.60554192e-09]
  [3.94158405e-06 9.99996066e-01 7.64364006e-12 1.70371651e-11
   7.79057808e-12]
  [1.80951120e-13 1.00000000e+00 1.81038618e-15 1.02516465e-14
   1.86031644e-15]]

 [[1.25089647e-10 1.00000000e+00 4.40936553e-14 1.61760498e-13
   3.77980457e-14]
  [1.15086779e-03 9.98849154e-01 1.38485723e-10 2.31561464e-10
   1.62871952e-10]
  [7.60733068e-01 2.39266917e-01 1.64383895e-09 1.73784342e-09
   1.65204894e-09]
  ...
  [1.52172491e-01 8.47827494e-01 1.42917855e-09 1.79145332e-09
   1.54073099e-09]
  [7.86012232e-01 2.13987753e-01 1.57687685e-09 1.65237324e-09
   1.57663027e-09]
  [3.60904574e-01 6.39095426e-01 1.84930371e-09 2.15049822e-09
   1.87534011e-09]]

 [[2.11782120e-10 1.00000000e+00 5.72856378e-14 2.04965886e-13
   4.94643761e-14]
  [7.32183949e-08 9.99999881e-01 1.11946151e-12 3.16530005e-12
   1.24749256e-12]
  [5.27779937e-01 4.72220093e-01 1.94622429e-09 2.18951390e-09
   2.00829131e-09]
  ...
  [4.29626971e-01 5.70373058e-01 1.90640392e-09 2.18221641e-09
   1.93383065e-09]
  [2.01044550e-08 1.00000000e+00 5.52117434e-13 1.64369050e-12
   5.47455202e-13]
  [1.02831138e-11 1.00000000e+00 1.36976951e-14 6.29122405e-14
   1.48770478e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[2.1523836e-01 7.8476161e-01 1.5835383e-09 1.9131017e-09 1.6333503e-09]
 [3.4143853e-01 6.5856141e-01 1.8388109e-09 2.1549604e-09 1.9125239e-09]
 [6.6630775e-01 3.3369228e-01 1.8157766e-09 1.9693085e-09 1.8296445e-09]
 ...
 [4.2962697e-01 5.7037306e-01 1.9064039e-09 2.1822164e-09 1.9338307e-09]
 [2.0104455e-08 1.0000000e+00 5.5211743e-13 1.6436905e-12 5.4745520e-13]
 [1.0283114e-11 1.0000000e+00 1.3697695e-14 6.2912241e-14 1.4877048e-14]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  2.6957583389282225
tp :  55728.0
fp :  44272.0
tn :  355728.0
fn :  44272.0
accuracy :  0.8229135870933533
precision :  0.5572800040245056
recall :  0.5572800040245056
auc :  0.8272178769111633

y_eval {0: 64231, 1: 35769}
pred {0: 19960, 1: 80040}
[INFO] confusion matrix for file 
[[19960 44271     0     0     0]
 [    0 35769     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[41445 87047     0     0     0]
 [    0 71508     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4502095e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-3.4502095e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-3.4502095e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 ...
 [ 3.4629455e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 3.4629455e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 3.4629455e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 1 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.19965982e-10 1.00000000e+00 4.31873131e-14 1.58754954e-13
   3.70038168e-14]
  [8.16351381e-14 1.00000000e+00 1.23101617e-15 7.23644303e-15
   1.25999730e-15]
  [2.36170869e-02 9.76382852e-01 6.16953322e-10 8.70408801e-10
   7.01289915e-10]
  ...
  [2.11924344e-01 7.88075626e-01 1.57392466e-09 1.90689153e-09
   1.60241043e-09]
  [1.78603106e-08 1.00000000e+00 5.21999978e-13 1.56546466e-12
   5.18572381e-13]
  [5.14213331e-02 9.48578596e-01 8.84991858e-10 1.18835441e-09
   9.70093450e-10]]

 [[8.28482248e-12 1.00000000e+00 1.14679494e-14 4.79108872e-14
   9.58373056e-15]
  [1.90010411e-07 9.99999762e-01 1.80097940e-12 4.83829426e-12
   2.01062886e-12]
  [4.31351190e-14 1.00000000e+00 8.93891233e-16 5.48793917e-15
   9.40395460e-16]
  ...
  [4.55309540e-01 5.44690490e-01 1.91810634e-09 2.18308860e-09
   1.94477767e-09]
  [7.16131449e-01 2.83868521e-01 1.73522408e-09 1.85717641e-09
   1.74242754e-09]
  [3.27277482e-01 6.72722578e-01 1.80837112e-09 2.12134577e-09
   1.84214677e-09]]

 [[8.26892547e-12 1.00000000e+00 1.14570617e-14 4.78695995e-14
   9.57448605e-15]
  [2.49373991e-16 1.00000000e+00 7.04086873e-17 5.58491597e-16
   7.27635183e-17]
  [7.19207338e-17 1.00000000e+00 3.86473605e-17 3.33975615e-16
   4.33423053e-17]
  ...
  [6.57211430e-03 9.93427813e-01 3.28770511e-10 4.98221020e-10
   3.74422909e-10]
  [7.72103012e-01 2.27897003e-01 1.61514668e-09 1.70098324e-09
   1.61969382e-09]
  [8.91134068e-02 9.10886586e-01 1.09746257e-09 1.40602874e-09
   1.12342824e-09]]

 ...

 [[8.51312971e-14 1.00000000e+00 1.19135893e-15 6.17388170e-15
   9.75330698e-16]
  [2.41825382e-14 1.00000000e+00 6.78528448e-16 4.22699002e-15
   6.90603326e-16]
  [3.73599013e-10 1.00000000e+00 8.35842897e-14 3.18221822e-13
   9.93470714e-14]
  ...
  [6.91916764e-01 3.08083266e-01 1.78014026e-09 1.91877914e-09
   1.79474891e-09]
  [3.40327233e-01 6.59672737e-01 1.82741600e-09 2.13778661e-09
   1.86905424e-09]
  [7.53461361e-01 2.46538669e-01 1.65801306e-09 1.75550474e-09
   1.66134950e-09]]

 [[8.51147359e-14 1.00000000e+00 1.19124533e-15 6.17334002e-15
   9.75237737e-16]
  [2.41802326e-14 1.00000000e+00 6.78497425e-16 4.22681257e-15
   6.90571721e-16]
  [6.58907261e-18 1.00000000e+00 1.17784183e-17 1.14717881e-16
   1.28330430e-17]
  ...
  [6.65938139e-01 3.34061831e-01 1.81869197e-09 1.97336192e-09
   1.83470150e-09]
  [4.30759154e-02 9.56924081e-01 7.83448528e-10 1.04882592e-09
   8.13854650e-10]
  [2.15909002e-09 1.00000000e+00 1.83715863e-13 6.19512037e-13
   1.81763323e-13]]

 [[7.99093847e-11 1.00000000e+00 3.53005318e-14 1.32369742e-13
   3.01398887e-14]
  [1.01772914e-16 1.00000000e+00 4.51845491e-17 3.75890140e-16
   4.69619153e-17]
  [7.82223593e-04 9.99217749e-01 1.17555618e-10 2.02712666e-10
   1.45458923e-10]
  ...
  [5.07804871e-01 4.92195189e-01 1.94657246e-09 2.19860685e-09
   2.00431094e-09]
  [7.32276440e-01 2.67723560e-01 1.70346948e-09 1.81494275e-09
   1.70920400e-09]
  [2.28982493e-01 7.71017492e-01 1.61916380e-09 1.95176231e-09
   1.65403025e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.1996598e-10 1.0000000e+00 4.3187313e-14 1.5875495e-13 3.7003817e-14]
 [8.1635138e-14 1.0000000e+00 1.2310162e-15 7.2364430e-15 1.2599973e-15]
 [2.3617087e-02 9.7638285e-01 6.1695332e-10 8.7040880e-10 7.0128992e-10]
 ...
 [5.0780487e-01 4.9219519e-01 1.9465725e-09 2.1986069e-09 2.0043109e-09]
 [7.3227644e-01 2.6772356e-01 1.7034695e-09 1.8149428e-09 1.7092040e-09]
 [2.2898249e-01 7.7101749e-01 1.6191638e-09 1.9517623e-09 1.6540302e-09]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 0 0 1] (100000,)
[33m[INFO] metrics:[0m
loss :  3.750222364807129
tp :  48744.0
fp :  51256.0
tn :  348744.0
fn :  51256.0
accuracy :  0.7949779033660889
precision :  0.48743999004364014
recall :  0.48743999004364014
auc :  0.7780022025108337

y_eval {0: 70406, 1: 29594}
pred {0: 19150, 1: 80850}
[INFO] confusion matrix for file 
[[19150 51256     0     0     0]
 [    0 29594     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 60595 138303      0      0      0]
 [     0 101102      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 0.34629455  0.          0.         ...  4.          0.00482
  -0.23351   ]
 [ 0.34629455  0.          0.         ...  3.          0.00482
   1.45442   ]
 [ 0.34629455  0.          0.         ...  2.          0.00482
  -0.33484   ]
 ...
 [ 1.03761     0.          0.         ...  1.          0.00482
  -0.32151   ]
 [ 1.03761     0.          0.         ...  2.          0.00482
  -0.33484   ]
 [ 1.03761     0.          0.         ...  3.          0.00482
   1.45442   ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[8.50832534e-14 1.00000000e+00 1.19102721e-15 6.17232739e-15
   9.75059224e-16]
  [2.74380568e-06 9.99997258e-01 6.77866964e-12 1.57023092e-11
   7.35198968e-12]
  [2.19922543e-01 7.80077457e-01 1.62480296e-09 1.97690886e-09
   1.71826287e-09]
  ...
  [2.54072319e-03 9.97459352e-01 2.07369316e-10 3.33215816e-10
   2.42490195e-10]
  [5.97633779e-01 4.02366191e-01 1.89629201e-09 2.09379003e-09
   1.92573557e-09]
  [4.52940054e-02 9.54705954e-01 8.01907096e-10 1.06960873e-09
   8.25302438e-10]]

 [[1.84975052e-03 9.98150229e-01 1.65371813e-10 2.60887922e-10
   1.67966446e-10]
  [2.35336542e-15 1.00000000e+00 2.09236712e-16 1.46925308e-15
   2.11294883e-16]
  [4.88351262e-08 1.00000000e+00 9.67683073e-13 2.86229005e-12
   1.29029762e-12]
  ...
  [6.73496758e-10 1.00000000e+00 1.06617189e-13 3.88190565e-13
   1.12738066e-13]
  [5.61527610e-02 9.43847179e-01 9.22130039e-10 1.23198962e-09
   1.01235997e-09]
  [7.14970410e-01 2.85029531e-01 1.73947989e-09 1.86329441e-09
   1.75098080e-09]]

 [[2.60991662e-11 1.00000000e+00 2.02561238e-14 8.01035264e-14
   1.70845868e-14]
  [9.55613505e-04 9.99044359e-01 1.26020902e-10 2.12716358e-10
   1.47309484e-10]
  [7.31914520e-01 2.68085420e-01 1.70861669e-09 1.82235493e-09
   1.72328596e-09]
  ...
  [1.03608975e-15 1.00000000e+00 1.46833903e-16 1.12439452e-15
   1.76898755e-16]
  [4.12130443e-12 1.00000000e+00 8.99360779e-15 4.42865010e-14
   1.08309544e-14]
  [1.00304894e-02 9.89969552e-01 4.05474154e-10 6.01070915e-10
   4.61926303e-10]]

 ...

 [[8.10692208e-11 1.00000000e+00 3.55511485e-14 1.33187501e-13
   3.03391040e-14]
  [1.13807741e-09 1.00000000e+00 1.40613690e-13 4.96951438e-13
   1.50363513e-13]
  [2.60552496e-01 7.39447474e-01 1.73049408e-09 2.08343653e-09
   1.83483229e-09]
  ...
  [1.86127090e-05 9.99981403e-01 1.65894260e-11 3.39577810e-11
   1.69430043e-11]
  [3.58153274e-03 9.96418476e-01 2.38723707e-10 3.71728814e-10
   2.63999239e-10]
  [3.15392681e-04 9.99684572e-01 6.97468194e-11 1.23365318e-10
   7.44104084e-11]]

 [[1.01940341e-13 1.00000000e+00 1.30224730e-15 6.69197745e-15
   1.06644137e-15]
  [5.66149481e-07 9.99999404e-01 3.08716594e-12 7.78601402e-12
   3.30303688e-12]
  [4.33395154e-16 1.00000000e+00 9.17374600e-17 7.17519651e-16
   9.56111799e-17]
  ...
  [5.63556589e-02 9.43644285e-01 8.90874707e-10 1.17477328e-09
   9.25695520e-10]
  [7.71595120e-01 2.28404805e-01 1.61540559e-09 1.70098335e-09
   1.61744040e-09]
  [3.42108607e-02 9.65789139e-01 7.00660752e-10 9.49990420e-10
   7.25622118e-10]]

 [[2.22740567e-07 9.99999762e-01 1.83377727e-12 4.65604942e-12
   1.75817282e-12]
  [4.99400822e-03 9.95006025e-01 2.83440743e-10 4.34327574e-10
   3.19557464e-10]
  [7.87424028e-01 2.12575898e-01 1.57430102e-09 1.64939407e-09
   1.57627211e-09]
  ...
  [5.97191043e-04 9.99402761e-01 1.03773157e-10 1.82350024e-10
   1.30018260e-10]
  [6.10479474e-01 3.89520496e-01 1.88686022e-09 2.07772088e-09
   1.91865168e-09]
  [4.37358208e-03 9.95626450e-01 2.54349458e-10 3.86516236e-10
   2.62686317e-10]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[8.5083253e-14 1.0000000e+00 1.1910272e-15 6.1723274e-15 9.7505922e-16]
 [2.7438057e-06 9.9999726e-01 6.7786696e-12 1.5702309e-11 7.3519897e-12]
 [2.1992254e-01 7.8007746e-01 1.6248030e-09 1.9769089e-09 1.7182629e-09]
 ...
 [5.9719104e-04 9.9940276e-01 1.0377316e-10 1.8235002e-10 1.3001826e-10]
 [6.1047947e-01 3.8952050e-01 1.8868602e-09 2.0777209e-09 1.9186517e-09]
 [4.3735821e-03 9.9562645e-01 2.5434946e-10 3.8651624e-10 2.6268632e-10]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 0 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.319290901184083
tp :  19511.0
fp :  80489.0
tn :  319511.0
fn :  80489.0
accuracy :  0.6780471801757812
precision :  0.1951099932193756
recall :  0.1951099932193756
auc :  0.5546722412109375

y_eval {0: 100000}
pred {0: 19511, 1: 80489}
[INFO] confusion matrix for file 
[[19511 80489     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 80106 218792      0      0      0]
 [     0 101102      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0376101e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.0376101e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0376101e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [ 1.7314672e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.7314672e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.7314672e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[2.21863715e-07 9.99999762e-01 1.83016774e-12 4.64780645e-12
   1.75460167e-12]
  [9.45373245e-07 9.99999046e-01 3.97144470e-12 9.74236664e-12
   4.41766589e-12]
  [2.58060988e-13 1.00000000e+00 2.16285903e-15 1.20516839e-14
   2.26848192e-15]
  ...
  [1.57328848e-13 1.00000000e+00 1.68969425e-15 9.64497952e-15
   1.74899280e-15]
  [3.90513428e-02 9.60948646e-01 7.86566423e-10 1.07760945e-09
   8.86145157e-10]
  [7.38195002e-01 2.61804998e-01 1.69315717e-09 1.80153847e-09
   1.70056547e-09]]

 [[7.60973715e-11 1.00000000e+00 3.44513745e-14 1.29459865e-13
   2.93803847e-14]
  [2.56747568e-10 1.00000000e+00 6.68583163e-14 2.55756950e-13
   6.99491395e-14]
  [6.00738822e-05 9.99939919e-01 3.18295321e-11 6.26402402e-11
   3.73071539e-11]
  ...
  [6.36126518e-01 3.63873512e-01 1.85960281e-09 2.03441930e-09
   1.88486360e-09]
  [7.84755349e-01 2.15244651e-01 1.57880886e-09 1.65432823e-09
   1.57423530e-09]
  [9.00653098e-03 9.90993440e-01 3.63890584e-10 5.31491351e-10
   3.77825243e-10]]

 [[3.26679051e-01 6.73320949e-01 1.80818893e-09 2.11892015e-09
   1.86719618e-09]
  [5.71392547e-07 9.99999404e-01 2.95742554e-12 7.34459108e-12
   3.05489726e-12]
  [2.01119675e-16 1.00000000e+00 6.32829432e-17 5.15803572e-16
   6.76682578e-17]
  ...
  [1.11727108e-08 1.00000000e+00 4.10991228e-13 1.26113649e-12
   4.02352197e-13]
  [2.35855937e-01 7.64144063e-01 1.68025416e-09 2.03822514e-09
   1.78557391e-09]
  [7.10641558e-04 9.99289274e-01 1.03152813e-10 1.73503975e-10
   1.06822176e-10]]

 ...

 [[4.27898951e-02 9.57210064e-01 7.83137277e-10 1.04691456e-09
   8.29923352e-10]
  [6.95960641e-01 3.04039359e-01 1.77446646e-09 1.91026817e-09
   1.79103610e-09]
  [6.13089942e-04 9.99386907e-01 9.54315516e-11 1.61782490e-10
   1.00867932e-10]
  ...
  [1.84872717e-09 1.00000000e+00 1.77355445e-13 6.13066997e-13
   1.91513661e-13]
  [1.42876149e-06 9.99998569e-01 4.98818912e-12 1.20971237e-11
   5.92054834e-12]
  [4.59216608e-07 9.99999523e-01 2.75362328e-12 7.03084552e-12
   3.03055736e-12]]

 [[4.29137098e-03 9.95708585e-01 2.51901361e-10 3.80477566e-10
   2.59567118e-10]
  [4.72591490e-01 5.27408540e-01 1.93737959e-09 2.20117524e-09
   1.99176942e-09]
  [3.22201848e-02 9.67779815e-01 6.82153833e-10 9.29582800e-10
   7.19860727e-10]
  ...
  [3.24145402e-03 9.96758521e-01 2.20419322e-10 3.41545847e-10
   2.31990496e-10]
  [3.76296772e-09 1.00000000e+00 2.43971455e-13 8.00204954e-13
   2.42910943e-13]
  [4.58877861e-01 5.41122139e-01 1.95356664e-09 2.23520003e-09
   2.03248063e-09]]

 [[3.42890755e-13 1.00000000e+00 2.37118996e-15 1.15105061e-14
   1.94706786e-15]
  [3.78984720e-01 6.21015310e-01 1.91057770e-09 2.23137508e-09
   2.00784034e-09]
  [2.85681599e-04 9.99714315e-01 6.53600091e-11 1.15759687e-10
   7.04051747e-11]
  ...
  [4.58319075e-02 9.54168081e-01 8.46844650e-10 1.14893428e-09
   9.49662793e-10]
  [7.31205821e-01 2.68794209e-01 1.70716086e-09 1.82004178e-09
   1.71578862e-09]
  [8.34091127e-01 1.65908918e-01 1.42717638e-09 1.46838497e-09
   1.41726431e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[2.2186371e-07 9.9999976e-01 1.8301677e-12 4.6478064e-12 1.7546017e-12]
 [9.4537324e-07 9.9999905e-01 3.9714447e-12 9.7423666e-12 4.4176659e-12]
 [2.5806099e-13 1.0000000e+00 2.1628590e-15 1.2051684e-14 2.2684819e-15]
 ...
 [4.5831908e-02 9.5416808e-01 8.4684465e-10 1.1489343e-09 9.4966279e-10]
 [7.3120582e-01 2.6879421e-01 1.7071609e-09 1.8200418e-09 1.7157886e-09]
 [8.3409113e-01 1.6590892e-01 1.4271764e-09 1.4683850e-09 1.4172643e-09]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  8.17851622314453
tp :  20515.0
fp :  79485.0
tn :  320515.0
fn :  79485.0
accuracy :  0.682063102722168
precision :  0.20514999330043793
recall :  0.20514999330043793
auc :  0.5536700487136841

y_eval {0: 100000}
pred {0: 20515, 1: 79485}
[INFO] confusion matrix for file 
[[20515 79485     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[100621 298277      0      0      0]
 [     0 101102      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2015-12-31_181648_113.log.part08_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1370 (0.274%)
[INFO] ** orig:[0:99.9948%,2:0.0052%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9948%,3:0.0052%]
[INFO] ** i/f_dir:[1:99.9948%,0:0.0052%]
[INFO] ** src:[22:38.4402%,9:25.9738%,7:18.1202%,1:17.4598%,21:0.0052%,2:0.0004%,15:0.0002%,11:0.0002%]
[INFO] ** dst:[21:43.345%,10:21.0682%,8:18.1202%,9:17.4594%,15:0.0052%,22:0.0012%,19:0.0004%,26:0.0002%,24:0.0002%]
[INFO] ** proto:[0:99.9946%,1:0.0052%,2:0.0002%]
[INFO] ** appi_name:[21:99.9942%,30:0.0052%,23:0.0002%,22:0.0002%,18:0.0002%]
[INFO] ** proxy_src_ip:[18:38.4402%,20:25.9738%,13:18.1202%,6:17.4598%,17:0.0052%,14:0.0004%,16:0.0002%,10:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9942%,-33.760870000000004:0.0058%]
[INFO] ** modbus_function_description:[7:49.998%,11:49.9962%,0:0.0058%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:25.9726%,1:21.0682%,5:18.1198%,4:17.459%,2:17.3718%,0:0.0086%]
[INFO] ** service:[0.0048200000000000005:99.9942%,-211.73542999999998:0.0052%,-211.07873999999998:0.0004%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:25.973%,-0.32151:21.0682%,-1.27613:18.12%,-0.23351:17.4592%,-0.33484:17.372%,-71.33197:0.0052%,-0.24151:0.0006%,1.45709:0.0004%,8.38348:0.0004%,-1.27347:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-71.14931:0.0002%,-1.02014:0.0002%]
[INFO] ** classification:[normal:80.1196%,Multi Stage Multi Point:14.47%,Single Stage Multi Point:5.4104%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7318661  0.         0.        ...  1.         0.00482   -0.32151  ]
 [-1.7318661  0.         0.        ...  2.         0.00482   -0.33484  ]
 [-1.7318661  0.         0.        ...  3.         0.00482    1.45442  ]
 ...
 [-1.0381526  0.         0.        ...  1.         0.00482   -0.32151  ]
 [-1.0381526  0.         0.        ...  3.         0.00482    1.45442  ]
 [-1.0381526  0.         0.        ...  3.         0.00482    1.45442  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.18318554e-02 9.88168180e-01 4.17634233e-10 5.98468552e-10
   4.38080322e-10]
  [1.69714168e-01 8.30285847e-01 1.46601375e-09 1.81349247e-09
   1.55189617e-09]
  [7.32546747e-01 2.67453283e-01 1.70364989e-09 1.81525961e-09
   1.71076786e-09]
  ...
  [4.86424327e-01 5.13575673e-01 1.92500482e-09 2.17565277e-09
   1.94658201e-09]
  [3.85793371e-08 1.00000000e+00 7.63445839e-13 2.19307493e-12
   7.59133262e-13]
  [1.53282747e-01 8.46717238e-01 1.43053114e-09 1.79136439e-09
   1.53505786e-09]]

 [[7.22250561e-14 1.00000000e+00 1.09836478e-15 5.73420129e-15
   8.98455047e-16]
  [1.79240563e-12 1.00000000e+00 5.70620559e-15 2.83371434e-14
   5.72539300e-15]
  [2.45392410e-04 9.99754608e-01 6.50455106e-11 1.18912200e-10
   7.80622095e-11]
  ...
  [4.41567423e-08 1.00000000e+00 8.13194022e-13 2.31614988e-12
   8.02960021e-13]
  [2.96305081e-12 1.00000000e+00 7.30143925e-15 3.56965535e-14
   7.55689931e-15]
  [4.09418531e-02 9.59058106e-01 7.99993849e-10 1.09198839e-09
   8.92769192e-10]]

 [[7.22174802e-14 1.00000000e+00 1.09830612e-15 5.73393914e-15
   8.98407084e-16]
  [3.97689408e-04 9.99602377e-01 8.12876155e-11 1.44035103e-10
   9.31929742e-11]
  [8.21157465e-12 1.00000000e+00 1.17667157e-14 5.40399295e-14
   1.18925264e-14]
  ...
  [5.56818426e-01 4.43181604e-01 1.91333660e-09 2.12910156e-09
   1.93393057e-09]
  [6.94003999e-01 3.05996001e-01 1.77398207e-09 1.91018024e-09
   1.78448545e-09]
  [6.11208577e-08 9.99999881e-01 9.55207701e-13 2.67191976e-12
   9.41184522e-13]]

 ...

 [[5.06538704e-08 1.00000000e+00 8.75740832e-13 2.39481937e-12
   8.19140600e-13]
  [1.65655743e-03 9.98343468e-01 1.64701502e-10 2.68965905e-10
   1.88905405e-10]
  [1.27497106e-08 1.00000000e+00 4.50368204e-13 1.38576130e-12
   4.67099178e-13]
  ...
  [3.64701189e-13 1.00000000e+00 2.52035628e-15 1.37180103e-14
   2.53098357e-15]
  [4.42072742e-05 9.99955773e-01 2.83425280e-11 5.75555610e-11
   3.62169877e-11]
  [2.79120296e-01 7.20879674e-01 1.75228188e-09 2.09309881e-09
   1.83289739e-09]]

 [[2.32083663e-09 1.00000000e+00 1.88398559e-13 5.99808397e-13
   1.67736539e-13]
  [1.56821043e-03 9.98431742e-01 1.60982075e-10 2.64156003e-10
   1.87031210e-10]
  [2.89727318e-08 1.00000000e+00 6.77766328e-13 1.99508530e-12
   7.08882768e-13]
  ...
  [2.09769933e-05 9.99979019e-01 1.94269826e-11 4.09801845e-11
   2.46323153e-11]
  [2.83251405e-01 7.16748595e-01 1.76224602e-09 2.10347983e-09
   1.84595872e-09]
  [6.23953402e-01 3.76046598e-01 1.86643523e-09 2.04543382e-09
   1.88282212e-09]]

 [[4.79008015e-08 1.00000000e+00 8.51670730e-13 2.33550028e-12
   7.95904792e-13]
  [3.98553023e-17 1.00000000e+00 2.83771257e-17 2.48288068e-16
   2.97193520e-17]
  [6.38952362e-04 9.99361098e-01 1.06707664e-10 1.86397564e-10
   1.33199632e-10]
  ...
  [6.82931125e-01 3.17068905e-01 1.79283866e-09 1.93684291e-09
   1.80784465e-09]
  [6.22835159e-01 3.77164841e-01 1.86526639e-09 2.04368855e-09
   1.87694371e-09]
  [4.75677401e-01 5.24322629e-01 1.92487226e-09 2.18159468e-09
   1.95463290e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.1831855e-02 9.8816818e-01 4.1763423e-10 5.9846855e-10 4.3808032e-10]
 [1.6971417e-01 8.3028585e-01 1.4660138e-09 1.8134925e-09 1.5518962e-09]
 [7.3254675e-01 2.6745328e-01 1.7036499e-09 1.8152596e-09 1.7107679e-09]
 ...
 [6.8293113e-01 3.1706890e-01 1.7928387e-09 1.9368429e-09 1.8078447e-09]
 [6.2283516e-01 3.7716484e-01 1.8652664e-09 2.0436886e-09 1.8769437e-09]
 [4.7567740e-01 5.2432263e-01 1.9248723e-09 2.1815947e-09 1.9546329e-09]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 0 0 1] (100000,)
[33m[INFO] metrics:[0m
loss :  10.579183201599122
tp :  15575.0
fp :  84425.0
tn :  315575.0
fn :  84425.0
accuracy :  0.6623032689094543
precision :  0.15575000643730164
recall :  0.15575000643730164
auc :  0.49501436948776245

y_eval {0: 72948, 2: 27052}
pred {0: 21542, 1: 78458}
[INFO] confusion matrix for file 
[[15575 57373     0     0     0]
 [    0     0     0     0     0]
 [ 5967 21085     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[116196 355650      0      0      0]
 [     0 101102      0      0      0]
 [  5967  21085      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0381526e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0381526e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.0381526e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 ...
 [-3.4698951e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4698951e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-3.4698951e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[2.0202486e-11 1.0000000e+00 1.7840577e-14 7.1439999e-14 1.5020894e-14]
  [1.3422627e-16 1.0000000e+00 5.1826081e-17 4.2461227e-16 5.3710812e-17]
  [3.8090468e-04 9.9961913e-01 8.2387708e-11 1.4800357e-10 1.0305980e-10]
  ...
  [6.9728625e-01 3.0271378e-01 1.7684747e-09 1.9024673e-09 1.7775478e-09]
  [6.9144714e-01 3.0855292e-01 1.7771988e-09 1.9144910e-09 1.7855676e-09]
  [1.9913965e-07 9.9999976e-01 1.7232725e-12 4.5215173e-12 1.7220567e-12]]

 [[6.8194663e-14 1.0000000e+00 1.0677480e-15 5.5911006e-15 8.7391073e-16]
  [1.0993730e-11 1.0000000e+00 1.4024051e-14 6.3239839e-14 1.4084472e-14]
  [1.8500301e-05 9.9998152e-01 1.7892686e-11 3.7650768e-11 2.1344764e-11]
  ...
  [1.7361121e-01 8.2638878e-01 1.4897573e-09 1.8446961e-09 1.5750586e-09]
  [5.5318993e-01 4.4681007e-01 1.9175062e-09 2.1362461e-09 1.9384521e-09]
  [4.5442557e-01 5.4557443e-01 1.9194866e-09 2.1857640e-09 1.9486917e-09]]

 [[5.0533075e-02 9.4946694e-01 8.4780061e-10 1.1229048e-09 8.9913893e-10]
  [5.0574046e-15 1.0000000e+00 3.0522835e-16 2.0609980e-15 3.1083314e-16]
  [2.6295738e-06 9.9999738e-01 7.0375654e-12 1.6755401e-11 9.3865315e-12]
  ...
  [2.6215884e-04 9.9973780e-01 6.7263188e-11 1.2261042e-10 8.0671338e-11]
  [5.6946731e-01 4.3053269e-01 1.9200841e-09 2.1362923e-09 1.9634516e-09]
  [5.9658682e-01 4.0341318e-01 1.8890025e-09 2.0827520e-09 1.9032809e-09]]

 ...

 [[7.4363245e-14 1.0000000e+00 1.1143939e-15 5.8117184e-15 9.1216173e-16]
  [1.2795252e-01 8.7204742e-01 1.3317202e-09 1.6917082e-09 1.4511793e-09]
  [1.7610027e-08 1.0000000e+00 5.2223303e-13 1.5722393e-12 5.3541747e-13]
  ...
  [1.4475165e-01 8.5524839e-01 1.3575266e-09 1.6890471e-09 1.3972306e-09]
  [1.1819159e-06 9.9999881e-01 4.2316541e-12 1.0109745e-11 4.3506691e-12]
  [4.2810124e-01 5.7189876e-01 1.9370037e-09 2.2312088e-09 2.0141191e-09]]

 [[3.3795048e-02 9.6620500e-01 6.9831890e-10 9.4505792e-10 7.3530743e-10]
  [5.0768504e-15 1.0000000e+00 3.0554755e-16 2.0620123e-15 3.0999124e-16]
  [3.1332492e-03 9.9686676e-01 2.3294555e-10 3.7066103e-10 2.8053398e-10]
  ...
  [4.6797236e-16 1.0000000e+00 9.7952114e-17 7.7981453e-16 1.1293417e-16]
  [2.9549468e-04 9.9970442e-01 7.3034731e-11 1.3367253e-10 9.1272614e-11]
  [4.8464522e-02 9.5153546e-01 8.3979368e-10 1.1221425e-09 8.8597091e-10]]

 [[3.2767307e-02 9.6723270e-01 6.8799666e-10 9.3270602e-10 7.2452278e-10]
  [5.7989812e-01 4.2010185e-01 1.9097819e-09 2.1172730e-09 1.9504078e-09]
  [2.8991070e-09 1.0000000e+00 2.1136534e-13 6.9919829e-13 2.0855092e-13]
  ...
  [8.1273788e-01 1.8726212e-01 1.4976094e-09 1.5538345e-09 1.4901099e-09]
  [8.4082309e-08 9.9999988e-01 1.1193099e-12 3.0761348e-12 1.1075828e-12]
  [2.5775725e-11 1.0000000e+00 2.1450301e-14 9.3413240e-14 2.2771619e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[2.0202486e-11 1.0000000e+00 1.7840577e-14 7.1439999e-14 1.5020894e-14]
 [1.3422627e-16 1.0000000e+00 5.1826081e-17 4.2461227e-16 5.3710812e-17]
 [3.8090468e-04 9.9961913e-01 8.2387708e-11 1.4800357e-10 1.0305980e-10]
 ...
 [8.1273788e-01 1.8726212e-01 1.4976094e-09 1.5538345e-09 1.4901099e-09]
 [8.4082309e-08 9.9999988e-01 1.1193099e-12 3.0761348e-12 1.1075828e-12]
 [2.5775725e-11 1.0000000e+00 2.1450301e-14 9.3413240e-14 2.2771619e-14]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 0 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.347386874389649
tp :  20074.0
fp :  79926.0
tn :  320074.0
fn :  79926.0
accuracy :  0.6802990436553955
precision :  0.2007399946451187
recall :  0.2007399946451187
auc :  0.564383864402771

y_eval {0: 100000}
pred {0: 20074, 1: 79926}
[INFO] confusion matrix for file 
[[20074 79926     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[136270 435576      0      0      0]
 [     0 101102      0      0      0]
 [  5967  21085      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4698951e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-3.4698951e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4698951e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 3.4672397e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 3.4672397e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4672397e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[4.0273593e-10 1.0000000e+00 7.8843589e-14 2.7344048e-13 6.8604837e-14]
  [8.2900835e-04 9.9917102e-01 1.1755909e-10 2.0008538e-10 1.3800631e-10]
  [4.3521991e-01 5.6478012e-01 1.9230264e-09 2.2053284e-09 1.9830446e-09]
  ...
  [5.9433614e-10 1.0000000e+00 9.6170257e-14 3.4673748e-13 9.3197897e-14]
  [1.8498085e-01 8.1501913e-01 1.5437067e-09 1.9084281e-09 1.6577106e-09]
  [1.3056251e-02 9.8694372e-01 4.3972107e-10 6.3060585e-10 4.5968337e-10]]

 [[8.1512891e-03 9.9184871e-01 3.4877023e-10 5.1167776e-10 3.7402456e-10]
  [1.0589517e-02 9.8941046e-01 4.0213449e-10 5.8633337e-10 4.3438830e-10]
  [6.7791891e-01 3.2208109e-01 1.8040520e-09 1.9526927e-09 1.8248788e-09]
  ...
  [4.4823290e-07 9.9999952e-01 2.5794093e-12 6.4688220e-12 2.5812399e-12]
  [7.6890026e-15 1.0000000e+00 3.8257204e-16 2.5737844e-15 4.0351437e-16]
  [9.1643578e-06 9.9999082e-01 1.3005551e-11 2.8857597e-11 1.6617863e-11]]

 [[2.9946037e-10 1.0000000e+00 6.8048099e-14 2.3943158e-13 5.9007656e-14]
  [1.0645389e-08 1.0000000e+00 4.2785342e-13 1.3413390e-12 4.6708134e-13]
  [5.9898783e-12 1.0000000e+00 1.0389796e-14 4.9119522e-14 1.1319005e-14]
  ...
  [7.5459653e-01 2.4540347e-01 1.6541256e-09 1.7502467e-09 1.6546399e-09]
  [1.9366487e-08 1.0000000e+00 5.3968678e-13 1.6069656e-12 5.2959769e-13]
  [3.3916023e-03 9.9660838e-01 2.3703359e-10 3.7280234e-10 2.7142674e-10]]

 ...

 [[2.6003974e-10 1.0000000e+00 6.3433735e-14 2.2469060e-13 5.4883920e-14]
  [1.6799277e-12 1.0000000e+00 5.5044394e-15 2.7556079e-14 5.6542668e-15]
  [7.5642712e-02 9.2435730e-01 1.0606577e-09 1.3929191e-09 1.1692832e-09]
  ...
  [5.4118281e-08 1.0000000e+00 1.0173935e-12 2.9965206e-12 1.3575801e-12]
  [4.6417177e-01 5.3582823e-01 1.9494741e-09 2.2265731e-09 2.0230841e-09]
  [2.2057111e-07 9.9999976e-01 1.8248625e-12 4.7665643e-12 1.8333191e-12]]

 [[6.6073444e-03 9.9339265e-01 3.1418837e-10 4.6613902e-10 3.3649419e-10]
  [2.3087009e-04 9.9976915e-01 5.9992566e-11 1.0804482e-10 6.5127403e-11]
  [2.2003242e-07 9.9999976e-01 1.8803245e-12 4.9665211e-12 2.0091684e-12]
  ...
  [1.5653901e-08 1.0000000e+00 4.8854378e-13 1.4752590e-12 4.8516188e-13]
  [3.5890046e-04 9.9964106e-01 7.7897473e-11 1.3900216e-10 9.0581292e-11]
  [6.2203769e-02 9.3779624e-01 9.4629071e-10 1.2472587e-09 1.0023421e-09]]

 [[1.2040294e-13 1.0000000e+00 1.4137433e-15 7.2068562e-15 1.1575139e-15]
  [1.1102967e-01 8.8897038e-01 1.2535406e-09 1.6070196e-09 1.3698143e-09]
  [7.3128855e-01 2.6871145e-01 1.7069796e-09 1.8199283e-09 1.7198000e-09]
  ...
  [9.4267989e-08 9.9999988e-01 1.1863946e-12 3.2428671e-12 1.1674289e-12]
  [9.5467661e-03 9.9045324e-01 3.9217318e-10 5.8045729e-10 4.3912435e-10]
  [4.9953464e-06 9.9999499e-01 8.7590889e-12 1.9406036e-11 9.1356584e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[4.0273593e-10 1.0000000e+00 7.8843589e-14 2.7344048e-13 6.8604837e-14]
 [8.2900835e-04 9.9917102e-01 1.1755909e-10 2.0008538e-10 1.3800631e-10]
 [4.3521991e-01 5.6478012e-01 1.9230264e-09 2.2053284e-09 1.9830446e-09]
 ...
 [9.4267989e-08 9.9999988e-01 1.1863946e-12 3.2428671e-12 1.1674289e-12]
 [9.5467661e-03 9.9045324e-01 3.9217318e-10 5.8045729e-10 4.3912435e-10]
 [4.9953464e-06 9.9999499e-01 8.7590889e-12 1.9406036e-11 9.1356584e-12]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.333926542663574
tp :  19247.0
fp :  80753.0
tn :  319247.0
fn :  80753.0
accuracy :  0.6769911646842957
precision :  0.1924699991941452
recall :  0.1924699991941452
auc :  0.5608124136924744

y_eval {0: 100000}
pred {0: 19247, 1: 80753}
[INFO] confusion matrix for file 
[[19247 80753     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[155517 516329      0      0      0]
 [     0 101102      0      0      0]
 [  5967  21085      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4672397e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4672397e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 3.4672397e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [ 1.0378871e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.0378871e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.0378871e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[2.8735106e-11 1.0000000e+00 2.1246343e-14 8.3633567e-14 1.7935564e-14]
  [6.4483373e-03 9.9355161e-01 3.2440478e-10 4.9198784e-10 3.7399203e-10]
  [1.2054565e-09 1.0000000e+00 1.3898980e-13 4.8595741e-13 1.4254064e-13]
  ...
  [7.4322999e-01 2.5676996e-01 1.6820646e-09 1.7869388e-09 1.6890442e-09]
  [6.1985556e-06 9.9999380e-01 9.5745694e-12 2.0822869e-11 9.7420553e-12]
  [1.2315029e-06 9.9999881e-01 4.4910776e-12 1.0839906e-11 4.8548275e-12]]

 [[2.3886815e-10 1.0000000e+00 6.0812290e-14 2.1629024e-13 5.2560637e-14]
  [4.2078365e-03 9.9579215e-01 2.6256369e-10 4.0762879e-10 3.0308581e-10]
  [8.2374638e-01 1.7625365e-01 1.4637122e-09 1.5128855e-09 1.4583534e-09]
  ...
  [8.3758641e-16 1.0000000e+00 1.2752334e-16 9.7102438e-16 1.3510987e-16]
  [1.2509461e-03 9.9874902e-01 1.4859629e-10 2.5002136e-10 1.8174479e-10]
  [8.5430521e-08 9.9999988e-01 1.1572662e-12 3.2058874e-12 1.1871823e-12]]

 [[2.3552843e-10 1.0000000e+00 6.0388320e-14 2.1492821e-13 5.2185239e-14]
  [4.1429298e-03 9.9585706e-01 2.6055927e-10 4.0487663e-10 3.0083688e-10]
  [8.2348722e-01 1.7651282e-01 1.4645779e-09 1.5139420e-09 1.4592745e-09]
  ...
  [7.4952322e-01 2.5047675e-01 1.6655519e-09 1.7649643e-09 1.6659490e-09]
  [3.8123462e-01 6.1876535e-01 1.8706887e-09 2.1652657e-09 1.8988509e-09]
  [8.2132477e-01 1.7867522e-01 1.4708583e-09 1.5213275e-09 1.4639647e-09]]

 ...

 [[1.7209235e-13 1.0000000e+00 1.6865903e-15 8.4558062e-15 1.3821428e-15]
  [1.6634023e-05 9.9998331e-01 1.6689174e-11 3.5130333e-11 1.8716568e-11]
  [2.5767332e-04 9.9974233e-01 6.3883794e-11 1.1479854e-10 7.1059179e-11]
  ...
  [8.0912918e-01 1.9087078e-01 1.5094039e-09 1.5685712e-09 1.5051261e-09]
  [1.5611205e-01 8.4388793e-01 1.3968924e-09 1.7270915e-09 1.4209268e-09]
  [5.5759202e-09 1.0000000e+00 2.9328495e-13 9.3758150e-13 2.9102258e-13]]

 [[2.0591161e-11 1.0000000e+00 1.8009916e-14 7.2020230e-14 1.5155981e-14]
  [3.1190096e-16 1.0000000e+00 7.8598126e-17 6.1670521e-16 8.1204539e-17]
  [2.1945646e-12 1.0000000e+00 6.5366337e-15 3.2940136e-14 7.7835865e-15]
  ...
  [1.7513035e-02 9.8248690e-01 5.0502430e-10 7.1073153e-10 5.2317772e-10]
  [1.9659339e-09 1.0000000e+00 1.7571700e-13 5.9585052e-13 1.7385311e-13]
  [3.9223093e-01 6.0776907e-01 1.9207791e-09 2.2341007e-09 2.0131168e-09]]

 [[1.4799961e-09 1.0000000e+00 1.5064569e-13 4.9051204e-13 1.3350288e-13]
  [6.4073860e-17 1.0000000e+00 3.5921479e-17 3.0648844e-16 3.7499624e-17]
  [2.0632708e-08 1.0000000e+00 6.2959327e-13 1.9510673e-12 8.3180381e-13]
  ...
  [7.4212337e-01 2.5787660e-01 1.6866419e-09 1.7932854e-09 1.6976186e-09]
  [5.4781180e-05 9.9994516e-01 2.8441598e-11 5.4906121e-11 2.9129348e-11]
  [2.7187540e-11 1.0000000e+00 2.1393833e-14 9.2041161e-14 2.1342235e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[2.8735106e-11 1.0000000e+00 2.1246343e-14 8.3633567e-14 1.7935564e-14]
 [6.4483373e-03 9.9355161e-01 3.2440478e-10 4.9198784e-10 3.7399203e-10]
 [1.2054565e-09 1.0000000e+00 1.3898980e-13 4.8595741e-13 1.4254064e-13]
 ...
 [7.4212337e-01 2.5787660e-01 1.6866419e-09 1.7932854e-09 1.6976186e-09]
 [5.4781180e-05 9.9994516e-01 2.8441598e-11 5.4906121e-11 2.9129348e-11]
 [2.7187540e-11 1.0000000e+00 2.1393833e-14 9.2041161e-14 2.1342235e-14]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 0 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  10.846666651916504
tp :  14247.0
fp :  85753.0
tn :  314247.0
fn :  85753.0
accuracy :  0.6569912433624268
precision :  0.14247000217437744
recall :  0.14247000217437744
auc :  0.47847381234169006

y_eval {0: 74770, 4: 25230}
pred {0: 19867, 1: 80133}
[INFO] confusion matrix for file 
[[14247 60523     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [ 5620 19610     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[169764 576852      0      0      0]
 [     0 101102      0      0      0]
 [  5967  21085      0      0      0]
 [     0      0      0      0      0]
 [  5620  19610      0      0      0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0378871  0.         0.        ...  2.         0.00482   -0.33484  ]
 [ 1.0378871  0.         0.        ...  3.         0.00482    1.45442  ]
 [ 1.0378871  0.         0.        ...  4.         0.00482   -0.23351  ]
 ...
 [ 1.7316006  0.         0.        ...  3.         0.00482    1.45442  ]
 [ 1.7316006  0.         0.        ...  2.         0.00482   -0.33484  ]
 [ 1.7316006  0.         0.        ...  4.         0.00482   -0.23351  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 1.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 4 0 ... 4 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.99612200e-01 8.00387740e-01 1.54238644e-09 1.87503990e-09
   1.60450442e-09]
  [2.66336882e-03 9.97336566e-01 2.00899755e-10 3.15225235e-10
   2.15609613e-10]
  [2.15575366e-12 1.00000000e+00 6.08238605e-15 2.99610597e-14
   6.14006052e-15]
  ...
  [8.12070429e-01 1.87929571e-01 1.50076984e-09 1.55792179e-09
   1.49581458e-09]
  [4.59995195e-02 9.54000473e-01 8.06809453e-10 1.07481635e-09
   8.30620239e-10]
  [1.04253115e-02 9.89574730e-01 3.95306898e-10 5.74909287e-10
   4.17356927e-10]]

 [[1.02154640e-13 1.00000000e+00 1.30359429e-15 6.69826031e-15
   1.06754845e-15]
  [2.73428213e-07 9.99999762e-01 2.14298718e-12 5.61681387e-12
   2.25855511e-12]
  [6.42685031e-16 1.00000000e+00 1.11486529e-16 8.54298584e-16
   1.16147209e-16]
  ...
  [8.31123710e-01 1.68876335e-01 1.43784706e-09 1.48140256e-09
   1.42967038e-09]
  [1.12436498e-02 9.88756359e-01 4.05710188e-10 5.85043403e-10
   4.19456775e-10]
  [7.31761992e-01 2.68237978e-01 1.70804249e-09 1.82117266e-09
   1.71791925e-09]]

 [[1.93789464e-11 1.00000000e+00 1.74761312e-14 7.00888322e-14
   1.46992370e-14]
  [2.19558590e-16 1.00000000e+00 6.60800445e-17 5.27815981e-16
   6.83130285e-17]
  [1.70613575e-19 1.00000000e+00 1.93803186e-18 2.24732565e-17
   2.11734414e-18]
  ...
  [5.68597972e-01 4.31402057e-01 1.92372407e-09 2.14141616e-09
   1.96874295e-09]
  [8.26003492e-01 1.73996493e-01 1.45508205e-09 1.50213053e-09
   1.44680734e-09]
  [5.52006289e-02 9.44799364e-01 8.79373518e-10 1.15907173e-09
   9.04543940e-10]]

 ...

 [[4.53461325e-06 9.99995470e-01 8.26226674e-12 1.79951661e-11
   8.30942606e-12]
  [2.46421695e-02 9.75357831e-01 6.16838358e-10 8.61544613e-10
   6.77769396e-10]
  [8.22549164e-01 1.77450821e-01 1.46730250e-09 1.51711432e-09
   1.46122803e-09]
  ...
  [7.30012298e-01 2.69987643e-01 1.71360570e-09 1.82898718e-09
   1.72771442e-09]
  [3.63766151e-09 1.00000000e+00 2.35751441e-13 7.68777891e-13
   2.28317772e-13]
  [2.37201988e-07 9.99999762e-01 2.07732377e-12 5.58735523e-12
   2.59441947e-12]]

 [[1.57373420e-11 1.00000000e+00 1.57645063e-14 6.38433940e-14
   1.32380535e-14]
  [4.89816768e-03 9.95101810e-01 2.82985080e-10 4.35761843e-10
   3.25818206e-10]
  [8.00083399e-01 1.99916631e-01 1.53772650e-09 1.60357305e-09
   1.53634860e-09]
  ...
  [3.62133257e-08 1.00000000e+00 7.35972264e-13 2.11831204e-12
   7.22660213e-13]
  [4.33218656e-06 9.99995708e-01 8.70181271e-12 1.98454968e-11
   1.04432105e-11]
  [6.58971846e-01 3.41028154e-01 1.83755089e-09 2.00122741e-09
   1.87015137e-09]]

 [[3.62208337e-13 1.00000000e+00 2.43631748e-15 1.17962873e-14
   2.00092814e-15]
  [4.07701619e-02 9.59229827e-01 7.93819510e-10 1.08229836e-09
   8.83632723e-10]
  [7.80817747e-01 2.19182208e-01 1.59079028e-09 1.66969227e-09
   1.59201352e-09]
  ...
  [1.11838831e-02 9.88816142e-01 4.09440620e-10 5.93377236e-10
   4.33290209e-10]
  [7.91526258e-01 2.08473757e-01 1.56321001e-09 1.63546399e-09
   1.56440605e-09]
  [1.32562661e-07 9.99999881e-01 1.40288258e-12 3.75985484e-12
   1.38119345e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.9961220e-01 8.0038774e-01 1.5423864e-09 1.8750399e-09 1.6045044e-09]
 [2.6633688e-03 9.9733657e-01 2.0089976e-10 3.1522523e-10 2.1560961e-10]
 [2.1557537e-12 1.0000000e+00 6.0823860e-15 2.9961060e-14 6.1400605e-15]
 ...
 [1.1183883e-02 9.8881614e-01 4.0944062e-10 5.9337724e-10 4.3329021e-10]
 [7.9152626e-01 2.0847376e-01 1.5632100e-09 1.6354640e-09 1.5644060e-09]
 [1.3256266e-07 9.9999988e-01 1.4028826e-12 3.7598548e-12 1.3811934e-12]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 0 1] (100000,)
[33m[INFO] metrics:[0m
loss :  12.736732083129883
tp :  10087.0
fp :  89913.0
tn :  310087.0
fn :  89913.0
accuracy :  0.640351414680481
precision :  0.10086999833583832
recall :  0.10086999833583832
auc :  0.4194914400577545

y_eval {0: 52880, 4: 47120}
pred {0: 20829, 1: 79171}
[INFO] confusion matrix for file 
[[10087 42793     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [10742 36378     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[179851 619645      0      0      0]
 [     0 101102      0      0      0]
 [  5967  21085      0      0      0]
 [     0      0      0      0      0]
 [ 16362  55988      0      0      0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2015-12-31_181648_113.log.part09_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1359 (0.2718%)
[INFO] ** orig:[0:99.9966%,2:0.0034%]
[INFO] ** type:[0:99.9996%,1:0.0004%]
[INFO] ** i/f_name:[2:99.9938%,3:0.0062%]
[INFO] ** i/f_dir:[1:99.9942%,0:0.0058%]
[INFO] ** src:[22:38.4204%,9:25.9634%,7:18.123%,1:17.486%,21:0.0034%,14:0.0028%,15:0.0006%,2:0.0004%]
[INFO] ** dst:[21:43.3316%,10:21.0518%,8:18.123%,9:17.486%,15:0.0062%,22:0.0008%,24:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** proto:[0:99.9934%,1:0.0062%,2:0.0004%]
[INFO] ** appi_name:[21:99.9934%,30:0.0062%,31:0.0002%,27:0.0002%]
[INFO] ** proxy_src_ip:[18:38.4204%,20:25.9634%,13:18.123%,6:17.486%,17:0.0062%,16:0.0006%,14:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.9934%,-33.760870000000004:0.0066%]
[INFO] ** modbus_function_description:[7:49.9972%,11:49.9962%,0:0.0066%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:25.9624%,1:21.0518%,5:18.1226%,4:17.4856%,2:17.3686%,0:0.009%]
[INFO] ** service:[0.0048200000000000005:99.9934%,-211.73542999999998:0.0062%,-186.43601999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:25.9628%,-0.32151:21.0518%,-1.27613:18.1226%,-0.23351:17.4858%,-0.33484:17.3686%,-71.33197:0.0062%,-1.02014:0.0006%,-1.27347:0.0002%,11.862:0.0002%,1.45709:0.0002%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,13.431270000000001:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:73.9096%,Multi Stage Multi Point:26.0904%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7313178e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.7313178e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.7313178e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [-1.0397894e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.0397894e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0397894e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 4 0 ... 4 4 4] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[7.31933231e-14 1.00000000e+00 1.10561199e-15 5.76842693e-15
   9.04386713e-16]
  [1.78652462e-02 9.82134700e-01 5.35056610e-10 7.66845587e-10
   6.08225914e-10]
  [1.66173270e-10 1.00000000e+00 5.18615607e-14 2.01720070e-13
   5.24110716e-14]
  ...
  [2.52845325e-03 9.97471571e-01 2.09810697e-10 3.38905293e-10
   2.52594390e-10]
  [2.69974589e-01 7.30025411e-01 1.72362136e-09 2.05873407e-09
   1.77790072e-09]
  [6.20805025e-01 3.79195005e-01 1.87004456e-09 2.05110173e-09
   1.88776239e-09]]

 [[7.31857812e-14 1.00000000e+00 1.10555291e-15 5.76816308e-15
   9.04345314e-16]
  [1.77676100e-02 9.82232332e-01 5.33632971e-10 7.65050245e-10
   6.06658501e-10]
  [6.53685212e-01 3.46314788e-01 1.83659066e-09 2.00017403e-09
   1.86459137e-09]
  ...
  [5.90777956e-02 9.40922260e-01 9.41409728e-10 1.25237143e-09
   1.02776843e-09]
  [6.45807087e-01 3.54192913e-01 1.84602356e-09 2.01428962e-09
   1.87122851e-09]
  [2.55339749e-09 1.00000000e+00 1.97751307e-13 6.57982078e-13
   1.92090945e-13]]

 [[7.31781037e-14 1.00000000e+00 1.10549806e-15 5.76787678e-15
   9.04297033e-16]
  [5.28776040e-03 9.94712234e-01 2.94133745e-10 4.51703452e-10
   3.37442824e-10]
  [6.23477697e-01 3.76522303e-01 1.87283677e-09 2.05546957e-09
   1.90758720e-09]
  ...
  [7.19773412e-01 2.80226588e-01 1.72892911e-09 1.84904181e-09
   1.73792214e-09]
  [8.18994224e-08 9.99999881e-01 1.10584556e-12 3.04515441e-12
   1.09851093e-12]
  [6.08844775e-14 1.00000000e+00 1.06501031e-15 6.41556137e-15
   1.11043478e-15]]

 ...

 [[4.55502391e-09 1.00000000e+00 2.63626035e-13 8.12301073e-13
   2.37407939e-13]
  [1.99885387e-03 9.98001158e-01 1.81411358e-10 2.93540026e-10
   2.09785217e-10]
  [6.12523913e-01 3.87476057e-01 1.88301286e-09 2.07209272e-09
   1.91583149e-09]
  ...
  [1.56817478e-04 9.99843121e-01 5.33549073e-11 1.01170489e-10
   6.70372785e-11]
  [3.30449373e-01 6.69550657e-01 1.83077731e-09 2.15404161e-09
   1.89350602e-09]
  [4.59342897e-01 5.40657043e-01 1.92213223e-09 2.18665241e-09
   1.95000460e-09]]

 [[1.88796873e-12 1.00000000e+00 5.51295036e-15 2.46996010e-14
   4.56125209e-15]
  [3.23712011e-03 9.96762872e-01 2.31567557e-10 3.65946967e-10
   2.71611234e-10]
  [4.61825813e-08 1.00000000e+00 8.53509971e-13 2.44947487e-12
   8.99159328e-13]
  ...
  [4.55937162e-03 9.95440602e-01 2.77826512e-10 4.32061137e-10
   3.27136790e-10]
  [5.41893363e-01 4.58106637e-01 1.92844651e-09 2.15767004e-09
   1.97082617e-09]
  [4.89801735e-01 5.10198236e-01 1.92637040e-09 2.17615392e-09
   1.95176364e-09]]

 [[1.88523741e-12 1.00000000e+00 5.50899810e-15 2.46836361e-14
   4.55794739e-15]
  [1.64954395e-06 9.99998331e-01 5.28832967e-12 1.26421295e-11
   5.98152257e-12]
  [7.28033288e-14 1.00000000e+00 1.15229769e-15 6.86225987e-15
   1.19729536e-15]
  ...
  [1.80237498e-02 9.81976271e-01 5.41403367e-10 7.75912223e-10
   6.15129614e-10]
  [4.24441725e-01 5.75558245e-01 1.91351024e-09 2.19792140e-09
   1.96211114e-09]
  [6.76494539e-01 3.23505461e-01 1.80100668e-09 1.94794691e-09
   1.81139348e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[7.3193323e-14 1.0000000e+00 1.1056120e-15 5.7684269e-15 9.0438671e-16]
 [1.7865246e-02 9.8213470e-01 5.3505661e-10 7.6684559e-10 6.0822591e-10]
 [1.6617327e-10 1.0000000e+00 5.1861561e-14 2.0172007e-13 5.2411072e-14]
 ...
 [1.8023750e-02 9.8197627e-01 5.4140337e-10 7.7591222e-10 6.1512961e-10]
 [4.2444173e-01 5.7555825e-01 1.9135102e-09 2.1979214e-09 1.9621111e-09]
 [6.7649454e-01 3.2350546e-01 1.8010067e-09 1.9479469e-09 1.8113935e-09]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  13.713540205383302
tp :  7961.0
fp :  92039.0
tn :  307961.0
fn :  92039.0
accuracy :  0.6318474411964417
precision :  0.07960999757051468
recall :  0.07960999757051468
auc :  0.3989705741405487

y_eval {0: 52975, 4: 47025}
pred {0: 21879, 1: 78121}
[INFO] confusion matrix for file 
[[ 7961 45014     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [13918 33107     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[187812 664659      0      0      0]
 [     0 101102      0      0      0]
 [  5967  21085      0      0      0]
 [     0      0      0      0      0]
 [ 30280  89095      0      0      0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0397894e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0397894e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0397894e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-3.4570932e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-3.4570932e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-3.4570932e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]] shape (100000, 16)
y_test [[0. 0. 0. 0. 1.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [4 0 4 ... 0 4 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[2.57036670e-10 1.00000000e+00 6.30659059e-14 2.23493397e-13
   5.45431925e-14]
  [5.86252784e-16 1.00000000e+00 1.07252371e-16 8.16677616e-16
   1.11101884e-16]
  [8.87861643e-06 9.99991179e-01 1.27478757e-11 2.82565187e-11
   1.63925314e-11]
  ...
  [4.57573233e-16 1.00000000e+00 9.66493180e-17 7.66747088e-16
   1.09971836e-16]
  [1.81961368e-04 9.99818027e-01 5.74433417e-11 1.08042478e-10
   7.20086005e-11]
  [1.54786482e-01 8.45213532e-01 1.41116563e-09 1.75546033e-09
   1.47323553e-09]]

 [[2.58303509e-04 9.99741733e-01 6.22457919e-11 1.09669822e-10
   6.51164261e-11]
  [3.96112129e-02 9.60388780e-01 7.69913078e-10 1.04417097e-09
   8.34786407e-10]
  [4.29750174e-01 5.70249856e-01 1.91468219e-09 2.19583884e-09
   1.96359751e-09]
  ...
  [4.81391959e-02 9.51860785e-01 8.56488158e-10 1.15483700e-09
   9.39551215e-10]
  [1.28794178e-01 8.71205807e-01 1.29759425e-09 1.62847325e-09
   1.33750566e-09]
  [8.67824390e-09 1.00000000e+00 3.66957766e-13 1.14584720e-12
   3.66640122e-13]]

 [[4.03987110e-09 1.00000000e+00 2.48331547e-13 7.69697836e-13
   2.23229679e-13]
  [7.95048138e-04 9.99204934e-01 1.14746011e-10 1.95436917e-10
   1.33280456e-10]
  [7.51153827e-01 2.48846203e-01 1.66664615e-09 1.76735371e-09
   1.67680181e-09]
  ...
  [3.93860130e-17 1.00000000e+00 2.86063441e-17 2.57681875e-16
   3.19969144e-17]
  [1.70730249e-10 1.00000000e+00 5.84665441e-14 2.37214220e-13
   7.63272163e-14]
  [7.88191090e-17 1.00000000e+00 4.00210627e-17 3.47377741e-16
   4.37744907e-17]]

 ...

 [[1.78798998e-09 1.00000000e+00 1.65493595e-13 5.33820601e-13
   1.46968619e-13]
  [2.57497979e-03 9.97425079e-01 2.05827785e-10 3.28444827e-10
   2.38151304e-10]
  [5.63510537e-01 4.36489522e-01 1.91818006e-09 2.13526929e-09
   1.95864858e-09]
  ...
  [1.33807201e-14 1.00000000e+00 5.05560826e-16 3.33732527e-15
   5.47390701e-16]
  [1.92981260e-03 9.98070180e-01 1.82766260e-10 2.99253816e-10
   2.18831064e-10]
  [5.82161427e-01 4.17838573e-01 1.90802796e-09 2.11481210e-09
   1.94241223e-09]]

 [[1.32895389e-10 1.00000000e+00 4.54393976e-14 1.66211690e-13
   3.89780303e-14]
  [3.72018776e-15 1.00000000e+00 2.67436174e-16 1.84943397e-15
   2.75910765e-16]
  [4.64199623e-03 9.95358050e-01 2.80804824e-10 4.36389785e-10
   3.32307154e-10]
  ...
  [6.76704884e-01 3.23295057e-01 1.80168025e-09 1.94894301e-09
   1.81296622e-09]
  [7.38182724e-01 2.61817336e-01 1.69020897e-09 1.79710868e-09
   1.69164105e-09]
  [2.30065390e-01 7.69934535e-01 1.62232028e-09 1.95518313e-09
   1.65927272e-09]]

 [[9.60646628e-14 1.00000000e+00 1.26451876e-15 6.51430509e-15
   1.03482576e-15]
  [3.01758613e-04 9.99698281e-01 7.08293910e-11 1.27390445e-10
   8.10498543e-11]
  [5.43155193e-01 4.56844807e-01 1.93233229e-09 2.16264873e-09
   1.98384287e-09]
  ...
  [2.45636251e-15 1.00000000e+00 2.21227430e-16 1.60271456e-15
   2.45789850e-16]
  [2.08636357e-06 9.99997854e-01 6.24828618e-12 1.50704154e-11
   8.07514038e-12]
  [7.84733910e-12 1.00000000e+00 1.16492094e-14 5.39682367e-14
   1.19953604e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[2.5703667e-10 1.0000000e+00 6.3065906e-14 2.2349340e-13 5.4543192e-14]
 [5.8625278e-16 1.0000000e+00 1.0725237e-16 8.1667762e-16 1.1110188e-16]
 [8.8786164e-06 9.9999118e-01 1.2747876e-11 2.8256519e-11 1.6392531e-11]
 ...
 [2.4563625e-15 1.0000000e+00 2.2122743e-16 1.6027146e-15 2.4578985e-16]
 [2.0863636e-06 9.9999785e-01 6.2482862e-12 1.5070415e-11 8.0751404e-12]
 [7.8473391e-12 1.0000000e+00 1.1649209e-14 5.3968237e-14 1.1995360e-14]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.631742456054688
tp :  8173.0
fp :  91827.0
tn :  308173.0
fn :  91827.0
accuracy :  0.6326954364776611
precision :  0.08173000067472458
recall :  0.08173000067472458
auc :  0.4011371433734894

y_eval {0: 53029, 4: 46971}
pred {0: 20069, 1: 79931}
[INFO] confusion matrix for file 
[[ 8173 44856     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [11896 35075     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[195985 709515      0      0      0]
 [     0 101102      0      0      0]
 [  5967  21085      0      0      0]
 [     0      0      0      0      0]
 [ 42176 124170      0      0      0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4570932e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4570932e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4570932e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 ...
 [ 3.4581903e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 3.4581903e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4581903e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [4 4 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.47866653e-04 9.99852061e-01 4.70540031e-11 8.53010232e-11
   4.87052343e-11]
  [5.28290235e-02 9.47170913e-01 8.82654283e-10 1.17699306e-09
   9.54680890e-10]
  [7.85258532e-01 2.14741513e-01 1.57945057e-09 1.65571412e-09
   1.58062596e-09]
  ...
  [4.85970825e-01 5.14029145e-01 1.95310412e-09 2.21914243e-09
   2.02056749e-09]
  [9.44004128e-08 9.99999881e-01 1.18850090e-12 3.24729870e-12
   1.15814053e-12]
  [2.71692798e-02 9.72830653e-01 6.52056686e-10 9.08487618e-10
   7.21403048e-10]]

 [[3.28709115e-10 1.00000000e+00 7.12743666e-14 2.49655629e-13
   6.18780743e-14]
  [5.68883408e-17 1.00000000e+00 3.38857119e-17 2.90608349e-16
   3.53239871e-17]
  [6.63360389e-09 1.00000000e+00 3.57356749e-13 1.17657847e-12
   4.67459242e-13]
  ...
  [1.64849973e-06 9.99998331e-01 4.94319950e-12 1.15564815e-11
   5.00038119e-12]
  [5.11397779e-01 4.88602221e-01 1.95115035e-09 2.20361751e-09
   2.01350114e-09]
  [3.22027415e-01 6.77972555e-01 1.80361326e-09 2.12030105e-09
   1.84592330e-09]]

 [[7.49537761e-14 1.00000000e+00 1.11875561e-15 5.83228390e-15
   9.15738754e-16]
  [2.18459352e-14 1.00000000e+00 6.45316127e-16 4.04055214e-15
   6.56714755e-16]
  [2.25204587e-17 1.00000000e+00 2.16141335e-17 1.97934394e-16
   2.35240273e-17]
  ...
  [7.12056339e-01 2.87943661e-01 1.74490211e-09 1.87067539e-09
   1.75724624e-09]
  [2.01157224e-09 1.00000000e+00 1.75548500e-13 5.91526014e-13
   1.70467075e-13]
  [1.49361238e-01 8.50638747e-01 1.41959244e-09 1.78206960e-09
   1.53206448e-09]]

 ...

 [[8.53703230e-14 1.00000000e+00 1.19300980e-15 6.18163501e-15
   9.76682245e-16]
  [1.06904306e-01 8.93095613e-01 1.23285304e-09 1.58399327e-09
   1.34231393e-09]
  [1.04547971e-05 9.99989510e-01 1.25881926e-11 2.67582519e-11
   1.35000084e-11]
  ...
  [1.41425460e-09 1.00000000e+00 1.63858740e-13 5.87352758e-13
   2.02231285e-13]
  [1.98786497e-01 8.01213562e-01 1.57839297e-09 1.94047911e-09
   1.68343361e-09]
  [1.19529955e-10 1.00000000e+00 4.35924185e-14 1.71799478e-13
   4.22894379e-14]]

 [[6.34714425e-01 3.65285575e-01 1.85257865e-09 2.02263362e-09
   1.87952853e-09]
  [8.16907902e-13 1.00000000e+00 3.71706687e-15 1.90394677e-14
   3.64602071e-15]
  [1.46761479e-07 9.99999881e-01 1.66551311e-12 4.63417542e-12
   2.20397333e-12]
  ...
  [1.42259285e-06 9.99998569e-01 4.61789851e-12 1.09031274e-11
   4.72093024e-12]
  [5.62765383e-13 1.00000000e+00 3.18233645e-15 1.69841914e-14
   3.28167669e-15]
  [1.11357376e-01 8.88642669e-01 1.26140920e-09 1.61792446e-09
   1.38183731e-09]]

 [[8.36397618e-11 1.00000000e+00 3.61030074e-14 1.35007538e-13
   3.07966611e-14]
  [1.18045582e-16 1.00000000e+00 4.86076011e-17 4.01221216e-16
   5.04387407e-17]
  [3.70096718e-03 9.96299088e-01 2.52486643e-10 3.97927052e-10
   3.03106540e-10]
  ...
  [2.35823112e-08 1.00000000e+00 5.95233715e-13 1.75434114e-12
   5.87399812e-13]
  [1.18644278e-11 1.00000000e+00 1.47985685e-14 6.75901866e-14
   1.65684591e-14]
  [7.68245627e-06 9.99992371e-01 1.16269858e-11 2.58103573e-11
   1.39545910e-11]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.4786665e-04 9.9985206e-01 4.7054003e-11 8.5301023e-11 4.8705234e-11]
 [5.2829023e-02 9.4717091e-01 8.8265428e-10 1.1769931e-09 9.5468089e-10]
 [7.8525853e-01 2.1474151e-01 1.5794506e-09 1.6557141e-09 1.5806260e-09]
 ...
 [2.3582311e-08 1.0000000e+00 5.9523371e-13 1.7543411e-12 5.8739981e-13]
 [1.1864428e-11 1.0000000e+00 1.4798569e-14 6.7590187e-14 1.6568459e-14]
 [7.6824563e-06 9.9999237e-01 1.1626986e-11 2.5810357e-11 1.3954591e-11]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  12.326743757629394
tp :  10825.0
fp :  89175.0
tn :  310825.0
fn :  89175.0
accuracy :  0.643303394317627
precision :  0.10824999958276749
recall :  0.10824999958276749
auc :  0.4380178451538086

y_eval {0: 63544, 4: 36456}
pred {0: 19047, 1: 80953}
[INFO] confusion matrix for file 
[[10825 52719     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [ 8222 28234     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[206810 762234      0      0      0]
 [     0 101102      0      0      0]
 [  5967  21085      0      0      0]
 [     0      0      0      0      0]
 [ 50398 152404      0      0      0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4581903e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 3.4581903e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4581903e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [ 1.0398991e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.0398991e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0398991e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[3.9601624e-02 9.6039838e-01 7.5528550e-10 1.0146877e-09 8.0365842e-10]
  [4.0799772e-08 1.0000000e+00 8.0244557e-13 2.3070233e-12 8.2734964e-13]
  [5.3772315e-17 1.0000000e+00 3.3071594e-17 2.8965541e-16 3.5713252e-17]
  ...
  [3.1952532e-06 9.9999678e-01 6.8893693e-12 1.5539091e-11 6.9863650e-12]
  [5.0014853e-01 4.9985147e-01 1.9507091e-09 2.2078097e-09 2.0119213e-09]
  [2.6331114e-04 9.9973673e-01 6.2652959e-11 1.1120271e-10 6.4822654e-11]]

 [[8.5305705e-14 1.0000000e+00 1.1925638e-15 6.1795128e-15 9.7631717e-16]
  [2.4207688e-14 1.0000000e+00 6.7887541e-16 4.2289416e-15 6.9096173e-16]
  [3.4695717e-09 1.0000000e+00 2.5370371e-13 8.5687176e-13 3.0660235e-13]
  ...
  [3.2863644e-01 6.7136359e-01 1.8100753e-09 2.1223445e-09 1.8411206e-09]
  [7.0150781e-01 2.9849216e-01 1.7616191e-09 1.8929791e-09 1.7704848e-09]
  [1.7103039e-04 9.9982893e-01 5.0356257e-11 9.1447801e-11 5.2271718e-11]]

 [[8.5289279e-14 1.0000000e+00 1.1924501e-15 6.1789944e-15 9.7622411e-16]
  [1.2805450e-05 9.9998724e-01 1.4625494e-11 3.1190012e-11 1.6160533e-11]
  [3.1247449e-01 6.8752551e-01 1.8100021e-09 2.1409527e-09 1.8908948e-09]
  ...
  [6.8251228e-01 3.1748769e-01 1.7945541e-09 1.9389770e-09 1.8098713e-09]
  [6.0484626e-06 9.9999392e-01 9.4735886e-12 2.0643418e-11 9.6800623e-12]
  [6.3430649e-01 3.6569351e-01 1.8702269e-09 2.0499955e-09 1.9074413e-09]]

 ...

 [[1.7946831e-13 1.0000000e+00 1.7219231e-15 8.6157430e-15 1.4111570e-15]
  [6.7307062e-02 9.3269300e-01 1.0039763e-09 1.3289521e-09 1.1139809e-09]
  [3.6738838e-05 9.9996328e-01 2.3633146e-11 4.6945291e-11 2.5498312e-11]
  ...
  [7.5163162e-01 2.4836840e-01 1.6613820e-09 1.7598202e-09 1.6642682e-09]
  [1.2926242e-03 9.9870741e-01 1.3830427e-10 2.2481562e-10 1.4419767e-10]
  [2.4999813e-10 1.0000000e+00 6.3729519e-14 2.4249895e-13 6.3330133e-14]]

 [[4.6205927e-02 9.5379400e-01 8.1262658e-10 1.0818867e-09 8.6244339e-10]
  [6.2634742e-01 3.7365261e-01 1.8700264e-09 2.0503856e-09 1.9026984e-09]
  [3.2434539e-09 1.0000000e+00 2.2345759e-13 7.3436255e-13 2.2009394e-13]
  ...
  [2.8820862e-03 9.9711788e-01 2.0712207e-10 3.2258241e-10 2.1671621e-10]
  [1.9055554e-04 9.9980944e-01 5.4453369e-11 9.9117645e-11 5.8737584e-11]
  [3.9508284e-13 1.0000000e+00 2.6453038e-15 1.4358648e-14 2.7010714e-15]]

 [[4.5487262e-02 9.5451272e-01 8.0659779e-10 1.0748274e-09 8.5613810e-10]
  [4.4703897e-04 9.9955291e-01 8.2908271e-11 1.4370310e-10 8.9363877e-11]
  [7.3302925e-01 2.6697069e-01 1.7076097e-09 1.8207876e-09 1.7206745e-09]
  ...
  [6.0701090e-01 3.9298913e-01 1.8859128e-09 2.0765270e-09 1.9096360e-09]
  [1.1695556e-02 9.8830450e-01 4.1494203e-10 5.9774335e-10 4.3169615e-10]
  [7.4557221e-01 2.5442782e-01 1.6786501e-09 1.7826313e-09 1.6871562e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[3.9601624e-02 9.6039838e-01 7.5528550e-10 1.0146877e-09 8.0365842e-10]
 [4.0799772e-08 1.0000000e+00 8.0244557e-13 2.3070233e-12 8.2734964e-13]
 [5.3772315e-17 1.0000000e+00 3.3071594e-17 2.8965541e-16 3.5713252e-17]
 ...
 [6.0701090e-01 3.9298913e-01 1.8859128e-09 2.0765270e-09 1.9096360e-09]
 [1.1695556e-02 9.8830450e-01 4.1494203e-10 5.9774335e-10 4.3169615e-10]
 [7.4557221e-01 2.5442782e-01 1.6786501e-09 1.7826313e-09 1.6871562e-09]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 0 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  8.225575146484376
tp :  19939.0
fp :  80061.0
tn :  319939.0
fn :  80061.0
accuracy :  0.6797592043876648
precision :  0.1993899941444397
recall :  0.1993899941444397
auc :  0.5583045482635498

y_eval {0: 100000}
pred {0: 19939, 1: 80061}
[INFO] confusion matrix for file 
[[19939 80061     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[226749 842295      0      0      0]
 [     0 101102      0      0      0]
 [  5967  21085      0      0      0]
 [     0      0      0      0      0]
 [ 50398 152404      0      0      0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0398991e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.0398991e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0398991e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 1.7339792e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.7339792e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.7339792e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[2.14916312e-07 9.99999762e-01 1.80133317e-12 4.58193206e-12
   1.72606851e-12]
  [5.49451082e-17 1.00000000e+00 3.32314451e-17 2.86105071e-16
   3.48016854e-17]
  [1.89885610e-13 1.00000000e+00 1.96649795e-15 1.13594487e-14
   2.46674798e-15]
  ...
  [2.81293377e-10 1.00000000e+00 7.19499330e-14 2.79037915e-13
   8.45490737e-14]
  [2.21517810e-17 1.00000000e+00 2.13614248e-17 1.97803051e-16
   2.32820025e-17]
  [1.82253473e-06 9.99998212e-01 5.96220339e-12 1.46121865e-11
   8.20589170e-12]]

 [[4.40833196e-02 9.55916703e-01 7.94661781e-10 1.06082654e-09
   8.43650816e-10]
  [6.21460676e-01 3.78539354e-01 1.87511762e-09 2.05844786e-09
   1.90869787e-09]
  [7.56319225e-01 2.43680805e-01 1.65013159e-09 1.74511505e-09
   1.65132796e-09]
  ...
  [7.63400018e-01 2.36599997e-01 1.63463976e-09 1.72537162e-09
   1.63573466e-09]
  [7.21662998e-01 2.78337002e-01 1.72293968e-09 1.84030768e-09
   1.72424819e-09]
  [2.86102644e-03 9.97138977e-01 2.05785625e-10 3.20265703e-10
   2.14355741e-10]]

 [[6.88234866e-01 3.11765105e-01 1.78094739e-09 1.91844851e-09
   1.79829440e-09]
  [7.75054014e-06 9.99992251e-01 1.07963395e-11 2.32330977e-11
   1.12610511e-11]
  [4.21309636e-07 9.99999523e-01 2.65287575e-12 6.80711173e-12
   2.96919325e-12]
  ...
  [5.59400618e-01 4.40599352e-01 1.92636795e-09 2.14823204e-09
   1.96932914e-09]
  [6.99456573e-01 3.00543427e-01 1.76382697e-09 1.89580707e-09
   1.76905268e-09]
  [8.23170841e-01 1.76829174e-01 1.46450685e-09 1.51358548e-09
   1.45695644e-09]]

 ...

 [[3.76067236e-02 9.62393343e-01 7.33042516e-10 9.83776727e-10
   7.58020258e-10]
  [6.38841331e-01 3.61158609e-01 1.85495785e-09 2.02625139e-09
   1.88089810e-09]
  [4.84005921e-02 9.51599479e-01 8.28158486e-10 1.10194054e-09
   8.69725514e-10]
  ...
  [2.52259523e-02 9.74774003e-01 6.03337214e-10 8.31384128e-10
   6.20240914e-10]
  [8.24311316e-01 1.75688714e-01 1.46164891e-09 1.51014201e-09
   1.45462642e-09]
  [8.94776406e-07 9.99999046e-01 3.63667430e-12 8.78137320e-12
   3.61782154e-12]]

 [[3.07672046e-13 1.00000000e+00 2.24752527e-15 1.09660273e-14
   1.84495232e-15]
  [2.51161765e-07 9.99999762e-01 2.06110281e-12 5.43730946e-12
   2.21937876e-12]
  [5.06999612e-01 4.93000358e-01 1.94860061e-09 2.20112839e-09
   2.01027195e-09]
  ...
  [8.05286348e-01 1.94713727e-01 1.52090873e-09 1.58269586e-09
   1.51708157e-09]
  [2.71803997e-02 9.72819626e-01 6.25324625e-10 8.57792726e-10
   6.40643594e-10]
  [7.90297508e-01 2.09702462e-01 1.56588209e-09 1.63853153e-09
   1.56512658e-09]]

 [[1.43415904e-11 1.00000000e+00 1.50521549e-14 6.12537161e-14
   1.26294298e-14]
  [2.79695017e-16 1.00000000e+00 7.45001344e-17 5.87786708e-16
   7.70382157e-17]
  [1.07522719e-02 9.89247739e-01 4.24660695e-10 6.28343266e-10
   4.96567676e-10]
  ...
  [7.91464849e-09 1.00000000e+00 3.64011799e-13 1.16016810e-12
   3.91525571e-13]
  [3.27791631e-01 6.72208369e-01 1.84667848e-09 2.18175789e-09
   1.94011451e-09]
  [7.88928986e-01 2.11071014e-01 1.56830138e-09 1.64147296e-09
   1.56600566e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[2.1491631e-07 9.9999976e-01 1.8013332e-12 4.5819321e-12 1.7260685e-12]
 [5.4945108e-17 1.0000000e+00 3.3231445e-17 2.8610507e-16 3.4801685e-17]
 [1.8988561e-13 1.0000000e+00 1.9664979e-15 1.1359449e-14 2.4667480e-15]
 ...
 [7.9146485e-09 1.0000000e+00 3.6401180e-13 1.1601681e-12 3.9152557e-13]
 [3.2779163e-01 6.7220837e-01 1.8466785e-09 2.1817579e-09 1.9401145e-09]
 [7.8892899e-01 2.1107101e-01 1.5683014e-09 1.6414730e-09 1.5660057e-09]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  8.107410359191894
tp :  20645.0
fp :  79355.0
tn :  320645.0
fn :  79355.0
accuracy :  0.6825831532478333
precision :  0.20645000040531158
recall :  0.20645000040531158
auc :  0.5562579035758972

y_eval {0: 100000}
pred {0: 20645, 1: 79355}
[INFO] confusion matrix for file 
[[20645 79355     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[247394 921650      0      0      0]
 [     0 101102      0      0      0]
 [  5967  21085      0      0      0]
 [     0      0      0      0      0]
 [ 50398 152404      0      0      0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2015-12-31_233049_114.log.part11_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1361 (0.2722%)
[INFO] ** orig:[0:99.9996%,2:0.0004%]
[INFO] ** type:[0:99.9994%,1:0.0004%,2:0.0002%]
[INFO] ** i/f_name:[2:99.9968%,3:0.0032%]
[INFO] ** i/f_dir:[1:99.9972%,0:0.0028%]
[INFO] ** src:[22:38.4512%,9:25.9642%,7:18.089%,1:17.4908%,14:0.0028%,11:0.0008%,21:0.0004%,15:0.0004%,2:0.0004%]
[INFO] ** dst:[21:43.3436%,10:21.0714%,8:18.0896%,9:17.4906%,15:0.0032%,22:0.001%,24:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** proto:[0:99.9964%,1:0.0032%,2:0.0004%]
[INFO] ** appi_name:[21:99.9956%,30:0.0032%,31:0.0002%,27:0.0002%,24:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.4512%,20:25.9642%,13:18.089%,6:17.4908%,17:0.0032%,10:0.0008%,16:0.0004%,14:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.9956%,-33.760870000000004:0.0042%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.999%,11:49.9966%,0:0.0042%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:25.9632%,1:21.0714%,5:18.0886%,4:17.4902%,2:17.3796%,0:0.007%]
[INFO] ** service:[0.0048200000000000005:99.9964%,-211.73542999999998:0.0032%,-186.43601999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:25.9636%,-0.32151:21.0714%,-1.27613:18.0886%,-0.23351:17.4904%,-0.33484:17.3798%,-71.33197:0.0032%,6.286230000000001:0.0008%,1.45709:0.0004%,-1.02014:0.0004%,-1.27347:0.0002%,11.862:0.0002%,-0.24950999999999998:0.0002%,1.47576:0.0002%,-0.24151:0.0002%,13.431270000000001:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:95.0874%,Single Stage Single Point:4.9126%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7336235  0.         0.        ...  1.         0.00482   -0.32151  ]
 [-1.7336235  0.         0.        ...  2.         0.00482   -0.33484  ]
 [-1.7336235  0.         0.        ...  3.         0.00482    1.45442  ]
 ...
 [-1.0400795  0.         0.        ...  3.         0.00482    1.45442  ]
 [-1.0400795  0.         0.        ...  1.         0.00482   -0.32151  ]
 [-1.0400795  0.         0.        ...  1.         0.00482   -0.32151  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[5.5501765e-01 4.4498235e-01 1.9122883e-09 2.1260733e-09 1.9456692e-09]
  [3.9600736e-01 6.0399258e-01 1.8918340e-09 2.1865021e-09 1.9552593e-09]
  [5.2799225e-01 4.7200772e-01 1.9245332e-09 2.1561972e-09 1.9507207e-09]
  ...
  [9.0154995e-09 1.0000000e+00 4.2474899e-13 1.3932085e-12 5.8097516e-13]
  [4.3320343e-16 1.0000000e+00 9.2396326e-17 7.3121384e-16 9.9361888e-17]
  [3.1115912e-04 9.9968886e-01 7.4944578e-11 1.3672503e-10 9.4044598e-11]]

 [[1.3355569e-02 9.8664445e-01 4.4530760e-10 6.3604766e-10 4.7795129e-10]
  [3.1896031e-01 6.8103969e-01 1.8137748e-09 2.1398900e-09 1.8886985e-09]
  [6.8399358e-01 3.1600639e-01 1.7903511e-09 1.9330748e-09 1.8033367e-09]
  ...
  [5.7847217e-02 9.4215280e-01 9.4224373e-10 1.2603877e-09 1.0482917e-09]
  [1.3683341e-09 1.0000000e+00 1.4605316e-13 5.0428455e-13 1.4106686e-13]
  [2.4439385e-17 1.0000000e+00 2.2461259e-17 2.0561439e-16 2.4410035e-17]]

 [[4.5431197e-09 1.0000000e+00 2.6325220e-13 8.1110899e-13 2.3689229e-13]
  [1.6494439e-16 1.0000000e+00 5.7249283e-17 4.6588660e-16 5.9583679e-17]
  [1.9902134e-19 1.0000000e+00 2.0922851e-18 2.4118932e-17 2.2952010e-18]
  ...
  [3.3620254e-05 9.9996638e-01 2.5186766e-11 5.2276111e-11 3.3065287e-11]
  [3.0874759e-01 6.9125241e-01 1.8018055e-09 2.1332218e-09 1.8702073e-09]
  [6.5038031e-01 3.4961969e-01 1.8365750e-09 1.9994095e-09 1.8473396e-09]]

 ...

 [[6.4767629e-02 9.3523240e-01 9.5232511e-10 1.2432725e-09 1.0080567e-09]
  [3.9754665e-01 6.0245341e-01 1.8986415e-09 2.1955087e-09 1.9638939e-09]
  [7.7178752e-01 2.2821248e-01 1.6134831e-09 1.6983857e-09 1.6138648e-09]
  ...
  [7.7747401e-12 1.0000000e+00 1.1817817e-14 5.4882978e-14 1.2375332e-14]
  [4.0541388e-02 9.5945859e-01 7.9541090e-10 1.0860041e-09 8.8583829e-10]
  [7.6563839e-11 1.0000000e+00 3.5123966e-14 1.4203612e-13 3.3924954e-14]]

 [[2.9677216e-09 1.0000000e+00 2.1292480e-13 6.6975901e-13 1.9023253e-13]
  [1.8423683e-03 9.9815768e-01 1.7418370e-10 2.8310310e-10 2.0155892e-10]
  [4.3999489e-07 9.9999952e-01 2.6202189e-12 6.6469018e-12 2.7758397e-12]
  ...
  [4.0179104e-02 9.5982087e-01 7.8582618e-10 1.0697992e-09 8.6138213e-10]
  [6.9484818e-01 3.0515185e-01 1.7760079e-09 1.9135145e-09 1.7934060e-09]
  [5.1419153e-09 1.0000000e+00 2.7956370e-13 8.9495371e-13 2.7136586e-13]]

 [[4.9482230e-03 9.9505180e-01 2.7163671e-10 4.0876943e-10 2.8801858e-10]
  [2.6735082e-01 7.3264921e-01 1.7259570e-09 2.0660624e-09 1.8081596e-09]
  [7.7956855e-01 2.2043151e-01 1.5938775e-09 1.6737212e-09 1.5945951e-09]
  ...
  [4.4972333e-01 5.5027670e-01 1.9224120e-09 2.1941657e-09 1.9656337e-09]
  [7.4432957e-01 2.5567046e-01 1.6778224e-09 1.7811068e-09 1.6807277e-09]
  [7.6883352e-01 2.3116645e-01 1.6202104e-09 1.7068174e-09 1.6193732e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[5.5501765e-01 4.4498235e-01 1.9122883e-09 2.1260733e-09 1.9456692e-09]
 [3.9600736e-01 6.0399258e-01 1.8918340e-09 2.1865021e-09 1.9552593e-09]
 [5.2799225e-01 4.7200772e-01 1.9245332e-09 2.1561972e-09 1.9507207e-09]
 ...
 [4.4972333e-01 5.5027670e-01 1.9224120e-09 2.1941657e-09 1.9656337e-09]
 [7.4432957e-01 2.5567046e-01 1.6778224e-09 1.7811068e-09 1.6807277e-09]
 [7.6883352e-01 2.3116645e-01 1.6202104e-09 1.7068174e-09 1.6193732e-09]] (100000, 5)
pred 3 (argmax) [0 1 0 ... 1 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  8.330552188110351
tp :  21833.0
fp :  78167.0
tn :  321833.0
fn :  78167.0
accuracy :  0.6873351335525513
precision :  0.2183299958705902
recall :  0.2183299958705902
auc :  0.5669713020324707

y_eval {0: 100000}
pred {0: 21833, 1: 78167}
[INFO] confusion matrix for file 
[[21833 78167     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[269227 999817      0      0      0]
 [     0 101102      0      0      0]
 [  5967  21085      0      0      0]
 [     0      0      0      0      0]
 [ 50398 152404      0      0      0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0400795e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0400795e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0400795e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [-3.4653556e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4653556e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-3.4653556e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.05818542e-08 9.99999881e-01 9.57517052e-13 2.59512767e-12
   8.98231901e-13]
  [5.37579836e-16 1.00000000e+00 1.02496810e-16 7.85217436e-16
   1.06515604e-16]
  [3.12065906e-19 1.00000000e+00 2.61213835e-18 2.95292725e-17
   2.86508874e-18]
  ...
  [3.30675487e-10 1.00000000e+00 7.19246846e-14 2.67522793e-13
   6.97257532e-14]
  [4.32527959e-02 9.56747174e-01 8.20314539e-10 1.11502030e-09
   9.12044440e-10]
  [7.31921375e-01 2.68078655e-01 1.70630743e-09 1.81906956e-09
   1.71597780e-09]]

 [[5.94604330e-08 1.00000000e+00 9.48635268e-13 2.57345447e-12
   8.89628432e-13]
  [5.35494229e-16 1.00000000e+00 1.02301503e-16 7.83879653e-16
   1.06313441e-16]
  [4.50569678e-06 9.99995470e-01 9.12909505e-12 2.10446226e-11
   1.18654600e-11]
  ...
  [1.35597375e-07 9.99999881e-01 1.42424917e-12 3.81620950e-12
   1.42400198e-12]
  [2.78019626e-02 9.72198069e-01 6.59217070e-10 9.17140475e-10
   7.26872451e-10]
  [6.75031543e-01 3.24968487e-01 1.80751414e-09 1.95782501e-09
   1.82817184e-09]]

 [[4.74240094e-01 5.25759876e-01 1.92163396e-09 2.17456209e-09
   1.95938510e-09]
  [2.35941746e-13 1.00000000e+00 2.01234890e-15 1.10182325e-14
   1.97677945e-15]
  [3.18602579e-05 9.99968171e-01 2.40552075e-11 4.96591206e-11
   3.08258176e-11]
  ...
  [6.83888853e-01 3.16111118e-01 1.79150805e-09 1.93460825e-09
   1.80305026e-09]
  [2.05903961e-09 1.00000000e+00 1.77861903e-13 5.98731676e-13
   1.73362382e-13]
  [1.00865088e-01 8.99134934e-01 1.20377375e-09 1.55134394e-09
   1.31083533e-09]]

 ...

 [[8.47880263e-03 9.91521120e-01 3.55640850e-10 5.20636201e-10
   3.81370852e-10]
  [8.13782861e-11 1.00000000e+00 3.67593631e-14 1.48191111e-13
   3.71283848e-14]
  [2.61899299e-18 1.00000000e+00 7.45123138e-18 7.62494030e-17
   8.10321348e-18]
  ...
  [7.62449503e-02 9.23754990e-01 1.03961761e-09 1.35399936e-09
   1.10179355e-09]
  [1.29508401e-11 1.00000000e+00 1.46023550e-14 6.50375546e-14
   1.43594700e-14]
  [4.79612852e-17 1.00000000e+00 3.16657874e-17 2.82380535e-16
   3.59841566e-17]]

 [[1.69479364e-08 1.00000000e+00 5.07304160e-13 1.46485103e-12
   4.66097050e-13]
  [3.43569648e-03 9.96564329e-01 2.36569653e-10 3.70857567e-10
   2.70396289e-10]
  [7.87224472e-01 2.12775514e-01 1.57495006e-09 1.65025338e-09
   1.57718361e-09]
  ...
  [4.78571519e-06 9.99995232e-01 8.44979815e-12 1.86632116e-11
   8.55972931e-12]
  [5.49673557e-01 4.50326473e-01 1.93690974e-09 2.16699059e-09
   1.98881533e-09]
  [7.99070358e-01 2.00929612e-01 1.53962754e-09 1.60591684e-09
   1.53728885e-09]]

 [[1.66380527e-08 1.00000000e+00 5.02659763e-13 1.45276965e-12
   4.61696057e-13]
  [3.79475136e-06 9.99996185e-01 7.98031866e-12 1.81929645e-11
   9.07746447e-12]
  [6.67760491e-01 3.32239509e-01 1.82464299e-09 1.98248329e-09
   1.85506044e-09]
  ...
  [2.95004249e-01 7.04995751e-01 1.78178050e-09 2.11873563e-09
   1.85769844e-09]
  [5.33583737e-08 1.00000000e+00 9.03081538e-13 2.55023476e-12
   9.05396092e-13]
  [2.71802455e-01 7.28197515e-01 1.75445003e-09 2.10493467e-09
   1.85322058e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.05818542e-08 9.99999881e-01 9.57517052e-13 2.59512767e-12
  8.98231901e-13]
 [5.37579836e-16 1.00000000e+00 1.02496810e-16 7.85217436e-16
  1.06515604e-16]
 [3.12065906e-19 1.00000000e+00 2.61213835e-18 2.95292725e-17
  2.86508874e-18]
 ...
 [2.95004249e-01 7.04995751e-01 1.78178050e-09 2.11873563e-09
  1.85769844e-09]
 [5.33583737e-08 1.00000000e+00 9.03081538e-13 2.55023476e-12
  9.05396092e-13]
 [2.71802455e-01 7.28197515e-01 1.75445003e-09 2.10493467e-09
  1.85322058e-09]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.357276106262207
tp :  19957.0
fp :  80043.0
tn :  319957.0
fn :  80043.0
accuracy :  0.6798311471939087
precision :  0.19957000017166138
recall :  0.19957000017166138
auc :  0.564246416091919

y_eval {0: 100000}
pred {0: 19957, 1: 80043}
[INFO] confusion matrix for file 
[[19957 80043     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 289184 1079860       0       0       0]
 [      0  101102       0       0       0]
 [   5967   21085       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-0.34653556  0.          0.         ...  3.          0.00482
   1.45442   ]
 [-0.34653556  0.          0.         ...  2.          0.00482
  -0.33484   ]
 [-0.34653556  0.          0.         ...  1.          0.00482
  -0.32151   ]
 ...
 [ 0.34700835  0.          0.         ...  4.          0.00482
  -0.23351   ]
 [ 0.34700835  0.          0.         ...  2.          0.00482
  -0.33484   ]
 [ 0.34700835  0.          0.         ...  3.          0.00482
   1.45442   ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.63338996e-08 1.00000000e+00 4.98058788e-13 1.44078792e-12
   4.57336588e-13]
  [3.51300533e-03 9.96487021e-01 2.39383513e-10 3.74961756e-10
   2.74130163e-10]
  [7.92233825e-01 2.07766220e-01 1.56080393e-09 1.63251379e-09
   1.56169744e-09]
  ...
  [3.64467468e-07 9.99999642e-01 2.32727292e-12 5.90455245e-12
   2.33030218e-12]
  [2.09357474e-14 1.00000000e+00 6.27677513e-16 4.00247632e-15
   6.59282536e-16]
  [9.52431292e-04 9.99047577e-01 1.28945604e-10 2.19764318e-10
   1.55800275e-10]]

 [[9.93472749e-10 1.00000000e+00 1.23494476e-13 4.09697477e-13
   1.08547428e-13]
  [7.16213249e-14 1.00000000e+00 1.15207355e-15 6.82146634e-15
   1.17949772e-15]
  [2.28173882e-02 9.77182567e-01 6.06956652e-10 8.58218385e-10
   6.90520474e-10]
  ...
  [7.23511159e-01 2.76488841e-01 1.72003689e-09 1.83665705e-09
   1.72356074e-09]
  [3.78366679e-01 6.21633351e-01 1.86803750e-09 2.16351315e-09
   1.89458715e-09]
  [1.60357025e-08 1.00000000e+00 4.94245107e-13 1.49009733e-12
   4.90329619e-13]]

 [[9.98191720e-12 1.00000000e+00 1.25776016e-14 5.20839102e-14
   1.05265934e-14]
  [3.05509639e-05 9.99969482e-01 2.27488636e-11 4.64892708e-11
   2.67967367e-11]
  [1.53704136e-07 9.99999881e-01 1.57539097e-12 4.25436726e-12
   1.71242079e-12]
  ...
  [7.61857688e-01 2.38142252e-01 1.63685099e-09 1.72789993e-09
   1.63490410e-09]
  [7.45292544e-01 2.54707485e-01 1.67507519e-09 1.77742077e-09
   1.67693248e-09]
  [6.39645219e-01 3.60354781e-01 1.84723381e-09 2.01566386e-09
   1.85707583e-09]]

 ...

 [[9.97908041e-02 9.00209129e-01 1.15363075e-09 1.46213597e-09
   1.18184917e-09]
  [6.98998576e-07 9.99999285e-01 3.27204800e-12 8.03798000e-12
   3.36083526e-12]
  [2.44796043e-04 9.99755204e-01 6.32758498e-11 1.14605520e-10
   7.14128132e-11]
  ...
  [7.71944713e-08 9.99999881e-01 1.09014306e-12 3.02461073e-12
   1.11132197e-12]
  [3.19877893e-01 6.80122077e-01 1.83591842e-09 2.17323648e-09
   1.93131711e-09]
  [1.47224799e-09 1.00000000e+00 1.51049935e-13 5.18783096e-13
   1.46266137e-13]]

 [[1.58336295e-11 1.00000000e+00 1.58095227e-14 6.40287519e-14
   1.32756279e-14]
  [9.84859069e-12 1.00000000e+00 1.32374987e-14 6.02493451e-14
   1.35368986e-14]
  [1.66192960e-17 1.00000000e+00 1.85570046e-17 1.73219323e-16
   2.01490477e-17]
  ...
  [7.39523470e-01 2.60476530e-01 1.68778769e-09 1.79387039e-09
   1.68845415e-09]
  [2.64177470e-06 9.99997377e-01 6.26953264e-12 1.42897560e-11
   6.39759122e-12]
  [1.37643612e-04 9.99862313e-01 4.76325854e-11 8.91419299e-11
   5.40711295e-11]]

 [[1.29813924e-01 8.70186090e-01 1.29833200e-09 1.62413671e-09
   1.36036782e-09]
  [3.35371774e-03 9.96646225e-01 2.25664057e-10 3.49786727e-10
   2.42442288e-10]
  [4.64010611e-03 9.95359957e-01 2.66713429e-10 4.07008344e-10
   2.87104451e-10]
  ...
  [3.42820428e-15 1.00000000e+00 2.57853955e-16 1.81433377e-15
   2.75615177e-16]
  [1.47136124e-02 9.85286355e-01 4.94156771e-10 7.19048765e-10
   5.71376224e-10]
  [6.41486347e-02 9.35851395e-01 9.51344559e-10 1.24708655e-09
   9.88900295e-10]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.6333900e-08 1.0000000e+00 4.9805879e-13 1.4407879e-12 4.5733659e-13]
 [3.5130053e-03 9.9648702e-01 2.3938351e-10 3.7496176e-10 2.7413016e-10]
 [7.9223382e-01 2.0776622e-01 1.5608039e-09 1.6325138e-09 1.5616974e-09]
 ...
 [3.4282043e-15 1.0000000e+00 2.5785396e-16 1.8143338e-15 2.7561518e-16]
 [1.4713612e-02 9.8528636e-01 4.9415677e-10 7.1904876e-10 5.7137622e-10]
 [6.4148635e-02 9.3585140e-01 9.5134456e-10 1.2470865e-09 9.8890029e-10]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  7.232746221923828
tp :  26885.0
fp :  73115.0
tn :  326885.0
fn :  73115.0
accuracy :  0.707542896270752
precision :  0.2688499987125397
recall :  0.2688499987125397
auc :  0.6164274215698242

y_eval {0: 92639, 1: 7361}
pred {0: 19524, 1: 80476}
[INFO] confusion matrix for file 
[[19524 73115     0     0     0]
 [    0  7361     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 308708 1152975       0       0       0]
 [      0  108463       0       0       0]
 [   5967   21085       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4700835e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 3.4700835e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4700835e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [ 1.0380025e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0380025e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.0380025e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 1 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.27254143e-01 8.72745872e-01 1.28738820e-09 1.61247216e-09
   1.34917910e-09]
  [1.01870748e-04 9.99898076e-01 3.94714574e-11 7.40767794e-11
   4.22005902e-11]
  [8.94004315e-11 1.00000000e+00 3.90221438e-14 1.57844630e-13
   4.08769190e-14]
  ...
  [1.62577424e-02 9.83742237e-01 4.92808627e-10 6.99864056e-10
   5.22243970e-10]
  [1.00503918e-10 1.00000000e+00 4.03554821e-14 1.61078833e-13
   3.98666153e-14]
  [3.82322350e-17 1.00000000e+00 2.81487743e-17 2.52828985e-16
   3.11656972e-17]]

 [[7.14664161e-11 1.00000000e+00 3.33965745e-14 1.25902815e-13
   2.84794330e-14]
  [1.13113281e-07 9.99999881e-01 1.39155115e-12 3.84486453e-12
   1.55866541e-12]
  [4.77060582e-03 9.95229363e-01 2.75351603e-10 4.22510499e-10
   3.07410208e-10]
  ...
  [2.04795778e-01 7.95204222e-01 1.55785695e-09 1.89462734e-09
   1.60393676e-09]
  [7.55253375e-01 2.44746611e-01 1.65420488e-09 1.75061443e-09
   1.65756220e-09]
  [6.84106070e-08 9.99999881e-01 1.01015778e-12 2.80823975e-12
   9.95453177e-13]]

 [[1.48532246e-11 1.00000000e+00 1.53163073e-14 6.22206957e-14
   1.28545220e-14]
  [1.27550063e-03 9.98724520e-01 1.45626358e-10 2.42114717e-10
   1.70884321e-10]
  [7.71531284e-01 2.28468731e-01 1.61676983e-09 1.70305314e-09
   1.62232072e-09]
  ...
  [4.23583359e-01 5.76416612e-01 1.92822514e-09 2.22113106e-09
   1.99738381e-09]
  [1.92864519e-02 9.80713546e-01 5.30989808e-10 7.43839101e-10
   5.49523871e-10]
  [7.13925898e-01 2.86074102e-01 1.74275594e-09 1.86767246e-09
   1.75564752e-09]]

 ...

 [[4.06063974e-01 5.93936086e-01 1.89240423e-09 2.17589768e-09
   1.94562433e-09]
  [3.20496690e-03 9.96794999e-01 2.19670240e-10 3.40848322e-10
   2.34908371e-10]
  [2.63858400e-03 9.97361362e-01 2.01654124e-10 3.17587928e-10
   2.17688131e-10]
  ...
  [2.18921248e-03 9.97810781e-01 1.80533200e-10 2.85354379e-10
   1.88461372e-10]
  [6.19116761e-02 9.38088298e-01 9.42790845e-10 1.24189692e-09
   9.97222527e-10]
  [7.63147533e-01 2.36852422e-01 1.63685687e-09 1.72859171e-09
   1.64230141e-09]]

 [[1.09773335e-13 1.00000000e+00 1.35074375e-15 6.91716327e-15
   1.10629120e-15]
  [7.97252710e-07 9.99999166e-01 3.66215088e-12 9.06887326e-12
   3.93679794e-12]
  [3.00095320e-01 6.99904680e-01 1.79551596e-09 2.13304974e-09
   1.88508631e-09]
  ...
  [6.88529946e-03 9.93114650e-01 3.20069554e-10 4.75411877e-10
   3.35085987e-10]
  [7.13469684e-01 2.86530256e-01 1.74411896e-09 1.86940419e-09
   1.75702719e-09]
  [1.16781570e-01 8.83218408e-01 1.23940358e-09 1.56366309e-09
   1.28161792e-09]]

 [[2.12936357e-07 9.99999762e-01 1.79302753e-12 4.56293727e-12
   1.71785101e-12]
  [1.52314166e-02 9.84768510e-01 4.90837426e-10 7.06342318e-10
   5.48600554e-10]
  [2.75254708e-09 1.00000000e+00 2.08820794e-13 6.96653022e-13
   2.12183298e-13]
  ...
  [6.17308482e-10 1.00000000e+00 1.09208019e-13 4.10727902e-13
   1.36584117e-13]
  [4.83415127e-02 9.51658487e-01 8.57900084e-10 1.15623766e-09
   9.42330325e-10]
  [2.33180079e-04 9.99766767e-01 5.94020458e-11 1.06412504e-10
   6.22352378e-11]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.27254143e-01 8.72745872e-01 1.28738820e-09 1.61247216e-09
  1.34917910e-09]
 [1.01870748e-04 9.99898076e-01 3.94714574e-11 7.40767794e-11
  4.22005902e-11]
 [8.94004315e-11 1.00000000e+00 3.90221438e-14 1.57844630e-13
  4.08769190e-14]
 ...
 [6.17308482e-10 1.00000000e+00 1.09208019e-13 4.10727902e-13
  1.36584117e-13]
 [4.83415127e-02 9.51658487e-01 8.57900084e-10 1.15623766e-09
  9.42330325e-10]
 [2.33180079e-04 9.99766767e-01 5.94020458e-11 1.06412504e-10
  6.22352378e-11]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  5.8849150024414065
tp :  37194.0
fp :  62806.0
tn :  337194.0
fn :  62806.0
accuracy :  0.7487785816192627
precision :  0.3719399869441986
recall :  0.3719399869441986
auc :  0.683262825012207

y_eval {0: 82798, 1: 17202}
pred {0: 19992, 1: 80008}
[INFO] confusion matrix for file 
[[19992 62806     0     0     0]
 [    0 17202     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 328700 1215781       0       0       0]
 [      0  125665       0       0       0]
 [   5967   21085       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0380025e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.0380025e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0380025e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 ...
 [ 1.7315464e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.7315464e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.7315464e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.00905253e-02 9.89909530e-01 3.84422910e-10 5.53271318e-10
   3.89864974e-10]
  [1.81696237e-07 9.99999762e-01 1.68071568e-12 4.44663143e-12
   1.71014234e-12]
  [4.02025819e-01 5.97974181e-01 1.92093186e-09 2.22614083e-09
   2.00200345e-09]
  ...
  [9.25186351e-02 9.07481372e-01 1.15959453e-09 1.50253421e-09
   1.26634714e-09]
  [9.17616308e-06 9.99990821e-01 1.17586166e-11 2.51185375e-11
   1.21366884e-11]
  [5.19467175e-01 4.80532825e-01 1.94557681e-09 2.19091545e-09
   1.99964356e-09]]

 [[1.16145927e-02 9.88385439e-01 4.15211948e-10 5.97147276e-10
   4.43428849e-10]
  [5.79126136e-05 9.99942064e-01 3.00382150e-11 5.83057838e-11
   3.24143212e-11]
  [2.54287897e-05 9.99974608e-01 2.01602467e-11 4.11502048e-11
   2.21379408e-11]
  ...
  [1.94152983e-09 1.00000000e+00 1.72814996e-13 5.83759820e-13
   1.68721292e-13]
  [1.48088577e-06 9.99998569e-01 5.18641120e-12 1.26369254e-11
   6.57116072e-12]
  [1.37792430e-10 1.00000000e+00 4.85019129e-14 1.92578849e-13
   5.08578843e-14]]

 [[1.53626452e-11 1.00000000e+00 1.55752283e-14 6.31626912e-14
   1.30750945e-14]
  [9.69121561e-10 1.00000000e+00 1.29367789e-13 4.60584316e-13
   1.35373700e-13]
  [1.54285058e-01 8.45714986e-01 1.43077139e-09 1.78942139e-09
   1.53716162e-09]
  ...
  [1.33624155e-07 9.99999881e-01 1.40872253e-12 3.77444083e-12
   1.39010266e-12]
  [1.70868705e-04 9.99829054e-01 5.34181067e-11 9.90052831e-11
   6.10330883e-11]
  [1.43629154e-11 1.00000000e+00 1.55835783e-14 6.95465820e-14
   1.56068700e-14]]

 ...

 [[1.23689603e-03 9.98763084e-01 1.35151793e-10 2.17313237e-10
   1.34537104e-10]
  [4.05088842e-01 5.94911158e-01 1.91005745e-09 2.20704166e-09
   1.98713446e-09]
  [3.17398697e-01 6.82601333e-01 1.79634296e-09 2.11469664e-09
   1.84995330e-09]
  ...
  [2.82780319e-01 7.17219651e-01 1.75879555e-09 2.09767625e-09
   1.83523519e-09]
  [7.72489130e-01 2.27510810e-01 1.61222924e-09 1.69688774e-09
   1.61328118e-09]
  [7.48332858e-01 2.51667142e-01 1.66759173e-09 1.76744253e-09
   1.66611658e-09]]

 [[1.00020853e-10 1.00000000e+00 3.94585589e-14 1.46324738e-13
   3.37418116e-14]
  [4.00644839e-02 9.59935546e-01 7.86612886e-10 1.07211295e-09
   8.78300377e-10]
  [3.78504731e-02 9.62149501e-01 7.40535799e-10 1.00188946e-09
   7.87852894e-10]
  ...
  [7.60504484e-01 2.39495471e-01 1.64209801e-09 1.73511572e-09
   1.64587333e-09]
  [7.49009609e-01 2.50990361e-01 1.66603675e-09 1.76541726e-09
   1.66431846e-09]
  [5.74544359e-08 1.00000000e+00 9.28813558e-13 2.60827297e-12
   9.24740861e-13]]

 [[9.86777465e-11 1.00000000e+00 3.91945286e-14 1.45440463e-13
   3.35111747e-14]
  [3.96545157e-02 9.60345447e-01 7.82800547e-10 1.06758047e-09
   8.74243733e-10]
  [1.51204333e-01 8.48795712e-01 1.38810174e-09 1.72635783e-09
   1.45555357e-09]
  ...
  [4.71877633e-03 9.95281160e-01 2.64440303e-10 4.00797284e-10
   2.78030071e-10]
  [8.96236816e-05 9.99910355e-01 3.72753946e-11 7.06753128e-11
   4.00433263e-11]
  [3.89561473e-12 1.00000000e+00 8.20653546e-15 3.93551362e-14
   8.36162973e-15]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.0090525e-02 9.8990953e-01 3.8442291e-10 5.5327132e-10 3.8986497e-10]
 [1.8169624e-07 9.9999976e-01 1.6807157e-12 4.4466314e-12 1.7101423e-12]
 [4.0202582e-01 5.9797418e-01 1.9209319e-09 2.2261408e-09 2.0020035e-09]
 ...
 [4.7187763e-03 9.9528116e-01 2.6444030e-10 4.0079728e-10 2.7803007e-10]
 [8.9623682e-05 9.9991035e-01 3.7275395e-11 7.0675313e-11 4.0043326e-11]
 [3.8956147e-12 1.0000000e+00 8.2065355e-15 3.9355136e-14 8.3616297e-15]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.099559130859374
tp :  20875.0
fp :  79125.0
tn :  320875.0
fn :  79125.0
accuracy :  0.6835031509399414
precision :  0.20874999463558197
recall :  0.20874999463558197
auc :  0.5564192533493042

y_eval {0: 100000}
pred {0: 20875, 1: 79125}
[INFO] confusion matrix for file 
[[20875 79125     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 349575 1294906       0       0       0]
 [      0  125665       0       0       0]
 [   5967   21085       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-01_151435_117.log.part03_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1365 (0.273%)
[INFO] ** orig:[0:99.9976%,2:0.0024%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9966%,3:0.0034%]
[INFO] ** i/f_dir:[1:99.9966%,0:0.0034%]
[INFO] ** src:[22:38.1462%,9:26.099%,7:18.1904%,1:17.5592%,21:0.0028%,14:0.001%,3:0.0006%,15:0.0004%,2:0.0004%]
[INFO] ** dst:[21:43.376%,10:20.8688%,8:18.1902%,9:17.5592%,15:0.0034%,22:0.0008%,18:0.0004%,16:0.0004%,6:0.0004%,24:0.0002%,2:0.0002%]
[INFO] ** proto:[0:99.9958%,1:0.0034%,2:0.0008%]
[INFO] ** appi_name:[21:99.9952%,30:0.0034%,7:0.0006%,31:0.0004%,26:0.0002%,22:0.0002%]
[INFO] ** proxy_src_ip:[18:38.1462%,20:26.099%,13:18.1904%,6:17.5592%,17:0.0034%,1:0.0006%,16:0.0004%,14:0.0004%,7:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.9952%,-33.760870000000004:0.0048%]
[INFO] ** modbus_function_description:[7:49.9978%,11:49.9974%,0:0.0048%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.0982%,1:20.8688%,5:18.19%,4:17.5588%,2:17.2772%,0:0.007%]
[INFO] ** service:[0.0048200000000000005:99.9952%,-211.73542999999998:0.0034%,-211.09762999999998:0.0006%,-186.43601999999998:0.0004%,-211.08346:0.0002%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:26.0986%,-0.32151:20.8688%,-1.27613:18.1902%,-0.23351:17.559%,-0.33484:17.2774%,-71.33197:0.0034%,-1.02014:0.0004%,-71.14931:0.0002%,-0.24151:0.0002%,4.42897:0.0002%,-71.14798:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,-0.78282:0.0002%,-2.92807:0.0002%,-4.88132:0.0002%,1.45709:0.0002%,9.18344:0.0002%]
[INFO] ** classification:[normal:84.2104%,Single Stage Single Point:15.7896%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7315832e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.7315832e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.7315832e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [-1.0377140e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0377140e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0377140e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 1 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.8755851e-04 9.9981242e-01 5.3084582e-11 9.5188163e-11 5.5630146e-11]
  [2.3861514e-16 1.0000000e+00 6.8235677e-17 5.4348943e-16 7.0979594e-17]
  [2.5037540e-19 1.0000000e+00 2.3444642e-18 2.6758911e-17 2.5798159e-18]
  ...
  [9.1620853e-09 1.0000000e+00 3.7329002e-13 1.1592169e-12 3.6702355e-13]
  [2.9328914e-15 1.0000000e+00 2.3953626e-16 1.7018492e-15 2.5788839e-16]
  [4.5936211e-17 1.0000000e+00 3.0990358e-17 2.7770481e-16 3.5137984e-17]]

 [[4.5905372e-07 9.9999952e-01 2.6310360e-12 6.4401622e-12 2.5515766e-12]
  [1.9763886e-04 9.9980241e-01 5.6904072e-11 1.0430588e-10 6.4690669e-11]
  [7.1785671e-01 2.8214327e-01 1.7379055e-09 1.8616114e-09 1.7552282e-09]
  ...
  [1.8230543e-01 8.1769454e-01 1.5306808e-09 1.8936241e-09 1.6356351e-09]
  [7.5988410e-08 9.9999988e-01 1.0715975e-12 2.9665450e-12 1.0431942e-12]
  [7.4371864e-15 1.0000000e+00 3.7696278e-16 2.5413936e-15 3.9777707e-16]]

 [[1.8048227e-04 9.9981958e-01 5.2073894e-11 9.3565378e-11 5.4552887e-11]
  [7.5805411e-02 9.2419457e-01 1.0436237e-09 1.3622458e-09 1.1246896e-09]
  [6.9984162e-01 3.0015838e-01 1.7659899e-09 1.8994284e-09 1.7797254e-09]
  ...
  [1.5184800e-14 1.0000000e+00 5.3883429e-16 3.5165509e-15 5.7922606e-16]
  [6.1407539e-18 1.0000000e+00 1.1408851e-17 1.1297252e-16 1.2720504e-17]
  [1.1702932e-07 9.9999988e-01 1.5318220e-12 4.3804162e-12 2.1431264e-12]]

 ...

 [[8.9623578e-02 9.1037643e-01 1.1012984e-09 1.4069764e-09 1.1430699e-09]
  [1.5593750e-10 1.0000000e+00 5.0099976e-14 1.9414258e-13 4.9259130e-14]
  [4.2638732e-03 9.9573612e-01 2.6637997e-10 4.1420165e-10 3.0755853e-10]
  ...
  [7.3107213e-01 2.6892793e-01 1.7070864e-09 1.8199728e-09 1.7151740e-09]
  [6.9678330e-01 3.0321670e-01 1.7676407e-09 1.9010153e-09 1.7715188e-09]
  [6.4438844e-01 3.5561156e-01 1.8423936e-09 2.0083855e-09 1.8545820e-09]]

 [[1.8831847e-09 1.0000000e+00 1.6979083e-13 5.4613177e-13 1.5072905e-13]
  [4.1427468e-17 1.0000000e+00 2.8953707e-17 2.5252921e-16 3.0236343e-17]
  [1.4585012e-18 1.0000000e+00 5.6190164e-18 5.8849983e-17 6.2780138e-18]
  ...
  [6.8329370e-01 3.1670627e-01 1.7898194e-09 1.9319553e-09 1.7964681e-09]
  [4.5954010e-01 5.4045993e-01 1.9201269e-09 2.1836049e-09 1.9477067e-09]
  [1.9304640e-08 1.0000000e+00 5.4104106e-13 1.6140246e-12 5.3507649e-13]]

 [[7.4297130e-02 9.2570281e-01 1.0146024e-09 1.3138950e-09 1.0727155e-09]
  [8.6758679e-15 1.0000000e+00 3.9796072e-16 2.6101502e-15 4.0373915e-16]
  [3.7553124e-19 1.0000000e+00 2.8623468e-18 3.2097893e-17 3.1409638e-18]
  ...
  [3.3860354e-07 9.9999964e-01 2.2506465e-12 5.7398981e-12 2.2655961e-12]
  [3.2192937e-01 6.7807066e-01 1.8375342e-09 2.1741993e-09 1.9295801e-09]
  [5.3939116e-01 4.6060887e-01 1.9228399e-09 2.1496989e-09 1.9518800e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.8755851e-04 9.9981242e-01 5.3084582e-11 9.5188163e-11 5.5630146e-11]
 [2.3861514e-16 1.0000000e+00 6.8235677e-17 5.4348943e-16 7.0979594e-17]
 [2.5037540e-19 1.0000000e+00 2.3444642e-18 2.6758911e-17 2.5798159e-18]
 ...
 [3.3860354e-07 9.9999964e-01 2.2506465e-12 5.7398981e-12 2.2655961e-12]
 [3.2192937e-01 6.7807066e-01 1.8375342e-09 2.1741993e-09 1.9295801e-09]
 [5.3939116e-01 4.6060887e-01 1.9228399e-09 2.1496989e-09 1.9518800e-09]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  3.6781524208068848
tp :  50525.0
fp :  49475.0
tn :  350525.0
fn :  49475.0
accuracy :  0.8021017909049988
precision :  0.5052499771118164
recall :  0.5052499771118164
auc :  0.7814171314239502

y_eval {0: 70708, 1: 29292}
pred {0: 21233, 1: 78767}
[INFO] confusion matrix for file 
[[21233 49475     0     0     0]
 [    0 29292     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 370808 1344381       0       0       0]
 [      0  154957       0       0       0]
 [   5967   21085       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.037714e+00  0.000000e+00  0.000000e+00 ...  5.000000e+00
   4.820000e-03 -1.276130e+00]
 [-1.037714e+00  0.000000e+00  0.000000e+00 ...  3.000000e+00
   4.820000e-03  1.454420e+00]
 [-1.037714e+00  0.000000e+00  0.000000e+00 ...  4.000000e+00
   4.820000e-03 -2.335100e-01]
 ...
 [-3.463864e-01  0.000000e+00  0.000000e+00 ...  5.000000e+00
   4.820000e-03 -1.276130e+00]
 [-3.463864e-01  0.000000e+00  0.000000e+00 ...  2.000000e+00
   4.820000e-03 -3.348400e-01]
 [-3.463864e-01  0.000000e+00  0.000000e+00 ...  3.000000e+00
   4.820000e-03  1.454420e+00]] shape (100000, 16)
y_test [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [1 0 1 ... 1 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[2.18801518e-12 1.00000000e+00 5.93048255e-15 2.63861317e-14
   4.91088188e-15]
  [1.21926227e-04 9.99878049e-01 4.53158795e-11 8.58579111e-11
   5.34021820e-11]
  [6.24071237e-12 1.00000000e+00 1.03380829e-14 4.82761617e-14
   1.06300975e-14]
  ...
  [1.83780120e-08 1.00000000e+00 5.28986902e-13 1.58243210e-12
   5.25720906e-13]
  [1.66201741e-01 8.33798289e-01 1.47756329e-09 1.84008520e-09
   1.58435964e-09]
  [6.50593936e-01 3.49406064e-01 1.83794235e-09 2.00207784e-09
   1.85720062e-09]]

 [[7.20184594e-02 9.27981555e-01 1.00018982e-09 1.29762201e-09
   1.05776787e-09]
  [3.25658582e-02 9.67434168e-01 6.92607749e-10 9.46021927e-10
   7.38946848e-10]
  [1.24819304e-11 1.00000000e+00 1.43874052e-14 6.42619503e-14
   1.43078806e-14]
  ...
  [2.88022056e-06 9.99997139e-01 7.40244758e-12 1.76092786e-11
   9.74091814e-12]
  [1.52994869e-02 9.84700561e-01 4.85794793e-10 6.96180835e-10
   5.25004928e-10]
  [6.61550343e-01 3.38449597e-01 1.82650373e-09 1.98486072e-09
   1.84572302e-09]]

 [[2.81820609e-11 1.00000000e+00 2.10434392e-14 8.29365263e-14
   1.77713950e-14]
  [4.93492524e-04 9.99506474e-01 9.11063655e-11 1.59878361e-10
   1.08321990e-10]
  [7.19625056e-01 2.80374974e-01 1.73333026e-09 1.85542537e-09
   1.74979597e-09]
  ...
  [5.95464110e-01 4.04535919e-01 1.89668681e-09 2.09525264e-09
   1.92962601e-09]
  [5.82114995e-01 4.17885035e-01 1.89931426e-09 2.10126672e-09
   1.91692529e-09]
  [7.49288678e-01 2.50711322e-01 1.66685465e-09 1.76684667e-09
   1.66973113e-09]]

 ...

 [[7.43545985e-14 1.00000000e+00 1.11433018e-15 5.81140750e-15
   9.12109536e-16]
  [5.02453037e-02 9.49754715e-01 8.77310669e-10 1.18265542e-09
   9.79254122e-10]
  [1.02856688e-10 1.00000000e+00 4.07917888e-14 1.62645315e-13
   4.09451966e-14]
  ...
  [1.46044955e-01 8.53955030e-01 1.39804779e-09 1.75544212e-09
   1.49910262e-09]
  [7.17760921e-01 2.82239050e-01 1.73322479e-09 1.85462257e-09
   1.74140957e-09]
  [2.56533794e-09 1.00000000e+00 1.98184785e-13 6.59018250e-13
   1.92821426e-13]]

 [[2.86903888e-01 7.13096142e-01 1.74552484e-09 2.06765760e-09
   1.81201465e-09]
  [5.94090462e-01 4.05909538e-01 1.89606908e-09 2.09397477e-09
   1.93085636e-09]
  [5.43246150e-01 4.56753850e-01 1.91938332e-09 2.14287343e-09
   1.94609084e-09]
  ...
  [4.00868744e-01 5.99131227e-01 1.92463046e-09 2.23240604e-09
   2.00993688e-09]
  [5.99633932e-01 4.00366038e-01 1.88917948e-09 2.08314521e-09
   1.91388549e-09]
  [7.49442935e-01 2.50557065e-01 1.66599623e-09 1.76560000e-09
   1.66660963e-09]]

 [[6.26660224e-10 1.00000000e+00 9.82048102e-14 3.33208775e-13
   8.58130705e-14]
  [1.81312993e-15 1.00000000e+00 1.87329754e-16 1.34551364e-15
   1.93742031e-16]
  [5.61721293e-19 1.00000000e+00 3.49101693e-18 3.83949050e-17
   3.82470944e-18]
  ...
  [2.15042817e-07 9.99999762e-01 1.81173566e-12 4.75434319e-12
   1.83749912e-12]
  [3.45459968e-01 6.54540062e-01 1.86736071e-09 2.19522067e-09
   1.95547356e-09]
  [3.96367490e-01 6.03632510e-01 1.88858307e-09 2.18103868e-09
   1.93169614e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[2.18801518e-12 1.00000000e+00 5.93048255e-15 2.63861317e-14
  4.91088188e-15]
 [1.21926227e-04 9.99878049e-01 4.53158795e-11 8.58579111e-11
  5.34021820e-11]
 [6.24071237e-12 1.00000000e+00 1.03380829e-14 4.82761617e-14
  1.06300975e-14]
 ...
 [2.15042817e-07 9.99999762e-01 1.81173566e-12 4.75434319e-12
  1.83749912e-12]
 [3.45459968e-01 6.54540062e-01 1.86736071e-09 2.19522067e-09
  1.95547356e-09]
 [3.96367490e-01 6.03632510e-01 1.88858307e-09 2.18103868e-09
  1.93169614e-09]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  2.6944669788360596
tp :  55501.0
fp :  44499.0
tn :  355501.0
fn :  44499.0
accuracy :  0.8220056295394897
precision :  0.5550100207328796
recall :  0.5550100207328796
auc :  0.8274093866348267

y_eval {0: 64215, 1: 35785}
pred {0: 19716, 1: 80284}
[INFO] confusion matrix for file 
[[19716 44499     0     0     0]
 [    0 35785     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 390524 1388880       0       0       0]
 [      0  190742       0       0       0]
 [   5967   21085       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4638640e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4638640e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4638640e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [ 3.4494117e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4494117e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4494117e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 1 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.48421631e-03 9.98515785e-01 1.48928717e-10 2.38898790e-10
   1.56534466e-10]
  [1.53203607e-01 8.46796393e-01 1.41131073e-09 1.75948611e-09
   1.49973867e-09]
  [7.63509589e-10 1.00000000e+00 1.09771242e-13 3.91446424e-13
   1.09095804e-13]
  ...
  [5.74989768e-04 9.99425054e-01 1.01487006e-10 1.78773482e-10
   1.25575023e-10]
  [4.32955325e-02 9.56704497e-01 7.94908750e-10 1.06843301e-09
   8.35225722e-10]
  [7.07887082e-09 1.00000000e+00 3.33801617e-13 1.05547905e-12
   3.36818355e-13]]

 [[1.43514469e-03 9.98564899e-01 1.46450629e-10 2.35345687e-10
   1.53907206e-10]
  [1.51179597e-01 8.48820329e-01 1.40378187e-09 1.75168957e-09
   1.49216484e-09]
  [7.61534558e-10 1.00000000e+00 1.09634815e-13 3.91024046e-13
   1.08970192e-13]
  ...
  [3.69613562e-10 1.00000000e+00 7.78314452e-14 2.91146935e-13
   7.92629105e-14]
  [1.21781930e-01 8.78218055e-01 1.30426181e-09 1.66022796e-09
   1.41406786e-09]
  [2.86247075e-01 7.13752925e-01 1.74846237e-09 2.07650896e-09
   1.79874227e-09]]

 [[7.76139049e-12 1.00000000e+00 1.11029977e-14 4.65299186e-14
   9.27407057e-15]
  [2.44897983e-05 9.99975562e-01 2.03699922e-11 4.21307537e-11
   2.39406325e-11]
  [6.66360080e-01 3.33639890e-01 1.82512105e-09 1.98314654e-09
   1.85495186e-09]
  ...
  [3.38719413e-03 9.96612847e-01 2.36615005e-10 3.72036124e-10
   2.70485800e-10]
  [2.86692475e-11 1.00000000e+00 2.17555364e-14 9.32110563e-14
   2.14808436e-14]
  [5.44714369e-02 9.45528507e-01 9.14558096e-10 1.22657839e-09
   1.01636899e-09]]

 ...

 [[6.37714326e-01 3.62285703e-01 1.84925708e-09 2.01754835e-09
   1.87574001e-09]
  [1.50903143e-05 9.99984860e-01 1.50706218e-11 3.12890269e-11
   1.57989385e-11]
  [1.58637902e-03 9.98413563e-01 1.59341165e-10 2.59660404e-10
   1.77247370e-10]
  ...
  [2.21764864e-08 1.00000000e+00 5.90682668e-13 1.76024354e-12
   5.98317294e-13]
  [1.56758296e-16 1.00000000e+00 5.61623343e-17 4.67421103e-16
   6.08855488e-17]
  [2.06950679e-03 9.97930527e-01 1.90651231e-10 3.11826898e-10
   2.31593092e-10]]

 [[1.03973101e-10 1.00000000e+00 4.02220032e-14 1.48840657e-13
   3.43879554e-14]
  [1.20678591e-02 9.87932146e-01 4.41221393e-10 6.45423270e-10
   5.04136732e-10]
  [6.63698018e-01 3.36302012e-01 1.82260695e-09 1.97969707e-09
   1.84671700e-09]
  ...
  [2.36756906e-01 7.63243079e-01 1.65654845e-09 2.00063099e-09
   1.72508940e-09]
  [4.73225157e-08 1.00000000e+00 8.46365729e-13 2.40627527e-12
   8.36262754e-13]
  [4.52909619e-01 5.47090411e-01 1.95076622e-09 2.23508034e-09
   2.02900985e-09]]

 [[1.00968317e-10 1.00000000e+00 3.96405829e-14 1.46896872e-13
   3.38804641e-14]
  [1.19560510e-02 9.88043964e-01 4.39226655e-10 6.42859599e-10
   5.01961916e-10]
  [5.22722399e-09 1.00000000e+00 2.87466448e-13 9.27114505e-13
   2.95453332e-13]
  ...
  [1.27040294e-05 9.99987245e-01 1.38422806e-11 2.90417534e-11
   1.44228796e-11]
  [2.21014488e-02 9.77898479e-01 5.84037485e-10 8.20698676e-10
   6.35969832e-10]
  [1.04863750e-10 1.00000000e+00 4.11801601e-14 1.63964098e-13
   4.03630241e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.48421631e-03 9.98515785e-01 1.48928717e-10 2.38898790e-10
  1.56534466e-10]
 [1.53203607e-01 8.46796393e-01 1.41131073e-09 1.75948611e-09
  1.49973867e-09]
 [7.63509589e-10 1.00000000e+00 1.09771242e-13 3.91446424e-13
  1.09095804e-13]
 ...
 [1.27040294e-05 9.99987245e-01 1.38422806e-11 2.90417534e-11
  1.44228796e-11]
 [2.21014488e-02 9.77898479e-01 5.84037485e-10 8.20698676e-10
  6.35969832e-10]
 [1.04863750e-10 1.00000000e+00 4.11801601e-14 1.63964098e-13
  4.03630241e-14]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  6.212371849060059
tp :  32863.0
fp :  67137.0
tn :  332863.0
fn :  67137.0
accuracy :  0.7314545512199402
precision :  0.3286300003528595
recall :  0.3286300003528595
auc :  0.6612145304679871

y_eval {0: 86129, 1: 13871}
pred {0: 18992, 1: 81008}
[INFO] confusion matrix for file 
[[18992 67137     0     0     0]
 [    0 13871     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 409516 1456017       0       0       0]
 [      0  204613       0       0       0]
 [   5967   21085       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 0.34494117  0.          0.         ...  4.          0.00482
  -0.23351   ]
 [ 0.34494117  0.          0.         ...  3.          0.00482
   1.45442   ]
 [ 0.34494117  0.          0.         ...  1.          0.00482
  -0.32151   ]
 ...
 [ 1.0388104   0.          0.         ...  3.          0.00482
   1.45442   ]
 [ 1.0388104   0.          0.         ...  2.          0.00482
  -0.33484   ]
 [ 1.0388104   0.          0.         ...  4.          0.00482
  -0.23351   ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.29622441e-13 1.00000000e+00 1.46621848e-15 7.44845791e-15
   1.20061584e-15]
  [1.56488575e-04 9.99843478e-01 5.10715220e-11 9.52207271e-11
   5.83759222e-11]
  [6.05147004e-01 3.94853026e-01 1.89365745e-09 2.08842166e-09
   1.93299998e-09]
  ...
  [2.50999648e-02 9.74900007e-01 6.21702190e-10 8.67814709e-10
   6.77943757e-10]
  [7.78767109e-01 2.21232936e-01 1.59741609e-09 1.67839065e-09
   1.59971514e-09]
  [3.87721926e-01 6.12278104e-01 1.87646809e-09 2.16846563e-09
   1.90141769e-09]]

 [[8.77226555e-14 1.00000000e+00 1.20912799e-15 6.25719882e-15
   9.89923064e-16]
  [5.05501335e-11 1.00000000e+00 2.99350117e-14 1.24511973e-13
   3.03606390e-14]
  [5.90158011e-09 1.00000000e+00 3.23645191e-13 1.05444885e-12
   3.71281917e-13]
  ...
  [8.47073214e-04 9.99152899e-01 1.11815397e-10 1.85850418e-10
   1.15618785e-10]
  [4.51192556e-10 1.00000000e+00 8.53543717e-14 3.14335716e-13
   8.44266063e-14]
  [2.73224339e-02 9.72677588e-01 6.57852439e-10 9.18364995e-10
   7.33491323e-10]]

 [[9.52532497e-11 1.00000000e+00 3.85103326e-14 1.43109998e-13
   3.28943653e-14]
  [8.49501323e-03 9.91504967e-01 3.71240788e-10 5.53944335e-10
   4.25515234e-10]
  [7.96509564e-01 2.03490436e-01 1.54837720e-09 1.61700997e-09
   1.54888236e-09]
  ...
  [2.74734546e-08 1.00000000e+00 6.41187353e-13 1.87242973e-12
   6.26231489e-13]
  [8.89791336e-05 9.99911070e-01 3.90871849e-11 7.54456289e-11
   4.65420064e-11]
  [6.79868937e-01 3.20131004e-01 1.80492254e-09 1.95420879e-09
   1.83085436e-09]]

 ...

 [[2.69831461e-03 9.97301698e-01 2.01164196e-10 3.13167714e-10
   2.14841006e-10]
  [2.49892334e-03 9.97501075e-01 1.97111508e-10 3.11731363e-10
   2.14933141e-10]
  [2.58469780e-04 9.99741495e-01 6.32238289e-11 1.13130588e-10
   6.82733037e-11]
  ...
  [1.20187353e-04 9.99879837e-01 4.21472163e-11 7.79847784e-11
   4.36253429e-11]
  [8.57778570e-11 1.00000000e+00 3.77330037e-14 1.52448800e-13
   3.75602395e-14]
  [3.86850373e-03 9.96131539e-01 2.53981502e-10 3.97338384e-10
   2.93036512e-10]]

 [[3.53093423e-11 1.00000000e+00 2.35327691e-14 9.17026126e-14
   1.98972495e-14]
  [2.58399471e-16 1.00000000e+00 7.16001781e-17 5.67431554e-16
   7.40386205e-17]
  [9.10622923e-13 1.00000000e+00 4.22666773e-15 2.23331350e-14
   5.03866781e-15]
  ...
  [7.79908478e-01 2.20091566e-01 1.59195601e-09 1.67106262e-09
   1.59010183e-09]
  [7.67444298e-02 9.23255622e-01 1.02505393e-09 1.32509215e-09
   1.05132170e-09]
  [9.42352330e-09 1.00000000e+00 3.81171250e-13 1.18501964e-12
   3.78682816e-13]]

 [[1.89173452e-13 1.00000000e+00 1.76731561e-15 8.82100196e-15
   1.44852851e-15]
  [3.26712074e-10 1.00000000e+00 7.55361756e-14 2.84475243e-13
   7.71957165e-14]
  [1.77393656e-06 9.99998212e-01 5.51006853e-12 1.31361085e-11
   6.40161275e-12]
  ...
  [3.97724919e-02 9.60227489e-01 7.53349993e-10 1.01270359e-09
   7.81269549e-10]
  [7.49404788e-01 2.50595212e-01 1.66922565e-09 1.77029513e-09
   1.67629266e-09]
  [1.24216655e-07 9.99999881e-01 1.35908526e-12 3.65640938e-12
   1.33866800e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.2962244e-13 1.0000000e+00 1.4662185e-15 7.4484579e-15 1.2006158e-15]
 [1.5648858e-04 9.9984348e-01 5.1071522e-11 9.5220727e-11 5.8375922e-11]
 [6.0514700e-01 3.9485303e-01 1.8936575e-09 2.0884217e-09 1.9330000e-09]
 ...
 [3.9772492e-02 9.6022749e-01 7.5334999e-10 1.0127036e-09 7.8126955e-10]
 [7.4940479e-01 2.5059521e-01 1.6692256e-09 1.7702951e-09 1.6762927e-09]
 [1.2421665e-07 9.9999988e-01 1.3590853e-12 3.6564094e-12 1.3386680e-12]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 1 0 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.289616796875
tp :  19775.0
fp :  80225.0
tn :  319775.0
fn :  80225.0
accuracy :  0.6791031360626221
precision :  0.1977500021457672
recall :  0.1977500021457672
auc :  0.5567717552185059

y_eval {0: 100000}
pred {0: 19775, 1: 80225}
[INFO] confusion matrix for file 
[[19775 80225     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 429291 1536242       0       0       0]
 [      0  204613       0       0       0]
 [   5967   21085       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0388104e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0388104e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.0388104e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [ 1.7326796e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.7326796e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.7326796e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[2.3275781e-10 1.0000000e+00 6.0031854e-14 2.1376386e-13 5.1856814e-14]
  [2.7206498e-13 1.0000000e+00 2.2377554e-15 1.2343789e-14 2.3095469e-15]
  [9.8718811e-18 1.0000000e+00 1.4391637e-17 1.3800822e-16 1.5824764e-17]
  ...
  [7.4032575e-01 2.5967425e-01 1.6869910e-09 1.7931537e-09 1.6912048e-09]
  [7.5249588e-01 2.4750413e-01 1.6584613e-09 1.7556613e-09 1.6570859e-09]
  [4.7490153e-02 9.5250988e-01 8.1985130e-10 1.0908081e-09 8.4836771e-10]]

 [[1.0733234e-13 1.0000000e+00 1.3358222e-15 6.8479560e-15 1.0940242e-15]
  [6.1413195e-02 9.3858677e-01 9.6241959e-10 1.2811686e-09 1.0679196e-09]
  [2.8241879e-01 7.1758127e-01 1.7427411e-09 2.0732940e-09 1.8125477e-09]
  ...
  [6.6266215e-01 3.3733788e-01 1.8232609e-09 1.9799691e-09 1.8390756e-09]
  [1.2793985e-01 8.7206012e-01 1.2887514e-09 1.6160928e-09 1.3280387e-09]
  [6.4854039e-04 9.9935144e-01 9.8880064e-11 1.6745033e-10 1.0435772e-10]]

 [[2.5520264e-03 9.9744797e-01 1.9565259e-10 3.0550201e-10 2.0892839e-10]
  [8.3839594e-05 9.9991620e-01 3.6301517e-11 6.9170204e-11 3.9493561e-11]
  [1.1780958e-13 1.0000000e+00 1.4568409e-15 8.4284649e-15 1.4998613e-15]
  ...
  [3.5548259e-03 9.9644524e-01 2.3559671e-10 3.6605091e-10 2.5585051e-10]
  [6.3165832e-01 3.6834165e-01 1.8643380e-09 2.0414601e-09 1.8893318e-09]
  [2.5180396e-02 9.7481954e-01 6.0495442e-10 8.3515644e-10 6.2950439e-10]]

 ...

 [[1.7958000e-02 9.8204201e-01 5.1071875e-10 7.1184747e-10 5.1468313e-10]
  [1.2967737e-01 8.7032259e-01 1.3108612e-09 1.6499877e-09 1.3966347e-09]
  [1.0639923e-01 8.9360082e-01 1.1942306e-09 1.5178401e-09 1.2466350e-09]
  ...
  [7.9029697e-01 2.0970303e-01 1.5633027e-09 1.6349185e-09 1.5578911e-09]
  [1.4379589e-01 8.5620409e-01 1.3525373e-09 1.6829323e-09 1.3909646e-09]
  [1.3630210e-08 1.0000000e+00 4.5694942e-13 1.3914664e-12 4.5350933e-13]]

 [[1.8430393e-11 1.0000000e+00 1.7048747e-14 6.8522973e-14 1.4334432e-14]
  [5.0470629e-03 9.9495292e-01 2.8777197e-10 4.4287535e-10 3.3391367e-10]
  [7.5395161e-01 2.4604842e-01 1.6588639e-09 1.7570658e-09 1.6673620e-09]
  ...
  [7.7653962e-01 2.2346036e-01 1.6035100e-09 1.6861051e-09 1.6070956e-09]
  [1.9967383e-02 9.8003262e-01 5.3871618e-10 7.5262280e-10 5.5669103e-10]
  [1.4772701e-02 9.8522723e-01 4.7047888e-10 6.7174050e-10 4.9897148e-10]]

 [[8.3503156e-11 1.0000000e+00 3.6076024e-14 1.3494781e-13 3.0789204e-14]
  [1.1990088e-16 1.0000000e+00 4.8990705e-17 4.0412900e-16 5.0875661e-17]
  [3.4517389e-19 1.0000000e+00 2.7492708e-18 3.0836350e-17 3.0283541e-18]
  ...
  [8.1280202e-01 1.8719794e-01 1.4979533e-09 1.5544553e-09 1.4927852e-09]
  [1.0563385e-03 9.9894363e-01 1.2478815e-10 2.0484343e-10 1.2861461e-10]
  [4.3216553e-02 9.5678341e-01 7.9749074e-10 1.0736324e-09 8.4840973e-10]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[2.3275781e-10 1.0000000e+00 6.0031854e-14 2.1376386e-13 5.1856814e-14]
 [2.7206498e-13 1.0000000e+00 2.2377554e-15 1.2343789e-14 2.3095469e-15]
 [9.8718811e-18 1.0000000e+00 1.4391637e-17 1.3800822e-16 1.5824764e-17]
 ...
 [8.1280202e-01 1.8719794e-01 1.4979533e-09 1.5544553e-09 1.4927852e-09]
 [1.0563385e-03 9.9894363e-01 1.2478815e-10 2.0484343e-10 1.2861461e-10]
 [4.3216553e-02 9.5678341e-01 7.9749074e-10 1.0736324e-09 8.4840973e-10]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 0 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.119160333251953
tp :  20788.0
fp :  79212.0
tn :  320788.0
fn :  79212.0
accuracy :  0.6831551790237427
precision :  0.20788000524044037
recall :  0.20788000524044037
auc :  0.5550039410591125

y_eval {0: 100000}
pred {0: 20788, 1: 79212}
[INFO] confusion matrix for file 
[[20788 79212     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 450079 1615454       0       0       0]
 [      0  204613       0       0       0]
 [   5967   21085       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-01_151435_117.log.part12_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1377 (0.2754%)
[INFO] ** orig:[0:99.9964%,2:0.0036%]
[INFO] ** type:[0:99.9994%,1:0.0004%,2:0.0002%]
[INFO] ** i/f_name:[2:99.996%,3:0.004%]
[INFO] ** i/f_dir:[1:99.9964%,0:0.0036%]
[INFO] ** src:[22:38.049%,9:26.1306%,7:18.2264%,1:17.587%,21:0.0036%,11:0.0014%,10:0.001%,14:0.0004%,15:0.0002%,8:0.0002%,4:0.0002%]
[INFO] ** dst:[21:43.355%,10:20.8256%,8:18.226%,9:17.5868%,15:0.004%,6:0.001%,22:0.0006%,25:0.0004%,24:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** proto:[0:99.9942%,1:0.004%,2:0.0018%]
[INFO] ** appi_name:[21:99.9932%,30:0.004%,22:0.0006%,26:0.0004%,0:0.0004%,31:0.0002%,27:0.0002%,24:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%,3:0.0002%]
[INFO] ** proxy_src_ip:[18:38.049%,20:26.1306%,13:18.2264%,6:17.587%,17:0.004%,10:0.0014%,11:0.001%,21:0.0002%,16:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9932%,-33.760870000000004:0.0066%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9974%,11:49.9958%,0:0.0066%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.13%,1:20.8244%,5:18.2258%,4:17.5864%,2:17.2242%,0:0.0092%]
[INFO] ** service:[0.0048200000000000005:99.9942%,-211.73542999999998:0.004%,-211.08818:0.0006%,-186.44547:0.0004%,-211.08346:0.0004%,-186.43601999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:26.1304%,-0.32151:20.8246%,-1.27613:18.226%,-0.23351:17.5866%,-0.33484:17.2244%,-71.33197:0.004%,-6.49859:0.0008%,-71.14931:0.0006%,-0.24151:0.0004%,-64.19493:0.0004%,-71.14798:0.0004%,-68.79874000000001:0.0002%,-1.81611:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,-61.95768:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:97.1716%,Single Stage Single Point:2.8284%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7293270e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.7293270e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.7293270e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 ...
 [-1.0398644e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.0398644e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0398644e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.9901962e-13 1.0000000e+00 3.3720693e-15 1.5830283e-14 2.7760010e-15]
  [1.9990208e-15 1.0000000e+00 1.9727106e-16 1.4024097e-15 2.0207328e-16]
  [4.4311695e-05 9.9995565e-01 2.8251635e-11 5.7148519e-11 3.5725947e-11]
  ...
  [8.3999563e-09 1.0000000e+00 3.5859325e-13 1.1201942e-12 3.5548452e-13]
  [1.5046509e-01 8.4953487e-01 1.4220565e-09 1.7840462e-09 1.5303974e-09]
  [3.0880558e-09 1.0000000e+00 2.1826288e-13 7.2034002e-13 2.1110023e-13]]

 [[3.0188538e-08 1.0000000e+00 6.7654969e-13 1.8985384e-12 6.2767608e-13]
  [1.7527537e-03 9.9824727e-01 1.6944113e-10 2.7584965e-10 1.9446539e-10]
  [5.3148064e-10 1.0000000e+00 9.2907534e-14 3.3984035e-13 9.4989310e-14]
  ...
  [6.4677906e-01 3.5322091e-01 1.8413027e-09 2.0068747e-09 1.8574475e-09]
  [1.4401562e-08 1.0000000e+00 4.6644481e-13 1.4127293e-12 4.5822108e-13]
  [5.4005623e-02 9.4599438e-01 9.0637059e-10 1.2137698e-09 9.9614283e-10]]

 [[1.2788014e-09 1.0000000e+00 1.4006308e-13 4.5920711e-13 1.2375833e-13]
  [2.0904204e-16 1.0000000e+00 6.4383802e-17 5.1743930e-16 6.6901839e-17]
  [2.2249659e-19 1.0000000e+00 2.2104247e-18 2.5352035e-17 2.4234204e-18]
  ...
  [7.3223060e-01 2.6776937e-01 1.7039510e-09 1.8154523e-09 1.7092111e-09]
  [4.7018776e-08 1.0000000e+00 8.3931646e-13 2.3816504e-12 8.2790372e-13]
  [1.1982542e-02 9.8801744e-01 4.3933296e-10 6.4230188e-10 4.9192267e-10]]

 ...

 [[4.1090349e-09 1.0000000e+00 2.5043921e-13 7.7558522e-13 2.2518184e-13]
  [1.9164225e-03 9.9808359e-01 1.7756195e-10 2.8790489e-10 2.0512000e-10]
  [7.8973782e-01 2.1026221e-01 1.5680359e-09 1.6415864e-09 1.5697564e-09]
  ...
  [1.1708056e-07 9.9999988e-01 1.3261316e-12 3.5840126e-12 1.2990341e-12]
  [3.6437973e-01 6.3562030e-01 1.8899704e-09 2.2115643e-09 1.9782256e-09]
  [8.1978158e-09 1.0000000e+00 3.5382656e-13 1.1062106e-12 3.4330302e-13]]

 [[4.6807441e-01 5.3192556e-01 1.9203246e-09 2.1760505e-09 1.9586144e-09]
  [1.7989941e-02 9.8201007e-01 5.1610261e-10 7.2777684e-10 5.5061050e-10]
  [1.8774393e-09 1.0000000e+00 1.7294196e-13 5.8895250e-13 1.7477274e-13]
  ...
  [2.4108587e-07 9.9999976e-01 1.8944974e-12 4.9178903e-12 1.8901337e-12]
  [4.2271823e-01 5.7728183e-01 1.9363715e-09 2.2337121e-09 2.0160440e-09]
  [2.9284971e-08 1.0000000e+00 6.6530402e-13 1.9386183e-12 6.4451016e-13]]

 [[9.2222661e-02 9.0777737e-01 1.1190874e-09 1.4305458e-09 1.1808045e-09]
  [9.3643134e-03 9.9063569e-01 3.7605211e-10 5.5087207e-10 4.0325959e-10]
  [5.7999283e-10 1.0000000e+00 9.6740209e-14 3.5141004e-13 9.7678755e-14]
  ...
  [7.3056531e-01 2.6943469e-01 1.7057989e-09 1.8176084e-09 1.7070748e-09]
  [2.7848667e-01 7.2151327e-01 1.7276858e-09 2.0527815e-09 1.7635835e-09]
  [7.2063792e-01 2.7936211e-01 1.7275655e-09 1.8470550e-09 1.7363462e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.9901962e-13 1.0000000e+00 3.3720693e-15 1.5830283e-14 2.7760010e-15]
 [1.9990208e-15 1.0000000e+00 1.9727106e-16 1.4024097e-15 2.0207328e-16]
 [4.4311695e-05 9.9995565e-01 2.8251635e-11 5.7148519e-11 3.5725947e-11]
 ...
 [7.3056531e-01 2.6943469e-01 1.7057989e-09 1.8176084e-09 1.7070748e-09]
 [2.7848667e-01 7.2151327e-01 1.7276858e-09 2.0527815e-09 1.7635835e-09]
 [7.2063792e-01 2.7936211e-01 1.7275655e-09 1.8470550e-09 1.7363462e-09]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 0 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  8.372034907531738
tp :  21585.0
fp :  78415.0
tn :  321585.0
fn :  78415.0
accuracy :  0.6863431334495544
precision :  0.21584999561309814
recall :  0.21584999561309814
auc :  0.5659024715423584

y_eval {0: 100000}
pred {0: 21585, 1: 78415}
[INFO] confusion matrix for file 
[[21585 78415     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 471664 1693869       0       0       0]
 [      0  204613       0       0       0]
 [   5967   21085       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0398644e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.0398644e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0398644e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-3.4786710e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-3.4786710e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-3.4786710e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.80709490e-14 1.00000000e+00 1.06679120e-15 5.58658082e-15
   8.73127650e-16]
  [6.59965153e-04 9.99339998e-01 1.04585077e-10 1.80193638e-10
   1.19801086e-10]
  [4.06897254e-02 9.59310234e-01 7.73482278e-10 1.04484810e-09
   8.31587244e-10]
  ...
  [5.43679718e-14 1.00000000e+00 1.00260887e-15 6.07063346e-15
   1.04047028e-15]
  [5.11393184e-04 9.99488592e-01 9.46136780e-11 1.66905392e-10
   1.15193327e-10]
  [5.72553396e-01 4.27446604e-01 1.91648941e-09 2.13002060e-09
   1.95604888e-09]]

 [[2.28923824e-10 1.00000000e+00 5.95383321e-14 2.12176414e-13
   5.14201007e-14]
  [4.87921992e-04 9.99512076e-01 9.04325434e-11 1.58616620e-10
   1.06803615e-10]
  [1.33664759e-08 1.00000000e+00 4.63260018e-13 1.42470584e-12
   4.87251190e-13]
  ...
  [2.34340192e-09 1.00000000e+00 1.90190081e-13 6.36634571e-13
   1.87028724e-13]
  [2.51390680e-04 9.99748647e-01 6.58148674e-11 1.20174204e-10
   7.85903009e-11]
  [5.64598799e-01 4.35401231e-01 1.92315341e-09 2.14223084e-09
   1.96702188e-09]]

 [[3.87186185e-03 9.96128082e-01 2.40432813e-10 3.66635861e-10
   2.54846311e-10]
  [1.14415072e-15 1.00000000e+00 1.47186083e-16 1.07726836e-15
   1.51300281e-16]
  [4.52017395e-19 1.00000000e+00 3.14092804e-18 3.48956729e-17
   3.46702207e-18]
  ...
  [2.51620775e-03 9.97483730e-01 2.03610642e-10 3.25259708e-10
   2.31813721e-10]
  [2.91496601e-12 1.00000000e+00 7.03824452e-15 3.41639118e-14
   6.98086227e-15]
  [1.47232749e-05 9.99985218e-01 1.63833669e-11 3.53254578e-11
   2.09464147e-11]]

 ...

 [[3.91863098e-10 1.00000000e+00 7.77781702e-14 2.70102788e-13
   6.76539039e-14]
  [2.43915842e-04 9.99756038e-01 6.38849112e-11 1.16266601e-10
   7.49501849e-11]
  [1.38306672e-10 1.00000000e+00 4.79234098e-14 1.89093370e-13
   4.95028823e-14]
  ...
  [4.38045990e-03 9.95619476e-01 2.71810879e-10 4.23676177e-10
   3.17309734e-10]
  [4.77496326e-01 5.22503674e-01 1.93396565e-09 2.19485008e-09
   1.97636485e-09]
  [2.65612513e-01 7.34387517e-01 1.70427306e-09 2.03308259e-09
   1.74251369e-09]]

 [[7.56925108e-14 1.00000000e+00 1.12418869e-15 5.85790326e-15
   9.20192983e-16]
  [5.14982230e-06 9.99994874e-01 9.27780595e-12 2.07737005e-11
   1.01167841e-11]
  [1.70699704e-13 1.00000000e+00 1.75041444e-15 9.93752606e-15
   1.79862894e-15]
  ...
  [9.82583612e-02 9.01741683e-01 1.18539756e-09 1.52803492e-09
   1.28284061e-09]
  [6.85296059e-02 9.31470394e-01 9.79241355e-10 1.27815836e-09
   1.02085174e-09]
  [7.35728741e-01 2.64271259e-01 1.69837255e-09 1.80836690e-09
   1.70639936e-09]]

 [[7.56829834e-14 1.00000000e+00 1.12411585e-15 5.85756826e-15
   9.20133373e-16]
  [2.00423989e-02 9.79957640e-01 5.64727820e-10 8.03119460e-10
   6.34700847e-10]
  [1.36801959e-11 1.00000000e+00 1.50404456e-14 6.69512189e-14
   1.50566917e-14]
  ...
  [3.37768376e-01 6.62231565e-01 1.82381821e-09 2.13428586e-09
   1.86020843e-09]
  [2.91311858e-06 9.99997139e-01 6.61496335e-12 1.50264315e-11
   6.79610708e-12]
  [5.15284529e-03 9.94847178e-01 2.86920987e-10 4.38494741e-10
   3.17707693e-10]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.8070949e-14 1.0000000e+00 1.0667912e-15 5.5865808e-15 8.7312765e-16]
 [6.5996515e-04 9.9934000e-01 1.0458508e-10 1.8019364e-10 1.1980109e-10]
 [4.0689725e-02 9.5931023e-01 7.7348228e-10 1.0448481e-09 8.3158724e-10]
 ...
 [3.3776838e-01 6.6223156e-01 1.8238182e-09 2.1342859e-09 1.8602084e-09]
 [2.9131186e-06 9.9999714e-01 6.6149634e-12 1.5026431e-11 6.7961071e-12]
 [5.1528453e-03 9.9484718e-01 2.8692099e-10 4.3849474e-10 3.1770769e-10]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.420282493591309
tp :  19698.0
fp :  80302.0
tn :  319698.0
fn :  80302.0
accuracy :  0.6787951588630676
precision :  0.19697999954223633
recall :  0.19697999954223633
auc :  0.5622003674507141

y_eval {0: 100000}
pred {0: 19698, 1: 80302}
[INFO] confusion matrix for file 
[[19698 80302     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 491362 1774171       0       0       0]
 [      0  204613       0       0       0]
 [   5967   21085       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4786710e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4786710e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4786710e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [ 3.4666502e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4666502e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 3.4666502e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[3.83434772e-01 6.16565228e-01 1.87497351e-09 2.16794960e-09
   1.93486072e-09]
  [3.67096543e-01 6.32903457e-01 1.86565252e-09 2.17119456e-09
   1.92842808e-09]
  [1.18590721e-10 1.00000000e+00 4.34853772e-14 1.71283506e-13
   4.26002278e-14]
  ...
  [1.70861721e-01 8.29138339e-01 1.49507340e-09 1.85893190e-09
   1.60615310e-09]
  [3.12487185e-01 6.87512815e-01 1.79224258e-09 2.11366369e-09
   1.84329252e-09]
  [6.89416707e-01 3.10583293e-01 1.78174075e-09 1.92092942e-09
   1.79260118e-09]]

 [[3.63683215e-11 1.00000000e+00 2.38807082e-14 9.29614187e-14
   2.02083494e-14]
  [3.01571388e-04 9.99698400e-01 7.10990225e-11 1.28022815e-10
   8.38182787e-11]
  [2.23125267e-06 9.99997735e-01 5.92815987e-12 1.37992725e-11
   6.45142403e-12]
  ...
  [7.12569535e-01 2.87430465e-01 1.74461834e-09 1.87018578e-09
   1.75723525e-09]
  [2.61844697e-08 1.00000000e+00 6.27229659e-13 1.83828820e-12
   6.15973798e-13]
  [3.81420698e-13 1.00000000e+00 2.67943817e-15 1.47187645e-14
   2.94923786e-15]]

 [[1.56855986e-05 9.99984264e-01 1.53337447e-11 3.12612713e-11
   1.55056766e-11]
  [7.12753739e-03 9.92872477e-01 3.35360378e-10 5.02424491e-10
   3.72043646e-10]
  [4.73635137e-01 5.26364923e-01 1.93311078e-09 2.19612417e-09
   1.98283345e-09]
  ...
  [1.11506555e-08 1.00000000e+00 4.10204151e-13 1.25895670e-12
   4.01600059e-13]
  [1.44846435e-03 9.98551548e-01 1.55975885e-10 2.57600136e-10
   1.81331811e-10]
  [5.37093580e-01 4.62906390e-01 1.93245442e-09 2.16536922e-09
   1.97746619e-09]]

 ...

 [[4.02990123e-03 9.95970130e-01 2.45741816e-10 3.74497156e-10
   2.63167210e-10]
  [2.67107080e-05 9.99973297e-01 2.04891451e-11 4.15353515e-11
   2.21544692e-11]
  [5.94529390e-01 4.05470610e-01 1.90564853e-09 2.10799711e-09
   1.94629424e-09]
  ...
  [6.26636902e-05 9.99937296e-01 3.32609149e-11 6.58650912e-11
   4.08250968e-11]
  [4.70642179e-01 5.29357851e-01 1.94073113e-09 2.20956786e-09
   1.99924921e-09]
  [3.39076212e-10 1.00000000e+00 7.29097772e-14 2.71021866e-13
   7.06776285e-14]]

 [[1.16025054e-11 1.00000000e+00 1.35511067e-14 5.57010255e-14
   1.13497892e-14]
  [8.97850189e-03 9.91021574e-01 3.81478349e-10 5.67538794e-10
   4.36328085e-10]
  [1.53071523e-01 8.46928477e-01 1.39862155e-09 1.73958381e-09
   1.47301848e-09]
  ...
  [7.73801565e-01 2.26198450e-01 1.60785008e-09 1.69114278e-09
   1.60644609e-09]
  [9.25233326e-05 9.99907494e-01 3.69885268e-11 6.94228355e-11
   3.82985900e-11]
  [3.13388631e-02 9.68661070e-01 6.87938484e-10 9.45645784e-10
   7.39978523e-10]]

 [[3.30846943e-02 9.66915309e-01 6.91853519e-10 9.38084943e-10
   7.32129635e-10]
  [5.22391900e-15 1.00000000e+00 3.10143814e-16 2.09092391e-15
   3.15359737e-16]
  [3.85730591e-13 1.00000000e+00 2.80620660e-15 1.56572583e-14
   3.60553677e-15]
  ...
  [6.38453700e-13 1.00000000e+00 3.50167867e-15 1.88316549e-14
   4.07075183e-15]
  [1.56735405e-02 9.84326422e-01 5.06946540e-10 7.33595684e-10
   5.78946668e-10]
  [7.46751111e-03 9.92532551e-01 3.35102335e-10 4.96401031e-10
   3.51642687e-10]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[3.8343477e-01 6.1656523e-01 1.8749735e-09 2.1679496e-09 1.9348607e-09]
 [3.6709654e-01 6.3290346e-01 1.8656525e-09 2.1711946e-09 1.9284281e-09]
 [1.1859072e-10 1.0000000e+00 4.3485377e-14 1.7128351e-13 4.2600228e-14]
 ...
 [6.3845370e-13 1.0000000e+00 3.5016787e-15 1.8831655e-14 4.0707518e-15]
 [1.5673541e-02 9.8432642e-01 5.0694654e-10 7.3359568e-10 5.7894667e-10]
 [7.4675111e-03 9.9253255e-01 3.3510233e-10 4.9640103e-10 3.5164269e-10]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.364256442260743
tp :  19148.0
fp :  80852.0
tn :  319148.0
fn :  80852.0
accuracy :  0.676595151424408
precision :  0.19147999584674835
recall :  0.19147999584674835
auc :  0.5599794983863831

y_eval {0: 100000}
pred {0: 19148, 1: 80852}
[INFO] confusion matrix for file 
[[19148 80852     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 510510 1855023       0       0       0]
 [      0  204613       0       0       0]
 [   5967   21085       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4666502e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 3.4666502e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4666502e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [ 1.0386623e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.0386623e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0386623e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[3.22965980e-02 9.67703462e-01 6.83854751e-10 9.28497612e-10
   7.23745286e-10]
  [2.27449873e-05 9.99977231e-01 1.87671805e-11 3.82812497e-11
   2.00662716e-11]
  [3.13992096e-11 1.00000000e+00 2.33214157e-14 1.00023756e-13
   2.46026496e-14]
  ...
  [1.04989741e-08 1.00000000e+00 4.49624902e-13 1.44686292e-12
   5.94329599e-13]
  [8.61371911e-12 1.00000000e+00 1.24001880e-14 5.75563767e-14
   1.32475512e-14]
  [5.40269166e-02 9.45973039e-01 9.10673703e-10 1.22148525e-09
   1.00976916e-09]]

 [[3.15262154e-02 9.68473792e-01 6.75930367e-10 9.18985610e-10
   7.15436488e-10]
  [2.19107387e-05 9.99978065e-01 1.84220104e-11 3.76547300e-11
   1.96959688e-11]
  [1.31841805e-14 1.00000000e+00 4.95587595e-16 3.22822425e-15
   5.16083040e-16]
  ...
  [5.78702464e-09 1.00000000e+00 3.23467436e-13 1.06231571e-12
   3.74585942e-13]
  [3.49212573e-16 1.00000000e+00 8.30972739e-17 6.63776946e-16
   8.90395608e-17]
  [3.12653661e-04 9.99687314e-01 7.51494353e-11 1.36961303e-10
   9.44001058e-11]]

 [[3.85767338e-03 9.96142328e-01 2.40457348e-10 3.67309544e-10
   2.57494776e-10]
  [2.26426870e-01 7.73573101e-01 1.63445757e-09 1.98171901e-09
   1.71843362e-09]
  [5.71583257e-07 9.99999404e-01 2.94585623e-12 7.32082884e-12
   3.02642134e-12]
  ...
  [5.66641756e-05 9.99943376e-01 3.17990564e-11 6.34475389e-11
   3.94351669e-11]
  [3.30670283e-11 1.00000000e+00 2.36150075e-14 1.00838825e-13
   2.39615101e-14]
  [1.77626542e-04 9.99822438e-01 5.56185063e-11 1.03765656e-10
   6.71496539e-11]]

 ...

 [[4.55338418e-01 5.44661522e-01 1.91837768e-09 2.18129115e-09
   1.96689220e-09]
  [7.51218379e-01 2.48781577e-01 1.66329917e-09 1.76199899e-09
   1.66956082e-09]
  [1.57521993e-01 8.42477977e-01 1.40476986e-09 1.73824266e-09
   1.45112122e-09]
  ...
  [1.89251501e-12 1.00000000e+00 6.01310637e-15 3.06533770e-14
   6.91666183e-15]
  [5.10687679e-02 9.48931217e-01 8.87007634e-10 1.19461274e-09
   9.83905069e-10]
  [7.50578046e-01 2.49421984e-01 1.66545122e-09 1.76525483e-09
   1.66985981e-09]]

 [[6.78146780e-01 3.21853161e-01 1.79451209e-09 1.93652938e-09
   1.79913195e-09]
  [5.82188606e-01 4.17811424e-01 1.90261829e-09 2.10653295e-09
   1.94198035e-09]
  [3.85181874e-01 6.14818096e-01 1.87606908e-09 2.17080176e-09
   1.91453498e-09]
  ...
  [1.30737418e-15 1.00000000e+00 1.64655833e-16 1.24285483e-15
   1.98146682e-16]
  [9.66337167e-12 1.00000000e+00 1.37795828e-14 6.48777297e-14
   1.68190098e-14]
  [1.00768603e-01 8.99231434e-01 1.20350108e-09 1.55193058e-09
   1.31301792e-09]]

 [[1.40817547e-02 9.85918164e-01 4.56560345e-10 6.49698184e-10
   4.87346385e-10]
  [6.61870360e-01 3.38129640e-01 1.82779147e-09 1.98606331e-09
   1.85239424e-09]
  [2.65485525e-01 7.34514475e-01 1.70333936e-09 2.03261208e-09
   1.75341797e-09]
  ...
  [7.94445872e-01 2.05554157e-01 1.55249613e-09 1.62177227e-09
   1.54963242e-09]
  [5.84286006e-08 1.00000000e+00 9.32850910e-13 2.61443926e-12
   9.18724732e-13]
  [5.77399671e-01 4.22600329e-01 1.92549221e-09 2.14065521e-09
   1.97540673e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[3.22965980e-02 9.67703462e-01 6.83854751e-10 9.28497612e-10
  7.23745286e-10]
 [2.27449873e-05 9.99977231e-01 1.87671805e-11 3.82812497e-11
  2.00662716e-11]
 [3.13992096e-11 1.00000000e+00 2.33214157e-14 1.00023756e-13
  2.46026496e-14]
 ...
 [7.94445872e-01 2.05554157e-01 1.55249613e-09 1.62177227e-09
  1.54963242e-09]
 [5.84286006e-08 1.00000000e+00 9.32850910e-13 2.61443926e-12
  9.18724732e-13]
 [5.77399671e-01 4.22600329e-01 1.92549221e-09 2.14065521e-09
  1.97540673e-09]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 0 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  8.327941331481934
tp :  19565.0
fp :  80435.0
tn :  319565.0
fn :  80435.0
accuracy :  0.6782631874084473
precision :  0.19564999639987946
recall :  0.19564999639987946
auc :  0.5549744963645935

y_eval {0: 100000}
pred {0: 19565, 1: 80435}
[INFO] confusion matrix for file 
[[19565 80435     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 530075 1935458       0       0       0]
 [      0  204613       0       0       0]
 [   5967   21085       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0386623e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0386623e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.0386623e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 ...
 [ 1.7331945e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.7331945e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.7331945e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 1 1] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.77406538e-13 1.00000000e+00 1.71211797e-15 8.57135679e-15
   1.40310002e-15]
  [4.38535347e-10 1.00000000e+00 8.74201698e-14 3.24052851e-13
   8.93714830e-14]
  [5.16835675e-02 9.48316455e-01 8.85462981e-10 1.18721055e-09
   9.75191594e-10]
  ...
  [2.18885198e-01 7.81114876e-01 1.64053748e-09 2.00365169e-09
   1.75414139e-09]
  [1.65734637e-09 1.00000000e+00 1.60157315e-13 5.46859324e-13
   1.55687610e-13]
  [3.14227045e-01 6.85772955e-01 1.83120108e-09 2.16997287e-09
   1.92888039e-09]]

 [[4.09053125e-10 1.00000000e+00 7.94498405e-14 2.75292999e-13
   6.91115324e-14]
  [3.13910935e-03 9.96860862e-01 2.27314639e-10 3.58924057e-10
   2.63659400e-10]
  [4.62305587e-04 9.99537706e-01 8.42129214e-11 1.45933515e-10
   9.15277576e-11]
  ...
  [2.51265941e-03 9.97487307e-01 2.05614220e-10 3.29798688e-10
   2.39438303e-10]
  [7.36209452e-01 2.63790578e-01 1.69905434e-09 1.80959658e-09
   1.71012804e-09]
  [3.61590580e-09 1.00000000e+00 2.34902240e-13 7.66444091e-13
   2.28014900e-13]]

 [[5.71343771e-11 1.00000000e+00 2.98792803e-14 1.13766486e-13
   2.53751013e-14]
  [8.21155086e-02 9.17884529e-01 1.09507570e-09 1.42782852e-09
   1.20045018e-09]
  [7.80841529e-01 2.19158456e-01 1.59092661e-09 1.67014769e-09
   1.59393354e-09]
  ...
  [9.14972797e-02 9.08502698e-01 1.11194443e-09 1.42360967e-09
   1.14783660e-09]
  [3.96577748e-09 1.00000000e+00 2.47801156e-13 8.07724872e-13
   2.45616841e-13]
  [3.82790506e-01 6.17209494e-01 1.91249949e-09 2.22915508e-09
   2.00498973e-09]]

 ...

 [[4.80834672e-07 9.99999523e-01 2.68118947e-12 6.51329338e-12
   2.53217391e-12]
  [6.85312140e-10 1.00000000e+00 1.07650949e-13 3.88911668e-13
   1.11052484e-13]
  [2.02202138e-15 1.00000000e+00 1.99216088e-16 1.44784358e-15
   2.16683839e-16]
  ...
  [7.60282710e-05 9.99923944e-01 3.44248310e-11 6.59142324e-11
   3.70378450e-11]
  [5.05091249e-13 1.00000000e+00 2.99012160e-15 1.60226904e-14
   3.05384558e-15]
  [1.40858185e-03 9.98591363e-01 1.56330879e-10 2.60270944e-10
   1.88398824e-10]]

 [[6.97451159e-02 9.30254877e-01 9.85158288e-10 1.28022593e-09
   1.04040354e-09]
  [5.48678026e-14 1.00000000e+00 9.88330748e-16 5.87730963e-15
   9.94396669e-16]
  [4.37066426e-14 1.00000000e+00 9.44800243e-16 5.90603252e-15
   1.17092606e-15]
  ...
  [4.48653125e-04 9.99551356e-01 8.14546486e-11 1.40259179e-10
   8.45254630e-11]
  [4.82920945e-01 5.17078996e-01 1.94198080e-09 2.20385421e-09
   1.99477945e-09]
  [7.81634092e-01 2.18365937e-01 1.58797042e-09 1.66623049e-09
   1.58796143e-09]]

 [[3.12212940e-08 1.00000000e+00 6.88030037e-13 1.92772252e-12
   6.38958070e-13]
  [5.73629572e-17 1.00000000e+00 3.39745047e-17 2.91806980e-16
   3.55487883e-17]
  [4.14023921e-03 9.95859802e-01 2.67211003e-10 4.18718255e-10
   3.20697274e-10]
  ...
  [8.41841334e-04 9.99158144e-01 1.16056643e-10 1.95787039e-10
   1.28654254e-10]
  [5.16152978e-01 4.83847052e-01 1.93880623e-09 2.18328711e-09
   1.98920280e-09]
  [7.53710806e-01 2.46289223e-01 1.65644676e-09 1.75329462e-09
   1.65790714e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.7740654e-13 1.0000000e+00 1.7121180e-15 8.5713568e-15 1.4031000e-15]
 [4.3853535e-10 1.0000000e+00 8.7420170e-14 3.2405285e-13 8.9371483e-14]
 [5.1683567e-02 9.4831645e-01 8.8546298e-10 1.1872106e-09 9.7519159e-10]
 ...
 [8.4184133e-04 9.9915814e-01 1.1605664e-10 1.9578704e-10 1.2865425e-10]
 [5.1615298e-01 4.8384705e-01 1.9388062e-09 2.1832871e-09 1.9892028e-09]
 [7.5371081e-01 2.4628922e-01 1.6564468e-09 1.7532946e-09 1.6579071e-09]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  7.257284652709961
tp :  28329.0
fp :  71671.0
tn :  328329.0
fn :  71671.0
accuracy :  0.7133188247680664
precision :  0.28328999876976013
recall :  0.28328999876976013
auc :  0.6082574725151062

y_eval {0: 85858, 1: 14142}
pred {0: 20435, 1: 79565}
[INFO] confusion matrix for file 
[[17311 68547     0     0     0]
 [ 3124 11018     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 547386 2004005       0       0       0]
 [   3124  215631       0       0       0]
 [   5967   21085       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-01_151435_117.log.part13_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1365 (0.273%)
[INFO] ** orig:[0:99.9986%,2:0.0014%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.998%,3:0.002%]
[INFO] ** i/f_dir:[1:99.998%,0:0.002%]
[INFO] ** src:[22:38.1186%,9:26.0918%,7:18.2288%,1:17.558%,21:0.0018%,14:0.0006%,15:0.0004%]
[INFO] ** dst:[21:43.3702%,10:20.8392%,8:18.2288%,9:17.5578%,15:0.002%,22:0.0012%,24:0.0004%,18:0.0002%,6:0.0002%]
[INFO] ** proto:[0:99.9976%,1:0.002%,2:0.0004%]
[INFO] ** appi_name:[21:99.9976%,30:0.002%,31:0.0002%,22:0.0002%]
[INFO] ** proxy_src_ip:[18:38.1186%,20:26.0918%,13:18.2288%,6:17.558%,17:0.002%,16:0.0004%,7:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.9976%,-33.760870000000004:0.0024%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.9978%,0:0.0024%]
[INFO] ** modbus_transaction_id:65534 (13.1068%)
[INFO] ** scada_tag:[3:26.0906%,1:20.839%,5:18.2282%,4:17.5572%,2:17.2792%,0:0.0058%]
[INFO] ** service:[0.0048200000000000005:99.9976%,-211.73542999999998:0.002%,-186.43601999999998:0.0002%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:26.0908%,-0.32151:20.8392%,-1.27613:18.2284%,-0.23351:17.5576%,-0.33484:17.2794%,-71.33197:0.002%,1.45709:0.0006%,-1.27347:0.0004%,-1.02014:0.0004%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,4.42897:0.0002%,-0.24151:0.0002%,-71.14931:0.0002%]
[INFO] ** classification:[normal:87.5394%,Single Stage Single Point:12.4606%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7325106  0.         0.        ...  2.         0.00482   -0.33484  ]
 [-1.7325106  0.         0.        ...  3.         0.00482    1.45442  ]
 [-1.7325106  0.         0.        ...  2.         0.00482   -0.33484  ]
 ...
 [-1.0383536  0.         0.        ...  1.         0.00482   -0.32151  ]
 [-1.0383536  0.         0.        ...  2.         0.00482   -0.33484  ]
 [-1.0383536  0.         0.        ...  1.         0.00482   -0.32151  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 1 0 ... 1 0 1] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[2.71669012e-02 9.72833157e-01 6.30257124e-10 8.65352456e-10
   6.74203304e-10]
  [2.58524626e-01 7.41475403e-01 1.70370384e-09 2.04315054e-09
   1.77936055e-09]
  [6.99514449e-01 3.00485522e-01 1.76587489e-09 1.89910554e-09
   1.77817749e-09]
  ...
  [2.65280881e-10 1.00000000e+00 6.50209324e-14 2.46158508e-13
   6.36760542e-14]
  [1.17519917e-02 9.88248050e-01 4.38205972e-10 6.43252451e-10
   4.98953434e-10]
  [6.43888235e-01 3.56111825e-01 1.84968874e-09 2.01974037e-09
   1.87628535e-09]]

 [[1.37027359e-06 9.99998689e-01 4.54303695e-12 1.05189486e-11
   4.48339109e-12]
  [5.88083966e-03 9.94119167e-01 3.06616066e-10 4.65314010e-10
   3.43863632e-10]
  [3.68144487e-10 1.00000000e+00 7.71603918e-14 2.87471923e-13
   7.80645690e-14]
  ...
  [1.09054099e-07 9.99999881e-01 1.27635283e-12 3.46061721e-12
   1.26777831e-12]
  [1.72160964e-13 1.00000000e+00 1.78003572e-15 1.01332161e-14
   1.84517763e-15]
  [8.90372341e-16 1.00000000e+00 1.34581068e-16 1.03443115e-15
   1.52922097e-16]]

 [[2.15154054e-04 9.99784887e-01 5.68544725e-11 1.01212455e-10
   5.96500627e-11]
  [8.19587633e-02 9.18041229e-01 1.08093645e-09 1.40409095e-09
   1.16328214e-09]
  [7.02116311e-01 2.97883689e-01 1.76199721e-09 1.89393101e-09
   1.77522075e-09]
  ...
  [6.82234168e-01 3.17765862e-01 1.79079396e-09 1.93326910e-09
   1.79585968e-09]
  [6.44403517e-01 3.55596423e-01 1.84267912e-09 2.00885775e-09
   1.85577897e-09]
  [6.50914490e-01 3.49085480e-01 1.83480842e-09 1.99707872e-09
   1.84679860e-09]]

 ...

 [[8.11569711e-14 1.00000000e+00 1.16346370e-15 6.04106397e-15
   9.51858145e-16]
  [3.02511454e-02 9.69748855e-01 6.89168334e-10 9.57149471e-10
   7.72820363e-10]
  [5.69339097e-01 4.30660874e-01 1.91305416e-09 2.12584172e-09
   1.95429761e-09]
  ...
  [4.69713335e-09 1.00000000e+00 2.68199742e-13 8.63717463e-13
   2.62515107e-13]
  [2.25075055e-02 9.77492511e-01 5.98861349e-10 8.45129355e-10
   6.69870881e-10]
  [6.45205855e-01 3.54794115e-01 1.84733628e-09 2.01616790e-09
   1.87208049e-09]]

 [[6.86526167e-14 1.00000000e+00 1.07128524e-15 5.60782567e-15
   8.76802450e-16]
  [2.14601494e-02 9.78539824e-01 5.84587712e-10 8.28782210e-10
   6.61389443e-10]
  [6.67938828e-01 3.32061112e-01 1.81706505e-09 1.97154049e-09
   1.84202564e-09]
  ...
  [6.43315911e-01 3.56684029e-01 1.84757243e-09 2.01628314e-09
   1.86551841e-09]
  [6.29563630e-01 3.70436370e-01 1.85866611e-09 2.03317763e-09
   1.86946747e-09]
  [7.15664864e-01 2.84335107e-01 1.73551307e-09 1.85751048e-09
   1.74187698e-09]]

 [[5.55277541e-02 9.44472253e-01 8.83142781e-10 1.16028709e-09
   9.18426557e-10]
  [6.03432907e-03 9.93965685e-01 3.02989550e-10 4.55159715e-10
   3.27424921e-10]
  [1.41943913e-11 1.00000000e+00 1.53973243e-14 6.84331064e-14
   1.54425897e-14]
  ...
  [2.39441550e-04 9.99760568e-01 6.60114047e-11 1.22336863e-10
   8.34709038e-11]
  [4.83613402e-01 5.16386628e-01 1.93945082e-09 2.20008878e-09
   1.98854755e-09]
  [6.53763771e-01 3.46236259e-01 1.83146565e-09 1.99189332e-09
   1.84089366e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[2.7166901e-02 9.7283316e-01 6.3025712e-10 8.6535246e-10 6.7420330e-10]
 [2.5852463e-01 7.4147540e-01 1.7037038e-09 2.0431505e-09 1.7793605e-09]
 [6.9951445e-01 3.0048552e-01 1.7658749e-09 1.8991055e-09 1.7781775e-09]
 ...
 [2.3944155e-04 9.9976057e-01 6.6011405e-11 1.2233686e-10 8.3470904e-11]
 [4.8361340e-01 5.1638663e-01 1.9394508e-09 2.2000888e-09 1.9885475e-09]
 [6.5376377e-01 3.4623626e-01 1.8314656e-09 1.9918933e-09 1.8408937e-09]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 1 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  6.358932595062256
tp :  41075.0
fp :  58925.0
tn :  341075.0
fn :  58925.0
accuracy :  0.7643024325370789
precision :  0.41075000166893005
recall :  0.41075000166893005
auc :  0.6962975263595581

y_eval {0: 53028, 1: 46972}
pred {0: 21161, 1: 78839}
[INFO] confusion matrix for file 
[[ 7632 45396     0     0     0]
 [13529 33443     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 555018 2049401       0       0       0]
 [  16653  249074       0       0       0]
 [   5967   21085       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0383536   0.          0.         ...  2.          0.00482
  -0.33484   ]
 [-1.0383536   0.          0.         ...  4.          0.00482
  -0.23351   ]
 [-1.0383536   0.          0.         ...  3.          0.00482
   1.45442   ]
 ...
 [-0.34673914  0.          0.         ...  1.          0.00482
  -0.32151   ]
 [-0.34673914  0.          0.         ...  1.          0.00482
  -0.32151   ]
 [-0.34673914  0.          0.         ...  4.          0.00482
  -0.23351   ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 1 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[3.50999534e-02 9.64900017e-01 7.12555792e-10 9.63628399e-10
   7.57515550e-10]
  [3.76822088e-15 1.00000000e+00 2.64195453e-16 1.81274262e-15
   2.69694126e-16]
  [6.63015453e-06 9.99993324e-01 1.11361528e-11 2.51835063e-11
   1.47518803e-11]
  ...
  [4.89475012e-01 5.10524988e-01 1.94009697e-09 2.19831708e-09
   1.99380601e-09]
  [7.29106605e-01 2.70893365e-01 1.70958747e-09 1.82283055e-09
   1.71341663e-09]
  [5.33042610e-01 4.66957420e-01 1.92110816e-09 2.14881579e-09
   1.94102312e-09]]

 [[5.13423271e-02 9.48657691e-01 8.51113791e-10 1.12323451e-09
   8.85333973e-10]
  [1.66943163e-01 8.33056867e-01 1.45309620e-09 1.79816462e-09
   1.53608171e-09]
  [3.58441332e-10 1.00000000e+00 7.54538101e-14 2.80331016e-13
   7.47188295e-14]
  ...
  [7.27751526e-10 1.00000000e+00 1.21931003e-13 4.59392832e-13
   1.68007427e-13]
  [8.66590276e-17 1.00000000e+00 4.18544456e-17 3.60554874e-16
   4.54785224e-17]
  [3.69151712e-05 9.99963045e-01 2.62575794e-11 5.41694849e-11
   3.42334078e-11]]

 [[8.61821137e-03 9.91381824e-01 3.58607505e-10 5.24600863e-10
   3.84971915e-10]
  [2.00330749e-01 7.99669266e-01 1.56240265e-09 1.91057881e-09
   1.64432246e-09]
  [7.12892175e-01 2.87107795e-01 1.74197268e-09 1.86645233e-09
   1.75157466e-09]
  ...
  [2.20999697e-16 1.00000000e+00 6.65528610e-17 5.43128802e-16
   7.18828820e-17]
  [2.92734894e-05 9.99970675e-01 2.33160991e-11 4.86497335e-11
   3.00689404e-11]
  [3.96177441e-01 6.03822589e-01 1.90461225e-09 2.20644947e-09
   1.96837591e-09]]

 ...

 [[8.29746276e-02 9.17025387e-01 1.06663811e-09 1.37187017e-09
   1.12471565e-09]
  [2.32705381e-02 9.76729512e-01 5.88321669e-10 8.19028401e-10
   6.28918972e-10]
  [1.23550675e-11 1.00000000e+00 1.43308505e-14 6.40737124e-14
   1.42866371e-14]
  ...
  [6.82341337e-01 3.17658663e-01 1.79617932e-09 1.94161442e-09
   1.81426629e-09]
  [7.73035467e-01 2.26964533e-01 1.60934621e-09 1.69283598e-09
   1.60586300e-09]
  [4.15077716e-01 5.84922314e-01 1.89814942e-09 2.18018181e-09
   1.92745264e-09]]

 [[8.14648718e-02 9.18535113e-01 1.05778131e-09 1.36197431e-09
   1.11555543e-09]
  [9.11167487e-15 1.00000000e+00 4.07478911e-16 2.66487174e-15
   4.12762093e-16]
  [4.69560473e-04 9.99530435e-01 9.15267445e-11 1.62549640e-10
   1.14364254e-10]
  ...
  [2.75038570e-01 7.24961400e-01 1.76425152e-09 2.11666595e-09
   1.86859239e-09]
  [4.88305449e-01 5.11694551e-01 1.92928384e-09 2.18197416e-09
   1.96321603e-09]
  [1.32482796e-07 9.99999881e-01 1.41279371e-12 3.79401588e-12
   1.41736861e-12]]

 [[2.55026342e-03 9.97449696e-01 1.95095093e-10 3.04016812e-10
   2.05477108e-10]
  [2.85583317e-01 7.14416683e-01 1.76184090e-09 2.09828444e-09
   1.84387716e-09]
  [6.74496472e-01 3.25503528e-01 1.80463855e-09 1.95347671e-09
   1.82089255e-09]
  ...
  [7.30755687e-01 2.69244343e-01 1.70627912e-09 1.81841131e-09
   1.70951708e-09]
  [7.90402055e-01 2.09597930e-01 1.56337943e-09 1.63510461e-09
   1.55879998e-09]
  [4.48448390e-08 1.00000000e+00 8.19468788e-13 2.33087204e-12
   8.07610868e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[3.5099953e-02 9.6490002e-01 7.1255579e-10 9.6362840e-10 7.5751555e-10]
 [3.7682209e-15 1.0000000e+00 2.6419545e-16 1.8127426e-15 2.6969413e-16]
 [6.6301545e-06 9.9999332e-01 1.1136153e-11 2.5183506e-11 1.4751880e-11]
 ...
 [7.3075569e-01 2.6924434e-01 1.7062791e-09 1.8184113e-09 1.7095171e-09]
 [7.9040205e-01 2.0959793e-01 1.5633794e-09 1.6351046e-09 1.5588000e-09]
 [4.4844839e-08 1.0000000e+00 8.1946879e-13 2.3308720e-12 8.0761087e-13]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 0 0 1] (100000,)
[33m[INFO] metrics:[0m
loss :  7.717023110961914
tp :  26974.0
fp :  73026.0
tn :  326974.0
fn :  73026.0
accuracy :  0.7078989148139954
precision :  0.2697399854660034
recall :  0.2697399854660034
auc :  0.6070169806480408

y_eval {0: 84669, 1: 15331}
pred {0: 19899, 1: 80101}
[INFO] confusion matrix for file 
[[15771 68898     0     0     0]
 [ 4128 11203     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 570789 2118299       0       0       0]
 [  20781  260277       0       0       0]
 [   5967   21085       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4673914e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-3.4673914e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4673914e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 3.4741792e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 3.4741792e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4741792e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[2.1868097e-08 1.0000000e+00 5.7602968e-13 1.6423806e-12 5.3137139e-13]
  [2.3298853e-03 9.9767011e-01 1.9525510e-10 3.1293701e-10 2.2408581e-10]
  [6.5913612e-01 3.4086382e-01 1.8303894e-09 1.9909963e-09 1.8552534e-09]
  ...
  [2.1670472e-14 1.0000000e+00 6.3646119e-16 4.0472628e-15 6.6479307e-16]
  [2.0750016e-02 9.7925001e-01 5.8250232e-10 8.2999768e-10 6.6691036e-10]
  [4.6327409e-01 5.3672588e-01 1.9282493e-09 2.1943480e-09 1.9666144e-09]]

 [[2.7332620e-10 1.0000000e+00 6.5028623e-14 2.2981945e-13 5.6325048e-14]
  [8.4525265e-04 9.9915481e-01 1.1874819e-10 2.0193390e-10 1.3958476e-10]
  [6.5256488e-01 3.4743509e-01 1.8399553e-09 2.0051729e-09 1.8679647e-09]
  ...
  [3.8810369e-01 6.1189634e-01 1.8794732e-09 2.1732647e-09 1.9157897e-09]
  [6.3531030e-07 9.9999940e-01 3.0886916e-12 7.6207972e-12 3.1354886e-12]
  [2.6450899e-09 1.0000000e+00 2.1298734e-13 7.2106031e-13 2.2853084e-13]]

 [[9.5243658e-14 1.0000000e+00 1.2591709e-15 6.4893786e-15 1.0304454e-15]
  [1.3178523e-03 9.9868208e-01 1.4763769e-10 2.4495034e-10 1.7004213e-10]
  [6.1208290e-01 3.8791713e-01 1.8852961e-09 2.0752147e-09 1.9225792e-09]
  ...
  [1.1819565e-06 9.9999881e-01 4.1835428e-12 9.9566154e-12 4.2100702e-12]
  [1.6948880e-11 1.0000000e+00 1.7088432e-14 7.5622376e-14 1.7072405e-14]
  [3.0994016e-10 1.0000000e+00 7.5457835e-14 2.9067642e-13 8.6230143e-14]]

 ...

 [[1.4642372e-11 1.0000000e+00 1.5208104e-14 6.1823220e-14 1.2762178e-14]
  [7.0072657e-14 1.0000000e+00 1.1443165e-15 6.7762089e-15 1.1743347e-15]
  [1.2951016e-18 1.0000000e+00 5.2641592e-18 5.5714009e-17 5.7234409e-18]
  ...
  [1.1141622e-02 9.8885834e-01 4.0966511e-10 5.9452071e-10 4.3586920e-10]
  [3.1822264e-08 1.0000000e+00 7.0674429e-13 2.0633610e-12 7.2182679e-13]
  [3.1718183e-01 6.8281817e-01 1.8325536e-09 2.1717621e-09 1.9297455e-09]]

 [[8.4179625e-14 1.0000000e+00 1.1847602e-15 6.1429654e-15 9.6992112e-16]
  [2.5996696e-05 9.9997401e-01 2.0827541e-11 4.2758005e-11 2.3208935e-11]
  [2.2725626e-14 1.0000000e+00 6.4402996e-16 4.0675539e-15 6.5851592e-16]
  ...
  [8.3024871e-01 1.6975126e-01 1.4407839e-09 1.4849295e-09 1.4326178e-09]
  [3.2133816e-08 1.0000000e+00 6.9353084e-13 2.0083412e-12 6.8154260e-13]
  [2.1211254e-04 9.9978787e-01 6.0066507e-11 1.1040149e-10 7.0771868e-11]]

 [[1.1947987e-13 1.0000000e+00 1.4083820e-15 7.1821829e-15 1.1531244e-15]
  [6.0939965e-07 9.9999940e-01 3.2014437e-12 8.0426733e-12 3.4291688e-12]
  [1.8893041e-13 1.0000000e+00 1.8511350e-15 1.0473800e-14 1.9287273e-15]
  ...
  [8.1670135e-01 1.8329871e-01 1.4851206e-09 1.5385364e-09 1.4769203e-09]
  [1.0482852e-05 9.9998951e-01 1.2445499e-11 2.6297770e-11 1.2754495e-11]
  [5.3243735e-04 9.9946755e-01 9.2631069e-11 1.6040297e-10 1.0277604e-10]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[2.1868097e-08 1.0000000e+00 5.7602968e-13 1.6423806e-12 5.3137139e-13]
 [2.3298853e-03 9.9767011e-01 1.9525510e-10 3.1293701e-10 2.2408581e-10]
 [6.5913612e-01 3.4086382e-01 1.8303894e-09 1.9909963e-09 1.8552534e-09]
 ...
 [8.1670135e-01 1.8329871e-01 1.4851206e-09 1.5385364e-09 1.4769203e-09]
 [1.0482852e-05 9.9998951e-01 1.2445499e-11 2.6297770e-11 1.2754495e-11]
 [5.3243735e-04 9.9946755e-01 9.2631069e-11 1.6040297e-10 1.0277604e-10]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 0 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.368909324645996
tp :  19153.0
fp :  80847.0
tn :  319153.0
fn :  80847.0
accuracy :  0.6766151785850525
precision :  0.1915300041437149
recall :  0.1915300041437149
auc :  0.5601590275764465

y_eval {0: 100000}
pred {0: 19153, 1: 80847}
[INFO] confusion matrix for file 
[[19153 80847     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 589942 2199146       0       0       0]
 [  20781  260277       0       0       0]
 [   5967   21085       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 0.34741792  0.          0.         ...  4.          0.00482
  -0.23351   ]
 [ 0.34741792  0.          0.         ...  4.          0.00482
  -0.23351   ]
 [ 0.34741792  0.          0.         ...  2.          0.00482
  -0.33484   ]
 ...
 [ 1.0390323   0.          0.         ...  1.          0.00482
  -0.32151   ]
 [ 1.0390323   0.          0.         ...  2.          0.00482
  -0.33484   ]
 [ 1.0390323   0.          0.         ...  1.          0.00482
  -0.32151   ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[8.41487999e-14 1.00000000e+00 1.18454784e-15 6.14195787e-15
   9.69747269e-16]
  [2.40361675e-14 1.00000000e+00 6.76502239e-16 4.21560505e-15
   6.88527884e-16]
  [4.01531724e-04 9.99598444e-01 8.38407538e-11 1.49543003e-10
   1.02732073e-10]
  ...
  [7.64541209e-01 2.35458776e-01 1.63037761e-09 1.71962589e-09
   1.62812153e-09]
  [6.14027679e-02 9.38597262e-01 9.24722021e-10 1.21152222e-09
   9.51698498e-10]
  [8.11875820e-01 1.88124165e-01 1.50178736e-09 1.55919222e-09
   1.49733403e-09]]

 [[5.33833359e-11 1.00000000e+00 2.88937270e-14 1.10460557e-13
   2.45632643e-14]
  [9.38237882e-17 1.00000000e+00 4.34099819e-17 3.62493891e-16
   4.50982741e-17]
  [3.83903753e-09 1.00000000e+00 2.71553803e-13 9.19718837e-13
   3.51281368e-13]
  ...
  [6.74914002e-01 3.25086027e-01 1.80698900e-09 1.95685690e-09
   1.82488902e-09]
  [1.56241417e-01 8.43758583e-01 1.39894984e-09 1.73033810e-09
   1.42738799e-09]
  [8.12429488e-01 1.87570527e-01 1.49963031e-09 1.55645075e-09
   1.49440216e-09]]

 [[3.39520365e-01 6.60479665e-01 1.82620319e-09 2.13366369e-09
   1.88740312e-09]
  [1.55343820e-04 9.99844670e-01 4.85229530e-11 8.88680587e-11
   5.16978474e-11]
  [2.42320338e-14 1.00000000e+00 6.67071798e-16 4.19545541e-15
   6.88094626e-16]
  ...
  [1.31673855e-15 1.00000000e+00 1.63788815e-16 1.23615014e-15
   1.89137798e-16]
  [1.91384414e-03 9.98086214e-01 1.82776183e-10 2.99862551e-10
   2.20014798e-10]
  [6.22429192e-01 3.77570808e-01 1.87406113e-09 2.05713890e-09
   1.90154092e-09]]

 ...

 [[4.76577134e-06 9.99995232e-01 8.43519265e-12 1.82430182e-11
   8.27365086e-12]
  [3.91384549e-02 9.60861564e-01 7.70508102e-10 1.04815179e-09
   8.46287651e-10]
  [3.66183143e-04 9.99633789e-01 7.44587378e-11 1.30312025e-10
   7.95928323e-11]
  ...
  [1.09888776e-09 1.00000000e+00 1.31928905e-13 4.62200916e-13
   1.30798150e-13]
  [1.84033036e-01 8.15966964e-01 1.53976454e-09 1.90495641e-09
   1.65256586e-09]
  [1.24811645e-08 1.00000000e+00 4.36403599e-13 1.33392494e-12
   4.24028597e-13]]

 [[3.80467623e-02 9.61953223e-01 7.40687067e-10 9.97114058e-10
   7.87098886e-10]
  [3.67909104e-01 6.32090926e-01 1.87161686e-09 2.17912888e-09
   1.93628757e-09]
  [4.39749360e-02 9.56025004e-01 7.93155708e-10 1.06182529e-09
   8.31672009e-10]
  ...
  [1.06444400e-04 9.99893546e-01 3.97784271e-11 7.41788089e-11
   4.13150833e-11]
  [6.61455989e-01 3.38544011e-01 1.83252724e-09 1.99347761e-09
   1.85949045e-09]
  [1.45835923e-02 9.85416353e-01 4.62849731e-10 6.58937183e-10
   4.82508256e-10]]

 [[3.45252334e-11 1.00000000e+00 2.32724928e-14 9.08246053e-14
   1.96856674e-14]
  [1.40046310e-16 1.00000000e+00 5.29146280e-17 4.32790479e-16
   5.48759857e-17]
  [2.05052452e-19 1.00000000e+00 2.12372646e-18 2.44088260e-17
   2.32823466e-18]
  ...
  [1.29947141e-01 8.70052874e-01 1.32806621e-09 1.67817349e-09
   1.41722079e-09]
  [7.47288525e-01 2.52711445e-01 1.67260183e-09 1.77444404e-09
   1.67683423e-09]
  [7.52406418e-01 2.47593507e-01 1.65857739e-09 1.75576065e-09
   1.65654768e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[8.4148800e-14 1.0000000e+00 1.1845478e-15 6.1419579e-15 9.6974727e-16]
 [2.4036168e-14 1.0000000e+00 6.7650224e-16 4.2156051e-15 6.8852788e-16]
 [4.0153172e-04 9.9959844e-01 8.3840754e-11 1.4954300e-10 1.0273207e-10]
 ...
 [1.2994714e-01 8.7005287e-01 1.3280662e-09 1.6781735e-09 1.4172208e-09]
 [7.4728853e-01 2.5271145e-01 1.6726018e-09 1.7744440e-09 1.6768342e-09]
 [7.5240642e-01 2.4759351e-01 1.6585774e-09 1.7557606e-09 1.6565477e-09]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  8.301764533996582
tp :  19551.0
fp :  80449.0
tn :  319551.0
fn :  80449.0
accuracy :  0.6782071590423584
precision :  0.19550999999046326
recall :  0.19550999999046326
auc :  0.5556697249412537

y_eval {0: 100000}
pred {0: 19551, 1: 80449}
[INFO] confusion matrix for file 
[[19551 80449     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 609493 2279595       0       0       0]
 [  20781  260277       0       0       0]
 [   5967   21085       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0390323e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0390323e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.0390323e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [ 1.7331893e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.7331893e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.7331893e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.2492411e-12 1.0000000e+00 9.9729956e-15 4.2213845e-14 8.3140485e-15]
  [5.3915411e-02 9.4608456e-01 9.0529767e-10 1.2132674e-09 1.0084446e-09]
  [3.0332470e-09 1.0000000e+00 2.1825747e-13 7.2388108e-13 2.2180914e-13]
  ...
  [6.1548882e-09 1.0000000e+00 3.0867951e-13 9.8242703e-13 3.0744561e-13]
  [3.8976049e-09 1.0000000e+00 2.6560248e-13 8.8952494e-13 3.1097000e-13]
  [1.4092630e-08 1.0000000e+00 4.9501115e-13 1.5393611e-12 5.5320635e-13]]

 [[6.1907059e-12 1.0000000e+00 9.9266137e-15 4.2036280e-14 8.2748139e-15]
  [5.3522371e-02 9.4647759e-01 9.0222713e-10 1.2096990e-09 1.0051948e-09]
  [4.7552804e-04 9.9952447e-01 8.4785082e-11 1.4635082e-10 9.1720354e-11]
  ...
  [1.2306349e-09 1.0000000e+00 1.3954338e-13 4.8601764e-13 1.3833205e-13]
  [5.5682031e-06 9.9999440e-01 9.8719123e-12 2.2234693e-11 1.1774929e-11]
  [5.5521127e-04 9.9944478e-01 9.3908728e-11 1.6199256e-10 1.0316690e-10]]

 [[1.9155128e-13 1.0000000e+00 1.7782576e-15 8.8704365e-15 1.4575524e-15]
  [5.8338508e-02 9.4166154e-01 9.4011565e-10 1.2554465e-09 1.0465486e-09]
  [1.5378715e-02 9.8462129e-01 4.7806781e-10 6.8085432e-10 5.1298288e-10]
  ...
  [3.1263689e-10 1.0000000e+00 7.3280629e-14 2.7824179e-13 7.8837273e-14]
  [2.2606098e-17 1.0000000e+00 2.1607951e-17 1.9990122e-16 2.3648551e-17]
  [4.3087416e-06 9.9999571e-01 9.1226401e-12 2.1297120e-11 1.2419066e-11]]

 ...

 [[3.0871622e-08 1.0000000e+00 6.8417743e-13 1.9180035e-12 6.3526392e-13]
  [5.9804437e-03 9.9401963e-01 3.1059416e-10 4.7144733e-10 3.5142542e-10]
  [7.8365421e-01 2.1634576e-01 1.5844860e-09 1.6621812e-09 1.5872779e-09]
  ...
  [1.4680747e-10 1.0000000e+00 4.9175955e-14 1.9302013e-13 4.9220434e-14]
  [2.7409527e-01 7.2590470e-01 1.7650283e-09 2.1191775e-09 1.8761628e-09]
  [3.7752155e-02 9.6224779e-01 7.3720791e-10 9.9516761e-10 7.6491868e-10]]

 [[1.1649471e-11 1.0000000e+00 1.3577987e-14 5.5803537e-14 1.1372673e-14]
  [5.8351775e-11 1.0000000e+00 3.2120357e-14 1.3301664e-13 3.3478083e-14]
  [9.9639229e-02 9.0036076e-01 1.1941582e-09 1.5384531e-09 1.3009500e-09]
  ...
  [2.0943377e-03 9.9790573e-01 1.7614102e-10 2.7891375e-10 1.8404964e-10]
  [7.3118645e-01 2.6881361e-01 1.7108674e-09 1.8251385e-09 1.7235462e-09]
  [4.1639511e-02 9.5836049e-01 7.7041190e-10 1.0330607e-09 7.9689089e-10]]

 [[3.1561923e-01 6.8438077e-01 1.7869045e-09 2.0940498e-09 1.8008814e-09]
  [3.9047359e-03 9.9609524e-01 2.4238034e-10 3.7203729e-10 2.5981656e-10]
  [2.1995650e-11 1.0000000e+00 1.9133903e-14 8.3044642e-14 1.9169921e-14]
  ...
  [1.8394003e-08 1.0000000e+00 5.8139637e-13 1.8031520e-12 7.0453430e-13]
  [6.3366419e-09 1.0000000e+00 3.3064095e-13 1.0716098e-12 3.6678001e-13]
  [2.1211413e-01 7.8788584e-01 1.6155228e-09 1.9761961e-09 1.7183773e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.2492411e-12 1.0000000e+00 9.9729956e-15 4.2213845e-14 8.3140485e-15]
 [5.3915411e-02 9.4608456e-01 9.0529767e-10 1.2132674e-09 1.0084446e-09]
 [3.0332470e-09 1.0000000e+00 2.1825747e-13 7.2388108e-13 2.2180914e-13]
 ...
 [1.8394003e-08 1.0000000e+00 5.8139637e-13 1.8031520e-12 7.0453430e-13]
 [6.3366419e-09 1.0000000e+00 3.3064095e-13 1.0716098e-12 3.6678001e-13]
 [2.1211413e-01 7.8788584e-01 1.6155228e-09 1.9761961e-09 1.7183773e-09]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.171378198242188
tp :  20425.0
fp :  79575.0
tn :  320425.0
fn :  79575.0
accuracy :  0.6817031502723694
precision :  0.20424999296665192
recall :  0.20424999296665192
auc :  0.5538706183433533

y_eval {0: 100000}
pred {0: 20425, 1: 79575}
[INFO] confusion matrix for file 
[[20425 79575     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 629918 2359170       0       0       0]
 [  20781  260277       0       0       0]
 [   5967   21085       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-01_203011_118.log.part06_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0:99.9988%,2:0.0008%,1:0.0004%]
[INFO] ** type:[0:99.9986%,1:0.001%,2:0.0004%]
[INFO] ** i/f_name:[2:99.998%,3:0.002%]
[INFO] ** i/f_dir:[1:99.9982%,0:0.0018%]
[INFO] ** src:[22:38.138%,9:26.0904%,7:18.1762%,1:17.5892%,10:0.0018%,11:0.0016%,14:0.0012%,21:0.0008%,15:0.0006%,4:0.0002%]
[INFO] ** dst:[21:43.3838%,10:20.845%,8:18.1758%,9:17.589%,15:0.002%,22:0.0014%,6:0.0014%,25:0.0004%,24:0.0004%,18:0.0004%,7:0.0004%]
[INFO] ** proto:[0:99.9954%,2:0.0026%,1:0.002%]
[INFO] ** appi_name:[21:99.9944%,30:0.002%,26:0.0008%,22:0.0006%,31:0.0004%,27:0.0004%,15:0.0004%,0:0.0004%,24:0.0002%,16:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.138%,20:26.0904%,13:18.1762%,6:17.5892%,17:0.002%,11:0.0018%,10:0.0016%,16:0.0006%,21:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9944%,-33.760870000000004:0.0052%,0.9188299999999999:0.0004%]
[INFO] ** modbus_function_description:[7:49.998%,11:49.9964%,0:0.0052%,15:0.0004%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.0894%,1:20.8438%,5:18.1758%,4:17.5888%,2:17.294%,0:0.0082%]
[INFO] ** service:[0.0048200000000000005:99.9954%,-211.73542999999998:0.002%,-211.08346:0.0008%,-211.08818:0.0006%,-186.44547:0.0004%,-186.43601999999998:0.0004%,-202.75898:0.0004%]
[INFO] ** s_port:[1.45442:26.0898%,-0.32151:20.844%,-1.27613:18.1758%,-0.23351:17.589%,-0.33484:17.294%,-71.33197:0.002%,-6.46392:0.0008%,-71.14798:0.0008%,1.45709:0.0006%,-71.14931:0.0006%,-1.02014:0.0006%,-1.27347:0.0004%,-68.79874000000001:0.0004%,-64.19493:0.0004%,-1.81611:0.0004%,-6.49859:0.0002%,-0.24151:0.0002%]
[INFO] ** classification:[normal:90.7904%,Single Stage Multi Point:5.7378%,Single Stage Single Point:3.4718%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7324393e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.7324393e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.7324393e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [-1.0386956e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0386956e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.0386956e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[4.09543830e-08 1.00000000e+00 7.87683178e-13 2.17707926e-12
   7.34391931e-13]
  [9.52503160e-06 9.99990463e-01 1.26083892e-11 2.73267138e-11
   1.43577112e-11]
  [1.70557748e-10 1.00000000e+00 5.34647738e-14 2.09118936e-13
   5.54941326e-14]
  ...
  [1.04534486e-02 9.89546597e-01 4.12138379e-10 6.07899786e-10
   4.64771943e-10]
  [6.47739887e-01 3.52260113e-01 1.84521676e-09 2.01298667e-09
   1.87103866e-09]
  [5.78554988e-01 4.21444952e-01 1.90131089e-09 2.10499662e-09
   1.91662863e-09]]

 [[6.89632921e-13 1.00000000e+00 3.34959497e-15 1.57347364e-14
   2.75733089e-15]
  [2.01441503e-15 1.00000000e+00 1.98022751e-16 1.40716842e-15
   2.02837087e-16]
  [9.82381380e-07 9.99999046e-01 4.25317941e-12 1.06141797e-11
   5.42071683e-12]
  ...
  [1.20004131e-07 9.99999881e-01 1.34204778e-12 3.62368794e-12
   1.34140800e-12]
  [2.52619028e-01 7.47380912e-01 1.71531556e-09 2.07098450e-09
   1.81577153e-09]
  [3.63309383e-08 1.00000000e+00 7.40382040e-13 2.13295614e-12
   7.18331373e-13]]

 [[3.87597439e-08 1.00000000e+00 7.66343261e-13 2.12391931e-12
   7.13858280e-13]
  [3.67144644e-17 1.00000000e+00 2.72526663e-17 2.39438506e-16
   2.85461717e-17]
  [1.94074892e-04 9.99805987e-01 5.92458443e-11 1.10772613e-10
   7.54533866e-11]
  ...
  [9.14562717e-02 9.08543766e-01 1.14884779e-09 1.48785995e-09
   1.24485955e-09]
  [6.75851285e-01 3.24148685e-01 1.80508608e-09 1.95434868e-09
   1.82402460e-09]
  [1.99812060e-08 1.00000000e+00 5.48746324e-13 1.63196344e-12
   5.38815628e-13]]

 ...

 [[7.65821412e-02 9.23417926e-01 1.02537101e-09 1.32223710e-09
   1.06503428e-09]
  [4.16219613e-04 9.99583781e-01 7.98089719e-11 1.38780404e-10
   8.59396096e-11]
  [6.36284411e-01 3.63715649e-01 1.86295090e-09 2.03939265e-09
   1.89480898e-09]
  ...
  [9.26274968e-09 1.00000000e+00 3.74540243e-13 1.16172263e-12
   3.67747418e-13]
  [2.01262251e-01 7.98737824e-01 1.59034907e-09 1.95414906e-09
   1.69992620e-09]
  [4.88062346e-09 1.00000000e+00 2.74087963e-13 8.81902570e-13
   2.64632608e-13]]

 [[2.13460950e-11 1.00000000e+00 1.83344720e-14 7.32247379e-14
   1.54441211e-14]
  [2.86183280e-07 9.99999762e-01 2.21076412e-12 5.81215805e-12
   2.49391068e-12]
  [2.54028827e-01 7.45971203e-01 1.70828973e-09 2.05788853e-09
   1.80282056e-09]
  ...
  [2.51147302e-12 1.00000000e+00 6.67805392e-15 3.28427064e-14
   6.77933746e-15]
  [1.10696675e-03 9.98893082e-01 1.37422962e-10 2.31238403e-10
   1.62057298e-10]
  [5.43417513e-01 4.56582516e-01 1.93017446e-09 2.15949214e-09
   1.97137706e-09]]

 [[8.21916591e-14 1.00000000e+00 1.17076534e-15 6.07535948e-15
   9.57846350e-16]
  [9.61175410e-12 1.00000000e+00 1.31164585e-14 5.95785425e-14
   1.31708592e-14]
  [2.42014517e-06 9.99997616e-01 6.50411886e-12 1.53047297e-11
   7.74834103e-12]
  ...
  [5.88960230e-01 4.11039740e-01 1.89373028e-09 2.09135198e-09
   1.90835725e-09]
  [4.40421815e-08 1.00000000e+00 8.13436016e-13 2.31843949e-12
   8.06690218e-13]
  [3.04700971e-01 6.95299089e-01 1.81531157e-09 2.15942708e-09
   1.91503746e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[4.0954383e-08 1.0000000e+00 7.8768318e-13 2.1770793e-12 7.3439193e-13]
 [9.5250316e-06 9.9999046e-01 1.2608389e-11 2.7326714e-11 1.4357711e-11]
 [1.7055775e-10 1.0000000e+00 5.3464774e-14 2.0911894e-13 5.5494133e-14]
 ...
 [5.8896023e-01 4.1103974e-01 1.8937303e-09 2.0913520e-09 1.9083573e-09]
 [4.4042181e-08 1.0000000e+00 8.1343602e-13 2.3184395e-12 8.0669022e-13]
 [3.0470097e-01 6.9529909e-01 1.8153116e-09 2.1594271e-09 1.9150375e-09]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 0 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.394992485046387
tp :  21398.0
fp :  78602.0
tn :  321398.0
fn :  78602.0
accuracy :  0.6855950951576233
precision :  0.21398000419139862
recall :  0.21398000419139862
auc :  0.564714252948761

y_eval {0: 100000}
pred {0: 21398, 1: 78602}
[INFO] confusion matrix for file 
[[21398 78602     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 651316 2437772       0       0       0]
 [  20781  260277       0       0       0]
 [   5967   21085       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0386956e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0386956e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.0386956e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [-3.4749308e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4749308e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-3.4749308e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[2.32149508e-10 1.00000000e+00 5.99538187e-14 2.13512855e-13
   5.17874250e-14]
  [5.87350398e-04 9.99412656e-01 9.90522386e-11 1.71857417e-10
   1.16523874e-10]
  [1.33717544e-08 1.00000000e+00 4.62938498e-13 1.42340480e-12
   4.86448935e-13]
  ...
  [3.50285582e-02 9.64971483e-01 7.43612172e-10 1.02452735e-09
   8.33645264e-10]
  [1.65287524e-01 8.34712446e-01 1.44031187e-09 1.78048243e-09
   1.49639667e-09]
  [1.72638770e-09 1.00000000e+00 1.64372734e-13 5.60575674e-13
   1.63171356e-13]]

 [[4.55378778e-02 9.54462111e-01 8.07012068e-10 1.07529741e-09
   8.56507587e-10]
  [5.39660752e-02 9.46033955e-01 8.81947959e-10 1.17026022e-09
   9.38649602e-10]
  [7.00824082e-01 2.99175858e-01 1.76524062e-09 1.89833282e-09
   1.77976445e-09]
  ...
  [3.36259482e-08 1.00000000e+00 8.02970700e-13 2.42709151e-12
   1.07302307e-12]
  [2.02931860e-03 9.97970641e-01 1.81773638e-10 2.93631314e-10
   2.04757905e-10]
  [6.18032217e-01 3.81967783e-01 1.87883242e-09 2.06463158e-09
   1.90667704e-09]]

 [[2.22361005e-10 1.00000000e+00 5.86839605e-14 2.09425874e-13
   5.06643440e-14]
  [5.90945506e-16 1.00000000e+00 1.07683643e-16 8.19558216e-16
   1.11536729e-16]
  [7.41720374e-04 9.99258220e-01 1.14173594e-10 1.97375505e-10
   1.40320783e-10]
  ...
  [5.56377351e-01 4.43622649e-01 1.92157090e-09 2.14160778e-09
   1.95365635e-09]
  [1.04109375e-07 9.99999881e-01 1.25244205e-12 3.40723175e-12
   1.25097133e-12]
  [2.22572172e-03 9.97774303e-01 1.91444111e-10 3.07837339e-10
   2.18217347e-10]]

 ...

 [[7.50887118e-14 1.00000000e+00 1.11975035e-15 5.83695783e-15
   9.16549577e-16]
  [1.83068737e-01 8.16931248e-01 1.53661728e-09 1.90412885e-09
   1.65521319e-09]
  [1.17127308e-10 1.00000000e+00 4.32655553e-14 1.70979943e-13
   4.28634890e-14]
  ...
  [6.98343873e-01 3.01656127e-01 1.76935400e-09 1.90396166e-09
   1.78347948e-09]
  [2.63564353e-08 1.00000000e+00 6.29171953e-13 1.84336530e-12
   6.18133474e-13]
  [3.15289348e-01 6.84710681e-01 1.83156523e-09 2.17197371e-09
   1.93040872e-09]]

 [[6.04354566e-10 1.00000000e+00 9.64756026e-14 3.28072882e-13
   8.43966552e-14]
  [2.08371799e-15 1.00000000e+00 2.00709645e-16 1.43163624e-15
   2.07770035e-16]
  [7.29346239e-19 1.00000000e+00 3.97273217e-18 4.31655898e-17
   4.35916655e-18]
  ...
  [1.86859146e-02 9.81314063e-01 5.42287326e-10 7.71119169e-10
   5.97674299e-10]
  [9.97867655e-09 1.00000000e+00 3.94920099e-13 1.22655553e-12
   3.93784343e-13]
  [5.62550494e-14 1.00000000e+00 1.04421195e-15 6.39698848e-15
   1.18532986e-15]]

 [[1.36943206e-01 8.63056779e-01 1.32848466e-09 1.65667824e-09
   1.39378620e-09]
  [1.50988006e-03 9.98490095e-01 1.51593016e-10 2.45491572e-10
   1.62823033e-10]
  [6.42710924e-01 3.57289106e-01 1.85393956e-09 2.02558348e-09
   1.88255678e-09]
  ...
  [4.81770843e-01 5.18229127e-01 1.94352556e-09 2.20769492e-09
   2.00440908e-09]
  [3.81193832e-09 1.00000000e+00 2.42617829e-13 7.90645435e-13
   2.38575002e-13]
  [1.74243695e-07 9.99999881e-01 1.78326657e-12 4.88163026e-12
   2.23736177e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[2.3214951e-10 1.0000000e+00 5.9953819e-14 2.1351286e-13 5.1787425e-14]
 [5.8735040e-04 9.9941266e-01 9.9052239e-11 1.7185742e-10 1.1652387e-10]
 [1.3371754e-08 1.0000000e+00 4.6293850e-13 1.4234048e-12 4.8644893e-13]
 ...
 [4.8177084e-01 5.1822913e-01 1.9435256e-09 2.2076949e-09 2.0044091e-09]
 [3.8119383e-09 1.0000000e+00 2.4261783e-13 7.9064544e-13 2.3857500e-13]
 [1.7424370e-07 9.9999988e-01 1.7832666e-12 4.8816303e-12 2.2373618e-12]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.411296725463867
tp :  19934.0
fp :  80066.0
tn :  319934.0
fn :  80066.0
accuracy :  0.6797391176223755
precision :  0.19934000074863434
recall :  0.19934000074863434
auc :  0.5623830556869507

y_eval {0: 100000}
pred {0: 19934, 1: 80066}
[INFO] confusion matrix for file 
[[19934 80066     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 671250 2517838       0       0       0]
 [  20781  260277       0       0       0]
 [   5967   21085       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4749308e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4749308e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-3.4749308e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [ 3.4625062e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4625062e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 3.4625062e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.34661853e-01 8.65338147e-01 1.31914490e-09 1.64679559e-09
   1.38425138e-09]
  [1.54499538e-14 1.00000000e+00 5.28069774e-16 3.35558031e-15
   5.32637981e-16]
  [2.24516637e-17 1.00000000e+00 2.17893071e-17 2.00750223e-16
   2.48562778e-17]
  ...
  [7.84701049e-01 2.15298980e-01 1.57965441e-09 1.65561520e-09
   1.57730307e-09]
  [5.94254516e-07 9.99999404e-01 2.97206574e-12 7.34286850e-12
   2.98635118e-12]
  [9.02445341e-11 1.00000000e+00 3.99518675e-14 1.62694944e-13
   4.32399816e-14]]

 [[5.22843505e-11 1.00000000e+00 2.85943856e-14 1.09392516e-13
   2.42847802e-14]
  [1.22494192e-03 9.98775065e-01 1.42917192e-10 2.38228576e-10
   1.68367736e-10]
  [5.50833934e-10 1.00000000e+00 9.47775658e-14 3.46388445e-13
   9.78088866e-14]
  ...
  [4.27217364e-01 5.72782636e-01 1.91156069e-09 2.19285679e-09
   1.95572758e-09]
  [7.88305998e-01 2.11693957e-01 1.56975222e-09 1.64318903e-09
   1.56688351e-09]
  [1.07329538e-06 9.99998927e-01 3.99119583e-12 9.55070658e-12
   4.02619865e-12]]

 [[5.13972337e-11 1.00000000e+00 2.83524967e-14 1.08556122e-13
   2.40751226e-14]
  [9.49652511e-17 1.00000000e+00 4.36657495e-17 3.64341878e-16
   4.53331967e-17]
  [1.24692204e-19 1.00000000e+00 1.66071190e-18 1.95268921e-17
   1.81771864e-18]
  ...
  [7.75799751e-01 2.24200219e-01 1.60449287e-09 1.68708714e-09
   1.60567459e-09]
  [2.57762949e-05 9.99974251e-01 1.95235807e-11 3.92863832e-11
   2.00098375e-11]
  [1.05560288e-01 8.94439697e-01 1.21027510e-09 1.54767021e-09
   1.28717681e-09]]

 ...

 [[4.12595153e-01 5.87404847e-01 1.89753591e-09 2.17893237e-09
   1.95277283e-09]
  [1.09332858e-13 1.00000000e+00 1.38099394e-15 7.88841614e-15
   1.37097894e-15]
  [6.78162216e-20 1.00000000e+00 1.22530316e-18 1.48678055e-17
   1.32084676e-18]
  ...
  [1.70026819e-04 9.99829888e-01 5.02677309e-11 9.13481721e-11
   5.22448543e-11]
  [6.75317526e-01 3.24682474e-01 1.81258253e-09 1.96483207e-09
   1.83809834e-09]
  [6.80526346e-02 9.31947351e-01 9.71742020e-10 1.26652788e-09
   1.00357378e-09]]

 [[8.47947133e-14 1.00000000e+00 1.18902981e-15 6.16296344e-15
   9.73420216e-16]
  [3.07537121e-05 9.99969244e-01 2.26508326e-11 4.60833316e-11
   2.52941973e-11]
  [1.74055007e-11 1.00000000e+00 1.72410948e-14 7.61416822e-14
   1.78213953e-14]
  ...
  [7.11520389e-02 9.28847969e-01 1.03016007e-09 1.35602984e-09
   1.12933529e-09]
  [1.71829670e-05 9.99982834e-01 1.61116502e-11 3.32667401e-11
   1.66454229e-11]
  [1.28838168e-02 9.87116158e-01 4.47884008e-10 6.48462228e-10
   4.88658503e-10]]

 [[4.04267401e-01 5.95732570e-01 1.89166616e-09 2.17635621e-09
   1.94768290e-09]
  [6.47842890e-09 1.00000000e+00 3.17967603e-13 1.00612942e-12
   3.19118972e-13]
  [3.56734309e-13 1.00000000e+00 2.61208274e-15 1.44441852e-14
   2.98114686e-15]
  ...
  [2.33550309e-05 9.99976635e-01 2.03133291e-11 4.23965724e-11
   2.49826305e-11]
  [5.13757348e-01 4.86242652e-01 1.94409022e-09 2.19251350e-09
   2.00035410e-09]
  [1.79418959e-02 9.82058108e-01 5.12083986e-10 7.19911075e-10
   5.28047106e-10]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.3466185e-01 8.6533815e-01 1.3191449e-09 1.6467956e-09 1.3842514e-09]
 [1.5449954e-14 1.0000000e+00 5.2806977e-16 3.3555803e-15 5.3263798e-16]
 [2.2451664e-17 1.0000000e+00 2.1789307e-17 2.0075022e-16 2.4856278e-17]
 ...
 [2.3355031e-05 9.9997663e-01 2.0313329e-11 4.2396572e-11 2.4982631e-11]
 [5.1375735e-01 4.8624265e-01 1.9440902e-09 2.1925135e-09 2.0003541e-09]
 [1.7941896e-02 9.8205811e-01 5.1208399e-10 7.1991108e-10 5.2804711e-10]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 0 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.360521545410156
tp :  19159.0
fp :  80841.0
tn :  319159.0
fn :  80841.0
accuracy :  0.6766391396522522
precision :  0.19158999621868134
recall :  0.19158999621868134
auc :  0.559748113155365

y_eval {0: 100000}
pred {0: 19159, 1: 80841}
[INFO] confusion matrix for file 
[[19159 80841     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 690409 2598679       0       0       0]
 [  20781  260277       0       0       0]
 [   5967   21085       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4625062e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4625062e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 3.4625062e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 ...
 [ 1.0399942e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.0399942e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0399942e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.23859714e-11 1.00000000e+00 3.12177449e-14 1.18457842e-13
   2.65825841e-14]
  [1.12125444e-16 1.00000000e+00 4.74032427e-17 3.92336794e-16
   4.92398913e-17]
  [2.16975878e-03 9.97830212e-01 1.94254418e-10 3.15793558e-10
   2.35793274e-10]
  ...
  [6.49329543e-01 3.50670487e-01 1.84270932e-09 2.00880246e-09
   1.86581461e-09]
  [4.32821956e-08 1.00000000e+00 8.06108869e-13 2.29934431e-12
   7.94114015e-13]
  [1.74388513e-01 8.25611472e-01 1.50470303e-09 1.86702320e-09
   1.61054947e-09]]

 [[1.75877810e-02 9.82412279e-01 5.09448705e-10 7.16312898e-10
   5.44413292e-10]
  [4.05074283e-03 9.95949268e-01 2.49340965e-10 3.83237775e-10
   2.69521627e-10]
  [6.10313177e-01 3.89686882e-01 1.88618787e-09 2.07657247e-09
   1.91761296e-09]
  ...
  [4.36188566e-06 9.99995589e-01 8.92962093e-12 2.05832174e-11
   1.12906611e-11]
  [5.78040282e-10 1.00000000e+00 9.83817926e-14 3.60415175e-13
   1.02025735e-13]
  [3.42109665e-08 1.00000000e+00 7.89194556e-13 2.35744844e-12
   9.60680103e-13]]

 [[3.55949965e-06 9.99996424e-01 7.30100615e-12 1.60537382e-11
   7.19641577e-12]
  [2.70959828e-02 9.72904027e-01 6.46540099e-10 8.98838171e-10
   7.13620996e-10]
  [7.74437368e-01 2.25562587e-01 1.60792546e-09 1.69163505e-09
   1.61050384e-09]
  ...
  [7.18693202e-03 9.92813051e-01 3.49552415e-10 5.30866073e-10
   4.11871037e-10]
  [8.38516105e-04 9.99161482e-01 1.12941018e-10 1.88870961e-10
   1.18811058e-10]
  [3.21851351e-13 1.00000000e+00 2.37945362e-15 1.30115560e-14
   2.40662029e-15]]

 ...

 [[3.23916934e-02 9.67608333e-01 6.81035950e-10 9.19810283e-10
   6.92642610e-10]
  [1.31655415e-13 1.00000000e+00 1.51272080e-15 8.55280507e-15
   1.48614694e-15]
  [2.61604135e-15 1.00000000e+00 2.31947849e-16 1.67082437e-15
   2.74399288e-16]
  ...
  [9.64395795e-03 9.90356088e-01 3.76516457e-10 5.48003753e-10
   3.91194910e-10]
  [1.12938026e-09 1.00000000e+00 1.33656256e-13 4.67418205e-13
   1.32269548e-13]
  [2.09097937e-01 7.90902078e-01 1.61362967e-09 1.97784877e-09
   1.72589365e-09]]

 [[3.08034346e-02 9.69196618e-01 6.64672373e-10 9.00211239e-10
   6.75952516e-10]
  [4.51207370e-06 9.99995470e-01 8.32322579e-12 1.84941524e-11
   8.67663667e-12]
  [1.16135861e-13 1.00000000e+00 1.45405371e-15 8.42746876e-15
   1.50536972e-15]
  ...
  [1.24028847e-01 8.75971138e-01 1.27245758e-09 1.59946301e-09
   1.31408984e-09]
  [1.18850740e-09 1.00000000e+00 1.36335293e-13 4.74463947e-13
   1.34638272e-13]
  [1.60878656e-07 9.99999881e-01 1.71004140e-12 4.69752015e-12
   2.10558264e-12]]

 [[1.26845389e-05 9.99987364e-01 1.37544065e-11 2.82757116e-11
   1.36489041e-11]
  [3.19277495e-02 9.68072176e-01 6.97060298e-10 9.57974589e-10
   7.61169461e-10]
  [1.17818955e-02 9.88218129e-01 4.19557195e-10 6.06493467e-10
   4.48537096e-10]
  ...
  [6.45114958e-01 3.54884982e-01 1.85768956e-09 2.03076489e-09
   1.89372229e-09]
  [8.49928893e-03 9.91500735e-01 3.53951896e-10 5.18920351e-10
   3.67707920e-10]
  [2.20463994e-10 1.00000000e+00 5.95626386e-14 2.27778869e-13
   5.90057449e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.2385971e-11 1.0000000e+00 3.1217745e-14 1.1845784e-13 2.6582584e-14]
 [1.1212544e-16 1.0000000e+00 4.7403243e-17 3.9233679e-16 4.9239891e-17]
 [2.1697588e-03 9.9783021e-01 1.9425442e-10 3.1579356e-10 2.3579327e-10]
 ...
 [6.4511496e-01 3.5488498e-01 1.8576896e-09 2.0307649e-09 1.8937223e-09]
 [8.4992889e-03 9.9150074e-01 3.5395190e-10 5.1892035e-10 3.6770792e-10]
 [2.2046399e-10 1.0000000e+00 5.9562639e-14 2.2777887e-13 5.9005745e-14]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 0 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  7.383488966369629
tp :  29618.0
fp :  70382.0
tn :  329618.0
fn :  70382.0
accuracy :  0.7184748649597168
precision :  0.29618000984191895
recall :  0.29618000984191895
auc :  0.6121166944503784

y_eval {0: 82641, 1: 17359}
pred {0: 19713, 1: 80287}
[INFO] confusion matrix for file 
[[15986 66655     0     0     0]
 [ 3727 13632     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 706395 2665334       0       0       0]
 [  24508  273909       0       0       0]
 [   5967   21085       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0399942  0.         0.        ...  4.         0.00482   -0.23351  ]
 [ 1.0399942  0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 1.0399942  0.         0.        ...  1.         0.00482   -0.32151  ]
 ...
 [ 1.733738   0.         0.        ...  2.         0.00482   -0.33484  ]
 [ 1.733738   0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 1.733738   0.         0.        ...  3.         0.00482    1.45442  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [0. 0. 1. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 2 2] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.9420591e-13 1.0000000e+00 1.7904006e-15 8.9252192e-15 1.4675502e-15]
  [1.7694769e-02 9.8230529e-01 5.3167920e-10 7.6158657e-10 6.0043176e-10]
  [7.2111982e-01 2.7888015e-01 1.7278076e-09 1.8474900e-09 1.7411897e-09]
  ...
  [7.9022473e-01 2.0977522e-01 1.5664221e-09 1.6393059e-09 1.5663563e-09]
  [1.8019151e-07 9.9999976e-01 1.6349384e-12 4.3102340e-12 1.6172814e-12]
  [2.8334037e-12 1.0000000e+00 7.0979125e-15 3.4675316e-14 7.2307306e-15]]

 [[1.1604232e-05 9.9998844e-01 1.3156215e-11 2.7171260e-11 1.3041837e-11]
  [2.9795032e-02 9.7020501e-01 6.7438810e-10 9.3059432e-10 7.3717799e-10]
  [1.2880865e-01 8.7119138e-01 1.2996807e-09 1.6335668e-09 1.3637174e-09]
  ...
  [1.6764636e-09 1.0000000e+00 1.6164884e-13 5.5218167e-13 1.5986190e-13]
  [4.1212761e-01 5.8787245e-01 1.9349620e-09 2.2393782e-09 2.0239357e-09]
  [7.0311254e-01 2.9688740e-01 1.7588491e-09 1.8895085e-09 1.7693910e-09]]

 [[2.5094787e-02 9.7490519e-01 6.0168298e-10 8.2415397e-10 6.1168520e-10]
  [1.6648626e-05 9.9998331e-01 1.5992466e-11 3.3124427e-11 1.6872444e-11]
  [1.0656842e-03 9.9893433e-01 1.3004040e-10 2.1629097e-10 1.4329704e-10]
  ...
  [7.5895244e-01 2.4104758e-01 1.6484839e-09 1.7434721e-09 1.6550463e-09]
  [5.7821730e-08 1.0000000e+00 9.3000130e-13 2.6091588e-12 9.1320061e-13]
  [1.8534432e-10 1.0000000e+00 5.8295952e-14 2.3000978e-13 6.7971568e-14]]

 ...

 [[1.2367223e-03 9.9876332e-01 1.3624042e-10 2.2106159e-10 1.4471549e-10]
  [1.3727988e-01 8.6272007e-01 1.3483618e-09 1.6925187e-09 1.4305352e-09]
  [8.2004297e-01 1.7995705e-01 1.4751516e-09 1.5265715e-09 1.4688541e-09]
  ...
  [1.2865511e-03 9.9871349e-01 1.3811952e-10 2.2450376e-10 1.4271852e-10]
  [6.2780881e-01 3.7219116e-01 1.8708035e-09 2.0513395e-09 1.8999891e-09]
  [8.2885730e-01 1.7114268e-01 1.4455476e-09 1.4906919e-09 1.4377658e-09]]

 [[3.3559036e-13 1.0000000e+00 2.3461051e-15 1.1400211e-14 1.9263230e-15]
  [7.6684339e-09 1.0000000e+00 3.6242325e-13 1.1528007e-12 3.7777816e-13]
  [8.0915466e-02 9.1908455e-01 1.0833276e-09 1.4117565e-09 1.1773347e-09]
  ...
  [8.8634233e-10 1.0000000e+00 1.1881197e-13 4.2138572e-13 1.1789456e-13]
  [2.6522440e-01 7.3477560e-01 1.7465566e-09 2.1018367e-09 1.8552041e-09]
  [8.1525975e-01 1.8474022e-01 1.4904122e-09 1.5452615e-09 1.4848565e-09]]

 [[2.3324299e-11 1.0000000e+00 1.9157639e-14 7.6174798e-14 1.6143554e-14]
  [2.1091178e-03 9.9789089e-01 1.8704008e-10 3.0241068e-10 2.1925964e-10]
  [2.8935661e-09 1.0000000e+00 2.1569782e-13 7.2003232e-13 2.2409098e-13]
  ...
  [7.1158928e-01 2.8841072e-01 1.7478733e-09 1.8746149e-09 1.7616761e-09]
  [8.2382417e-01 1.7617585e-01 1.4622626e-09 1.5108770e-09 1.4547099e-09]
  [1.2333578e-02 9.8766637e-01 4.2485127e-10 6.0968663e-10 4.4031337e-10]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.9420591e-13 1.0000000e+00 1.7904006e-15 8.9252192e-15 1.4675502e-15]
 [1.7694769e-02 9.8230529e-01 5.3167920e-10 7.6158657e-10 6.0043176e-10]
 [7.2111982e-01 2.7888015e-01 1.7278076e-09 1.8474900e-09 1.7411897e-09]
 ...
 [7.1158928e-01 2.8841072e-01 1.7478733e-09 1.8746149e-09 1.7616761e-09]
 [8.2382417e-01 1.7617585e-01 1.4622626e-09 1.5108770e-09 1.4547099e-09]
 [1.2333578e-02 9.8766637e-01 4.2485127e-10 6.0968663e-10 4.4031337e-10]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 0 0 1] (100000,)
[33m[INFO] metrics:[0m
loss :  10.899329440307618
tp :  14224.0
fp :  85776.0
tn :  314224.0
fn :  85776.0
accuracy :  0.6568992733955383
precision :  0.1422400027513504
recall :  0.1422400027513504
auc :  0.47461265325546265

y_eval {0: 71311, 2: 28689}
pred {0: 20688, 1: 79312}
[INFO] confusion matrix for file 
[[14224 57087     0     0     0]
 [    0     0     0     0     0]
 [ 6464 22225     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 720619 2722421       0       0       0]
 [  24508  273909       0       0       0]
 [  12431   43310       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-01_203011_118.log.part07_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0:99.9996%,2:0.0004%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9994%,3:0.0006%]
[INFO] ** i/f_dir:[1:99.9994%,0:0.0006%]
[INFO] ** src:[22:38.0718%,9:26.1174%,7:18.2344%,1:17.5754%,21:0.0008%,14:0.0002%]
[INFO] ** dst:[21:43.3758%,10:20.813%,8:18.2342%,9:17.5754%,15:0.0006%,22:0.0004%,24:0.0002%,18:0.0002%,6:0.0002%]
[INFO] ** proto:[0:99.999%,1:0.0006%,2:0.0004%]
[INFO] ** appi_name:[21:99.999%,30:0.0006%,31:0.0002%,22:0.0002%]
[INFO] ** proxy_src_ip:[18:38.0718%,20:26.1174%,13:18.2344%,6:17.5754%,17:0.0006%,7:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.999%,-33.760870000000004:0.001%]
[INFO] ** modbus_function_description:[7:49.9996%,11:49.9994%,0:0.001%]
[INFO] ** modbus_transaction_id:65301 (13.0602%)
[INFO] ** scada_tag:[3:26.1164%,1:20.813%,5:18.2338%,4:17.575%,2:17.2586%,0:0.0032%]
[INFO] ** service:[0.0048200000000000005:99.999%,-211.73542999999998:0.0006%,-186.43601999999998:0.0002%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:26.1168%,-0.32151:20.813%,-1.27613:18.234%,-0.23351:17.5752%,-0.33484:17.2588%,-71.33197:0.0006%,-1.27347:0.0002%,1.45709:0.0002%,1.46509:0.0002%,1.47576:0.0002%,4.42897:0.0002%,-0.24151:0.0002%,-71.14931:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:89.2092%,Single Stage Multi Point:10.7908%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7311594e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.7311594e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.7311594e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [-1.0380956e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.0380956e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0380956e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[0. 0. 1. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 1. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [2 0 0 ... 2 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[4.34378222e-09 1.00000000e+00 2.57434671e-13 7.94938388e-13
   2.31503591e-13]
  [3.30819438e-17 1.00000000e+00 2.59047755e-17 2.28616813e-16
   2.70953101e-17]
  [4.90013058e-19 1.00000000e+00 3.27326990e-18 3.60995086e-17
   3.63231302e-18]
  ...
  [2.40331709e-01 7.59668291e-01 1.67899217e-09 2.03219308e-09
   1.77161108e-09]
  [5.58581114e-01 4.41418916e-01 1.91491401e-09 2.13083284e-09
   1.93612704e-09]
  [2.06867612e-09 1.00000000e+00 1.78395981e-13 6.00639547e-13
   1.74371178e-13]]

 [[7.24828522e-14 1.00000000e+00 1.10029379e-15 5.74333062e-15
   9.00036457e-16]
  [1.71034653e-02 9.82896507e-01 5.23841248e-10 7.52674312e-10
   5.95859750e-10]
  [6.47649825e-01 3.52350205e-01 1.84420379e-09 2.01154404e-09
   1.87332794e-09]
  ...
  [6.48898304e-01 3.51101667e-01 1.83780835e-09 2.00157668e-09
   1.85114180e-09]
  [7.24635422e-01 2.75364578e-01 1.71813219e-09 1.83416837e-09
   1.72242398e-09]
  [7.07078278e-01 2.92921692e-01 1.75050152e-09 1.87772753e-09
   1.75609971e-09]]

 [[6.47229869e-14 1.00000000e+00 1.04055764e-15 5.46212457e-15
   8.51630483e-16]
  [3.13795172e-03 9.96862054e-01 2.27132022e-10 3.59119623e-10
   2.60867966e-10]
  [5.32440238e-11 1.00000000e+00 2.95838895e-14 1.22580182e-13
   2.98919926e-14]
  ...
  [6.27027869e-01 3.72972101e-01 1.86184179e-09 2.03821737e-09
   1.87478455e-09]
  [1.29229027e-08 1.00000000e+00 4.42239751e-13 1.34722854e-12
   4.35211600e-13]
  [1.92108005e-01 8.07891965e-01 1.56309865e-09 1.92724481e-09
   1.67229042e-09]]

 ...

 [[4.64822203e-02 9.53517795e-01 8.14916135e-10 1.08455411e-09
   8.64779304e-10]
  [1.71091892e-02 9.82890785e-01 5.06958864e-10 7.18486215e-10
   5.43600165e-10]
  [7.49431333e-12 1.00000000e+00 1.11984922e-14 5.14593454e-14
   1.11737850e-14]
  ...
  [9.96797234e-02 9.00320292e-01 1.16989884e-09 1.49703716e-09
   1.22808441e-09]
  [7.22162552e-10 1.00000000e+00 1.06984476e-13 3.82632457e-13
   1.06150088e-13]
  [7.82263502e-02 9.21773612e-01 1.07572307e-09 1.40913536e-09
   1.17770238e-09]]

 [[4.78659570e-03 9.95213389e-01 2.67187383e-10 4.02796185e-10
   2.83286866e-10]
  [2.52479874e-03 9.97475207e-01 1.97814459e-10 3.12521620e-10
   2.15471432e-10]
  [7.16406822e-01 2.83593237e-01 1.73934145e-09 1.86323823e-09
   1.75421078e-09]
  ...
  [6.76619472e-09 1.00000000e+00 3.22755006e-13 1.02040186e-12
   3.19355219e-13]
  [1.36473234e-16 1.00000000e+00 5.26088987e-17 4.40934436e-16
   5.74766382e-17]
  [1.39494683e-03 9.98605072e-01 1.56998178e-10 2.62695921e-10
   1.91787045e-10]]

 [[9.61005222e-03 9.90389943e-01 3.78468340e-10 5.50366863e-10
   4.06216200e-10]
  [3.52789342e-01 6.47210717e-01 1.85894955e-09 2.17443108e-09
   1.93130267e-09]
  [6.34442627e-01 3.65557373e-01 1.85547988e-09 2.02853867e-09
   1.87501503e-09]
  ...
  [7.60230958e-01 2.39769027e-01 1.64205227e-09 1.73485559e-09
   1.64410807e-09]
  [7.80658364e-01 2.19341680e-01 1.59011659e-09 1.66880387e-09
   1.58834323e-09]
  [4.76116888e-08 1.00000000e+00 8.42715546e-13 2.38844209e-12
   8.28413943e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[4.3437822e-09 1.0000000e+00 2.5743467e-13 7.9493839e-13 2.3150359e-13]
 [3.3081944e-17 1.0000000e+00 2.5904776e-17 2.2861681e-16 2.7095310e-17]
 [4.9001306e-19 1.0000000e+00 3.2732699e-18 3.6099509e-17 3.6323130e-18]
 ...
 [7.6023096e-01 2.3976903e-01 1.6420523e-09 1.7348556e-09 1.6441081e-09]
 [7.8065836e-01 2.1934168e-01 1.5901166e-09 1.6688039e-09 1.5883432e-09]
 [4.7611689e-08 1.0000000e+00 8.4271555e-13 2.3884421e-12 8.2841394e-13]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 0 0 1] (100000,)
[33m[INFO] metrics:[0m
loss :  13.722709262084962
tp :  7963.0
fp :  92037.0
tn :  307963.0
fn :  92037.0
accuracy :  0.6318554878234863
precision :  0.07963000237941742
recall :  0.07963000237941742
auc :  0.3989926874637604

y_eval {0: 53027, 2: 46973}
pred {0: 21589, 1: 78411}
[INFO] confusion matrix for file 
[[ 7963 45064     0     0     0]
 [    0     0     0     0     0]
 [13626 33347     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 728582 2767485       0       0       0]
 [  24508  273909       0       0       0]
 [  26057   76657       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0380956e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0380956e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.0380956e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-3.4757039e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-3.4757039e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-3.4757039e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 2 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[4.4366129e-02 9.5563394e-01 7.9707063e-10 1.0636404e-09 8.4610813e-10]
  [5.4180674e-15 1.0000000e+00 3.1585213e-16 2.1253912e-15 3.2165571e-16]
  [1.1050952e-06 9.9999893e-01 4.5758761e-12 1.1430699e-11 6.1309586e-12]
  ...
  [7.3130779e-02 9.2686927e-01 1.0381029e-09 1.3628959e-09 1.1277316e-09]
  [7.4608743e-01 2.5391260e-01 1.6762158e-09 1.7795608e-09 1.6843755e-09]
  [4.8594169e-09 1.0000000e+00 2.7171649e-13 8.7227008e-13 2.6345915e-13]]

 [[7.1750539e-10 1.0000000e+00 1.0505979e-13 3.5422698e-13 9.2053447e-14]
  [4.4162764e-04 9.9955839e-01 8.5949886e-11 1.5149347e-10 1.0109500e-10]
  [4.6869736e-10 1.0000000e+00 8.7708771e-14 3.2362296e-13 9.0693729e-14]
  ...
  [5.1251914e-09 1.0000000e+00 2.7935957e-13 8.9465674e-13 2.7323925e-13]
  [1.3674118e-01 8.6325884e-01 1.3686090e-09 1.7283294e-09 1.4780900e-09]
  [6.3112384e-01 3.6887613e-01 1.8608466e-09 2.0369493e-09 1.8827997e-09]]

 [[8.0202589e-14 1.0000000e+00 1.1566885e-15 6.0092541e-15 9.4631156e-16]
  [5.9198767e-13 1.0000000e+00 3.3025361e-15 1.7398504e-14 3.3425235e-15]
  [9.8100967e-09 1.0000000e+00 4.2189879e-13 1.3433309e-12 4.9978408e-13]
  ...
  [6.9137597e-01 3.0862400e-01 1.7810778e-09 1.9204931e-09 1.7983471e-09]
  [4.4818371e-10 1.0000000e+00 8.3534728e-14 3.0555384e-13 8.0920784e-14]
  [3.8657721e-02 9.6134222e-01 7.7793921e-10 1.0646176e-09 8.6704316e-10]]

 ...

 [[2.7790767e-09 1.0000000e+00 2.0612163e-13 6.5067369e-13 1.8422467e-13]
  [1.8434173e-03 9.9815661e-01 1.7434405e-10 2.8343236e-10 2.0200747e-10]
  [1.0464801e-09 1.0000000e+00 1.3007344e-13 4.5865389e-13 1.3365321e-13]
  ...
  [4.5810864e-07 9.9999952e-01 3.0082701e-12 7.9590640e-12 4.1299819e-12]
  [2.2989541e-01 7.7010465e-01 1.6522641e-09 2.0054423e-09 1.7399440e-09]
  [6.6843867e-01 3.3156133e-01 1.8134475e-09 1.9656534e-09 1.8241914e-09]]

 [[1.7653611e-03 9.9823463e-01 1.6175661e-10 2.5616334e-10 1.6590680e-10]
  [4.7741676e-04 9.9952257e-01 8.6405716e-11 1.4971059e-10 9.4684954e-11]
  [1.7462448e-09 1.0000000e+00 1.6875154e-13 5.7936062e-13 1.7447064e-13]
  ...
  [9.7159353e-19 1.0000000e+00 4.5734063e-18 4.9382477e-17 5.0409094e-18]
  [1.3582873e-08 1.0000000e+00 5.3042461e-13 1.7107430e-12 7.6290872e-13]
  [4.8271254e-02 9.5172882e-01 8.5399449e-10 1.1491248e-09 9.2858959e-10]]

 [[2.6867133e-09 1.0000000e+00 2.0268192e-13 6.4087554e-13 1.8106056e-13]
  [3.5791742e-04 9.9964201e-01 7.7138775e-11 1.3728908e-10 8.9758437e-11]
  [3.7787606e-06 9.9999619e-01 7.6991547e-12 1.7400987e-11 8.3407925e-12]
  ...
  [8.6222404e-18 1.0000000e+00 1.3468988e-17 1.3114094e-16 1.4928787e-17]
  [6.8321074e-18 1.0000000e+00 1.2046150e-17 1.1871347e-16 1.3565671e-17]
  [2.6167803e-07 9.9999976e-01 2.2826994e-12 6.2356661e-12 3.1439458e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[4.4366129e-02 9.5563394e-01 7.9707063e-10 1.0636404e-09 8.4610813e-10]
 [5.4180674e-15 1.0000000e+00 3.1585213e-16 2.1253912e-15 3.2165571e-16]
 [1.1050952e-06 9.9999893e-01 4.5758761e-12 1.1430699e-11 6.1309586e-12]
 ...
 [8.6222404e-18 1.0000000e+00 1.3468988e-17 1.3114094e-16 1.4928787e-17]
 [6.8321074e-18 1.0000000e+00 1.2046150e-17 1.1871347e-16 1.3565671e-17]
 [2.6167803e-07 9.9999976e-01 2.2826994e-12 6.2356661e-12 3.1439458e-12]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  9.193876484680176
tp :  17853.0
fp :  82147.0
tn :  317853.0
fn :  82147.0
accuracy :  0.6714152097702026
precision :  0.1785299926996231
recall :  0.1785299926996231
auc :  0.5384075045585632

y_eval {0: 93019, 2: 6981}
pred {0: 19622, 1: 80378}
[INFO] confusion matrix for file 
[[17853 75166     0     0     0]
 [    0     0     0     0     0]
 [ 1769  5212     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 746435 2842651       0       0       0]
 [  24508  273909       0       0       0]
 [  27826   81869       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-0.3475704  0.         0.        ...  2.         0.00482   -0.33484  ]
 [-0.3475704  0.         0.        ...  3.         0.00482    1.45442  ]
 [-0.3475704  0.         0.        ...  2.         0.00482   -0.33484  ]
 ...
 [ 0.3454935  0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 0.3454935  0.         0.        ...  3.         0.00482    1.45442  ]
 [ 0.3454935  0.         0.        ...  2.         0.00482   -0.33484  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.32700671e-02 9.86729980e-01 4.43718284e-10 6.33813890e-10
   4.75326223e-10]
  [4.22752053e-02 9.57724810e-01 7.87779786e-10 1.06127529e-09
   8.42364067e-10]
  [7.18603253e-01 2.81396747e-01 1.73318171e-09 1.85480631e-09
   1.74551618e-09]
  ...
  [1.76747635e-01 8.23252320e-01 1.48003543e-09 1.82184323e-09
   1.53809243e-09]
  [8.79370965e-10 1.00000000e+00 1.17355222e-13 4.14950057e-13
   1.15217365e-13]
  [1.66783138e-15 1.00000000e+00 1.83344517e-16 1.35483089e-15
   2.08091286e-16]]

 [[2.53691645e-09 1.00000000e+00 1.96975465e-13 6.24584152e-13
   1.75814888e-13]
  [4.26311453e-04 9.99573648e-01 8.42042269e-11 1.48485987e-10
   9.81430562e-11]
  [7.69165754e-01 2.30834186e-01 1.62351277e-09 1.71181702e-09
   1.63031477e-09]
  ...
  [1.05633111e-08 1.00000000e+00 3.99297972e-13 1.22884342e-12
   3.88186851e-13]
  [3.85542214e-03 9.96144533e-01 2.52872057e-10 3.95053101e-10
   2.90892477e-10]
  [6.59824799e-12 1.00000000e+00 1.05314927e-14 4.88875399e-14
   1.04089965e-14]]

 [[1.79789961e-10 1.00000000e+00 5.27996768e-14 1.90337776e-13
   4.54472004e-14]
  [2.34693750e-15 1.00000000e+00 2.12956153e-16 1.50857171e-15
   2.20005453e-16]
  [8.81443149e-04 9.99118507e-01 1.23942454e-10 2.11901580e-10
   1.51051519e-10]
  ...
  [2.61616497e-03 9.97383773e-01 2.12775950e-10 3.42562173e-10
   2.54746918e-10]
  [1.20616436e-01 8.79383564e-01 1.26744948e-09 1.60050506e-09
   1.31907818e-09]
  [4.36136744e-08 1.00000000e+00 8.19965948e-13 2.34426562e-12
   8.26513716e-13]]

 ...

 [[4.74189438e-11 1.00000000e+00 2.72405474e-14 1.04685330e-13
   2.31050869e-14]
  [5.36774618e-12 1.00000000e+00 9.79178473e-15 4.60459307e-14
   1.00211604e-14]
  [5.12444526e-02 9.48755562e-01 8.85825635e-10 1.19087251e-09
   9.82601556e-10]
  ...
  [6.21060957e-04 9.99378920e-01 1.01793858e-10 1.75844436e-10
   1.16929161e-10]
  [1.07769800e-11 1.00000000e+00 1.34706784e-14 6.09893131e-14
   1.34140669e-14]
  [2.36158397e-16 1.00000000e+00 7.00141685e-17 5.76479454e-16
   8.12919423e-17]]

 [[7.72401108e-05 9.99922752e-01 3.39704306e-11 6.36450059e-11
   3.46857890e-11]
  [1.41382992e-01 8.58616948e-01 1.37076228e-09 1.72003956e-09
   1.46550316e-09]
  [8.09903443e-01 1.90096527e-01 1.50728197e-09 1.56596580e-09
   1.50305612e-09]
  ...
  [3.30849648e-01 6.69150352e-01 1.81341608e-09 2.12534546e-09
   1.84640525e-09]
  [7.68644512e-01 2.31355444e-01 1.62169789e-09 1.70884706e-09
   1.62265690e-09]
  [7.91755676e-01 2.08244279e-01 1.55969260e-09 1.63059533e-09
   1.55568158e-09]]

 [[7.49407411e-11 1.00000000e+00 3.41929854e-14 1.28612236e-13
   2.91737697e-14]
  [8.24924461e-17 1.00000000e+00 4.07315513e-17 3.42446447e-16
   4.23489408e-17]
  [3.33327504e-10 1.00000000e+00 8.04575455e-14 3.10877517e-13
   1.02854567e-13]
  ...
  [6.27728343e-01 3.72271657e-01 1.86757987e-09 2.04681672e-09
   1.89177607e-09]
  [1.96230680e-01 8.03769290e-01 1.53191482e-09 1.86732874e-09
   1.56971547e-09]
  [7.64546275e-01 2.35453755e-01 1.63228031e-09 1.72243741e-09
   1.63469183e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.3270067e-02 9.8672998e-01 4.4371828e-10 6.3381389e-10 4.7532622e-10]
 [4.2275205e-02 9.5772481e-01 7.8777979e-10 1.0612753e-09 8.4236407e-10]
 [7.1860325e-01 2.8139675e-01 1.7331817e-09 1.8548063e-09 1.7455162e-09]
 ...
 [6.2772834e-01 3.7227166e-01 1.8675799e-09 2.0468167e-09 1.8917761e-09]
 [1.9623068e-01 8.0376929e-01 1.5319148e-09 1.8673287e-09 1.5697155e-09]
 [7.6454628e-01 2.3545375e-01 1.6322803e-09 1.7224374e-09 1.6346918e-09]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 0 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  8.373119541931151
tp :  19074.0
fp :  80926.0
tn :  319074.0
fn :  80926.0
accuracy :  0.6762991547584534
precision :  0.19074000418186188
recall :  0.19074000418186188
auc :  0.5596693158149719

y_eval {0: 100000}
pred {0: 19074, 1: 80926}
[INFO] confusion matrix for file 
[[19074 80926     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 765509 2923577       0       0       0]
 [  24508  273909       0       0       0]
 [  27826   81869       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4549350e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4549350e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4549350e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [ 1.0385574e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.0385574e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0385574e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[7.47463133e-11 1.00000000e+00 3.41489261e-14 1.28462440e-13
   2.91353449e-14]
  [1.52588520e-08 1.00000000e+00 5.12347055e-13 1.57595020e-12
   5.61376032e-13]
  [1.17405712e-07 9.99999881e-01 1.40923850e-12 3.89049817e-12
   1.59291872e-12]
  ...
  [1.52951196e-01 8.47048819e-01 1.39306655e-09 1.72951142e-09
   1.44331169e-09]
  [1.93227434e-10 1.00000000e+00 5.54691587e-14 2.13075109e-13
   5.45694166e-14]
  [2.42265003e-07 9.99999762e-01 2.12085839e-12 5.72304227e-12
   2.71940543e-12]]

 [[7.45532386e-11 1.00000000e+00 3.41051853e-14 1.28313552e-13
   2.90971369e-14]
  [2.93130190e-12 1.00000000e+00 7.25709284e-15 3.52611684e-14
   7.44595832e-15]
  [4.92632724e-02 9.50736761e-01 8.70307049e-10 1.17314725e-09
   9.67199210e-10]
  ...
  [2.20260799e-01 7.79739261e-01 1.60248825e-09 1.94016159e-09
   1.65175873e-09]
  [6.68671229e-10 1.00000000e+00 1.02434039e-13 3.67501982e-13
   1.00681426e-13]
  [1.03073398e-06 9.99998927e-01 4.33648603e-12 1.07832198e-11
   5.46798501e-12]]

 [[3.98066691e-10 1.00000000e+00 7.83859536e-14 2.71994422e-13
   6.81860777e-14]
  [6.72564260e-04 9.99327421e-01 1.05804851e-10 1.82052706e-10
   1.23830834e-10]
  [7.79326737e-01 2.20673263e-01 1.59697633e-09 1.67807590e-09
   1.60165570e-09]
  ...
  [1.14516343e-08 1.00000000e+00 4.15525849e-13 1.27291276e-12
   4.03288785e-13]
  [1.33712494e-11 1.00000000e+00 1.59201215e-14 7.27075735e-14
   1.89328940e-14]
  [4.43538847e-05 9.99955654e-01 2.78075341e-11 5.60425248e-11
   3.31940933e-11]]

 ...

 [[1.09472001e-10 1.00000000e+00 4.12697966e-14 1.52396460e-13
   3.53368424e-14]
  [1.86497617e-09 1.00000000e+00 1.79803397e-13 6.18881411e-13
   1.93227148e-13]
  [3.43016643e-15 1.00000000e+00 2.57945435e-16 1.82108060e-15
   2.78413351e-16]
  ...
  [2.06920225e-02 9.79307950e-01 5.81828308e-10 8.28520419e-10
   6.66465383e-10]
  [6.46986961e-01 3.53013068e-01 1.84447846e-09 2.01174788e-09
   1.86692573e-09]
  [8.25810850e-01 1.74189121e-01 1.45546986e-09 1.50249080e-09
   1.44624646e-09]]

 [[4.70542647e-02 9.52945769e-01 8.18335677e-10 1.08708997e-09
   8.61497207e-10]
  [2.26243628e-08 1.00000000e+00 5.97370786e-13 1.77185469e-12
   6.11261855e-13]
  [7.05100202e-17 1.00000000e+00 3.78411969e-17 3.26849447e-16
   4.09404508e-17]
  ...
  [2.85856250e-09 1.00000000e+00 2.26401471e-13 7.70805566e-13
   2.62080857e-13]
  [6.25251598e-17 1.00000000e+00 3.56203262e-17 3.12402268e-16
   3.86315878e-17]
  [7.21354736e-04 9.99278605e-01 1.13933356e-10 1.98187966e-10
   1.42343234e-10]]

 [[2.66983500e-03 9.97330189e-01 2.00103004e-10 3.11694004e-10
   2.13703194e-10]
  [5.74580610e-01 4.25419360e-01 1.91623384e-09 2.12771845e-09
   1.95766892e-09]
  [1.54526457e-01 8.45473588e-01 1.39521805e-09 1.72956771e-09
   1.44720713e-09]
  ...
  [5.62673392e-07 9.99999404e-01 2.95747064e-12 7.38639965e-12
   3.04413092e-12]
  [9.97312145e-06 9.99989986e-01 1.29629432e-11 2.80820818e-11
   1.49672306e-11]
  [1.68760706e-15 1.00000000e+00 1.79674905e-16 1.31463071e-15
   1.88498911e-16]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[7.4746313e-11 1.0000000e+00 3.4148926e-14 1.2846244e-13 2.9135345e-14]
 [1.5258852e-08 1.0000000e+00 5.1234705e-13 1.5759502e-12 5.6137603e-13]
 [1.1740571e-07 9.9999988e-01 1.4092385e-12 3.8904982e-12 1.5929187e-12]
 ...
 [5.6267339e-07 9.9999940e-01 2.9574706e-12 7.3863997e-12 3.0441309e-12]
 [9.9731215e-06 9.9998999e-01 1.2962943e-11 2.8082082e-11 1.4967231e-11]
 [1.6876071e-15 1.0000000e+00 1.7967491e-16 1.3146307e-15 1.8849891e-16]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.31924860534668
tp :  19742.0
fp :  80258.0
tn :  319742.0
fn :  80258.0
accuracy :  0.6789711713790894
precision :  0.19742000102996826
recall :  0.19742000102996826
auc :  0.5553606748580933

y_eval {0: 100000}
pred {0: 19742, 1: 80258}
[INFO] confusion matrix for file 
[[19742 80258     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 785251 3003835       0       0       0]
 [  24508  273909       0       0       0]
 [  27826   81869       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0385574  0.         0.        ...  4.         0.00482   -0.23351  ]
 [ 1.0385574  0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 1.0385574  0.         0.        ...  2.         0.00482   -0.33484  ]
 ...
 [ 1.7316213  0.         0.        ...  3.         0.00482    1.45442  ]
 [ 1.7316213  0.         0.        ...  2.         0.00482   -0.33484  ]
 [ 1.7316213  0.         0.        ...  1.         0.00482   -0.32151  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.77001615e-13 1.00000000e+00 1.71019234e-15 8.56263150e-15
   1.40151660e-15]
  [1.37635663e-01 8.62364352e-01 1.37195311e-09 1.73359682e-09
   1.48996837e-09]
  [7.21430898e-01 2.78569072e-01 1.72638159e-09 1.84576110e-09
   1.74089787e-09]
  ...
  [1.09097920e-04 9.99890924e-01 4.01771186e-11 7.47571241e-11
   4.16193226e-11]
  [4.60432004e-03 9.95395720e-01 2.68174816e-10 4.10722650e-10
   2.91036056e-10]
  [1.63249203e-09 1.00000000e+00 1.60829249e-13 5.51920543e-13
   1.58782818e-13]]

 [[6.47305371e-03 9.93526936e-01 3.09426373e-10 4.57700489e-10
   3.22076726e-10]
  [5.95944260e-15 1.00000000e+00 3.31024076e-16 2.21614397e-15
   3.34723016e-16]
  [7.60693848e-03 9.92393017e-01 3.59166419e-10 5.42174639e-10
   4.22653718e-10]
  ...
  [3.06297392e-02 9.69370186e-01 6.63730959e-10 9.05117870e-10
   6.83883727e-10]
  [9.03877306e-10 1.00000000e+00 1.19501048e-13 4.22610758e-13
   1.18292786e-13]
  [4.63481394e-15 1.00000000e+00 3.02040805e-16 2.10564386e-15
   3.32113122e-16]]

 [[6.17122930e-03 9.93828833e-01 3.02174535e-10 4.48124315e-10
   3.14491211e-10]
  [5.06274521e-01 4.93725538e-01 1.93890437e-09 2.18649832e-09
   1.99075334e-09]
  [1.51977926e-01 8.48022044e-01 1.38600631e-09 1.72036196e-09
   1.44099854e-09]
  ...
  [2.01428385e-08 1.00000000e+00 5.50200998e-13 1.63492939e-12
   5.36381323e-13]
  [3.19103777e-01 6.80896223e-01 1.83689364e-09 2.17524110e-09
   1.93447436e-09]
  [8.34246635e-01 1.65753305e-01 1.42718382e-09 1.46862245e-09
   1.41916245e-09]]

 ...

 [[1.90722091e-11 1.00000000e+00 1.73376175e-14 6.96028454e-14
   1.45832612e-14]
  [1.26949048e-10 1.00000000e+00 4.72621176e-14 1.87787597e-13
   4.95846243e-14]
  [5.82022034e-02 9.41797793e-01 9.36073441e-10 1.24691235e-09
   1.02971032e-09]
  ...
  [2.16758461e-04 9.99783218e-01 6.09704925e-11 1.12197092e-10
   7.21649060e-11]
  [7.44892240e-01 2.55107731e-01 1.68170944e-09 1.78694326e-09
   1.69302539e-09]
  [1.61717758e-02 9.83828187e-01 4.85676444e-10 6.86281365e-10
   4.99545627e-10]]

 [[4.35496647e-12 1.00000000e+00 8.34047763e-15 3.59118049e-14
   6.93796090e-15]
  [1.65903018e-15 1.00000000e+00 1.79701640e-16 1.29221674e-15
   1.84632430e-16]
  [1.23319948e-11 1.00000000e+00 1.54350511e-14 7.09066323e-14
   1.86214213e-14]
  ...
  [6.50858390e-04 9.99349177e-01 9.83152934e-11 1.66038516e-10
   1.02561792e-10]
  [7.56864130e-01 2.43135914e-01 1.65424585e-09 1.75103176e-09
   1.66211478e-09]
  [1.21543366e-07 9.99999881e-01 1.34522309e-12 3.62444124e-12
   1.32801485e-12]]

 [[2.61912714e-06 9.99997377e-01 6.28011271e-12 1.40689110e-11
   6.26422525e-12]
  [2.90886902e-07 9.99999762e-01 2.19575746e-12 5.73018542e-12
   2.39655518e-12]
  [8.54071317e-14 1.00000000e+00 1.25669006e-15 7.44397033e-15
   1.33205661e-15]
  ...
  [1.20005645e-02 9.87999439e-01 4.19687618e-10 6.03521955e-10
   4.36974124e-10]
  [7.88911223e-01 2.11088791e-01 1.57032831e-09 1.64423075e-09
   1.57082858e-09]
  [7.15824962e-01 2.84175038e-01 1.73474601e-09 1.85655136e-09
   1.74107395e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.77001615e-13 1.00000000e+00 1.71019234e-15 8.56263150e-15
  1.40151660e-15]
 [1.37635663e-01 8.62364352e-01 1.37195311e-09 1.73359682e-09
  1.48996837e-09]
 [7.21430898e-01 2.78569072e-01 1.72638159e-09 1.84576110e-09
  1.74089787e-09]
 ...
 [1.20005645e-02 9.87999439e-01 4.19687618e-10 6.03521955e-10
  4.36974124e-10]
 [7.88911223e-01 2.11088791e-01 1.57032831e-09 1.64423075e-09
  1.57082858e-09]
 [7.15824962e-01 2.84175038e-01 1.73474601e-09 1.85655136e-09
  1.74107395e-09]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 1 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  8.15226015625
tp :  20425.0
fp :  79575.0
tn :  320425.0
fn :  79575.0
accuracy :  0.6817031502723694
precision :  0.20424999296665192
recall :  0.20424999296665192
auc :  0.5536410808563232

y_eval {0: 100000}
pred {0: 20425, 1: 79575}
[INFO] confusion matrix for file 
[[20425 79575     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 805676 3083410       0       0       0]
 [  24508  273909       0       0       0]
 [  27826   81869       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-02_014558_119.log.part06_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0:99.997%,2:0.003%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9964%,3:0.0036%]
[INFO] ** i/f_dir:[1:99.9964%,0:0.0036%]
[INFO] ** src:[22:38.0288%,9:26.1242%,7:18.2114%,1:17.6294%,21:0.003%,2:0.0008%,14:0.0006%,3:0.0006%,15:0.0004%,4:0.0004%,11:0.0002%,8:0.0002%]
[INFO] ** dst:[21:43.357%,10:20.7952%,8:18.2116%,9:17.629%,15:0.0036%,22:0.0012%,16:0.0008%,19:0.0004%,17:0.0004%,6:0.0004%,26:0.0002%,24:0.0002%]
[INFO] ** proto:[0:99.9958%,1:0.0036%,2:0.0006%]
[INFO] ** appi_name:[21:99.9942%,30:0.0036%,17:0.0008%,22:0.0004%,28:0.0002%,26:0.0002%,23:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** proxy_src_ip:[18:38.0288%,20:26.1242%,13:18.2114%,6:17.6294%,17:0.0036%,14:0.0008%,1:0.0006%,21:0.0004%,16:0.0004%,10:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9942%,-33.760870000000004:0.0058%]
[INFO] ** modbus_function_description:[7:49.9974%,11:49.9968%,0:0.0058%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.123%,1:20.7952%,5:18.211%,4:17.6288%,2:17.2336%,0:0.0084%]
[INFO] ** service:[0.0048200000000000005:99.9942%,-211.73542999999998:0.0036%,-205.44247:0.0008%,-211.07873999999998:0.0004%,-211.08818:0.0004%,-211.09762999999998:0.0002%,-211.08346:0.0002%,-185.9872:0.0002%]
[INFO] ** s_port:[1.45442:26.1234%,-0.32151:20.7952%,-1.27613:18.2112%,-0.23351:17.629%,-0.33484:17.2336%,-71.33197:0.0036%,1.45709:0.0006%,9.89942:0.0004%,-1.02014:0.0004%,-71.14931:0.0004%,-58.035180000000004:0.0002%,-5.1466400000000005:0.0002%,-0.24151:0.0002%,-5.08665:0.0002%,1.46509:0.0002%,-71.14798:0.0002%,-0.24950999999999998:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-1.27347:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** classification:[normal:81.41%,Single Stage Single Point:18.59%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7326837e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.7326837e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.7326837e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [-1.0391493e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0391493e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0391493e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 1 0 1] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[4.30739220e-07 9.99999523e-01 2.54870669e-12 6.25879253e-12
   2.46919390e-12]
  [2.64836180e-16 1.00000000e+00 7.21667042e-17 5.73494245e-16
   7.51279975e-17]
  [1.78348489e-19 1.00000000e+00 1.98103387e-18 2.29762005e-17
   2.16937525e-18]
  ...
  [5.77626050e-01 4.22373950e-01 1.90851379e-09 2.11678763e-09
   1.94166594e-09]
  [7.16306865e-01 2.83693165e-01 1.73414016e-09 1.85556670e-09
   1.73883008e-09]
  [4.10933474e-08 1.00000000e+00 7.85671116e-13 2.24679151e-12
   7.78276315e-13]]

 [[1.66304073e-08 1.00000000e+00 5.02477617e-13 1.45200507e-12
   4.61148643e-13]
  [2.64560943e-03 9.97354388e-01 2.07979259e-10 3.30975275e-10
   2.38615905e-10]
  [7.80960381e-01 2.19039574e-01 1.59199143e-09 1.67169589e-09
   1.59530478e-09]
  ...
  [2.66189128e-01 7.33810842e-01 1.71607184e-09 2.05200523e-09
   1.77132276e-09]
  [7.13739276e-01 2.86260724e-01 1.74000891e-09 1.86357663e-09
   1.74676584e-09]
  [7.46165574e-01 2.53834397e-01 1.67336289e-09 1.77522796e-09
   1.67515124e-09]]

 [[6.36241277e-13 1.00000000e+00 3.21874362e-15 1.51773295e-14
   2.64870675e-15]
  [1.40655441e-02 9.85934436e-01 4.76123863e-10 6.91508628e-10
   5.44278678e-10]
  [1.20297078e-10 1.00000000e+00 4.42310373e-14 1.75143144e-13
   4.47851256e-14]
  ...
  [2.97410171e-02 9.70259011e-01 6.71961597e-10 9.27654564e-10
   7.26420979e-10]
  [9.68030604e-12 1.00000000e+00 1.26727674e-14 5.74236906e-14
   1.25236447e-14]
  [2.86633509e-18 1.00000000e+00 7.80132068e-18 7.98876543e-17
   8.54907376e-18]]

 ...

 [[2.56078669e-09 1.00000000e+00 1.97854293e-13 6.26878053e-13
   1.76399355e-13]
  [6.59827725e-04 9.99340117e-01 1.04650746e-10 1.80151727e-10
   1.21909552e-10]
  [7.71713734e-01 2.28286222e-01 1.61684999e-09 1.70330983e-09
   1.62293667e-09]
  ...
  [2.17456943e-07 9.99999762e-01 1.80383963e-12 4.71362966e-12
   1.81114835e-12]
  [6.86497414e-10 1.00000000e+00 1.08375311e-13 3.94011213e-13
   1.12038390e-13]
  [2.70557851e-01 7.29442120e-01 1.75451165e-09 2.10813034e-09
   1.86120264e-09]]

 [[1.38519444e-02 9.86148000e-01 4.50893017e-10 6.39989450e-10
   4.69701333e-10]
  [1.31725688e-02 9.86827374e-01 4.47333004e-10 6.44245546e-10
   4.84749962e-10]
  [7.45124519e-01 2.54875511e-01 1.67923642e-09 1.78348514e-09
   1.68816727e-09]
  ...
  [1.55690020e-06 9.99998450e-01 5.42921914e-12 1.33389801e-11
   7.14783961e-12]
  [1.92816243e-01 8.07183743e-01 1.54900182e-09 1.90382621e-09
   1.63587532e-09]
  [6.68625772e-01 3.31374198e-01 1.81373383e-09 1.96625272e-09
   1.82701110e-09]]

 [[3.06281181e-11 1.00000000e+00 2.19306012e-14 8.60901248e-14
   1.85353848e-14]
  [4.11725305e-05 9.99958873e-01 2.64026578e-11 5.30770705e-11
   3.11908555e-11]
  [7.72329867e-10 1.00000000e+00 1.13138306e-13 4.07463993e-13
   1.19128286e-13]
  ...
  [2.57127303e-05 9.99974251e-01 2.14685682e-11 4.47228365e-11
   2.68471009e-11]
  [4.10465300e-01 5.89534700e-01 1.91755944e-09 2.21522867e-09
   1.98731342e-09]
  [6.14751339e-01 3.85248691e-01 1.87447036e-09 2.05829465e-09
   1.88867855e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[4.3073922e-07 9.9999952e-01 2.5487067e-12 6.2587925e-12 2.4691939e-12]
 [2.6483618e-16 1.0000000e+00 7.2166704e-17 5.7349424e-16 7.5127998e-17]
 [1.7834849e-19 1.0000000e+00 1.9810339e-18 2.2976200e-17 2.1693752e-18]
 ...
 [2.5712730e-05 9.9997425e-01 2.1468568e-11 4.4722837e-11 2.6847101e-11]
 [4.1046530e-01 5.8953470e-01 1.9175594e-09 2.2152287e-09 1.9873134e-09]
 [6.1475134e-01 3.8524869e-01 1.8744704e-09 2.0582946e-09 1.8886785e-09]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  6.977390989685059
tp :  35334.0
fp :  64666.0
tn :  335334.0
fn :  64666.0
accuracy :  0.7413386702537537
precision :  0.3533399999141693
recall :  0.3533399999141693
auc :  0.6568132042884827

y_eval {0: 67398, 1: 32602}
pred {0: 21334, 1: 78666}
[INFO] confusion matrix for file 
[[12033 55365     0     0     0]
 [ 9301 23301     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 817709 3138775       0       0       0]
 [  33809  297210       0       0       0]
 [  27826   81869       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0391493e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0391493e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0391493e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-3.4561479e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4561479e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-3.4561479e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [1 0 1 ... 1 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[5.11033704e-08 1.00000000e+00 8.79607856e-13 2.40432999e-12
   8.22873833e-13]
  [6.68710362e-15 1.00000000e+00 3.55768873e-16 2.38972347e-15
   3.66165752e-16]
  [3.45989647e-05 9.99965429e-01 2.49362180e-11 5.11895179e-11
   3.13956083e-11]
  ...
  [6.39754653e-01 3.60245377e-01 1.85323901e-09 2.02462869e-09
   1.87318983e-09]
  [4.51325357e-01 5.48674583e-01 1.91743310e-09 2.18441265e-09
   1.94281258e-09]
  [7.26595342e-01 2.73404658e-01 1.71511383e-09 1.83027926e-09
   1.72129466e-09]]

 [[1.20621752e-02 9.87937868e-01 4.21146534e-10 6.02288441e-10
   4.38665437e-10]
  [2.93752699e-15 1.00000000e+00 2.33307364e-16 1.62021553e-15
   2.36580379e-16]
  [3.04124056e-04 9.99695897e-01 7.38175354e-11 1.34420239e-10
   9.29497798e-11]
  ...
  [5.59768204e-12 1.00000000e+00 9.74884863e-15 4.57996271e-14
   9.81279961e-15]
  [7.04285863e-04 9.99295712e-01 1.10407357e-10 1.90873442e-10
   1.32534567e-10]
  [5.16589642e-01 4.83410388e-01 1.93824179e-09 2.18241025e-09
   1.98680006e-09]]

 [[2.29841834e-09 1.00000000e+00 1.87490906e-13 5.97203331e-13
   1.66905498e-13]
  [6.13222597e-04 9.99386787e-01 1.00924498e-10 1.74457740e-10
   1.17657162e-10]
  [1.66296132e-08 1.00000000e+00 5.15558462e-13 1.56588273e-12
   5.40339800e-13]
  ...
  [6.23624796e-09 1.00000000e+00 3.07872814e-13 9.75693159e-13
   3.00916518e-13]
  [2.99122836e-03 9.97008741e-01 2.23377122e-10 3.54223706e-10
   2.58207788e-10]
  [6.59474475e-10 1.00000000e+00 1.02881448e-13 3.71376107e-13
   1.01871724e-13]]

 ...

 [[1.04496814e-03 9.98955011e-01 1.24997540e-10 2.04299896e-10
   1.31162553e-10]
  [1.22298360e-01 8.77701640e-01 1.28571143e-09 1.62713398e-09
   1.37235512e-09]
  [7.97812104e-01 2.02187926e-01 1.54358160e-09 1.61078761e-09
   1.54123980e-09]
  ...
  [6.77304393e-11 1.00000000e+00 3.29686094e-14 1.34109276e-13
   3.19015342e-14]
  [1.05889609e-04 9.99894142e-01 4.32554340e-11 8.32114863e-11
   5.33974392e-11]
  [2.85539482e-14 1.00000000e+00 7.21675618e-16 4.52430621e-15
   7.39813399e-16]]

 [[4.28947378e-10 1.00000000e+00 8.13373484e-14 2.81115409e-13
   7.07395297e-14]
  [2.09641883e-15 1.00000000e+00 2.01303891e-16 1.43486206e-15
   2.08094462e-16]
  [3.28312954e-03 9.96716797e-01 2.37033143e-10 3.75853876e-10
   2.82789875e-10]
  ...
  [2.68659592e-01 7.31340408e-01 1.74998827e-09 2.10280349e-09
   1.85194116e-09]
  [4.36020762e-01 5.63979208e-01 1.91486449e-09 2.19162910e-09
   1.95541938e-09]
  [1.45116576e-06 9.99998569e-01 4.66198000e-12 1.09933790e-11
   4.76097980e-12]]

 [[9.84347220e-14 1.00000000e+00 1.27983460e-15 6.58569006e-15
   1.04740346e-15]
  [6.87520835e-04 9.99312520e-01 1.06788800e-10 1.83630458e-10
   1.22815438e-10]
  [8.36477415e-11 1.00000000e+00 3.72464815e-14 1.50774765e-13
   3.82155245e-14]
  ...
  [5.19827306e-01 4.80172664e-01 1.94962335e-09 2.19745000e-09
   2.01051398e-09]
  [2.43574547e-08 1.00000000e+00 6.06189252e-13 1.78386548e-12
   5.88885061e-13]
  [7.39646957e-16 1.00000000e+00 1.20930272e-16 9.23428119e-16
   1.30044955e-16]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[5.1103370e-08 1.0000000e+00 8.7960786e-13 2.4043300e-12 8.2287383e-13]
 [6.6871036e-15 1.0000000e+00 3.5576887e-16 2.3897235e-15 3.6616575e-16]
 [3.4598965e-05 9.9996543e-01 2.4936218e-11 5.1189518e-11 3.1395608e-11]
 ...
 [5.1982731e-01 4.8017266e-01 1.9496234e-09 2.1974500e-09 2.0105140e-09]
 [2.4357455e-08 1.0000000e+00 6.0618925e-13 1.7838655e-12 5.8888506e-13]
 [7.3964696e-16 1.0000000e+00 1.2093027e-16 9.2342812e-16 1.3004496e-16]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 0 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  6.255292116546631
tp :  43284.0
fp :  56716.0
tn :  343284.0
fn :  56716.0
accuracy :  0.7731383442878723
precision :  0.4328399896621704
recall :  0.4328399896621704
auc :  0.700871467590332

y_eval {0: 53052, 1: 46948}
pred {0: 19706, 1: 80294}
[INFO] confusion matrix for file 
[[ 8021 45031     0     0     0]
 [11685 35263     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 825730 3183806       0       0       0]
 [  45494  332473       0       0       0]
 [  27826   81869       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4561479e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4561479e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-3.4561479e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [ 3.4537926e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 3.4537926e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 3.4537926e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 1 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.8162241e-02 9.8183781e-01 5.1707605e-10 7.2527145e-10 5.5009819e-10]
  [3.8564179e-02 9.6143579e-01 7.5359335e-10 1.0205126e-09 8.0674850e-10]
  [5.1847251e-09 1.0000000e+00 2.8583497e-13 9.2010666e-13 2.8963708e-13]
  ...
  [7.1212530e-01 2.8787476e-01 1.7443023e-09 1.8695330e-09 1.7532850e-09]
  [2.1064617e-09 1.0000000e+00 1.7990836e-13 6.0476645e-13 1.7520931e-13]
  [2.5274446e-03 9.9747258e-01 2.0598487e-10 3.3002412e-10 2.3961752e-10]]

 [[4.0196543e-10 1.0000000e+00 7.8752807e-14 2.7304336e-13 6.8437287e-14]
  [1.2868622e-03 9.9871314e-01 1.4620943e-10 2.4280286e-10 1.7115831e-10]
  [7.8348750e-01 2.1651244e-01 1.5854124e-09 1.6634416e-09 1.5886543e-09]
  ...
  [1.2060340e-04 9.9987936e-01 4.6115414e-11 8.8047951e-11 5.6890874e-11]
  [5.6623071e-01 4.3376929e-01 1.9223108e-09 2.1404756e-09 1.9669251e-09]
  [3.7359729e-07 9.9999964e-01 2.3704873e-12 6.0147881e-12 2.3901549e-12]]

 [[3.9552076e-10 1.0000000e+00 7.8122662e-14 2.7107152e-13 6.7876220e-14]
  [5.1211738e-17 1.0000000e+00 3.2163836e-17 2.7727081e-16 3.3512786e-17]
  [6.4390188e-04 9.9935609e-01 1.0692921e-10 1.8655207e-10 1.3311668e-10]
  ...
  [1.2635682e-06 9.9999869e-01 4.3272313e-12 1.0262369e-11 4.3749834e-12]
  [5.6712543e-12 1.0000000e+00 9.9560041e-15 4.6793359e-14 1.0055357e-14]
  [2.1935145e-03 9.9780649e-01 1.9257977e-10 3.1161990e-10 2.2507857e-10]]

 ...

 [[1.2851711e-09 1.0000000e+00 1.4041000e-13 4.6023303e-13 1.2407410e-13]
  [4.2595699e-17 1.0000000e+00 2.9360564e-17 2.5569024e-16 3.0663331e-17]
  [1.6751271e-03 9.9832481e-01 1.7131513e-10 2.8289407e-10 2.0964841e-10]
  ...
  [7.6820226e-12 1.0000000e+00 1.1494534e-14 5.3038588e-14 1.1549608e-14]
  [6.5740957e-03 9.9342597e-01 3.3052855e-10 5.0217364e-10 3.8093556e-10]
  [1.3165420e-06 9.9999869e-01 4.4979606e-12 1.0707549e-11 4.6075435e-12]]

 [[9.6463170e-03 9.9035370e-01 3.7896880e-10 5.5076044e-10 4.0568104e-10]
  [1.9509142e-03 9.9804914e-01 1.7365492e-10 2.7806088e-10 1.8838850e-10]
  [6.8640709e-01 3.1359288e-01 1.7924275e-09 1.9362547e-09 1.8134592e-09]
  ...
  [2.8943714e-01 7.1056283e-01 1.7892042e-09 2.1368722e-09 1.8912365e-09]
  [8.8800572e-10 1.0000000e+00 1.1759990e-13 4.1527865e-13 1.1383486e-13]
  [2.5631016e-01 7.4368984e-01 1.7279523e-09 2.0833506e-09 1.8356280e-09]]

 [[1.2237019e-09 1.0000000e+00 1.3702745e-13 4.5022048e-13 1.2100244e-13]
  [1.7508679e-12 1.0000000e+00 5.6127694e-15 2.8037898e-14 5.7688449e-15]
  [1.3006730e-04 9.9986994e-01 4.7328207e-11 8.9659620e-11 5.6818550e-11]
  ...
  [4.5816955e-09 1.0000000e+00 2.6537258e-13 8.5669362e-13 2.6231141e-13]
  [3.4516853e-01 6.5483147e-01 1.8735700e-09 2.2047686e-09 1.9714925e-09]
  [8.3160537e-01 1.6839463e-01 1.4364183e-09 1.4797612e-09 1.4287566e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.8162241e-02 9.8183781e-01 5.1707605e-10 7.2527145e-10 5.5009819e-10]
 [3.8564179e-02 9.6143579e-01 7.5359335e-10 1.0205126e-09 8.0674850e-10]
 [5.1847251e-09 1.0000000e+00 2.8583497e-13 9.2010666e-13 2.8963708e-13]
 ...
 [4.5816955e-09 1.0000000e+00 2.6537258e-13 8.5669362e-13 2.6231141e-13]
 [3.4516853e-01 6.5483147e-01 1.8735700e-09 2.2047686e-09 1.9714925e-09]
 [8.3160537e-01 1.6839463e-01 1.4364183e-09 1.4797612e-09 1.4287566e-09]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  7.769525325012207
tp :  26210.0
fp :  73790.0
tn :  326210.0
fn :  73790.0
accuracy :  0.7048429846763611
precision :  0.2621000111103058
recall :  0.2621000111103058
auc :  0.5984790921211243

y_eval {0: 86600, 1: 13400}
pred {0: 19014, 1: 80986}
[INFO] confusion matrix for file 
[[15912 70688     0     0     0]
 [ 3102 10298     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 841642 3254494       0       0       0]
 [  48596  342771       0       0       0]
 [  27826   81869       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4537926e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4537926e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4537926e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 ...
 [ 1.0389137e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.0389137e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0389137e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[8.0169066e-11 1.0000000e+00 3.5357473e-14 1.3256253e-13 3.0189596e-14]
  [6.8337833e-08 9.9999988e-01 1.0822353e-12 3.0720422e-12 1.2057559e-12]
  [5.2626657e-01 4.7373343e-01 1.9466977e-09 2.1907816e-09 2.0091859e-09]
  ...
  [2.5179249e-03 9.9748212e-01 2.0514268e-10 3.2865222e-10 2.3694968e-10]
  [7.4414885e-01 2.5585115e-01 1.6820896e-09 1.7873540e-09 1.6920132e-09]
  [8.2750183e-01 1.7249814e-01 1.4498935e-09 1.4958297e-09 1.4409419e-09]]

 [[9.3281148e-03 9.9067187e-01 3.7273309e-10 5.4269389e-10 3.9903089e-10]
  [2.5442259e-15 1.0000000e+00 2.1826172e-16 1.5315627e-15 2.2410432e-16]
  [6.2841075e-08 9.9999988e-01 1.1020303e-12 3.2248809e-12 1.4912999e-12]
  ...
  [1.7152252e-05 9.9998283e-01 1.5902273e-11 3.2695440e-11 1.6244086e-11]
  [4.4850572e-07 9.9999952e-01 2.7080694e-12 6.8996189e-12 2.9100151e-12]
  [1.1011834e-01 8.8988161e-01 1.2380816e-09 1.5819336e-09 1.3282322e-09]]

 [[8.5530378e-14 1.0000000e+00 1.1941117e-15 6.1868015e-15 9.7759175e-16]
  [3.8567007e-02 9.6143305e-01 7.7467799e-10 1.0611114e-09 8.6975543e-10]
  [1.2413465e-10 1.0000000e+00 4.4819051e-14 1.7694694e-13 4.5123295e-14]
  ...
  [2.5880604e-06 9.9999738e-01 6.1845412e-12 1.4099589e-11 6.2715180e-12]
  [5.9308504e-13 1.0000000e+00 3.2591210e-15 1.7314221e-14 3.3397323e-15]
  [1.2234128e-16 1.0000000e+00 5.0289845e-17 4.2740581e-16 5.6771060e-17]]

 ...

 [[1.6609616e-05 9.9998343e-01 1.5737533e-11 3.1902394e-11 1.5665146e-11]
  [4.6838604e-02 9.5316142e-01 8.3740109e-10 1.1264488e-09 9.1515562e-10]
  [8.1379634e-01 1.8620364e-01 1.4954240e-09 1.5514576e-09 1.4908218e-09]
  ...
  [5.2977625e-02 9.4702238e-01 8.6364910e-10 1.1419973e-09 8.9284891e-10]
  [2.7487381e-09 1.0000000e+00 2.0691061e-13 6.8836348e-13 2.0497097e-13]
  [4.1690935e-14 1.0000000e+00 8.9225593e-16 5.5166316e-15 9.6236220e-16]]

 [[2.1466470e-10 1.0000000e+00 5.7665820e-14 2.0614325e-13 4.9764358e-14]
  [2.9648866e-13 1.0000000e+00 2.3351582e-15 1.2822248e-14 2.4098909e-15]
  [1.7332664e-02 9.8266727e-01 5.3041732e-10 7.6160711e-10 6.0480659e-10]
  ...
  [7.5214739e-06 9.9999249e-01 1.0814663e-11 2.3486083e-11 1.1435859e-11]
  [3.7104244e-14 1.0000000e+00 8.2577496e-16 5.1021479e-15 8.5456259e-16]
  [4.2825168e-10 1.0000000e+00 9.1998864e-14 3.5370106e-13 1.2139843e-13]]

 [[2.2516163e-02 9.7748387e-01 5.7464800e-10 7.9675527e-10 6.1235400e-10]
  [6.1350963e-03 9.9386483e-01 3.0619343e-10 4.5981741e-10 3.3042552e-10]
  [7.6423848e-01 2.3576149e-01 1.6350750e-09 1.7262753e-09 1.6406795e-09]
  ...
  [8.1367083e-02 9.1863298e-01 1.0905636e-09 1.4233564e-09 1.1860423e-09]
  [8.7872922e-02 9.1212702e-01 1.0971916e-09 1.4104458e-09 1.1377174e-09]
  [7.6722503e-01 2.3277496e-01 1.6256894e-09 1.7138702e-09 1.6265579e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[8.0169066e-11 1.0000000e+00 3.5357473e-14 1.3256253e-13 3.0189596e-14]
 [6.8337833e-08 9.9999988e-01 1.0822353e-12 3.0720422e-12 1.2057559e-12]
 [5.2626657e-01 4.7373343e-01 1.9466977e-09 2.1907816e-09 2.0091859e-09]
 ...
 [8.1367083e-02 9.1863298e-01 1.0905636e-09 1.4233564e-09 1.1860423e-09]
 [8.7872922e-02 9.1212702e-01 1.0971916e-09 1.4104458e-09 1.1377174e-09]
 [7.6722503e-01 2.3277496e-01 1.6256894e-09 1.7138702e-09 1.6265579e-09]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 1 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  8.315829873657227
tp :  19607.0
fp :  80393.0
tn :  319607.0
fn :  80393.0
accuracy :  0.6784311532974243
precision :  0.19607000052928925
recall :  0.19607000052928925
auc :  0.5553289651870728

y_eval {0: 100000}
pred {0: 19607, 1: 80393}
[INFO] confusion matrix for file 
[[19607 80393     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 861249 3334887       0       0       0]
 [  48596  342771       0       0       0]
 [  27826   81869       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0389137e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0389137e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.0389137e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [ 1.7324482e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.7324482e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.7324482e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.7188405e-13 1.0000000e+00 1.6855869e-15 8.4512272e-15 1.3813206e-15]
  [5.0696217e-02 9.4930375e-01 8.8078966e-10 1.1864082e-09 9.8345254e-10]
  [1.2515343e-05 9.9998748e-01 1.3824184e-11 2.9136971e-11 1.4880347e-11]
  ...
  [4.0915968e-08 1.0000000e+00 7.8449709e-13 2.2453519e-12 7.7314229e-13]
  [3.3932722e-01 6.6067278e-01 1.8633102e-09 2.1938331e-09 1.9559938e-09]
  [4.1718327e-09 1.0000000e+00 2.5306675e-13 8.2074207e-13 2.4523157e-13]]

 [[2.0280830e-10 1.0000000e+00 5.6060747e-14 2.0095510e-13 4.8346191e-14]
  [5.2307243e-09 1.0000000e+00 3.0047606e-13 9.7861931e-13 3.2627690e-13]
  [6.5484089e-09 1.0000000e+00 3.3724456e-13 1.0919349e-12 3.8273611e-13]
  ...
  [2.8385482e-08 1.0000000e+00 6.5367649e-13 1.9078968e-12 6.4008759e-13]
  [4.5598581e-01 5.4401422e-01 1.9517177e-09 2.2340392e-09 2.0289004e-09]
  [4.5100268e-02 9.5489973e-01 8.0198270e-10 1.0715678e-09 8.3455060e-10]]

 [[3.2350451e-02 9.6764952e-01 6.8061690e-10 9.1931279e-10 6.9222444e-10]
  [1.0786223e-13 1.0000000e+00 1.3710626e-15 7.8344059e-15 1.3482162e-15]
  [1.8573915e-07 9.9999976e-01 1.8675714e-12 5.1181485e-12 2.4328055e-12]
  ...
  [7.5038028e-01 2.4961968e-01 1.6653618e-09 1.7650759e-09 1.6696620e-09]
  [8.8669454e-09 1.0000000e+00 3.6613418e-13 1.1377653e-12 3.5771069e-13]
  [1.7162144e-01 8.2837856e-01 1.4980659e-09 1.8600930e-09 1.6066659e-09]]

 ...

 [[3.3534465e-13 1.0000000e+00 2.3452549e-15 1.1396515e-14 1.9256250e-15]
  [1.1138624e-08 1.0000000e+00 4.3636031e-13 1.3604158e-12 4.5593260e-13]
  [1.9132587e-01 8.0867416e-01 1.5521371e-09 1.9098387e-09 1.6528309e-09]
  ...
  [1.6704861e-02 9.8329514e-01 4.9324372e-10 6.9569128e-10 5.0823357e-10]
  [7.3940046e-02 9.2606002e-01 1.0189509e-09 1.3261392e-09 1.0713297e-09]
  [7.8057021e-01 2.1942979e-01 1.5923984e-09 1.6720436e-09 1.5946690e-09]]

 [[1.4687839e-13 1.0000000e+00 1.5597041e-15 7.8793334e-15 1.2782293e-15]
  [1.1346496e-07 9.9999988e-01 1.3873929e-12 3.8170834e-12 1.4728297e-12]
  [1.9971753e-16 1.0000000e+00 6.2729182e-17 5.1187350e-16 6.5855329e-17]
  ...
  [7.6078963e-01 2.3921034e-01 1.6400338e-09 1.7322771e-09 1.6418303e-09]
  [6.2493975e-03 9.9375063e-01 3.0305636e-10 4.5125820e-10 3.1206152e-10]
  [5.3670862e-10 1.0000000e+00 9.2801628e-14 3.3818890e-13 9.2409506e-14]]

 [[2.4947850e-02 9.7505218e-01 6.0245470e-10 8.2887075e-10 6.3278610e-10]
  [2.8176749e-14 1.0000000e+00 7.1149063e-16 4.3850413e-15 7.1549974e-16]
  [5.4010106e-03 9.9459898e-01 3.0344935e-10 4.6735887e-10 3.5938372e-10]
  ...
  [2.5129807e-03 9.9748695e-01 1.9269002e-10 3.0195232e-10 2.0032045e-10]
  [7.1695119e-01 2.8304881e-01 1.7387021e-09 1.8623013e-09 1.7527968e-09]
  [1.7129055e-07 9.9999988e-01 1.5965902e-12 4.2221855e-12 1.5774386e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.7188405e-13 1.0000000e+00 1.6855869e-15 8.4512272e-15 1.3813206e-15]
 [5.0696217e-02 9.4930375e-01 8.8078966e-10 1.1864082e-09 9.8345254e-10]
 [1.2515343e-05 9.9998748e-01 1.3824184e-11 2.9136971e-11 1.4880347e-11]
 ...
 [2.5129807e-03 9.9748695e-01 1.9269002e-10 3.0195232e-10 2.0032045e-10]
 [7.1695119e-01 2.8304881e-01 1.7387021e-09 1.8623013e-09 1.7527968e-09]
 [1.7129055e-07 9.9999988e-01 1.5965902e-12 4.2221855e-12 1.5774386e-12]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 0 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.17802689666748
tp :  20475.0
fp :  79525.0
tn :  320475.0
fn :  79525.0
accuracy :  0.6819031238555908
precision :  0.20475000143051147
recall :  0.20475000143051147
auc :  0.553227961063385

y_eval {0: 100000}
pred {0: 20475, 1: 79525}
[INFO] confusion matrix for file 
[[20475 79525     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 881724 3414412       0       0       0]
 [  48596  342771       0       0       0]
 [  27826   81869       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-02_121729_121.log.part12_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1368 (0.2736%)
[INFO] ** orig:[0:99.9986%,1:0.0008%,2:0.0006%]
[INFO] ** type:[0:99.9984%,1:0.0014%,2:0.0002%]
[INFO] ** i/f_name:[2:99.9978%,3:0.0022%]
[INFO] ** i/f_dir:[1:99.998%,0:0.002%]
[INFO] ** src:[22:38.1136%,9:26.1176%,7:18.2158%,1:17.5472%,14:0.0016%,11:0.0014%,10:0.001%,21:0.0006%,15:0.0004%,2:0.0004%,4:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.4022%,10:20.8284%,8:18.2156%,9:17.547%,15:0.0022%,22:0.002%,6:0.0008%,26:0.0004%,25:0.0004%,19:0.0004%,24:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** proto:[0:99.996%,1:0.0022%,2:0.0018%]
[INFO] ** appi_name:[21:99.9946%,30:0.0022%,22:0.0006%,26:0.0004%,0:0.0004%,31:0.0002%,27:0.0002%,24:0.0002%,23:0.0002%,18:0.0002%,16:0.0002%,15:0.0002%,14:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.1136%,20:26.1176%,13:18.2158%,6:17.5472%,17:0.0022%,10:0.0014%,11:0.001%,16:0.0004%,14:0.0004%,21:0.0002%,1:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9946%,-33.760870000000004:0.0052%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9984%,11:49.9962%,0:0.0052%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1164%,1:20.8284%,5:18.2154%,4:17.5466%,2:17.285%,0:0.0082%]
[INFO] ** service:[0.0048200000000000005:99.9954%,-211.73542999999998:0.0022%,-211.08818:0.0006%,-186.44547:0.0004%,-211.08346:0.0004%,-211.07873999999998:0.0004%,-186.42657:0.0002%,-186.43601999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:26.1168%,-0.32151:20.8284%,-1.27613:18.2154%,-0.23351:17.5468%,-0.33484:17.2852%,-71.33197:0.0022%,-10.59042:0.0008%,-71.14931:0.0006%,-64.19493:0.0004%,-1.02014:0.0004%,-0.24151:0.0004%,-71.14798:0.0004%,1.45709:0.0004%,10.54739:0.0004%,1.47576:0.0002%,1.46509:0.0002%,-1.27347:0.0002%,-68.79874000000001:0.0002%,13.34061:0.0002%,-1.2708:0.0002%,15.264529999999999:0.0002%]
[INFO] ** classification:[normal:99.9996%,Single Stage Multi Point:0.0004%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7332737e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.7332737e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.7332737e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-1.0409675e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0409675e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0409675e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.42612116e-14 1.00000000e+00 1.03688448e-15 5.44473287e-15
   8.48633945e-16]
  [1.63304082e-12 1.00000000e+00 5.45115507e-15 2.72043046e-14
   5.47512102e-15]
  [1.19967126e-05 9.99987960e-01 1.45115499e-11 3.13461132e-11
   1.75743552e-11]
  ...
  [7.19282389e-01 2.80717611e-01 1.72893311e-09 1.84864757e-09
   1.73469061e-09]
  [7.06513107e-01 2.93486953e-01 1.75137227e-09 1.87887661e-09
   1.75659809e-09]
  [7.04353452e-01 2.95646548e-01 1.75560633e-09 1.88473037e-09
   1.76238346e-09]]

 [[6.32853725e-09 1.00000000e+00 3.10499429e-13 9.41190051e-13
   2.80795515e-13]
  [3.26683502e-17 1.00000000e+00 2.57411559e-17 2.27347931e-16
   2.69317732e-17]
  [4.94235091e-19 1.00000000e+00 3.28724719e-18 3.62419061e-17
   3.64856133e-18]
  ...
  [8.51983503e-02 9.14801717e-01 1.10760834e-09 1.43966716e-09
   1.19675159e-09]
  [6.59149885e-01 3.40850085e-01 1.82736137e-09 1.98601247e-09
   1.84192550e-09]
  [5.78733325e-01 4.21266675e-01 1.90141791e-09 2.10509921e-09
   1.91798022e-09]]

 [[1.57058423e-07 9.99999881e-01 1.54024493e-12 3.97992620e-12
   1.46787140e-12]
  [2.07794295e-03 9.97922122e-01 1.83985258e-10 2.96493330e-10
   2.09831014e-10]
  [6.84067607e-01 3.15932423e-01 1.79444926e-09 1.93931515e-09
   1.81474991e-09]
  ...
  [3.86968814e-02 9.61303115e-01 7.63169972e-10 1.03775777e-09
   8.21953838e-10]
  [2.34278291e-11 1.00000000e+00 1.95914621e-14 8.45329530e-14
   1.92822798e-14]
  [2.59181764e-03 9.97408211e-01 2.09703754e-10 3.36342787e-10
   2.46158122e-10]]

 ...

 [[2.13301295e-12 1.00000000e+00 5.85620538e-15 2.60869834e-14
   4.84865334e-15]
  [1.78916669e-13 1.00000000e+00 1.81842198e-15 1.02366795e-14
   1.84371417e-15]
  [8.72654273e-05 9.99912739e-01 3.90650394e-11 7.57935034e-11
   4.76601571e-11]
  ...
  [6.77547038e-01 3.22452933e-01 1.80032333e-09 1.94710759e-09
   1.81379300e-09]
  [7.18480229e-01 2.81519800e-01 1.72986969e-09 1.84989624e-09
   1.73487580e-09]
  [2.23131977e-07 9.99999762e-01 1.82266767e-12 4.75172289e-12
   1.82002742e-12]]

 [[8.17114727e-14 1.00000000e+00 1.16738483e-15 6.05948185e-15
   9.55069776e-16]
  [1.87387504e-03 9.98126090e-01 1.75851250e-10 2.86123181e-10
   2.02349124e-10]
  [5.68670630e-01 4.31329370e-01 1.91758787e-09 2.13261186e-09
   1.96252303e-09]
  ...
  [6.80638492e-01 3.19361538e-01 1.79486759e-09 1.93934180e-09
   1.80574589e-09]
  [2.99192351e-08 1.00000000e+00 6.70141080e-13 1.94982095e-12
   6.60252506e-13]
  [9.46833640e-02 9.05316651e-01 1.16786014e-09 1.50974455e-09
   1.26668509e-09]]

 [[2.12668793e-12 1.00000000e+00 5.84761054e-15 2.60523753e-14
   4.84146372e-15]
  [7.84226619e-16 1.00000000e+00 1.24119126e-16 9.27148394e-16
   1.27634789e-16]
  [5.71957757e-18 1.00000000e+00 1.09996112e-17 1.07922162e-16
   1.21012346e-17]
  ...
  [7.16590405e-01 2.83409625e-01 1.73374159e-09 1.85517213e-09
   1.74011239e-09]
  [6.55757666e-01 3.44242334e-01 1.82800575e-09 1.98685668e-09
   1.83653293e-09]
  [7.45079398e-01 2.54920602e-01 1.67584235e-09 1.77848225e-09
   1.67835978e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.4261212e-14 1.0000000e+00 1.0368845e-15 5.4447329e-15 8.4863395e-16]
 [1.6330408e-12 1.0000000e+00 5.4511551e-15 2.7204305e-14 5.4751210e-15]
 [1.1996713e-05 9.9998796e-01 1.4511550e-11 3.1346113e-11 1.7574355e-11]
 ...
 [7.1659040e-01 2.8340963e-01 1.7337416e-09 1.8551721e-09 1.7401124e-09]
 [6.5575767e-01 3.4424233e-01 1.8280057e-09 1.9868567e-09 1.8365329e-09]
 [7.4507940e-01 2.5492060e-01 1.6758424e-09 1.7784823e-09 1.6783598e-09]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  8.384211904907227
tp :  21550.0
fp :  78450.0
tn :  321550.0
fn :  78450.0
accuracy :  0.686203122138977
precision :  0.21549999713897705
recall :  0.21549999713897705
auc :  0.5649852156639099

y_eval {0: 100000}
pred {0: 21550, 1: 78450}
[INFO] confusion matrix for file 
[[21550 78450     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 903274 3492862       0       0       0]
 [  48596  342771       0       0       0]
 [  27826   81869       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0409675e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.0409675e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0409675e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-3.4612519e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4612519e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4612519e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[3.37011591e-02 9.66298819e-01 6.96046221e-10 9.40692968e-10
   7.24765359e-10]
  [8.55274835e-13 1.00000000e+00 3.82583903e-15 1.96346303e-14
   3.77986759e-15]
  [9.40635437e-06 9.99990582e-01 1.30387558e-11 2.87324782e-11
   1.64598803e-11]
  ...
  [5.10641754e-01 4.89358246e-01 1.92956784e-09 2.17083729e-09
   1.95659622e-09]
  [1.74354242e-09 1.00000000e+00 1.64288423e-13 5.58647963e-13
   1.61015556e-13]
  [1.02943510e-01 8.97056460e-01 1.21459631e-09 1.56319990e-09
   1.32237832e-09]]

 [[1.68988634e-09 1.00000000e+00 1.60882321e-13 5.20230777e-13
   1.42606711e-13]
  [5.59451175e-04 9.99440491e-01 9.64129471e-11 1.67491784e-10
   1.12411989e-10]
  [7.63535738e-01 2.36464337e-01 1.63742697e-09 1.72962267e-09
   1.64537906e-09]
  ...
  [1.82111549e-07 9.99999762e-01 1.65286697e-12 4.36250602e-12
   1.66236133e-12]
  [2.90830165e-01 7.09169805e-01 1.78926951e-09 2.13551177e-09
   1.88626559e-09]
  [1.41410430e-08 1.00000000e+00 4.63801957e-13 1.40728325e-12
   4.49798185e-13]]

 [[3.09720300e-02 9.69027996e-01 6.68226252e-10 9.07364739e-10
   6.95891789e-10]
  [7.35575778e-15 1.00000000e+00 3.66221630e-16 2.42070751e-15
   3.69008051e-16]
  [5.54933553e-19 1.00000000e+00 3.47560283e-18 3.82358812e-17
   3.83049144e-18]
  ...
  [3.56859356e-01 6.43140614e-01 1.84656879e-09 2.15023599e-09
   1.87649252e-09]
  [7.31821477e-01 2.68178552e-01 1.70495873e-09 1.81685511e-09
   1.71130521e-09]
  [4.21773549e-08 1.00000000e+00 7.94753423e-13 2.26848531e-12
   7.81119744e-13]]

 ...

 [[2.48655652e-10 1.00000000e+00 6.20300388e-14 2.20132560e-13
   5.35945427e-14]
  [2.13037511e-15 1.00000000e+00 2.02971766e-16 1.44527199e-15
   2.09772170e-16]
  [4.22560051e-03 9.95774448e-01 2.68308070e-10 4.19252938e-10
   3.18590265e-10]
  ...
  [1.54701922e-06 9.99998450e-01 4.81885582e-12 1.13278380e-11
   4.86348245e-12]
  [1.11189825e-13 1.00000000e+00 1.42468464e-15 8.29222470e-15
   1.47143493e-15]
  [4.17048112e-04 9.99582946e-01 8.55945245e-11 1.52779497e-10
   1.04330142e-10]]

 [[2.44892134e-10 1.00000000e+00 6.15617583e-14 2.18632038e-13
   5.31804079e-14]
  [5.65132839e-17 1.00000000e+00 3.37727951e-17 2.89614541e-16
   3.51661411e-17]
  [4.33520396e-18 1.00000000e+00 9.64088186e-18 9.57637583e-17
   1.08341602e-17]
  ...
  [7.62885511e-01 2.37114549e-01 1.63473812e-09 1.72518566e-09
   1.63273750e-09]
  [2.35163629e-01 7.64836431e-01 1.63452629e-09 1.96660110e-09
   1.67084824e-09]
  [1.41446117e-06 9.99998569e-01 4.61952828e-12 1.09194225e-11
   4.73302951e-12]]

 [[3.46048661e-02 9.65395153e-01 7.07388315e-10 9.57109059e-10
   7.50487394e-10]
  [3.72429602e-02 9.62757051e-01 7.40047246e-10 1.00367581e-09
   7.90930321e-10]
  [2.19972372e-01 7.80027688e-01 1.60667168e-09 1.94759120e-09
   1.66739522e-09]
  ...
  [7.58285522e-01 2.41714448e-01 1.64596126e-09 1.73985160e-09
   1.64723635e-09]
  [7.92076111e-01 2.07923919e-01 1.55857771e-09 1.62908798e-09
   1.55328039e-09]
  [6.26415826e-08 9.99999881e-01 9.67238225e-13 2.70159567e-12
   9.56082652e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[3.3701159e-02 9.6629882e-01 6.9604622e-10 9.4069297e-10 7.2476536e-10]
 [8.5527484e-13 1.0000000e+00 3.8258390e-15 1.9634630e-14 3.7798676e-15]
 [9.4063544e-06 9.9999058e-01 1.3038756e-11 2.8732478e-11 1.6459880e-11]
 ...
 [7.5828552e-01 2.4171445e-01 1.6459613e-09 1.7398516e-09 1.6472363e-09]
 [7.9207611e-01 2.0792392e-01 1.5585777e-09 1.6290880e-09 1.5532804e-09]
 [6.2641583e-08 9.9999988e-01 9.6723823e-13 2.7015957e-12 9.5608265e-13]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 0 0 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.411795797729493
tp :  19906.0
fp :  80094.0
tn :  319906.0
fn :  80094.0
accuracy :  0.6796271800994873
precision :  0.19905999302864075
recall :  0.19905999302864075
auc :  0.562390148639679

y_eval {0: 100000}
pred {0: 19906, 1: 80094}
[INFO] confusion matrix for file 
[[19906 80094     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 923180 3572956       0       0       0]
 [  48596  342771       0       0       0]
 [  27826   81869       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.461252e-01  0.000000e+00  0.000000e+00 ...  5.000000e+00
   4.820000e-03 -1.276130e+00]
 [-3.461252e-01  0.000000e+00  0.000000e+00 ...  2.000000e+00
   4.820000e-03 -3.348400e-01]
 [-3.461252e-01  0.000000e+00  0.000000e+00 ...  3.000000e+00
   4.820000e-03  1.454420e+00]
 ...
 [ 3.461811e-01  0.000000e+00  0.000000e+00 ...  1.000000e+00
   4.820000e-03 -3.215100e-01]
 [ 3.461811e-01  0.000000e+00  0.000000e+00 ...  5.000000e+00
   4.820000e-03 -1.276130e+00]
 [ 3.461811e-01  0.000000e+00  0.000000e+00 ...  3.000000e+00
   4.820000e-03  1.454420e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[7.6069177e-12 1.0000000e+00 1.0992959e-14 4.6112728e-14 9.1807225e-15]
  [1.0827308e-03 9.9891734e-01 1.3457097e-10 2.2608036e-10 1.5930605e-10]
  [6.6417497e-01 3.3582500e-01 1.8245151e-09 1.9824427e-09 1.8511557e-09]
  ...
  [2.6553109e-09 1.0000000e+00 2.1613765e-13 7.3455868e-13 2.3711019e-13]
  [3.9701171e-15 1.0000000e+00 2.7732475e-16 1.9517827e-15 2.9800880e-16]
  [3.8600508e-03 9.9613994e-01 2.5750937e-10 4.0540976e-10 3.0589736e-10]]

 [[3.2550680e-09 1.0000000e+00 2.2300116e-13 6.9852110e-13 1.9977650e-13]
  [9.7987149e-04 9.9902010e-01 1.2740825e-10 2.1458038e-10 1.4818793e-10]
  [7.8584343e-01 2.1415664e-01 1.5790842e-09 1.6554847e-09 1.5817911e-09]
  ...
  [1.2720365e-16 1.0000000e+00 5.0962095e-17 4.3192132e-16 5.6359567e-17]
  [5.3708398e-08 1.0000000e+00 1.0271679e-12 3.0488741e-12 1.3865598e-12]
  [1.3839513e-13 1.0000000e+00 1.5932660e-15 9.2307990e-15 1.6806431e-15]]

 [[3.0898037e-03 9.9691027e-01 2.1467599e-10 3.3110062e-10 2.2622638e-10]
  [1.6697538e-01 8.3302462e-01 1.4593337e-09 1.8082444e-09 1.5468209e-09]
  [8.0583501e-01 1.9416495e-01 1.5197376e-09 1.5812660e-09 1.5158872e-09]
  ...
  [1.1072747e-01 8.8927251e-01 1.2581640e-09 1.6143193e-09 1.3786847e-09]
  [3.7092686e-01 6.2907308e-01 1.8666502e-09 2.1687829e-09 1.9042801e-09]
  [7.7767712e-01 2.2232285e-01 1.5981558e-09 1.6787900e-09 1.5957891e-09]]

 ...

 [[8.7998090e-03 9.9120015e-01 3.6213352e-10 5.2894322e-10 3.8771975e-10]
  [1.9894762e-01 8.0105239e-01 1.5571460e-09 1.9041360e-09 1.6355488e-09]
  [3.7248147e-01 6.2751859e-01 1.8681705e-09 2.1701807e-09 1.9175903e-09]
  ...
  [2.0649817e-03 9.9793506e-01 1.8670795e-10 3.0296676e-10 2.1832118e-10]
  [2.6277275e-12 1.0000000e+00 6.6815958e-15 3.2621390e-14 6.6138120e-15]
  [2.1500110e-03 9.9785006e-01 1.9202734e-10 3.1172917e-10 2.2856196e-10]]

 [[2.0513993e-03 9.9794859e-01 1.7413658e-10 2.7320959e-10 1.7697467e-10]
  [1.3517119e-06 9.9999869e-01 4.6062433e-12 1.0963144e-11 4.8348760e-12]
  [5.1990342e-01 4.8009661e-01 1.9471214e-09 2.1938305e-09 2.0062223e-09]
  ...
  [5.2055338e-09 1.0000000e+00 2.8338996e-13 9.1024085e-13 2.7910606e-13]
  [2.3710643e-05 9.9997628e-01 2.0380616e-11 4.2453284e-11 2.4907588e-11]
  [1.0732001e-14 1.0000000e+00 4.4644015e-16 2.9561537e-15 4.6294575e-16]]

 [[6.1966412e-06 9.9999380e-01 9.6301734e-12 2.0577252e-11 9.5592423e-12]
  [2.7301366e-02 9.7269857e-01 6.4835948e-10 9.0072816e-10 7.1463063e-10]
  [7.7951866e-01 2.2048129e-01 1.5946908e-09 1.6748818e-09 1.5963555e-09]
  ...
  [7.5252318e-01 2.4747683e-01 1.6591956e-09 1.7569410e-09 1.6614534e-09]
  [1.0167680e-05 9.9998987e-01 1.2258702e-11 2.5947812e-11 1.2521817e-11]
  [8.9852087e-02 9.1014796e-01 1.1299022e-09 1.4608418e-09 1.2087035e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[7.6069177e-12 1.0000000e+00 1.0992959e-14 4.6112728e-14 9.1807225e-15]
 [1.0827308e-03 9.9891734e-01 1.3457097e-10 2.2608036e-10 1.5930605e-10]
 [6.6417497e-01 3.3582500e-01 1.8245151e-09 1.9824427e-09 1.8511557e-09]
 ...
 [7.5252318e-01 2.4747683e-01 1.6591956e-09 1.7569410e-09 1.6614534e-09]
 [1.0167680e-05 9.9998987e-01 1.2258702e-11 2.5947812e-11 1.2521817e-11]
 [8.9852087e-02 9.1014796e-01 1.1299022e-09 1.4608418e-09 1.2087035e-09]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 0 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.386118814086913
tp :  18990.0
fp :  81010.0
tn :  318990.0
fn :  81010.0
accuracy :  0.6759631037712097
precision :  0.1898999959230423
recall :  0.1898999959230423
auc :  0.5590643882751465

y_eval {0: 100000}
pred {0: 18990, 1: 81010}
[INFO] confusion matrix for file 
[[18990 81010     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 942170 3653966       0       0       0]
 [  48596  342771       0       0       0]
 [  27826   81869       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4618109e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 3.4618109e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4618109e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 ...
 [ 1.0384874e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.0384874e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0384874e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[8.51181429e-03 9.91488218e-01 3.56216279e-10 5.21247878e-10
   3.81404769e-10]
  [8.26950597e-09 1.00000000e+00 3.64653186e-13 1.14508901e-12
   3.75392751e-13]
  [7.21533075e-02 9.27846670e-01 1.03220854e-09 1.35651235e-09
   1.12476417e-09]
  ...
  [1.08938768e-10 1.00000000e+00 4.19369739e-14 1.66391206e-13
   4.15337862e-14]
  [2.52593425e-04 9.99747455e-01 6.63216218e-11 1.21352914e-10
   8.01503447e-11]
  [2.26731226e-03 9.97732639e-01 1.87403204e-10 2.97903924e-10
   2.00956904e-10]]

 [[5.58334750e-06 9.99994397e-01 9.14170128e-12 1.96390838e-11
   9.06253544e-12]
  [2.62973122e-02 9.73702669e-01 6.36849407e-10 8.86711149e-10
   7.02439606e-10]
  [7.95829952e-01 2.04170004e-01 1.54995650e-09 1.61887825e-09
   1.54928559e-09]
  ...
  [8.09731944e-07 9.99999166e-01 3.91272344e-12 9.95291610e-12
   5.13325060e-12]
  [3.40888651e-10 1.00000000e+00 7.59986150e-14 2.87266928e-13
   8.00693062e-14]
  [1.60741251e-06 9.99998450e-01 5.34387465e-12 1.29198813e-11
   6.49301836e-12]]

 [[5.39343091e-06 9.99994636e-01 8.98503494e-12 1.93371204e-11
   8.90335375e-12]
  [2.59504616e-02 9.74049509e-01 6.32813357e-10 8.81787587e-10
   6.98161029e-10]
  [7.77779996e-01 2.22219974e-01 1.59928515e-09 1.68069092e-09
   1.60128433e-09]
  ...
  [3.09277257e-12 1.00000000e+00 7.24461859e-15 3.50803134e-14
   7.21788877e-15]
  [3.17376533e-15 1.00000000e+00 2.56326966e-16 1.85212394e-15
   3.14784019e-16]
  [2.85836892e-11 1.00000000e+00 2.36678556e-14 1.05217206e-13
   2.93293222e-14]]

 ...

 [[9.92777041e-11 1.00000000e+00 3.93142482e-14 1.45858843e-13
   3.36255885e-14]
  [1.32720190e-16 1.00000000e+00 5.15120969e-17 4.22831039e-16
   5.35116208e-17]
  [4.92839883e-12 1.00000000e+00 9.81171372e-15 4.74344278e-14
   1.19192316e-14]
  ...
  [3.82211566e-01 6.17788434e-01 1.91099181e-09 2.22708763e-09
   2.00133132e-09]
  [8.07742417e-01 1.92257598e-01 1.51372459e-09 1.57389246e-09
   1.50970247e-09]
  [5.45312203e-02 9.45468724e-01 8.74386619e-10 1.15342669e-09
   8.99920527e-10]]

 [[1.54205381e-11 1.00000000e+00 1.56043103e-14 6.32691599e-14
   1.30998821e-14]
  [3.96230816e-16 1.00000000e+00 8.84788647e-17 6.85647389e-16
   9.13435632e-17]
  [1.53012616e-15 1.00000000e+00 1.76627016e-16 1.30591368e-15
   2.03059275e-16]
  ...
  [1.26271119e-15 1.00000000e+00 1.55888844e-16 1.16083038e-15
   1.64346468e-16]
  [5.90023278e-19 1.00000000e+00 3.56606868e-18 3.94914785e-17
   3.87330920e-18]
  [1.58581713e-07 9.99999881e-01 1.80232663e-12 5.08348528e-12
   2.61163812e-12]]

 [[2.54014023e-02 9.74598587e-01 6.09394757e-10 8.39263770e-10
   6.49021559e-10]
  [4.91438866e-01 5.08561134e-01 1.93737271e-09 2.19183738e-09
   1.98857375e-09]
  [1.22019229e-02 9.87798035e-01 4.24308588e-10 6.10544226e-10
   4.47249765e-10]
  ...
  [1.06311031e-08 1.00000000e+00 4.38863518e-13 1.39353535e-12
   5.18852322e-13]
  [7.15215986e-16 1.00000000e+00 1.18702602e-16 9.15120632e-16
   1.27993640e-16]
  [4.52682901e-14 1.00000000e+00 9.66213553e-16 6.08828224e-15
   1.21365665e-15]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[8.5118143e-03 9.9148822e-01 3.5621628e-10 5.2124788e-10 3.8140477e-10]
 [8.2695060e-09 1.0000000e+00 3.6465319e-13 1.1450890e-12 3.7539275e-13]
 [7.2153307e-02 9.2784667e-01 1.0322085e-09 1.3565123e-09 1.1247642e-09]
 ...
 [1.0631103e-08 1.0000000e+00 4.3886352e-13 1.3935354e-12 5.1885232e-13]
 [7.1521599e-16 1.0000000e+00 1.1870260e-16 9.1512063e-16 1.2799364e-16]
 [4.5268290e-14 1.0000000e+00 9.6621355e-16 6.0882822e-15 1.2136567e-15]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.307156503295898
tp :  19634.0
fp :  80366.0
tn :  319634.0
fn :  80366.0
accuracy :  0.6785391569137573
precision :  0.19633999466896057
recall :  0.19633999466896057
auc :  0.5557630062103271

y_eval {0: 100000}
pred {0: 19634, 1: 80366}
[INFO] confusion matrix for file 
[[19634 80366     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 961804 3734332       0       0       0]
 [  48596  342771       0       0       0]
 [  27826   81869       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0384874  0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 1.0384874  0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 1.0384874  0.         0.        ...  3.         0.00482    1.45442  ]
 ...
 [ 1.7307937  0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 1.7307937  0.         0.        ...  4.         0.00482   -0.23351  ]
 [ 1.7307937  0.         0.        ...  3.         0.00482    1.45442  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[4.84908087e-05 9.99951482e-01 2.68801023e-11 5.15292115e-11
   2.70678393e-11]
  [8.10549706e-02 9.18945014e-01 1.07588449e-09 1.39767808e-09
   1.15683874e-09]
  [1.91660196e-01 8.08339834e-01 1.52401358e-09 1.86464821e-09
   1.58790647e-09]
  ...
  [1.07407257e-10 1.00000000e+00 4.14532978e-14 1.64730209e-13
   4.04463315e-14]
  [1.58315301e-01 8.41684759e-01 1.45498780e-09 1.81961435e-09
   1.57224500e-09]
  [1.70594733e-03 9.98294055e-01 1.59910876e-10 2.56678456e-10
   1.68077816e-10]]

 [[9.30396177e-11 1.00000000e+00 3.80675546e-14 1.41674636e-13
   3.25357010e-14]
  [9.46329266e-04 9.99053657e-01 1.25433580e-10 2.11834481e-10
   1.46847964e-10]
  [7.91540623e-01 2.08459347e-01 1.56302660e-09 1.63524083e-09
   1.56427915e-09]
  ...
  [2.89380014e-01 7.10619986e-01 1.78973714e-09 2.13772888e-09
   1.89217864e-09]
  [2.12852731e-01 7.87147284e-01 1.58202706e-09 1.91996441e-09
   1.63382519e-09]
  [7.90763259e-01 2.09236771e-01 1.56330338e-09 1.63514691e-09
   1.56062518e-09]]

 [[1.94571857e-13 1.00000000e+00 1.79206104e-15 8.93274678e-15
   1.46892803e-15]
  [3.20933935e-07 9.99999642e-01 2.32794773e-12 6.05754769e-12
   2.49777130e-12]
  [3.55674446e-01 6.44325495e-01 1.87392457e-09 2.19455343e-09
   1.95916083e-09]
  ...
  [6.15152121e-01 3.84847850e-01 1.88376648e-09 2.07252282e-09
   1.91859173e-09]
  [1.91727653e-03 9.98082757e-01 1.68654257e-10 2.68410932e-10
   1.75757103e-10]
  [6.99576914e-01 3.00423086e-01 1.77086956e-09 1.90621408e-09
   1.78906323e-09]]

 ...

 [[1.16182107e-03 9.98838246e-01 1.31270356e-10 2.12568241e-10
   1.34367448e-10]
  [3.53245825e-01 6.46754205e-01 1.86141902e-09 2.17629403e-09
   1.93262584e-09]
  [1.13334716e-03 9.98866677e-01 1.30078961e-10 2.13532109e-10
   1.38851028e-10]
  ...
  [1.25735198e-07 9.99999881e-01 1.36877033e-12 3.68279626e-12
   1.36050394e-12]
  [6.29405975e-01 3.70593995e-01 1.87737736e-09 2.05997752e-09
   1.91395277e-09]
  [2.14485311e-07 9.99999762e-01 1.78760153e-12 4.66800903e-12
   1.76274620e-12]]

 [[3.45869921e-06 9.99996543e-01 7.21625017e-12 1.59371960e-11
   7.22822106e-12]
  [6.58435395e-09 1.00000000e+00 3.32849877e-13 1.06579025e-12
   3.54696199e-13]
  [4.51050907e-01 5.48949063e-01 1.94814542e-09 2.23233299e-09
   2.02586681e-09]
  ...
  [8.40017140e-01 1.59982860e-01 1.40639544e-09 1.44362433e-09
   1.39701395e-09]
  [7.97396481e-01 2.02603504e-01 1.54371660e-09 1.61074409e-09
   1.53902135e-09]
  [5.20667847e-08 1.00000000e+00 8.81263595e-13 2.48570999e-12
   8.70063461e-13]]

 [[2.51924662e-11 1.00000000e+00 1.99039681e-14 7.88520047e-14
   1.67843983e-14]
  [6.06872400e-11 1.00000000e+00 3.27164138e-14 1.35203385e-13
   3.40724153e-14]
  [1.79529652e-16 1.00000000e+00 6.01805726e-17 4.97168741e-16
   6.55315510e-17]
  ...
  [8.31266046e-01 1.68733984e-01 1.43711987e-09 1.48044155e-09
   1.42826340e-09]
  [3.64851012e-08 1.00000000e+00 7.39277129e-13 2.12670810e-12
   7.30409277e-13]
  [7.92133324e-06 9.99992132e-01 1.17507835e-11 2.59336701e-11
   1.41270537e-11]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[4.84908087e-05 9.99951482e-01 2.68801023e-11 5.15292115e-11
  2.70678393e-11]
 [8.10549706e-02 9.18945014e-01 1.07588449e-09 1.39767808e-09
  1.15683874e-09]
 [1.91660196e-01 8.08339834e-01 1.52401358e-09 1.86464821e-09
  1.58790647e-09]
 ...
 [8.31266046e-01 1.68733984e-01 1.43711987e-09 1.48044155e-09
  1.42826340e-09]
 [3.64851012e-08 1.00000000e+00 7.39277129e-13 2.12670810e-12
  7.30409277e-13]
 [7.92133324e-06 9.99992132e-01 1.17507835e-11 2.59336701e-11
  1.41270537e-11]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 0 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.124132139587402
tp :  20483.0
fp :  79517.0
tn :  320483.0
fn :  79517.0
accuracy :  0.6819351315498352
precision :  0.20483000576496124
recall :  0.20483000576496124
auc :  0.5552322268486023

y_eval {0: 99998, 2: 2}
pred {0: 20483, 1: 79517}
[INFO] confusion matrix for file 
[[20483 79515     0     0     0]
 [    0     0     0     0     0]
 [    0     2     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[ 982287 3813847       0       0       0]
 [  48596  342771       0       0       0]
 [  27826   81871       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-02_121729_121.log.part13_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1368 (0.2736%)
[INFO] ** orig:[0:99.9996%,2:0.0004%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9994%,3:0.0006%]
[INFO] ** i/f_dir:[1:99.9994%,0:0.0006%]
[INFO] ** src:[22:38.162%,9:26.1664%,7:18.0742%,1:17.5958%,21:0.0008%,17:0.0002%,15:0.0002%,14:0.0002%,8:0.0002%]
[INFO] ** dst:[21:43.4352%,10:20.8932%,8:18.0744%,9:17.5952%,22:0.0006%,18:0.0006%,15:0.0006%,6:0.0002%]
[INFO] ** proto:[0:99.9986%,2:0.0008%,1:0.0006%]
[INFO] ** appi_name:[21:99.9986%,31:0.0006%,30:0.0006%,22:0.0002%]
[INFO] ** proxy_src_ip:[18:38.162%,20:26.1664%,13:18.0742%,6:17.5958%,17:0.0006%,7:0.0004%,16:0.0002%,2:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9986%,-33.760870000000004:0.0014%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.9988%,0:0.0014%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.166%,1:20.893%,5:18.0738%,4:17.5948%,2:17.2688%,0:0.0036%]
[INFO] ** service:[0.0048200000000000005:99.9986%,-211.73542999999998:0.0006%,-186.43601999999998:0.0006%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:26.1662%,-0.32151:20.8932%,-1.27613:18.074%,-0.23351:17.5952%,-0.33484:17.2688%,-71.33197:0.0006%,15.43653:0.0004%,-0.24151:0.0004%,-0.24950999999999998:0.0002%,1.46509:0.0002%,4.42897:0.0002%,-71.14931:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:92.8338%,Multi Stage Single Point:7.1662%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7333814e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.7333814e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.7333814e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [-1.0384512e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0384512e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.0384512e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[4.9127706e-09 1.0000000e+00 2.7370922e-13 8.4008842e-13 2.4658896e-13]
  [1.5554465e-03 9.9844462e-01 1.6020642e-10 2.6291533e-10 1.8565031e-10]
  [8.1969981e-10 1.0000000e+00 1.1528441e-13 4.1198878e-13 1.1838624e-13]
  ...
  [5.8259457e-01 4.1740540e-01 1.8989548e-09 2.1007089e-09 1.9177584e-09]
  [9.3000530e-08 9.9999988e-01 1.1806383e-12 3.2306803e-12 1.1743542e-12]
  [9.7725448e-12 1.0000000e+00 1.3149523e-14 6.0281756e-14 1.3545783e-14]]

 [[4.1634003e-03 9.9583662e-01 2.4946686e-10 3.7915432e-10 2.6553482e-10]
  [1.9767623e-01 8.0232376e-01 1.5565444e-09 1.9060127e-09 1.6426156e-09]
  [7.4057484e-01 2.5942513e-01 1.6868441e-09 1.7931377e-09 1.6928972e-09]
  ...
  [1.5657362e-16 1.0000000e+00 5.6715427e-17 4.7582081e-16 6.3460139e-17]
  [8.3340979e-08 9.9999988e-01 1.2745501e-12 3.6881808e-12 1.6941791e-12]
  [1.4619447e-01 8.5380554e-01 1.3946153e-09 1.7491026e-09 1.4849313e-09]]

 [[2.6254075e-02 9.7374594e-01 6.1989053e-10 8.5275692e-10 6.6325173e-10]
  [3.7432243e-13 1.0000000e+00 2.5538624e-15 1.3737071e-14 2.5564452e-15]
  [1.0008189e-03 9.9899918e-01 1.3188106e-10 2.2376843e-10 1.5948846e-10]
  ...
  [7.3266125e-01 2.6733878e-01 1.7025418e-09 1.8135948e-09 1.7075957e-09]
  [7.2377240e-08 9.9999988e-01 1.0390201e-12 2.8792858e-12 1.0237841e-12]
  [1.0069915e-12 1.0000000e+00 4.2633290e-15 2.2038618e-14 4.3569787e-15]]

 ...

 [[3.5857808e-10 1.0000000e+00 7.4414751e-14 2.5949631e-13 6.4623566e-14]
  [4.6710356e-17 1.0000000e+00 3.0738753e-17 2.6623709e-16 3.2047611e-17]
  [2.5314288e-04 9.9974686e-01 6.7445709e-11 1.2412429e-10 8.5235950e-11]
  ...
  [6.1549383e-07 9.9999940e-01 3.3023629e-12 8.4152208e-12 3.9166669e-12]
  [7.7104112e-16 1.0000000e+00 1.2228390e-16 9.3307731e-16 1.2931234e-16]
  [1.4760757e-03 9.9852389e-01 1.6125845e-10 2.6872526e-10 1.9690308e-10]]

 [[6.7920485e-03 9.9320799e-01 3.1868447e-10 4.7228865e-10 3.4219863e-10]
  [4.2488220e-01 5.7511783e-01 1.9212583e-09 2.2088675e-09 1.9864923e-09]
  [7.3565513e-01 2.6434481e-01 1.6967943e-09 1.8061591e-09 1.7033963e-09]
  ...
  [2.9248677e-03 9.9707508e-01 2.2230641e-10 3.5422568e-10 2.5967758e-10]
  [2.1497283e-10 1.0000000e+00 5.8975028e-14 2.2617273e-13 5.8209730e-14]
  [9.1601685e-02 9.0839833e-01 1.1542995e-09 1.4967921e-09 1.2599062e-09]]

 [[6.7515285e-03 9.9324846e-01 3.1774028e-10 4.7104293e-10 3.4118544e-10]
  [4.2293996e-01 5.7706004e-01 1.9201798e-09 2.2086344e-09 1.9856612e-09]
  [3.8278455e-01 6.1721551e-01 1.8755983e-09 2.1723192e-09 1.9187989e-09]
  ...
  [3.7381039e-08 1.0000000e+00 7.4887514e-13 2.1510304e-12 7.3744770e-13]
  [3.1897500e-01 6.8102503e-01 1.8363022e-09 2.1748934e-09 1.9335638e-09]
  [5.7804942e-01 4.2195058e-01 1.9047977e-09 2.1110143e-09 1.9319655e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[4.9127706e-09 1.0000000e+00 2.7370922e-13 8.4008842e-13 2.4658896e-13]
 [1.5554465e-03 9.9844462e-01 1.6020642e-10 2.6291533e-10 1.8565031e-10]
 [8.1969981e-10 1.0000000e+00 1.1528441e-13 4.1198878e-13 1.1838624e-13]
 ...
 [3.7381039e-08 1.0000000e+00 7.4887514e-13 2.1510304e-12 7.3744770e-13]
 [3.1897500e-01 6.8102503e-01 1.8363022e-09 2.1748934e-09 1.9335638e-09]
 [5.7804942e-01 4.2195058e-01 1.9047977e-09 2.1110143e-09 1.9319655e-09]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  8.351887300109864
tp :  21585.0
fp :  78415.0
tn :  321585.0
fn :  78415.0
accuracy :  0.6863431334495544
precision :  0.21584999561309814
recall :  0.21584999561309814
auc :  0.5661014318466187

y_eval {0: 100000}
pred {0: 21585, 1: 78415}
[INFO] confusion matrix for file 
[[21585 78415     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1003872 3892262       0       0       0]
 [  48596  342771       0       0       0]
 [  27826   81871       0       0       0]
 [      0       0       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0384512e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0384512e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0384512e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-3.4605739e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4605739e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4605739e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[2.08032272e-11 1.00000000e+00 1.81017311e-14 7.23843457e-14
   1.52446398e-14]
  [3.33458331e-04 9.99666572e-01 7.49978205e-11 1.34539685e-10
   8.94089872e-11]
  [5.67892253e-01 4.32107747e-01 1.91880223e-09 2.13494333e-09
   1.96284478e-09]
  ...
  [4.78931277e-08 1.00000000e+00 8.50962801e-13 2.41646720e-12
   8.51920964e-13]
  [3.17048907e-01 6.82951033e-01 1.83376359e-09 2.17380958e-09
   1.93166061e-09]
  [2.40323971e-07 9.99999762e-01 1.89849091e-12 4.93453065e-12
   1.87713885e-12]]

 [[3.32627620e-10 1.00000000e+00 7.16871969e-14 2.50896282e-13
   6.21967281e-14]
  [4.74747243e-17 1.00000000e+00 3.09868111e-17 2.68153293e-16
   3.23025345e-17]
  [2.46815034e-04 9.99753177e-01 6.66044372e-11 1.22750365e-10
   8.41962194e-11]
  ...
  [3.91270305e-09 1.00000000e+00 2.45590603e-13 7.99579424e-13
   2.42633116e-13]
  [1.61352276e-04 9.99838591e-01 5.27383970e-11 9.86716056e-11
   6.30726651e-11]
  [1.28478747e-11 1.00000000e+00 1.47349716e-14 6.61861042e-14
   1.48084229e-14]]

 [[6.83463635e-14 1.00000000e+00 1.06892170e-15 5.59667025e-15
   8.74871320e-16]
  [2.17481069e-02 9.78251934e-01 5.88944338e-10 8.34689484e-10
   6.68867572e-10]
  [6.74412251e-01 3.25587779e-01 1.80802373e-09 1.95863459e-09
   1.83237414e-09]
  ...
  [2.49172032e-01 7.50828028e-01 1.66640957e-09 1.99613215e-09
   1.69966230e-09]
  [5.41030047e-08 1.00000000e+00 9.06892833e-13 2.56038224e-12
   9.08884188e-13]
  [3.41438413e-01 6.58561647e-01 1.86656468e-09 2.19837770e-09
   1.96156424e-09]]

 ...

 [[7.01248864e-05 9.99929905e-01 3.24090442e-11 6.11020332e-11
   3.33138725e-11]
  [6.18230850e-02 9.38176990e-01 9.51653534e-10 1.25824962e-09
   1.03150000e-09]
  [7.74112761e-01 2.25887179e-01 1.60850289e-09 1.69231351e-09
   1.61058422e-09]
  ...
  [2.45537830e-08 1.00000000e+00 6.22686906e-13 1.84585268e-12
   6.27244025e-13]
  [2.71644578e-16 1.00000000e+00 7.36231906e-17 5.94858322e-16
   7.93279773e-17]
  [4.14940828e-08 1.00000000e+00 9.00285109e-13 2.70502479e-12
   1.19541692e-12]]

 [[5.87427329e-11 1.00000000e+00 3.02961967e-14 1.15257142e-13
   2.57607436e-14]
  [4.86971345e-04 9.99513030e-01 9.02937100e-11 1.58377034e-10
   1.06576414e-10]
  [7.62410998e-01 2.37588972e-01 1.64025649e-09 1.73326908e-09
   1.64873160e-09]
  ...
  [1.70363765e-03 9.98296320e-01 1.67639250e-10 2.73534806e-10
   1.90152644e-10]
  [5.69382896e-09 1.00000000e+00 3.00884372e-13 9.65901729e-13
   3.00578085e-13]
  [1.49926752e-01 8.50073278e-01 1.41754797e-09 1.77763726e-09
   1.52397772e-09]]

 [[9.38003134e-14 1.00000000e+00 1.24971516e-15 6.44534093e-15
   1.02270335e-15]
  [3.66625264e-02 9.63337481e-01 7.55000396e-10 1.03634212e-09
   8.41440029e-10]
  [6.85817480e-01 3.14182490e-01 1.79018778e-09 1.93322292e-09
   1.81238202e-09]
  ...
  [7.03389287e-01 2.96610743e-01 1.75918557e-09 1.88983429e-09
   1.76988479e-09]
  [7.44383812e-01 2.55616158e-01 1.67731762e-09 1.78046888e-09
   1.68046532e-09]
  [6.64410393e-08 9.99999881e-01 9.95605182e-13 2.77233249e-12
   9.84062332e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[2.0803227e-11 1.0000000e+00 1.8101731e-14 7.2384346e-14 1.5244640e-14]
 [3.3345833e-04 9.9966657e-01 7.4997820e-11 1.3453968e-10 8.9408987e-11]
 [5.6789225e-01 4.3210775e-01 1.9188022e-09 2.1349433e-09 1.9628448e-09]
 ...
 [7.0338929e-01 2.9661074e-01 1.7591856e-09 1.8898343e-09 1.7698848e-09]
 [7.4438381e-01 2.5561616e-01 1.6773176e-09 1.7804689e-09 1.6804653e-09]
 [6.6441039e-08 9.9999988e-01 9.9560518e-13 2.7723325e-12 9.8406233e-13]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 0 0 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.472320152282714
tp :  19642.0
fp :  80358.0
tn :  319642.0
fn :  80358.0
accuracy :  0.6785711646080017
precision :  0.19641999900341034
recall :  0.19641999900341034
auc :  0.5621411800384521

y_eval {0: 88734, 3: 11266}
pred {0: 19642, 1: 80358}
[INFO] confusion matrix for file 
[[19642 69092     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0 11266     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1023514 3961354       0       0       0]
 [  48596  342771       0       0       0]
 [  27826   81871       0       0       0]
 [      0   11266       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-0.3460574   0.          0.         ...  3.          0.00482
   1.45442   ]
 [-0.3460574   0.          0.         ...  3.          0.00482
   1.45442   ]
 [-0.3460574   0.          0.         ...  4.          0.00482
  -0.23351   ]
 ...
 [ 0.34633645  0.          0.         ...  3.          0.00482
   1.45442   ]
 [ 0.34633645  0.          0.         ...  2.          0.00482
  -0.33484   ]
 [ 0.34633645  0.          0.         ...  1.          0.00482
  -0.32151   ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.3552785e-10 1.0000000e+00 9.8919177e-14 3.3556220e-13 8.6592409e-14]
  [2.4124013e-08 1.0000000e+00 6.4291649e-13 1.9285758e-12 7.0697620e-13]
  [4.0724158e-14 1.0000000e+00 8.7340749e-16 5.3919238e-15 9.3194249e-16]
  ...
  [6.0205716e-01 3.9794287e-01 1.8906048e-09 2.0842876e-09 1.9157131e-09]
  [7.2987014e-01 2.7012983e-01 1.7079211e-09 1.8206441e-09 1.7123833e-09]
  [7.5487703e-01 2.4512294e-01 1.6536109e-09 1.7496053e-09 1.6541567e-09]]

 [[5.5866242e-11 1.0000000e+00 2.9550445e-14 1.1269142e-13 2.5113698e-14]
  [9.0919789e-17 1.0000000e+00 4.2735505e-17 3.5739166e-16 4.4376572e-17]
  [1.9451005e-04 9.9980551e-01 5.9110036e-11 1.1030366e-10 7.4773271e-11]
  ...
  [1.7853174e-10 1.0000000e+00 5.3565415e-14 2.0724396e-13 5.2458678e-14]
  [1.9307665e-15 1.0000000e+00 1.9815424e-16 1.4601735e-15 2.3106561e-16]
  [2.7658293e-04 9.9972337e-01 7.0553549e-11 1.2951686e-10 8.7635656e-11]]

 [[5.5172113e-11 1.0000000e+00 2.9367666e-14 1.1206147e-13 2.4955171e-14]
  [9.1388178e-17 1.0000000e+00 4.2844217e-17 3.5820377e-16 4.4488268e-17]
  [1.9180641e-04 9.9980825e-01 5.8701564e-11 1.0962797e-10 7.4268737e-11]
  ...
  [7.0975906e-01 2.9024100e-01 1.7505717e-09 1.8785944e-09 1.7663454e-09]
  [1.2192518e-01 8.7807482e-01 1.2606365e-09 1.5843652e-09 1.2887925e-09]
  [5.4752968e-07 9.9999940e-01 2.8871814e-12 7.1940080e-12 2.9594400e-12]]

 ...

 [[5.2981365e-01 4.7018635e-01 1.9220734e-09 2.1498299e-09 1.9640469e-09]
  [1.5964108e-08 1.0000000e+00 4.9679504e-13 1.4961235e-12 4.9948294e-13]
  [2.5278207e-05 9.9997473e-01 2.0834150e-11 4.3067015e-11 2.4737299e-11]
  ...
  [3.2208881e-18 1.0000000e+00 8.2973064e-18 8.4811252e-17 9.2991735e-18]
  [1.5076098e-07 9.9999988e-01 1.7491421e-12 4.9404456e-12 2.4829804e-12]
  [1.6222423e-01 8.3777571e-01 1.4532305e-09 1.8091230e-09 1.5436163e-09]]

 [[6.8920612e-02 9.3107939e-01 9.7509045e-10 1.2630985e-09 9.9969066e-10]
  [4.0596709e-01 5.9403294e-01 1.9047910e-09 2.1983217e-09 1.9758584e-09]
  [3.1299980e-09 1.0000000e+00 2.2008637e-13 7.2573772e-13 2.1811639e-13]
  ...
  [1.7225723e-09 1.0000000e+00 1.8227088e-13 6.4867122e-13 2.3023361e-13]
  [6.4660497e-07 9.9999940e-01 3.3305878e-12 8.4120749e-12 3.8350044e-12]
  [2.7014193e-01 7.2985810e-01 1.7427543e-09 2.0895630e-09 1.8307506e-09]]

 [[2.5895329e-02 9.7410470e-01 6.1534833e-10 8.4676671e-10 6.5642441e-10]
  [3.9140576e-11 1.0000000e+00 2.5534008e-14 1.0692980e-13 2.5738201e-14]
  [3.3941200e-14 1.0000000e+00 8.1849281e-16 5.1560513e-15 9.4645238e-16]
  ...
  [1.3517350e-05 9.9998653e-01 1.4761125e-11 3.1243581e-11 1.6145116e-11]
  [4.9481636e-01 5.0518364e-01 1.9458737e-09 2.2034206e-09 1.9997810e-09]
  [7.3524290e-01 2.6475710e-01 1.6973967e-09 1.8068486e-09 1.7022729e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.3552785e-10 1.0000000e+00 9.8919177e-14 3.3556220e-13 8.6592409e-14]
 [2.4124013e-08 1.0000000e+00 6.4291649e-13 1.9285758e-12 7.0697620e-13]
 [4.0724158e-14 1.0000000e+00 8.7340749e-16 5.3919238e-15 9.3194249e-16]
 ...
 [1.3517350e-05 9.9998653e-01 1.4761125e-11 3.1243581e-11 1.6145116e-11]
 [4.9481636e-01 5.0518364e-01 1.9458737e-09 2.2034206e-09 1.9997810e-09]
 [7.3524290e-01 2.6475710e-01 1.6973967e-09 1.8068486e-09 1.7022729e-09]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  8.421109017944335
tp :  19222.0
fp :  80778.0
tn :  319222.0
fn :  80778.0
accuracy :  0.6768911480903625
precision :  0.19222000241279602
recall :  0.19222000241279602
auc :  0.5598313212394714

y_eval {0: 92435, 3: 7565}
pred {0: 19222, 1: 80778}
[INFO] confusion matrix for file 
[[19222 73213     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0  7565     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1042736 4034567       0       0       0]
 [  48596  342771       0       0       0]
 [  27826   81871       0       0       0]
 [      0   18831       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4633645e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 3.4633645e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4633645e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 1.0387303e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0387303e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0387303e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.31970391e-02 9.36802983e-01 9.36600353e-10 1.21932708e-09
   9.60337698e-10]
  [1.70340664e-09 1.00000000e+00 1.63909386e-13 5.57701509e-13
   1.61815412e-13]
  [9.25805182e-07 9.99999046e-01 4.03467841e-12 1.00137719e-11
   4.82320737e-12]
  ...
  [4.07628065e-09 1.00000000e+00 2.81075212e-13 9.55357213e-13
   3.61629861e-13]
  [8.77777097e-07 9.99999166e-01 3.85502481e-12 9.55211171e-12
   4.35832837e-12]
  [3.06254506e-01 6.93745494e-01 1.80630100e-09 2.14336282e-09
   1.88950988e-09]]

 [[6.04767129e-02 9.39523280e-01 9.17553811e-10 1.19755605e-09
   9.40856726e-10]
  [4.09952772e-05 9.99958992e-01 2.50541012e-11 4.94043417e-11
   2.66384814e-11]
  [2.86241950e-13 1.00000000e+00 2.26055179e-15 1.24607415e-14
   2.31770195e-15]
  ...
  [3.26652416e-09 1.00000000e+00 2.24225234e-13 7.37530696e-13
   2.18336159e-13]
  [7.62073889e-13 1.00000000e+00 3.86170410e-15 2.06703805e-14
   4.68730161e-15]
  [1.53799434e-07 9.99999881e-01 1.67957824e-12 4.64779821e-12
   2.06366391e-12]]

 [[6.14367455e-05 9.99938607e-01 3.02981980e-11 5.74500517e-11
   3.08661499e-11]
  [5.05077750e-13 1.00000000e+00 2.99300871e-15 1.58989711e-14
   3.02971064e-15]
  [2.10936330e-02 9.78906393e-01 5.84634952e-10 8.30143287e-10
   6.65299427e-10]
  ...
  [7.98050128e-03 9.92019475e-01 3.55460744e-10 5.29605693e-10
   3.92154031e-10]
  [7.44321823e-01 2.55678207e-01 1.68152769e-09 1.78657278e-09
   1.69181902e-09]
  [7.24509656e-01 2.75490403e-01 1.71783054e-09 1.83367843e-09
   1.72045378e-09]]

 ...

 [[3.28989336e-11 1.00000000e+00 2.27218994e-14 8.88805427e-14
   1.92109156e-14]
  [1.27423648e-03 9.98725712e-01 1.45456633e-10 2.41696496e-10
   1.70236478e-10]
  [8.06245208e-01 1.93754777e-01 1.51995438e-09 1.58180535e-09
   1.51870250e-09]
  ...
  [7.44939328e-08 9.99999881e-01 1.08914548e-12 3.04876328e-12
   1.13835775e-12]
  [5.23572664e-16 1.00000000e+00 1.01679781e-16 7.94155169e-16
   1.09491707e-16]
  [5.50678413e-14 1.00000000e+00 1.06472592e-15 6.63744377e-15
   1.34124491e-15]]

 [[5.13105697e-05 9.99948740e-01 2.76502102e-11 5.28489370e-11
   2.78593155e-11]
  [7.99597353e-02 9.20040250e-01 1.07071851e-09 1.39369694e-09
   1.15829490e-09]
  [8.29598188e-01 1.70401812e-01 1.44350709e-09 1.48834067e-09
   1.43642387e-09]
  ...
  [5.30850521e-05 9.99946952e-01 2.88066203e-11 5.62772641e-11
   3.07089701e-11]
  [5.59353521e-14 1.00000000e+00 1.00851999e-15 6.08438166e-15
   1.03578545e-15]
  [3.67556000e-03 9.96324360e-01 2.51009352e-10 3.95737609e-10
   2.97728675e-10]]

 [[5.32458313e-02 9.46754158e-01 8.68982053e-10 1.14750054e-09
   9.21316523e-10]
  [5.29470205e-01 4.70529765e-01 1.93172500e-09 2.16610485e-09
   1.97639549e-09]
  [3.52945700e-02 9.64705467e-01 7.12913784e-10 9.66080216e-10
   7.47031714e-10]
  ...
  [1.91144431e-12 1.00000000e+00 5.74503950e-15 2.85926407e-14
   5.78649923e-15]
  [8.21137727e-18 1.00000000e+00 1.31577825e-17 1.28082539e-16
   1.45750647e-17]
  [3.70751173e-13 1.00000000e+00 2.75590089e-15 1.55303169e-14
   3.48456924e-15]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.31970391e-02 9.36802983e-01 9.36600353e-10 1.21932708e-09
  9.60337698e-10]
 [1.70340664e-09 1.00000000e+00 1.63909386e-13 5.57701509e-13
  1.61815412e-13]
 [9.25805182e-07 9.99999046e-01 4.03467841e-12 1.00137719e-11
  4.82320737e-12]
 ...
 [1.91144431e-12 1.00000000e+00 5.74503950e-15 2.85926407e-14
  5.78649923e-15]
 [8.21137727e-18 1.00000000e+00 1.31577825e-17 1.28082539e-16
  1.45750647e-17]
 [3.70751173e-13 1.00000000e+00 2.75590089e-15 1.55303169e-14
  3.48456924e-15]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.251574839782714
tp :  19914.0
fp :  80086.0
tn :  319914.0
fn :  80086.0
accuracy :  0.6796591281890869
precision :  0.19913999736309052
recall :  0.19913999736309052
auc :  0.5574817061424255

y_eval {0: 100000}
pred {0: 19914, 1: 80086}
[INFO] confusion matrix for file 
[[19914 80086     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1062650 4114653       0       0       0]
 [  48596  342771       0       0       0]
 [  27826   81871       0       0       0]
 [      0   18831       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0387303  0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 1.0387303  0.         0.        ...  2.         0.00482   -0.33484  ]
 [ 1.0387303  0.         0.        ...  1.         0.00482   -0.32151  ]
 ...
 [ 1.7311242  0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 1.7311242  0.         0.        ...  3.         0.00482    1.45442  ]
 [ 1.7311242  0.         0.        ...  3.         0.00482    1.45442  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[4.66917118e-05 9.99953270e-01 2.63770394e-11 5.06647606e-11
   2.65508292e-11]
  [7.73924142e-02 9.22607541e-01 1.05515041e-09 1.37625955e-09
   1.14223520e-09]
  [8.21035326e-01 1.78964719e-01 1.47204882e-09 1.52290158e-09
   1.46605539e-09]
  ...
  [1.87233626e-03 9.98127639e-01 1.66089420e-10 2.64213096e-10
   1.71157172e-10]
  [1.56693603e-10 1.00000000e+00 5.04954185e-14 1.96905209e-13
   5.00903267e-14]
  [2.63999909e-01 7.36000061e-01 1.74568393e-09 2.10178053e-09
   1.85702731e-09]]

 [[1.77823901e-13 1.00000000e+00 1.71411114e-15 8.58035312e-15
   1.40473342e-15]
  [2.01032071e-06 9.99997973e-01 5.81133839e-12 1.37022347e-11
   6.35344121e-12]
  [1.01835165e-10 1.00000000e+00 4.17693359e-14 1.68077940e-13
   4.42701160e-14]
  ...
  [6.78101599e-01 3.21898431e-01 1.80439697e-09 1.95326355e-09
   1.82638060e-09]
  [1.22740058e-08 1.00000000e+00 4.30724141e-13 1.31563098e-12
   4.20735197e-13]
  [4.33773220e-01 5.66226780e-01 1.94455629e-09 2.23774355e-09
   2.02645856e-09]]

 [[5.73134552e-12 1.00000000e+00 9.55460110e-15 4.06092057e-14
   7.96026995e-15]
  [2.67348532e-02 9.73265111e-01 6.48628207e-10 9.05778175e-10
   7.27444105e-10]
  [3.41404016e-10 1.00000000e+00 7.39306348e-14 2.76346762e-13
   7.47065712e-14]
  ...
  [7.47389853e-01 2.52610117e-01 1.67483982e-09 1.77751003e-09
   1.68255321e-09]
  [3.91646754e-04 9.99608338e-01 7.61928784e-11 1.32240385e-10
   7.91265733e-11]
  [7.60027349e-01 2.39972651e-01 1.64697855e-09 1.74171733e-09
   1.65467395e-09]]

 ...

 [[1.51554970e-13 1.00000000e+00 1.58404838e-15 7.99060220e-15
   1.29827429e-15]
  [3.63140609e-14 1.00000000e+00 8.29392904e-16 5.06315723e-15
   8.44912771e-16]
  [1.84916322e-14 1.00000000e+00 6.03242571e-16 3.90082093e-15
   6.75852194e-16]
  ...
  [8.29676270e-01 1.70323730e-01 1.44255863e-09 1.48699675e-09
   1.43389822e-09]
  [3.44067328e-02 9.65593278e-01 7.01896208e-10 9.50923451e-10
   7.25978833e-10]
  [7.28282273e-01 2.71717727e-01 1.71432823e-09 1.82948268e-09
   1.72401782e-09]]

 [[3.69670339e-08 1.00000000e+00 7.48499570e-13 2.07957197e-12
   6.97010592e-13]
  [5.79250032e-17 1.00000000e+00 3.41361127e-17 2.93058603e-16
   3.57199286e-17]
  [3.13233928e-09 1.00000000e+00 2.46405598e-13 8.46415765e-13
   3.23437241e-13]
  ...
  [5.34384162e-04 9.99465644e-01 8.90533827e-11 1.51946747e-10
   9.27159183e-11]
  [7.60744393e-01 2.39255652e-01 1.64480729e-09 1.73855885e-09
   1.65077896e-09]
  [7.18996078e-02 9.28100467e-01 9.96537852e-10 1.29461630e-09
   1.03109554e-09]]

 [[2.33358680e-11 1.00000000e+00 1.91650589e-14 7.61605609e-14
   1.61445699e-14]
  [3.99955036e-03 9.96000469e-01 2.56535099e-10 4.00024985e-10
   2.98420899e-10]
  [1.16557297e-09 1.00000000e+00 1.36990340e-13 4.80120880e-13
   1.40986710e-13]
  ...
  [8.23275387e-01 1.76724643e-01 1.46451684e-09 1.51372004e-09
   1.45810630e-09]
  [2.34125126e-02 9.76587474e-01 5.82320747e-10 8.06393230e-10
   6.03664618e-10]
  [8.88103712e-03 9.91118968e-01 3.65979719e-10 5.37525080e-10
   3.88578558e-10]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[4.6691712e-05 9.9995327e-01 2.6377039e-11 5.0664761e-11 2.6550829e-11]
 [7.7392414e-02 9.2260754e-01 1.0551504e-09 1.3762596e-09 1.1422352e-09]
 [8.2103533e-01 1.7896472e-01 1.4720488e-09 1.5229016e-09 1.4660554e-09]
 ...
 [8.2327539e-01 1.7672464e-01 1.4645168e-09 1.5137200e-09 1.4581063e-09]
 [2.3412513e-02 9.7658747e-01 5.8232075e-10 8.0639323e-10 6.0366462e-10]
 [8.8810371e-03 9.9111897e-01 3.6597972e-10 5.3752508e-10 3.8857856e-10]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 0 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.925643321228028
tp :  20632.0
fp :  79368.0
tn :  320632.0
fn :  79368.0
accuracy :  0.6825311183929443
precision :  0.20632000267505646
recall :  0.20632000267505646
auc :  0.5455809235572815

y_eval {0: 83000, 3: 17000}
pred {0: 20632, 1: 79368}
[INFO] confusion matrix for file 
[[20632 62368     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0 17000     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1083282 4177021       0       0       0]
 [  48596  342771       0       0       0]
 [  27826   81871       0       0       0]
 [      0   35831       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-02_121729_121.log.part14_sorted-labeled.csv
[INFO] process dataset, shape: (439824, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (439824, 17)

[INFO] analyzing data
[INFO] 439824 rows
[INFO] ** unixtime:1201 (0.27306%)
[INFO] ** orig:[0:99.99955%,2:0.00045%]
[INFO] ** type:[0:99.99977%,1:0.00023%]
[INFO] ** i/f_name:[2:99.99864%,3:0.00136%]
[INFO] ** i/f_dir:[1:99.99886%,0:0.00114%]
[INFO] ** src:[22:38.09456%,9:26.09703%,7:18.22161%,1:17.58408%,14:0.00091%,21:0.00068%,15:0.00068%,4:0.00023%,3:0.00023%]
[INFO] ** dst:[21:43.35416%,10:20.83674%,8:18.22115%,9:17.58385%,22:0.00159%,15:0.00136%,24:0.00045%,25:0.00023%,6:0.00023%,2:0.00023%]
[INFO] ** proto:[0:99.99818%,1:0.00136%,2:0.00045%]
[INFO] ** appi_name:[21:99.99795%,30:0.00136%,26:0.00023%,8:0.00023%,0:0.00023%]
[INFO] ** proxy_src_ip:[18:38.09456%,20:26.09703%,13:18.22161%,6:17.58408%,17:0.00136%,16:0.00068%,21:0.00023%,7:0.00023%,1:0.00023%]
[INFO] ** modbus_function_code:[0.02961:99.99795%,-33.760870000000004:0.00205%]
[INFO] ** modbus_function_description:[7:49.99955%,11:49.99841%,0:0.00205%]
[INFO] ** modbus_transaction_id:65536 (14.90051%)
[INFO] ** scada_tag:[3:26.09612%,1:20.83652%,5:18.22092%,4:17.5834%,2:17.25758%,0:0.00546%]
[INFO] ** service:[0.0048200000000000005:99.99795%,-211.73542999999998:0.00136%,-186.44547:0.00023%,-211.08346:0.00023%,-211.35747999999998:0.00023%]
[INFO] ** s_port:[1.45442:26.09635%,-0.32151:20.83674%,-1.27613:18.22115%,-0.23351:17.58362%,-0.33484:17.25781%,-71.33197:0.00136%,-1.02014:0.00068%,-1.27347:0.00045%,1.45709:0.00045%,-0.24151:0.00045%,-71.14798:0.00023%,1.47576:0.00023%,-64.19493:0.00023%,-1.2708:0.00023%]
[INFO] ** classification:[normal:93.34597%,Single Stage Single Point:4.48861%,Multi Stage Single Point:2.16541%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/439824 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.732219e+00  0.000000e+00  0.000000e+00 ...  5.000000e+00
   4.820000e-03 -1.276130e+00]
 [-1.732219e+00  0.000000e+00  0.000000e+00 ...  1.000000e+00
   4.820000e-03 -3.215100e-01]
 [-1.732219e+00  0.000000e+00  0.000000e+00 ...  2.000000e+00
   4.820000e-03 -3.348400e-01]
 ...
 [-9.465184e-01  0.000000e+00  0.000000e+00 ...  5.000000e+00
   4.820000e-03 -1.276130e+00]
 [-9.465184e-01  0.000000e+00  0.000000e+00 ...  2.000000e+00
   4.820000e-03 -3.348400e-01]
 [-9.465184e-01  0.000000e+00  0.000000e+00 ...  3.000000e+00
   4.820000e-03  1.454420e+00]] shape (100000, 16)
y_test [[0. 0. 0. 1. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [3 0 0 ... 1 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[7.34342925e-13 1.00000000e+00 3.45528964e-15 1.61834471e-14
   2.84511845e-15]
  [4.33654711e-03 9.95663464e-01 2.67319417e-10 4.15454726e-10
   3.11455722e-10]
  [7.38058984e-01 2.61941016e-01 1.69492587e-09 1.80424609e-09
   1.70782510e-09]
  ...
  [1.74314092e-08 1.00000000e+00 5.12604119e-13 1.53630776e-12
   5.05234797e-13]
  [6.08139411e-02 9.39186037e-01 9.57279922e-10 1.27258537e-09
   1.04830467e-09]
  [2.02041628e-09 1.00000000e+00 1.77529744e-13 6.00321117e-13
   1.71873217e-13]]

 [[7.33539423e-13 1.00000000e+00 3.45341855e-15 1.61755476e-14
   2.84357770e-15]
  [1.06574059e-03 9.98934209e-01 1.33239780e-10 2.23969079e-10
   1.56335944e-10]
  [4.12973628e-10 1.00000000e+00 8.19713763e-14 3.04383499e-13
   8.42000149e-14]
  ...
  [2.32268214e-01 7.67731786e-01 1.67229874e-09 2.03319606e-09
   1.78047532e-09]
  [6.87357008e-01 3.12643021e-01 1.78623005e-09 1.92757721e-09
   1.80090576e-09]
  [4.64117944e-09 1.00000000e+00 2.65726108e-13 8.55537538e-13
   2.58869478e-13]]

 [[7.32739553e-13 1.00000000e+00 3.45156164e-15 1.61676499e-14
   2.84202699e-15]
  [1.06005347e-03 9.98939931e-01 1.32885480e-10 2.23440003e-10
   1.55921415e-10]
  [5.48659801e-01 4.51340228e-01 1.92758254e-09 2.15398210e-09
   1.97564765e-09]
  ...
  [2.42328930e-08 1.00000000e+00 6.03284892e-13 1.77537629e-12
   5.94923850e-13]
  [1.46728575e-01 8.53271425e-01 1.40677348e-09 1.76719062e-09
   1.51285606e-09]
  [6.87910497e-01 3.12089562e-01 1.78598469e-09 1.92732341e-09
   1.80205340e-09]]

 ...

 [[1.54395849e-02 9.84560370e-01 4.78135864e-10 6.77392642e-10
   5.12427045e-10]
  [4.08746228e-02 9.59125340e-01 7.74991349e-10 1.04599240e-09
   8.28487279e-10]
  [6.86553895e-01 3.13446075e-01 1.78932980e-09 1.93184690e-09
   1.80690651e-09]
  ...
  [5.30869429e-15 1.00000000e+00 3.18600326e-16 2.18661852e-15
   3.36371659e-16]
  [5.11869323e-04 9.99488115e-01 9.51916046e-11 1.68303246e-10
   1.16844048e-10]
  [7.34211997e-11 1.00000000e+00 3.47635908e-14 1.41707609e-13
   3.46641424e-14]]

 [[1.96199734e-02 9.80380058e-01 5.36503120e-10 7.48792306e-10
   5.67934866e-10]
  [2.84407973e-01 7.15591967e-01 1.75647186e-09 2.09177831e-09
   1.83688065e-09]
  [6.08390033e-01 3.91610026e-01 1.88115545e-09 2.06951190e-09
   1.90291982e-09]
  ...
  [4.02001244e-15 1.00000000e+00 2.78192540e-16 1.93990620e-15
   2.95289503e-16]
  [4.81895899e-04 9.99518156e-01 9.24269758e-11 1.64013567e-10
   1.13656987e-10]
  [6.28622016e-11 1.00000000e+00 3.21961696e-14 1.32373794e-13
   3.21233586e-14]]

 [[3.58857433e-09 1.00000000e+00 2.34035095e-13 7.29280297e-13
   2.09618510e-13]
  [5.35273683e-16 1.00000000e+00 1.02410439e-16 7.84190726e-16
   1.06248173e-16]
  [3.63294617e-03 9.96367097e-01 2.49746918e-10 3.94036498e-10
   2.98693625e-10]
  ...
  [4.10591049e-12 1.00000000e+00 8.68706149e-15 4.19616192e-14
   9.45741847e-15]
  [5.64522296e-02 9.43547785e-01 9.29340493e-10 1.24414312e-09
   1.02948117e-09]
  [3.68594587e-01 6.31405473e-01 1.86507121e-09 2.16835394e-09
   1.90252392e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[7.3434293e-13 1.0000000e+00 3.4552896e-15 1.6183447e-14 2.8451184e-15]
 [4.3365471e-03 9.9566346e-01 2.6731942e-10 4.1545473e-10 3.1145572e-10]
 [7.3805898e-01 2.6194102e-01 1.6949259e-09 1.8042461e-09 1.7078251e-09]
 ...
 [4.1059105e-12 1.0000000e+00 8.6870615e-15 4.1961619e-14 9.4574185e-15]
 [5.6452230e-02 9.4354779e-01 9.2934049e-10 1.2441431e-09 1.0294812e-09]
 [3.6859459e-01 6.3140547e-01 1.8650712e-09 2.1683539e-09 1.9025239e-09]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  7.818171734619141
tp :  25009.0
fp :  74991.0
tn :  325009.0
fn :  74991.0
accuracy :  0.7000389695167542
precision :  0.25009000301361084
recall :  0.25009000301361084
auc :  0.5917088985443115

y_eval {0: 86777, 1: 3699, 3: 9524}
pred {0: 21310, 1: 78690}
[INFO] confusion matrix for file 
[[21310 65467     0     0     0]
 [    0  3699     0     0     0]
 [    0     0     0     0     0]
 [    0  9524     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1104592 4242488       0       0       0]
 [  48596  346470       0       0       0]
 [  27826   81871       0       0       0]
 [      0   45355       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 100000-200000/439824 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-0.9465184  0.         0.        ...  4.         0.00482   -0.23351  ]
 [-0.9436298  0.         0.        ...  1.         0.00482   -0.32151  ]
 [-0.9436298  0.         0.        ...  2.         0.00482   -0.33484  ]
 ...
 [-0.1579293  0.         0.        ...  2.         0.00482   -0.33484  ]
 [-0.1579293  0.         0.        ...  3.         0.00482    1.45442  ]
 [-0.1579293  0.         0.        ...  2.         0.00482   -0.33484  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[8.1845616e-14 1.0000000e+00 1.1683293e-15 6.0639910e-15 9.5586429e-16]
  [6.4129747e-02 9.3587023e-01 9.8182529e-10 1.3036255e-09 1.0883893e-09]
  [7.3050356e-01 2.6949647e-01 1.7090381e-09 1.8227140e-09 1.7222976e-09]
  ...
  [8.4294125e-02 9.1570592e-01 1.1049223e-09 1.4372006e-09 1.1930799e-09]
  [1.1654713e-08 1.0000000e+00 4.2293008e-13 1.2985685e-12 4.1057048e-13]
  [6.4385739e-14 1.0000000e+00 1.1116850e-15 6.7376490e-15 1.2341429e-15]]

 [[8.1878718e-14 1.0000000e+00 1.1685656e-15 6.0650782e-15 9.5605392e-16]
  [2.4443620e-03 9.9755561e-01 2.0067270e-10 3.2173700e-10 2.3088167e-10]
  [6.4802325e-01 3.5197669e-01 1.8458162e-09 2.0136597e-09 1.8763147e-09]
  ...
  [4.6529884e-08 1.0000000e+00 8.3325035e-13 2.3650778e-12 8.2113038e-13]
  [1.8954132e-11 1.0000000e+00 1.8357565e-14 8.1174000e-14 1.9098316e-14]
  [2.7361028e-15 1.0000000e+00 2.3281217e-16 1.6772614e-15 2.5633382e-16]]

 [[6.9243150e-08 9.9999988e-01 1.0235108e-12 2.7554736e-12 9.6217262e-13]
  [7.4040229e-03 9.9259597e-01 3.4502914e-10 5.1760540e-10 3.8988721e-10]
  [8.3215633e-07 9.9999917e-01 3.5837912e-12 8.7643399e-12 3.7734091e-12]
  ...
  [3.3998790e-01 6.6001213e-01 1.8655057e-09 2.1978346e-09 1.9613191e-09]
  [7.4847710e-01 2.5152287e-01 1.6696924e-09 1.7709216e-09 1.6756807e-09]
  [6.2532419e-01 3.7467584e-01 1.8620353e-09 2.0384876e-09 1.8699864e-09]]

 ...

 [[3.5733685e-10 1.0000000e+00 7.4274937e-14 2.5897023e-13 6.4435002e-14]
  [5.3422692e-17 1.0000000e+00 3.2842283e-17 2.8248398e-16 3.4206373e-17]
  [6.2282913e-04 9.9937719e-01 1.0517771e-10 1.8383650e-10 1.3099268e-10]
  ...
  [4.5649842e-12 1.0000000e+00 9.1511415e-15 4.3889510e-14 9.9533461e-15]
  [6.1867978e-02 9.3813205e-01 9.6916142e-10 1.2899860e-09 1.0719172e-09]
  [1.8048283e-01 8.1951714e-01 1.4885848e-09 1.8272228e-09 1.5294999e-09]]

 [[7.5898665e-14 1.0000000e+00 1.1256993e-15 5.8650806e-15 9.2144352e-16]
  [4.0380355e-10 1.0000000e+00 8.3766076e-14 3.1148052e-13 8.4485885e-14]
  [2.7288222e-03 9.9727112e-01 2.1165829e-10 3.3622669e-10 2.4218053e-10]
  ...
  [7.4782258e-01 2.5217739e-01 1.6716435e-09 1.7732754e-09 1.6772838e-09]
  [7.8736132e-01 2.1263869e-01 1.5720544e-09 1.6460978e-09 1.5691275e-09]
  [7.2148573e-01 2.7851430e-01 1.7233676e-09 1.8409509e-09 1.7250712e-09]]

 [[1.2404560e-11 1.0000000e+00 1.4008064e-14 5.7412307e-14 1.1745055e-14]
  [1.3651248e-03 9.9863487e-01 1.5053817e-10 2.4924340e-10 1.7612253e-10]
  [5.4739767e-01 4.5260233e-01 1.9272355e-09 2.1539595e-09 1.9745345e-09]
  ...
  [8.3279585e-05 9.9991667e-01 3.9283302e-11 7.7436106e-11 5.0522215e-11]
  [8.5302673e-02 9.1469735e-01 1.0930439e-09 1.4129885e-09 1.1518670e-09]
  [7.2827083e-01 2.7172920e-01 1.7132031e-09 1.8278147e-09 1.7205285e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[8.1845616e-14 1.0000000e+00 1.1683293e-15 6.0639910e-15 9.5586429e-16]
 [6.4129747e-02 9.3587023e-01 9.8182529e-10 1.3036255e-09 1.0883893e-09]
 [7.3050356e-01 2.6949647e-01 1.7090381e-09 1.8227140e-09 1.7222976e-09]
 ...
 [8.3279585e-05 9.9991667e-01 3.9283302e-11 7.7436106e-11 5.0522215e-11]
 [8.5302673e-02 9.1469735e-01 1.0930439e-09 1.4129885e-09 1.1518670e-09]
 [7.2827083e-01 2.7172920e-01 1.7132031e-09 1.8278147e-09 1.7205285e-09]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 1 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  5.90057513961792
tp :  35656.0
fp :  64344.0
tn :  335656.0
fn :  64344.0
accuracy :  0.7426266670227051
precision :  0.35655999183654785
recall :  0.35655999183654785
auc :  0.6798645853996277

y_eval {0: 83957, 1: 16043}
pred {0: 19613, 1: 80387}
[INFO] confusion matrix for file 
[[19613 64344     0     0     0]
 [    0 16043     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1124205 4306832       0       0       0]
 [  48596  362513       0       0       0]
 [  27826   81871       0       0       0]
 [      0   45355       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 200000-300000/439824 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.579293e-01  0.000000e+00  0.000000e+00 ...  3.000000e+00
   4.820000e-03  1.454420e+00]
 [-1.579293e-01  0.000000e+00  0.000000e+00 ...  4.000000e+00
   4.820000e-03 -2.335100e-01]
 [-1.579293e-01  0.000000e+00  0.000000e+00 ...  5.000000e+00
   4.820000e-03 -1.276130e+00]
 ...
 [ 6.306598e-01  0.000000e+00  0.000000e+00 ...  5.000000e+00
   4.820000e-03 -1.276130e+00]
 [ 6.306598e-01  0.000000e+00  0.000000e+00 ...  4.000000e+00
   4.820000e-03 -2.335100e-01]
 [ 6.306598e-01  0.000000e+00  0.000000e+00 ...  3.000000e+00
   4.820000e-03  1.454420e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[3.34847261e-10 1.00000000e+00 7.19137071e-14 2.51530676e-13
   6.23380606e-14]
  [5.41343455e-17 1.00000000e+00 3.30583526e-17 2.84142920e-16
   3.44285276e-17]
  [7.22947914e-18 1.00000000e+00 1.24263555e-17 1.20393107e-16
   1.40247778e-17]
  ...
  [3.20392446e-09 1.00000000e+00 2.26581191e-13 7.52055699e-13
   2.30166878e-13]
  [2.59416818e-04 9.99740541e-01 6.64282657e-11 1.20845542e-10
   7.84539725e-11]
  [4.22976851e-01 5.77023149e-01 1.92138327e-09 2.21124963e-09
   1.98395567e-09]]

 [[3.74326929e-02 9.62567329e-01 7.35329020e-10 9.91185800e-10
   7.83424325e-10]
  [4.87465858e-01 5.12534142e-01 1.93771976e-09 2.19498730e-09
   1.99295158e-09]
  [4.97667352e-10 1.00000000e+00 8.83547047e-14 3.21732875e-13
   8.66109078e-14]
  ...
  [3.24153603e-04 9.99675870e-01 7.49606141e-11 1.35248743e-10
   8.98692232e-11]
  [4.55963798e-02 9.54403579e-01 8.17099499e-10 1.09662268e-09
   8.67830918e-10]
  [4.14275050e-01 5.85724950e-01 1.90593452e-09 2.19328622e-09
   1.95042937e-09]]

 [[7.58578516e-14 1.00000000e+00 1.12539868e-15 5.86367155e-15
   9.21200952e-16]
  [1.84629057e-02 9.81537163e-01 5.43142531e-10 7.76536224e-10
   6.14254425e-10]
  [7.13299155e-01 2.86700785e-01 1.74350911e-09 1.86892546e-09
   1.76072312e-09]
  ...
  [1.43272713e-10 1.00000000e+00 5.01198543e-14 1.98623751e-13
   5.27778267e-14]
  [3.19596849e-11 1.00000000e+00 2.42198348e-14 1.05362401e-13
   2.71183070e-14]
  [1.50251377e-03 9.98497486e-01 1.58957181e-10 2.62425248e-10
   1.84496987e-10]]

 ...

 [[6.27844478e-04 9.99372184e-01 9.67434396e-11 1.62204000e-10
   1.00134380e-10]
  [6.69738787e-16 1.00000000e+00 1.13119146e-16 8.51594749e-16
   1.16181765e-16]
  [2.04842514e-03 9.97951567e-01 1.89313412e-10 3.08775921e-10
   2.30569230e-10]
  ...
  [7.84654990e-02 9.21534538e-01 1.03623088e-09 1.33816158e-09
   1.06506792e-09]
  [7.93372154e-01 2.06627786e-01 1.55671842e-09 1.62702984e-09
   1.55490532e-09]
  [9.79108154e-05 9.99902129e-01 3.80533625e-11 7.11998377e-11
   3.92123625e-11]]

 [[9.60803032e-02 9.03919697e-01 1.13858589e-09 1.45084500e-09
   1.19517984e-09]
  [1.20332073e-02 9.87966835e-01 4.25617291e-10 6.14848950e-10
   4.56543192e-10]
  [1.94774948e-05 9.99980569e-01 1.73356208e-11 3.56867244e-11
   1.84827327e-11]
  ...
  [6.23834074e-01 3.76165986e-01 1.87500127e-09 2.05839079e-09
   1.90712379e-09]
  [1.63879633e-01 8.36120307e-01 1.42775336e-09 1.76147041e-09
   1.46362866e-09]
  [7.34429955e-01 2.65570045e-01 1.70035175e-09 1.81081272e-09
   1.70724124e-09]]

 [[7.33866232e-11 1.00000000e+00 3.38327422e-14 1.27301652e-13
   2.88137637e-14]
  [3.03613185e-03 9.96963918e-01 2.23791818e-10 3.54278079e-10
   2.60681754e-10]
  [3.23989298e-05 9.99967575e-01 2.23714970e-11 4.48755755e-11
   2.43102153e-11]
  ...
  [1.16203346e-05 9.99988437e-01 1.33030731e-11 2.80956473e-11
   1.39901406e-11]
  [3.17507454e-14 1.00000000e+00 7.67086431e-16 4.78595342e-15
   8.03556281e-16]
  [4.60363037e-09 1.00000000e+00 3.00338530e-13 1.01622595e-12
   4.02368297e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[3.34847261e-10 1.00000000e+00 7.19137071e-14 2.51530676e-13
  6.23380606e-14]
 [5.41343455e-17 1.00000000e+00 3.30583526e-17 2.84142920e-16
  3.44285276e-17]
 [7.22947914e-18 1.00000000e+00 1.24263555e-17 1.20393107e-16
  1.40247778e-17]
 ...
 [1.16203346e-05 9.99988437e-01 1.33030731e-11 2.80956473e-11
  1.39901406e-11]
 [3.17507454e-14 1.00000000e+00 7.67086431e-16 4.78595342e-15
  8.03556281e-16]
 [4.60363037e-09 1.00000000e+00 3.00338530e-13 1.01622595e-12
  4.02368297e-13]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.368239315795899
tp :  19052.0
fp :  80948.0
tn :  319052.0
fn :  80948.0
accuracy :  0.6762112379074097
precision :  0.1905200034379959
recall :  0.1905200034379959
auc :  0.557410717010498

y_eval {0: 100000}
pred {0: 19052, 1: 80948}
[INFO] confusion matrix for file 
[[19052 80948     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1143257 4387780       0       0       0]
 [  48596  362513       0       0       0]
 [  27826   81871       0       0       0]
 [      0   45355       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 300000-400000/439824 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 6.3065982e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 6.3065982e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 6.3065982e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 1.4192489e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.4192489e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.4192489e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.80508775e-10 1.00000000e+00 5.29139009e-14 1.90794673e-13
   4.56061072e-14]
  [1.73921441e-03 9.98260796e-01 1.69869591e-10 2.77438489e-10
   1.98739400e-10]
  [6.53587162e-01 3.46412867e-01 1.83790938e-09 2.00215244e-09
   1.86514382e-09]
  ...
  [3.05862933e-01 6.94137096e-01 1.81858661e-09 2.16271667e-09
   1.92066385e-09]
  [8.15492153e-01 1.84507862e-01 1.48977963e-09 1.54455848e-09
   1.48467372e-09]
  [1.99748725e-01 8.00251245e-01 1.53963409e-09 1.87314031e-09
   1.57038993e-09]]

 [[1.45964038e-13 1.00000000e+00 1.55479737e-15 7.85481519e-15
   1.27349858e-15]
  [6.06534695e-06 9.99993920e-01 1.00817349e-11 2.23967234e-11
   1.11345672e-11]
  [3.11038524e-01 6.88961446e-01 1.80941162e-09 2.14205098e-09
   1.89401672e-09]
  ...
  [1.01267204e-07 9.99999881e-01 1.22960290e-12 3.34709604e-12
   1.20733447e-12]
  [3.95538092e-01 6.04461908e-01 1.91902627e-09 2.22838215e-09
   2.00370964e-09]
  [7.35897745e-04 9.99264061e-01 1.04802972e-10 1.75966811e-10
   1.09302588e-10]]

 [[1.45897793e-13 1.00000000e+00 1.55444744e-15 7.85322701e-15
   1.27321196e-15]
  [2.70379484e-02 9.72962022e-01 6.53818610e-10 9.14546106e-10
   7.39368677e-10]
  [7.93286324e-01 2.06713676e-01 1.55701319e-09 1.62758618e-09
   1.55718549e-09]
  ...
  [1.27823414e-05 9.99987245e-01 1.38274244e-11 2.89724841e-11
   1.42846238e-11]
  [7.68781566e-11 1.00000000e+00 3.59204379e-14 1.46272832e-13
   3.58097544e-14]
  [2.68004782e-14 1.00000000e+00 7.18448158e-16 4.56522129e-15
   7.80094210e-16]]

 ...

 [[1.96293946e-02 9.80370641e-01 5.34839784e-10 7.44430406e-10
   5.55111013e-10]
  [2.21279278e-01 7.78720737e-01 1.61784608e-09 1.96367078e-09
   1.70423242e-09]
  [8.41799378e-01 1.58200592e-01 1.40005540e-09 1.43602041e-09
   1.39028922e-09]
  ...
  [7.86937535e-01 2.13062391e-01 1.57688240e-09 1.65241054e-09
   1.57797475e-09]
  [7.98703184e-07 9.99999166e-01 3.43768785e-12 8.35138729e-12
   3.40083408e-12]
  [2.95275036e-04 9.99704659e-01 6.96420144e-11 1.24973781e-10
   7.88189236e-11]]

 [[2.05655798e-10 1.00000000e+00 5.64484101e-14 2.02193866e-13
   4.86779061e-14]
  [3.37301311e-03 9.96626973e-01 2.35641007e-10 3.70660225e-10
   2.73567974e-10]
  [5.93222005e-09 1.00000000e+00 3.07491337e-13 9.86287224e-13
   3.18696838e-13]
  ...
  [1.20802075e-02 9.87919807e-01 4.20593782e-10 6.04235773e-10
   4.35400688e-10]
  [8.12431931e-01 1.87568054e-01 1.50038726e-09 1.55742053e-09
   1.49571555e-09]
  [3.51508191e-07 9.99999642e-01 2.28365720e-12 5.80370474e-12
   2.26113659e-12]]

 [[2.02700787e-10 1.00000000e+00 5.60438536e-14 2.00885356e-13
   4.83207461e-14]
  [6.16926243e-09 1.00000000e+00 3.26345369e-13 1.05353616e-12
   3.55357074e-13]
  [1.43239082e-14 1.00000000e+00 5.22309897e-16 3.41464350e-15
   5.61865753e-16]
  ...
  [7.47130632e-01 2.52869397e-01 1.67654379e-09 1.78012283e-09
   1.68738712e-09]
  [7.90967345e-01 2.09032640e-01 1.56192437e-09 1.63336467e-09
   1.55780078e-09]
  [1.45350331e-02 9.85464990e-01 4.60680355e-10 6.54899912e-10
   4.75630368e-10]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.8050877e-10 1.0000000e+00 5.2913901e-14 1.9079467e-13 4.5606107e-14]
 [1.7392144e-03 9.9826080e-01 1.6986959e-10 2.7743849e-10 1.9873940e-10]
 [6.5358716e-01 3.4641287e-01 1.8379094e-09 2.0021524e-09 1.8651438e-09]
 ...
 [7.4713063e-01 2.5286940e-01 1.6765438e-09 1.7801228e-09 1.6873871e-09]
 [7.9096735e-01 2.0903264e-01 1.5619244e-09 1.6333647e-09 1.5578008e-09]
 [1.4535033e-02 9.8546499e-01 4.6068035e-10 6.5489991e-10 4.7563037e-10]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 0 0 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.221761640930175
tp :  20121.0
fp :  79879.0
tn :  320121.0
fn :  79879.0
accuracy :  0.6804870963096619
precision :  0.20121000707149506
recall :  0.20121000707149506
auc :  0.5550248622894287

y_eval {0: 100000}
pred {0: 20121, 1: 79879}
[INFO] confusion matrix for file 
[[20121 79879     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1163378 4467659       0       0       0]
 [  48596  362513       0       0       0]
 [  27826   81871       0       0       0]
 [      0   45355       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 400000-500000/439824 for LSTM
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-02_172943_122.log.part03_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1376 (0.2752%)
[INFO] ** orig:[0:99.9976%,2:0.002%,1:0.0004%]
[INFO] ** type:[0:99.9988%,1:0.001%,2:0.0002%]
[INFO] ** i/f_name:[2:99.9944%,3:0.0056%]
[INFO] ** i/f_dir:[1:99.9946%,0:0.0054%]
[INFO] ** src:[22:38.2234%,9:26.124%,7:18.075%,1:17.571%,14:0.0036%,21:0.0022%,2:0.0004%,11:0.0002%,10:0.0002%]
[INFO] ** dst:[21:43.4342%,10:20.913%,8:18.0748%,9:17.5708%,15:0.0056%,22:0.0006%,25:0.0004%,24:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** proto:[0:99.9936%,1:0.0056%,2:0.0008%]
[INFO] ** appi_name:[21:99.9934%,30:0.0056%,0:0.0004%,31:0.0002%,27:0.0002%,15:0.0002%]
[INFO] ** proxy_src_ip:[18:38.2234%,20:26.124%,13:18.075%,6:17.571%,17:0.0056%,14:0.0004%,11:0.0002%,10:0.0002%,7:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9934%,-33.760870000000004:0.0064%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.997%,11:49.9964%,0:0.0064%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1234%,1:20.9128%,5:18.0748%,4:17.5704%,2:17.3102%,0:0.0084%]
[INFO] ** service:[0.0048200000000000005:99.9936%,-211.73542999999998:0.0056%,-186.44547:0.0004%,-186.43601999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:26.1238%,-0.32151:20.913%,-1.27613:18.0748%,-0.23351:17.5706%,-0.33484:17.3104%,-71.33197:0.0056%,-0.24151:0.0004%,-64.19493:0.0004%,-1.27347:0.0002%,-10.59042:0.0002%,11.862:0.0002%,1.47576:0.0002%,13.431270000000001:0.0002%]
[INFO] ** classification:[normal:94.9296%,Single Stage Single Point:5.0704%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7301897e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.7301897e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.7301897e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 ...
 [-1.0376850e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.0376850e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0376850e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.2725200e-02 9.8727477e-01 4.3482437e-10 6.2273003e-10 4.6676812e-10]
  [2.0905939e-01 7.9094064e-01 1.5854632e-09 1.9320709e-09 1.6641996e-09]
  [6.8510443e-01 3.1489560e-01 1.7896882e-09 1.9322557e-09 1.8046229e-09]
  ...
  [4.1931809e-05 9.9995804e-01 2.8116396e-11 5.7682626e-11 3.6877189e-11]
  [3.6778206e-01 6.3221794e-01 1.8781159e-09 2.1901183e-09 1.9414035e-09]
  [6.2417829e-01 3.7582168e-01 1.8655490e-09 2.0438227e-09 1.8784527e-09]]

 [[4.2826194e-08 1.0000000e+00 8.0519911e-13 2.2196839e-12 7.4992996e-13]
  [3.0165380e-03 9.9698347e-01 2.2173677e-10 3.5017816e-10 2.5353483e-10]
  [7.8431696e-01 2.1568301e-01 1.5829066e-09 1.6602426e-09 1.5854056e-09]
  ...
  [4.4214323e-11 1.0000000e+00 2.6752623e-14 1.1154754e-13 2.5909657e-14]
  [3.3469175e-03 9.9665314e-01 2.3770932e-10 3.7559766e-10 2.7858330e-10]
  [6.3673353e-01 3.6326644e-01 1.8591527e-09 2.0340782e-09 1.8877062e-09]]

 [[1.2604375e-02 9.8739558e-01 4.3278492e-10 6.2013450e-10 4.6459220e-10]
  [3.6608154e-01 6.3391846e-01 1.8732942e-09 2.1839501e-09 1.9442616e-09]
  [6.3046008e-01 3.6953989e-01 1.8597228e-09 2.0351019e-09 1.8791555e-09]
  ...
  [4.6367559e-01 5.3632438e-01 1.9295285e-09 2.1965114e-09 1.9765825e-09]
  [2.9882947e-09 1.0000000e+00 2.1469836e-13 7.0933992e-13 2.1117353e-13]
  [4.0738387e-17 1.0000000e+00 2.8956136e-17 2.5863910e-16 3.1738467e-17]]

 ...

 [[1.7605524e-12 1.0000000e+00 5.3255697e-15 2.3938808e-14 4.4045048e-15]
  [1.6205139e-13 1.0000000e+00 1.7322007e-15 9.8016128e-15 1.7579761e-15]
  [1.3208631e-04 9.9986792e-01 4.8008361e-11 9.1025694e-11 5.8477202e-11]
  ...
  [4.7311368e-03 9.9526888e-01 2.8437402e-10 4.4229415e-10 3.3638722e-10]
  [1.8965329e-01 8.1034672e-01 1.5227674e-09 1.8657087e-09 1.5760273e-09]
  [6.6949189e-01 3.3050811e-01 1.8124738e-09 1.9643847e-09 1.8254911e-09]]

 [[1.7580659e-12 1.0000000e+00 5.3218326e-15 2.3923653e-14 4.4013975e-15]
  [1.6193213e-13 1.0000000e+00 1.7315731e-15 9.7984729e-15 1.7573525e-15]
  [1.3046701e-04 9.9986947e-01 4.7715581e-11 9.0533060e-11 5.8125678e-11]
  ...
  [6.6768110e-01 3.3231887e-01 1.8123876e-09 1.9641186e-09 1.8208143e-09]
  [1.3424248e-07 9.9999988e-01 1.4172604e-12 3.8002878e-12 1.4165686e-12]
  [7.4437750e-14 1.0000000e+00 1.1775016e-15 7.0201985e-15 1.2337993e-15]]

 [[1.4881121e-01 8.5118884e-01 1.3755566e-09 1.7065774e-09 1.4437117e-09]
  [2.1579778e-01 7.8420222e-01 1.5974692e-09 1.9397259e-09 1.6696370e-09]
  [7.0844156e-01 2.9155850e-01 1.7502841e-09 1.8777198e-09 1.7610500e-09]
  ...
  [9.4825729e-09 1.0000000e+00 3.7890532e-13 1.1736289e-12 3.7090890e-13]
  [2.0334987e-01 7.9665011e-01 1.5963417e-09 1.9603306e-09 1.7066377e-09]
  [4.6990266e-08 1.0000000e+00 8.4448713e-13 2.4011448e-12 8.2697412e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.2725200e-02 9.8727477e-01 4.3482437e-10 6.2273003e-10 4.6676812e-10]
 [2.0905939e-01 7.9094064e-01 1.5854632e-09 1.9320709e-09 1.6641996e-09]
 [6.8510443e-01 3.1489560e-01 1.7896882e-09 1.9322557e-09 1.8046229e-09]
 ...
 [9.4825729e-09 1.0000000e+00 3.7890532e-13 1.1736289e-12 3.7090890e-13]
 [2.0334987e-01 7.9665011e-01 1.5963417e-09 1.9603306e-09 1.7066377e-09]
 [4.6990266e-08 1.0000000e+00 8.4448713e-13 2.4011448e-12 8.2697412e-13]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.397591120910645
tp :  21259.0
fp :  78741.0
tn :  321259.0
fn :  78741.0
accuracy :  0.6850390434265137
precision :  0.21258999407291412
recall :  0.21258999407291412
auc :  0.5641556978225708

y_eval {0: 100000}
pred {0: 21259, 1: 78741}
[INFO] confusion matrix for file 
[[21259 78741     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1184637 4546400       0       0       0]
 [  48596  362513       0       0       0]
 [  27826   81871       0       0       0]
 [      0   45355       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.037685    0.          0.         ...  4.          0.00482
  -0.23351   ]
 [-1.037685    0.          0.         ...  3.          0.00482
   1.45442   ]
 [-1.037685    0.          0.         ...  2.          0.00482
  -0.33484   ]
 ...
 [-0.34771708  0.          0.         ...  4.          0.00482
  -0.23351   ]
 [-0.34771708  0.          0.         ...  1.          0.00482
  -0.32151   ]
 [-0.34771708  0.          0.         ...  1.          0.00482
  -0.32151   ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[8.02662515e-14 1.00000000e+00 1.15714314e-15 6.01138647e-15
   9.46679809e-16]
  [4.96644410e-04 9.99503374e-01 9.08097764e-11 1.58960803e-10
   1.04255403e-10]
  [4.81806576e-01 5.18193424e-01 1.94010674e-09 2.20214713e-09
   2.00131445e-09]
  ...
  [8.07430345e-10 1.00000000e+00 1.11901916e-13 3.96650323e-13
   1.08799688e-13]
  [4.00217585e-02 9.59978282e-01 7.90401911e-10 1.07886255e-09
   8.79380457e-10]
  [3.96300197e-01 6.03699803e-01 1.89295202e-09 2.18809060e-09
   1.94240490e-09]]

 [[1.56762563e-02 9.84323800e-01 4.81735152e-10 6.81932455e-10
   5.16320986e-10]
  [1.57136291e-01 8.42863739e-01 1.41985212e-09 1.76441095e-09
   1.49634261e-09]
  [2.09924611e-09 1.00000000e+00 1.81358143e-13 6.12014291e-13
   1.80848988e-13]
  ...
  [2.91504421e-08 1.00000000e+00 6.63395716e-13 1.93441487e-12
   6.56326339e-13]
  [7.43317040e-12 1.00000000e+00 1.16306492e-14 5.43527286e-14
   1.25435822e-14]
  [2.22387277e-02 9.77761269e-01 5.97628003e-10 8.45918169e-10
   6.73134493e-10]]

 [[6.21371266e-09 1.00000000e+00 3.07619219e-13 9.33021780e-13
   2.77773030e-13]
  [3.90921852e-17 1.00000000e+00 2.81237669e-17 2.46121066e-16
   2.93949682e-17]
  [3.37165729e-05 9.99966264e-01 2.48929002e-11 5.13484671e-11
   3.23689547e-11]
  ...
  [1.24571727e-07 9.99999881e-01 1.37067235e-12 3.69510238e-12
   1.38145951e-12]
  [2.52371907e-01 7.47628093e-01 1.71435843e-09 2.06954054e-09
   1.81452986e-09]
  [5.85535176e-09 1.00000000e+00 2.99599890e-13 9.54204489e-13
   2.89933876e-13]]

 ...

 [[3.84890973e-11 1.00000000e+00 2.45618108e-14 9.53538057e-14
   2.07962140e-14]
  [1.92214815e-13 1.00000000e+00 1.88135504e-15 1.05648912e-14
   1.91963289e-15]
  [3.04038072e-18 1.00000000e+00 8.02948770e-18 8.15951669e-17
   8.76066077e-18]
  ...
  [7.49224007e-01 2.50776023e-01 1.66973990e-09 1.77103976e-09
   1.67751280e-09]
  [7.53774464e-01 2.46225610e-01 1.65610026e-09 1.75284420e-09
   1.65658665e-09]
  [7.64336646e-01 2.35663310e-01 1.63080294e-09 1.72016634e-09
   1.62855862e-09]]

 [[7.57384335e-14 1.00000000e+00 1.12452327e-15 5.85949017e-15
   9.20466892e-16]
  [7.78220147e-02 9.22178030e-01 1.07257403e-09 1.40728207e-09
   1.18553634e-09]
  [1.54032769e-08 1.00000000e+00 4.89859455e-13 1.48676167e-12
   5.04090313e-13]
  ...
  [5.62946493e-18 1.00000000e+00 1.08648701e-17 1.07969927e-16
   1.18709335e-17]
  [2.07711921e-11 1.00000000e+00 2.07213024e-14 9.46778327e-14
   2.85079103e-14]
  [8.59222189e-03 9.91407812e-01 3.75951326e-10 5.62541735e-10
   4.29391661e-10]]

 [[1.77487090e-01 8.22512925e-01 1.47136592e-09 1.79995163e-09
   1.51283164e-09]
  [7.47801343e-14 1.00000000e+00 1.14376669e-15 6.66565929e-15
   1.13147678e-15]
  [1.73972795e-10 1.00000000e+00 5.85549336e-14 2.35107073e-13
   7.70487664e-14]
  ...
  [1.06757746e-14 1.00000000e+00 4.48818830e-16 2.96875413e-15
   4.71119461e-16]
  [1.04435636e-02 9.89556372e-01 4.18228119e-10 6.20775931e-10
   4.86954421e-10]
  [6.77357614e-01 3.22642356e-01 1.80343862e-09 1.95185024e-09
   1.82083082e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[8.02662515e-14 1.00000000e+00 1.15714314e-15 6.01138647e-15
  9.46679809e-16]
 [4.96644410e-04 9.99503374e-01 9.08097764e-11 1.58960803e-10
  1.04255403e-10]
 [4.81806576e-01 5.18193424e-01 1.94010674e-09 2.20214713e-09
  2.00131445e-09]
 ...
 [1.06757746e-14 1.00000000e+00 4.48818830e-16 2.96875413e-15
  4.71119461e-16]
 [1.04435636e-02 9.89556372e-01 4.18228119e-10 6.20775931e-10
  4.86954421e-10]
 [6.77357614e-01 3.22642356e-01 1.80343862e-09 1.95185024e-09
  1.82083082e-09]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  8.410234365844726
tp :  19668.0
fp :  80332.0
tn :  319668.0
fn :  80332.0
accuracy :  0.6786751747131348
precision :  0.1966799944639206
recall :  0.1966799944639206
auc :  0.5627784729003906

y_eval {0: 100000}
pred {0: 19668, 1: 80332}
[INFO] confusion matrix for file 
[[19668 80332     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1204305 4626732       0       0       0]
 [  48596  362513       0       0       0]
 [  27826   81871       0       0       0]
 [      0   45355       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-0.34771708  0.          0.         ...  3.          0.00482
   1.45442   ]
 [-0.34771708  0.          0.         ...  3.          0.00482
   1.45442   ]
 [-0.34771708  0.          0.         ...  2.          0.00482
  -0.33484   ]
 ...
 [ 0.34478754  0.          0.         ...  4.          0.00482
  -0.23351   ]
 [ 0.34478754  0.          0.         ...  1.          0.00482
  -0.32151   ]
 [ 0.34478754  0.          0.         ...  3.          0.00482
   1.45442   ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[3.74016818e-10 1.00000000e+00 7.59964465e-14 2.64511476e-13
   6.60643957e-14]
  [1.03827746e-08 1.00000000e+00 4.22470544e-13 1.32611402e-12
   4.60911203e-13]
  [4.74273652e-01 5.25726378e-01 1.95201655e-09 2.22437135e-09
   2.02590833e-09]
  ...
  [2.90998537e-02 9.70900118e-01 6.51965315e-10 8.94509466e-10
   6.83913481e-10]
  [4.13740535e-11 1.00000000e+00 2.59750226e-14 1.08740145e-13
   2.57020950e-14]
  [5.56813143e-02 9.44318712e-01 9.24404997e-10 1.23805743e-09
   1.02644049e-09]]

 [[2.86211277e-10 1.00000000e+00 6.65345600e-14 2.34618802e-13
   5.76625200e-14]
  [2.22193194e-03 9.97778118e-01 1.91380592e-10 3.07940701e-10
   2.21988442e-10]
  [7.80746579e-01 2.19253466e-01 1.59274594e-09 1.67267955e-09
   1.59687075e-09]
  ...
  [1.34606642e-04 9.99865413e-01 4.77359575e-11 8.98984359e-11
   5.58919751e-11]
  [5.89607529e-10 1.00000000e+00 9.84005561e-14 3.58837526e-13
   1.00176879e-13]
  [9.60746706e-02 9.03925359e-01 1.17687304e-09 1.52087942e-09
   1.28103139e-09]]

 [[1.61995217e-01 8.38004768e-01 1.41893930e-09 1.74624426e-09
   1.45979873e-09]
  [4.56813271e-14 1.00000000e+00 8.97184498e-16 5.36791206e-15
   8.89876615e-16]
  [7.60709025e-20 1.00000000e+00 1.29831188e-18 1.56564577e-17
   1.40529942e-18]
  ...
  [5.94001847e-07 9.99999404e-01 2.98408498e-12 7.38534321e-12
   3.01081837e-12]
  [4.14541781e-01 5.85458219e-01 1.92956806e-09 2.22951835e-09
   2.00731010e-09]
  [4.41585392e-01 5.58414578e-01 1.91610394e-09 2.18957052e-09
   1.95377647e-09]]

 ...

 [[8.59475522e-14 1.00000000e+00 1.19698482e-15 6.20026847e-15
   9.79947769e-16]
  [7.23783387e-07 9.99999285e-01 3.48702534e-12 8.67630533e-12
   3.72580048e-12]
  [1.37105599e-01 8.62894416e-01 1.35488643e-09 1.70399139e-09
   1.44838086e-09]
  ...
  [7.34072268e-01 2.65927762e-01 1.70009429e-09 1.81041082e-09
   1.70517345e-09]
  [8.11815441e-01 1.88184619e-01 1.50047319e-09 1.55731072e-09
   1.49294810e-09]
  [1.91065874e-02 9.80893373e-01 5.27170363e-10 7.38290040e-10
   5.45486822e-10]]

 [[4.32439670e-02 9.56755996e-01 7.86645249e-10 1.05055153e-09
   8.31314739e-10]
  [6.49678463e-15 1.00000000e+00 3.45171776e-16 2.29964786e-15
   3.50377482e-16]
  [6.68240133e-18 1.00000000e+00 1.19607984e-17 1.16896622e-16
   1.35826556e-17]
  ...
  [1.06334559e-08 1.00000000e+00 4.00833257e-13 1.23313772e-12
   3.92542498e-13]
  [1.52816058e-11 1.00000000e+00 1.69963124e-14 7.70196759e-14
   2.01083826e-14]
  [3.85637077e-06 9.99996185e-01 8.24958071e-12 1.90245424e-11
   9.86031916e-12]]

 [[5.66036419e-11 1.00000000e+00 2.97462792e-14 1.13401015e-13
   2.53034762e-14]
  [2.27990218e-12 1.00000000e+00 6.40961690e-15 3.15634461e-14
   6.57760555e-15]
  [6.00189306e-02 9.39981043e-01 9.54289425e-10 1.27126221e-09
   1.05716080e-09]
  ...
  [1.95861407e-08 1.00000000e+00 5.44996502e-13 1.62496557e-12
   5.33033090e-13]
  [3.85800213e-01 6.14199758e-01 1.91242355e-09 2.22547669e-09
   2.00012407e-09]
  [2.95900516e-02 9.70409989e-01 6.55390520e-10 8.97310670e-10
   6.84356183e-10]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[3.7401682e-10 1.0000000e+00 7.5996447e-14 2.6451148e-13 6.6064396e-14]
 [1.0382775e-08 1.0000000e+00 4.2247054e-13 1.3261140e-12 4.6091120e-13]
 [4.7427365e-01 5.2572638e-01 1.9520165e-09 2.2243714e-09 2.0259083e-09]
 ...
 [1.9586141e-08 1.0000000e+00 5.4499650e-13 1.6249656e-12 5.3303309e-13]
 [3.8580021e-01 6.1419976e-01 1.9124236e-09 2.2254767e-09 2.0001241e-09]
 [2.9590052e-02 9.7040999e-01 6.5539052e-10 8.9731067e-10 6.8435618e-10]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.375221713256837
tp :  19202.0
fp :  80798.0
tn :  319202.0
fn :  80798.0
accuracy :  0.676811158657074
precision :  0.1920199990272522
recall :  0.1920199990272522
auc :  0.5598245859146118

y_eval {0: 100000}
pred {0: 19202, 1: 80798}
[INFO] confusion matrix for file 
[[19202 80798     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1223507 4707530       0       0       0]
 [  48596  362513       0       0       0]
 [  27826   81871       0       0       0]
 [      0   45355       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4478754e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 3.4478754e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4478754e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [ 1.0398288e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0398288e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0398288e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[4.39516921e-03 9.95604873e-01 2.56581895e-10 3.89185767e-10
   2.74795353e-10]
  [3.09758761e-05 9.99969006e-01 2.20543687e-11 4.43445350e-11
   2.38506437e-11]
  [7.12361489e-11 1.00000000e+00 3.49270207e-14 1.43208009e-13
   3.67267048e-14]
  ...
  [7.58425549e-13 1.00000000e+00 3.95249756e-15 2.14754768e-14
   5.11514599e-15]
  [9.43601318e-03 9.90563989e-01 3.95403321e-10 5.89238047e-10
   4.54072890e-10]
  [6.56345367e-01 3.43654692e-01 1.83315796e-09 1.99466599e-09
   1.85244742e-09]]

 [[1.20500936e-11 1.00000000e+00 1.38077602e-14 5.66538868e-14
   1.15683033e-14]
  [3.77003103e-02 9.62299705e-01 7.64408592e-10 1.04602504e-09
   8.54160964e-10]
  [7.48027014e-06 9.99992490e-01 1.06728203e-11 2.31318020e-11
   1.14429941e-11]
  ...
  [2.84570612e-14 1.00000000e+00 7.22430324e-16 4.52793236e-15
   7.46700306e-16]
  [3.75883152e-15 1.00000000e+00 2.78525953e-16 1.99540189e-15
   3.38624714e-16]
  [1.01879740e-03 9.98981178e-01 1.33916128e-10 2.27899394e-10
   1.62857755e-10]]

 [[5.61778263e-11 1.00000000e+00 2.96349418e-14 1.13017736e-13
   2.52067976e-14]
  [2.26430962e-12 1.00000000e+00 6.38794132e-15 3.14681075e-14
   6.55538703e-15]
  [5.94600029e-02 9.40540016e-01 9.50196810e-10 1.26654198e-09
   1.05285192e-09]
  ...
  [2.01496352e-02 9.79850411e-01 5.43494139e-10 7.60293550e-10
   5.65282487e-10]
  [9.06125592e-08 9.99999881e-01 1.18561866e-12 3.26509869e-12
   1.21195588e-12]
  [7.93901196e-15 1.00000000e+00 3.90125032e-16 2.63353385e-15
   4.17547962e-16]]

 ...

 [[6.35698318e-01 3.64301711e-01 1.84885829e-09 2.01590944e-09
   1.85673887e-09]
  [1.30850938e-11 1.00000000e+00 1.45409333e-14 6.40634464e-14
   1.39650602e-14]
  [2.12848485e-02 9.78715181e-01 5.87481563e-10 8.33751068e-10
   6.69365563e-10]
  ...
  [4.29112014e-13 1.00000000e+00 2.75085914e-15 1.48551283e-14
   2.79488262e-15]
  [6.67384166e-18 1.00000000e+00 1.18781812e-17 1.16921596e-16
   1.31795340e-17]
  [1.67075836e-04 9.99832869e-01 5.56551680e-11 1.05479257e-10
   7.18176490e-11]]

 [[3.84789356e-03 9.96152103e-01 2.40056447e-10 3.66630698e-10
   2.56526189e-10]
  [6.11100858e-03 9.93888974e-01 3.07013776e-10 4.61910121e-10
   3.33505723e-10]
  [3.07547793e-06 9.99996901e-01 6.91583336e-12 1.57567570e-11
   7.34488165e-12]
  ...
  [1.77515114e-10 1.00000000e+00 5.38641668e-14 2.08983357e-13
   5.36349360e-14]
  [2.53606349e-01 7.46393681e-01 1.72353720e-09 2.08200657e-09
   1.83630988e-09]
  [8.27666521e-01 1.72333494e-01 1.44988621e-09 1.49599333e-09
   1.44260937e-09]]

 [[5.37513811e-10 1.00000000e+00 9.10044203e-14 3.11177679e-13
   7.94398388e-14]
  [8.02183810e-17 1.00000000e+00 4.01462912e-17 3.38427117e-16
   4.18253951e-17]
  [1.20856368e-03 9.98791516e-01 1.45733925e-10 2.45165527e-10
   1.79077073e-10]
  ...
  [9.44115734e-16 1.00000000e+00 1.37866153e-16 1.05026421e-15
   1.53905860e-16]
  [1.06416167e-07 9.99999881e-01 1.42858598e-12 4.06697809e-12
   1.87299395e-12]
  [3.46840382e-01 6.53159678e-01 1.86516136e-09 2.19096297e-09
   1.94944860e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[4.3951692e-03 9.9560487e-01 2.5658189e-10 3.8918577e-10 2.7479535e-10]
 [3.0975876e-05 9.9996901e-01 2.2054369e-11 4.4344535e-11 2.3850644e-11]
 [7.1236149e-11 1.0000000e+00 3.4927021e-14 1.4320801e-13 3.6726705e-14]
 ...
 [9.4411573e-16 1.0000000e+00 1.3786615e-16 1.0502642e-15 1.5390586e-16]
 [1.0641617e-07 9.9999988e-01 1.4285860e-12 4.0669781e-12 1.8729939e-12]
 [3.4684038e-01 6.5315968e-01 1.8651614e-09 2.1909630e-09 1.9494486e-09]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.237203225708008
tp :  19905.0
fp :  80095.0
tn :  319905.0
fn :  80095.0
accuracy :  0.6796231269836426
precision :  0.19904999434947968
recall :  0.19904999434947968
auc :  0.558216392993927

y_eval {0: 100000}
pred {0: 19905, 1: 80095}
[INFO] confusion matrix for file 
[[19905 80095     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1243412 4787625       0       0       0]
 [  48596  362513       0       0       0]
 [  27826   81871       0       0       0]
 [      0   45355       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0398288e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.0398288e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.0398288e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 ...
 [ 1.7323334e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.7323334e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.7323334e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[2.24812979e-07 9.99999762e-01 1.84227178e-12 4.67543148e-12
   1.76658655e-12]
  [1.08544178e-01 8.91455829e-01 1.23228749e-09 1.57473456e-09
   1.32821110e-09]
  [7.96841562e-01 2.03158364e-01 1.54652213e-09 1.61454283e-09
   1.54578483e-09]
  ...
  [1.30970037e-07 9.99999881e-01 1.39557799e-12 3.74351114e-12
   1.38449300e-12]
  [1.68886241e-02 9.83111382e-01 5.17930476e-10 7.41646522e-10
   5.73813164e-10]
  [1.81763880e-05 9.99981880e-01 1.66622740e-11 3.43589983e-11
   1.72742185e-11]]

 [[7.40857375e-11 1.00000000e+00 3.39912119e-14 1.27809411e-13
   2.89383487e-14]
  [2.34006112e-03 9.97659922e-01 1.96777747e-10 3.16180804e-10
   2.30017005e-10]
  [2.88722981e-02 9.71127689e-01 6.53567533e-10 8.99879171e-10
   7.01076641e-10]
  ...
  [7.58501291e-01 2.41498694e-01 1.64746627e-09 1.74194392e-09
   1.65160352e-09]
  [6.64777957e-08 9.99999881e-01 9.96927692e-13 2.77605760e-12
   9.82123454e-13]
  [3.34389567e-01 6.65610373e-01 1.85698679e-09 2.19060392e-09
   1.95198280e-09]]

 [[6.18925393e-01 3.81074637e-01 1.86596538e-09 2.04257211e-09
   1.87503812e-09]
  [9.14584780e-06 9.99990821e-01 1.17023223e-11 2.49345215e-11
   1.21211886e-11]
  [4.90747809e-01 5.09252191e-01 1.94936378e-09 2.21074781e-09
   2.01122385e-09]
  ...
  [6.58137143e-01 3.41862917e-01 1.83490834e-09 1.99743488e-09
   1.86255655e-09]
  [8.27738941e-01 1.72261000e-01 1.44913670e-09 1.49491197e-09
   1.44035450e-09]
  [7.57058024e-01 2.42941946e-01 1.64832570e-09 1.74272319e-09
   1.64795788e-09]]

 ...

 [[3.06520488e-13 1.00000000e+00 2.24336231e-15 1.09476366e-14
   1.84151400e-15]
  [4.02936578e-01 5.97063482e-01 1.92996219e-09 2.24080732e-09
   2.02345518e-09]
  [1.50450377e-03 9.98495460e-01 1.49882301e-10 2.42339149e-10
   1.61447453e-10]
  ...
  [7.87662864e-01 2.12337181e-01 1.57240443e-09 1.64665293e-09
   1.57135815e-09]
  [3.50044370e-02 9.64995563e-01 7.08150982e-10 9.58751634e-10
   7.32808703e-10]
  [7.82303989e-01 2.17695996e-01 1.58769520e-09 1.66593539e-09
   1.58826163e-09]]

 [[6.77322504e-11 1.00000000e+00 3.25151046e-14 1.22857318e-13
   2.76886346e-14]
  [8.76601562e-02 9.12339807e-01 1.12726117e-09 1.46307844e-09
   1.23128852e-09]
  [4.20591606e-09 1.00000000e+00 2.55662326e-13 8.31845010e-13
   2.58361908e-13]
  ...
  [1.96810625e-03 9.98031914e-01 1.72383399e-10 2.74782530e-10
   1.81352947e-10]
  [7.24515498e-01 2.75484473e-01 1.72396952e-09 1.84246152e-09
   1.73688119e-09]
  [3.41885276e-08 1.00000000e+00 7.16746541e-13 2.06990436e-12
   7.02993328e-13]]

 [[3.88374488e-08 1.00000000e+00 7.67150503e-13 2.12615667e-12
   7.14949692e-13]
  [9.50119901e-17 1.00000000e+00 4.35842060e-17 3.64864842e-16
   4.55526577e-17]
  [4.86244911e-09 1.00000000e+00 3.07305478e-13 1.03141443e-12
   4.07335759e-13]
  ...
  [7.89184153e-01 2.10815847e-01 1.56766888e-09 1.64056690e-09
   1.56474445e-09]
  [2.99982019e-02 9.70001876e-01 6.57475741e-10 8.98140173e-10
   6.81693924e-10]
  [7.83331692e-01 2.16668382e-01 1.58517255e-09 1.66283154e-09
   1.58611613e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[2.2481298e-07 9.9999976e-01 1.8422718e-12 4.6754315e-12 1.7665866e-12]
 [1.0854418e-01 8.9145583e-01 1.2322875e-09 1.5747346e-09 1.3282111e-09]
 [7.9684156e-01 2.0315836e-01 1.5465221e-09 1.6145428e-09 1.5457848e-09]
 ...
 [7.8918415e-01 2.1081585e-01 1.5676689e-09 1.6405669e-09 1.5647444e-09]
 [2.9998202e-02 9.7000188e-01 6.5747574e-10 8.9814017e-10 6.8169392e-10]
 [7.8333169e-01 2.1666838e-01 1.5851725e-09 1.6628315e-09 1.5861161e-09]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 0 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  4.647890035247802
tp :  46147.0
fp :  53853.0
tn :  346147.0
fn :  53853.0
accuracy :  0.7845900058746338
precision :  0.46147000789642334
recall :  0.46147000789642334
auc :  0.7325412631034851

y_eval {0: 74648, 1: 25352}
pred {0: 20795, 1: 79205}
[INFO] confusion matrix for file 
[[20795 53853     0     0     0]
 [    0 25352     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1264207 4841478       0       0       0]
 [  48596  387865       0       0       0]
 [  27826   81871       0       0       0]
 [      0   45355       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-02_172943_122.log.part04_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1377 (0.2754%)
[INFO] ** orig:[0:99.995%,2:0.005%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9944%,3:0.0056%]
[INFO] ** i/f_dir:[1:99.9944%,0:0.0056%]
[INFO] ** src:[22:38.203%,9:26.1368%,7:18.1014%,1:17.5508%,21:0.005%,3:0.0008%,15:0.0006%,14:0.0006%,4:0.0004%,2:0.0004%,8:0.0002%]
[INFO] ** dst:[21:43.4462%,10:20.893%,8:18.1012%,9:17.5504%,15:0.0056%,22:0.0016%,16:0.0008%,6:0.0006%,17:0.0004%,24:0.0002%]
[INFO] ** proto:[0:99.9938%,1:0.0056%,2:0.0006%]
[INFO] ** appi_name:[21:99.9926%,30:0.0056%,17:0.0008%,26:0.0004%,28:0.0002%,22:0.0002%,7:0.0002%]
[INFO] ** proxy_src_ip:[18:38.203%,20:26.1368%,13:18.1014%,6:17.5508%,17:0.0056%,1:0.0008%,16:0.0006%,21:0.0004%,14:0.0004%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9926%,-33.760870000000004:0.0074%]
[INFO] ** modbus_function_description:[7:49.9972%,11:49.9954%,0:0.0074%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1358%,1:20.8928%,5:18.1008%,4:17.55%,2:17.31%,0:0.0106%]
[INFO] ** service:[0.0048200000000000005:99.9926%,-211.73542999999998:0.0056%,-205.44247:0.0008%,-211.08346:0.0004%,-211.09762999999998:0.0002%,-185.9872:0.0002%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:26.136%,-0.32151:20.893%,-1.27613:18.101%,-0.23351:17.5502%,-0.33484:17.31%,-71.33197:0.0056%,1.45709:0.0006%,-1.02014:0.0006%,-71.14798:0.0004%,-0.24151:0.0004%,-5.1466400000000005:0.0002%,-58.035180000000004:0.0002%,-1.2708:0.0002%,-71.14931:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,-5.08665:0.0002%,-0.24950999999999998:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** classification:[normal:64.3482%,Single Stage Single Point:35.6518%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7331795e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.7331795e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.7331795e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [-1.0379097e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0379097e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0379097e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 1 1 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[4.73499238e-01 5.26500762e-01 1.92225813e-09 2.17623142e-09
   1.96450167e-09]
  [1.35592831e-13 1.00000000e+00 1.53260299e-15 8.64633021e-15
   1.51226510e-15]
  [2.11012637e-19 1.00000000e+00 2.14896519e-18 2.47519124e-17
   2.33300005e-18]
  ...
  [2.94483919e-03 9.97055173e-01 2.23979710e-10 3.57058050e-10
   2.64196637e-10]
  [6.33178055e-01 3.66821945e-01 1.86292648e-09 2.03991846e-09
   1.89156335e-09]
  [4.50480570e-10 1.00000000e+00 8.37865272e-14 3.06384855e-13
   8.10721865e-14]]

 [[2.24844214e-08 1.00000000e+00 5.83979208e-13 1.66241565e-12
   5.38457029e-13]
  [7.03212048e-04 9.99296784e-01 1.07783671e-10 1.84746843e-10
   1.24662863e-10]
  [7.65437424e-01 2.34562606e-01 1.63252234e-09 1.72330084e-09
   1.63931824e-09]
  ...
  [2.15661407e-15 1.00000000e+00 2.07600496e-16 1.52091415e-15
   2.32116038e-16]
  [8.99721545e-06 9.99991059e-01 1.29227679e-11 2.87523391e-11
   1.65480928e-11]
  [3.44706804e-01 6.55293167e-01 1.85534654e-09 2.17771334e-09
   1.92715133e-09]]

 [[1.19910352e-02 9.88008976e-01 4.22268331e-10 6.06728334e-10
   4.53369259e-10]
  [1.46414484e-15 1.00000000e+00 1.66213963e-16 1.20064337e-15
   1.71275726e-16]
  [8.05163199e-06 9.99991894e-01 1.22823652e-11 2.74916929e-11
   1.62938517e-11]
  ...
  [4.57463928e-13 1.00000000e+00 2.90002736e-15 1.57353378e-14
   3.06183606e-15]
  [3.27934563e-17 1.00000000e+00 2.61460211e-17 2.37985183e-16
   2.92312625e-17]
  [1.81700898e-06 9.99998212e-01 5.92811737e-12 1.45039501e-11
   7.95351458e-12]]

 ...

 [[6.91570214e-14 1.00000000e+00 1.07515819e-15 5.62621010e-15
   8.79979035e-16]
  [5.79821989e-02 9.42017794e-01 9.37362410e-10 1.25241228e-09
   1.04133657e-09]
  [7.24633753e-01 2.75366306e-01 1.72090941e-09 1.83852467e-09
   1.73534642e-09]
  ...
  [2.42113307e-01 7.57886648e-01 1.67107850e-09 2.01581307e-09
   1.73968617e-09]
  [7.51059890e-01 2.48940155e-01 1.66342728e-09 1.76237325e-09
   1.66569403e-09]
  [4.86108184e-01 5.13891816e-01 1.92509164e-09 2.17611196e-09
   1.94953076e-09]]

 [[2.24040664e-12 1.00000000e+00 6.00036615e-15 2.66672399e-14
   4.96945252e-15]
  [1.60104333e-04 9.99839902e-01 5.19080612e-11 9.68932642e-11
   6.12384032e-11]
  [8.47049254e-12 1.00000000e+00 1.20195915e-14 5.51966581e-14
   1.23549547e-14]
  ...
  [6.00734055e-01 3.99265975e-01 1.89412597e-09 2.09031725e-09
   1.92675964e-09]
  [6.57127917e-01 3.42872083e-01 1.82688820e-09 1.98518024e-09
   1.83577453e-09]
  [7.60445058e-01 2.39554882e-01 1.64054847e-09 1.73272474e-09
   1.63997282e-09]]

 [[6.43059082e-08 9.99999881e-01 9.86439446e-13 2.66554682e-12
   9.26257118e-13]
  [5.34681872e-16 1.00000000e+00 1.02221140e-16 7.83320717e-16
   1.06233582e-16]
  [3.11707789e-19 1.00000000e+00 2.61066411e-18 2.95140690e-17
   2.86354811e-18]
  ...
  [3.34697306e-01 6.65302694e-01 1.83415383e-09 2.15479812e-09
   1.89576843e-09]
  [7.06849694e-01 2.93150276e-01 1.75230042e-09 1.88019489e-09
   1.75922577e-09]
  [7.73382008e-01 2.26617947e-01 1.60872649e-09 1.69215819e-09
   1.60654934e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[4.7349924e-01 5.2650076e-01 1.9222581e-09 2.1762314e-09 1.9645017e-09]
 [1.3559283e-13 1.0000000e+00 1.5326030e-15 8.6463302e-15 1.5122651e-15]
 [2.1101264e-19 1.0000000e+00 2.1489652e-18 2.4751912e-17 2.3330001e-18]
 ...
 [3.3469731e-01 6.6530269e-01 1.8341538e-09 2.1547981e-09 1.8957684e-09]
 [7.0684969e-01 2.9315028e-01 1.7523004e-09 1.8801949e-09 1.7592258e-09]
 [7.7338201e-01 2.2661795e-01 1.6087265e-09 1.6921582e-09 1.6065493e-09]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  2.626872853851318
tp :  57218.0
fp :  42782.0
tn :  357218.0
fn :  42782.0
accuracy :  0.8288735151290894
precision :  0.5721799731254578
recall :  0.5721799731254578
auc :  0.8303117752075195

y_eval {0: 64457, 1: 35543}
pred {0: 21675, 1: 78325}
[INFO] confusion matrix for file 
[[21675 42782     0     0     0]
 [    0 35543     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1285882 4884260       0       0       0]
 [  48596  423408       0       0       0]
 [  27826   81871       0       0       0]
 [      0   45355       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0379097  0.         0.        ...  4.         0.00482   -0.23351  ]
 [-1.0379097  0.         0.        ...  3.         0.00482    1.45442  ]
 [-1.0379097  0.         0.        ...  2.         0.00482   -0.33484  ]
 ...
 [-0.3451776  0.         0.        ...  2.         0.00482   -0.33484  ]
 [-0.3451776  0.         0.        ...  3.         0.00482    1.45442  ]
 [-0.3451776  0.         0.        ...  1.         0.00482   -0.32151  ]] shape (100000, 16)
y_test [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [1 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[6.9139749e-14 1.0000000e+00 1.0750269e-15 5.6255664e-15 8.7987162e-16]
  [3.4804136e-04 9.9965191e-01 7.6038384e-11 1.3568863e-10 8.6916446e-11]
  [4.2490658e-01 5.7509339e-01 1.9219906e-09 2.2106623e-09 1.9915978e-09]
  ...
  [1.1677936e-03 9.9883217e-01 1.4345439e-10 2.4233626e-10 1.7501396e-10]
  [5.5788535e-01 4.4211465e-01 1.9226014e-09 2.1431976e-09 1.9595570e-09]
  [7.4503589e-01 2.5496408e-01 1.6757254e-09 1.7781546e-09 1.6760674e-09]]

 [[2.8729930e-09 1.0000000e+00 2.0951378e-13 6.6008001e-13 1.8709830e-13]
  [7.1225181e-04 9.9928778e-01 1.0878500e-10 1.8654821e-10 1.2692374e-10]
  [7.3967147e-01 2.6032853e-01 1.6919710e-09 1.8003999e-09 1.7037067e-09]
  ...
  [2.4663786e-17 1.0000000e+00 2.2480718e-17 2.0668152e-16 2.4376723e-17]
  [1.0383352e-04 9.9989617e-01 4.3907877e-11 8.5500752e-11 5.7031005e-11]
  [5.3119087e-01 4.6880913e-01 1.9364617e-09 2.1735171e-09 1.9842259e-09]]

 [[5.9672658e-08 9.9999988e-01 9.5032109e-13 2.5775760e-12 8.9126222e-13]
  [5.2712983e-16 1.0000000e+00 1.0151003e-16 7.7844435e-16 1.0549818e-16]
  [2.8150601e-17 1.0000000e+00 2.4300219e-17 2.2130425e-16 2.7406022e-17]
  ...
  [1.4644129e-05 9.9998534e-01 1.6496159e-11 3.5757074e-11 2.1191549e-11]
  [2.3364860e-15 1.0000000e+00 2.1036035e-16 1.5108696e-15 2.1924054e-16]
  [3.2287548e-04 9.9967718e-01 7.6173422e-11 1.3854898e-10 9.5346085e-11]]

 ...

 [[7.0301932e-01 2.9698071e-01 1.7554355e-09 1.8829123e-09 1.7644654e-09]
  [4.5235920e-01 5.4764080e-01 1.9230413e-09 2.1933271e-09 1.9807049e-09]
  [7.4448168e-01 2.5551835e-01 1.6775412e-09 1.7807608e-09 1.6807056e-09]
  ...
  [1.0095049e-01 8.9904958e-01 1.2070758e-09 1.5564690e-09 1.3204416e-09]
  [3.2048369e-08 1.0000000e+00 7.0043965e-13 2.0362516e-12 6.9288694e-13]
  [3.9787927e-01 6.0212070e-01 1.9209063e-09 2.2287920e-09 2.0051296e-09]]

 [[3.3728498e-10 1.0000000e+00 7.2192828e-14 2.5255801e-13 6.2695902e-14]
  [5.5237283e-06 9.9999452e-01 9.6791091e-12 2.1678570e-11 1.1239104e-11]
  [6.8434262e-01 3.1565738e-01 1.7990920e-09 1.9459985e-09 1.8261762e-09]
  ...
  [1.6712740e-07 9.9999988e-01 1.5993027e-12 4.2519499e-12 1.6308369e-12]
  [4.0632671e-01 5.9367329e-01 1.9260735e-09 2.2306350e-09 2.0085149e-09]
  [6.5636647e-09 1.0000000e+00 3.1653955e-13 1.0013070e-12 3.0688315e-13]]

 [[6.9845629e-01 3.0154377e-01 1.7631835e-09 1.8935002e-09 1.7727773e-09]
  [1.1630291e-02 9.8836970e-01 4.1534554e-10 5.9962241e-10 4.4256585e-10]
  [5.5907679e-12 1.0000000e+00 9.6946665e-15 4.5265183e-14 9.6750492e-15]
  ...
  [2.4646436e-01 7.5353563e-01 1.6863364e-09 2.0337532e-09 1.7643286e-09]
  [3.4819394e-01 6.5180606e-01 1.8390921e-09 2.1469690e-09 1.8711417e-09]
  [8.0449641e-01 1.9550353e-01 1.5235696e-09 1.5858520e-09 1.5190547e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[6.9139749e-14 1.0000000e+00 1.0750269e-15 5.6255664e-15 8.7987162e-16]
 [3.4804136e-04 9.9965191e-01 7.6038384e-11 1.3568863e-10 8.6916446e-11]
 [4.2490658e-01 5.7509339e-01 1.9219906e-09 2.2106623e-09 1.9915978e-09]
 ...
 [2.4646436e-01 7.5353563e-01 1.6863364e-09 2.0337532e-09 1.7643286e-09]
 [3.4819394e-01 6.5180606e-01 1.8390921e-09 2.1469690e-09 1.8711417e-09]
 [8.0449641e-01 1.9550353e-01 1.5235696e-09 1.5858520e-09 1.5190547e-09]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  2.6761186019897463
tp :  55526.0
fp :  44474.0
tn :  355526.0
fn :  44474.0
accuracy :  0.8221056461334229
precision :  0.5552600026130676
recall :  0.5552600026130676
auc :  0.8274650573730469

y_eval {0: 64588, 1: 35412}
pred {0: 20114, 1: 79886}
[INFO] confusion matrix for file 
[[20114 44474     0     0     0]
 [    0 35412     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1305996 4928734       0       0       0]
 [  48596  458820       0       0       0]
 [  27826   81871       0       0       0]
 [      0   45355       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4517759e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4517759e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-3.4517759e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 3.4755462e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4755462e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4755462e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 1 0 ... 1 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.2985179e-01 8.7014818e-01 1.2990334e-09 1.6254357e-09 1.3636960e-09]
  [4.7834128e-09 1.0000000e+00 2.7475586e-13 8.8553665e-13 2.7702699e-13]
  [7.3224808e-05 9.9992681e-01 3.5351434e-11 6.8914006e-11 4.1733533e-11]
  ...
  [6.6092998e-01 3.3906996e-01 1.8264518e-09 1.9847211e-09 1.8436793e-09]
  [4.0714571e-08 1.0000000e+00 7.8453303e-13 2.2443928e-12 7.7796168e-13]
  [3.8463864e-01 6.1536139e-01 1.9111674e-09 2.2251228e-09 1.9981741e-09]]

 [[2.1701869e-10 1.0000000e+00 5.7974391e-14 2.0709934e-13 5.0010424e-14]
  [1.1429753e-03 9.9885702e-01 1.3793269e-10 2.3065172e-10 1.6191182e-10]
  [7.1598522e-10 1.0000000e+00 1.0794353e-13 3.8888866e-13 1.1137512e-13]
  ...
  [1.8788860e-17 1.0000000e+00 1.9679143e-17 1.8365182e-16 2.1462544e-17]
  [1.8693472e-04 9.9981314e-01 5.8729958e-11 1.1060704e-10 7.5861151e-11]
  [4.6489730e-01 5.3510267e-01 1.9375992e-09 2.2081741e-09 1.9945119e-09]]

 [[6.9130737e-01 3.0869257e-01 1.7749091e-09 1.9096515e-09 1.7853768e-09]
  [2.1342379e-12 1.0000000e+00 5.9485633e-15 2.8903373e-14 5.7589067e-15]
  [2.9972887e-18 1.0000000e+00 8.0097859e-18 8.1235211e-17 8.8786490e-18]
  ...
  [9.7348995e-14 1.0000000e+00 1.3850141e-15 8.2690389e-15 1.6226030e-15]
  [1.3212205e-02 9.8678780e-01 4.6757126e-10 6.8409478e-10 5.3724308e-10]
  [7.5329387e-01 2.4670614e-01 1.6598148e-09 1.7579521e-09 1.6640750e-09]]

 ...

 [[1.7750086e-02 9.8224992e-01 5.1174842e-10 7.1918010e-10 5.4685001e-10]
  [2.4024789e-01 7.5975209e-01 1.6639757e-09 2.0069273e-09 1.7417940e-09]
  [7.8275990e-01 2.1724008e-01 1.5854694e-09 1.6630860e-09 1.5854211e-09]
  ...
  [2.3224960e-01 7.6775038e-01 1.6546540e-09 2.0058086e-09 1.7414207e-09]
  [7.4264789e-01 2.5735211e-01 1.6821583e-09 1.7868509e-09 1.6861061e-09]
  [6.8972469e-07 9.9999928e-01 3.2073289e-12 7.8627964e-12 3.2311838e-12]]

 [[1.3618222e-02 9.8638177e-01 4.4613768e-10 6.3245409e-10 4.5694584e-10]
  [9.9921841e-08 9.9999988e-01 1.2482327e-12 3.4130856e-12 1.2700437e-12]
  [1.2578844e-03 9.9874216e-01 1.4318532e-10 2.3706853e-10 1.6148209e-10]
  ...
  [4.6413139e-02 9.5358682e-01 8.1230594e-10 1.0827436e-09 8.4068008e-10]
  [7.0959985e-01 2.9040015e-01 1.7496917e-09 1.8769162e-09 1.7617304e-09]
  [4.3412996e-08 1.0000000e+00 8.0762475e-13 2.3026492e-12 7.9479739e-13]]

 [[6.8845082e-11 1.0000000e+00 3.2782625e-14 1.2381005e-13 2.7944681e-14]
  [7.0714509e-07 9.9999928e-01 3.4734574e-12 8.6979443e-12 3.9696055e-12]
  [6.2406933e-01 3.7593070e-01 1.8803687e-09 2.0663671e-09 1.9215158e-09]
  ...
  [2.0492007e-06 9.9999797e-01 5.5148403e-12 1.2743489e-11 5.6185291e-12]
  [4.4750448e-02 9.5524955e-01 8.2263762e-10 1.1108675e-09 8.9338209e-10]
  [7.5104284e-01 2.4895714e-01 1.6651291e-09 1.7650951e-09 1.6724211e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.2985179e-01 8.7014818e-01 1.2990334e-09 1.6254357e-09 1.3636960e-09]
 [4.7834128e-09 1.0000000e+00 2.7475586e-13 8.8553665e-13 2.7702699e-13]
 [7.3224808e-05 9.9992681e-01 3.5351434e-11 6.8914006e-11 4.1733533e-11]
 ...
 [2.0492007e-06 9.9999797e-01 5.5148403e-12 1.2743489e-11 5.6185291e-12]
 [4.4750448e-02 9.5524955e-01 8.2263762e-10 1.1108675e-09 8.9338209e-10]
 [7.5104284e-01 2.4895714e-01 1.6651291e-09 1.7650951e-09 1.6724211e-09]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  2.810008762741089
tp :  54772.0
fp :  45228.0
tn :  354772.0
fn :  45228.0
accuracy :  0.8190897107124329
precision :  0.5477200150489807
recall :  0.5477200150489807
auc :  0.8232710957527161

y_eval {0: 64276, 1: 35724}
pred {0: 19048, 1: 80952}
[INFO] confusion matrix for file 
[[19048 45228     0     0     0]
 [    0 35724     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1325044 4973962       0       0       0]
 [  48596  494544       0       0       0]
 [  27826   81871       0       0       0]
 [      0   45355       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4755462e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4755462e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 3.4755462e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [ 1.0377493e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.0377493e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0377493e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]] shape (100000, 16)
y_test [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [1 1 1 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[4.42506431e-09 1.00000000e+00 2.59867296e-13 8.01936046e-13
   2.34011866e-13]
  [3.80770824e-17 1.00000000e+00 2.77700414e-17 2.43371545e-16
   2.90488493e-17]
  [1.69690597e-19 1.00000000e+00 1.93665729e-18 2.24417310e-17
   2.13649999e-18]
  ...
  [6.36719823e-01 3.63280177e-01 1.85533988e-09 2.02785966e-09
   1.87428717e-09]
  [7.08722509e-05 9.99929070e-01 3.24468091e-11 6.18401580e-11
   3.36206306e-11]
  [6.51053190e-01 3.48946810e-01 1.84741400e-09 2.01561057e-09
   1.87852622e-09]]

 [[8.51592288e-14 1.00000000e+00 1.19154983e-15 6.17477659e-15
   9.75486976e-16]
  [5.99514124e-06 9.99994040e-01 1.00129965e-11 2.22417258e-11
   1.09625911e-11]
  [2.25229293e-01 7.74770677e-01 1.63593306e-09 1.98546091e-09
   1.72324233e-09]
  ...
  [1.53152764e-01 8.46847236e-01 1.43265411e-09 1.79531334e-09
   1.54395363e-09]
  [6.67960649e-06 9.99993324e-01 1.00135429e-11 2.17478327e-11
   1.02996908e-11]
  [5.48927009e-01 4.51072991e-01 1.93703720e-09 2.16731899e-09
   1.98881711e-09]]

 [[8.51429929e-14 1.00000000e+00 1.19143612e-15 6.17425863e-15
   9.75397720e-16]
  [1.06337466e-04 9.99893665e-01 4.20826499e-11 8.00800051e-11
   4.76448880e-11]
  [3.48405868e-01 6.51594162e-01 1.85618920e-09 2.17481655e-09
   1.93352490e-09]
  ...
  [1.41878810e-03 9.98581171e-01 1.53753038e-10 2.54244542e-10
   1.77731455e-10]
  [6.57988369e-01 3.42011631e-01 1.83353155e-09 1.99538053e-09
   1.85821492e-09]
  [6.91770971e-01 3.08229029e-01 1.77645842e-09 1.91330995e-09
   1.78235715e-09]]

 ...

 [[1.23037136e-10 1.00000000e+00 4.37351639e-14 1.60595360e-13
   3.74973930e-14]
  [7.65262055e-04 9.99234796e-01 1.12862948e-10 1.92855801e-10
   1.32219985e-10]
  [2.67425748e-10 1.00000000e+00 6.62515290e-14 2.51949395e-13
   6.82540030e-14]
  ...
  [6.75124019e-13 1.00000000e+00 3.60621101e-15 1.94676445e-14
   4.14790594e-15]
  [5.80276772e-02 9.41972315e-01 9.42023681e-10 1.25921640e-09
   1.04483344e-09]
  [8.78179371e-02 9.12182093e-01 1.09670539e-09 1.40987455e-09
   1.13689214e-09]]

 [[2.94641104e-05 9.99970555e-01 2.09562576e-11 4.12320594e-11
   2.09925827e-11]
  [2.15524107e-01 7.84475923e-01 1.61471247e-09 1.96793581e-09
   1.71283399e-09]
  [1.87095195e-01 8.12904835e-01 1.50717960e-09 1.84574411e-09
   1.56395186e-09]
  ...
  [2.66537938e-08 1.00000000e+00 7.03568822e-13 2.14418956e-12
   8.68123986e-13]
  [3.34738314e-01 6.65261686e-01 1.85234661e-09 2.18363438e-09
   1.94118699e-09]
  [1.55577520e-02 9.84442294e-01 4.78109496e-10 6.77977063e-10
   4.94962960e-10]]

 [[2.08354308e-07 9.99999762e-01 1.77366661e-12 4.51861205e-12
   1.69869912e-12]
  [4.03210614e-03 9.95967865e-01 2.55014371e-10 3.95518257e-10
   2.88065516e-10]
  [8.17375124e-01 1.82624891e-01 1.48477608e-09 1.53857560e-09
   1.48077428e-09]
  ...
  [7.96094358e-01 2.03905597e-01 1.54802182e-09 1.61624092e-09
   1.54552293e-09]
  [4.51978929e-02 9.54802155e-01 7.99528888e-10 1.06585496e-09
   8.20328749e-10]
  [8.01529586e-01 1.98470458e-01 1.53346147e-09 1.59824720e-09
   1.53108248e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[4.4250643e-09 1.0000000e+00 2.5986730e-13 8.0193605e-13 2.3401187e-13]
 [3.8077082e-17 1.0000000e+00 2.7770041e-17 2.4337154e-16 2.9048849e-17]
 [1.6969060e-19 1.0000000e+00 1.9366573e-18 2.2441731e-17 2.1365000e-18]
 ...
 [7.9609436e-01 2.0390560e-01 1.5480218e-09 1.6162409e-09 1.5455229e-09]
 [4.5197893e-02 9.5480216e-01 7.9952889e-10 1.0658550e-09 8.2032875e-10]
 [8.0152959e-01 1.9847046e-01 1.5334615e-09 1.5982472e-09 1.5310825e-09]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 0 1 0] (100000,)
[33m[INFO] metrics:[0m
loss :  2.9571253086090086
tp :  55643.0
fp :  44357.0
tn :  355643.0
fn :  44357.0
accuracy :  0.8225736021995544
precision :  0.5564299821853638
recall :  0.5564299821853638
auc :  0.8189333081245422

y_eval {0: 64281, 1: 35719}
pred {0: 19926, 1: 80074}
[INFO] confusion matrix for file 
[[19925 44356     0     0     0]
 [    1 35718     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1344969 5018318       0       0       0]
 [  48597  530262       0       0       0]
 [  27826   81871       0       0       0]
 [      0   45355       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0377493e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0377493e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.0377493e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 1.7330190e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.7330190e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.7330190e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [1 0 0 ... 1 1 1] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.72666731e-13 1.00000000e+00 1.68937196e-15 8.46836351e-15
   1.38442241e-15]
  [1.48358896e-01 8.51641119e-01 1.41448275e-09 1.77781045e-09
   1.52730417e-09]
  [9.08281747e-03 9.90917146e-01 3.67866682e-10 5.39101375e-10
   3.95620509e-10]
  ...
  [4.13204491e-01 5.86795509e-01 1.93367322e-09 2.23625651e-09
   2.01904915e-09]
  [2.63948703e-08 1.00000000e+00 6.31515185e-13 1.85255760e-12
   6.22220374e-13]
  [3.29880194e-08 1.00000000e+00 7.72387633e-13 2.30884582e-12
   9.49339348e-13]]

 [[1.15111878e-10 1.00000000e+00 4.23124331e-14 1.55869458e-13
   3.62501167e-14]
  [7.10212276e-04 9.99289751e-01 1.08760327e-10 1.86627228e-10
   1.27487368e-10]
  [7.84760535e-01 2.15239495e-01 1.58197533e-09 1.65901248e-09
   1.58468716e-09]
  ...
  [1.46529331e-07 9.99999881e-01 1.47437835e-12 3.93077584e-12
   1.45956294e-12]
  [3.46908927e-01 6.53091133e-01 1.87136528e-09 2.19968510e-09
   1.96113659e-09]
  [2.54436920e-04 9.99745548e-01 6.16233661e-11 1.09631970e-10
   6.38645109e-11]]

 [[1.72471873e-13 1.00000000e+00 1.68843133e-15 8.46410039e-15
   1.38364632e-15]
  [1.44600123e-01 8.55399847e-01 1.39982026e-09 1.76244486e-09
   1.51236035e-09]
  [3.11900163e-04 9.99688148e-01 6.85359478e-11 1.20945962e-10
   7.41726194e-11]
  ...
  [7.86810815e-01 2.13189200e-01 1.57284097e-09 1.64686198e-09
   1.56764168e-09]
  [1.14104114e-01 8.85895848e-01 1.22513444e-09 1.54657498e-09
   1.25956734e-09]
  [1.37150957e-08 1.00000000e+00 4.58611935e-13 1.39639559e-12
   4.55473658e-13]]

 ...

 [[1.85879792e-08 1.00000000e+00 5.31281182e-13 1.52740505e-12
   4.89304777e-13]
  [4.27927527e-10 1.00000000e+00 8.61712774e-14 3.20600236e-13
   9.15966792e-14]
  [2.89552030e-04 9.99710381e-01 6.94527283e-11 1.25208788e-10
   8.04708938e-11]
  ...
  [7.30408283e-05 9.99926925e-01 3.30844206e-11 6.30260358e-11
   3.42754228e-11]
  [8.31019588e-06 9.99991655e-01 1.16066141e-11 2.52073969e-11
   1.28331469e-11]
  [1.43784021e-07 9.99999881e-01 1.54107955e-12 4.18641294e-12
   1.67864626e-12]]

 [[2.97237188e-03 9.97027695e-01 2.10982745e-10 3.26604493e-10
   2.24721949e-10]
  [3.14526806e-05 9.99968529e-01 2.22352640e-11 4.46843847e-11
   2.40550791e-11]
  [9.24407691e-03 9.90755975e-01 3.78910181e-10 5.58363300e-10
   4.12727880e-10]
  ...
  [1.90853097e-11 1.00000000e+00 1.94034377e-14 8.79533534e-14
   2.47706518e-14]
  [5.95993832e-09 1.00000000e+00 3.27532679e-13 1.07508598e-12
   3.80177985e-13]
  [3.27971131e-01 6.72028899e-01 1.84531213e-09 2.17951590e-09
   1.93706384e-09]]

 [[5.50046027e-01 4.49953973e-01 1.91170302e-09 2.12481033e-09
   1.91863969e-09]
  [2.63968974e-01 7.36030996e-01 1.70666392e-09 2.04042494e-09
   1.78327164e-09]
  [1.34069085e-01 8.65930915e-01 1.31765376e-09 1.64931979e-09
   1.36625999e-09]
  ...
  [1.48845780e-09 1.00000000e+00 1.53842691e-13 5.30353810e-13
   1.52978338e-13]
  [3.47171635e-06 9.99996543e-01 7.78943750e-12 1.79961809e-11
   9.20544457e-12]
  [6.10887412e-14 1.00000000e+00 1.05798883e-15 6.38448204e-15
   1.09604179e-15]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.7266673e-13 1.0000000e+00 1.6893720e-15 8.4683635e-15 1.3844224e-15]
 [1.4835890e-01 8.5164112e-01 1.4144828e-09 1.7778105e-09 1.5273042e-09]
 [9.0828175e-03 9.9091715e-01 3.6786668e-10 5.3910137e-10 3.9562051e-10]
 ...
 [1.4884578e-09 1.0000000e+00 1.5384269e-13 5.3035381e-13 1.5297834e-13]
 [3.4717164e-06 9.9999654e-01 7.7894375e-12 1.7996181e-11 9.2054446e-12]
 [6.1088741e-14 1.0000000e+00 1.0579888e-15 6.3844820e-15 1.0960418e-15]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  3.199458790588379
tp :  56277.0
fp :  43723.0
tn :  356277.0
fn :  43723.0
accuracy :  0.8251094818115234
precision :  0.5627700090408325
recall :  0.5627700090408325
auc :  0.8060149550437927

y_eval {0: 64139, 1: 35861}
pred {0: 20416, 1: 79584}
[INFO] confusion matrix for file 
[[20416 43723     0     0     0]
 [    0 35861     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1365385 5062041       0       0       0]
 [  48597  566123       0       0       0]
 [  27826   81871       0       0       0]
 [      0   45355       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-02_172943_122.log.part05_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1367 (0.2734%)
[INFO] ** orig:[0:99.9992%,2:0.0008%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9984%,3:0.0016%]
[INFO] ** i/f_dir:[1:99.9984%,0:0.0016%]
[INFO] ** src:[22:38.0648%,9:26.1164%,7:18.2044%,1:17.6118%,21:0.001%,14:0.0008%,3:0.0004%,2:0.0004%]
[INFO] ** dst:[21:43.368%,10:20.8128%,8:18.2044%,9:17.6114%,15:0.0016%,22:0.0006%,16:0.0004%,24:0.0002%,18:0.0002%,6:0.0002%,2:0.0002%]
[INFO] ** proto:[0:99.998%,1:0.0016%,2:0.0004%]
[INFO] ** appi_name:[21:99.9974%,30:0.0016%,7:0.0006%,31:0.0002%,22:0.0002%]
[INFO] ** proxy_src_ip:[18:38.0648%,20:26.1164%,13:18.2044%,6:17.6118%,17:0.0016%,14:0.0004%,1:0.0004%,7:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9974%,-33.760870000000004:0.0026%]
[INFO] ** modbus_function_description:[7:49.9992%,11:49.9982%,0:0.0026%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1154%,1:20.8126%,5:18.204%,4:17.6112%,2:17.2518%,0:0.005%]
[INFO] ** service:[0.0048200000000000005:99.9974%,-211.73542999999998:0.0016%,-211.09762999999998:0.0006%,-186.43601999999998:0.0002%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:26.1158%,-0.32151:20.8128%,-1.27613:18.204%,-0.23351:17.6114%,-0.33484:17.252%,-71.33197:0.0016%,1.45709:0.0004%,-1.2708:0.0002%,-71.14931:0.0002%,-0.24151:0.0002%,-2.02544:0.0002%,1.46509:0.0002%,10.73138:0.0002%,-0.24950999999999998:0.0002%,14.88321:0.0002%,-1.27347:0.0002%,-2.81074:0.0002%]
[INFO] ** classification:[normal:97.0224%,Single Stage Single Point:2.9776%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7314488e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.7314488e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.7314488e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-1.0388432e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0388432e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0388432e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [1 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[3.71958324e-12 1.00000000e+00 7.71223922e-15 3.34631445e-14
   6.40680602e-15]
  [1.77419512e-04 9.99822557e-01 5.46592875e-11 1.01467931e-10
   6.46698944e-11]
  [4.97709662e-01 5.02290368e-01 1.94087946e-09 2.19530216e-09
   1.99867389e-09]
  ...
  [6.66005790e-01 3.33994240e-01 1.81519277e-09 1.96828087e-09
   1.82593285e-09]
  [4.34585594e-08 1.00000000e+00 8.07034994e-13 2.30077459e-12
   7.97526216e-13]
  [1.08218382e-12 1.00000000e+00 4.44013400e-15 2.29388414e-14
   4.63585706e-15]]

 [[1.78349907e-07 9.99999881e-01 1.64114035e-12 4.21358564e-12
   1.56727788e-12]
  [1.15143647e-15 1.00000000e+00 1.49059746e-16 1.09817208e-15
   1.54107374e-16]
  [1.77865219e-03 9.98221338e-01 1.75806328e-10 2.89148844e-10
   2.12860812e-10]
  ...
  [4.51001156e-08 1.00000000e+00 8.21518905e-13 2.33661441e-12
   8.08800943e-13]
  [1.42524973e-01 8.57475042e-01 1.38913436e-09 1.74806036e-09
   1.49296386e-09]
  [5.51358461e-01 4.48641509e-01 1.92041361e-09 2.14215556e-09
   1.95315009e-09]]

 [[7.28374948e-14 1.00000000e+00 1.10295389e-15 5.75585400e-15
   9.02208991e-16]
  [1.62186210e-13 1.00000000e+00 1.73941826e-15 9.80898204e-15
   1.76166166e-15]
  [8.79209343e-19 1.00000000e+00 4.33573336e-18 4.67288919e-17
   4.65122542e-18]
  ...
  [5.48206925e-01 4.51793075e-01 1.91602889e-09 2.13572848e-09
   1.93364746e-09]
  [2.45961562e-08 1.00000000e+00 6.09432968e-13 1.79339052e-12
   6.03167527e-13]
  [2.35147059e-01 7.64852941e-01 1.67837766e-09 2.03863015e-09
   1.78478454e-09]]

 ...

 [[1.19056806e-01 8.80943179e-01 1.25212918e-09 1.57566449e-09
   1.31764732e-09]
  [1.14896242e-14 1.00000000e+00 4.56607192e-16 2.94836033e-15
   4.61867955e-16]
  [4.82649645e-20 1.00000000e+00 1.03600918e-18 1.27645433e-17
   1.11770020e-18]
  ...
  [1.17764868e-17 1.00000000e+00 1.57647539e-17 1.50705823e-16
   1.76438353e-17]
  [7.49747244e-07 9.99999285e-01 3.82829489e-12 9.82968568e-12
   5.15551447e-12]
  [2.06312299e-01 7.93687761e-01 1.58868663e-09 1.94269023e-09
   1.67212166e-09]]

 [[2.82415740e-11 1.00000000e+00 2.10655264e-14 8.30150225e-14
   1.77903872e-14]
  [6.06256479e-04 9.99393702e-01 1.00906519e-10 1.75050585e-10
   1.19820320e-10]
  [7.16208339e-01 2.83791661e-01 1.73985815e-09 1.86424343e-09
   1.75710968e-09]
  ...
  [5.91389760e-02 9.40861046e-01 9.46073553e-10 1.26046140e-09
   1.04144138e-09]
  [7.00183213e-01 2.99816817e-01 1.76621184e-09 1.89984095e-09
   1.78102877e-09]
  [5.16168832e-08 1.00000000e+00 8.81393049e-13 2.48906429e-12
   8.73597093e-13]]

 [[1.64658704e-08 1.00000000e+00 5.00089228e-13 1.44619527e-12
   4.59415600e-13]
  [2.86166294e-04 9.99713838e-01 6.88608406e-11 1.23987931e-10
   7.96298791e-11]
  [1.20986929e-10 1.00000000e+00 4.48141788e-14 1.77999000e-13
   4.60348685e-14]
  ...
  [5.72531007e-06 9.99994278e-01 1.03548732e-11 2.36599022e-11
   1.34277563e-11]
  [1.27927167e-02 9.87207234e-01 4.44379367e-10 6.43021247e-10
   4.80027906e-10]
  [1.86958912e-12 1.00000000e+00 5.63273861e-15 2.79297612e-14
   5.58847775e-15]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[3.7195832e-12 1.0000000e+00 7.7122392e-15 3.3463145e-14 6.4068060e-15]
 [1.7741951e-04 9.9982256e-01 5.4659288e-11 1.0146793e-10 6.4669894e-11]
 [4.9770966e-01 5.0229037e-01 1.9408795e-09 2.1953022e-09 1.9986739e-09]
 ...
 [5.7253101e-06 9.9999428e-01 1.0354873e-11 2.3659902e-11 1.3427756e-11]
 [1.2792717e-02 9.8720723e-01 4.4437937e-10 6.4302125e-10 4.8002791e-10]
 [1.8695891e-12 1.0000000e+00 5.6327386e-15 2.7929761e-14 5.5884777e-15]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  5.989350886535645
tp :  36407.0
fp :  63593.0
tn :  336407.0
fn :  63593.0
accuracy :  0.7456303834915161
precision :  0.36406999826431274
recall :  0.36406999826431274
auc :  0.6752647757530212

y_eval {0: 85112, 1: 14888}
pred {0: 21519, 1: 78481}
[INFO] confusion matrix for file 
[[21519 63593     0     0     0]
 [    0 14888     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1386904 5125634       0       0       0]
 [  48597  581011       0       0       0]
 [  27826   81871       0       0       0]
 [      0   45355       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0388432e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0388432e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.0388432e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 ...
 [-3.4623763e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4623763e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4623763e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[2.81114090e-11 1.00000000e+00 2.10172066e-14 8.28432443e-14
   1.77488351e-14]
  [1.27750237e-16 1.00000000e+00 5.05687868e-17 4.15484007e-16
   5.24371893e-17]
  [1.11714966e-04 9.99888301e-01 4.48958197e-11 8.64338809e-11
   5.70682078e-11]
  ...
  [2.32586381e-11 1.00000000e+00 2.03014553e-14 8.89249679e-14
   2.14159609e-14]
  [9.62547958e-02 9.03745174e-01 1.18030685e-09 1.52694701e-09
   1.28996969e-09]
  [6.53540671e-01 3.46459359e-01 1.83437110e-09 1.99651895e-09
   1.84960114e-09]]

 [[7.68997590e-04 9.99230981e-01 1.06962321e-10 1.77271045e-10
   1.10221360e-10]
  [1.51623317e-04 9.99848366e-01 4.88830018e-11 9.02611527e-11
   5.35677960e-11]
  [2.54350208e-12 1.00000000e+00 6.63314084e-15 3.24818772e-14
   6.76115590e-15]
  ...
  [3.79148722e-01 6.20851278e-01 1.86967375e-09 2.16548668e-09
   1.89865679e-09]
  [6.53419197e-01 3.46580803e-01 1.83321536e-09 1.99474726e-09
   1.84873905e-09]
  [7.34316230e-01 2.65683740e-01 1.69901226e-09 1.80894788e-09
   1.70360726e-09]]

 [[2.17470139e-12 1.00000000e+00 5.91259236e-15 2.63141119e-14
   4.89589956e-15]
  [6.64420426e-16 1.00000000e+00 1.14352611e-16 8.61488464e-16
   1.17645941e-16]
  [7.84422483e-20 1.00000000e+00 1.31783706e-18 1.58572757e-17
   1.42551964e-18]
  ...
  [7.36292720e-01 2.63707310e-01 1.69530345e-09 1.80402526e-09
   1.69927561e-09]
  [6.27442181e-01 3.72557819e-01 1.86060378e-09 2.03628336e-09
   1.87153759e-09]
  [1.55928049e-07 9.99999881e-01 1.52696497e-12 4.06158267e-12
   1.52873677e-12]]

 ...

 [[5.38276508e-02 9.46172357e-01 8.69477268e-10 1.14340992e-09
   8.98339403e-10]
  [1.92071429e-14 1.00000000e+00 5.86559252e-16 3.67952595e-15
   5.85707348e-16]
  [1.45424281e-06 9.99998569e-01 5.21937788e-12 1.28102954e-11
   6.89481068e-12]
  ...
  [1.74042985e-01 8.25957060e-01 1.46617707e-09 1.80422666e-09
   1.51514978e-09]
  [4.21439111e-01 5.78560948e-01 1.90741423e-09 2.19012541e-09
   1.94739558e-09]
  [2.20301717e-06 9.99997854e-01 5.74864245e-12 1.32564654e-11
   5.88771783e-12]]

 [[7.38449490e-14 1.00000000e+00 1.11055337e-15 5.79361134e-15
   9.09014583e-16]
  [4.37460206e-02 9.56254005e-01 8.22300339e-10 1.11793919e-09
   9.21210330e-10]
  [3.08128804e-01 6.91871226e-01 1.78773651e-09 2.11237472e-09
   1.85621651e-09]
  ...
  [3.48696005e-09 1.00000000e+00 2.30397488e-13 7.53169608e-13
   2.23736502e-13]
  [8.22766102e-04 9.99177158e-01 1.18321283e-10 2.02019332e-10
   1.39829578e-10]
  [3.46482843e-02 9.65351701e-01 7.16168402e-10 9.76393078e-10
   7.60964125e-10]]

 [[8.18346172e-12 1.00000000e+00 1.13982547e-14 4.76473380e-14
   9.52454329e-15]
  [2.96896801e-16 1.00000000e+00 7.67478289e-17 6.03389849e-16
   7.92819927e-17]
  [2.46518198e-07 9.99999762e-01 2.14827049e-12 5.79563047e-12
   2.78193029e-12]
  ...
  [6.10020220e-01 3.89979780e-01 1.88678650e-09 2.07796047e-09
   1.92018712e-09]
  [7.03293681e-01 2.96706289e-01 1.75703863e-09 1.88647320e-09
   1.76121251e-09]
  [7.70462215e-01 2.29537740e-01 1.61626423e-09 1.70178371e-09
   1.61533042e-09]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[2.81114090e-11 1.00000000e+00 2.10172066e-14 8.28432443e-14
  1.77488351e-14]
 [1.27750237e-16 1.00000000e+00 5.05687868e-17 4.15484007e-16
  5.24371893e-17]
 [1.11714966e-04 9.99888301e-01 4.48958197e-11 8.64338809e-11
  5.70682078e-11]
 ...
 [6.10020220e-01 3.89979780e-01 1.88678650e-09 2.07796047e-09
  1.92018712e-09]
 [7.03293681e-01 2.96706289e-01 1.75703863e-09 1.88647320e-09
  1.76121251e-09]
 [7.70462215e-01 2.29537740e-01 1.61626423e-09 1.70178371e-09
  1.61533042e-09]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  8.430076187133789
tp :  19806.0
fp :  80194.0
tn :  319806.0
fn :  80194.0
accuracy :  0.6792271733283997
precision :  0.19806000590324402
recall :  0.19806000590324402
auc :  0.5619837045669556

y_eval {0: 100000}
pred {0: 19806, 1: 80194}
[INFO] confusion matrix for file 
[[19806 80194     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1406710 5205828       0       0       0]
 [  48597  581011       0       0       0]
 [  27826   81871       0       0       0]
 [      0   45355       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4623763e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-3.4623763e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-3.4623763e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 3.4890494e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4890494e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 3.4890494e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.31271797e-14 1.00000000e+00 1.24527989e-15 6.42469662e-15
   1.01908546e-15]
  [3.39062681e-04 9.99660969e-01 7.50662379e-11 1.34153036e-10
   8.59375626e-11]
  [2.41136067e-02 9.75886345e-01 6.01861339e-10 8.38221215e-10
   6.50996923e-10]
  ...
  [1.32149282e-07 9.99999881e-01 1.63178585e-12 4.62907794e-12
   2.27429924e-12]
  [1.35069698e-01 8.64930332e-01 1.34859446e-09 1.69922543e-09
   1.43457779e-09]
  [2.96142817e-01 7.03857183e-01 1.76432235e-09 2.08779660e-09
   1.79993742e-09]]

 [[4.79596853e-01 5.20403147e-01 1.92504501e-09 2.17764540e-09
   1.97482009e-09]
  [5.10182679e-01 4.89817381e-01 1.93083971e-09 2.17346163e-09
   1.97630023e-09]
  [1.26820996e-01 8.73179018e-01 1.28517808e-09 1.61327551e-09
   1.32888822e-09]
  ...
  [1.89652666e-01 8.10347378e-01 1.55263657e-09 1.91436356e-09
   1.65734093e-09]
  [7.78693616e-01 2.21306413e-01 1.59666236e-09 1.67738434e-09
   1.59836877e-09]
  [1.81675297e-09 1.00000000e+00 1.66927792e-13 5.65304314e-13
   1.61469498e-13]]

 [[1.87537430e-09 1.00000000e+00 1.69471154e-13 5.45376027e-13
   1.50603759e-13]
  [1.34263487e-07 9.99999881e-01 1.51174798e-12 4.13345877e-12
   1.68670839e-12]
  [7.34257588e-09 1.00000000e+00 3.52284472e-13 1.12870661e-12
   3.86458172e-13]
  ...
  [4.23489511e-01 5.76510489e-01 1.93738381e-09 2.23496510e-09
   2.01838346e-09]
  [2.32220607e-08 1.00000000e+00 5.91995528e-13 1.74704836e-12
   5.74616309e-13]
  [1.39514043e-04 9.99860525e-01 4.88759484e-11 9.20488269e-11
   5.83954066e-11]]

 ...

 [[3.78213461e-10 1.00000000e+00 7.64173880e-14 2.65820894e-13
   6.64300700e-14]
  [1.54929450e-02 9.84507084e-01 4.97375752e-10 7.16140425e-10
   5.61844626e-10]
  [3.62984356e-05 9.99963641e-01 2.35278654e-11 4.68044041e-11
   2.53804616e-11]
  ...
  [2.12522018e-08 1.00000000e+00 5.81088183e-13 1.74090126e-12
   6.02180090e-13]
  [2.26632997e-01 7.73366988e-01 1.65387637e-09 2.01291606e-09
   1.75579717e-09]
  [7.55693197e-01 2.44306788e-01 1.65318059e-09 1.74943027e-09
   1.65759462e-09]]

 [[3.72683051e-10 1.00000000e+00 7.58598777e-14 2.64069907e-13
   6.59329769e-14]
  [1.52399251e-02 9.84760106e-01 4.93406982e-10 7.11108006e-10
   5.57518753e-10]
  [1.59604102e-01 8.40395868e-01 1.42095380e-09 1.76178006e-09
   1.49196144e-09]
  ...
  [2.78672796e-05 9.99972105e-01 2.28780692e-11 4.79634769e-11
   2.97469133e-11]
  [6.96642787e-12 1.00000000e+00 1.09221087e-14 5.07532283e-14
   1.11639002e-14]
  [1.39949475e-06 9.99998569e-01 5.06346657e-12 1.24111216e-11
   6.40165178e-12]]

 [[8.69079009e-02 9.13092077e-01 1.08871423e-09 1.39593570e-09
   1.14501542e-09]
  [3.96315455e-01 6.03684485e-01 1.89670613e-09 2.19347140e-09
   1.96139061e-09]
  [1.14677995e-01 8.85321975e-01 1.23122579e-09 1.55586910e-09
   1.27692146e-09]
  ...
  [1.26957013e-06 9.99998689e-01 4.43906804e-12 1.06032093e-11
   4.64950387e-12]
  [4.05556858e-01 5.94443142e-01 1.92215199e-09 2.22552465e-09
   2.00113259e-09]
  [2.83601409e-09 1.00000000e+00 2.08837518e-13 6.91695887e-13
   2.02461691e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.3127180e-14 1.0000000e+00 1.2452799e-15 6.4246966e-15 1.0190855e-15]
 [3.3906268e-04 9.9966097e-01 7.5066238e-11 1.3415304e-10 8.5937563e-11]
 [2.4113607e-02 9.7588634e-01 6.0186134e-10 8.3822121e-10 6.5099692e-10]
 ...
 [1.2695701e-06 9.9999869e-01 4.4390680e-12 1.0603209e-11 4.6495039e-12]
 [4.0555686e-01 5.9444314e-01 1.9221520e-09 2.2255247e-09 2.0011326e-09]
 [2.8360141e-09 1.0000000e+00 2.0883752e-13 6.9169589e-13 2.0246169e-13]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 1 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.395946430969238
tp :  19006.0
fp :  80994.0
tn :  319006.0
fn :  80994.0
accuracy :  0.6760271787643433
precision :  0.19006000459194183
recall :  0.19006000459194183
auc :  0.558661699295044

y_eval {0: 100000}
pred {0: 19006, 1: 80994}
[INFO] confusion matrix for file 
[[19006 80994     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1425716 5286822       0       0       0]
 [  48597  581011       0       0       0]
 [  27826   81871       0       0       0]
 [      0   45355       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4890494e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4890494e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 3.4890494e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 1.0389735e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.0389735e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.0389735e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[7.81718162e-11 1.00000000e+00 3.49172290e-14 1.31070868e-13
   2.98055139e-14]
  [1.75820768e-03 9.98241782e-01 1.70856454e-10 2.78964546e-10
   2.00234343e-10]
  [6.10189021e-01 3.89810920e-01 1.88544469e-09 2.07609085e-09
   1.92039251e-09]
  ...
  [3.03095305e-07 9.99999642e-01 2.30053671e-12 6.05879539e-12
   2.64077519e-12]
  [4.77146924e-01 5.22853076e-01 1.94999861e-09 2.21998775e-09
   2.01909467e-09]
  [7.30141819e-01 2.69858181e-01 1.70763481e-09 1.82025539e-09
   1.71076120e-09]]

 [[1.81589276e-03 9.98184025e-01 1.64502842e-10 2.60785837e-10
   1.71843997e-10]
  [3.17197730e-04 9.99682784e-01 7.05085712e-11 1.24946248e-10
   7.71179301e-11]
  [4.42654043e-02 9.55734611e-01 8.06829714e-10 1.08518228e-09
   8.61850813e-10]
  ...
  [1.90496780e-02 9.80950296e-01 5.45784862e-10 7.74664000e-10
   6.00663519e-10]
  [7.13041842e-01 2.86958158e-01 1.74452319e-09 1.87036897e-09
   1.76023573e-09]
  [8.57118517e-02 9.14288104e-01 1.07873521e-09 1.38572320e-09
   1.10752707e-09]]

 [[8.62615643e-14 1.00000000e+00 1.19914200e-15 6.21037611e-15
   9.81717539e-16]
  [7.24158777e-09 1.00000000e+00 3.51284052e-13 1.11850980e-12
   3.57987105e-13]
  [3.54267577e-05 9.99964595e-01 2.42378687e-11 4.88540042e-11
   2.76845283e-11]
  ...
  [7.42393076e-01 2.57606953e-01 1.68081160e-09 1.78468484e-09
   1.68006153e-09]
  [9.38969254e-02 9.06103075e-01 1.12427367e-09 1.43651502e-09
   1.15765009e-09]
  [7.47537315e-01 2.52462745e-01 1.67277259e-09 1.77483506e-09
   1.67929382e-09]]

 ...

 [[2.88369856e-03 9.97116327e-01 2.06222581e-10 3.17357945e-10
   2.07975637e-10]
  [1.59434549e-07 9.99999881e-01 1.58049246e-12 4.21592492e-12
   1.61278109e-12]
  [5.01421094e-01 4.98578906e-01 1.95210603e-09 2.20948748e-09
   2.01670947e-09]
  ...
  [2.38834424e-10 1.00000000e+00 6.94058526e-14 2.76722818e-13
   9.47103453e-14]
  [1.64478105e-13 1.00000000e+00 1.75308747e-15 1.01168395e-14
   1.90370634e-15]
  [3.78451603e-10 1.00000000e+00 8.59262477e-14 3.31886265e-13
   1.11202124e-13]]

 [[2.19168115e-07 9.99999762e-01 1.81903472e-12 4.62238060e-12
   1.74358249e-12]
  [1.62735989e-03 9.98372614e-01 1.62628522e-10 2.65365424e-10
   1.84712273e-10]
  [7.77655303e-01 2.22344756e-01 1.60111324e-09 1.68323477e-09
   1.60542490e-09]
  ...
  [1.96636975e-04 9.99803364e-01 5.73454027e-11 1.05502704e-10
   6.57770505e-11]
  [6.75800663e-07 9.99999285e-01 3.27593204e-12 8.13142609e-12
   3.43814734e-12]
  [2.73436042e-15 1.00000000e+00 2.29311195e-16 1.63619036e-15
   2.43338113e-16]]

 [[2.10174471e-06 9.99997854e-01 5.60484948e-12 1.26445590e-11
   5.44159466e-12]
  [6.57495437e-03 9.93425012e-01 3.23130273e-10 4.86504781e-10
   3.60235286e-10]
  [2.15670779e-01 7.84329236e-01 1.59727698e-09 1.94042493e-09
   1.66852554e-09]
  ...
  [7.75638282e-01 2.24361703e-01 1.60447100e-09 1.68722492e-09
   1.60630509e-09]
  [6.52680635e-01 3.47319394e-01 1.83134585e-09 1.99173655e-09
   1.83867122e-09]
  [7.52557635e-01 2.47442320e-01 1.65869229e-09 1.75603987e-09
   1.65890113e-09]]]Using TensorFlow backend.
 (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[7.8171816e-11 1.0000000e+00 3.4917229e-14 1.3107087e-13 2.9805514e-14]
 [1.7582077e-03 9.9824178e-01 1.7085645e-10 2.7896455e-10 2.0023434e-10]
 [6.1018902e-01 3.8981092e-01 1.8854447e-09 2.0760909e-09 1.9203925e-09]
 ...
 [7.7563828e-01 2.2436170e-01 1.6044710e-09 1.6872249e-09 1.6063051e-09]
 [6.5268064e-01 3.4731939e-01 1.8313459e-09 1.9917366e-09 1.8386712e-09]
 [7.5255764e-01 2.4744232e-01 1.6586923e-09 1.7560399e-09 1.6589011e-09]] (100000, 5)
pred 3 (argmax) [1 1 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  8.337738000488281
tp :  19579.0
fp :  80421.0
tn :  319579.0
fn :  80421.0
accuracy :  0.6783192157745361
precision :  0.19578999280929565
recall :  0.19578999280929565
auc :  0.5549733638763428

y_eval {0: 100000}
pred {0: 19579, 1: 80421}
[INFO] confusion matrix for file 
[[19579 80421     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1445295 5367243       0       0       0]
 [  48597  581011       0       0       0]
 [  27826   81871       0       0       0]
 [      0   45355       0       0       0]
 [  50398  152404       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0389735e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0389735e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0389735e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [ 1.7315791e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.7315791e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.7315791e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 5)             440       
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 10)            640       
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 5)             320       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 5)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             30        
=================================================================
Total params: 1,430
Trainable params: 1,430
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[1.26061106e-10 1.00000000e+00 4.42657250e-14 1.62353963e-13
   3.79627089e-14]
  [1.13121303e-16 1.00000000e+00 4.75982158e-17 3.93953515e-16
   4.94765676e-17]
  [3.46282421e-15 1.00000000e+00 2.65892007e-16 1.88608339e-15
   3.11534721e-16]
  ...
  [5.98722875e-01 4.01277155e-01 1.89656557e-09 2.09393192e-09
   1.92879601e-09]
  [7.75133014e-01 2.24867016e-01 1.60475366e-09 1.68737735e-09
   1.60509650e-09]
  [1.43488437e-01 8.56511593e-01 1.35099887e-09 1.68104375e-09
   1.38683798e-09]]

 [[1.02438335e-13 1.00000000e+00 1.30538577e-15 6.70656971e-15
   1.06901551e-15]
  [1.15583452e-06 9.99998808e-01 4.40702726e-12 1.06970578e-11
   4.75204468e-12]
  [2.21796289e-01 7.78203726e-01 1.63105074e-09 1.98370831e-09
   1.72585735e-09]
  ...
  [2.64056553e-07 9.99999762e-01 2.11711182e-12 5.59923982e-12
   2.37226948e-12]
  [2.50335597e-03 9.97496665e-01 2.00400738e-10 3.18842563e-10
   2.22540861e-10]
  [7.20840335e-01 2.79159695e-01 1.73078207e-09 1.85168736e-09
   1.74423020e-09]]

 [[1.88460567e-11 1.00000000e+00 1.72361955e-14 6.92186515e-14
   1.44940263e-14]
  [3.68720182e-04 9.99631286e-01 7.85514084e-11 1.39884854e-10
   9.24418458e-11]
  [7.17467844e-01 2.82532215e-01 1.73753723e-09 1.86090821e-09
   1.75411341e-09]
  ...
  [1.94311971e-12 1.00000000e+00 6.31920629e-15 3.26359525e-14
   8.45180740e-15]
  [4.99039438e-12 1.00000000e+00 9.65340919e-15 4.65840880e-14
   1.08716442e-14]
  [7.91858286e-02 9.20814157e-01 1.08283327e-09 1.41847656e-09
   1.18890597e-09]]

 ...

 [[1.08895758e-04 9.99891043e-01 4.02139225e-11 7.37762074e-11
   4.04008944e-11]
  [8.77116397e-02 9.12288308e-01 1.11477105e-09 1.44218082e-09
   1.20348953e-09]
  [8.33149076e-01 1.66850954e-01 1.43106205e-09 1.47325652e-09
   1.42292123e-09]
  ...
  [1.52756395e-02 9.84724402e-01 4.73345085e-10 6.71892153e-10
   4.91934493e-10]
  [6.81241800e-04 9.99318719e-01 1.02067479e-10 1.72783191e-10
   1.08795223e-10]
  [9.05366335e-03 9.90946293e-01 3.73197778e-10 5.49714718e-10
   4.03247574e-10]]

 [[1.50334267e-13 1.00000000e+00 1.57773428e-15 7.96172769e-15
   1.29306970e-15]
  [1.94672793e-06 9.99998093e-01 5.71829693e-12 1.35038326e-11
   6.23675027e-12]
  [5.35004475e-15 1.00000000e+00 3.16796993e-16 2.16721151e-15
   3.27934735e-16]
  ...
  [7.68872857e-01 2.31127128e-01 1.62026859e-09 1.70701209e-09
   1.62063951e-09]
  [3.22786183e-03 9.96772110e-01 2.18232377e-10 3.37214145e-10
   2.26568542e-10]
  [1.76187456e-02 9.82381284e-01 5.15489817e-10 7.30091987e-10
   5.50232637e-10]]

 [[2.07330331e-01 7.92669713e-01 1.55891000e-09 1.88375382e-09
   1.57336488e-09]
  [6.35528743e-01 3.64471227e-01 1.85729909e-09 2.03093431e-09
   1.88959026e-09]
  [1.91909049e-08 1.00000000e+00 5.39414054e-13 1.60927218e-12
   5.35592079e-13]
  ...
  [6.68394446e-01 3.31605494e-01 1.81974791e-09 1.97477878e-09
   1.84150406e-09]
  [1.32710696e-03 9.98672962e-01 1.40412029e-10 2.27995567e-10
   1.46353929e-10]
  [6.20333198e-03 9.93796706e-01 3.09007236e-10 4.64362604e-10
   3.32465583e-10]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[1.2606111e-10 1.0000000e+00 4.4265725e-14 1.6235396e-13 3.7962709e-14]
 [1.1312130e-16 1.0000000e+00 4.7598216e-17 3.9395351e-16 4.9476568e-17]
 [3.4628242e-15 1.0000000e+00 2.6589201e-16 1.8860834e-15 3.1153472e-16]
 ...
 [6.6839445e-01 3.3160549e-01 1.8197479e-09 1.9747788e-09 1.8415041e-09]
 [1.3271070e-03 9.9867296e-01 1.4041203e-10 2.2799557e-10 1.4635393e-10]
 [6.2033320e-03 9.9379671e-01 3.0900724e-10 4.6436260e-10 3.3246558e-10]] (100000, 5)
pred 3 (argmax) [1 1 1 ... 0 1 1] (100000,)
[33m[INFO] metrics:[0m
loss :  8.149273825073243
tp :  20619.0
fp :  79381.0
tn :  320619.0
fn :  79381.0
accuracy :  0.6824790835380554
precision :  0.20619000494480133
recall :  0.20619000494480133
auc :  0.5549266934394836

y_eval {0: 100000}
pred {0: 20619, 1: 79381}
[INFO] confusion matrix for file 
[[20619 79381     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1465914 5446624       0       0       0]
 [  48597  581011       0       0       0]
 [  27826   81871       0       0       0]
 [      0   45355       0       0       0]
 [  50398  152404       0       0       0]]
