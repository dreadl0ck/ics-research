2020-02-02 05:05:17.963188: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-02-02 05:05:17.976478: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fef1d0da930 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-02-02 05:05:17.976506: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-02-02 05:05:22.033760: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-02 05:05:22.058004: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 05:05:22.069033: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 05:05:22.166421: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-02 05:05:22.173891: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-02 05:05:22.181475: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 05:05:22.188958: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 05:05:22.221479: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-02 05:05:26.398733: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-02 05:05:26.404825: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 05:05:26.407629: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 05:05:26.433669: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-02 05:05:26.435711: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-02 05:05:26.437887: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 05:05:26.440071: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 05:05:26.450744: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
Date: 2020-02-02 05:05:17.956271
[INFO] input_shape (10, 16)
[INFO] LSTM first and last layer neurons: 15
adding core layer 0
[INFO] created DNN
[33m[INFO] epoch 1/10[0m
[33m[INFO] loading file 1-1/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1356 (0.2712%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** i/f_name:[2:99.9988%,3:0.0012%]
[INFO] ** i/f_dir:[1:99.9988%,0:0.0012%]
[INFO] ** src:[22:38.4088%,9:25.8982%,7:18.1636%,1:17.5218%,11:0.0014%,10:0.0014%,14:0.0012%,3:0.001%,2:0.001%,21:0.0006%,15:0.0004%,4:0.0004%,8:0.0002%]
[INFO] ** dst:[21:43.266%,10:21.0416%,8:18.1634%,9:17.5214%,6:0.0016%,16:0.0012%,15:0.0012%,22:0.001%,18:0.0006%,26:0.0004%,25:0.0004%,19:0.0004%,17:0.0004%,24:0.0002%,7:0.0002%]
[INFO] ** proto:[0:99.996%,2:0.0028%,1:0.0012%]
[INFO] ** appi_name:[21:99.9928%,30:0.0012%,22:0.001%,17:0.0008%,31:0.0006%,26:0.0006%,7:0.0006%,23:0.0004%,18:0.0004%,0:0.0004%,28:0.0002%,27:0.0002%,24:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.4088%,20:25.8982%,13:18.1636%,6:17.5218%,11:0.0014%,10:0.0014%,17:0.0012%,14:0.001%,1:0.001%,7:0.0006%,21:0.0004%,16:0.0004%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9928%,-33.760870000000004:0.007%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9974%,11:49.9954%,0:0.007%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:25.8976%,1:21.0406%,5:18.163%,4:17.521%,2:17.3678%,0:0.01%]
[INFO] ** service:[0.0048200000000000005:99.9936%,-211.73542999999998:0.0012%,-211.08818:0.001%,-205.44247:0.0008%,-211.07873999999998:0.0008%,-211.09762999999998:0.0006%,-211.08346:0.0006%,-186.43601999999998:0.0006%,-186.44547:0.0004%,-185.9872:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:25.8978%,-0.32151:21.0408%,-1.27613:18.1632%,-0.23351:17.5212%,-0.33484:17.368%,-71.33197:0.0012%,-71.14931:0.001%,-2.1481:0.0008%,-0.24151:0.0006%,-71.14798:0.0006%,-2.42942:0.0004%,4.44364:0.0004%,-1.02014:0.0004%,-64.19493:0.0004%,-5.1466400000000005:0.0002%,-1.2708:0.0002%,-58.035180000000004:0.0002%,4.076980000000001:0.0002%,-5.08665:0.0002%,1.47576:0.0002%,1.46509:0.0002%,4.29964:0.0002%,14.253910000000001:0.0002%,-68.79874000000001:0.0002%,6.1115699999999995:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,10.67005:0.0002%,-1.27347:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** classification:[normal:79.2972%,Single Stage Single Point:20.7028%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.2137 - tp: 69738.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 10262.0000 - accuracy: 0.9743 - precision: 1.0000 - recall: 0.8717 - auc: 1.0000 - val_loss: 0.0118 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0060 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0034 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0251 - tp: 79766.0000 - fp: 234.0000 - tn: 319766.0000 - fn: 234.0000 - accuracy: 0.9988 - precision: 0.9971 - recall: 0.9971 - auc: 0.9982 - val_loss: 3.1926 - val_tp: 10606.0000 - val_fp: 9394.0000 - val_tn: 70606.0000 - val_fn: 9394.0000 - val_accuracy: 0.8121 - val_precision: 0.5303 - val_recall: 0.5303 - val_auc: 0.7230
[INFO] saving weights to checkpoints/lstm-epoch-1-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.8611 - tp: 48046.0000 - fp: 27747.0000 - tn: 292253.0000 - fn: 31954.0000 - accuracy: 0.8507 - precision: 0.6339 - recall: 0.6006 - auc: 0.9069 - val_loss: 0.4272 - val_tp: 19732.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 268.0000 - val_accuracy: 0.9973 - val_precision: 0.9999 - val_recall: 0.9866 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1408 - tp: 79969.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 31.0000 - accuracy: 0.9999 - precision: 1.0000 - recall: 0.9996 - auc: 1.0000 - val_loss: 0.0468 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-0-1-batch-400000-500000
[33m[INFO] loading file 2-2/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1359 (0.2718%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9996%,3:0.0004%]
[INFO] ** i/f_dir:[1:99.9996%,0:0.0004%]
[INFO] ** src:[22:38.3832%,9:25.9606%,7:18.1352%,1:17.52%,14:0.0004%,3:0.0004%,15:0.0002%]
[INFO] ** dst:[21:43.3108%,10:21.0326%,8:18.135%,9:17.5198%,22:0.0008%,15:0.0004%,2:0.0004%,24:0.0002%]
[INFO] ** proto:[0:99.9996%,1:0.0004%]
[INFO] ** appi_name:[21:99.9992%,30:0.0004%,8:0.0002%,7:0.0002%]
[INFO] ** proxy_src_ip:[18:38.3832%,20:25.9606%,13:18.1352%,6:17.52%,17:0.0004%,1:0.0004%,16:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9992%,-33.760870000000004:0.0008%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.9992%,0:0.0008%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:25.9596%,1:21.0326%,5:18.1348%,4:17.5194%,2:17.3504%,0:0.0032%]
[INFO] ** service:[0.0048200000000000005:99.9992%,-211.73542999999998:0.0004%,-211.09762999999998:0.0002%,-211.35747999999998:0.0002%]
[INFO] ** s_port:[1.45442:25.96%,-0.32151:21.0326%,-1.27613:18.1348%,-0.23351:17.5196%,-0.33484:17.3506%,1.45709:0.0004%,-71.33197:0.0004%,-1.27347:0.0002%,-0.24950999999999998:0.0002%,-3.3787199999999995:0.0002%,1.47576:0.0002%,12.60597:0.0002%,-0.24151:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:72.7902%,Single Stage Single Point:27.2098%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0307 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0208 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3408 - tp: 66607.0000 - fp: 13324.0000 - tn: 306676.0000 - fn: 13393.0000 - accuracy: 0.9332 - precision: 0.8333 - recall: 0.8326 - auc: 0.9815 - val_loss: 0.2131 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2499 - tp: 72432.0000 - fp: 7568.0000 - tn: 312432.0000 - fn: 7568.0000 - accuracy: 0.9622 - precision: 0.9054 - recall: 0.9054 - auc: 0.9876 - val_loss: 0.7843 - val_tp: 10593.0000 - val_fp: 9407.0000 - val_tn: 70593.0000 - val_fn: 9407.0000 - val_accuracy: 0.8119 - val_precision: 0.5296 - val_recall: 0.5296 - val_auc: 0.9447
[INFO] saving weights to checkpoints/lstm-epoch-1-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0398 - tp: 79182.0000 - fp: 818.0000 - tn: 319182.0000 - fn: 818.0000 - accuracy: 0.9959 - precision: 0.9898 - recall: 0.9898 - auc: 0.9999 - val_loss: 0.0150 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3858 - tp: 65685.0000 - fp: 14293.0000 - tn: 305707.0000 - fn: 14315.0000 - accuracy: 0.9285 - precision: 0.8213 - recall: 0.8211 - auc: 0.9780 - val_loss: 0.1966 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-1-2-batch-400000-500000
[33m[INFO] loading file 3-3/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1357 (0.2714%)
[INFO] ** orig:[0:99.9988%,2:0.0012%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** i/f_name:[2:99.9984%,3:0.0016%]
[INFO] ** i/f_dir:[1:99.9984%,0:0.0016%]
[INFO] ** src:[22:38.418%,9:25.9724%,7:18.1538%,1:17.4466%,21:0.0022%,3:0.0018%,2:0.0014%,11:0.0008%,10:0.0008%,4:0.0008%,14:0.0004%,8:0.0004%,17:0.0002%,15:0.0002%,13:0.0002%]
[INFO] ** dst:[21:43.3012%,10:21.0888%,8:18.1536%,9:17.4462%,6:0.0024%,15:0.0016%,18:0.0014%,16:0.0014%,22:0.001%,2:0.0004%,7:0.0004%,25:0.0004%,17:0.0004%,12:0.0002%,24:0.0002%,19:0.0002%,0:0.0002%]
[INFO] ** proto:[0:99.9936%,2:0.0048%,1:0.0016%]
[INFO] ** appi_name:[21:99.9908%,30:0.0024%,22:0.0012%,31:0.001%,26:0.001%,17:0.001%,7:0.0008%,27:0.0004%,0:0.0004%,28:0.0002%,23:0.0002%,15:0.0002%,8:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.418%,20:25.9724%,13:18.1538%,6:17.4466%,17:0.0024%,1:0.0016%,14:0.0014%,7:0.001%,11:0.0008%,10:0.0008%,21:0.0006%,16:0.0002%,15:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9908%,-33.760870000000004:0.009%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9962%,11:49.9946%,0:0.009%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:25.9712%,1:21.0884%,5:18.153%,4:17.4458%,2:17.3292%,0:0.0124%]
[INFO] ** service:[0.0048200000000000005:99.991%,-211.73542999999998:0.0016%,-186.43601999999998:0.0014%,-211.08346:0.0012%,-211.08818:0.0012%,-205.44247:0.001%,-211.09762999999998:0.0008%,-186.44547:0.0004%,-202.75898:0.0004%,-183.8612:0.0002%,-185.9872:0.0002%,-201.23771000000002:0.0002%,-211.35747999999998:0.0002%,-211.07873999999998:0.0002%]
[INFO] ** s_port:[1.45442:25.9716%,-0.32151:21.0886%,-1.27613:18.1532%,-0.23351:17.446%,-0.33484:17.3294%,-71.33197:0.0016%,-71.14798:0.0012%,-71.14931:0.0012%,-64.19493:0.0004%,-0.08551:0.0004%,1.45709:0.0004%,-0.24151:0.0004%,13.431270000000001:0.0002%,14.4699:0.0002%,4.076980000000001:0.0002%,-5.1466400000000005:0.0002%,-1.02014:0.0002%,1.47576:0.0002%,-1.2708:0.0002%,-58.035180000000004:0.0002%,-58.032509999999995:0.0002%,12.60597:0.0002%,-5.08665:0.0002%,1.46509:0.0002%,-2.1481:0.0002%,-1.27347:0.0002%,10.67005:0.0002%,-43.76509:0.0002%,2.05573:0.0002%,6.1115699999999995:0.0002%,4.44364:0.0002%,13.86459:0.0002%,4.29964:0.0002%,-0.24950999999999998:0.0002%,-3.3787199999999995:0.0002%,10.192739999999999:0.0002%,-68.79874000000001:0.0002%,14.253910000000001:0.0002%,4.90362:0.0002%,-68.36943000000001:0.0002%]
[INFO] ** classification:[normal:86.7116%,Single Stage Single Point:13.2884%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1421 - tp: 76672.0000 - fp: 3317.0000 - tn: 316683.0000 - fn: 3328.0000 - accuracy: 0.9834 - precision: 0.9585 - recall: 0.9584 - auc: 0.9957 - val_loss: 0.0444 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3320 - tp: 64563.0000 - fp: 15403.0000 - tn: 304597.0000 - fn: 15437.0000 - accuracy: 0.9229 - precision: 0.8074 - recall: 0.8070 - auc: 0.9785 - val_loss: 0.4122 - val_tp: 10622.0000 - val_fp: 9378.0000 - val_tn: 70622.0000 - val_fn: 9378.0000 - val_accuracy: 0.8124 - val_precision: 0.5311 - val_recall: 0.5311 - val_auc: 0.9449
[INFO] saving weights to checkpoints/lstm-epoch-1-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0148 - tp: 79433.0000 - fp: 559.0000 - tn: 319441.0000 - fn: 567.0000 - accuracy: 0.9972 - precision: 0.9930 - recall: 0.9929 - auc: 1.0000 - val_loss: 0.0016 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0014 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0012 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0011 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.4539e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-2-3-batch-400000-500000
[33m[INFO] loading file 4-4/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1367 (0.2734%)
[INFO] ** orig:[0:99.9988%,2:0.0012%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** i/f_name:[2:99.9986%,3:0.0014%]
[INFO] ** i/f_dir:[1:99.9988%,0:0.0012%]
[INFO] ** src:[22:38.2474%,9:26.0432%,7:18.1738%,1:17.5328%,21:0.0012%,15:0.0004%,4:0.0004%,17:0.0002%,14:0.0002%,8:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.3578%,10:20.9324%,8:18.1738%,9:17.5324%,15:0.0014%,22:0.0012%,18:0.0004%,24:0.0002%,6:0.0002%,0:0.0002%]
[INFO] ** proto:[0:99.998%,1:0.0014%,2:0.0006%]
[INFO] ** appi_name:[21:99.9976%,30:0.0014%,31:0.0004%,33:0.0002%,26:0.0002%,9:0.0002%]
[INFO] ** proxy_src_ip:[18:38.2474%,20:26.0432%,13:18.1738%,6:17.5328%,17:0.0014%,21:0.0004%,16:0.0004%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9976%,-33.760870000000004:0.0024%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.9978%,0:0.0024%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.0422%,1:20.932%,5:18.1734%,4:17.5318%,2:17.315%,0:0.0056%]
[INFO] ** service:[0.0048200000000000005:99.9978%,-211.73542999999998:0.0014%,-186.43601999999998:0.0004%,-183.8612:0.0002%,-211.08346:0.0002%]
[INFO] ** s_port:[1.45442:26.0424%,-0.32151:20.9322%,-1.27613:18.1734%,-0.23351:17.5322%,-0.33484:17.3152%,-71.33197:0.0014%,1.45709:0.0004%,-0.24151:0.0004%,-1.02014:0.0004%,-0.08551:0.0004%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,14.4699:0.0002%,-49.275529999999996:0.0002%,-1.2708:0.0002%,-71.14798:0.0002%]
[INFO] ** classification:[normal:91.244%,Single Stage Single Point:8.756%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.3860e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.4384e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.7477e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.1143e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.5184e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.9936e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3984 - tp: 71528.0000 - fp: 8472.0000 - tn: 311528.0000 - fn: 8472.0000 - accuracy: 0.9576 - precision: 0.8941 - recall: 0.8941 - auc: 0.9715 - val_loss: 1.2397 - val_tp: 7806.0000 - val_fp: 12194.0000 - val_tn: 67806.0000 - val_fn: 12194.0000 - val_accuracy: 0.7561 - val_precision: 0.3903 - val_recall: 0.3903 - val_auc: 0.8996
[INFO] saving weights to checkpoints/lstm-epoch-1-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.4753 - tp: 56259.0000 - fp: 23402.0000 - tn: 296598.0000 - fn: 23741.0000 - accuracy: 0.8821 - precision: 0.7062 - recall: 0.7032 - auc: 0.9551 - val_loss: 0.3413 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-3-4-batch-400000-500000
[33m[INFO] loading file 5-5/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1365 (0.273%)
[INFO] ** orig:[0:99.9982%,2:0.0018%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** i/f_name:[2:99.9978%,3:0.0022%]
[INFO] ** i/f_dir:[1:99.998%,0:0.002%]
[INFO] ** src:[22:37.992%,9:26.1346%,7:18.252%,1:17.618%,21:0.002%,14:0.0004%,16:0.0002%,15:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.365%,10:20.7618%,8:18.2518%,9:17.6176%,15:0.0022%,22:0.0008%,25:0.0002%,24:0.0002%,6:0.0002%,2:0.0002%]
[INFO] ** proto:[0:99.9974%,1:0.0022%,2:0.0004%]
[INFO] ** appi_name:[21:99.9968%,30:0.0022%,37:0.0002%,26:0.0002%,12:0.0002%,6:0.0002%,0:0.0002%]
[INFO] ** proxy_src_ip:[18:37.992%,20:26.1346%,13:18.252%,6:17.618%,17:0.0022%,21:0.0002%,16:0.0002%,7:0.0002%,5:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9968%,-33.760870000000004:0.0032%]
[INFO] ** modbus_function_description:[7:49.999%,11:49.9978%,0:0.0032%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.134%,1:20.7612%,5:18.2516%,4:17.6176%,2:17.2306%,0:0.005%]
[INFO] ** service:[0.0048200000000000005:99.9972%,-211.73542999999998:0.0022%,-186.44547:0.0002%,-211.08346:0.0002%,-211.35747999999998:0.0002%]
[INFO] ** s_port:[1.45442:26.1344%,-0.32151:20.7614%,-1.27613:18.2518%,-0.23351:17.6176%,-0.33484:17.2306%,-71.33197:0.0022%,-0.24151:0.0004%,-71.14798:0.0002%,-1.27347:0.0002%,1.45709:0.0002%,2.22906:0.0002%,-49.275529999999996:0.0002%,-61.95768:0.0002%,-1.02014:0.0002%,-64.19493:0.0002%]
[INFO] ** classification:[normal:88.731%,Single Stage Single Point:11.269%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2904 - tp: 67646.0000 - fp: 12267.0000 - tn: 307733.0000 - fn: 12354.0000 - accuracy: 0.9384 - precision: 0.8465 - recall: 0.8456 - auc: 0.9853 - val_loss: 0.1521 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0236 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.9763 - val_tp: 15795.0000 - val_fp: 4205.0000 - val_tn: 75795.0000 - val_fn: 4205.0000 - val_accuracy: 0.9159 - val_precision: 0.7897 - val_recall: 0.7897 - val_auc: 0.9679
[INFO] saving weights to checkpoints/lstm-epoch-1-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0540 - tp: 78906.0000 - fp: 1094.0000 - tn: 318906.0000 - fn: 1094.0000 - accuracy: 0.9945 - precision: 0.9863 - recall: 0.9863 - auc: 0.9999 - val_loss: 0.0015 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0013 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0010 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.1236e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-4-5-batch-400000-500000
[33m[INFO] loading file 6-6/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1369 (0.2738%)
[INFO] ** orig:[0:99.9996%,1:0.0004%]
[INFO] ** type:[0:99.999%,1:0.001%]
[INFO] ** i/f_name:[2:99.9964%,3:0.0036%]
[INFO] ** i/f_dir:[1:99.9966%,0:0.0034%]
[INFO] ** src:[22:37.9454%,9:26.1658%,7:18.285%,1:17.5992%,14:0.0036%,2:0.0006%,15:0.0002%,10:0.0002%]
[INFO] ** dst:[21:43.3788%,10:20.7322%,8:18.2848%,9:17.599%,15:0.0036%,22:0.0004%,25:0.0002%,24:0.0002%,18:0.0002%,12:0.0002%,7:0.0002%,6:0.0002%]
[INFO] ** proto:[0:99.9954%,1:0.0036%,2:0.001%]
[INFO] ** appi_name:[21:99.9954%,30:0.0036%,31:0.0002%,27:0.0002%,26:0.0002%,5:0.0002%,0:0.0002%]
[INFO] ** proxy_src_ip:[18:37.9454%,20:26.1658%,13:18.285%,6:17.5992%,17:0.0036%,14:0.0006%,16:0.0002%,11:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9954%,-33.760870000000004:0.0046%]
[INFO] ** modbus_function_description:[7:49.9984%,11:49.997%,0:0.0046%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1652%,1:20.732%,5:18.2842%,4:17.5984%,2:17.213%,0:0.0072%]
[INFO] ** service:[0.0048200000000000005:99.9954%,-211.73542999999998:0.0036%,-186.44547:0.0002%,-211.08346:0.0002%,-186.43601999999998:0.0002%,-201.23771000000002:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:26.1654%,-0.32151:20.7322%,-1.27613:18.2844%,-0.23351:17.5988%,-0.33484:17.2132%,-71.33197:0.0036%,-0.24151:0.0002%,-1.2708:0.0002%,-64.19493:0.0002%,-1.02014:0.0002%,13.431270000000001:0.0002%,4.90362:0.0002%,-71.14798:0.0002%,1.47576:0.0002%,1.46509:0.0002%,-0.24950999999999998:0.0002%,-1.27347:0.0002%,-68.36943000000001:0.0002%]
[INFO] ** classification:[normal:91.919%,Single Stage Single Point:8.081%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.2818e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.4939e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.8490e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.2533e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7420e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.2668e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.8767e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7575 - val_tp: 15632.0000 - val_fp: 4368.0000 - val_tn: 75632.0000 - val_fn: 4368.0000 - val_accuracy: 0.9126 - val_precision: 0.7816 - val_recall: 0.7816 - val_auc: 0.8635
[INFO] saving weights to checkpoints/lstm-epoch-1-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2739 - tp: 75505.0000 - fp: 4494.0000 - tn: 315506.0000 - fn: 4495.0000 - accuracy: 0.9775 - precision: 0.9438 - recall: 0.9438 - auc: 0.9782 - val_loss: 0.0139 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-5-6-batch-400000-500000
[33m[INFO] loading file 7-7/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1365 (0.273%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9986%,3:0.0014%]
[INFO] ** i/f_dir:[1:99.9986%,0:0.0014%]
[INFO] ** src:[22:37.9848%,9:26.133%,7:18.2404%,1:17.6366%,14:0.0014%,10:0.0008%,3:0.0008%,4:0.0006%,21:0.0004%,15:0.0004%,2:0.0004%,11:0.0002%,8:0.0002%]
[INFO] ** dst:[21:43.358%,10:20.759%,8:18.24%,9:17.6364%,6:0.0016%,22:0.0014%,15:0.0014%,16:0.0008%,24:0.0004%,18:0.0004%,17:0.0004%,7:0.0002%]
[INFO] ** proto:[0:99.9964%,2:0.0022%,1:0.0014%]
[INFO] ** appi_name:[21:99.9952%,30:0.0014%,22:0.001%,17:0.0008%,26:0.0006%,31:0.0004%,28:0.0002%,27:0.0002%,7:0.0002%]
[INFO] ** proxy_src_ip:[18:37.9848%,20:26.133%,13:18.2404%,6:17.6366%,17:0.0014%,11:0.0008%,1:0.0008%,21:0.0006%,16:0.0004%,14:0.0004%,7:0.0004%,10:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9952%,-33.760870000000004:0.0048%]
[INFO] ** modbus_function_description:[7:49.9984%,11:49.9968%,0:0.0048%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1316%,1:20.759%,5:18.2398%,4:17.636%,2:17.2258%,0:0.0078%]
[INFO] ** service:[0.0048200000000000005:99.9952%,-211.73542999999998:0.0014%,-211.08818:0.001%,-205.44247:0.0008%,-211.08346:0.0006%,-186.43601999999998:0.0004%,-211.09762999999998:0.0002%,-185.9872:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:26.132%,-0.32151:20.759%,-1.27613:18.2398%,-0.23351:17.6362%,-0.33484:17.2258%,-71.33197:0.0014%,-71.14931:0.001%,-71.14798:0.0006%,1.45709:0.0006%,-1.02014:0.0004%,-1.27347:0.0004%,-0.24151:0.0004%,-58.035180000000004:0.0002%,-1.2708:0.0002%,-5.1466400000000005:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-5.08665:0.0002%,14.253910000000001:0.0002%,-68.79874000000001:0.0002%,6.1115699999999995:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** classification:[normal:82.7162%,Single Stage Single Point:17.2838%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0096 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0066 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0053 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0044 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.2753 - tp: 68663.0000 - fp: 11301.0000 - tn: 308699.0000 - fn: 11337.0000 - accuracy: 0.9434 - precision: 0.8587 - recall: 0.8583 - auc: 0.9866 - val_loss: 0.1486 - val_tp: 19994.0000 - val_fp: 6.0000 - val_tn: 79994.0000 - val_fn: 6.0000 - val_accuracy: 0.9999 - val_precision: 0.9997 - val_recall: 0.9997 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 0.0052 - tp: 79999.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0020 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 8s - loss: 0.0015 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0012 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-6-7-batch-400000-500000
[33m[INFO] loading file 8-8/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1369 (0.2738%)
[INFO] ** orig:[0:99.9996%,2:0.0004%]
[INFO] ** type:[0:99.9994%,1:0.0004%,2:0.0002%]
[INFO] ** i/f_name:[2:99.999%,3:0.001%]
[INFO] ** i/f_dir:[1:99.9994%,0:0.0006%]
[INFO] ** src:[22:38.1046%,9:26.147%,7:18.1632%,1:17.5816%,11:0.0012%,15:0.0006%,14:0.0006%,21:0.0004%,2:0.0004%,16:0.0002%,10:0.0002%]
[INFO] ** dst:[21:43.4334%,10:20.8176%,8:18.164%,9:17.5812%,22:0.0014%,15:0.001%,25:0.0006%,19:0.0004%,26:0.0002%,24:0.0002%]
[INFO] ** proto:[0:99.9982%,1:0.001%,2:0.0008%]
[INFO] ** appi_name:[21:99.997%,30:0.001%,0:0.0006%,24:0.0002%,23:0.0002%,22:0.0002%,18:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.1046%,20:26.147%,13:18.1632%,6:17.5816%,10:0.0012%,17:0.001%,16:0.0006%,14:0.0004%,11:0.0002%,5:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.997%,-33.760870000000004:0.0028%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.9972%,0:0.0028%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.146%,1:20.8174%,5:18.163%,4:17.5808%,2:17.2868%,0:0.006%]
[INFO] ** service:[0.0048200000000000005:99.9978%,-211.73542999999998:0.001%,-186.44547:0.0006%,-211.07873999999998:0.0004%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:26.1464%,-0.32151:20.8176%,-1.27613:18.163%,-0.23351:17.581%,-0.33484:17.287%,-71.33197:0.001%,-15.039579999999999:0.0008%,-1.02014:0.0006%,-64.19493:0.0006%,1.45709:0.0004%,-0.24151:0.0004%,4.66896:0.0004%,-1.27347:0.0002%,-0.24950999999999998:0.0002%,1.47576:0.0002%,-71.14931:0.0002%]
[INFO] ** classification:[normal:94.2844%,Single Stage Single Point:5.7156%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 8s - loss: 0.0012 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.3081e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 8.2785e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.3474e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 6.7100e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.0862e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1886 - tp: 73230.0000 - fp: 6617.0000 - tn: 313383.0000 - fn: 6770.0000 - accuracy: 0.9665 - precision: 0.9171 - recall: 0.9154 - auc: 0.9913 - val_loss: 0.1232 - val_tp: 18745.0000 - val_fp: 1248.0000 - val_tn: 78752.0000 - val_fn: 1255.0000 - val_accuracy: 0.9750 - val_precision: 0.9376 - val_recall: 0.9373 - val_auc: 0.9975
[INFO] saving weights to checkpoints/lstm-epoch-1-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0116 - tp: 79962.0000 - fp: 36.0000 - tn: 319964.0000 - fn: 38.0000 - accuracy: 0.9998 - precision: 0.9995 - recall: 0.9995 - auc: 1.0000 - val_loss: 0.0044 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-7-8-batch-400000-500000
[33m[INFO] loading file 9-9/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9992%,3:0.0008%]
[INFO] ** i/f_dir:[1:99.9992%,0:0.0008%]
[INFO] ** src:[22:38.0%,9:26.1346%,7:18.2984%,1:17.5654%,14:0.0008%,17:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.3632%,10:20.7708%,8:18.2982%,9:17.5652%,22:0.0008%,15:0.0008%,18:0.0004%,25:0.0002%,24:0.0002%,6:0.0002%]
[INFO] ** proto:[0:99.9984%,2:0.0008%,1:0.0008%]
[INFO] ** appi_name:[21:99.9984%,30:0.0008%,31:0.0004%,26:0.0002%,0:0.0002%]
[INFO] ** proxy_src_ip:[18:38.0%,20:26.1346%,13:18.2984%,6:17.5654%,17:0.0008%,21:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9984%,-33.760870000000004:0.0016%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.9986%,0:0.0016%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1334%,1:20.7708%,5:18.298%,4:17.5648%,2:17.2292%,0:0.0038%]
[INFO] ** service:[0.0048200000000000005:99.9984%,-211.73542999999998:0.0008%,-186.43601999999998:0.0004%,-186.44547:0.0002%,-211.08346:0.0002%]
[INFO] ** s_port:[1.45442:26.1338%,-0.32151:20.7708%,-1.27613:18.298%,-0.23351:17.565%,-0.33484:17.2292%,-71.33197:0.0008%,1.45709:0.0004%,-0.24151:0.0004%,-0.08551:0.0004%,-71.14798:0.0002%,-1.27347:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-64.19493:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:96.1038%,Single Stage Single Point:3.8962%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0082 - tp: 79903.0000 - fp: 97.0000 - tn: 319903.0000 - fn: 97.0000 - accuracy: 0.9995 - precision: 0.9988 - recall: 0.9988 - auc: 0.9999 - val_loss: 0.0026 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1072 - tp: 78389.0000 - fp: 1611.0000 - tn: 318389.0000 - fn: 1611.0000 - accuracy: 0.9919 - precision: 0.9799 - recall: 0.9799 - auc: 0.9929 - val_loss: 0.0101 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0050 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0024 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0017 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0013 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0010 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.2233e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-8-9-batch-400000-500000
[33m[INFO] loading file 10-10/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1365 (0.273%)
[INFO] ** orig:[0:99.9992%,1:0.0008%]
[INFO] ** type:[0:99.9984%,1:0.0014%,2:0.0002%]
[INFO] ** i/f_name:[2:99.998%,3:0.002%]
[INFO] ** i/f_dir:[1:99.9982%,0:0.0018%]
[INFO] ** src:[22:38.097%,9:26.13%,7:18.2188%,1:17.5504%,14:0.002%,11:0.001%,2:0.0004%,16:0.0002%,15:0.0002%]
[INFO] ** dst:[21:43.4154%,10:20.8112%,8:18.2186%,9:17.551%,15:0.002%,22:0.0006%,24:0.0004%,19:0.0004%,26:0.0002%,25:0.0002%]
[INFO] ** proto:[0:99.9976%,1:0.002%,2:0.0004%]
[INFO] ** appi_name:[21:99.9964%,30:0.002%,24:0.0002%,23:0.0002%,22:0.0002%,18:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%,0:0.0002%]
[INFO] ** proxy_src_ip:[18:38.097%,20:26.13%,13:18.2188%,6:17.5504%,17:0.002%,10:0.001%,14:0.0004%,16:0.0002%,5:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9964%,-33.760870000000004:0.0034%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9988%,11:49.9976%,0:0.0034%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.129%,1:20.811%,5:18.2182%,4:17.5498%,2:17.2856%,0:0.0064%]
[INFO] ** service:[0.0048200000000000005:99.9972%,-211.73542999999998:0.002%,-211.07873999999998:0.0004%,-186.44547:0.0002%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:26.1294%,-0.32151:20.8112%,-1.27613:18.2182%,-0.23351:17.55%,-0.33484:17.2858%,-71.33197:0.002%,-10.51843:0.0008%,5.71692:0.0004%,-1.27347:0.0004%,1.46509:0.0002%,1.47576:0.0002%,-0.24950999999999998:0.0002%,1.45709:0.0002%,-0.24151:0.0002%,-71.14931:0.0002%,-1.02014:0.0002%,-64.19493:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:93.8902%,Single Stage Single Point:6.1098%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.8384e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.8445e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0066 - tp: 79936.0000 - fp: 64.0000 - tn: 319936.0000 - fn: 64.0000 - accuracy: 0.9997 - precision: 0.9992 - recall: 0.9992 - auc: 0.9995 - val_loss: 2.6096 - val_tp: 12843.0000 - val_fp: 7157.0000 - val_tn: 72843.0000 - val_fn: 7157.0000 - val_accuracy: 0.8569 - val_precision: 0.6421 - val_recall: 0.6421 - val_auc: 0.7763
[INFO] saving weights to checkpoints/lstm-epoch-1-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3045 - tp: 72950.0000 - fp: 7050.0000 - tn: 312950.0000 - fn: 7050.0000 - accuracy: 0.9647 - precision: 0.9119 - recall: 0.9119 - auc: 0.9806 - val_loss: 0.5405 - val_tp: 12813.0000 - val_fp: 7187.0000 - val_tn: 72813.0000 - val_fn: 7187.0000 - val_accuracy: 0.8563 - val_precision: 0.6406 - val_recall: 0.6406 - val_auc: 0.9677
[INFO] saving weights to checkpoints/lstm-epoch-1-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0141 - tp: 79493.0000 - fp: 507.0000 - tn: 319493.0000 - fn: 507.0000 - accuracy: 0.9975 - precision: 0.9937 - recall: 0.9937 - auc: 1.0000 - val_loss: 0.0025 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0020 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0016 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-9-10-batch-400000-500000
[33m[INFO] loading file 11-11/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9996%,3:0.0004%]
[INFO] ** i/f_dir:[1:99.9996%,0:0.0004%]
[INFO] ** src:[22:38.147%,9:26.1112%,7:18.2032%,1:17.5368%,15:0.0006%,14:0.0004%,17:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.3768%,10:20.881%,8:18.2034%,9:17.5362%,22:0.0014%,18:0.0004%,15:0.0004%,25:0.0002%,6:0.0002%]
[INFO] ** proto:[0:99.9988%,2:0.0008%,1:0.0004%]
[INFO] ** appi_name:[21:99.9988%,31:0.0004%,30:0.0004%,26:0.0002%,0:0.0002%]
[INFO] ** proxy_src_ip:[18:38.147%,20:26.1112%,13:18.2032%,6:17.5368%,16:0.0006%,17:0.0004%,21:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9988%,-33.760870000000004:0.0012%]
[INFO] ** modbus_function_description:[7:50.0004%,11:49.9984%,0:0.0012%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1104%,1:20.881%,5:18.203%,4:17.536%,2:17.2658%,0:0.0038%]
[INFO] ** service:[0.0048200000000000005:99.9988%,-211.73542999999998:0.0004%,-186.43601999999998:0.0004%,-186.44547:0.0002%,-211.08346:0.0002%]
[INFO] ** s_port:[1.45442:26.1108%,-0.32151:20.881%,-1.27613:18.2032%,-0.23351:17.5362%,-0.33484:17.266%,-0.24151:0.0006%,-1.02014:0.0006%,-0.08551:0.0004%,-71.33197:0.0004%,-71.14798:0.0002%,1.45709:0.0002%,1.46509:0.0002%,-64.19493:0.0002%]
[INFO] ** classification:[normal:100.0%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0014 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0012 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 0.0010 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.0578e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 8.0847e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.2037e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 8s - loss: 6.4765e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.8088e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 9s - loss: 5.2414e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.7175e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-10-11-batch-400000-500000
[33m[INFO] loading file 12-12/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0:99.9982%,2:0.0018%]
[INFO] ** type:[0:99.9996%,1:0.0004%]
[INFO] ** i/f_name:[2:99.9978%,3:0.0022%]
[INFO] ** i/f_dir:[1:99.9982%,0:0.0018%]
[INFO] ** src:[22:38.138%,9:26.1258%,7:18.1958%,1:17.5378%,21:0.0018%,14:0.0004%,15:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.3898%,10:20.8738%,8:18.1954%,9:17.5376%,15:0.0022%,22:0.0006%,24:0.0004%,0:0.0002%]
[INFO] ** proto:[0:99.9978%,1:0.0022%]
[INFO] ** appi_name:[21:99.9976%,30:0.0022%,9:0.0002%]
[INFO] ** proxy_src_ip:[18:38.138%,20:26.1258%,13:18.1958%,6:17.5378%,17:0.0022%,16:0.0002%,1:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9976%,-33.760870000000004:0.0024%]
[INFO] ** modbus_function_description:[7:49.9994%,11:49.9982%,0:0.0024%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.125%,1:20.8738%,5:18.1952%,4:17.537%,2:17.2642%,0:0.0048%]
[INFO] ** service:[0.0048200000000000005:99.9976%,-211.73542999999998:0.0022%,-183.8612:0.0002%]
[INFO] ** s_port:[1.45442:26.1254%,-0.32151:20.8738%,-1.27613:18.1952%,-0.23351:17.5374%,-0.33484:17.2642%,-71.33197:0.0022%,-1.27347:0.0004%,1.45709:0.0002%,-0.24950999999999998:0.0002%,1.47576:0.0002%,14.4699:0.0002%,-0.24151:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:92.7618%,Single Stage Single Point:7.2382%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.2924e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9050e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.5882e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3563 - val_tp: 16689.0000 - val_fp: 3311.0000 - val_tn: 76689.0000 - val_fn: 3311.0000 - val_accuracy: 0.9338 - val_precision: 0.8345 - val_recall: 0.8345 - val_auc: 0.8965
[INFO] saving weights to checkpoints/lstm-epoch-1-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2169 - tp: 76981.0000 - fp: 3019.0000 - tn: 316981.0000 - fn: 3019.0000 - accuracy: 0.9849 - precision: 0.9623 - recall: 0.9623 - auc: 0.9810 - val_loss: 0.7894 - val_tp: 17100.0000 - val_fp: 2900.0000 - val_tn: 77100.0000 - val_fn: 2900.0000 - val_accuracy: 0.9420 - val_precision: 0.8550 - val_recall: 0.8550 - val_auc: 0.9224
[INFO] saving weights to checkpoints/lstm-epoch-1-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0832 - tp: 78382.0000 - fp: 1616.0000 - tn: 318384.0000 - fn: 1618.0000 - accuracy: 0.9919 - precision: 0.9798 - recall: 0.9798 - auc: 0.9974 - val_loss: 0.0034 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0027 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0022 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-11-12-batch-400000-500000
[33m[INFO] loading file 13-13/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** i/f_name:[2:99.9996%,3:0.0004%]
[INFO] ** i/f_dir:[1:99.9996%,0:0.0004%]
[INFO] ** src:[22:38.0458%,9:26.115%,7:18.2794%,1:17.5554%,11:0.0012%,10:0.001%,15:0.0006%,21:0.0004%,14:0.0004%,17:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.3642%,10:20.7962%,8:18.2792%,9:17.556%,22:0.0012%,6:0.001%,18:0.0008%,25:0.0006%,15:0.0004%,24:0.0002%,7:0.0002%]
[INFO] ** proto:[0:99.997%,2:0.0026%,1:0.0004%]
[INFO] ** appi_name:[21:99.9962%,31:0.0008%,26:0.0006%,0:0.0006%,30:0.0004%,22:0.0004%,27:0.0002%,24:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.0458%,20:26.115%,13:18.2794%,6:17.5554%,10:0.0012%,11:0.001%,16:0.0006%,17:0.0004%,7:0.0004%,21:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9962%,-33.760870000000004:0.0036%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9988%,11:49.9974%,0:0.0036%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.114%,1:20.796%,5:18.279%,4:17.555%,2:17.2494%,0:0.0066%]
[INFO] ** service:[0.0048200000000000005:99.997%,-186.43601999999998:0.0008%,-186.44547:0.0006%,-211.08346:0.0006%,-211.73542999999998:0.0004%,-211.08818:0.0004%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:26.1144%,-0.32151:20.7962%,-1.27613:18.279%,-0.23351:17.555%,-0.33484:17.2496%,-9.78512:0.0008%,-71.14798:0.0006%,-64.19493:0.0006%,-1.02014:0.0006%,-0.08551:0.0004%,-71.14931:0.0004%,-0.24151:0.0004%,-71.33197:0.0004%,-1.27347:0.0002%,1.46509:0.0002%,-68.79874000000001:0.0002%,14.540560000000001:0.0002%,1.45709:0.0002%,-1.2708:0.0002%,6.1115699999999995:0.0002%,1.47576:0.0002%]
[INFO] ** classification:[normal:84.6974%,Single Stage Single Point:15.3026%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0019 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0016 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0014 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0012 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0011 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7051 - val_tp: 15075.0000 - val_fp: 4925.0000 - val_tn: 75075.0000 - val_fn: 4925.0000 - val_accuracy: 0.9015 - val_precision: 0.7538 - val_recall: 0.7538 - val_auc: 0.8498
[INFO] saving weights to checkpoints/lstm-epoch-1-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2225 - tp: 76321.0000 - fp: 3677.0000 - tn: 316323.0000 - fn: 3679.0000 - accuracy: 0.9816 - precision: 0.9540 - recall: 0.9540 - auc: 0.9813 - val_loss: 0.0128 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0090 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0065 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-12-13-batch-400000-500000
[33m[INFO] loading file 14-14/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1365 (0.273%)
[INFO] ** orig:[0:100.0%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** i/f_name:[2:99.9998%,3:0.0002%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** src:[22:38.0404%,9:26.1076%,7:18.2758%,1:17.5756%,15:0.0002%,14:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.3416%,10:20.8058%,8:18.2756%,9:17.5754%,22:0.0008%,24:0.0004%,15:0.0002%,0:0.0002%]
[INFO] ** proto:[0:99.9998%,1:0.0002%]
[INFO] ** appi_name:[21:99.9996%,30:0.0002%,9:0.0002%]
[INFO] ** proxy_src_ip:[18:38.0404%,20:26.1076%,13:18.2758%,6:17.5756%,17:0.0002%,16:0.0002%,1:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9996%,-33.760870000000004:0.0004%]
[INFO] ** modbus_function_description:[7:50.0008%,11:49.9988%,0:0.0004%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1064%,1:20.8058%,5:18.275%,4:17.5748%,2:17.2344%,0:0.0036%]
[INFO] ** service:[0.0048200000000000005:99.9996%,-183.8612:0.0002%,-211.73542999999998:0.0002%]
[INFO] ** s_port:[1.45442:26.1068%,-0.32151:20.8058%,-1.27613:18.2752%,-0.23351:17.5752%,-0.33484:17.2346%,-1.27347:0.0004%,1.45709:0.0004%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,14.4699:0.0002%,-0.24151:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%,-71.33197:0.0002%]
[INFO] ** classification:[normal:96.5086%,Single Stage Single Point:3.4914%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2828 - tp: 67999.0000 - fp: 12001.0000 - tn: 307999.0000 - fn: 12001.0000 - accuracy: 0.9400 - precision: 0.8500 - recall: 0.8500 - auc: 0.9863 - val_loss: 0.2881 - val_tp: 14304.0000 - val_fp: 5695.0000 - val_tn: 74305.0000 - val_fn: 5696.0000 - val_accuracy: 0.8861 - val_precision: 0.7152 - val_recall: 0.7152 - val_auc: 0.9724
[INFO] saving weights to checkpoints/lstm-epoch-1-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0141 - tp: 79701.0000 - fp: 299.0000 - tn: 319701.0000 - fn: 299.0000 - accuracy: 0.9985 - precision: 0.9963 - recall: 0.9963 - auc: 1.0000 - val_loss: 0.0026 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0020 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0016 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0014 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0012 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0010 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.2962e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-13-14-batch-400000-500000
[33m[INFO] loading file 15-15/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1374 (0.2748%)
[INFO] ** orig:[0:99.997%,2:0.003%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9968%,3:0.0032%]
[INFO] ** i/f_dir:[1:99.9968%,0:0.0032%]
[INFO] ** src:[22:38.005%,9:26.0626%,7:18.3142%,1:17.6136%,21:0.0034%,15:0.0006%,16:0.0002%,14:0.0002%,8:0.0002%]
[INFO] ** dst:[21:43.2978%,10:20.7692%,8:18.3144%,9:17.613%,15:0.0032%,22:0.0016%,25:0.0002%,24:0.0002%,16:0.0002%,6:0.0002%]
[INFO] ** proto:[0:99.9964%,1:0.0032%,2:0.0004%]
[INFO] ** appi_name:[21:99.996%,30:0.0032%,26:0.0002%,17:0.0002%,12:0.0002%,0:0.0002%]
[INFO] ** proxy_src_ip:[18:38.005%,20:26.0626%,13:18.3142%,6:17.6136%,17:0.0032%,16:0.0006%,7:0.0004%,5:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.996%,-33.760870000000004:0.004%]
[INFO] ** modbus_function_description:[7:49.999%,11:49.997%,0:0.004%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.0614%,1:20.7688%,5:18.314%,4:17.6124%,2:17.2358%,0:0.0076%]
[INFO] ** service:[0.0048200000000000005:99.9962%,-211.73542999999998:0.0032%,-186.44547:0.0002%,-211.08346:0.0002%,-205.44247:0.0002%]
[INFO] ** s_port:[1.45442:26.0618%,-0.32151:20.769%,-1.27613:18.314%,-0.23351:17.6128%,-0.33484:17.236%,-71.33197:0.0032%,-1.02014:0.0006%,-0.24151:0.0006%,1.45709:0.0004%,-64.19493:0.0002%,-61.95768:0.0002%,-71.14798:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,10.192739999999999:0.0002%,-0.24950999999999998:0.0002%,1.46509:0.0002%]
[INFO] ** classification:[normal:88.954%,Single Stage Multi Point:11.0452%,Single Stage Single Point:0.0008%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0010 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.4940e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 8.7303e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.2811e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.6858e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.1967e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.8278e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.7812 - val_tp: 11586.0000 - val_fp: 8414.0000 - val_tn: 71586.0000 - val_fn: 8414.0000 - val_accuracy: 0.8317 - val_precision: 0.5793 - val_recall: 0.5793 - val_auc: 0.7371
[INFO] saving weights to checkpoints/lstm-epoch-1-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/500000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 7.5433 - tp: 42561.0000 - fp: 37439.0000 - tn: 282561.0000 - fn: 37439.0000 - accuracy: 0.8128 - precision: 0.5320 - recall: 0.5320 - auc: 0.7075 - val_loss: 7.5540 - val_tp: 10627.0000 - val_fp: 9373.0000 - val_tn: 70627.0000 - val_fn: 9373.0000 - val_accuracy: 0.8125 - val_precision: 0.5314 - val_recall: 0.5314 - val_auc: 0.7071
[INFO] saving weights to checkpoints/lstm-epoch-1-files-14-15-batch-400000-500000
[33m[INFO] loading file 16-16/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (439690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (439690, 17)

[INFO] analyzing data
[INFO] 439690 rows
[INFO] ** unixtime:1201 (0.27315%)
[INFO] ** orig:[0:99.99886%,2:0.00114%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.99886%,3:0.00114%]
[INFO] ** i/f_dir:[1:99.99886%,0:0.00114%]
[INFO] ** src:[22:38.05363%,9:26.10544%,7:18.25172%,1:17.58762%,21:0.00114%,15:0.00023%,4:0.00023%]
[INFO] ** dst:[21:43.35941%,10:20.79943%,8:18.25127%,9:17.58762%,15:0.00114%,22:0.00091%,24:0.00023%]
[INFO] ** proto:[0:99.99886%,1:0.00114%]
[INFO] ** appi_name:[21:99.99864%,30:0.00114%,33:0.00023%]
[INFO] ** proxy_src_ip:[18:38.05363%,20:26.10544%,13:18.25172%,6:17.58762%,17:0.00114%,21:0.00023%,16:0.00023%]
[INFO] ** modbus_function_code:[0.02961:99.99864%,-33.760870000000004:0.00136%]
[INFO] ** modbus_function_description:[7:50.00045%,11:49.99818%,0:0.00136%]
[INFO] ** modbus_transaction_id:65536 (14.90505%)
[INFO] ** scada_tag:[3:26.1043%,1:20.7992%,5:18.25104%,4:17.58694%,2:17.25443%,0:0.00409%]
[INFO] ** service:[0.0048200000000000005:99.99886%,-211.73542999999998:0.00114%]
[INFO] ** s_port:[1.45442:26.10476%,-0.32151:20.7992%,-1.27613:18.25127%,-0.23351:17.58739%,-0.33484:17.25443%,-71.33197:0.00114%,1.45709:0.00045%,-1.27347:0.00023%,1.47576:0.00023%,-49.275529999999996:0.00023%,-0.24151:0.00023%,-1.02014:0.00023%,-1.2708:0.00023%]
[INFO] ** classification:[normal:84.4188%,Single Stage Multi Point:15.5812%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/439690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5572 - tp: 42492.0000 - fp: 37508.0000 - tn: 282492.0000 - fn: 37508.0000 - accuracy: 0.8125 - precision: 0.5311 - recall: 0.5311 - auc: 0.7070 - val_loss: 7.5612 - val_tp: 10618.0000 - val_fp: 9382.0000 - val_tn: 70618.0000 - val_fn: 9382.0000 - val_accuracy: 0.8124 - val_precision: 0.5309 - val_recall: 0.5309 - val_auc: 0.7068
[INFO] saving weights to checkpoints/lstm-epoch-1-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/439690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.3560 - tp: 58381.0000 - fp: 21619.0000 - tn: 298381.0000 - fn: 21619.0000 - accuracy: 0.8919 - precision: 0.7298 - recall: 0.7298 - auc: 0.8311 - val_loss: 3.2149e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/439690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9693e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7389e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/439690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.5369e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3539e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/439690
[33m[INFO] loading file 17-17/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539690, 17)

[INFO] analyzing data
[INFO] 539690 rows
[INFO] ** appi_name:[21:99.99722%,7:0.00056%,26:0.00037%,0:0.00037%,31:0.00019%,27:0.00019%,24:0.00019%,22:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:94.28376%,Multi Stage Multi Point:5.71624%]
[INFO] ** dst:[21:43.34562%,10:20.85123%,8:18.201%,9:17.59918%,22:0.00074%,6:0.00056%,25:0.00037%,16:0.00037%,2:0.00037%,24:0.00019%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99722%,-33.760870000000004:0.00259%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99963%,11:49.99759%,0:0.00259%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.14327%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9987%,2:0.0013%]
[INFO] ** proxy_src_ip:[18:38.08316%,20:26.11444%,13:18.20045%,6:17.59899%,10:0.00111%,11:0.00093%,1:0.00037%,16:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.11351%,-0.32151:20.85123%,-1.27613:18.20008%,-0.23351:17.59881%,-0.33484:17.23193%,6.0369:0.00074%,-71.14798:0.00037%,1.47576:0.00037%,-64.19493:0.00037%,1.45709:0.00037%,1.46509:0.00019%,-68.79874000000001:0.00019%,-1.27347:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,6.15557:0.00019%,6.06224:0.00019%,8.55414:0.00019%,-3.3787199999999995:0.00019%,-4.3880099999999995:0.00019%,-71.14931:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:26.11332%,1:20.85104%,5:18.19989%,4:17.59844%,2:17.23193%,0:0.00537%]
[INFO] ** service:[0.0048200000000000005:99.99796%,-211.09762999999998:0.00056%,-211.08346:0.00037%,-186.44547:0.00037%,-211.35747999999998:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.08316%,9:26.11444%,7:18.20045%,1:17.59899%,11:0.00111%,10:0.00093%,3:0.00037%,21:0.00019%,15:0.00019%,2:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1475 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1132e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8817e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7570e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6177e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5039e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3913e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.2955 - tp: 68607.0000 - fp: 11393.0000 - tn: 308607.0000 - fn: 11393.0000 - accuracy: 0.9430 - precision: 0.8576 - recall: 0.8576 - auc: 0.9110 - val_loss: 2.9263 - val_tp: 16369.0000 - val_fp: 3631.0000 - val_tn: 76369.0000 - val_fn: 3631.0000 - val_accuracy: 0.9274 - val_precision: 0.8184 - val_recall: 0.8184 - val_auc: 0.8865
[INFO] saving weights to checkpoints/lstm-epoch-1-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9163 - tp: 65526.0000 - fp: 14474.0000 - tn: 305526.0000 - fn: 14474.0000 - accuracy: 0.9276 - precision: 0.8191 - recall: 0.8191 - auc: 0.8869 - val_loss: 1.0897 - val_tp: 18648.0000 - val_fp: 1352.0000 - val_tn: 78648.0000 - val_fn: 1352.0000 - val_accuracy: 0.9730 - val_precision: 0.9324 - val_recall: 0.9324 - val_auc: 0.9577
[INFO] saving weights to checkpoints/lstm-epoch-1-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/539690
[33m[INFO] loading file 18-18/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539690, 17)

[INFO] analyzing data
[INFO] 539690 rows
[INFO] ** appi_name:[21:99.99815%,30:0.00056%,7:0.00056%,31:0.00019%,27:0.00019%,22:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:82.02709%,Multi Stage Multi Point:17.97291%]
[INFO] ** dst:[21:43.33692%,10:20.8327%,8:18.26604%,9:17.56138%,22:0.00074%,15:0.00056%,24:0.00037%,16:0.00037%,2:0.00037%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99944%,0:0.00056%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.99815%,-33.760870000000004:0.00185%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99815%,0:0.00185%]
[INFO] ** modbus_transaction_id:65536 (12.14327%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99889%,2:0.00056%,1:0.00056%]
[INFO] ** proxy_src_ip:[18:38.07371%,20:26.09646%,13:18.26641%,6:17.56156%,17:0.00056%,11:0.00056%,1:0.00037%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.09572%,-0.32151:20.8327%,-1.27613:18.26586%,-0.23351:17.56119%,-0.33484:17.24101%,-71.33197:0.00056%,-1.27347:0.00037%,1.45709:0.00037%,-0.24151:0.00037%,1.47576:0.00019%,1.46509:0.00019%,3.6236699999999997:0.00019%,-1.2708:0.00019%,-2.48275:0.00019%,6.06224:0.00019%,-3.3787199999999995:0.00019%,8.10082:0.00019%,6.45955:0.00019%,-71.14931:0.00019%]
[INFO] ** scada_tag:[3:26.09535%,1:20.83251%,5:18.26567%,4:17.56101%,2:17.24082%,0:0.00463%]
[INFO] ** service:[0.0048200000000000005:99.99815%,-211.09762999999998:0.00056%,-211.73542999999998:0.00056%,-211.35747999999998:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.07371%,9:26.09646%,7:18.26641%,1:17.56156%,14:0.00056%,10:0.00056%,3:0.00037%,21:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1475 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3711 - tp: 72197.0000 - fp: 7478.0000 - tn: 312522.0000 - fn: 7803.0000 - accuracy: 0.9618 - precision: 0.9061 - recall: 0.9025 - auc: 0.9854 - val_loss: 0.2720 - val_tp: 15948.0000 - val_fp: 3703.0000 - val_tn: 76297.0000 - val_fn: 4052.0000 - val_accuracy: 0.9224 - val_precision: 0.8116 - val_recall: 0.7974 - val_auc: 0.9799
[INFO] saving weights to checkpoints/lstm-epoch-1-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0083 - tp: 79906.0000 - fp: 88.0000 - tn: 319912.0000 - fn: 94.0000 - accuracy: 0.9995 - precision: 0.9989 - recall: 0.9988 - auc: 1.0000 - val_loss: 0.0012 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0010 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.5799e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2408 - tp: 74024.0000 - fp: 5976.0000 - tn: 314024.0000 - fn: 5976.0000 - accuracy: 0.9701 - precision: 0.9253 - recall: 0.9253 - auc: 0.9887 - val_loss: 0.0715 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0033 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6840e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/539690
[33m[INFO] loading file 19-19/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539690, 17)

[INFO] analyzing data
[INFO] 539690 rows
[INFO] ** appi_name:[21:99.99796%,26:0.00037%,0:0.00037%,31:0.00019%,27:0.00019%,24:0.00019%,22:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:86.74054%,Single Stage Multi Point:13.25946%]
[INFO] ** dst:[21:43.38213%,10:20.82492%,8:18.21879%,9:17.57138%,22:0.0013%,6:0.00056%,25:0.00037%,24:0.00019%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99796%,-33.760870000000004:0.00185%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99815%,0:0.00185%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.14327%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9987%,2:0.0013%]
[INFO] ** proxy_src_ip:[18:38.11318%,20:26.09405%,13:18.21879%,6:17.57138%,10:0.00111%,11:0.00093%,16:0.00056%]
[INFO] ** s_port:[1.45442:26.09294%,-0.32151:20.82492%,-1.27613:18.21842%,-0.23351:17.5712%,-0.33484:17.28826%,-5.20264:0.00074%,1.45709:0.00056%,-1.02014:0.00056%,-64.19493:0.00037%,-71.14798:0.00037%,1.46509:0.00037%,-1.27347:0.00019%,-0.24151:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-71.14931:0.00019%,-68.79874000000001:0.00019%,0.75578:0.00019%]
[INFO] ** scada_tag:[3:26.09257%,1:20.82473%,5:18.21824%,4:17.57101%,2:17.28807%,0:0.00537%]
[INFO] ** service:[0.0048200000000000005:99.9987%,-211.08346:0.00037%,-186.44547:0.00037%,-202.75898:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.11318%,9:26.09405%,7:18.21879%,1:17.57138%,11:0.00111%,10:0.00093%,15:0.00056%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1476 (0.27349%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6372e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6874e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4342e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2341e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0845e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.5332e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.8517 - tp: 69300.0000 - fp: 10699.0000 - tn: 309301.0000 - fn: 10700.0000 - accuracy: 0.9465 - precision: 0.8663 - recall: 0.8662 - auc: 0.9493 - val_loss: 0.8336 - val_tp: 7882.0000 - val_fp: 12118.0000 - val_tn: 67882.0000 - val_fn: 12118.0000 - val_accuracy: 0.7576 - val_precision: 0.3941 - val_recall: 0.3941 - val_auc: 0.9082
[INFO] saving weights to checkpoints/lstm-epoch-1-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0549 - tp: 79036.0000 - fp: 872.0000 - tn: 319128.0000 - fn: 964.0000 - accuracy: 0.9954 - precision: 0.9891 - recall: 0.9880 - auc: 0.9993 - val_loss: 3.2621 - val_tp: 7773.0000 - val_fp: 12227.0000 - val_tn: 67773.0000 - val_fn: 12227.0000 - val_accuracy: 0.7555 - val_precision: 0.3887 - val_recall: 0.3887 - val_auc: 0.6838
[INFO] saving weights to checkpoints/lstm-epoch-1-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/539690
[33m[INFO] loading file 20-20/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539690, 17)

[INFO] analyzing data
[INFO] 539690 rows
[INFO] ** appi_name:[21:99.99648%,30:0.00296%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:92.40694%,Single Stage Multi Point:7.59306%]
[INFO] ** dst:[21:43.42697%,10:20.83529%,8:18.16487%,9:17.56786%,15:0.00296%,22:0.00111%,24:0.00037%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99741%,0:0.00259%]
[INFO] ** i/f_name:[2:99.99704%,3:0.00296%]
[INFO] ** modbus_function_code:[0.02961:99.99648%,-33.760870000000004:0.00352%]
[INFO] ** modbus_function_description:[7:49.99944%,11:49.99704%,0:0.00352%]
[INFO] ** modbus_transaction_id:65536 (12.14327%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99648%,1:0.00296%,2:0.00056%]
[INFO] ** proxy_src_ip:[18:38.11373%,20:26.14909%,13:18.16506%,6:17.56842%,17:0.00296%,14:0.00056%,16:0.00019%]
[INFO] ** s_port:[1.45442:26.14834%,-0.32151:20.83529%,-1.27613:18.1645%,-0.23351:17.56768%,-0.33484:17.27844%,-71.33197:0.00296%,-0.24151:0.00056%,1.45709:0.00037%,-1.27347:0.00037%,13.431270000000001:0.00019%,-1.2708:0.00019%,-1.02014:0.00019%,-71.14798:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,11.862:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:26.14797%,1:20.83511%,5:18.1645%,4:17.56731%,2:17.27825%,0:0.00686%]
[INFO] ** service:[0.0048200000000000005:99.99648%,-211.73542999999998:0.00296%,-211.08346:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.11373%,9:26.14909%,7:18.16506%,1:17.56842%,14:0.00296%,2:0.00056%,15:0.00019%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1475 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0321 - tp: 79297.0000 - fp: 688.0000 - tn: 319312.0000 - fn: 703.0000 - accuracy: 0.9965 - precision: 0.9914 - recall: 0.9912 - auc: 0.9993 - val_loss: 0.2502 - val_tp: 19491.0000 - val_fp: 509.0000 - val_tn: 79491.0000 - val_fn: 509.0000 - val_accuracy: 0.9898 - val_precision: 0.9746 - val_recall: 0.9746 - val_auc: 0.9841
[INFO] saving weights to checkpoints/lstm-epoch-1-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.4061 - tp: 70581.0000 - fp: 9365.0000 - tn: 310635.0000 - fn: 9419.0000 - accuracy: 0.9530 - precision: 0.8829 - recall: 0.8823 - auc: 0.9750 - val_loss: 0.0397 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0199 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0115 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1277 - tp: 75850.0000 - fp: 4149.0000 - tn: 315851.0000 - fn: 4150.0000 - accuracy: 0.9793 - precision: 0.9481 - recall: 0.9481 - auc: 0.9975 - val_loss: 0.0764 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/539690
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0051 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0014 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/539690
[33m[INFO] loading file 21-21/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539688, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539688, 17)

[INFO] analyzing data
[INFO] 539688 rows
[INFO] ** appi_name:[21:99.99611%,30:0.00093%,7:0.00056%,26:0.00037%,22:0.00037%,0:0.00037%,31:0.00019%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:98.86916%,Multi Stage Single Point:1.13084%]
[INFO] ** dst:[21:43.30539%,10:20.98583%,8:18.17142%,9:17.53272%,22:0.00093%,15:0.00093%,6:0.00074%,24:0.00056%,25:0.00037%,16:0.00037%,2:0.00037%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99907%,0:0.00093%]
[INFO] ** i/f_name:[2:99.99907%,3:0.00093%]
[INFO] ** modbus_function_code:[0.02961:99.99611%,-33.760870000000004:0.00371%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.9987%,11:49.99741%,0:0.00371%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.14331%)
[INFO] ** orig:[0:99.99926%,2:0.00074%]
[INFO] ** proto:[0:99.99759%,2:0.00148%,1:0.00093%]
[INFO] ** proxy_src_ip:[18:38.31288%,20:25.97816%,13:18.1718%,6:17.53272%,10:0.00111%,17:0.00093%,11:0.00093%,16:0.00056%,1:0.00037%,21:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.9776%,-0.32151:20.98509%,-1.27613:18.17124%,-0.23351:17.53254%,-0.33484:17.32779%,-71.33197:0.00093%,-6.64392:0.00074%,-1.27347:0.00056%,-1.02014:0.00056%,-64.19493:0.00037%,-71.14931:0.00037%,-71.14798:0.00037%,1.47576:0.00019%,1.46509:0.00019%,6.62488:0.00019%,10.15141:0.00019%,-68.79874000000001:0.00019%,7.060860000000001:0.00019%,-3.3787199999999995:0.00019%,-2.2440900000000004:0.00019%,1.45709:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.97723%,1:20.9849%,5:18.17105%,4:17.53217%,2:17.32779%,0:0.00686%]
[INFO] ** service:[0.0048200000000000005:99.99685%,-211.73542999999998:0.00093%,-211.09762999999998:0.00056%,-211.08346:0.00037%,-186.44547:0.00037%,-211.08818:0.00037%,-211.35747999999998:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.31288%,9:25.97816%,7:18.1718%,1:17.53272%,11:0.00111%,21:0.00093%,10:0.00093%,15:0.00056%,3:0.00037%,14:0.00019%,4:0.00019%,2:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1470 (0.27238%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539688
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0012 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.3214e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/539688
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.9625e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.8023e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/539688
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.9571e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2057e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/539688
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.6343e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1044e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/539688
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6731e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2262e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/539688
[33m[INFO] loading file 22-22/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (308729, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (308729, 17)

[INFO] analyzing data
[INFO] 308729 rows
[INFO] ** appi_name:[21:99.99223%,30:0.0068%,23:0.00032%,22:0.00032%,18:0.00032%]
[INFO] ** classification:[normal:57.06526%,Multi Stage Single Point:42.93474%]
[INFO] ** dst:[21:43.30108%,10:21.00386%,8:18.11394%,9:17.57205%,15:0.0068%,22:0.0013%,19:0.00065%,26:0.00032%]
[INFO] ** i/f_dir:[1:99.99352%,0:0.00648%]
[INFO] ** i/f_name:[2:99.9932%,3:0.00648%,0:0.00032%]
[INFO] ** modbus_function_code:[0.02961:99.99223%,-33.760870000000004:0.00777%]
[INFO] ** modbus_function_description:[7:49.99725%,11:49.99498%,0:0.00777%]
[INFO] ** modbus_transaction_id:65534 (21.22703%)
[INFO] ** orig:[0:99.99482%,2:0.00453%,1:0.00065%]
[INFO] ** proto:[0:99.99287%,1:0.0068%,2:0.00032%]
[INFO] ** proxy_src_ip:[18:38.32682%,20:25.97909%,13:18.1133%,6:17.57302%,17:0.0068%,14:0.00065%,10:0.00032%]
[INFO] ** s_port:[1.45442:25.97812%,-0.32151:21.00386%,-1.27613:18.1133%,-0.23351:17.57205%,-0.33484:17.32296%,-71.33197:0.0068%,1.45709:0.00065%,-0.24151:0.00065%,7.228860000000001:0.00065%,-0.24950999999999998:0.00032%,1.46509:0.00032%,-71.14931:0.00032%]
[INFO] ** scada_tag:[3:25.9778%,1:21.00386%,5:18.1133%,4:17.57172%,2:17.32296%,0:0.01037%]
[INFO] ** service:[0.0048200000000000005:99.99223%,-211.73542999999998:0.0068%,-211.07873999999998:0.00065%,-211.08818:0.00032%]
[INFO] ** src:[22:38.32682%,9:25.97909%,7:18.1133%,1:17.57302%,21:0.00453%,14:0.00227%,2:0.00065%,11:0.00032%]
[INFO] ** type:[0:99.99806%,1:0.00194%]
[INFO] ** unixtime:853 (0.27629%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/308729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.0358 - tp: 55006.0000 - fp: 24994.0000 - tn: 295006.0000 - fn: 24994.0000 - accuracy: 0.8750 - precision: 0.6876 - recall: 0.6876 - auc: 0.8047 - val_loss: 7.5659 - val_tp: 10612.0000 - val_fp: 9388.0000 - val_tn: 70612.0000 - val_fn: 9388.0000 - val_accuracy: 0.8122 - val_precision: 0.5306 - val_recall: 0.5306 - val_auc: 0.7066
[INFO] saving weights to checkpoints/lstm-epoch-1-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/308729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5760 - tp: 42398.0000 - fp: 37602.0000 - tn: 282398.0000 - fn: 37602.0000 - accuracy: 0.8120 - precision: 0.5300 - recall: 0.5300 - auc: 0.7062 - val_loss: 7.6344 - val_tp: 10527.0000 - val_fp: 9473.0000 - val_tn: 70527.0000 - val_fn: 9473.0000 - val_accuracy: 0.8105 - val_precision: 0.5264 - val_recall: 0.5264 - val_auc: 0.7040
[INFO] saving weights to checkpoints/lstm-epoch-1-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/308729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5816 - tp: 42370.0000 - fp: 37630.0000 - tn: 282370.0000 - fn: 37630.0000 - accuracy: 0.8118 - precision: 0.5296 - recall: 0.5296 - auc: 0.7060 - val_loss: 7.5562 - val_tp: 10624.0000 - val_fp: 9376.0000 - val_tn: 70624.0000 - val_fn: 9376.0000 - val_accuracy: 0.8125 - val_precision: 0.5312 - val_recall: 0.5312 - val_auc: 0.7070
[INFO] saving weights to checkpoints/lstm-epoch-1-files-21-22-batch-200000-300000
[INFO] processing batch 300000-400000/308729
[33m[INFO] loading file 23-23/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (508729, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (508729, 17)

[INFO] analyzing data
[INFO] 508729 rows
[INFO] ** appi_name:[21:99.99902%,31:0.00039%,33:0.0002%,30:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:97.42024%,Multi Stage Single Point:2.57976%]
[INFO] ** dst:[21:43.3384%,10:20.99821%,8:18.13618%,9:17.52505%,22:0.00098%,24:0.00039%,18:0.00039%,25:0.0002%,15:0.0002%]
[INFO] ** i/f_dir:[1:99.9998%,0:0.0002%]
[INFO] ** i/f_name:[2:99.9998%,3:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.99902%,-33.760870000000004:0.00098%]
[INFO] ** modbus_function_description:[7:50.00049%,11:49.99853%,0:0.00098%]
[INFO] ** modbus_transaction_id:65536 (12.8823%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99921%,2:0.00059%,1:0.0002%]
[INFO] ** proxy_src_ip:[18:38.34596%,20:25.99085%,13:18.13638%,6:17.52524%,16:0.00059%,21:0.0002%,17:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.99026%,-0.32151:20.99802%,-1.27613:18.13579%,-0.23351:17.52485%,-0.33484:17.34794%,-1.02014:0.00059%,-0.08551:0.00039%,-1.27347:0.00039%,1.47576:0.0002%,-49.275529999999996:0.0002%,1.46509:0.0002%,-0.24151:0.0002%,-0.24950999999999998:0.0002%,-64.19493:0.0002%,-1.2708:0.0002%,1.45709:0.0002%,-71.33197:0.0002%]
[INFO] ** scada_tag:[3:25.98987%,1:20.99802%,5:18.13559%,4:17.52465%,2:17.34774%,0:0.00413%]
[INFO] ** service:[0.0048200000000000005:99.99921%,-186.43601999999998:0.00039%,-186.44547:0.0002%,-211.73542999999998:0.0002%]
[INFO] ** src:[22:38.34596%,9:25.99085%,7:18.13638%,1:17.52524%,15:0.00059%,17:0.0002%,14:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1383 (0.27185%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0497 - tp: 65606.0000 - fp: 12302.0000 - tn: 307698.0000 - fn: 14394.0000 - accuracy: 0.9333 - precision: 0.8421 - recall: 0.8201 - auc: 0.9081 - val_loss: 0.1362 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0039 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.8767e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.4494e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8034e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9938e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3889e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0103e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6957e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/508729
[33m[INFO] loading file 24-24/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (508729, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (508729, 17)

[INFO] analyzing data
[INFO] 508729 rows
[INFO] ** appi_name:[21:99.99273%,30:0.00354%,26:0.00059%,31:0.00039%,27:0.00039%,22:0.00039%,0:0.00039%,24:0.0002%,23:0.0002%,19:0.0002%,18:0.0002%,16:0.0002%,15:0.0002%,11:0.0002%,5:0.0002%]
[INFO] ** classification:[normal:94.99144%,Multi Stage Single Point:5.00856%]
[INFO] ** dst:[21:43.36081%,10:21.0334%,8:18.09451%,9:17.50382%,15:0.00354%,22:0.00118%,6:0.00079%,25:0.00039%,19:0.00039%,18:0.00039%,7:0.00039%,26:0.0002%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.99666%,0:0.00334%]
[INFO] ** i/f_name:[2:99.99646%,3:0.00354%]
[INFO] ** modbus_function_code:[0.02961:99.99273%,-33.760870000000004:0.00668%,0.47422:0.0002%,-0.415:0.0002%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.99735%,11:49.99538%,0:0.00668%,15:0.0002%,10:0.0002%,2:0.0002%]
[INFO] ** modbus_transaction_id:65536 (12.8823%)
[INFO] ** orig:[0:99.99961%,1:0.00039%]
[INFO] ** proto:[0:99.9943%,1:0.00354%,2:0.00216%]
[INFO] ** proxy_src_ip:[18:38.41888%,20:25.97611%,13:18.09431%,6:17.50303%,17:0.00354%,10:0.00138%,14:0.00098%,11:0.00098%,21:0.00039%,16:0.00039%]
[INFO] ** s_port:[1.45442:25.97532%,-0.32151:21.0334%,-1.27613:18.09411%,-0.23351:17.50244%,-0.33484:17.38548%,-71.33197:0.00354%,-9.58113:0.00079%,-71.14798:0.00059%,7.6315100000000005:0.00039%,-64.19493:0.00039%,-1.02014:0.00039%,-71.14931:0.00039%,-0.24151:0.00039%,1.45709:0.00039%,-31.55091:0.00039%,7.4901800000000005:0.0002%,-1.27347:0.0002%,1.47576:0.0002%,1.46509:0.0002%,13.431270000000001:0.0002%,-68.79874000000001:0.0002%,-0.24950999999999998:0.0002%,11.862:0.0002%]
[INFO] ** scada_tag:[3:25.97513%,1:21.0334%,5:18.09392%,4:17.50205%,2:17.38529%,0:0.01022%]
[INFO] ** service:[0.0048200000000000005:99.99391%,-211.73542999999998:0.00354%,-211.08346:0.00059%,-186.44547:0.00039%,-186.43601999999998:0.00039%,-211.07873999999998:0.00039%,-211.08818:0.00039%,-202.75898:0.00039%]
[INFO] ** src:[22:38.41888%,9:25.97611%,7:18.09431%,1:17.50303%,14:0.00354%,11:0.00138%,10:0.00098%,2:0.00098%,15:0.00039%,4:0.00039%]
[INFO] ** type:[0:99.99862%,1:0.00098%,2:0.00039%]
[INFO] ** unixtime:1382 (0.27166%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.6823e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1478e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0219e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.0862e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.1844e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.3323e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.6120e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.9408e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3825 - tp: 65250.0000 - fp: 13259.0000 - tn: 306741.0000 - fn: 14750.0000 - accuracy: 0.9300 - precision: 0.8311 - recall: 0.8156 - auc: 0.9768 - val_loss: 0.2534 - val_tp: 16775.0000 - val_fp: 2857.0000 - val_tn: 77143.0000 - val_fn: 3225.0000 - val_accuracy: 0.9392 - val_precision: 0.8545 - val_recall: 0.8388 - val_auc: 0.9861
[INFO] saving weights to checkpoints/lstm-epoch-1-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/508729
[33m[INFO] loading file 25-25/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (508729, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (508729, 17)

[INFO] analyzing data
[INFO] 508729 rows
[INFO] ** appi_name:[21:99.99627%,30:0.00098%,17:0.00079%,22:0.00059%,31:0.00039%,28:0.0002%,26:0.0002%,12:0.0002%,7:0.0002%,6:0.0002%]
[INFO] ** classification:[normal:64.33661%,Multi Stage Single Point:35.66339%]
[INFO] ** dst:[21:43.31029%,10:21.022%,8:18.1521%,9:17.51109%,22:0.00098%,15:0.00098%,16:0.00079%,6:0.00079%,18:0.00039%,17:0.00039%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.99902%,0:0.00098%]
[INFO] ** i/f_name:[2:99.99902%,3:0.00098%]
[INFO] ** modbus_function_code:[0.02961:99.99627%,-33.760870000000004:0.00373%]
[INFO] ** modbus_function_description:[7:49.99892%,11:49.99735%,0:0.00373%]
[INFO] ** modbus_transaction_id:65536 (12.8823%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99784%,2:0.00118%,1:0.00098%]
[INFO] ** proxy_src_ip:[18:38.38154%,20:25.95036%,13:18.1523%,6:17.51168%,17:0.00098%,1:0.00098%,21:0.00079%,16:0.00039%,14:0.00039%,7:0.00039%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.95016%,-0.32151:21.0216%,-1.27613:18.1519%,-0.23351:17.51109%,-0.33484:17.35993%,-71.33197:0.00098%,-71.14931:0.00059%,-1.02014:0.00039%,-0.24151:0.00039%,-49.275529999999996:0.00039%,-71.14798:0.0002%,-58.035180000000004:0.0002%,-1.2708:0.0002%,-5.1466400000000005:0.0002%,-5.08665:0.0002%,-1.27347:0.0002%,-0.24950999999999998:0.0002%,1.45709:0.0002%,6.1115699999999995:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,2.52505:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** scada_tag:[3:25.94977%,1:21.02141%,5:18.15171%,4:17.51089%,2:17.35973%,0:0.00649%]
[INFO] ** service:[0.0048200000000000005:99.99666%,-211.73542999999998:0.00098%,-205.44247:0.00079%,-211.08818:0.00059%,-186.43601999999998:0.00039%,-211.09762999999998:0.0002%,-211.08346:0.0002%,-185.9872:0.0002%]
[INFO] ** src:[22:38.38154%,9:25.95036%,7:18.1523%,1:17.51168%,14:0.00098%,3:0.00098%,4:0.00079%,21:0.00039%,15:0.00039%,2:0.00039%,8:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1382 (0.27166%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0176 - tp: 79777.0000 - fp: 194.0000 - tn: 319806.0000 - fn: 223.0000 - accuracy: 0.9990 - precision: 0.9976 - recall: 0.9972 - auc: 1.0000 - val_loss: 0.0037 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0028 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0020 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0016 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0012 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0012 - tp: 79997.0000 - fp: 3.0000 - tn: 319997.0000 - fn: 3.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0011 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.9524e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.9972e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/508729
[33m[INFO] loading file 26-26/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (508729, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (508729, 17)

[INFO] analyzing data
[INFO] 508729 rows
[INFO] ** appi_name:[21:99.99882%,7:0.00059%,30:0.0002%,22:0.0002%,8:0.0002%]
[INFO] ** classification:[normal:64.39696%,Single Stage Single Point:31.39432%,Multi Stage Single Point:4.20872%]
[INFO] ** dst:[21:43.31068%,10:21.08431%,8:18.12026%,9:17.48239%,22:0.00079%,24:0.00039%,16:0.00039%,2:0.00039%,15:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.9998%,0:0.0002%]
[INFO] ** i/f_name:[2:99.9998%,3:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.99882%,-33.760870000000004:0.00118%]
[INFO] ** modbus_function_description:[7:50.0001%,11:49.99872%,0:0.00118%]
[INFO] ** modbus_transaction_id:65536 (12.8823%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99961%,2:0.0002%,1:0.0002%]
[INFO] ** proxy_src_ip:[18:38.4692%,20:25.92618%,13:18.12065%,6:17.48239%,16:0.00039%,1:0.00039%,21:0.0002%,17:0.0002%,14:0.0002%,7:0.0002%]
[INFO] ** s_port:[1.45442:25.92559%,-0.32151:21.08431%,-1.27613:18.12006%,-0.23351:17.4822%,-0.33484:17.38489%,-1.27347:0.00039%,-1.02014:0.00039%,7.66617:0.0002%,-1.2708:0.0002%,-71.14931:0.0002%,-0.24151:0.0002%,11.57001:0.0002%,1.47576:0.0002%,1.46509:0.0002%,14.191239999999999:0.0002%,-3.3787199999999995:0.0002%,1.45709:0.0002%,-71.33197:0.0002%]
[INFO] ** scada_tag:[3:25.9252%,1:21.08431%,5:18.12006%,4:17.482%,2:17.38489%,0:0.00354%]
[INFO] ** service:[0.0048200000000000005:99.99882%,-211.09762999999998:0.00059%,-211.73542999999998:0.0002%,-211.35747999999998:0.0002%,-211.08818:0.0002%]
[INFO] ** src:[22:38.4692%,9:25.92618%,7:18.12065%,1:17.48239%,15:0.00039%,3:0.00039%,21:0.0002%,14:0.0002%,4:0.0002%,2:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1381 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2784 - tp: 72853.0000 - fp: 7065.0000 - tn: 312935.0000 - fn: 7147.0000 - accuracy: 0.9645 - precision: 0.9116 - recall: 0.9107 - auc: 0.9873 - val_loss: 0.5358 - val_tp: 12898.0000 - val_fp: 7102.0000 - val_tn: 72898.0000 - val_fn: 7102.0000 - val_accuracy: 0.8580 - val_precision: 0.6449 - val_recall: 0.6449 - val_auc: 0.9685
[INFO] saving weights to checkpoints/lstm-epoch-1-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0205 - tp: 79359.0000 - fp: 625.0000 - tn: 319375.0000 - fn: 641.0000 - accuracy: 0.9968 - precision: 0.9922 - recall: 0.9920 - auc: 1.0000 - val_loss: 0.0027 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0019 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0017 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0011 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0013 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/508729
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.2838e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.1942e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/508729
[33m[INFO] loading file 27-27/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (448859, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (448859, 17)

[INFO] analyzing data
[INFO] 448859 rows
[INFO] ** appi_name:[21:99.99933%,30:0.00067%]
[INFO] ** classification:[normal:64.33735%,Single Stage Single Point:35.66265%]
[INFO] ** dst:[21:43.2715%,10:21.06385%,8:18.1948%,9:17.46807%,22:0.00089%,15:0.00067%,24:0.00022%]
[INFO] ** i/f_dir:[1:99.99978%,0:0.00022%]
[INFO] ** i/f_name:[2:99.99933%,3:0.00067%]
[INFO] ** modbus_function_code:[0.02961:99.99933%,-33.760870000000004:0.00067%]
[INFO] ** modbus_function_description:[7:50.00033%,11:49.999%,0:0.00067%]
[INFO] ** modbus_transaction_id:65536 (14.60058%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99933%,1:0.00067%]
[INFO] ** proxy_src_ip:[18:38.40493%,20:25.93108%,13:18.19458%,6:17.46829%,17:0.00067%,16:0.00045%]
[INFO] ** s_port:[1.45442:25.93041%,-0.32151:21.06385%,-1.27613:18.19436%,-0.23351:17.46785%,-0.33484:17.34108%,-71.33197:0.00067%,-1.02014:0.00045%,-1.27347:0.00022%,1.45709:0.00022%,-0.24950999999999998:0.00022%,1.46509:0.00022%,1.47576:0.00022%,-0.24151:0.00022%]
[INFO] ** scada_tag:[3:25.92997%,1:21.06363%,5:18.19413%,4:17.46762%,2:17.34086%,0:0.00379%]
[INFO] ** service:[0.0048200000000000005:99.99933%,-211.73542999999998:0.00067%]
[INFO] ** src:[22:38.40493%,9:25.93108%,7:18.19458%,1:17.46829%,14:0.00067%,15:0.00045%]
[INFO] ** type:[0:99.99955%,1:0.00045%]
[INFO] ** unixtime:1220 (0.2718%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/448859
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.4145e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5286e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/448859
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 6.0554e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6241e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/448859
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.1676e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7942e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/448859
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.7281e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2689e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/448859
[33m[INFO] loading file 28-28/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (382775, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (382775, 17)

[INFO] analyzing data
[INFO] 382775 rows
[INFO] ** appi_name:[21:99.99216%,30:0.00183%,17:0.00131%,22:0.00105%,7:0.00105%,31:0.00078%,26:0.00078%,28:0.00026%,27:0.00026%,8:0.00026%,0:0.00026%]
[INFO] ** classification:[normal:64.3088%,Single Stage Single Point:35.6912%]
[INFO] ** dst:[21:43.28235%,10:21.01835%,8:18.2073%,9:17.48364%,6:0.00209%,16:0.00183%,18:0.00131%,15:0.00078%,22:0.00052%,17:0.00052%,2:0.00052%,25:0.00026%,7:0.00026%,0:0.00026%]
[INFO] ** i/f_dir:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name:[2:99.99922%,3:0.00078%]
[INFO] ** modbus_function_code:[0.02961:99.99216%,-33.760870000000004:0.00784%]
[INFO] ** modbus_function_description:[11:49.99621%,7:49.99595%,0:0.00784%]
[INFO] ** modbus_transaction_id:65536 (17.12129%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9953%,2:0.00392%,1:0.00078%]
[INFO] ** proxy_src_ip:[18:38.3361%,20:25.9646%,13:18.20756%,6:17.4839%,1:0.00209%,17:0.00183%,14:0.00157%,7:0.00131%,21:0.00078%,0:0.00026%]
[INFO] ** s_port:[1.45442:25.96434%,-0.32151:21.01835%,-1.27613:18.2073%,-0.23351:17.48338%,-0.33484:17.31775%,-71.14798:0.00105%,-71.14931:0.00105%,-71.33197:0.00078%,-0.08551:0.00052%,-0.24151:0.00052%,7.66617:0.00026%,-58.035180000000004:0.00026%,-1.2708:0.00026%,-64.19493:0.00026%,-5.1466400000000005:0.00026%,13.431270000000001:0.00026%,11.57001:0.00026%,14.4699:0.00026%,1.47576:0.00026%,14.191239999999999:0.00026%,-5.08665:0.00026%,10.192739999999999:0.00026%,-3.3787199999999995:0.00026%,6.1115699999999995:0.00026%,2.05573:0.00026%,-43.76509:0.00026%,2.52505:0.00026%,11.862:0.00026%,-58.032509999999995:0.00026%]
[INFO] ** scada_tag:[3:25.96408%,1:21.01835%,5:18.2073%,4:17.48312%,2:17.31775%,0:0.00941%]
[INFO] ** service:[0.0048200000000000005:99.99216%,-205.44247:0.00131%,-186.43601999999998:0.00131%,-211.09762999999998:0.00105%,-211.08346:0.00105%,-211.08818:0.00105%,-211.73542999999998:0.00078%,-186.44547:0.00026%,-183.8612:0.00026%,-185.9872:0.00026%,-211.35747999999998:0.00026%,-202.75898:0.00026%]
[INFO] ** src:[22:38.3361%,9:25.9646%,7:18.20756%,1:17.4839%,3:0.00235%,2:0.00157%,21:0.00131%,4:0.00105%,14:0.00078%,8:0.00052%,17:0.00026%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1040 (0.2717%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/382775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.0432e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.0069e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/382775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.5019e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3152e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/382775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1677e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.9223e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/382775
[33m[INFO] loading file 29-29/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582775, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582775, 17)

[INFO] analyzing data
[INFO] 582775 rows
[INFO] ** appi_name:[21:99.9988%,30:0.00051%,31:0.00017%,26:0.00017%,9:0.00017%,3:0.00017%]
[INFO] ** classification:[normal:64.38746%,Single Stage Single Point:35.61254%]
[INFO] ** dst:[21:43.32427%,10:21.06182%,8:18.14422%,9:17.46798%,22:0.00051%,15:0.00051%,24:0.00017%,18:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99966%,0:0.00034%]
[INFO] ** i/f_name:[2:99.99949%,3:0.00051%]
[INFO] ** modbus_function_code:[0.02961:99.9988%,-33.760870000000004:0.0012%]
[INFO] ** modbus_function_description:[7:49.99974%,11:49.99906%,0:0.0012%]
[INFO] ** modbus_transaction_id:65536 (11.24551%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99914%,1:0.00051%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.43542%,20:25.95084%,13:18.14457%,6:17.4678%,17:0.00051%,21:0.00017%,16:0.00017%,7:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95032%,-0.32151:21.06164%,-1.27613:18.14422%,-0.23351:17.4678%,-0.33484:17.37377%,-71.33197:0.00051%,1.45709:0.00034%,-71.14798:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,6.1115699999999995:0.00017%,14.4699:0.00017%]
[INFO] ** scada_tag:[3:25.94998%,1:21.06147%,5:18.14422%,4:17.46746%,2:17.37377%,0:0.00309%]
[INFO] ** service:[0.0048200000000000005:99.99897%,-211.73542999999998:0.00051%,-183.8612:0.00017%,-211.08346:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.43542%,9:25.95084%,7:18.14457%,1:17.4678%,14:0.00051%,21:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1583 (0.27163%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.1412e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.8520e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1342e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.1813e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.9670e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.4207e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8435e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5559e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.6844e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4885e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/582775
[33m[INFO] loading file 30-30/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582775, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582775, 17)

[INFO] analyzing data
[INFO] 582775 rows
[INFO] ** appi_name:[21:99.9976%,30:0.00172%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.37459%,Single Stage Single Point:35.62541%]
[INFO] ** dst:[21:43.34143%,10:21.03024%,8:18.14525%,9:17.47982%,15:0.00172%,22:0.00069%,24:0.00034%,25:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99846%,0:0.00154%]
[INFO] ** i/f_name:[2:99.99828%,3:0.00172%]
[INFO] ** modbus_function_code:[0.02961:99.9976%,-33.760870000000004:0.0024%]
[INFO] ** modbus_function_description:[7:49.99957%,11:49.99803%,0:0.0024%]
[INFO] ** modbus_transaction_id:65536 (11.24551%)
[INFO] ** orig:[0:99.99914%,2:0.00051%,1:0.00034%]
[INFO] ** proto:[0:99.99794%,1:0.00172%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.37673%,20:25.99477%,13:18.1456%,6:17.48033%,17:0.00172%,7:0.00034%,16:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.99459%,-0.32151:21.03007%,-1.27613:18.14508%,-0.23351:17.47964%,-0.33484:17.34666%,-71.33197:0.00172%,-0.24151:0.00051%,-1.27347:0.00034%,-71.14798:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:25.99425%,1:21.03007%,5:18.14491%,4:17.47947%,2:17.34649%,0:0.0048%]
[INFO] ** service:[0.0048200000000000005:99.99777%,-211.73542999999998:0.00172%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.37673%,9:25.99477%,7:18.1456%,1:17.48033%,14:0.0012%,21:0.00086%,16:0.00017%,15:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99914%,1:0.00086%]
[INFO] ** unixtime:1584 (0.2718%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.6679e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2601e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6721e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0888e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.7963e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5619e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9406e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5554e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0938e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0011 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-1-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/582775
[33m[INFO] loading file 31-31/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582775, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582775, 17)

[INFO] analyzing data
[INFO] 582775 rows
[INFO] ** appi_name:[21:99.99966%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.3775%,Single Stage Single Point:35.6225%]
[INFO] ** dst:[21:43.32513%,10:21.05083%,8:18.12072%,9:17.50161%,22:0.00103%,24:0.00034%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99966%,-33.760870000000004:0.00034%]
[INFO] ** modbus_function_description:[7:50.00026%,11:49.9994%,0:0.00034%]
[INFO] ** modbus_transaction_id:65536 (11.24551%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.39835%,20:25.97829%,13:18.12089%,6:17.50161%,16:0.00051%,7:0.00034%]
[INFO] ** s_port:[1.45442:25.97761%,-0.32151:21.05083%,-1.27613:18.12054%,-0.23351:17.50144%,-0.33484:17.34752%,-1.02014:0.00051%,-1.27347:0.00034%,1.45709:0.00034%,-71.14798:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-0.24151:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.97726%,1:21.05066%,5:18.12037%,4:17.50109%,2:17.34735%,0:0.00326%]
[INFO] ** service:[0.0048200000000000005:99.99966%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.39835%,9:25.97829%,7:18.12089%,1:17.50161%,15:0.00051%,21:0.00034%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1583 (0.27163%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.0865e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9879e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8054e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6798e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5684e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4657e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3732e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2905e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5919e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3783e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/582775
[33m[INFO] loading file 32-32/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582775, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582775, 17)

[INFO] analyzing data
[INFO] 582775 rows
[INFO] ** appi_name:[21:99.99657%,30:0.00292%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.38214%,Single Stage Single Point:35.61786%]
[INFO] ** dst:[21:43.32187%,10:21.05581%,8:18.15349%,9:17.46437%,15:0.00292%,22:0.00086%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99743%,0:0.00257%]
[INFO] ** i/f_name:[2:99.99708%,3:0.00292%]
[INFO] ** modbus_function_code:[0.02961:99.99657%,-33.760870000000004:0.00343%]
[INFO] ** modbus_function_description:[7:49.99923%,11:49.99734%,0:0.00343%]
[INFO] ** modbus_transaction_id:65536 (11.24551%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99657%,1:0.00292%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.42306%,20:25.95496%,13:18.15349%,6:17.46489%,17:0.00292%,14:0.00051%,16:0.00017%]
[INFO] ** s_port:[1.45442:25.95444%,-0.32151:21.05581%,-1.27613:18.15315%,-0.23351:17.4642%,-0.33484:17.36725%,-71.33197:0.00292%,-0.24151:0.00051%,-1.2708:0.00017%,-1.02014:0.00017%,13.431270000000001:0.00017%,-71.14798:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.9541%,1:21.05564%,5:18.15315%,4:17.46386%,2:17.36725%,0:0.00601%]
[INFO] ** service:[0.0048200000000000005:99.99657%,-211.73542999999998:0.00292%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.42306%,9:25.95496%,7:18.15349%,1:17.46489%,14:0.00292%,2:0.00051%,15:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1581 (0.27129%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9730e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8231e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4865e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.8725e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3929e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2319e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1488e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0544e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.9677e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.1856e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/582775
[33m[INFO] loading file 33-33/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582775, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582775, 17)

[INFO] analyzing data
[INFO] 582775 rows
[INFO] ** appi_name:[21:99.99708%,30:0.00103%,17:0.00069%,22:0.00051%,31:0.00017%,28:0.00017%,26:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:64.39552%,Single Stage Single Point:35.60448%]
[INFO] ** dst:[21:43.32736%,10:21.06353%,8:18.1226%,9:17.48188%,22:0.00137%,15:0.00103%,16:0.00069%,6:0.00069%,24:0.00034%,17:0.00034%,18:0.00017%]
[INFO] ** i/f_dir:[1:99.99897%,0:0.00103%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.99708%,-33.760870000000004:0.00292%]
[INFO] ** modbus_function_description:[7:49.99974%,11:49.99734%,0:0.00292%]
[INFO] ** modbus_transaction_id:65536 (11.24551%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99811%,1:0.00103%,2:0.00086%]
[INFO] ** proxy_src_ip:[18:38.42375%,20:25.968%,13:18.1226%,6:17.48205%,17:0.00103%,16:0.00069%,1:0.00069%,21:0.00034%,14:0.00034%,7:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.96714%,-0.32151:21.06353%,-1.27613:18.12226%,-0.23351:17.4817%,-0.33484:17.36022%,-71.33197:0.00103%,-1.02014:0.00069%,1.45709:0.00051%,-71.14931:0.00051%,-1.27347:0.00034%,-5.08665:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,-71.14798:0.00017%,-58.032509999999995:0.00017%,-58.035180000000004:0.00017%,-0.24151:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.9668%,1:21.06353%,5:18.12209%,4:17.48153%,2:17.36022%,0:0.00583%]
[INFO] ** service:[0.0048200000000000005:99.99708%,-211.73542999999998:0.00103%,-205.44247:0.00069%,-211.08818:0.00051%,-211.09762999999998:0.00017%,-211.08346:0.00017%,-185.9872:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.42375%,9:25.968%,7:18.1226%,1:17.48205%,14:0.00103%,15:0.00069%,3:0.00069%,21:0.00034%,4:0.00034%,2:0.00034%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1585 (0.27197%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.7044e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.2225e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5254e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.7242e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.7639e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.3713e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4120e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.1841e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/582775
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3740e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.7247e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/582775
[33m[INFO] loading file 34-34/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (424208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (424208, 17)

[INFO] analyzing data
[INFO] 424208 rows
[INFO] ** appi_name:[21:99.99764%,30:0.00071%,7:0.00071%,31:0.00024%,22:0.00024%,8:0.00024%,6:0.00024%]
[INFO] ** classification:[normal:64.34509%,Single Stage Single Point:35.65491%]
[INFO] ** dst:[21:43.28513%,10:21.05689%,8:18.18825%,9:17.4669%,22:0.00071%,15:0.00071%,16:0.00047%,2:0.00047%,18:0.00024%,6:0.00024%]
[INFO] ** i/f_dir:[1:99.99929%,0:0.00071%]
[INFO] ** i/f_name:[2:99.99929%,3:0.00071%]
[INFO] ** modbus_function_code:[0.02961:99.99764%,-33.760870000000004:0.00236%]
[INFO] ** modbus_function_description:[7:49.99929%,11:49.99835%,0:0.00236%]
[INFO] ** modbus_transaction_id:65536 (15.44903%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99882%,1:0.00071%,2:0.00047%]
[INFO] ** proxy_src_ip:[18:38.39343%,20:25.94883%,13:18.18801%,6:17.46737%,17:0.00071%,1:0.00071%,21:0.00047%,14:0.00024%,7:0.00024%]
[INFO] ** s_port:[1.45442:25.94836%,-0.32151:21.05665%,-1.27613:18.18801%,-0.23351:17.46667%,-0.33484:17.33678%,-0.24151:0.00071%,-71.33197:0.00071%,-3.0613900000000003:0.00024%,-3.3787199999999995:0.00024%,14.191239999999999:0.00024%,1.46509:0.00024%,1.47576:0.00024%,11.57001:0.00024%,-49.275529999999996:0.00024%,-71.14931:0.00024%,7.66617:0.00024%]
[INFO] ** scada_tag:[3:25.94812%,1:21.05642%,5:18.18778%,4:17.4662%,2:17.33678%,0:0.00471%]
[INFO] ** service:[0.0048200000000000005:99.99788%,-211.09762999999998:0.00071%,-211.73542999999998:0.00071%,-186.43601999999998:0.00024%,-211.35747999999998:0.00024%,-211.08818:0.00024%]
[INFO] ** src:[22:38.39343%,9:25.94883%,7:18.18801%,1:17.46737%,14:0.00071%,3:0.00071%,4:0.00047%,21:0.00024%,2:0.00024%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1152 (0.27156%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/424208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.0426e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.7599e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/424208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.3093e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.8411e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/424208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.9005e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8541e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/424208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.2084e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.4447e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-33-34-batch-300000-400000
[INFO] processing batch 400000-500000/424208
[33m[INFO] loading file 35-35/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524208, 17)

[INFO] analyzing data
[INFO] 524208 rows
[INFO] ** appi_name:[21:99.99886%,30:0.00114%]
[INFO] ** classification:[normal:64.37769%,Single Stage Single Point:35.62231%]
[INFO] ** dst:[21:43.33566%,10:21.03936%,8:18.14413%,9:17.47856%,22:0.00114%,15:0.00114%]
[INFO] ** i/f_dir:[1:99.99905%,0:0.00095%]
[INFO] ** i/f_name:[2:99.99886%,3:0.00114%]
[INFO] ** modbus_function_code:[0.02961:99.99886%,-33.760870000000004:0.00114%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99886%,0:0.00114%]
[INFO] ** modbus_transaction_id:65536 (12.50191%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99886%,1:0.00114%]
[INFO] ** proxy_src_ip:[18:38.40346%,20:25.97213%,13:18.14375%,6:17.47875%,17:0.00114%,16:0.00076%]
[INFO] ** s_port:[1.45442:25.97156%,-0.32151:21.03936%,-1.27613:18.14375%,-0.23351:17.47837%,-0.33484:17.3641%,-71.33197:0.00114%,-1.02014:0.00076%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.97118%,1:21.03936%,5:18.14356%,4:17.47799%,2:17.3641%,0:0.00382%]
[INFO] ** service:[0.0048200000000000005:99.99886%,-211.73542999999998:0.00114%]
[INFO] ** src:[22:38.40346%,9:25.97213%,7:18.14375%,1:17.47875%,14:0.00114%,15:0.00076%]
[INFO] ** type:[0:99.99905%,1:0.00095%]
[INFO] ** unixtime:1423 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.1643e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.6169e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.0698e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2176e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4602e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.1435e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.6790e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2630e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.9417e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6199e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/524208
[33m[INFO] loading file 36-36/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524208, 17)

[INFO] analyzing data
[INFO] 524208 rows
[INFO] ** appi_name:[21:99.99866%,30:0.00057%,31:0.00038%,33:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.35156%,Single Stage Single Point:35.64844%]
[INFO] ** dst:[21:43.33032%,10:21.01914%,8:18.1613%,9:17.48695%,22:0.00076%,15:0.00057%,24:0.00038%,18:0.00038%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99943%,0:0.00057%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99866%,-33.760870000000004:0.00134%]
[INFO] ** modbus_function_description:[7:50.00038%,11:49.99828%,0:0.00134%]
[INFO] ** modbus_transaction_id:65536 (12.50191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99886%,2:0.00057%,1:0.00057%]
[INFO] ** proxy_src_ip:[18:38.36836%,20:25.98129%,13:18.16149%,6:17.48752%,17:0.00057%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.98072%,-0.32151:21.01895%,-1.27613:18.16092%,-0.23351:17.48676%,-0.33484:17.34941%,-0.24151:0.00057%,-71.33197:0.00057%,-1.27347:0.00038%,-0.08551:0.00038%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-49.275529999999996:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.98034%,1:21.01876%,5:18.16073%,4:17.48657%,2:17.34922%,0:0.00439%]
[INFO] ** service:[0.0048200000000000005:99.99886%,-211.73542999999998:0.00057%,-186.43601999999998:0.00038%,-186.44547:0.00019%]
[INFO] ** src:[22:38.36836%,9:25.98129%,7:18.16149%,1:17.48752%,14:0.00057%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1424 (0.27165%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.4527e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3817e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 1.2958e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.6841e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 8s - loss: 1.5314e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.3844e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 4.4017e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5360e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 3.1623e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.0056e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/524208
[33m[INFO] loading file 37-37/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524208, 17)

[INFO] analyzing data
[INFO] 524208 rows
[INFO] ** appi_name:[21:99.99886%,30:0.00076%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.38627%,Single Stage Single Point:35.61373%]
[INFO] ** dst:[21:43.33814%,10:21.04623%,8:18.13383%,9:17.4797%,22:0.00076%,15:0.00076%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99924%,3:0.00076%]
[INFO] ** modbus_function_code:[0.02961:99.99886%,-33.760870000000004:0.00114%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99866%,0:0.00114%]
[INFO] ** modbus_transaction_id:65536 (12.50191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99905%,1:0.00076%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.39545%,20:25.9893%,13:18.13402%,6:17.4797%,17:0.00076%,16:0.00038%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.98873%,-0.32151:21.04623%,-1.27613:18.13364%,-0.23351:17.47951%,-0.33484:17.34922%,-71.33197:0.00076%,-1.02014:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.98854%,1:21.04623%,5:18.13345%,4:17.47932%,2:17.34903%,0:0.00343%]
[INFO] ** service:[0.0048200000000000005:99.99886%,-211.73542999999998:0.00076%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.39545%,9:25.9893%,7:18.13402%,1:17.4797%,14:0.00076%,15:0.00038%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1424 (0.27165%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.4947e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.0011e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.9296e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5412e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7762e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2273e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.2201e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.6628e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6837e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3964e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/524208
[33m[INFO] loading file 38-38/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524208, 17)

[INFO] analyzing data
[INFO] 524208 rows
[INFO] ** appi_name:[21:99.99905%,30:0.00019%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.41126%,Single Stage Single Point:35.58874%]
[INFO] ** dst:[21:43.32212%,10:21.08705%,8:18.09625%,9:17.49267%,22:0.00095%,25:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99905%,-33.760870000000004:0.00095%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99943%,0:0.00095%]
[INFO] ** modbus_transaction_id:65536 (12.50191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99943%,2:0.00038%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.45439%,20:25.95535%,13:18.09606%,6:17.49306%,7:0.00038%,17:0.00019%,16:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95458%,-0.32151:21.08686%,-1.27613:18.09587%,-0.23351:17.49248%,-0.33484:17.36753%,1.45709:0.00038%,-0.24151:0.00038%,-71.14798:0.00019%,-64.19493:0.00019%,-1.02014:0.00019%,-61.95768:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,10.192739999999999:0.00019%,-0.24950999999999998:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.9542%,1:21.08686%,5:18.09587%,4:17.49229%,2:17.36753%,0:0.00324%]
[INFO] ** service:[0.0048200000000000005:99.99924%,-186.44547:0.00019%,-211.08346:0.00019%,-211.73542999999998:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.45439%,9:25.95535%,7:18.09606%,1:17.49306%,21:0.00038%,16:0.00019%,15:0.00019%,14:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1425 (0.27184%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5919e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.0899e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.6939e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3351e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2442e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.1591e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0618e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.1140e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.6471e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2499e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/524208
[33m[INFO] loading file 39-39/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524208, 17)

[INFO] analyzing data
[INFO] 524208 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.41145%,Single Stage Single Point:35.58855%]
[INFO] ** dst:[21:43.32269%,10:21.088%,8:18.13002%,9:17.45815%,22:0.00095%,24:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.00057%,11:49.99943%]
[INFO] ** modbus_transaction_id:65536 (12.50191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.46164%,20:25.94924%,13:18.1304%,6:17.45815%,16:0.00057%]
[INFO] ** s_port:[1.45442:25.94886%,-0.32151:21.088%,-1.27613:18.13002%,-0.23351:17.45796%,-0.33484:17.37364%,-1.02014:0.00057%,-1.27347:0.00019%,1.45709:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.94848%,1:21.08781%,5:18.12983%,4:17.45796%,2:17.37345%,0:0.00248%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.46164%,9:25.94924%,7:18.1304%,1:17.45815%,15:0.00057%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1423 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6522e-04 - tp: 79997.0000 - fp: 3.0000 - tn: 319997.0000 - fn: 3.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.0831e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3778e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.3390e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.9818e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.9532e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4485e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.2887e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.4082e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.9115e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/524208
[33m[INFO] loading file 40-40/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524208, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524208, 17)

[INFO] analyzing data
[INFO] 524208 rows
[INFO] ** appi_name:[21:99.99618%,30:0.00324%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.33782%,Single Stage Single Point:35.66218%]
[INFO] ** dst:[21:43.29541%,10:21.03726%,8:18.19087%,9:17.4715%,15:0.00324%,22:0.00095%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99695%,0:0.00305%]
[INFO] ** i/f_name:[2:99.99676%,3:0.00324%]
[INFO] ** modbus_function_code:[0.02961:99.99618%,-33.760870000000004:0.00382%]
[INFO] ** modbus_function_description:[7:49.99924%,11:49.99695%,0:0.00382%]
[INFO] ** modbus_transaction_id:65536 (12.50191%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99618%,1:0.00324%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.35271%,20:25.98091%,13:18.19068%,6:17.47188%,17:0.00324%,14:0.00057%]
[INFO] ** s_port:[1.45442:25.97995%,-0.32151:21.03726%,-1.27613:18.19049%,-0.23351:17.47131%,-0.33484:17.31545%,-71.33197:0.00324%,1.45709:0.00057%,-0.24151:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,13.431270000000001:0.00019%]
[INFO] ** scada_tag:[3:25.97957%,1:21.03707%,5:18.1903%,4:17.47093%,2:17.31526%,0:0.00687%]
[INFO] ** service:[0.0048200000000000005:99.99618%,-211.73542999999998:0.00324%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.35271%,9:25.98091%,7:18.19068%,1:17.47188%,14:0.00324%,2:0.00057%]
[INFO] ** type:[0:99.99905%,1:0.00095%]
[INFO] ** unixtime:1426 (0.27203%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6218e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3910e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.4810e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.5983e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.2116e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.8579e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.8979e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.1148e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/524208
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.8174e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4451e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/524208
[33m[INFO] loading file 41-41/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (464366, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (464366, 17)

[INFO] analyzing data
[INFO] 464366 rows
[INFO] ** appi_name:[21:99.99634%,30:0.00108%,22:0.00086%,17:0.00086%,32:0.00022%,28:0.00022%,26:0.00022%,7:0.00022%]
[INFO] ** classification:[normal:64.39231%,Single Stage Single Point:35.60769%]
[INFO] ** dst:[21:43.32208%,10:21.06571%,8:18.13699%,9:17.47049%,16:0.00108%,15:0.00108%,6:0.00108%,22:0.00065%,24:0.00043%,17:0.00043%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99634%,-33.760870000000004:0.00366%]
[INFO] ** modbus_function_description:[7:49.99892%,11:49.99742%,0:0.00366%]
[INFO] ** modbus_transaction_id:65536 (14.11301%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99763%,2:0.00129%,1:0.00108%]
[INFO] ** proxy_src_ip:[18:38.43994%,20:25.94807%,13:18.1372%,6:17.4707%,17:0.00108%,1:0.00086%,21:0.00043%,16:0.00043%,14:0.00043%,0:0.00043%,7:0.00022%,2:0.00022%]
[INFO] ** s_port:[1.45442:25.94764%,-0.32151:21.06571%,-1.27613:18.13656%,-0.23351:17.47027%,-0.33484:17.37423%,-71.33197:0.00108%,-71.14931:0.00086%,-1.02014:0.00043%,-1.27347:0.00043%,-71.14798:0.00022%,-0.24151:0.00022%,-58.035180000000004:0.00022%,-1.2708:0.00022%,-5.1466400000000005:0.00022%,1.47576:0.00022%,1.46509:0.00022%,-64.19226:0.00022%,-5.08665:0.00022%,-0.24950999999999998:0.00022%,2.05573:0.00022%,-43.76509:0.00022%,-58.032509999999995:0.00022%]
[INFO] ** scada_tag:[3:25.94742%,1:21.06571%,5:18.13656%,4:17.47006%,2:17.37423%,0:0.00603%]
[INFO] ** service:[0.0048200000000000005:99.99634%,-211.73542999999998:0.00108%,-205.44247:0.00086%,-211.08818:0.00086%,89.64175:0.00022%,-211.09762999999998:0.00022%,-211.08346:0.00022%,-185.9872:0.00022%]
[INFO] ** src:[22:38.43994%,9:25.94807%,7:18.1372%,1:17.4707%,14:0.00108%,3:0.00086%,15:0.00043%,8:0.00043%,4:0.00043%,2:0.00043%,21:0.00022%,17:0.00022%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1260 (0.27134%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/464366
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4353e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3941e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/464366
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.3255e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9187e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/464366
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0221e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.6509e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/464366
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.1477e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.8414e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/464366
[33m[INFO] loading file 42-42/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (407880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (407880, 17)

[INFO] analyzing data
[INFO] 407880 rows
[INFO] ** appi_name:[21:99.99166%,30:0.00221%,17:0.00123%,31:0.00098%,26:0.00098%,7:0.00098%,22:0.00074%,28:0.00025%,27:0.00025%,9:0.00025%,8:0.00025%,0:0.00025%]
[INFO] ** classification:[normal:64.37947%,Single Stage Single Point:35.62053%]
[INFO] ** dst:[21:43.31691%,10:21.05374%,8:18.17741%,9:17.44263%,16:0.00221%,6:0.00196%,18:0.00123%,2:0.00098%,22:0.00074%,15:0.00074%,17:0.00049%,25:0.00025%,24:0.00025%,7:0.00025%,0:0.00025%]
[INFO] ** i/f_dir:[1:99.99926%,0:0.00074%]
[INFO] ** i/f_name:[2:99.99926%,3:0.00074%]
[INFO] ** modbus_function_code:[0.02961:99.99166%,-33.760870000000004:0.00834%]
[INFO] ** modbus_function_description:[7:49.99657%,11:49.9951%,0:0.00834%]
[INFO] ** modbus_transaction_id:65536 (16.06747%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99559%,2:0.00368%,1:0.00074%]
[INFO] ** proxy_src_ip:[18:38.4135%,20:25.95739%,13:18.1779%,6:17.44263%,17:0.00221%,1:0.00221%,14:0.00147%,21:0.00098%,7:0.00074%,0:0.00049%,16:0.00025%,2:0.00025%]
[INFO] ** s_port:[1.45442:25.9569%,-0.32151:21.05374%,-1.27613:18.17741%,-0.23351:17.44239%,-0.33484:17.35976%,-71.14931:0.00098%,-71.14798:0.00098%,-71.33197:0.00074%,11.57001:0.00049%,-0.08551:0.00049%,-3.3787199999999995:0.00049%,-0.24151:0.00025%,13.431270000000001:0.00025%,-5.1466400000000005:0.00025%,0.31847:0.00025%,-1.02014:0.00025%,-1.2708:0.00025%,-58.035180000000004:0.00025%,7.66617:0.00025%,-64.19493:0.00025%,1.47576:0.00025%,14.4699:0.00025%,15.912510000000001:0.00025%,14.191239999999999:0.00025%,7.9608300000000005:0.00025%,-5.08665:0.00025%,10.192739999999999:0.00025%,-3.0613900000000003:0.00025%,1.45709:0.00025%,2.05573:0.00025%,-43.76509:0.00025%,11.862:0.00025%,-1.27347:0.00025%,-58.032509999999995:0.00025%]
[INFO] ** scada_tag:[3:25.95641%,1:21.05374%,5:18.17716%,4:17.44239%,2:17.35952%,0:0.01079%]
[INFO] ** service:[0.0048200000000000005:99.99166%,-211.09762999999998:0.00172%,-205.44247:0.00123%,-186.43601999999998:0.00123%,-211.08346:0.00098%,-211.08818:0.00098%,-211.73542999999998:0.00074%,-211.35747999999998:0.00049%,-186.44547:0.00025%,-183.8612:0.00025%,-185.9872:0.00025%,-202.75898:0.00025%]
[INFO] ** src:[22:38.4135%,9:25.95739%,7:18.1779%,1:17.44263%,3:0.00294%,2:0.00172%,4:0.00123%,21:0.00098%,14:0.00074%,8:0.00049%,17:0.00025%,15:0.00025%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1107 (0.2714%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/407880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.4324e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3273e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/407880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.1078e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7583e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/407880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.0598e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2853e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/407880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.5904e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.3843e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-41-42-batch-300000-400000
[INFO] processing batch 400000-500000/407880
[33m[INFO] loading file 43-43/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.99921%,30:0.00059%,26:0.0002%]
[INFO] ** classification:[normal:64.40124%,Single Stage Single Point:35.59876%]
[INFO] ** dst:[21:43.3313%,10:21.06817%,8:18.12653%,9:17.47204%,22:0.00098%,15:0.00059%,24:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.9998%,0:0.0002%]
[INFO] ** i/f_name:[2:99.99941%,3:0.00059%]
[INFO] ** modbus_function_code:[0.02961:99.99921%,-33.760870000000004:0.00079%]
[INFO] ** modbus_function_description:[7:50.0002%,11:49.99902%,0:0.00079%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99921%,1:0.00059%,2:0.0002%]
[INFO] ** proxy_src_ip:[18:38.42227%,20:25.97759%,13:18.12672%,6:17.47224%,17:0.00059%,16:0.00039%,1:0.0002%]
[INFO] ** s_port:[1.45442:25.977%,-0.32151:21.06817%,-1.27613:18.12633%,-0.23351:17.47184%,-0.33484:17.3541%,-71.33197:0.00059%,1.45709:0.00039%,-1.02014:0.00039%,-71.14798:0.0002%,-1.27347:0.0002%,-0.24950999999999998:0.0002%,1.47576:0.0002%,-0.24151:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.97661%,1:21.06817%,5:18.12613%,4:17.47145%,2:17.3539%,0:0.00374%]
[INFO] ** service:[0.0048200000000000005:99.99921%,-211.73542999999998:0.00059%,-211.08346:0.0002%]
[INFO] ** src:[22:38.42227%,9:25.97759%,7:18.12672%,1:17.47224%,14:0.00059%,15:0.00039%,3:0.0002%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1381 (0.27191%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.0071e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9133e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3632e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7629e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.6421e-05 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5842e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.3437e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0380e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 7.6332e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9791e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 44-44/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.99803%,30:0.00079%,31:0.00059%,0:0.00039%,22:0.0002%]
[INFO] ** classification:[normal:64.36501%,Single Stage Single Point:35.63499%]
[INFO] ** dst:[21:43.32185%,10:21.04001%,8:18.16965%,9:17.46515%,22:0.00098%,15:0.00079%,18:0.00059%,25:0.00039%,24:0.00039%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99921%,0:0.00079%]
[INFO] ** i/f_name:[2:99.99921%,3:0.00079%]
[INFO] ** modbus_function_code:[0.02961:99.99803%,-33.760870000000004:0.00197%]
[INFO] ** modbus_function_description:[7:50.0002%,11:49.99783%,0:0.00197%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99803%,2:0.00118%,1:0.00079%]
[INFO] ** proxy_src_ip:[18:38.40947%,20:25.95278%,13:18.16984%,6:17.46574%,17:0.00079%,7:0.00039%,16:0.0002%,5:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.95219%,-0.32151:21.04001%,-1.27613:18.16925%,-0.23351:17.46495%,-0.33484:17.36946%,-71.33197:0.00079%,-0.24151:0.00059%,-64.19493:0.00039%,-0.08551:0.00039%,-1.27347:0.00039%,1.46509:0.0002%,1.47576:0.0002%,-0.24950999999999998:0.0002%,1.45709:0.0002%,4.42897:0.0002%,-71.14931:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.9518%,1:21.04001%,5:18.16925%,4:17.46456%,2:17.36926%,0:0.00512%]
[INFO] ** service:[0.0048200000000000005:99.99803%,-211.73542999999998:0.00079%,-186.43601999999998:0.00059%,-186.44547:0.00039%,-211.08818:0.0002%]
[INFO] ** src:[22:38.40947%,9:25.95278%,7:18.16984%,1:17.46574%,14:0.00079%,21:0.00039%,17:0.0002%,16:0.0002%,15:0.0002%,8:0.0002%,3:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1378 (0.27132%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0865e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8802e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.5209e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7880e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0335e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.1822e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.7076e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.7586e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.1717e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1376e-04 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 45-45/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.99902%,30:0.00059%,26:0.0002%,9:0.0002%]
[INFO] ** classification:[normal:64.41797%,Single Stage Single Point:35.58203%]
[INFO] ** dst:[21:43.32441%,10:21.0914%,8:18.12003%,9:17.462%,22:0.00118%,15:0.00059%,6:0.0002%,0:0.0002%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99941%,3:0.00059%]
[INFO] ** modbus_function_code:[0.02961:99.99902%,-33.760870000000004:0.00098%]
[INFO] ** modbus_function_description:[7:50.00039%,11:49.99862%,0:0.00098%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99921%,1:0.00059%,2:0.0002%]
[INFO] ** proxy_src_ip:[18:38.48527%,20:25.93113%,13:18.12003%,6:17.4622%,17:0.00059%,16:0.00039%,21:0.0002%,1:0.0002%]
[INFO] ** s_port:[1.45442:25.93053%,-0.32151:21.0914%,-1.27613:18.12003%,-0.23351:17.462%,-0.33484:17.39387%,1.45709:0.00059%,-71.33197:0.00059%,-1.02014:0.00039%,-71.14798:0.0002%,14.4699:0.0002%,-0.24151:0.0002%]
[INFO] ** scada_tag:[3:25.93014%,1:21.0912%,5:18.12003%,4:17.462%,2:17.39368%,0:0.00295%]
[INFO] ** service:[0.0048200000000000005:99.99902%,-211.73542999999998:0.00059%,-183.8612:0.0002%,-211.08346:0.0002%]
[INFO] ** src:[22:38.48527%,9:25.93113%,7:18.12003%,1:17.4622%,14:0.00059%,15:0.00039%,4:0.0002%,3:0.0002%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** unixtime:1379 (0.27152%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.7881e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3736e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.1690e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8285e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6996e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6276e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4958e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4028e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.3148e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2344e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 46-46/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.99823%,30:0.00098%,26:0.0002%,17:0.0002%,12:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:64.42093%,Single Stage Single Point:35.57907%]
[INFO] ** dst:[21:43.35%,10:21.06836%,8:18.10979%,9:17.46928%,22:0.00098%,15:0.00098%,25:0.0002%,16:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99902%,0:0.00098%]
[INFO] ** i/f_name:[2:99.99902%,3:0.00098%]
[INFO] ** modbus_function_code:[0.02961:99.99823%,-33.760870000000004:0.00177%]
[INFO] ** modbus_function_description:[11:49.99921%,7:49.99902%,0:0.00177%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:99.99961%,1:0.00039%]
[INFO] ** proto:[0:99.99862%,1:0.00098%,2:0.00039%]
[INFO] ** proxy_src_ip:[18:38.44097%,20:25.9772%,13:18.10979%,6:17.46987%,17:0.00098%,16:0.00039%,7:0.00039%,5:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.977%,-0.32151:21.06817%,-1.27613:18.10959%,-0.23351:17.46909%,-0.33484:17.3728%,-71.33197:0.00098%,-0.24151:0.00059%,-1.02014:0.00039%,-71.14798:0.0002%,-0.24950999999999998:0.0002%,10.192739999999999:0.0002%,1.47576:0.0002%,-61.95768:0.0002%,-64.19493:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.97681%,1:21.06797%,5:18.1094%,4:17.46869%,2:17.3728%,0:0.00433%]
[INFO] ** service:[0.0048200000000000005:99.99842%,-211.73542999999998:0.00098%,-186.44547:0.0002%,-211.08346:0.0002%,-205.44247:0.0002%]
[INFO] ** src:[22:38.44097%,9:25.9772%,7:18.10979%,1:17.46987%,14:0.00098%,21:0.00039%,15:0.00039%,16:0.0002%,8:0.0002%]
[INFO] ** type:[0:99.99921%,1:0.00079%]
[INFO] ** unixtime:1381 (0.27191%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 6.4023e-05 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.0807e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.3312e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6086e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.4307e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1430e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5667e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0030e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1635e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0068e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 47-47/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.9998%,33:0.0002%]
[INFO] ** classification:[normal:64.39257%,Single Stage Single Point:35.60743%]
[INFO] ** dst:[21:43.30058%,10:21.09022%,8:18.12849%,9:17.47854%,22:0.00177%,24:0.00039%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.9998%,-33.760870000000004:0.0002%]
[INFO] ** modbus_function_description:[7:50.00138%,11:49.99842%,0:0.0002%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.46086%,20:25.93073%,13:18.12889%,6:17.47893%,16:0.00039%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.92975%,-0.32151:21.09022%,-1.27613:18.1283%,-0.23351:17.47834%,-0.33484:17.37064%,1.45709:0.00059%,-0.24151:0.00059%,-1.27347:0.00039%,-1.02014:0.00039%,-61.95635:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.92916%,1:21.09002%,5:18.1281%,4:17.47814%,2:17.37044%,0:0.00413%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.46086%,9:25.93073%,7:18.12889%,1:17.47893%,15:0.00039%,8:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1379 (0.27152%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1989e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.9888e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.2956e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.8680e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9029e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5474e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.0020e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9378e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.7926e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1749e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 48-48/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.99665%,30:0.00276%,31:0.0002%,27:0.0002%,26:0.0002%]
[INFO] ** classification:[normal:64.41719%,Single Stage Single Point:35.58281%]
[INFO] ** dst:[21:43.33169%,10:21.08155%,8:18.11432%,9:17.4681%,15:0.00276%,22:0.00079%,24:0.0002%,18:0.0002%,7:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99764%,0:0.00236%]
[INFO] ** i/f_name:[2:99.99724%,3:0.00276%]
[INFO] ** modbus_function_code:[0.02961:99.99665%,-33.760870000000004:0.00335%]
[INFO] ** modbus_function_description:[7:49.99921%,11:49.99744%,0:0.00335%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99665%,1:0.00276%,2:0.00059%]
[INFO] ** proxy_src_ip:[18:38.45515%,20:25.9583%,13:18.11471%,6:17.4681%,17:0.00276%,14:0.00059%,16:0.00039%]
[INFO] ** s_port:[1.45442:25.9579%,-0.32151:21.08155%,-1.27613:18.11432%,-0.23351:17.46791%,-0.33484:17.37359%,-71.33197:0.00276%,-1.02014:0.00039%,-71.14798:0.0002%,-1.27347:0.0002%,11.862:0.0002%,1.45709:0.0002%,1.47576:0.0002%,-0.24151:0.0002%,13.431270000000001:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.95751%,1:21.08155%,5:18.11432%,4:17.46791%,2:17.3734%,0:0.00532%]
[INFO] ** service:[0.0048200000000000005:99.99665%,-211.73542999999998:0.00276%,-211.08346:0.0002%,-186.43601999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:38.45515%,9:25.9583%,7:18.11471%,1:17.4681%,14:0.00276%,2:0.00059%,15:0.00039%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1378 (0.27132%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1550e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0309e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.6931e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.1366e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1611e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6283e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7418e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2888e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.9283e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5011e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 49-49/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (507880, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (507880, 17)

[INFO] analyzing data
[INFO] 507880 rows
[INFO] ** appi_name:[21:99.99724%,30:0.00098%,17:0.00079%,22:0.00039%,28:0.0002%,26:0.0002%,7:0.0002%]
[INFO] ** classification:[normal:64.37151%,Single Stage Single Point:35.62849%]
[INFO] ** dst:[21:43.29901%,10:21.06797%,8:18.14149%,9:17.4872%,22:0.00138%,15:0.00098%,16:0.00079%,6:0.00059%,17:0.00039%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.99902%,0:0.00098%]
[INFO] ** i/f_name:[2:99.99902%,3:0.00098%]
[INFO] ** modbus_function_code:[0.02961:99.99724%,-33.760870000000004:0.00276%]
[INFO] ** modbus_function_description:[7:49.99941%,11:49.99783%,0:0.00276%]
[INFO] ** modbus_transaction_id:65536 (12.90384%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99842%,1:0.00098%,2:0.00059%]
[INFO] ** proxy_src_ip:[18:38.42798%,20:25.93979%,13:18.14129%,6:17.48779%,17:0.00098%,1:0.00079%,21:0.00039%,16:0.00039%,14:0.00039%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.939%,-0.32151:21.06797%,-1.27613:18.1411%,-0.23351:17.487%,-0.33484:17.36001%,-71.33197:0.00098%,-0.24151:0.00059%,1.45709:0.00039%,-1.02014:0.00039%,-71.14931:0.00039%,-71.14798:0.0002%,-58.035180000000004:0.0002%,-5.1466400000000005:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,-5.08665:0.0002%,-0.24950999999999998:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** scada_tag:[3:25.93861%,1:21.06777%,5:18.1409%,4:17.48661%,2:17.36001%,0:0.0061%]
[INFO] ** service:[0.0048200000000000005:99.99724%,-211.73542999999998:0.00098%,-205.44247:0.00079%,-211.08818:0.00039%,-211.09762999999998:0.0002%,-211.08346:0.0002%,-185.9872:0.0002%]
[INFO] ** src:[22:38.42798%,9:25.93979%,7:18.14129%,1:17.48779%,14:0.00098%,3:0.00079%,15:0.00039%,4:0.00039%,2:0.00039%,8:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1379 (0.27152%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.5855e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.2304e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.3509e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9306e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9533e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3067e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7613e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2137e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/507880
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3123e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7861e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/507880
[33m[INFO] loading file 50-50/50 on epoch 1/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (357862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (357862, 17)

[INFO] analyzing data
[INFO] 357862 rows
[INFO] ** appi_name:[21:99.99749%,30:0.00084%,7:0.00084%,31:0.00028%,22:0.00028%,8:0.00028%]
[INFO] ** classification:[normal:64.2949%,Single Stage Single Point:35.7051%]
[INFO] ** dst:[21:43.25019%,10:21.04163%,8:18.2263%,9:17.47853%,15:0.00084%,22:0.00056%,16:0.00056%,2:0.00056%,24:0.00028%,18:0.00028%,6:0.00028%]
[INFO] ** i/f_dir:[1:99.99916%,0:0.00084%]
[INFO] ** i/f_name:[2:99.99916%,3:0.00084%]
[INFO] ** modbus_function_code:[0.02961:99.99749%,-33.760870000000004:0.00251%]
[INFO] ** modbus_function_description:[7:49.99916%,11:49.99832%,0:0.00251%]
[INFO] ** modbus_transaction_id:65535 (18.31293%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9986%,1:0.00084%,2:0.00056%]
[INFO] ** proxy_src_ip:[18:38.36339%,20:25.92871%,13:18.22658%,6:17.47853%,17:0.00084%,1:0.00084%,21:0.00028%,16:0.00028%,14:0.00028%,7:0.00028%]
[INFO] ** s_port:[1.45442:25.92815%,-0.32151:21.04163%,-1.27613:18.22602%,-0.23351:17.47853%,-0.33484:17.32176%,-71.33197:0.00084%,-3.3787199999999995:0.00028%,4.33564:0.00028%,15.912510000000001:0.00028%,7.9608300000000005:0.00028%,1.46509:0.00028%,1.45709:0.00028%,-1.27347:0.00028%,-71.14931:0.00028%,-1.02014:0.00028%,-1.2708:0.00028%,0.31847:0.00028%]
[INFO] ** scada_tag:[3:25.92787%,1:21.04135%,5:18.22574%,4:17.47853%,2:17.32148%,0:0.00503%]
[INFO] ** service:[0.0048200000000000005:99.99749%,-211.09762999999998:0.00084%,-211.73542999999998:0.00084%,-186.43601999999998:0.00028%,-211.35747999999998:0.00028%,-211.08818:0.00028%]
[INFO] ** src:[22:38.36339%,9:25.92871%,7:18.22658%,1:17.47853%,14:0.00084%,3:0.00084%,21:0.00028%,15:0.00028%,4:0.00028%,2:0.00028%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:973 (0.27189%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/357862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5122e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3153e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/357862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5726e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3397e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/357862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.4345e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4863e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-1-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/357862
[33m[INFO] epoch 2/10[0m
[33m[INFO] loading file 1-1/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99355%,30:0.00108%,22:0.0009%,17:0.00072%,31:0.00054%,26:0.00054%,7:0.00054%,23:0.00036%,18:0.00036%,0:0.00036%,28:0.00018%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:77.7375%,Single Stage Single Point:22.2625%]
[INFO] ** dst:[21:43.26823%,10:21.03423%,8:18.17026%,9:17.52028%,6:0.00143%,22:0.00108%,16:0.00108%,15:0.00108%,18:0.00054%,26:0.00036%,25:0.00036%,19:0.00036%,17:0.00036%,24:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99355%,-33.760870000000004:0.00627%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99767%,11:49.99588%,0:0.00627%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99641%,2:0.00251%,1:0.00108%]
[INFO] ** proxy_src_ip:[18:38.39605%,20:25.90605%,13:18.17044%,6:17.52064%,11:0.00125%,10:0.00125%,17:0.00108%,14:0.0009%,1:0.0009%,7:0.00054%,21:0.00036%,16:0.00036%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.90551%,-0.32151:21.03352%,-1.27613:18.17009%,-0.23351:17.5201%,-0.33484:17.36254%,-71.33197:0.00108%,-71.14931:0.0009%,-2.1481:0.00072%,-0.24151:0.00054%,-71.14798:0.00054%,-1.02014:0.00036%,-64.19493:0.00036%,-2.42942:0.00036%,4.44364:0.00036%,-43.76509:0.00018%,10.67005:0.00018%,4.29964:0.00018%,-5.08665:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,1.47576:0.00018%,1.46509:0.00018%,4.076980000000001:0.00018%,-58.032509999999995:0.00018%,-58.035180000000004:0.00018%,-1.2708:0.00018%,-1.27347:0.00018%,-5.1466400000000005:0.00018%,-68.79874000000001:0.00018%,14.253910000000001:0.00018%,1.45709:0.00018%]
[INFO] ** scada_tag:[3:25.90533%,1:21.03334%,5:18.16973%,4:17.51992%,2:17.36236%,0:0.00932%]
[INFO] ** service:[0.0048200000000000005:99.99426%,-211.73542999999998:0.00108%,-211.08818:0.0009%,-205.44247:0.00072%,-211.07873999999998:0.00072%,-211.09762999999998:0.00054%,-211.08346:0.00054%,-186.43601999999998:0.00054%,-186.44547:0.00036%,-185.9872:0.00018%,-202.75898:0.00018%]
[INFO] ** src:[22:38.39605%,9:25.90605%,7:18.17044%,1:17.52064%,11:0.00125%,10:0.00125%,14:0.00108%,3:0.0009%,2:0.0009%,21:0.00054%,15:0.00036%,4:0.00036%,8:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1514 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0399 - tp: 79118.0000 - fp: 882.0000 - tn: 319118.0000 - fn: 882.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9988 - val_loss: 7.1070e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5615e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.0123e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.2796e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.9229e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.5150 - tp: 61000.0000 - fp: 18999.0000 - tn: 301001.0000 - fn: 19000.0000 - accuracy: 0.9050 - precision: 0.7625 - recall: 0.7625 - auc: 0.9609 - val_loss: 0.2837 - val_tp: 17907.0000 - val_fp: 2093.0000 - val_tn: 77907.0000 - val_fn: 2093.0000 - val_accuracy: 0.9581 - val_precision: 0.8953 - val_recall: 0.8953 - val_auc: 0.9949
[INFO] saving weights to checkpoints/lstm-epoch-2-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0155 - tp: 79933.0000 - fp: 67.0000 - tn: 319933.0000 - fn: 67.0000 - accuracy: 0.9997 - precision: 0.9992 - recall: 0.9992 - auc: 1.0000 - val_loss: 0.0011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 2-2/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99875%,7:0.00054%,30:0.00036%,31:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:70.74223%,Single Stage Single Point:29.25777%]
[INFO] ** dst:[21:43.30838%,10:21.03047%,8:18.14571%,9:17.51311%,22:0.0009%,16:0.00036%,15:0.00036%,2:0.00036%,24:0.00018%,18:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99964%,3:0.00036%]
[INFO] ** modbus_function_code:[0.02961:99.99875%,-33.760870000000004:0.00125%]
[INFO] ** modbus_function_description:[7:49.99982%,11:49.99892%,0:0.00125%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99946%,1:0.00036%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.38064%,20:25.95875%,13:18.14571%,6:17.51347%,1:0.00054%,17:0.00036%,16:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.95803%,-0.32151:21.03047%,-1.27613:18.14535%,-0.23351:17.51293%,-0.33484:17.35017%,-0.24151:0.00036%,-71.33197:0.00036%,1.45709:0.00036%,1.47576:0.00018%,12.60597:0.00018%,10.67005:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,4.076980000000001:0.00018%,-3.3787199999999995:0.00018%,4.29964:0.00018%,-1.27347:0.00018%]
[INFO] ** scada_tag:[3:25.95767%,1:21.03047%,5:18.14535%,4:17.51257%,2:17.34999%,0:0.00394%]
[INFO] ** service:[0.0048200000000000005:99.99875%,-211.09762999999998:0.00054%,-211.73542999999998:0.00036%,-211.35747999999998:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.38064%,9:25.95875%,7:18.14571%,1:17.51347%,3:0.00054%,14:0.00036%,21:0.00018%,15:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1517 (0.27193%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0083 - tp: 79801.0000 - fp: 199.0000 - tn: 319801.0000 - fn: 199.0000 - accuracy: 0.9990 - precision: 0.9975 - recall: 0.9975 - auc: 1.0000 - val_loss: 7.5628e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.5354e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9442 - val_tp: 12609.0000 - val_fp: 7391.0000 - val_tn: 72609.0000 - val_fn: 7391.0000 - val_accuracy: 0.8522 - val_precision: 0.6305 - val_recall: 0.6305 - val_auc: 0.7690
[INFO] saving weights to checkpoints/lstm-epoch-2-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0794 - tp: 78985.0000 - fp: 1015.0000 - tn: 318985.0000 - fn: 1015.0000 - accuracy: 0.9949 - precision: 0.9873 - recall: 0.9873 - auc: 0.9941 - val_loss: 4.2641e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.4928 - tp: 67294.0000 - fp: 12706.0000 - tn: 307294.0000 - fn: 12706.0000 - accuracy: 0.9365 - precision: 0.8412 - recall: 0.8412 - auc: 0.9663 - val_loss: 0.1798 - val_tp: 19911.0000 - val_fp: 89.0000 - val_tn: 79911.0000 - val_fn: 89.0000 - val_accuracy: 0.9982 - val_precision: 0.9955 - val_recall: 0.9955 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0224 - tp: 79996.0000 - fp: 4.0000 - tn: 319996.0000 - fn: 4.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 1.8975 - val_tp: 12846.0000 - val_fp: 7154.0000 - val_tn: 72846.0000 - val_fn: 7154.0000 - val_accuracy: 0.8569 - val_precision: 0.6423 - val_recall: 0.6423 - val_auc: 0.8280
[INFO] saving weights to checkpoints/lstm-epoch-2-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 3-3/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99175%,30:0.00215%,22:0.00108%,31:0.0009%,26:0.0009%,17:0.0009%,7:0.00072%,27:0.00036%,0:0.00036%,28:0.00018%,23:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:88.08989%,Single Stage Single Point:11.91011%]
[INFO] ** dst:[21:43.31053%,10:21.08066%,8:18.1561%,9:17.44356%,6:0.00215%,15:0.00143%,18:0.00125%,16:0.00125%,22:0.0009%,2:0.00036%,7:0.00036%,25:0.00036%,17:0.00036%,12:0.00018%,24:0.00018%,19:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99857%,0:0.00143%]
[INFO] ** i/f_name:[2:99.99857%,3:0.00143%]
[INFO] ** modbus_function_code:[0.02961:99.99175%,-33.760870000000004:0.00807%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99641%,11:49.99534%,0:0.00807%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99892%,2:0.00108%]
[INFO] ** proto:[0:99.99426%,2:0.0043%,1:0.00143%]
[INFO] ** proxy_src_ip:[18:38.40502%,20:25.98653%,13:18.15628%,6:17.44392%,17:0.00215%,1:0.00143%,14:0.00125%,7:0.0009%,11:0.00072%,10:0.00072%,21:0.00054%,16:0.00018%,15:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.98582%,-0.32151:21.08048%,-1.27613:18.15574%,-0.23351:17.44338%,-0.33484:17.32454%,-71.33197:0.00143%,-71.14931:0.00108%,-71.14798:0.00108%,-64.19493:0.00036%,-0.08551:0.00036%,1.45709:0.00036%,-0.24151:0.00036%,14.4699:0.00018%,4.29964:0.00018%,4.90362:0.00018%,10.192739999999999:0.00018%,-3.3787199999999995:0.00018%,13.86459:0.00018%,4.44364:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,-43.76509:0.00018%,-5.08665:0.00018%,-58.035180000000004:0.00018%,4.076980000000001:0.00018%,-58.032509999999995:0.00018%,-1.27347:0.00018%,-1.2708:0.00018%,-1.02014:0.00018%,-5.1466400000000005:0.00018%,13.431270000000001:0.00018%,12.60597:0.00018%,1.47576:0.00018%,1.46509:0.00018%,14.253910000000001:0.00018%,-68.79874000000001:0.00018%,-0.24950999999999998:0.00018%,-2.1481:0.00018%,10.67005:0.00018%,-68.36943000000001:0.00018%]
[INFO] ** scada_tag:[3:25.98546%,1:21.0803%,5:18.15557%,4:17.4432%,2:17.32436%,0:0.01111%]
[INFO] ** service:[0.0048200000000000005:99.99193%,-211.73542999999998:0.00143%,-186.43601999999998:0.00125%,-211.08346:0.00108%,-211.08818:0.00108%,-205.44247:0.0009%,-211.09762999999998:0.00072%,-202.75898:0.00036%,-186.44547:0.00036%,-183.8612:0.00018%,-185.9872:0.00018%,-201.23771000000002:0.00018%,-211.35747999999998:0.00018%,-211.07873999999998:0.00018%]
[INFO] ** src:[22:38.40502%,9:25.98653%,7:18.15628%,1:17.44392%,21:0.00197%,3:0.00161%,2:0.00125%,11:0.00072%,10:0.00072%,4:0.00072%,14:0.00036%,8:0.00036%,17:0.00018%,15:0.00018%,13:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1515 (0.27157%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.1358 - tp: 75875.0000 - fp: 4125.0000 - tn: 315875.0000 - fn: 4125.0000 - accuracy: 0.9794 - precision: 0.9484 - recall: 0.9484 - auc: 0.9959 - val_loss: 0.1261 - val_tp: 19978.0000 - val_fp: 22.0000 - val_tn: 79978.0000 - val_fn: 22.0000 - val_accuracy: 0.9996 - val_precision: 0.9989 - val_recall: 0.9989 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0107 - tp: 79996.0000 - fp: 4.0000 - tn: 319996.0000 - fn: 4.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 0.0034 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1966 - tp: 76295.0000 - fp: 3705.0000 - tn: 316295.0000 - fn: 3705.0000 - accuracy: 0.9815 - precision: 0.9537 - recall: 0.9537 - auc: 0.9892 - val_loss: 0.0364 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0053 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0016 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0012 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.5358e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 4-4/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99767%,30:0.00125%,31:0.00036%,33:0.00018%,26:0.00018%,23:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:92.15218%,Single Stage Single Point:7.84782%]
[INFO] ** dst:[21:43.35086%,10:20.9464%,8:18.17636%,9:17.52297%,15:0.00125%,22:0.00108%,18:0.00036%,24:0.00018%,19:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99875%,3:0.00125%]
[INFO] ** modbus_function_code:[0.02961:99.99767%,-33.760870000000004:0.00233%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.99803%,0:0.00233%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99892%,2:0.00108%]
[INFO] ** proto:[0:99.99821%,1:0.00125%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.25785%,20:26.03977%,13:18.17636%,6:17.52333%,17:0.00125%,21:0.00036%,16:0.00036%,14:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.03906%,-0.32151:20.94622%,-1.27613:18.176%,-0.23351:17.52279%,-0.33484:17.31163%,-71.33197:0.00125%,1.45709:0.00036%,-0.08551:0.00036%,-0.24151:0.00036%,-1.02014:0.00036%,-1.2708:0.00018%,14.4699:0.00018%,4.44364:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-49.275529999999996:0.00018%]
[INFO] ** scada_tag:[3:26.03888%,1:20.94604%,5:18.176%,4:17.52243%,2:17.31145%,0:0.0052%]
[INFO] ** service:[0.0048200000000000005:99.99785%,-211.73542999999998:0.00125%,-186.43601999999998:0.00036%,-183.8612:0.00018%,-211.08346:0.00018%,-211.07873999999998:0.00018%]
[INFO] ** src:[22:38.25785%,9:26.03977%,7:18.17636%,1:17.52333%,21:0.00108%,15:0.00036%,4:0.00036%,17:0.00018%,14:0.00018%,8:0.00018%,3:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1525 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.9108e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.5004e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.4756e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.5994e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.8695e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2627e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.7434e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2543e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.6122 - tp: 61951.0000 - fp: 18049.0000 - tn: 301951.0000 - fn: 18049.0000 - accuracy: 0.9098 - precision: 0.7744 - recall: 0.7744 - auc: 0.9485 - val_loss: 0.3558 - val_tp: 17425.0000 - val_fp: 2575.0000 - val_tn: 77425.0000 - val_fn: 2575.0000 - val_accuracy: 0.9485 - val_precision: 0.8712 - val_recall: 0.8712 - val_auc: 0.9804
[INFO] saving weights to checkpoints/lstm-epoch-2-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 5-5/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99641%,30:0.00251%,37:0.00018%,26:0.00018%,12:0.00018%,9:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:89.89983%,Single Stage Single Point:10.10017%]
[INFO] ** dst:[21:43.36556%,10:20.76929%,8:18.23641%,9:17.62443%,15:0.00251%,22:0.0009%,25:0.00018%,24:0.00018%,6:0.00018%,2:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99785%,0:0.00215%]
[INFO] ** i/f_name:[2:99.99749%,3:0.00251%]
[INFO] ** modbus_function_code:[0.02961:99.99641%,-33.760870000000004:0.00359%]
[INFO] ** modbus_function_description:[7:49.99875%,11:49.99767%,0:0.00359%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99803%,2:0.00197%]
[INFO] ** proto:[0:99.99713%,1:0.00251%,2:0.00036%]
[INFO] ** proxy_src_ip:[18:38.00689%,20:26.12815%,13:18.23659%,6:17.62461%,17:0.00251%,1:0.00036%,21:0.00018%,16:0.00018%,7:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.12761%,-0.32151:20.76894%,-1.27613:18.23641%,-0.23351:17.62425%,-0.33484:17.23795%,-71.33197:0.00251%,-0.24151:0.00036%,1.45709:0.00036%,1.47576:0.00018%,-49.275529999999996:0.00018%,-1.27347:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,2.22906:0.00018%,14.4699:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.12725%,1:20.76876%,5:18.23623%,4:17.62425%,2:17.23795%,0:0.00556%]
[INFO] ** service:[0.0048200000000000005:99.99677%,-211.73542999999998:0.00251%,-183.8612:0.00018%,-211.08346:0.00018%,-211.35747999999998:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.00689%,9:26.12815%,7:18.23659%,1:17.62461%,21:0.00215%,14:0.00054%,3:0.00036%,16:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1526 (0.27354%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0195 - tp: 79293.0000 - fp: 707.0000 - tn: 319293.0000 - fn: 707.0000 - accuracy: 0.9965 - precision: 0.9912 - recall: 0.9912 - auc: 1.0000 - val_loss: 1.1391 - val_tp: 16070.0000 - val_fp: 3930.0000 - val_tn: 76070.0000 - val_fn: 3930.0000 - val_accuracy: 0.9214 - val_precision: 0.8035 - val_recall: 0.8035 - val_auc: 0.8772
[INFO] saving weights to checkpoints/lstm-epoch-2-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1979 - tp: 76690.0000 - fp: 3310.0000 - tn: 316690.0000 - fn: 3310.0000 - accuracy: 0.9834 - precision: 0.9586 - recall: 0.9586 - auc: 0.9866 - val_loss: 0.0088 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2711 - tp: 67569.0000 - fp: 12431.0000 - tn: 307569.0000 - fn: 12431.0000 - accuracy: 0.9378 - precision: 0.8446 - recall: 0.8446 - auc: 0.9847 - val_loss: 0.2933 - val_tp: 13100.0000 - val_fp: 6900.0000 - val_tn: 73100.0000 - val_fn: 6900.0000 - val_accuracy: 0.8620 - val_precision: 0.6550 - val_recall: 0.6550 - val_auc: 0.9683
[INFO] saving weights to checkpoints/lstm-epoch-2-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0168 - tp: 79450.0000 - fp: 550.0000 - tn: 319450.0000 - fn: 550.0000 - accuracy: 0.9973 - precision: 0.9931 - recall: 0.9931 - auc: 1.0000 - val_loss: 0.0028 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0021 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0015 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 6-6/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99588%,30:0.00323%,31:0.00018%,27:0.00018%,26:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:92.75717%,Single Stage Single Point:7.24283%]
[INFO] ** dst:[21:43.37471%,10:20.73129%,8:18.27871%,9:17.61045%,15:0.00323%,22:0.00054%,25:0.00018%,24:0.00018%,18:0.00018%,12:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99695%,0:0.00305%]
[INFO] ** i/f_name:[2:99.99677%,3:0.00323%]
[INFO] ** modbus_function_code:[0.02961:99.99588%,-33.760870000000004:0.00412%]
[INFO] ** modbus_function_description:[7:49.99857%,11:49.99731%,0:0.00412%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99964%,1:0.00036%]
[INFO] ** proto:[0:99.99588%,1:0.00323%,2:0.0009%]
[INFO] ** proxy_src_ip:[18:37.94057%,20:26.16561%,13:18.27889%,6:17.61063%,17:0.00323%,14:0.00054%,16:0.00036%,11:0.00018%]
[INFO] ** s_port:[1.45442:26.16525%,-0.32151:20.73129%,-1.27613:18.27836%,-0.23351:17.61027%,-0.33484:17.20927%,-71.33197:0.00323%,-1.02014:0.00036%,-71.14798:0.00018%,-64.19493:0.00018%,4.90362:0.00018%,-1.2708:0.00018%,-0.24151:0.00018%,13.431270000000001:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-68.36943000000001:0.00018%]
[INFO] ** scada_tag:[3:26.16507%,1:20.73093%,5:18.27818%,4:17.60991%,2:17.20909%,0:0.00681%]
[INFO] ** service:[0.0048200000000000005:99.99588%,-211.73542999999998:0.00323%,-211.08346:0.00018%,-201.23771000000002:0.00018%,-202.75898:0.00018%,-186.44547:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:37.94057%,9:26.16561%,7:18.27889%,1:17.61063%,14:0.00323%,2:0.00054%,15:0.00036%,10:0.00018%]
[INFO] ** type:[0:99.9991%,1:0.0009%]
[INFO] ** unixtime:1527 (0.27372%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0011 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 8.9122e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.6046e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 6.6456e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7744e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.6637e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2069e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.3183 - tp: 67286.0000 - fp: 12714.0000 - tn: 307286.0000 - fn: 12714.0000 - accuracy: 0.9364 - precision: 0.8411 - recall: 0.8411 - auc: 0.9798 - val_loss: 0.3181 - val_tp: 12788.0000 - val_fp: 7212.0000 - val_tn: 72788.0000 - val_fn: 7212.0000 - val_accuracy: 0.8558 - val_precision: 0.6394 - val_recall: 0.6394 - val_auc: 0.9675
[INFO] saving weights to checkpoints/lstm-epoch-2-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 7-7/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99534%,30:0.00161%,22:0.0009%,17:0.00072%,26:0.00054%,31:0.00036%,28:0.00018%,27:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:80.77535%,Single Stage Single Point:19.22465%]
[INFO] ** dst:[21:43.36037%,10:20.74438%,8:18.25021%,9:17.63859%,15:0.00161%,22:0.00143%,6:0.00143%,16:0.00072%,24:0.00036%,18:0.00036%,17:0.00036%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99839%,0:0.00161%]
[INFO] ** i/f_name:[2:99.99839%,3:0.00161%]
[INFO] ** modbus_function_code:[0.02961:99.99534%,-33.760870000000004:0.00466%]
[INFO] ** modbus_function_description:[7:49.99839%,11:49.99695%,0:0.00466%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99641%,2:0.00197%,1:0.00161%]
[INFO] ** proxy_src_ip:[18:37.96817%,20:26.13729%,13:18.25057%,6:17.63877%,17:0.00161%,11:0.00072%,1:0.00072%,21:0.00054%,16:0.00054%,14:0.00036%,7:0.00036%,10:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13639%,-0.32151:20.74438%,-1.27613:18.25003%,-0.23351:17.63841%,-0.33484:17.22379%,-71.33197:0.00161%,-71.14931:0.0009%,-1.02014:0.00054%,-71.14798:0.00054%,1.45709:0.00054%,-0.24151:0.00036%,-1.27347:0.00036%,1.47576:0.00018%,1.46509:0.00018%,14.253910000000001:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,-68.79874000000001:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,6.1115699999999995:0.00018%,-5.08665:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:26.13603%,1:20.74438%,5:18.24985%,4:17.63823%,2:17.22379%,0:0.00771%]
[INFO] ** service:[0.0048200000000000005:99.99534%,-211.73542999999998:0.00161%,-211.08818:0.0009%,-205.44247:0.00072%,-211.08346:0.00054%,-186.43601999999998:0.00036%,-211.09762999999998:0.00018%,-185.9872:0.00018%,-202.75898:0.00018%]
[INFO] ** src:[22:37.96817%,9:26.13729%,7:18.25057%,1:17.63877%,14:0.00161%,10:0.00072%,3:0.00072%,15:0.00054%,4:0.00054%,21:0.00036%,2:0.00036%,11:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1524 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0267 - tp: 79287.0000 - fp: 713.0000 - tn: 319287.0000 - fn: 713.0000 - accuracy: 0.9964 - precision: 0.9911 - recall: 0.9911 - auc: 1.0000 - val_loss: 0.0040 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0027 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0018 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0014 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.1766 - val_tp: 19583.0000 - val_fp: 417.0000 - val_tn: 79583.0000 - val_fn: 417.0000 - val_accuracy: 0.9917 - val_precision: 0.9791 - val_recall: 0.9791 - val_auc: 0.9870
[INFO] saving weights to checkpoints/lstm-epoch-2-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1043 - tp: 78395.0000 - fp: 1605.0000 - tn: 318395.0000 - fn: 1605.0000 - accuracy: 0.9920 - precision: 0.9799 - recall: 0.9799 - auc: 0.9940 - val_loss: 2.2660e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0525e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8218e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 8-8/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99713%,30:0.00108%,0:0.00054%,24:0.00018%,23:0.00018%,22:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:94.87723%,Single Stage Single Point:5.12277%]
[INFO] ** dst:[21:43.42095%,10:20.80335%,8:18.19034%,9:17.58177%,22:0.00125%,15:0.00108%,25:0.00054%,19:0.00036%,26:0.00018%,24:0.00018%]
[INFO] ** i/f_dir:[1:99.99928%,0:0.00072%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99713%,-33.760870000000004:0.00269%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.99749%,0:0.00269%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99964%,2:0.00036%]
[INFO] ** proto:[0:99.99821%,1:0.00108%,2:0.00072%]
[INFO] ** proxy_src_ip:[18:38.08863%,20:26.13621%,13:18.18962%,6:17.58213%,17:0.00108%,10:0.00108%,16:0.00054%,14:0.00036%,11:0.00018%,5:0.00018%]
[INFO] ** s_port:[1.45442:26.13568%,-0.32151:20.80335%,-1.27613:18.18944%,-0.23351:17.58159%,-0.33484:17.28528%,-71.33197:0.00108%,-15.039579999999999:0.00072%,-1.02014:0.00054%,-64.19493:0.00054%,1.45709:0.00036%,-0.24151:0.00036%,4.66896:0.00036%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.13514%,1:20.80317%,5:18.18944%,4:17.58141%,2:17.2851%,0:0.00574%]
[INFO] ** service:[0.0048200000000000005:99.99785%,-211.73542999999998:0.00108%,-186.44547:0.00054%,-211.07873999999998:0.00036%,-211.08818:0.00018%]
[INFO] ** src:[22:38.08863%,9:26.13621%,7:18.18962%,1:17.58213%,11:0.00108%,14:0.00072%,15:0.00054%,21:0.00036%,2:0.00036%,16:0.00018%,10:0.00018%]
[INFO] ** type:[0:99.99946%,1:0.00036%,2:0.00018%]
[INFO] ** unixtime:1528 (0.2739%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6266e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4753e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3334e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1944e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3131e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.6383e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.6277e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.7532e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2241 - tp: 75950.0000 - fp: 4050.0000 - tn: 315950.0000 - fn: 4050.0000 - accuracy: 0.9797 - precision: 0.9494 - recall: 0.9494 - auc: 0.9860 - val_loss: 0.0063 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 9-9/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99821%,30:0.00108%,31:0.00036%,26:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:94.62824%,Single Stage Single Point:5.37176%]
[INFO] ** dst:[21:43.37327%,10:20.77055%,8:18.27979%,9:17.57352%,15:0.00108%,22:0.0009%,18:0.00036%,25:0.00018%,24:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99821%,-33.760870000000004:0.00179%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99821%,0:0.00179%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99964%,2:0.00036%]
[INFO] ** proto:[0:99.99821%,1:0.00108%,2:0.00072%]
[INFO] ** proxy_src_ip:[18:38.00653%,20:26.13783%,13:18.27979%,6:17.57388%,17:0.00108%,21:0.00018%,16:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13711%,-0.32151:20.77055%,-1.27613:18.27943%,-0.23351:17.57334%,-0.33484:17.23598%,-71.33197:0.00108%,-0.24151:0.00036%,1.45709:0.00036%,-0.08551:0.00036%,1.46509:0.00018%,1.47576:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.13675%,1:20.77037%,5:18.27943%,4:17.57316%,2:17.2358%,0:0.00448%]
[INFO] ** service:[0.0048200000000000005:99.99821%,-211.73542999999998:0.00108%,-186.43601999999998:0.00036%,-211.08346:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.00653%,9:26.13783%,7:18.27979%,1:17.57388%,14:0.00072%,21:0.00036%,17:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1528 (0.2739%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0044 - tp: 79993.0000 - fp: 7.0000 - tn: 319993.0000 - fn: 7.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 0.0024 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0983 - tp: 76984.0000 - fp: 3016.0000 - tn: 316984.0000 - fn: 3016.0000 - accuracy: 0.9849 - precision: 0.9623 - recall: 0.9623 - auc: 0.9980 - val_loss: 0.2644 - val_tp: 16372.0000 - val_fp: 3628.0000 - val_tn: 76372.0000 - val_fn: 3628.0000 - val_accuracy: 0.9274 - val_precision: 0.8186 - val_recall: 0.8186 - val_auc: 0.9918
[INFO] saving weights to checkpoints/lstm-epoch-2-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0046 - tp: 79760.0000 - fp: 240.0000 - tn: 319760.0000 - fn: 240.0000 - accuracy: 0.9988 - precision: 0.9970 - recall: 0.9970 - auc: 1.0000 - val_loss: 2.1432e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9055e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6906e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5353e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4339e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 10-10/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99624%,30:0.00179%,31:0.00036%,26:0.00018%,24:0.00018%,23:0.00018%,22:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:94.52391%,Single Stage Single Point:5.47609%]
[INFO] ** dst:[21:43.41181%,10:20.80586%,8:18.22565%,9:17.55273%,15:0.00179%,22:0.00054%,24:0.00036%,19:0.00036%,18:0.00036%,26:0.00018%,25:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99839%,0:0.00161%]
[INFO] ** i/f_name:[2:99.99821%,3:0.00179%]
[INFO] ** modbus_function_code:[0.02961:99.99624%,-33.760870000000004:0.00359%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99892%,11:49.99731%,0:0.00359%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99928%,1:0.00072%]
[INFO] ** proto:[0:99.99731%,1:0.00179%,2:0.0009%]
[INFO] ** proxy_src_ip:[18:38.08325%,20:26.13496%,13:18.22583%,6:17.55201%,17:0.00179%,10:0.0009%,14:0.00036%,21:0.00018%,16:0.00018%,5:0.00018%,2:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13424%,-0.32151:20.80586%,-1.27613:18.2253%,-0.23351:17.55165%,-0.33484:17.27739%,-71.33197:0.00179%,-10.51843:0.00072%,-0.08551:0.00036%,-1.27347:0.00036%,5.71692:0.00036%,1.47576:0.00036%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-71.14931:0.00018%,-64.19493:0.00018%,1.45709:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.13388%,1:20.80568%,5:18.2253%,4:17.55147%,2:17.27721%,0:0.00645%]
[INFO] ** service:[0.0048200000000000005:99.99695%,-211.73542999999998:0.00179%,-211.07873999999998:0.00036%,-186.43601999999998:0.00036%,-211.08346:0.00018%,-186.44547:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.08325%,9:26.13496%,7:18.22583%,1:17.55201%,14:0.00179%,11:0.0009%,2:0.00036%,17:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%]
[INFO] ** type:[0:99.99857%,1:0.00125%,2:0.00018%]
[INFO] ** unixtime:1524 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5526e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2332e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1419e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0595e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3345 - tp: 66128.0000 - fp: 13872.0000 - tn: 306128.0000 - fn: 13872.0000 - accuracy: 0.9306 - precision: 0.8266 - recall: 0.8266 - auc: 0.9784 - val_loss: 0.2118 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2183 - tp: 71609.0000 - fp: 8391.0000 - tn: 311609.0000 - fn: 8391.0000 - accuracy: 0.9580 - precision: 0.8951 - recall: 0.8951 - auc: 0.9908 - val_loss: 0.1137 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0064 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0015 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 11-11/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99892%,31:0.00036%,30:0.00036%,26:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.38833%,10:20.87559%,8:18.19787%,9:17.53588%,22:0.00125%,18:0.00036%,15:0.00036%,25:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99964%,3:0.00036%]
[INFO] ** modbus_function_code:[0.02961:99.99892%,-33.760870000000004:0.00108%]
[INFO] ** modbus_function_description:[7:50.00054%,11:49.99839%,0:0.00108%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99892%,2:0.00072%,1:0.00036%]
[INFO] ** proxy_src_ip:[18:38.14689%,20:26.11739%,13:18.19787%,6:17.53624%,16:0.00054%,17:0.00036%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.11685%,-0.32151:20.87559%,-1.27613:18.19769%,-0.23351:17.5357%,-0.33484:17.2713%,-0.24151:0.00054%,-1.02014:0.00054%,-0.08551:0.00036%,-71.33197:0.00036%,-71.14798:0.00018%,1.45709:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:26.11649%,1:20.87559%,5:18.19751%,4:17.53534%,2:17.27112%,0:0.00394%]
[INFO] ** service:[0.0048200000000000005:99.99892%,-211.73542999999998:0.00036%,-186.43601999999998:0.00036%,-211.08346:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.14689%,9:26.11739%,7:18.19787%,1:17.53624%,15:0.00054%,14:0.00036%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1525 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0011 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.4494e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 7.9175e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.6612e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7979e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.0517e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.4675e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9565e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.5423e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1574e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 12-12/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99785%,30:0.00197%,9:0.00018%]
[INFO] ** classification:[normal:93.51255%,Single Stage Single Point:6.48745%]
[INFO] ** dst:[21:43.40159%,10:20.88312%,8:18.18066%,9:17.53158%,15:0.00197%,22:0.00054%,24:0.00036%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99839%,0:0.00161%]
[INFO] ** i/f_name:[2:99.99803%,3:0.00197%]
[INFO] ** modbus_function_code:[0.02961:99.99785%,-33.760870000000004:0.00215%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.99821%,0:0.00215%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99839%,2:0.00161%]
[INFO] ** proto:[0:99.99803%,1:0.00197%]
[INFO] ** proxy_src_ip:[18:38.15496%,20:26.13012%,13:18.18084%,6:17.53176%,17:0.00197%,16:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:26.12958%,-0.32151:20.88312%,-1.27613:18.1803%,-0.23351:17.5314%,-0.33484:17.27183%,-71.33197:0.00197%,-1.27347:0.00036%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:26.12922%,1:20.88312%,5:18.1803%,4:17.53104%,2:17.27183%,0:0.00448%]
[INFO] ** service:[0.0048200000000000005:99.99785%,-211.73542999999998:0.00197%,-183.8612:0.00018%]
[INFO] ** src:[22:38.15496%,9:26.13012%,7:18.18084%,1:17.53176%,21:0.00161%,14:0.00036%,15:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1525 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6790e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6172e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3636e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1366e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2932 - tp: 68393.0000 - fp: 11607.0000 - tn: 308393.0000 - fn: 11607.0000 - accuracy: 0.9420 - precision: 0.8549 - recall: 0.8549 - auc: 0.9829 - val_loss: 0.3362 - val_tp: 12822.0000 - val_fp: 7178.0000 - val_tn: 72822.0000 - val_fn: 7178.0000 - val_accuracy: 0.8564 - val_precision: 0.6411 - val_recall: 0.6411 - val_auc: 0.9678
[INFO] saving weights to checkpoints/lstm-epoch-2-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2415 - tp: 68878.0000 - fp: 11122.0000 - tn: 308878.0000 - fn: 11122.0000 - accuracy: 0.9444 - precision: 0.8610 - recall: 0.8610 - auc: 0.9876 - val_loss: 0.3302 - val_tp: 12843.0000 - val_fp: 7157.0000 - val_tn: 72843.0000 - val_fn: 7157.0000 - val_accuracy: 0.8569 - val_precision: 0.6421 - val_recall: 0.6421 - val_auc: 0.9680
[INFO] saving weights to checkpoints/lstm-epoch-2-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0148 - tp: 79323.0000 - fp: 677.0000 - tn: 319323.0000 - fn: 677.0000 - accuracy: 0.9966 - precision: 0.9915 - recall: 0.9915 - auc: 1.0000 - val_loss: 8.8610e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 13-13/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99659%,31:0.00072%,26:0.00054%,0:0.00054%,30:0.00036%,22:0.00036%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:86.2846%,Single Stage Single Point:13.7154%]
[INFO] ** dst:[21:43.35535%,10:20.80622%,8:18.28033%,9:17.55416%,22:0.00108%,6:0.0009%,18:0.00072%,25:0.00054%,15:0.00036%,24:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99964%,3:0.00036%]
[INFO] ** modbus_function_code:[0.02961:99.99659%,-33.760870000000004:0.00323%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99892%,11:49.99767%,0:0.00323%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99731%,2:0.00233%,1:0.00036%]
[INFO] ** proxy_src_ip:[18:38.05403%,20:26.10789%,13:18.28051%,6:17.55362%,10:0.00108%,11:0.0009%,16:0.00054%,17:0.00036%,7:0.00036%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.10735%,-0.32151:20.80622%,-1.27613:18.28015%,-0.23351:17.55327%,-0.33484:17.24781%,-9.78512:0.00072%,-64.19493:0.00054%,-1.02014:0.00054%,-71.14798:0.00054%,-0.24151:0.00036%,-71.14931:0.00036%,-0.08551:0.00036%,-71.33197:0.00036%,1.47576:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-1.2708:0.00018%,-68.79874000000001:0.00018%,6.1115699999999995:0.00018%,14.540560000000001:0.00018%,1.45709:0.00018%]
[INFO] ** scada_tag:[3:26.10699%,1:20.80604%,5:18.28015%,4:17.55327%,2:17.24763%,0:0.00592%]
[INFO] ** service:[0.0048200000000000005:99.99731%,-186.43601999999998:0.00072%,-211.08346:0.00054%,-186.44547:0.00054%,-211.73542999999998:0.00036%,-211.08818:0.00036%,-202.75898:0.00018%]
[INFO] ** src:[22:38.05403%,9:26.10789%,7:18.28051%,1:17.55362%,11:0.00108%,10:0.0009%,15:0.00054%,21:0.00036%,14:0.00036%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1525 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.3377e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.9759e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.5231e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0683e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 6.0888e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0202e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3138 - tp: 66791.0000 - fp: 13209.0000 - tn: 306791.0000 - fn: 13209.0000 - accuracy: 0.9340 - precision: 0.8349 - recall: 0.8349 - auc: 0.9808 - val_loss: 0.3027 - val_tp: 12833.0000 - val_fp: 7167.0000 - val_tn: 72833.0000 - val_fn: 7167.0000 - val_accuracy: 0.8567 - val_precision: 0.6417 - val_recall: 0.6417 - val_auc: 0.9679
[INFO] saving weights to checkpoints/lstm-epoch-2-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0193 - tp: 79240.0000 - fp: 760.0000 - tn: 319240.0000 - fn: 760.0000 - accuracy: 0.9962 - precision: 0.9905 - recall: 0.9905 - auc: 1.0000 - val_loss: 5.3483e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 14-14/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99964%,30:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:93.16856%,Single Stage Single Point:6.83144%]
[INFO] ** dst:[21:43.35086%,10:20.81303%,8:18.26151%,9:17.57316%,22:0.00072%,24:0.00036%,15:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:99.99982%,3:0.00018%]
[INFO] ** modbus_function_code:[0.02961:99.99964%,-33.760870000000004:0.00036%]
[INFO] ** modbus_function_description:[7:50.00054%,11:49.9991%,0:0.00036%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,1:0.00018%]
[INFO] ** proxy_src_ip:[18:38.05296%,20:26.11148%,13:18.26168%,6:17.57334%,17:0.00018%,16:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:26.11076%,-0.32151:20.81303%,-1.27613:18.26115%,-0.23351:17.57298%,-0.33484:17.23993%,-1.27347:0.00036%,1.45709:0.00036%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,14.4699:0.00018%,-71.33197:0.00018%]
[INFO] ** scada_tag:[3:26.1104%,1:20.81303%,5:18.26097%,4:17.57263%,2:17.23975%,0:0.00323%]
[INFO] ** service:[0.0048200000000000005:99.99964%,-183.8612:0.00018%,-211.73542999999998:0.00018%]
[INFO] ** src:[22:38.05296%,9:26.11148%,7:18.26168%,1:17.57334%,15:0.00018%,14:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1524 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.9981e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0222e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2100 - tp: 76381.0000 - fp: 3619.0000 - tn: 316381.0000 - fn: 3619.0000 - accuracy: 0.9819 - precision: 0.9548 - recall: 0.9548 - auc: 0.9878 - val_loss: 0.0293 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0033 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.4188e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.9296e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0082e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.5525e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2078e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 15-15/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (557862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (557862, 17)

[INFO] analyzing data
[INFO] 557862 rows
[INFO] ** appi_name:[21:99.99624%,30:0.00305%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:90.0997%,Single Stage Multi Point:9.89958%,Single Stage Single Point:0.00072%]
[INFO] ** dst:[21:43.30229%,10:20.77682%,8:18.31528%,9:17.60023%,15:0.00305%,22:0.00161%,25:0.00018%,24:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99713%,0:0.00287%]
[INFO] ** i/f_name:[2:99.99695%,3:0.00305%]
[INFO] ** modbus_function_code:[0.02961:99.99624%,-33.760870000000004:0.00376%]
[INFO] ** modbus_function_description:[7:49.9991%,11:49.99713%,0:0.00376%]
[INFO] ** modbus_transaction_id:65536 (11.74771%)
[INFO] ** orig:[0:99.99731%,2:0.00269%]
[INFO] ** proto:[0:99.99659%,1:0.00305%,2:0.00036%]
[INFO] ** proxy_src_ip:[18:38.01012%,20:26.06971%,13:18.31492%,6:17.60077%,17:0.00305%,16:0.00072%,7:0.00036%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.06881%,-0.32151:20.77664%,-1.27613:18.31474%,-0.23351:17.60005%,-0.33484:17.23347%,-71.33197:0.00305%,-1.02014:0.00072%,-0.24151:0.00054%,1.46509:0.00036%,1.45709:0.00036%,1.47576:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-61.95768:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.06845%,1:20.77646%,5:18.31474%,4:17.59969%,2:17.23329%,0:0.00735%]
[INFO] ** service:[0.0048200000000000005:99.99641%,-211.73542999999998:0.00305%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.01012%,9:26.06971%,7:18.31492%,1:17.60077%,21:0.00305%,15:0.00072%,14:0.00036%,16:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1533 (0.2748%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.2701e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.8324e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0837e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.6708e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.8206e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5712e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.2542e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9286e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/557862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.7846 - tp: 61216.0000 - fp: 18784.0000 - tn: 301216.0000 - fn: 18784.0000 - accuracy: 0.9061 - precision: 0.7652 - recall: 0.7652 - auc: 0.8532 - val_loss: 7.5199 - val_tp: 10669.0000 - val_fp: 9331.0000 - val_tn: 70669.0000 - val_fn: 9331.0000 - val_accuracy: 0.8134 - val_precision: 0.5335 - val_recall: 0.5335 - val_auc: 0.7084
[INFO] saving weights to checkpoints/lstm-epoch-2-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/557862
[33m[INFO] loading file 16-16/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (497552, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (497552, 17)

[INFO] analyzing data
[INFO] 497552 rows
[INFO] ** appi_name:[21:99.99819%,30:0.00161%,33:0.0002%]
[INFO] ** classification:[normal:80.78191%,Single Stage Multi Point:19.21809%]
[INFO] ** dst:[21:43.35004%,10:20.79541%,8:18.25819%,9:17.59334%,15:0.00161%,22:0.00121%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.99839%,0:0.00161%]
[INFO] ** i/f_name:[2:99.99839%,3:0.00161%]
[INFO] ** modbus_function_code:[0.02961:99.99819%,-33.760870000000004:0.00181%]
[INFO] ** modbus_function_description:[7:50.0004%,11:49.99779%,0:0.00181%]
[INFO] ** modbus_transaction_id:65536 (13.17169%)
[INFO] ** orig:[0:99.99839%,2:0.00161%]
[INFO] ** proto:[0:99.99839%,1:0.00161%]
[INFO] ** proxy_src_ip:[18:38.04205%,20:26.1036%,13:18.25859%,6:17.59354%,17:0.00161%,16:0.0004%,21:0.0002%]
[INFO] ** s_port:[1.45442:26.103%,-0.32151:20.79521%,-1.27613:18.25819%,-0.23351:17.59314%,-0.33484:17.24684%,-71.33197:0.00161%,1.45709:0.0004%,-0.24151:0.0004%,-1.02014:0.0004%,-1.27347:0.0002%,1.47576:0.0002%,-49.275529999999996:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:26.1026%,1:20.79501%,5:18.25799%,4:17.59273%,2:17.24664%,0:0.00502%]
[INFO] ** service:[0.0048200000000000005:99.99839%,-211.73542999999998:0.00161%]
[INFO] ** src:[22:38.04205%,9:26.1036%,7:18.25859%,1:17.59354%,21:0.00161%,15:0.0004%,4:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1362 (0.27374%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/497552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5636 - tp: 42459.0000 - fp: 37541.0000 - tn: 282459.0000 - fn: 37541.0000 - accuracy: 0.8123 - precision: 0.5307 - recall: 0.5307 - auc: 0.7067 - val_loss: 7.5368 - val_tp: 10648.0000 - val_fp: 9352.0000 - val_tn: 70648.0000 - val_fn: 9352.0000 - val_accuracy: 0.8130 - val_precision: 0.5324 - val_recall: 0.5324 - val_auc: 0.7078
[INFO] saving weights to checkpoints/lstm-epoch-2-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/497552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5473 - tp: 42540.0000 - fp: 37460.0000 - tn: 282540.0000 - fn: 37460.0000 - accuracy: 0.8127 - precision: 0.5318 - recall: 0.5318 - auc: 0.7073 - val_loss: 7.5804 - val_tp: 10594.0000 - val_fp: 9406.0000 - val_tn: 70594.0000 - val_fn: 9406.0000 - val_accuracy: 0.8119 - val_precision: 0.5297 - val_recall: 0.5297 - val_auc: 0.7061
[INFO] saving weights to checkpoints/lstm-epoch-2-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/497552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3750 - tp: 78139.0000 - fp: 1861.0000 - tn: 318139.0000 - fn: 1861.0000 - accuracy: 0.9907 - precision: 0.9767 - recall: 0.9767 - auc: 0.9855 - val_loss: 2.5276e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/497552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.4015e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2311e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/497552
[33m[INFO] loading file 17-17/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597552, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597552, 17)

[INFO] analyzing data
[INFO] 597552 rows
[INFO] ** appi_name:[21:99.99732%,7:0.0005%,26:0.00033%,0:0.00033%,33:0.00017%,31:0.00017%,27:0.00017%,24:0.00017%,22:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:94.83727%,Multi Stage Multi Point:5.16273%]
[INFO] ** dst:[21:43.35255%,10:20.83651%,8:18.2098%,9:17.5983%,22:0.00084%,6:0.0005%,25:0.00033%,16:0.00033%,2:0.00033%,24:0.00017%,18:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99732%,-33.760870000000004:0.00251%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99967%,11:49.99766%,0:0.00251%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (10.96741%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99883%,2:0.00117%]
[INFO] ** proxy_src_ip:[18:38.07736%,20:26.11237%,13:18.20929%,6:17.59813%,10:0.001%,11:0.00084%,1:0.00033%,21:0.00017%,16:0.00017%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:26.11137%,-0.32151:20.83635%,-1.27613:18.20896%,-0.23351:17.59797%,-0.33484:17.24101%,6.0369:0.00067%,1.45709:0.0005%,1.47576:0.00033%,-71.14798:0.00033%,-64.19493:0.00033%,1.46509:0.00017%,-49.275529999999996:0.00017%,-1.27347:0.00017%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,-68.79874000000001:0.00017%,6.15557:0.00017%,6.06224:0.00017%,8.55414:0.00017%,-3.3787199999999995:0.00017%,-4.3880099999999995:0.00017%,-71.14931:0.00017%]
[INFO] ** scada_tag:[3:26.1112%,1:20.83618%,5:18.20879%,4:17.59746%,2:17.24101%,0:0.00536%]
[INFO] ** service:[0.0048200000000000005:99.99816%,-211.09762999999998:0.0005%,-211.08346:0.00033%,-186.44547:0.00033%,-211.35747999999998:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.07736%,9:26.11237%,7:18.20929%,1:17.59813%,11:0.001%,10:0.00084%,3:0.00033%,21:0.00017%,15:0.00017%,4:0.00017%,2:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1632 (0.27311%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0407e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8693e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5360e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2140e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.1870e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1271e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1640 - tp: 79186.0000 - fp: 814.0000 - tn: 319186.0000 - fn: 814.0000 - accuracy: 0.9959 - precision: 0.9898 - recall: 0.9898 - auc: 0.9936 - val_loss: 2.9778 - val_tp: 16305.0000 - val_fp: 3695.0000 - val_tn: 76305.0000 - val_fn: 3695.0000 - val_accuracy: 0.9261 - val_precision: 0.8152 - val_recall: 0.8152 - val_auc: 0.8845
[INFO] saving weights to checkpoints/lstm-epoch-2-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.9236 - tp: 65489.0000 - fp: 14511.0000 - tn: 305489.0000 - fn: 14511.0000 - accuracy: 0.9274 - precision: 0.8186 - recall: 0.8186 - auc: 0.8866 - val_loss: 2.8988 - val_tp: 16403.0000 - val_fp: 3597.0000 - val_tn: 76403.0000 - val_fn: 3597.0000 - val_accuracy: 0.9281 - val_precision: 0.8202 - val_recall: 0.8202 - val_auc: 0.8876
[INFO] saving weights to checkpoints/lstm-epoch-2-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/597552
[33m[INFO] loading file 18-18/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597552, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597552, 17)

[INFO] analyzing data
[INFO] 597552 rows
[INFO] ** appi_name:[21:99.99833%,30:0.0005%,7:0.0005%,31:0.00017%,27:0.00017%,22:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:82.38965%,Multi Stage Multi Point:17.61035%]
[INFO] ** dst:[21:43.34234%,10:20.83233%,8:18.25314%,9:17.56952%,22:0.00067%,15:0.0005%,24:0.00033%,16:0.00033%,2:0.00033%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.9995%,0:0.0005%]
[INFO] ** i/f_name:[2:99.9995%,3:0.0005%]
[INFO] ** modbus_function_code:[0.02961:99.99833%,-33.760870000000004:0.00167%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99833%,0:0.00167%]
[INFO] ** modbus_transaction_id:65536 (10.96741%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.999%,2:0.0005%,1:0.0005%]
[INFO] ** proxy_src_ip:[18:38.0797%,20:26.09547%,13:18.25347%,6:17.56968%,17:0.0005%,11:0.0005%,1:0.00033%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:26.0948%,-0.32151:20.83233%,-1.27613:18.25297%,-0.23351:17.56935%,-0.33484:17.24737%,-71.33197:0.0005%,-1.27347:0.00033%,1.45709:0.00033%,-0.24151:0.00033%,1.47576:0.00017%,1.46509:0.00017%,3.6236699999999997:0.00017%,-1.2708:0.00017%,-2.48275:0.00017%,6.06224:0.00017%,-3.3787199999999995:0.00017%,8.10082:0.00017%,6.45955:0.00017%,-71.14931:0.00017%]
[INFO] ** scada_tag:[3:26.09447%,1:20.83216%,5:18.2528%,4:17.56918%,2:17.2472%,0:0.00418%]
[INFO] ** service:[0.0048200000000000005:99.99833%,-211.09762999999998:0.0005%,-211.73542999999998:0.0005%,-211.35747999999998:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.0797%,9:26.09547%,7:18.25347%,1:17.56968%,14:0.0005%,10:0.0005%,3:0.00033%,21:0.00017%,2:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1632 (0.27311%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6588 - tp: 71767.0000 - fp: 8233.0000 - tn: 311767.0000 - fn: 8233.0000 - accuracy: 0.9588 - precision: 0.8971 - recall: 0.8971 - auc: 0.9357 - val_loss: 9.3418e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.8111 - tp: 56121.0000 - fp: 23879.0000 - tn: 296121.0000 - fn: 23879.0000 - accuracy: 0.8806 - precision: 0.7015 - recall: 0.7015 - auc: 0.8134 - val_loss: 6.1080 - val_tp: 12421.0000 - val_fp: 7579.0000 - val_tn: 72421.0000 - val_fn: 7579.0000 - val_accuracy: 0.8484 - val_precision: 0.6211 - val_recall: 0.6211 - val_auc: 0.7632
[INFO] saving weights to checkpoints/lstm-epoch-2-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.1384 - tp: 49533.0000 - fp: 30467.0000 - tn: 289533.0000 - fn: 30467.0000 - accuracy: 0.8477 - precision: 0.6192 - recall: 0.6192 - auc: 0.7620 - val_loss: 6.1329 - val_tp: 12390.0000 - val_fp: 7610.0000 - val_tn: 72390.0000 - val_fn: 7610.0000 - val_accuracy: 0.8478 - val_precision: 0.6195 - val_recall: 0.6195 - val_auc: 0.7622
[INFO] saving weights to checkpoints/lstm-epoch-2-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.5331 - tp: 52537.0000 - fp: 27463.0000 - tn: 292537.0000 - fn: 27463.0000 - accuracy: 0.8627 - precision: 0.6567 - recall: 0.6567 - auc: 0.7854 - val_loss: 7.8388e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.9538e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.4509e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/597552
[33m[INFO] loading file 19-19/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597552, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597552, 17)

[INFO] analyzing data
[INFO] 597552 rows
[INFO] ** appi_name:[21:99.99816%,26:0.00033%,0:0.00033%,31:0.00017%,27:0.00017%,24:0.00017%,22:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:88.02447%,Single Stage Multi Point:11.97553%]
[INFO] ** dst:[21:43.39037%,10:20.83233%,8:18.20411%,9:17.57069%,22:0.00117%,6:0.0005%,25:0.00033%,24:0.00017%,18:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99816%,-33.760870000000004:0.00167%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99816%,0:0.00167%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (10.96741%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99883%,2:0.00117%]
[INFO] ** proxy_src_ip:[18:38.1217%,20:26.10116%,13:18.20411%,6:17.57069%,10:0.001%,11:0.00084%,16:0.0005%]
[INFO] ** s_port:[1.45442:26.10016%,-0.32151:20.83233%,-1.27613:18.20377%,-0.23351:17.57052%,-0.33484:17.28937%,-5.20264:0.00067%,1.45709:0.0005%,-1.02014:0.0005%,-64.19493:0.00033%,-71.14798:0.00033%,1.46509:0.00033%,-1.27347:0.00017%,-0.24151:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,-71.14931:0.00017%,-68.79874000000001:0.00017%,0.75578:0.00017%]
[INFO] ** scada_tag:[3:26.09982%,1:20.83216%,5:18.2036%,4:17.57035%,2:17.28921%,0:0.00485%]
[INFO] ** service:[0.0048200000000000005:99.99883%,-211.08346:0.00033%,-186.44547:0.00033%,-202.75898:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.1217%,9:26.10116%,7:18.20411%,1:17.57069%,11:0.001%,10:0.00084%,15:0.0005%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1634 (0.27345%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.1046e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.8635e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7457e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.5196e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3570e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.9290e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.7241e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5008e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.3221 - tp: 43658.0000 - fp: 36342.0000 - tn: 283658.0000 - fn: 36342.0000 - accuracy: 0.8183 - precision: 0.5457 - recall: 0.5457 - auc: 0.7161 - val_loss: 9.8232 - val_tp: 7811.0000 - val_fp: 12189.0000 - val_tn: 67811.0000 - val_fn: 12189.0000 - val_accuracy: 0.7562 - val_precision: 0.3905 - val_recall: 0.3905 - val_auc: 0.6191
[INFO] saving weights to checkpoints/lstm-epoch-2-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/597552
[33m[INFO] loading file 20-20/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597552, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597552, 17)

[INFO] analyzing data
[INFO] 597552 rows
[INFO] ** appi_name:[21:99.99682%,30:0.00268%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:89.2883%,Single Stage Multi Point:10.7117%]
[INFO] ** dst:[21:43.42735%,10:20.8345%,8:18.15407%,9:17.57939%,15:0.00268%,22:0.00117%,24:0.00033%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99766%,0:0.00234%]
[INFO] ** i/f_name:[2:99.99732%,3:0.00268%]
[INFO] ** modbus_function_code:[0.02961:99.99682%,-33.760870000000004:0.00318%]
[INFO] ** modbus_function_description:[7:49.99967%,11:49.99716%,0:0.00318%]
[INFO] ** modbus_transaction_id:65536 (10.96741%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99682%,1:0.00268%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.11233%,20:26.15019%,13:18.15424%,6:17.57989%,17:0.00268%,14:0.0005%,16:0.00017%]
[INFO] ** s_port:[1.45442:26.14936%,-0.32151:20.8345%,-1.27613:18.15373%,-0.23351:17.57922%,-0.33484:17.27783%,-71.33197:0.00268%,1.45709:0.0005%,-0.24151:0.0005%,-1.27347:0.00033%,13.431270000000001:0.00017%,-1.2708:0.00017%,-1.02014:0.00017%,-71.14798:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:26.14885%,1:20.83434%,5:18.15373%,4:17.57889%,2:17.27766%,0:0.00653%]
[INFO] ** service:[0.0048200000000000005:99.99682%,-211.73542999999998:0.00268%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.11233%,9:26.15019%,7:18.15424%,1:17.57989%,14:0.00268%,2:0.0005%,15:0.00017%]
[INFO] ** type:[0:99.99967%,1:0.00033%]
[INFO] ** unixtime:1634 (0.27345%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.6398 - tp: 56971.0000 - fp: 23029.0000 - tn: 296971.0000 - fn: 23029.0000 - accuracy: 0.8849 - precision: 0.7121 - recall: 0.7121 - auc: 0.8201 - val_loss: 3.8046e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.9079 - tp: 75494.0000 - fp: 4506.0000 - tn: 315494.0000 - fn: 4506.0000 - accuracy: 0.9775 - precision: 0.9437 - recall: 0.9437 - auc: 0.9648 - val_loss: 2.9681 - val_tp: 16317.0000 - val_fp: 3683.0000 - val_tn: 76317.0000 - val_fn: 3683.0000 - val_accuracy: 0.9263 - val_precision: 0.8159 - val_recall: 0.8159 - val_auc: 0.8849
[INFO] saving weights to checkpoints/lstm-epoch-2-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.9407 - tp: 65404.0000 - fp: 14596.0000 - tn: 305404.0000 - fn: 14596.0000 - accuracy: 0.9270 - precision: 0.8176 - recall: 0.8176 - auc: 0.8860 - val_loss: 2.9690 - val_tp: 16316.0000 - val_fp: 3684.0000 - val_tn: 76316.0000 - val_fn: 3684.0000 - val_accuracy: 0.9263 - val_precision: 0.8158 - val_recall: 0.8158 - val_auc: 0.8849
[INFO] saving weights to checkpoints/lstm-epoch-2-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9234 - tp: 65490.0000 - fp: 14510.0000 - tn: 305490.0000 - fn: 14510.0000 - accuracy: 0.9275 - precision: 0.8186 - recall: 0.8186 - auc: 0.8866 - val_loss: 2.6992e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/597552
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.5228e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3662e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/597552
[33m[INFO] loading file 21-21/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597550, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597550, 17)

[INFO] analyzing data
[INFO] 597550 rows
[INFO] ** appi_name:[21:99.99632%,30:0.001%,7:0.0005%,26:0.00033%,22:0.00033%,0:0.00033%,31:0.00017%,27:0.00017%,24:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:98.97866%,Multi Stage Single Point:1.02134%]
[INFO] ** dst:[21:43.32809%,10:20.9723%,8:18.16199%,9:17.53309%,15:0.001%,22:0.00084%,24:0.00067%,6:0.00067%,25:0.00033%,16:0.00033%,2:0.00033%,18:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.999%,0:0.001%]
[INFO] ** i/f_name:[2:99.999%,3:0.001%]
[INFO] ** modbus_function_code:[0.02961:99.99632%,-33.760870000000004:0.00351%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99916%,11:49.99716%,0:0.00351%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (10.96745%)
[INFO] ** orig:[0:99.99933%,2:0.00067%]
[INFO] ** proto:[0:99.99766%,2:0.00134%,1:0.001%]
[INFO] ** proxy_src_ip:[18:38.30223%,20:25.99799%,13:18.16266%,6:17.53293%,17:0.001%,10:0.001%,11:0.00084%,16:0.0005%,1:0.00033%,21:0.00017%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.99732%,-0.32151:20.97163%,-1.27613:18.16183%,-0.23351:17.53276%,-0.33484:17.3306%,-71.33197:0.001%,-1.27347:0.00067%,-6.64392:0.00067%,-1.02014:0.0005%,-64.19493:0.00033%,-71.14931:0.00033%,-71.14798:0.00033%,1.47576:0.00033%,1.46509:0.00017%,-1.2708:0.00017%,6.62488:0.00017%,10.15141:0.00017%,-68.79874000000001:0.00017%,7.060860000000001:0.00017%,-3.3787199999999995:0.00017%,-2.2440900000000004:0.00017%,1.45709:0.00017%,-0.24151:0.00017%]
[INFO] ** scada_tag:[3:25.99682%,1:20.9713%,5:18.16166%,4:17.53242%,2:17.3306%,0:0.0072%]
[INFO] ** service:[0.0048200000000000005:99.99699%,-211.73542999999998:0.001%,-211.09762999999998:0.0005%,-211.08346:0.00033%,-186.44547:0.00033%,-211.08818:0.00033%,-211.35747999999998:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.30223%,9:25.99799%,7:18.16266%,1:17.53293%,11:0.001%,21:0.00084%,10:0.00084%,15:0.0005%,14:0.00033%,3:0.00033%,4:0.00017%,2:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1628 (0.27245%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597550
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1741e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0485e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/597550
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9600e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8382e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/597550
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7198e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6360e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/597550
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5330e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4405e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/597550
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3496e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2512e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/597550
[33m[INFO] loading file 22-22/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (366591, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (366591, 17)

[INFO] analyzing data
[INFO] 366591 rows
[INFO] ** appi_name:[21:99.99291%,30:0.00627%,23:0.00027%,22:0.00027%,18:0.00027%]
[INFO] ** classification:[normal:63.84199%,Multi Stage Single Point:36.15801%]
[INFO] ** dst:[21:43.31912%,10:21.00679%,8:18.1011%,9:17.56481%,15:0.00627%,22:0.00109%,19:0.00055%,26:0.00027%]
[INFO] ** i/f_dir:[1:99.994%,0:0.006%]
[INFO] ** i/f_name:[2:99.99373%,3:0.006%,0:0.00027%]
[INFO] ** modbus_function_code:[0.02961:99.99291%,-33.760870000000004:0.00709%]
[INFO] ** modbus_function_description:[7:49.99714%,11:49.99577%,0:0.00709%]
[INFO] ** modbus_transaction_id:65534 (17.8766%)
[INFO] ** orig:[0:99.99509%,2:0.00436%,1:0.00055%]
[INFO] ** proto:[0:99.99345%,1:0.00627%,2:0.00027%]
[INFO] ** proxy_src_ip:[18:38.33018%,20:25.99655%,13:18.10055%,6:17.56562%,17:0.00627%,14:0.00055%,10:0.00027%]
[INFO] ** s_port:[1.45442:25.99573%,-0.32151:21.00679%,-1.27613:18.10055%,-0.23351:17.56481%,-0.33484:17.32339%,-71.33197:0.00627%,1.45709:0.00055%,-0.24151:0.00055%,7.228860000000001:0.00055%,-0.24950999999999998:0.00027%,1.46509:0.00027%,-71.14931:0.00027%]
[INFO] ** scada_tag:[3:25.99546%,1:21.00679%,5:18.10055%,4:17.56453%,2:17.32339%,0:0.00927%]
[INFO] ** service:[0.0048200000000000005:99.99291%,-211.73542999999998:0.00627%,-211.07873999999998:0.00055%,-211.08818:0.00027%]
[INFO] ** src:[22:38.33018%,9:25.99655%,7:18.10055%,1:17.56562%,21:0.00436%,14:0.00191%,2:0.00055%,11:0.00027%]
[INFO] ** type:[0:99.99836%,1:0.00164%]
[INFO] ** unixtime:1012 (0.27606%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/366591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1815e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.8380 - val_tp: 12756.0000 - val_fp: 7244.0000 - val_tn: 72756.0000 - val_fn: 7244.0000 - val_accuracy: 0.8551 - val_precision: 0.6378 - val_recall: 0.6378 - val_auc: 0.7736
[INFO] saving weights to checkpoints/lstm-epoch-2-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/366591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5674 - tp: 42440.0000 - fp: 37560.0000 - tn: 282440.0000 - fn: 37560.0000 - accuracy: 0.8122 - precision: 0.5305 - recall: 0.5305 - auc: 0.7066 - val_loss: 7.5763 - val_tp: 10599.0000 - val_fp: 9401.0000 - val_tn: 70599.0000 - val_fn: 9401.0000 - val_accuracy: 0.8120 - val_precision: 0.5300 - val_recall: 0.5300 - val_auc: 0.7062
[INFO] saving weights to checkpoints/lstm-epoch-2-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/366591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5916 - tp: 42320.0000 - fp: 37680.0000 - tn: 282320.0000 - fn: 37680.0000 - accuracy: 0.8116 - precision: 0.5290 - recall: 0.5290 - auc: 0.7056 - val_loss: 7.5763 - val_tp: 10599.0000 - val_fp: 9401.0000 - val_tn: 70599.0000 - val_fn: 9401.0000 - val_accuracy: 0.8120 - val_precision: 0.5300 - val_recall: 0.5300 - val_auc: 0.7062
[INFO] saving weights to checkpoints/lstm-epoch-2-files-21-22-batch-200000-300000
[INFO] processing batch 300000-400000/366591
[33m[INFO] loading file 23-23/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (566591, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (566591, 17)

[INFO] analyzing data
[INFO] 566591 rows
[INFO] ** appi_name:[21:99.99859%,30:0.00071%,31:0.00035%,33:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:92.88711%,Multi Stage Single Point:7.11289%]
[INFO] ** dst:[21:43.31978%,10:21.00104%,8:18.14342%,9:17.53311%,22:0.00106%,15:0.00071%,24:0.00035%,18:0.00035%,25:0.00018%]
[INFO] ** i/f_dir:[1:99.99929%,0:0.00071%]
[INFO] ** i/f_name:[2:99.99929%,3:0.00071%]
[INFO] ** modbus_function_code:[0.02961:99.99859%,-33.760870000000004:0.00141%]
[INFO] ** modbus_function_description:[7:50.00026%,11:49.99832%,0:0.00141%]
[INFO] ** modbus_transaction_id:65536 (11.56672%)
[INFO] ** orig:[0:99.99947%,2:0.00053%]
[INFO] ** proto:[0:99.99876%,1:0.00071%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.33541%,20:25.98594%,13:18.14342%,6:17.53328%,17:0.00071%,16:0.00053%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.98506%,-0.32151:21.00086%,-1.27613:18.14289%,-0.23351:17.53293%,-0.33484:17.33455%,-71.33197:0.00071%,-1.02014:0.00053%,-0.08551:0.00035%,-1.27347:0.00035%,1.45709:0.00035%,1.46509:0.00035%,-0.24151:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%,-0.24950999999999998:0.00018%,-49.275529999999996:0.00018%]
[INFO] ** scada_tag:[3:25.98471%,1:21.00086%,5:18.14272%,4:17.53275%,2:17.33437%,0:0.00459%]
[INFO] ** service:[0.0048200000000000005:99.99876%,-211.73542999999998:0.00071%,-186.43601999999998:0.00035%,-186.44547:0.00018%]
[INFO] ** src:[22:38.33541%,9:25.98594%,7:18.14342%,1:17.53328%,21:0.00053%,15:0.00053%,17:0.00018%,14:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1543 (0.27233%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5685 - tp: 42435.0000 - fp: 37565.0000 - tn: 282435.0000 - fn: 37565.0000 - accuracy: 0.8122 - precision: 0.5304 - recall: 0.5304 - auc: 0.7065 - val_loss: 2.2050 - val_tp: 17264.0000 - val_fp: 2736.0000 - val_tn: 77264.0000 - val_fn: 2736.0000 - val_accuracy: 0.9453 - val_precision: 0.8632 - val_recall: 0.8632 - val_auc: 0.9145
[INFO] saving weights to checkpoints/lstm-epoch-2-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.9570e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.4338e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.9849e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.5710e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.1379e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7447e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.4387e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.1748e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/566591
[33m[INFO] loading file 24-24/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (566591, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (566591, 17)

[INFO] analyzing data
[INFO] 566591 rows
[INFO] ** appi_name:[21:99.99347%,30:0.00318%,26:0.00053%,31:0.00035%,27:0.00035%,22:0.00035%,0:0.00035%,24:0.00018%,23:0.00018%,19:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,11:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:95.50293%,Multi Stage Single Point:4.49707%]
[INFO] ** dst:[21:43.37079%,10:21.01781%,8:18.09648%,9:17.50804%,15:0.00318%,22:0.00106%,6:0.00071%,25:0.00035%,24:0.00035%,19:0.00035%,18:0.00035%,7:0.00035%,26:0.00018%]
[INFO] ** i/f_dir:[1:99.997%,0:0.003%]
[INFO] ** i/f_name:[2:99.99682%,3:0.00318%]
[INFO] ** modbus_function_code:[0.02961:99.99347%,-33.760870000000004:0.006%,-0.415:0.00018%,0.9188299999999999:0.00018%,0.47422:0.00018%]
[INFO] ** modbus_function_description:[7:49.99779%,11:49.99568%,0:0.006%,15:0.00018%,10:0.00018%,2:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.56672%)
[INFO] ** orig:[0:99.99965%,1:0.00035%]
[INFO] ** proto:[0:99.99488%,1:0.00318%,2:0.00194%]
[INFO] ** proxy_src_ip:[18:38.40319%,20:25.98629%,13:18.0963%,6:17.50734%,17:0.00318%,10:0.00124%,14:0.00088%,11:0.00088%,21:0.00035%,16:0.00035%]
[INFO] ** s_port:[1.45442:25.98541%,-0.32151:21.01781%,-1.27613:18.09595%,-0.23351:17.50663%,-0.33484:17.38538%,-71.33197:0.00318%,-9.58113:0.00071%,-71.14798:0.00053%,-0.24950999999999998:0.00035%,-1.27347:0.00035%,1.45709:0.00035%,-0.24151:0.00035%,-1.02014:0.00035%,-31.55091:0.00035%,7.6315100000000005:0.00035%,-71.14931:0.00035%,-64.19493:0.00035%,1.47576:0.00035%,-68.79874000000001:0.00018%,1.46509:0.00018%,7.4901800000000005:0.00018%,13.431270000000001:0.00018%,11.862:0.00018%]
[INFO] ** scada_tag:[3:25.98523%,1:21.01781%,5:18.09577%,4:17.50628%,2:17.3852%,0:0.00971%]
[INFO] ** service:[0.0048200000000000005:99.99453%,-211.73542999999998:0.00318%,-211.08346:0.00053%,-211.07873999999998:0.00035%,-202.75898:0.00035%,-186.44547:0.00035%,-186.43601999999998:0.00035%,-211.08818:0.00035%]
[INFO] ** src:[22:38.40319%,9:25.98629%,7:18.0963%,1:17.50734%,14:0.00318%,11:0.00124%,10:0.00088%,2:0.00088%,15:0.00035%,4:0.00035%]
[INFO] ** type:[0:99.99876%,1:0.00088%,2:0.00035%]
[INFO] ** unixtime:1539 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.8835e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.6547e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.4946e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2936e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.1277e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9720e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.8223e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7101e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.5387e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4716 - val_tp: 18174.0000 - val_fp: 1826.0000 - val_tn: 78174.0000 - val_fn: 1826.0000 - val_accuracy: 0.9635 - val_precision: 0.9087 - val_recall: 0.9087 - val_auc: 0.9429
[INFO] saving weights to checkpoints/lstm-epoch-2-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/566591
[33m[INFO] loading file 25-25/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (566591, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (566591, 17)

[INFO] analyzing data
[INFO] 566591 rows
[INFO] ** appi_name:[21:99.99647%,30:0.00106%,17:0.00071%,22:0.00053%,31:0.00035%,28:0.00018%,26:0.00018%,12:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** classification:[normal:64.35118%,Multi Stage Single Point:35.64882%]
[INFO] ** dst:[21:43.32102%,10:21.02593%,8:18.13389%,9:17.51493%,15:0.00106%,22:0.00088%,16:0.00071%,6:0.00071%,18:0.00035%,17:0.00035%,24:0.00018%]
[INFO] ** i/f_dir:[1:99.99894%,0:0.00106%]
[INFO] ** i/f_name:[2:99.99894%,3:0.00106%]
[INFO] ** modbus_function_code:[0.02961:99.99647%,-33.760870000000004:0.00353%]
[INFO] ** modbus_function_description:[7:49.99903%,11:49.99744%,0:0.00353%]
[INFO] ** modbus_transaction_id:65536 (11.56672%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99788%,2:0.00106%,1:0.00106%]
[INFO] ** proxy_src_ip:[18:38.38924%,20:25.95752%,13:18.13389%,6:17.51546%,17:0.00106%,1:0.00088%,21:0.00071%,16:0.00035%,14:0.00035%,7:0.00035%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95717%,-0.32151:21.02557%,-1.27613:18.13354%,-0.23351:17.51493%,-0.33484:17.36367%,-71.33197:0.00106%,-71.14931:0.00053%,-0.24151:0.00035%,-1.02014:0.00035%,-49.275529999999996:0.00035%,1.46509:0.00018%,-5.1466400000000005:0.00018%,-1.27347:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,-0.24950999999999998:0.00018%,2.52505:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,6.1115699999999995:0.00018%,-5.08665:0.00018%,1.45709:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:25.95682%,1:21.0254%,5:18.13336%,4:17.51475%,2:17.3635%,0:0.00618%]
[INFO] ** service:[0.0048200000000000005:99.99682%,-211.73542999999998:0.00106%,-205.44247:0.00071%,-211.08818:0.00053%,-186.43601999999998:0.00035%,-211.09762999999998:0.00018%,-211.08346:0.00018%,-185.9872:0.00018%]
[INFO] ** src:[22:38.38924%,9:25.95752%,7:18.13389%,1:17.51546%,14:0.00106%,3:0.00088%,4:0.00071%,21:0.00035%,15:0.00035%,2:0.00035%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1539 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7330 - tp: 51545.0000 - fp: 28455.0000 - tn: 291545.0000 - fn: 28455.0000 - accuracy: 0.8577 - precision: 0.6443 - recall: 0.6443 - auc: 0.7777 - val_loss: 5.7429 - val_tp: 12874.0000 - val_fp: 7126.0000 - val_tn: 72874.0000 - val_fn: 7126.0000 - val_accuracy: 0.8575 - val_precision: 0.6437 - val_recall: 0.6437 - val_auc: 0.7773
[INFO] saving weights to checkpoints/lstm-epoch-2-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7552 - tp: 51435.0000 - fp: 28565.0000 - tn: 291435.0000 - fn: 28565.0000 - accuracy: 0.8572 - precision: 0.6429 - recall: 0.6429 - auc: 0.7768 - val_loss: 5.7566 - val_tp: 12857.0000 - val_fp: 7143.0000 - val_tn: 72857.0000 - val_fn: 7143.0000 - val_accuracy: 0.8571 - val_precision: 0.6428 - val_recall: 0.6428 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-2-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7463 - tp: 51479.0000 - fp: 28521.0000 - tn: 291479.0000 - fn: 28521.0000 - accuracy: 0.8574 - precision: 0.6435 - recall: 0.6435 - auc: 0.7772 - val_loss: 5.7276 - val_tp: 12893.0000 - val_fp: 7107.0000 - val_tn: 72893.0000 - val_fn: 7107.0000 - val_accuracy: 0.8579 - val_precision: 0.6446 - val_recall: 0.6446 - val_auc: 0.7779
[INFO] saving weights to checkpoints/lstm-epoch-2-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.7497 - tp: 51462.0000 - fp: 28538.0000 - tn: 291462.0000 - fn: 28538.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.7770 - val_loss: 5.7324 - val_tp: 12887.0000 - val_fp: 7113.0000 - val_tn: 72887.0000 - val_fn: 7113.0000 - val_accuracy: 0.8577 - val_precision: 0.6443 - val_recall: 0.6443 - val_auc: 0.7777
[INFO] saving weights to checkpoints/lstm-epoch-2-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7594 - tp: 51414.0000 - fp: 28586.0000 - tn: 291414.0000 - fn: 28586.0000 - accuracy: 0.8571 - precision: 0.6427 - recall: 0.6427 - auc: 0.7767 - val_loss: 5.7195 - val_tp: 12903.0000 - val_fp: 7097.0000 - val_tn: 72903.0000 - val_fn: 7097.0000 - val_accuracy: 0.8581 - val_precision: 0.6452 - val_recall: 0.6452 - val_auc: 0.7782
[INFO] saving weights to checkpoints/lstm-epoch-2-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/566591
[33m[INFO] loading file 26-26/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (566591, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (566591, 17)

[INFO] analyzing data
[INFO] 566591 rows
[INFO] ** appi_name:[21:99.99824%,30:0.00053%,7:0.00053%,31:0.00018%,22:0.00018%,12:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:64.39707%,Single Stage Single Point:28.18823%,Multi Stage Single Point:7.4147%]
[INFO] ** dst:[21:43.30884%,10:21.08593%,8:18.12189%,9:17.48069%,22:0.00071%,15:0.00053%,24:0.00035%,16:0.00035%,2:0.00035%,18:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99947%,0:0.00053%]
[INFO] ** i/f_name:[2:99.99947%,3:0.00053%]
[INFO] ** modbus_function_code:[0.02961:99.99824%,-33.760870000000004:0.00176%]
[INFO] ** modbus_function_description:[7:49.99974%,11:49.9985%,0:0.00176%]
[INFO] ** modbus_transaction_id:65536 (11.56672%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99912%,1:0.00053%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.46337%,20:25.93158%,13:18.12224%,6:17.48069%,17:0.00053%,1:0.00053%,21:0.00035%,16:0.00035%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.93105%,-0.32151:21.08576%,-1.27613:18.12171%,-0.23351:17.48051%,-0.33484:17.37761%,-71.33197:0.00053%,-1.02014:0.00035%,-1.27347:0.00035%,-49.275529999999996:0.00018%,1.47576:0.00018%,1.45709:0.00018%,1.46509:0.00018%,-1.2708:0.00018%,14.191239999999999:0.00018%,2.52505:0.00018%,-3.3787199999999995:0.00018%,11.57001:0.00018%,-71.14931:0.00018%,7.66617:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.9307%,1:21.08576%,5:18.12154%,4:17.48033%,2:17.37761%,0:0.00406%]
[INFO] ** service:[0.0048200000000000005:99.99841%,-211.09762999999998:0.00053%,-211.73542999999998:0.00053%,-211.35747999999998:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.46337%,9:25.93158%,7:18.12224%,1:17.48069%,14:0.00053%,3:0.00053%,15:0.00035%,4:0.00035%,21:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1538 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7425 - tp: 51498.0000 - fp: 28502.0000 - tn: 291498.0000 - fn: 28502.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.7773 - val_loss: 5.7550 - val_tp: 12859.0000 - val_fp: 7141.0000 - val_tn: 72859.0000 - val_fn: 7141.0000 - val_accuracy: 0.8572 - val_precision: 0.6429 - val_recall: 0.6429 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-2-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.6590 - tp: 70983.0000 - fp: 8548.0000 - tn: 311452.0000 - fn: 9017.0000 - accuracy: 0.9561 - precision: 0.8925 - recall: 0.8873 - auc: 0.9657 - val_loss: 0.1106 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0073 - tp: 79998.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0013 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0010 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.9872e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/566591
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.7565e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7661e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/566591
[33m[INFO] loading file 27-27/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (506721, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (506721, 17)

[INFO] analyzing data
[INFO] 506721 rows
[INFO] ** appi_name:[21:99.99941%,30:0.00059%]
[INFO] ** classification:[normal:64.35849%,Single Stage Single Point:35.64151%]
[INFO] ** dst:[21:43.28773%,10:21.06899%,8:18.17154%,9:17.47017%,22:0.00079%,15:0.00059%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.9998%,0:0.0002%]
[INFO] ** i/f_name:[2:99.99941%,3:0.00059%]
[INFO] ** modbus_function_code:[0.02961:99.99941%,-33.760870000000004:0.00059%]
[INFO] ** modbus_function_description:[7:50.0003%,11:49.99911%,0:0.00059%]
[INFO] ** modbus_transaction_id:65536 (12.93335%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99941%,1:0.00059%]
[INFO] ** proxy_src_ip:[18:38.42627%,20:25.93104%,13:18.17134%,6:17.47036%,17:0.00059%,16:0.00039%]
[INFO] ** s_port:[1.45442:25.93044%,-0.32151:21.06899%,-1.27613:18.17114%,-0.23351:17.46997%,-0.33484:17.35728%,-71.33197:0.00059%,-1.02014:0.00039%,-1.27347:0.0002%,1.45709:0.0002%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-0.24151:0.0002%]
[INFO] ** scada_tag:[3:25.93005%,1:21.06879%,5:18.17095%,4:17.46977%,2:17.35709%,0:0.00335%]
[INFO] ** service:[0.0048200000000000005:99.99941%,-211.73542999999998:0.00059%]
[INFO] ** src:[22:38.42627%,9:25.93104%,7:18.17134%,1:17.47036%,14:0.00059%,15:0.00039%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1376 (0.27155%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/506721
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.6973e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3527e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/506721
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.0399e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.4843e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/506721
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.1625e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8644e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/506721
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.6133e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3810e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/506721
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1947e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.9900e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-26-27-batch-400000-500000
[INFO] processing batch 500000-600000/506721
[33m[INFO] loading file 28-28/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (340637, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (340637, 17)

[INFO] analyzing data
[INFO] 340637 rows
[INFO] ** appi_name:[21:99.99149%,30:0.00176%,17:0.00147%,22:0.00117%,7:0.00117%,31:0.00088%,26:0.00088%,28:0.00029%,27:0.00029%,8:0.00029%,0:0.00029%]
[INFO] ** classification:[normal:64.31421%,Single Stage Single Point:35.68579%]
[INFO] ** dst:[21:43.28714%,10:21.01856%,8:18.19796%,9:17.48753%,6:0.00235%,16:0.00205%,18:0.00147%,17:0.00059%,15:0.00059%,2:0.00059%,25:0.00029%,22:0.00029%,7:0.00029%,0:0.00029%]
[INFO] ** i/f_dir:[1:99.99941%,0:0.00059%]
[INFO] ** i/f_name:[2:99.99941%,3:0.00059%]
[INFO] ** modbus_function_code:[0.02961:99.99149%,-33.760870000000004:0.00851%]
[INFO] ** modbus_function_description:[11:49.99604%,7:49.99545%,0:0.00851%]
[INFO] ** modbus_transaction_id:65535 (19.23896%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99501%,2:0.0044%,1:0.00059%]
[INFO] ** proxy_src_ip:[18:38.33935%,20:25.96635%,13:18.19826%,6:17.48753%,1:0.00235%,17:0.00176%,14:0.00176%,7:0.00147%,21:0.00088%,0:0.00029%]
[INFO] ** s_port:[1.45442:25.96606%,-0.32151:21.01856%,-1.27613:18.19796%,-0.23351:17.48724%,-0.33484:17.32078%,-71.14798:0.00117%,-71.14931:0.00117%,-71.33197:0.00059%,-0.08551:0.00059%,7.66617:0.00029%,-58.035180000000004:0.00029%,-1.2708:0.00029%,-64.19493:0.00029%,-5.1466400000000005:0.00029%,13.431270000000001:0.00029%,-0.24151:0.00029%,11.57001:0.00029%,14.4699:0.00029%,1.47576:0.00029%,14.191239999999999:0.00029%,-5.08665:0.00029%,10.192739999999999:0.00029%,-3.3787199999999995:0.00029%,6.1115699999999995:0.00029%,2.05573:0.00029%,-43.76509:0.00029%,2.52505:0.00029%,11.862:0.00029%,-58.032509999999995:0.00029%]
[INFO] ** scada_tag:[3:25.96606%,1:21.01856%,5:18.19796%,4:17.48694%,2:17.32078%,0:0.00969%]
[INFO] ** service:[0.0048200000000000005:99.99149%,-205.44247:0.00147%,-186.43601999999998:0.00147%,-211.09762999999998:0.00117%,-211.08346:0.00117%,-211.08818:0.00117%,-211.73542999999998:0.00059%,-186.44547:0.00029%,-183.8612:0.00029%,-185.9872:0.00029%,-211.35747999999998:0.00029%,-202.75898:0.00029%]
[INFO] ** src:[22:38.33935%,9:25.96635%,7:18.19826%,1:17.48753%,3:0.00264%,2:0.00176%,21:0.00147%,4:0.00117%,14:0.00059%,8:0.00059%,17:0.00029%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:926 (0.27184%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/340637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.6143e-04 - tp: 79991.0000 - fp: 9.0000 - tn: 319991.0000 - fn: 9.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 1.8876e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/340637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7631e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.5908e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/340637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.9844e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3194e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/340637
[33m[INFO] loading file 29-29/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540637, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540637, 17)

[INFO] analyzing data
[INFO] 540637 rows
[INFO] ** appi_name:[21:99.99889%,30:0.00055%,26:0.00018%,9:0.00018%,3:0.00018%]
[INFO] ** classification:[normal:64.39219%,Single Stage Single Point:35.60781%]
[INFO] ** dst:[21:43.32704%,10:21.06386%,8:18.14341%,9:17.46403%,22:0.00055%,15:0.00055%,24:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99945%,3:0.00055%]
[INFO] ** modbus_function_code:[0.02961:99.99889%,-33.760870000000004:0.00111%]
[INFO] ** modbus_function_description:[7:49.99972%,11:49.99917%,0:0.00111%]
[INFO] ** modbus_transaction_id:65536 (12.122%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99926%,1:0.00055%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.44058%,20:25.9505%,13:18.14378%,6:17.46384%,17:0.00055%,21:0.00018%,16:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.94994%,-0.32151:21.06367%,-1.27613:18.14341%,-0.23351:17.46384%,-0.33484:17.37691%,-71.33197:0.00055%,1.45709:0.00037%,-71.14798:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.94957%,1:21.06349%,5:18.14341%,4:17.46347%,2:17.37691%,0:0.00314%]
[INFO] ** service:[0.0048200000000000005:99.99908%,-211.73542999999998:0.00055%,-183.8612:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.44058%,9:25.9505%,7:18.14378%,1:17.46384%,14:0.00055%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1468 (0.27153%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3786e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1210e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0417e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.6730e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.2292e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.4532e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8577e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.4551e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0984e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.0990e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/540637
[33m[INFO] loading file 30-30/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540637, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540637, 17)

[INFO] analyzing data
[INFO] 540637 rows
[INFO] ** appi_name:[21:99.9976%,30:0.00166%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.36925%,Single Stage Single Point:35.63075%]
[INFO] ** dst:[21:43.33684%,10:21.02945%,8:18.14489%,9:17.48548%,15:0.00166%,22:0.00074%,24:0.00037%,25:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99834%,0:0.00166%]
[INFO] ** i/f_name:[2:99.99834%,3:0.00166%]
[INFO] ** modbus_function_code:[0.02961:99.9976%,-33.760870000000004:0.0024%]
[INFO] ** modbus_function_description:[7:49.99972%,11:49.99787%,0:0.0024%]
[INFO] ** modbus_transaction_id:65536 (12.122%)
[INFO] ** orig:[0:99.99908%,2:0.00055%,1:0.00037%]
[INFO] ** proto:[0:99.99797%,1:0.00166%,2:0.00037%]
[INFO] ** proxy_src_ip:[18:38.36955%,20:25.99656%,13:18.14526%,6:17.48604%,17:0.00166%,7:0.00037%,16:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.99637%,-0.32151:21.02927%,-1.27613:18.14471%,-0.23351:17.4853%,-0.33484:17.34029%,-71.33197:0.00166%,-0.24151:0.00055%,-1.27347:0.00037%,-71.14798:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:25.996%,1:21.02927%,5:18.14452%,4:17.48511%,2:17.3401%,0:0.00499%]
[INFO] ** service:[0.0048200000000000005:99.99778%,-211.73542999999998:0.00166%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.36955%,9:25.99656%,7:18.14526%,1:17.48604%,14:0.00111%,21:0.00092%,16:0.00018%,15:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99926%,1:0.00074%]
[INFO] ** unixtime:1470 (0.2719%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.8294e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.8424e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8999e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.3047e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7485e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.9395e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6366e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.2914e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7832e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.1399e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/540637
[33m[INFO] loading file 31-31/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540637, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540637, 17)

[INFO] analyzing data
[INFO] 540637 rows
[INFO] ** appi_name:[21:99.99982%,26:0.00018%]
[INFO] ** classification:[normal:64.37869%,Single Stage Single Point:35.62131%]
[INFO] ** dst:[21:43.32093%,10:21.05646%,8:18.12492%,9:17.49621%,22:0.00092%,24:0.00037%,6:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99982%,-33.760870000000004:0.00018%]
[INFO] ** modbus_function_description:[11:49.99991%,7:49.99991%,0:0.00018%]
[INFO] ** modbus_transaction_id:65536 (12.122%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.40081%,20:25.97732%,13:18.1251%,6:17.49621%,16:0.00037%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.97658%,-0.32151:21.05646%,-1.27613:18.12473%,-0.23351:17.49603%,-0.33484:17.34435%,-1.27347:0.00037%,1.45709:0.00037%,-1.02014:0.00037%,-71.14798:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.97621%,1:21.05627%,5:18.12455%,4:17.49584%,2:17.34417%,0:0.00296%]
[INFO] ** service:[0.0048200000000000005:99.99982%,-211.08346:0.00018%]
[INFO] ** src:[22:38.40081%,9:25.97732%,7:18.1251%,1:17.49621%,15:0.00037%,21:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1469 (0.27172%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7713e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6854e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.3861e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1291e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.9059e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6617e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.4476e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2263e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0421e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8760e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/540637
[33m[INFO] loading file 32-32/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540637, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540637, 17)

[INFO] analyzing data
[INFO] 540637 rows
[INFO] ** appi_name:[21:99.9963%,30:0.00314%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.37554%,Single Stage Single Point:35.62446%]
[INFO] ** dst:[21:43.31964%,10:21.05109%,8:18.16024%,9:17.46421%,15:0.00314%,22:0.00092%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99723%,0:0.00277%]
[INFO] ** i/f_name:[2:99.99686%,3:0.00314%]
[INFO] ** modbus_function_code:[0.02961:99.9963%,-33.760870000000004:0.0037%]
[INFO] ** modbus_function_description:[7:49.99917%,11:49.99713%,0:0.0037%]
[INFO] ** modbus_transaction_id:65536 (12.122%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9963%,1:0.00314%,2:0.00055%]
[INFO] ** proxy_src_ip:[18:38.41376%,20:25.95734%,13:18.16024%,6:17.46477%,17:0.00314%,14:0.00055%,16:0.00018%]
[INFO] ** s_port:[1.45442:25.95679%,-0.32151:21.05109%,-1.27613:18.15987%,-0.23351:17.46403%,-0.33484:17.36267%,-71.33197:0.00314%,-0.24151:0.00055%,-1.2708:0.00018%,-1.02014:0.00018%,13.431270000000001:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,1.45709:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:25.95642%,1:21.05091%,5:18.15987%,4:17.46366%,2:17.36267%,0:0.00647%]
[INFO] ** service:[0.0048200000000000005:99.9963%,-211.73542999999998:0.00314%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.41376%,9:25.95734%,7:18.16024%,1:17.46477%,14:0.00314%,2:0.00055%,15:0.00018%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1467 (0.27135%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.4256e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.3765e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.2127e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2887e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6336e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4400e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.2763e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8928e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6546e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4940e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/540637
[33m[INFO] loading file 33-33/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540637, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540637, 17)

[INFO] analyzing data
[INFO] 540637 rows
[INFO] ** appi_name:[21:99.99686%,30:0.00111%,17:0.00074%,22:0.00055%,31:0.00018%,28:0.00018%,26:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.39811%,Single Stage Single Point:35.60189%]
[INFO] ** dst:[21:43.33185%,10:21.06127%,8:18.11474%,9:17.48715%,22:0.00148%,15:0.00111%,16:0.00074%,6:0.00074%,24:0.00037%,17:0.00037%,18:0.00018%]
[INFO] ** i/f_dir:[1:99.99889%,0:0.00111%]
[INFO] ** i/f_name:[2:99.99889%,3:0.00111%]
[INFO] ** modbus_function_code:[0.02961:99.99686%,-33.760870000000004:0.00314%]
[INFO] ** modbus_function_description:[7:49.99954%,11:49.99732%,0:0.00314%]
[INFO] ** modbus_transaction_id:65536 (12.122%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99797%,1:0.00111%,2:0.00092%]
[INFO] ** proxy_src_ip:[18:38.42449%,20:25.96955%,13:18.11474%,6:17.48733%,17:0.00111%,16:0.00074%,1:0.00074%,21:0.00037%,14:0.00037%,7:0.00037%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.96863%,-0.32151:21.06127%,-1.27613:18.11437%,-0.23351:17.48696%,-0.33484:17.36322%,-71.33197:0.00111%,-1.02014:0.00074%,1.45709:0.00055%,-71.14931:0.00055%,-1.27347:0.00037%,-5.08665:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,-43.76509:0.00018%,-71.14798:0.00018%,-58.032509999999995:0.00018%,-58.035180000000004:0.00018%,-0.24151:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:25.96826%,1:21.06127%,5:18.11419%,4:17.48678%,2:17.36322%,0:0.00629%]
[INFO] ** service:[0.0048200000000000005:99.99686%,-211.73542999999998:0.00111%,-205.44247:0.00074%,-211.08818:0.00055%,-211.09762999999998:0.00018%,-211.08346:0.00018%,-185.9872:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.42449%,9:25.96955%,7:18.11474%,1:17.48733%,14:0.00111%,15:0.00074%,3:0.00074%,21:0.00037%,4:0.00037%,2:0.00037%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1470 (0.2719%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.5640e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6478e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6571e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4504e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3273e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2203e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1923e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0659e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/540637
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2136e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0161e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/540637
[33m[INFO] loading file 34-34/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (382070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (382070, 17)

[INFO] analyzing data
[INFO] 382070 rows
[INFO] ** appi_name:[21:99.99738%,30:0.00079%,7:0.00079%,31:0.00026%,22:0.00026%,8:0.00026%,6:0.00026%]
[INFO] ** classification:[normal:64.34109%,Single Stage Single Point:35.65891%]
[INFO] ** dst:[21:43.28107%,10:21.05687%,8:18.19954%,9:17.45937%,22:0.00079%,15:0.00079%,16:0.00052%,2:0.00052%,18:0.00026%,6:0.00026%]
[INFO] ** i/f_dir:[1:99.99921%,0:0.00079%]
[INFO] ** i/f_name:[2:99.99921%,3:0.00079%]
[INFO] ** modbus_function_code:[0.02961:99.99738%,-33.760870000000004:0.00262%]
[INFO] ** modbus_function_description:[7:49.99921%,11:49.99817%,0:0.00262%]
[INFO] ** modbus_transaction_id:65536 (17.15288%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99869%,1:0.00079%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.38852%,20:25.94943%,13:18.19954%,6:17.45989%,17:0.00079%,1:0.00079%,21:0.00052%,14:0.00026%,7:0.00026%]
[INFO] ** s_port:[1.45442:25.94917%,-0.32151:21.05661%,-1.27613:18.19954%,-0.23351:17.4591%,-0.33484:17.3319%,-0.24151:0.00079%,-71.33197:0.00079%,-3.0613900000000003:0.00026%,-3.3787199999999995:0.00026%,14.191239999999999:0.00026%,1.47576:0.00026%,11.57001:0.00026%,-49.275529999999996:0.00026%,-71.14931:0.00026%,7.66617:0.00026%]
[INFO] ** scada_tag:[3:25.94891%,1:21.05635%,5:18.19928%,4:17.45858%,2:17.3319%,0:0.00497%]
[INFO] ** service:[0.0048200000000000005:99.99764%,-211.09762999999998:0.00079%,-211.73542999999998:0.00079%,-186.43601999999998:0.00026%,-211.35747999999998:0.00026%,-211.08818:0.00026%]
[INFO] ** src:[22:38.38852%,9:25.94943%,7:18.19954%,1:17.45989%,14:0.00079%,3:0.00079%,4:0.00052%,21:0.00026%,2:0.00026%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1038 (0.27168%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/382070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 9.9670e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.7657e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/382070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5607e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.1136e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/382070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.2084e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4105e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/382070
[33m[INFO] loading file 35-35/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582070, 17)

[INFO] analyzing data
[INFO] 582070 rows
[INFO] ** appi_name:[21:99.99897%,30:0.00103%]
[INFO] ** classification:[normal:64.36356%,Single Stage Single Point:35.63644%]
[INFO] ** dst:[21:43.32297%,10:21.03802%,8:18.16208%,9:17.4747%,22:0.0012%,15:0.00103%]
[INFO] ** i/f_dir:[1:99.99914%,0:0.00086%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.99897%,-33.760870000000004:0.00103%]
[INFO] ** modbus_function_description:[7:50.00034%,11:49.99863%,0:0.00103%]
[INFO] ** modbus_transaction_id:65536 (11.25913%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.99897%,1:0.00103%]
[INFO] ** proxy_src_ip:[18:38.39384%,20:25.96767%,13:18.16173%,6:17.47505%,17:0.00103%,16:0.00069%]
[INFO] ** s_port:[1.45442:25.96715%,-0.32151:21.03802%,-1.27613:18.16173%,-0.23351:17.47453%,-0.33484:17.35582%,-71.33197:0.00103%,-1.02014:0.00069%,-0.24151:0.00034%,1.45709:0.00017%,-0.24950999999999998:0.00017%,1.46509:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.96681%,1:21.03802%,5:18.16156%,4:17.47419%,2:17.35582%,0:0.00361%]
[INFO] ** service:[0.0048200000000000005:99.99897%,-211.73542999999998:0.00103%]
[INFO] ** src:[22:38.39384%,9:25.96767%,7:18.16173%,1:17.47505%,14:0.00103%,15:0.00069%]
[INFO] ** type:[0:99.99914%,1:0.00086%]
[INFO] ** unixtime:1580 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7040e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5510e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6013e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4215e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.9762e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0528e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6710e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0273e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.9217e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.8622e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/582070
[33m[INFO] loading file 36-36/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582070, 17)

[INFO] analyzing data
[INFO] 582070 rows
[INFO] ** appi_name:[21:99.99863%,30:0.00069%,31:0.00034%,33:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.36391%,Single Stage Single Point:35.63609%]
[INFO] ** dst:[21:43.33121%,10:21.03046%,8:18.15039%,9:17.48553%,22:0.00086%,15:0.00069%,24:0.00034%,18:0.00034%,25:0.00017%]
[INFO] ** i/f_dir:[1:99.99931%,0:0.00069%]
[INFO] ** i/f_name:[2:99.99931%,3:0.00069%]
[INFO] ** modbus_function_code:[0.02961:99.99863%,-33.760870000000004:0.00137%]
[INFO] ** modbus_function_description:[7:50.00034%,11:49.99828%,0:0.00137%]
[INFO] ** modbus_transaction_id:65536 (11.25913%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9988%,1:0.00069%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.38284%,20:25.97901%,13:18.15057%,6:17.48604%,17:0.00069%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.97849%,-0.32151:21.03029%,-1.27613:18.15005%,-0.23351:17.48535%,-0.33484:17.35255%,-71.33197:0.00069%,-0.24151:0.00052%,-0.08551:0.00034%,-1.27347:0.00034%,1.45709:0.00017%,1.47576:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,-64.19493:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:25.97815%,1:21.03012%,5:18.14988%,4:17.48518%,2:17.35238%,0:0.0043%]
[INFO] ** service:[0.0048200000000000005:99.9988%,-211.73542999999998:0.00069%,-186.43601999999998:0.00034%,-186.44547:0.00017%]
[INFO] ** src:[22:38.38284%,9:25.97901%,7:18.15057%,1:17.48604%,14:0.00069%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1581 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.1492e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.6154e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.1524e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.5982e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5437e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7998e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4979e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1224e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5066e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.2509e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/582070
[33m[INFO] loading file 37-37/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582070, 17)

[INFO] analyzing data
[INFO] 582070 rows
[INFO] ** appi_name:[21:99.9988%,30:0.00069%,33:0.00017%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:64.37937%,Single Stage Single Point:35.62063%]
[INFO] ** dst:[21:43.33963%,10:21.03785%,8:18.13596%,9:17.48467%,22:0.00069%,15:0.00069%,24:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99966%,0:0.00034%]
[INFO] ** i/f_name:[2:99.99931%,3:0.00069%]
[INFO] ** modbus_function_code:[0.02961:99.9988%,-33.760870000000004:0.0012%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.99863%,0:0.0012%]
[INFO] ** modbus_transaction_id:65536 (11.25913%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99914%,1:0.00069%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.38559%,20:25.99206%,13:18.13596%,6:17.48484%,17:0.00069%,21:0.00034%,16:0.00034%,1:0.00017%]
[INFO] ** s_port:[1.45442:25.99155%,-0.32151:21.03768%,-1.27613:18.13562%,-0.23351:17.48449%,-0.33484:17.34791%,-71.33197:0.00069%,-1.02014:0.00034%,1.46509:0.00017%,1.47576:0.00017%,-1.27347:0.00017%,-49.275529999999996:0.00017%,-0.24950999999999998:0.00017%,-0.24151:0.00017%,-1.2708:0.00017%,1.45709:0.00017%,14.4699:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:25.99138%,1:21.03768%,5:18.13545%,4:17.48432%,2:17.34774%,0:0.00344%]
[INFO] ** service:[0.0048200000000000005:99.99897%,-211.73542999999998:0.00069%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.38559%,9:25.99206%,7:18.13596%,1:17.48484%,14:0.00069%,15:0.00034%,4:0.00034%,3:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1581 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.5706e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3089e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4473e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7066e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0944e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.2695e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.8131e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.8748e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.2721e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.7279e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/582070
[33m[INFO] loading file 38-38/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582070, 17)

[INFO] analyzing data
[INFO] 582070 rows
[INFO] ** appi_name:[21:99.99897%,30:0.00034%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.4072%,Single Stage Single Point:35.5928%]
[INFO] ** dst:[21:43.32211%,10:21.08303%,8:18.09851%,9:17.49446%,22:0.00086%,15:0.00034%,25:0.00017%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99983%,0:0.00017%]
[INFO] ** i/f_name:[2:99.99966%,3:0.00034%]
[INFO] ** modbus_function_code:[0.02961:99.99897%,-33.760870000000004:0.00103%]
[INFO] ** modbus_function_description:[11:49.99948%,7:49.99948%,0:0.00103%]
[INFO] ** modbus_transaction_id:65536 (11.25913%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99931%,2:0.00034%,1:0.00034%]
[INFO] ** proxy_src_ip:[18:38.44469%,20:25.96097%,13:18.09834%,6:17.4948%,17:0.00034%,7:0.00034%,16:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.96028%,-0.32151:21.08286%,-1.27613:18.09817%,-0.23351:17.49429%,-0.33484:17.36183%,-0.24151:0.00034%,-71.33197:0.00034%,1.45709:0.00034%,1.47576:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-61.95768:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:25.95994%,1:21.08286%,5:18.09817%,4:17.49412%,2:17.36183%,0:0.00309%]
[INFO] ** service:[0.0048200000000000005:99.99914%,-211.73542999999998:0.00034%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.44469%,9:25.96097%,7:18.09834%,1:17.4948%,21:0.00034%,14:0.00034%,16:0.00017%,15:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1582 (0.27179%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.3788e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9971e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.7517e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4244e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5032e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.4129e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.0975e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2656e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0723e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7880e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/582070
[33m[INFO] loading file 39-39/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582070, 17)

[INFO] analyzing data
[INFO] 582070 rows
[INFO] ** appi_name:[21:99.99966%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.39672%,Single Stage Single Point:35.60328%]
[INFO] ** dst:[21:43.31558%,10:21.07994%,8:18.13871%,9:17.46439%,22:0.00086%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99966%,-33.760870000000004:0.00034%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99966%,0:0.00034%]
[INFO] ** modbus_transaction_id:65536 (11.25913%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.44125%,20:25.95461%,13:18.13888%,6:17.46439%,16:0.00052%,7:0.00034%]
[INFO] ** s_port:[1.45442:25.95409%,-0.32151:21.07994%,-1.27613:18.13854%,-0.23351:17.46422%,-0.33484:17.36131%,-1.02014:0.00052%,-71.14798:0.00017%,-1.27347:0.00017%,1.45709:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-0.24151:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.95375%,1:21.07977%,5:18.13837%,4:17.46422%,2:17.36114%,0:0.00275%]
[INFO] ** service:[0.0048200000000000005:99.99966%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.44125%,9:25.95461%,7:18.13888%,1:17.46439%,15:0.00052%,21:0.00034%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1580 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.2989e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.9935e-04 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.7206e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2257e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.4899e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9132e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.5874e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9556e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0833e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8881e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/582070
[33m[INFO] loading file 40-40/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582070, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582070, 17)

[INFO] analyzing data
[INFO] 582070 rows
[INFO] ** appi_name:[21:99.99656%,30:0.00292%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.33539%,Single Stage Single Point:35.66461%]
[INFO] ** dst:[21:43.29101%,10:21.03974%,8:18.19661%,9:17.46817%,15:0.00292%,22:0.00086%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99725%,0:0.00275%]
[INFO] ** i/f_name:[2:99.99708%,3:0.00292%]
[INFO] ** modbus_function_code:[0.02961:99.99656%,-33.760870000000004:0.00344%]
[INFO] ** modbus_function_description:[7:49.99931%,11:49.99725%,0:0.00344%]
[INFO] ** modbus_transaction_id:65536 (11.25913%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.99656%,1:0.00292%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.35707%,20:25.97454%,13:18.19644%,6:17.46852%,17:0.00292%,14:0.00052%]
[INFO] ** s_port:[1.45442:25.97368%,-0.32151:21.03974%,-1.27613:18.19627%,-0.23351:17.468%,-0.33484:17.31733%,-71.33197:0.00292%,1.45709:0.00052%,-0.24151:0.00034%,-71.14798:0.00017%,-1.27347:0.00017%,11.862:0.00017%,-0.24950999999999998:0.00017%,1.46509:0.00017%,1.47576:0.00017%,13.431270000000001:0.00017%]
[INFO] ** scada_tag:[3:25.97334%,1:21.03957%,5:18.19609%,4:17.46766%,2:17.31716%,0:0.00618%]
[INFO] ** service:[0.0048200000000000005:99.99656%,-211.73542999999998:0.00292%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.35707%,9:25.97454%,7:18.19644%,1:17.46852%,14:0.00292%,2:0.00052%]
[INFO] ** type:[0:99.99914%,1:0.00086%]
[INFO] ** unixtime:1583 (0.27196%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6974e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.2883e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.2721e-04 - tp: 79997.0000 - fp: 3.0000 - tn: 319997.0000 - fn: 3.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6882e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.5166e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9818e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.1930e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8136e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/582070
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.6073e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.0772e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/582070
[33m[INFO] loading file 41-41/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (522228, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (522228, 17)

[INFO] analyzing data
[INFO] 522228 rows
[INFO] ** appi_name:[21:99.99674%,30:0.00096%,22:0.00077%,17:0.00077%,32:0.00019%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.38778%,Single Stage Single Point:35.61222%]
[INFO] ** dst:[21:43.32724%,10:21.05651%,8:18.14284%,9:17.46919%,16:0.00096%,15:0.00096%,6:0.00096%,22:0.00057%,24:0.00038%,17:0.00038%]
[INFO] ** i/f_dir:[1:99.99904%,0:0.00096%]
[INFO] ** i/f_name:[2:99.99904%,3:0.00096%]
[INFO] ** modbus_function_code:[0.02961:99.99674%,-33.760870000000004:0.00326%]
[INFO] ** modbus_function_description:[7:49.99923%,11:49.99751%,0:0.00326%]
[INFO] ** modbus_transaction_id:65536 (12.54931%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99789%,2:0.00115%,1:0.00096%]
[INFO] ** proxy_src_ip:[18:38.42843%,20:25.95552%,13:18.14303%,6:17.46938%,17:0.00096%,1:0.00077%,21:0.00038%,16:0.00038%,14:0.00038%,0:0.00038%,7:0.00019%,2:0.00019%]
[INFO] ** s_port:[1.45442:25.95514%,-0.32151:21.05651%,-1.27613:18.14246%,-0.23351:17.469%,-0.33484:17.37191%,-71.33197:0.00096%,-71.14931:0.00077%,-1.02014:0.00038%,-1.27347:0.00038%,-71.14798:0.00019%,-0.24151:0.00019%,-58.035180000000004:0.00019%,-1.2708:0.00019%,-5.1466400000000005:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-64.19226:0.00019%,-5.08665:0.00019%,-0.24950999999999998:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:25.95495%,1:21.05651%,5:18.14246%,4:17.46881%,2:17.37172%,0:0.00555%]
[INFO] ** service:[0.0048200000000000005:99.99674%,-211.73542999999998:0.00096%,-205.44247:0.00077%,-211.08818:0.00077%,89.64175:0.00019%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.42843%,9:25.95552%,7:18.14303%,1:17.46938%,14:0.00096%,3:0.00077%,15:0.00038%,8:0.00038%,4:0.00038%,2:0.00038%,21:0.00019%,17:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1417 (0.27134%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/522228
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.6572e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1248e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/522228
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 8.5809e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6511e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/522228
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7725e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2620e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/522228
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 6.0657e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3700e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/522228
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.1407e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4585e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-40-41-batch-400000-500000
[INFO] processing batch 500000-600000/522228
[33m[INFO] loading file 42-42/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (365742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (365742, 17)

[INFO] analyzing data
[INFO] 365742 rows
[INFO] ** appi_name:[21:99.9907%,30:0.00246%,17:0.00137%,31:0.00109%,26:0.00109%,7:0.00109%,22:0.00082%,28:0.00027%,27:0.00027%,9:0.00027%,8:0.00027%,0:0.00027%]
[INFO] ** classification:[normal:64.34809%,Single Stage Single Point:35.65191%]
[INFO] ** dst:[21:43.30102%,10:21.03723%,8:18.19643%,9:17.4552%,16:0.00246%,6:0.00219%,18:0.00137%,2:0.00109%,22:0.00082%,15:0.00082%,17:0.00055%,25:0.00027%,7:0.00027%,0:0.00027%]
[INFO] ** i/f_dir:[1:99.99918%,0:0.00082%]
[INFO] ** i/f_name:[2:99.99918%,3:0.00082%]
[INFO] ** modbus_function_code:[0.02961:99.9907%,-33.760870000000004:0.0093%]
[INFO] ** modbus_function_description:[7:49.9959%,11:49.99481%,0:0.0093%]
[INFO] ** modbus_transaction_id:65536 (17.91864%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99508%,2:0.0041%,1:0.00082%]
[INFO] ** proxy_src_ip:[18:38.38881%,20:25.94971%,13:18.19671%,6:17.4552%,17:0.00246%,1:0.00246%,14:0.00164%,21:0.00109%,7:0.00082%,0:0.00055%,16:0.00027%,2:0.00027%]
[INFO] ** s_port:[1.45442:25.94917%,-0.32151:21.03723%,-1.27613:18.19643%,-0.23351:17.45493%,-0.33484:17.35158%,-71.14931:0.00109%,-71.14798:0.00109%,-71.33197:0.00082%,-3.3787199999999995:0.00055%,-0.08551:0.00055%,11.57001:0.00055%,13.431270000000001:0.00027%,-5.1466400000000005:0.00027%,0.31847:0.00027%,-1.02014:0.00027%,-64.19493:0.00027%,-1.2708:0.00027%,-58.035180000000004:0.00027%,7.66617:0.00027%,-0.24151:0.00027%,1.47576:0.00027%,14.4699:0.00027%,15.912510000000001:0.00027%,14.191239999999999:0.00027%,7.9608300000000005:0.00027%,-5.08665:0.00027%,10.192739999999999:0.00027%,-3.0613900000000003:0.00027%,1.45709:0.00027%,2.05573:0.00027%,-43.76509:0.00027%,11.862:0.00027%,-58.032509999999995:0.00027%]
[INFO] ** scada_tag:[3:25.94889%,1:21.03723%,5:18.19616%,4:17.45493%,2:17.3513%,0:0.01148%]
[INFO] ** service:[0.0048200000000000005:99.9907%,-211.09762999999998:0.00191%,-205.44247:0.00137%,-186.43601999999998:0.00137%,-211.08346:0.00109%,-211.08818:0.00109%,-211.73542999999998:0.00082%,-211.35747999999998:0.00055%,-186.44547:0.00027%,-183.8612:0.00027%,-185.9872:0.00027%,-202.75898:0.00027%]
[INFO] ** src:[22:38.38881%,9:25.94971%,7:18.19671%,1:17.4552%,3:0.00328%,2:0.00191%,4:0.00137%,21:0.00109%,14:0.00082%,8:0.00055%,17:0.00027%,15:0.00027%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:993 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/365742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.2155e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7382e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/365742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0743e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7290e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/365742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5511e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4836e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/365742
[33m[INFO] loading file 43-43/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99894%,30:0.00053%,26:0.00018%,8:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.39844%,Single Stage Single Point:35.60156%]
[INFO] ** dst:[21:43.32646%,10:21.06985%,8:18.13123%,9:17.47015%,22:0.00106%,15:0.00053%,2:0.00035%,24:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99982%,0:0.00018%]
[INFO] ** i/f_name:[2:99.99947%,3:0.00053%]
[INFO] ** modbus_function_code:[0.02961:99.99894%,-33.760870000000004:0.00106%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99894%,0:0.00106%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99929%,1:0.00053%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.41804%,20:25.9788%,13:18.13141%,6:17.47033%,17:0.00053%,1:0.00053%,16:0.00035%]
[INFO] ** s_port:[1.45442:25.9781%,-0.32151:21.06985%,-1.27613:18.13106%,-0.23351:17.4698%,-0.33484:17.34819%,-71.33197:0.00053%,1.45709:0.00035%,1.47576:0.00035%,-0.24151:0.00035%,-1.02014:0.00035%,0.31847:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-1.2708:0.00018%,-3.3787199999999995:0.00018%]
[INFO] ** scada_tag:[3:25.97774%,1:21.06985%,5:18.13088%,4:17.46945%,2:17.34801%,0:0.00407%]
[INFO] ** service:[0.0048200000000000005:99.99894%,-211.73542999999998:0.00053%,-211.09762999999998:0.00018%,-211.08346:0.00018%,-211.35747999999998:0.00018%]
[INFO] ** src:[22:38.41804%,9:25.9788%,7:18.13141%,1:17.47033%,14:0.00053%,3:0.00053%,15:0.00035%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1538 (0.27186%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.4941e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6825e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.0285e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0724e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.1503e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6732e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.1921e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3514e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 1.4345e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8663e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 44-44/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99823%,30:0.00071%,31:0.00053%,0:0.00035%,22:0.00018%]
[INFO] ** classification:[normal:64.3926%,Single Stage Single Point:35.6074%]
[INFO] ** dst:[21:43.33619%,10:21.05341%,8:18.15121%,9:17.45601%,22:0.00106%,15:0.00071%,18:0.00053%,25:0.00035%,24:0.00035%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99929%,0:0.00071%]
[INFO] ** i/f_name:[2:99.99929%,3:0.00071%]
[INFO] ** modbus_function_code:[0.02961:99.99823%,-33.760870000000004:0.00177%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99806%,0:0.00177%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99823%,2:0.00106%,1:0.00071%]
[INFO] ** proxy_src_ip:[18:38.43554%,20:25.95459%,13:18.15138%,6:17.45654%,17:0.00071%,7:0.00035%,16:0.00018%,5:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95388%,-0.32151:21.05341%,-1.27613:18.15085%,-0.23351:17.45584%,-0.33484:17.38213%,-71.33197:0.00071%,-0.24151:0.00053%,-0.08551:0.00035%,-64.19493:0.00035%,-1.27347:0.00035%,1.45709:0.00035%,-1.02014:0.00018%,-1.2708:0.00018%,1.47576:0.00018%,-71.14931:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,4.42897:0.00018%]
[INFO] ** scada_tag:[3:25.95335%,1:21.05341%,5:18.15085%,4:17.45548%,2:17.38195%,0:0.00495%]
[INFO] ** service:[0.0048200000000000005:99.99823%,-211.73542999999998:0.00071%,-186.43601999999998:0.00053%,-186.44547:0.00035%,-211.08818:0.00018%]
[INFO] ** src:[22:38.43554%,9:25.95459%,7:18.15138%,1:17.45654%,14:0.00071%,21:0.00035%,17:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1535 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 3.5652e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4565e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 3.3689e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5311e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.3041e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0940e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.1163e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7737e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4314e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6638e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 45-45/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99876%,30:0.00053%,31:0.00035%,26:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:64.41912%,Single Stage Single Point:35.58088%]
[INFO] ** dst:[21:43.32646%,10:21.08983%,8:18.12505%,9:17.45601%,22:0.00141%,15:0.00053%,18:0.00035%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99965%,0:0.00035%]
[INFO] ** i/f_name:[2:99.99947%,3:0.00053%]
[INFO] ** modbus_function_code:[0.02961:99.99876%,-33.760870000000004:0.00124%]
[INFO] ** modbus_function_description:[7:50.00035%,11:49.99841%,0:0.00124%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99894%,2:0.00053%,1:0.00053%]
[INFO] ** proxy_src_ip:[18:38.48645%,20:25.93055%,13:18.12487%,6:17.45654%,17:0.00053%,16:0.00035%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.92984%,-0.32151:21.08983%,-1.27613:18.12487%,-0.23351:17.45584%,-0.33484:17.39662%,1.45709:0.00053%,-0.24151:0.00053%,-71.33197:0.00053%,-1.02014:0.00035%,-0.08551:0.00035%,-71.14798:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.92931%,1:21.08965%,5:18.12487%,4:17.45584%,2:17.39645%,0:0.00389%]
[INFO] ** service:[0.0048200000000000005:99.99876%,-211.73542999999998:0.00053%,-186.43601999999998:0.00035%,-183.8612:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.48645%,9:25.93055%,7:18.12487%,1:17.45654%,14:0.00053%,15:0.00035%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1535 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.8764e-04 - tp: 79996.0000 - fp: 4.0000 - tn: 319996.0000 - fn: 4.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 3.8777e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.0623e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.1224e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4602e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.1947e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.4630e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9311e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6060e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3281e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 46-46/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99823%,30:0.00106%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.42336%,Single Stage Single Point:35.57664%]
[INFO] ** dst:[21:43.34538%,10:21.07533%,8:18.10348%,9:17.47316%,22:0.00106%,15:0.00106%,25:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99912%,0:0.00088%]
[INFO] ** i/f_name:[2:99.99894%,3:0.00106%]
[INFO] ** modbus_function_code:[0.02961:99.99823%,-33.760870000000004:0.00177%]
[INFO] ** modbus_function_description:[11:49.99929%,7:49.99894%,0:0.00177%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:99.99965%,1:0.00035%]
[INFO] ** proto:[0:99.99859%,1:0.00106%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.44668%,20:25.97403%,13:18.10348%,6:17.47369%,17:0.00106%,16:0.00035%,7:0.00035%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.97368%,-0.32151:21.07515%,-1.27613:18.10331%,-0.23351:17.47298%,-0.33484:17.37152%,-71.33197:0.00106%,-0.24151:0.00053%,-1.02014:0.00035%,-71.14798:0.00018%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:25.97332%,1:21.07498%,5:18.10313%,4:17.47263%,2:17.37152%,0:0.00442%]
[INFO] ** service:[0.0048200000000000005:99.99841%,-211.73542999999998:0.00106%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.44668%,9:25.97403%,7:18.10348%,1:17.47369%,14:0.00106%,21:0.00035%,15:0.00035%,16:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99912%,1:0.00088%]
[INFO] ** unixtime:1538 (0.27186%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.2123e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9337e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7384e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3820e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.2610e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3254e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.5483e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3712e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2100e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3325e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 47-47/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99947%,33:0.00018%,26:0.00018%,17:0.00018%]
[INFO] ** classification:[normal:64.39649%,Single Stage Single Point:35.60351%]
[INFO] ** dst:[21:43.31179%,10:21.08276%,8:18.12876%,9:17.4744%,22:0.00159%,24:0.00035%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99947%,-33.760870000000004:0.00053%]
[INFO] ** modbus_function_description:[7:50.00106%,11:49.99841%,0:0.00053%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.45392%,20:25.94133%,13:18.12911%,6:17.47475%,16:0.00035%,7:0.00035%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.94045%,-0.32151:21.08276%,-1.27613:18.12858%,-0.23351:17.47422%,-0.33484:17.37117%,1.45709:0.00053%,-0.24151:0.00053%,-1.27347:0.00035%,-1.02014:0.00035%,-71.14798:0.00018%,-61.95635:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%]
[INFO] ** scada_tag:[3:25.93992%,1:21.08258%,5:18.1284%,4:17.47404%,2:17.37099%,0:0.00407%]
[INFO] ** service:[0.0048200000000000005:99.99965%,-211.08346:0.00018%,-205.44247:0.00018%]
[INFO] ** src:[22:38.45392%,9:25.94133%,7:18.12911%,1:17.47475%,21:0.00035%,15:0.00035%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1536 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.2627e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.0520e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.1381e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4589e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.3278e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9789e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.5861e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6863e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.9044e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3554e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 48-48/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99682%,30:0.00247%,33:0.00018%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.43114%,Single Stage Single Point:35.56886%]
[INFO] ** dst:[21:43.3353%,10:21.09195%,8:18.09995%,9:17.46874%,15:0.00247%,22:0.00088%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99788%,0:0.00212%]
[INFO] ** i/f_name:[2:99.99753%,3:0.00247%]
[INFO] ** modbus_function_code:[0.02961:99.99682%,-33.760870000000004:0.00318%]
[INFO] ** modbus_function_description:[7:49.99912%,11:49.9977%,0:0.00318%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.997%,1:0.00247%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.46736%,20:25.96024%,13:18.10012%,6:17.46874%,17:0.00247%,14:0.00053%,16:0.00035%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95971%,-0.32151:21.09195%,-1.27613:18.09977%,-0.23351:17.46856%,-0.33484:17.37541%,-71.33197:0.00247%,-1.02014:0.00035%,-1.2708:0.00018%,13.431270000000001:0.00018%,-0.24151:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-61.95635:0.00018%,1.45709:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:25.95936%,1:21.09177%,5:18.09977%,4:17.46856%,2:17.37523%,0:0.0053%]
[INFO] ** service:[0.0048200000000000005:99.997%,-211.73542999999998:0.00247%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.46736%,9:25.96024%,7:18.10012%,1:17.46874%,14:0.00247%,2:0.00053%,15:0.00035%,8:0.00018%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1535 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3441e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9702e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8685e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7506e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6474e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0503e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4658e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5119e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3036e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1907e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 49-49/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (565742, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (565742, 17)

[INFO] analyzing data
[INFO] 565742 rows
[INFO] ** appi_name:[21:99.99735%,30:0.00088%,17:0.00071%,26:0.00035%,22:0.00035%,28:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.37493%,Single Stage Single Point:35.62507%]
[INFO] ** dst:[21:43.31338%,10:21.0573%,8:18.13441%,9:17.49048%,22:0.00141%,15:0.00088%,16:0.00071%,6:0.00071%,24:0.00035%,17:0.00035%]
[INFO] ** i/f_dir:[1:99.99912%,0:0.00088%]
[INFO] ** i/f_name:[2:99.99912%,3:0.00088%]
[INFO] ** modbus_function_code:[0.02961:99.99735%,-33.760870000000004:0.00265%]
[INFO] ** modbus_function_description:[7:49.99965%,11:49.9977%,0:0.00265%]
[INFO] ** modbus_transaction_id:65536 (11.58408%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99841%,1:0.00088%,2:0.00071%]
[INFO] ** proxy_src_ip:[18:38.42246%,20:25.94893%,13:18.13459%,6:17.49101%,17:0.00088%,1:0.00071%,14:0.00053%,21:0.00035%,16:0.00035%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.94805%,-0.32151:21.0573%,-1.27613:18.13406%,-0.23351:17.4903%,-0.33484:17.36516%,-71.33197:0.00088%,1.45709:0.00053%,-0.24151:0.00053%,-1.27347:0.00035%,-71.14931:0.00035%,-1.02014:0.00035%,-71.14798:0.00035%,1.47576:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,1.46509:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,-5.08665:0.00018%,-0.24950999999999998:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:25.94769%,1:21.05712%,5:18.13388%,4:17.48995%,2:17.36516%,0:0.00619%]
[INFO] ** service:[0.0048200000000000005:99.99735%,-211.73542999999998:0.00088%,-205.44247:0.00071%,-211.08346:0.00035%,-211.08818:0.00035%,-211.09762999999998:0.00018%,-185.9872:0.00018%]
[INFO] ** src:[22:38.42246%,9:25.94893%,7:18.13459%,1:17.49101%,14:0.00088%,3:0.00071%,2:0.00053%,15:0.00035%,4:0.00035%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1536 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.5340e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3852e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.8896e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8565e-04 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4005e-04 - tp: 79997.0000 - fp: 3.0000 - tn: 319997.0000 - fn: 3.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9154e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7680e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8411e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/565742
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0700e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5560e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/565742
[33m[INFO] loading file 50-50/50 on epoch 2/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (415724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (415724, 17)

[INFO] analyzing data
[INFO] 415724 rows
[INFO] ** appi_name:[21:99.99759%,30:0.00096%,7:0.00072%,31:0.00024%,22:0.00024%,8:0.00024%]
[INFO] ** classification:[normal:64.30733%,Single Stage Single Point:35.69267%]
[INFO] ** dst:[21:43.26139%,10:21.04281%,8:18.21834%,9:17.47409%,15:0.00096%,22:0.00072%,16:0.00048%,2:0.00048%,24:0.00024%,18:0.00024%,6:0.00024%]
[INFO] ** i/f_dir:[1:99.99904%,0:0.00096%]
[INFO] ** i/f_name:[2:99.99904%,3:0.00096%]
[INFO] ** modbus_function_code:[0.02961:99.99759%,-33.760870000000004:0.00241%]
[INFO] ** modbus_function_description:[11:49.9988%,7:49.9988%,0:0.00241%]
[INFO] ** modbus_transaction_id:65536 (15.76431%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99856%,1:0.00096%,2:0.00048%]
[INFO] ** proxy_src_ip:[18:38.3656%,20:25.93884%,13:18.21858%,6:17.47409%,17:0.00096%,1:0.00072%,16:0.00048%,21:0.00024%,14:0.00024%,7:0.00024%]
[INFO] ** s_port:[1.45442:25.93836%,-0.32151:21.04281%,-1.27613:18.2181%,-0.23351:17.47409%,-0.33484:17.32279%,-71.33197:0.00096%,-1.02014:0.00048%,-3.3787199999999995:0.00024%,4.33564:0.00024%,15.912510000000001:0.00024%,7.9608300000000005:0.00024%,1.46509:0.00024%,1.45709:0.00024%,-1.27347:0.00024%,-71.14931:0.00024%,-1.2708:0.00024%,0.31847:0.00024%]
[INFO] ** scada_tag:[3:25.93812%,1:21.04257%,5:18.21786%,4:17.47409%,2:17.32255%,0:0.00481%]
[INFO] ** service:[0.0048200000000000005:99.99759%,-211.73542999999998:0.00096%,-211.09762999999998:0.00072%,-186.43601999999998:0.00024%,-211.35747999999998:0.00024%,-211.08818:0.00024%]
[INFO] ** src:[22:38.3656%,9:25.93884%,7:18.21858%,1:17.47409%,14:0.00096%,3:0.00072%,15:0.00048%,21:0.00024%,4:0.00024%,2:0.00024%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1130 (0.27181%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/415724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6414e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9125e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/415724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6636e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4665e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/415724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5299e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.3680e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/415724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.8179e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.2671e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-2-files-49-50-batch-300000-400000
[INFO] processing batch 400000-500000/415724
[33m[INFO] epoch 3/10[0m
[33m[INFO] loading file 1-1/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99302%,30:0.00116%,22:0.00097%,17:0.00078%,31:0.00058%,26:0.00058%,7:0.00058%,23:0.00039%,18:0.00039%,0:0.00039%,28:0.00019%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:78.84217%,Single Stage Single Point:21.15783%]
[INFO] ** dst:[21:43.26578%,10:21.04381%,8:18.16766%,9:17.51538%,6:0.00155%,16:0.00116%,15:0.00116%,22:0.00097%,18:0.00058%,26:0.00039%,25:0.00039%,19:0.00039%,17:0.00039%,24:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99884%,0:0.00116%]
[INFO] ** i/f_name:[2:99.99884%,3:0.00116%]
[INFO] ** modbus_function_code:[0.02961:99.99302%,-33.760870000000004:0.00679%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99748%,11:49.99554%,0:0.00679%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99612%,2:0.00271%,1:0.00116%]
[INFO] ** proxy_src_ip:[18:38.40523%,20:25.90378%,13:18.16786%,6:17.51576%,11:0.00136%,10:0.00136%,17:0.00116%,14:0.00097%,1:0.00097%,7:0.00058%,21:0.00039%,16:0.00039%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.90339%,-0.32151:21.04304%,-1.27613:18.16747%,-0.23351:17.51518%,-0.33484:17.36219%,-71.33197:0.00116%,-71.14931:0.00097%,-2.1481:0.00078%,-0.24151:0.00058%,-71.14798:0.00058%,-2.42942:0.00039%,4.44364:0.00039%,-1.02014:0.00039%,-64.19493:0.00039%,-5.1466400000000005:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,4.076980000000001:0.00019%,-5.08665:0.00019%,1.47576:0.00019%,1.46509:0.00019%,4.29964:0.00019%,14.253910000000001:0.00019%,-68.79874000000001:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,10.67005:0.00019%,-1.27347:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:25.9032%,1:21.04284%,5:18.16708%,4:17.51499%,2:17.362%,0:0.00989%]
[INFO] ** service:[0.0048200000000000005:99.9938%,-211.73542999999998:0.00116%,-211.08818:0.00097%,-205.44247:0.00078%,-211.07873999999998:0.00078%,-211.09762999999998:0.00058%,-211.08346:0.00058%,-186.43601999999998:0.00058%,-186.44547:0.00039%,-185.9872:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.40523%,9:25.90378%,7:18.16786%,1:17.51576%,11:0.00136%,10:0.00136%,14:0.00116%,3:0.00097%,2:0.00097%,21:0.00058%,15:0.00039%,4:0.00039%,8:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1400 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1635 - tp: 78343.0000 - fp: 1657.0000 - tn: 318343.0000 - fn: 1657.0000 - accuracy: 0.9917 - precision: 0.9793 - recall: 0.9793 - auc: 0.9908 - val_loss: 1.8905e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.9537e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4698e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1543e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5171 - val_tp: 17757.0000 - val_fp: 2243.0000 - val_tn: 77757.0000 - val_fn: 2243.0000 - val_accuracy: 0.9551 - val_precision: 0.8878 - val_recall: 0.8878 - val_auc: 0.9299
[INFO] saving weights to checkpoints/lstm-epoch-3-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3110 - tp: 74316.0000 - fp: 5684.0000 - tn: 314316.0000 - fn: 5684.0000 - accuracy: 0.9716 - precision: 0.9290 - recall: 0.9290 - auc: 0.9853 - val_loss: 0.0044 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0030 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0021 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 2-2/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99864%,7:0.00058%,30:0.00039%,31:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:72.18764%,Single Stage Single Point:27.81236%]
[INFO] ** dst:[21:43.31348%,10:21.03199%,8:18.13606%,9:17.51615%,22:0.00078%,16:0.00039%,15:0.00039%,2:0.00039%,24:0.00019%,18:0.00019%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99961%,3:0.00039%]
[INFO] ** modbus_function_code:[0.02961:99.99864%,-33.760870000000004:0.00136%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99884%,0:0.00136%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99942%,1:0.00039%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.38545%,20:25.96059%,13:18.13606%,6:17.51635%,1:0.00058%,17:0.00039%,16:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.95982%,-0.32151:21.03199%,-1.27613:18.13567%,-0.23351:17.51596%,-0.33484:17.35347%,-71.33197:0.00039%,1.45709:0.00039%,12.60597:0.00019%,-1.2708:0.00019%,-1.02014:0.00019%,-0.24151:0.00019%,4.076980000000001:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-1.27347:0.00019%,-3.3787199999999995:0.00019%,-0.24950999999999998:0.00019%,10.67005:0.00019%,4.29964:0.00019%]
[INFO] ** scada_tag:[3:25.95943%,1:21.03199%,5:18.13567%,4:17.51576%,2:17.35327%,0:0.00388%]
[INFO] ** service:[0.0048200000000000005:99.99864%,-211.09762999999998:0.00058%,-211.73542999999998:0.00039%,-186.43601999999998:0.00019%,-211.35747999999998:0.00019%]
[INFO] ** src:[22:38.38545%,9:25.96059%,7:18.13606%,1:17.51635%,3:0.00058%,14:0.00039%,21:0.00019%,15:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1403 (0.27204%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0142 - tp: 79747.0000 - fp: 253.0000 - tn: 319747.0000 - fn: 253.0000 - accuracy: 0.9987 - precision: 0.9968 - recall: 0.9968 - auc: 0.9997 - val_loss: 0.0010 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3714 - tp: 61500.0000 - fp: 18469.0000 - tn: 301531.0000 - fn: 18500.0000 - accuracy: 0.9076 - precision: 0.7690 - recall: 0.7688 - auc: 0.9711 - val_loss: 0.3327 - val_tp: 15084.0000 - val_fp: 4916.0000 - val_tn: 75084.0000 - val_fn: 4916.0000 - val_accuracy: 0.9017 - val_precision: 0.7542 - val_recall: 0.7542 - val_auc: 0.9702
[INFO] saving weights to checkpoints/lstm-epoch-3-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0243 - tp: 79640.0000 - fp: 360.0000 - tn: 319640.0000 - fn: 360.0000 - accuracy: 0.9982 - precision: 0.9955 - recall: 0.9955 - auc: 0.9991 - val_loss: 2.5903 - val_tp: 10613.0000 - val_fp: 9387.0000 - val_tn: 70613.0000 - val_fn: 9387.0000 - val_accuracy: 0.8123 - val_precision: 0.5307 - val_recall: 0.5307 - val_auc: 0.7953
[INFO] saving weights to checkpoints/lstm-epoch-3-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1002 - tp: 77724.0000 - fp: 2270.0000 - tn: 317730.0000 - fn: 2276.0000 - accuracy: 0.9886 - precision: 0.9716 - recall: 0.9715 - auc: 0.9968 - val_loss: 0.0021 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3670 - tp: 61726.0000 - fp: 18268.0000 - tn: 301732.0000 - fn: 18274.0000 - accuracy: 0.9086 - precision: 0.7716 - recall: 0.7716 - auc: 0.9708 - val_loss: 0.3617 - val_tp: 12318.0000 - val_fp: 7682.0000 - val_tn: 72318.0000 - val_fn: 7682.0000 - val_accuracy: 0.8464 - val_precision: 0.6159 - val_recall: 0.6159 - val_auc: 0.9510
[INFO] saving weights to checkpoints/lstm-epoch-3-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 3-3/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99108%,30:0.00233%,22:0.00116%,31:0.00097%,26:0.00097%,17:0.00097%,7:0.00078%,27:0.00039%,0:0.00039%,28:0.00019%,23:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:87.11675%,Single Stage Single Point:12.88325%]
[INFO] ** dst:[21:43.30611%,10:21.08861%,8:18.1539%,9:17.4415%,6:0.00233%,15:0.00155%,18:0.00136%,16:0.00136%,22:0.00097%,2:0.00039%,7:0.00039%,25:0.00039%,17:0.00039%,12:0.00019%,24:0.00019%,19:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99845%,0:0.00155%]
[INFO] ** i/f_name:[2:99.99845%,3:0.00155%]
[INFO] ** modbus_function_code:[0.02961:99.99108%,-33.760870000000004:0.00873%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99632%,11:49.99476%,0:0.00873%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99884%,2:0.00116%]
[INFO] ** proto:[0:99.9938%,2:0.00465%,1:0.00155%]
[INFO] ** proxy_src_ip:[18:38.42036%,20:25.97475%,13:18.15409%,6:17.44189%,17:0.00233%,1:0.00155%,14:0.00136%,7:0.00097%,11:0.00078%,10:0.00078%,21:0.00058%,16:0.00019%,15:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.97397%,-0.32151:21.08841%,-1.27613:18.15351%,-0.23351:17.44131%,-0.33484:17.33194%,-71.33197:0.00155%,-71.14798:0.00116%,-71.14931:0.00116%,-64.19493:0.00039%,-0.08551:0.00039%,1.45709:0.00039%,-0.24151:0.00039%,13.431270000000001:0.00019%,14.4699:0.00019%,4.076980000000001:0.00019%,-5.1466400000000005:0.00019%,-1.02014:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,12.60597:0.00019%,-5.08665:0.00019%,1.46509:0.00019%,-2.1481:0.00019%,-1.27347:0.00019%,10.67005:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,6.1115699999999995:0.00019%,4.44364:0.00019%,13.86459:0.00019%,4.29964:0.00019%,-0.24950999999999998:0.00019%,-3.3787199999999995:0.00019%,10.192739999999999:0.00019%,-68.79874000000001:0.00019%,14.253910000000001:0.00019%,4.90362:0.00019%,-68.36943000000001:0.00019%]
[INFO] ** scada_tag:[3:25.97358%,1:21.08822%,5:18.15331%,4:17.44111%,2:17.33175%,0:0.01202%]
[INFO] ** service:[0.0048200000000000005:99.99127%,-211.73542999999998:0.00155%,-186.43601999999998:0.00136%,-211.08346:0.00116%,-211.08818:0.00116%,-205.44247:0.00097%,-211.09762999999998:0.00078%,-186.44547:0.00039%,-202.75898:0.00039%,-183.8612:0.00019%,-185.9872:0.00019%,-201.23771000000002:0.00019%,-211.35747999999998:0.00019%,-211.07873999999998:0.00019%]
[INFO] ** src:[22:38.42036%,9:25.97475%,7:18.15409%,1:17.44189%,21:0.00213%,3:0.00175%,2:0.00136%,11:0.00078%,10:0.00078%,4:0.00078%,14:0.00039%,8:0.00039%,17:0.00019%,15:0.00019%,13:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1400 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1571 - tp: 75928.0000 - fp: 4072.0000 - tn: 315928.0000 - fn: 4072.0000 - accuracy: 0.9796 - precision: 0.9491 - recall: 0.9491 - auc: 0.9957 - val_loss: 0.0467 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2483 - tp: 71960.0000 - fp: 8040.0000 - tn: 311960.0000 - fn: 8040.0000 - accuracy: 0.9598 - precision: 0.8995 - recall: 0.8995 - auc: 0.9882 - val_loss: 0.7634 - val_tp: 10612.0000 - val_fp: 9388.0000 - val_tn: 70612.0000 - val_fn: 9388.0000 - val_accuracy: 0.8122 - val_precision: 0.5306 - val_recall: 0.5306 - val_auc: 0.9449
[INFO] saving weights to checkpoints/lstm-epoch-3-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0161 - tp: 79153.0000 - fp: 847.0000 - tn: 319153.0000 - fn: 847.0000 - accuracy: 0.9958 - precision: 0.9894 - recall: 0.9894 - auc: 1.0000 - val_loss: 4.5002e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.1070e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9939e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.7372e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5572e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 4-4/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99767%,30:0.00136%,31:0.00039%,33:0.00019%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:91.51096%,Single Stage Single Point:8.48904%]
[INFO] ** dst:[21:43.35517%,10:20.94143%,8:18.17174%,9:17.52817%,15:0.00136%,22:0.00116%,18:0.00039%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99884%,0:0.00116%]
[INFO] ** i/f_name:[2:99.99864%,3:0.00136%]
[INFO] ** modbus_function_code:[0.02961:99.99767%,-33.760870000000004:0.00233%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99787%,0:0.00233%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99884%,2:0.00116%]
[INFO] ** proto:[0:99.99806%,1:0.00136%,2:0.00058%]
[INFO] ** proxy_src_ip:[18:38.25884%,20:26.03815%,13:18.17174%,6:17.52856%,17:0.00136%,21:0.00039%,16:0.00039%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.03738%,-0.32151:20.94124%,-1.27613:18.17135%,-0.23351:17.52798%,-0.33484:17.3176%,-71.33197:0.00136%,1.45709:0.00039%,-0.24151:0.00039%,-1.02014:0.00039%,-0.08551:0.00039%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,14.4699:0.00019%,-49.275529999999996:0.00019%,-1.2708:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:26.03718%,1:20.94105%,5:18.17135%,4:17.52759%,2:17.3174%,0:0.00543%]
[INFO] ** service:[0.0048200000000000005:99.99787%,-211.73542999999998:0.00136%,-186.43601999999998:0.00039%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.25884%,9:26.03815%,7:18.17174%,1:17.52856%,21:0.00116%,15:0.00039%,4:0.00039%,17:0.00019%,14:0.00019%,8:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1411 (0.2736%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.7319e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2282e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5608e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9693e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.8334e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6615e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.5355e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.3450 - val_tp: 8906.0000 - val_fp: 11094.0000 - val_tn: 68906.0000 - val_fn: 11094.0000 - val_accuracy: 0.7781 - val_precision: 0.4453 - val_recall: 0.4453 - val_auc: 0.6533
[INFO] saving weights to checkpoints/lstm-epoch-3-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.6580 - tp: 59560.0000 - fp: 20440.0000 - tn: 299560.0000 - fn: 20440.0000 - accuracy: 0.8978 - precision: 0.7445 - recall: 0.7445 - auc: 0.9437 - val_loss: 0.7318 - val_tp: 7802.0000 - val_fp: 12198.0000 - val_tn: 67802.0000 - val_fn: 12198.0000 - val_accuracy: 0.7560 - val_precision: 0.3901 - val_recall: 0.3901 - val_auc: 0.9070
[INFO] saving weights to checkpoints/lstm-epoch-3-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 5-5/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.9967%,30:0.00233%,37:0.00019%,26:0.00019%,12:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:89.07458%,Single Stage Single Point:10.92542%]
[INFO] ** dst:[21:43.36641%,10:20.76285%,8:18.24813%,9:17.61873%,15:0.00233%,22:0.00078%,25:0.00019%,24:0.00019%,6:0.00019%,2:0.00019%]
[INFO] ** i/f_dir:[1:99.99806%,0:0.00194%]
[INFO] ** i/f_name:[2:99.99767%,3:0.00233%]
[INFO] ** modbus_function_code:[0.02961:99.9967%,-33.760870000000004:0.0033%]
[INFO] ** modbus_function_description:[7:49.99884%,11:49.99787%,0:0.0033%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99825%,2:0.00175%]
[INFO] ** proto:[0:99.99729%,1:0.00233%,2:0.00039%]
[INFO] ** proxy_src_ip:[18:37.99416%,20:26.13491%,13:18.24833%,6:17.61911%,17:0.00233%,21:0.00019%,16:0.00019%,7:0.00019%,5:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.13472%,-0.32151:20.76246%,-1.27613:18.24813%,-0.23351:17.61873%,-0.33484:17.2317%,-71.33197:0.00233%,-0.24151:0.00039%,-71.14798:0.00019%,-1.27347:0.00019%,1.45709:0.00019%,2.22906:0.00019%,-49.275529999999996:0.00019%,-61.95768:0.00019%,-1.02014:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:26.13433%,1:20.76227%,5:18.24794%,4:17.61873%,2:17.2317%,0:0.00504%]
[INFO] ** service:[0.0048200000000000005:99.99709%,-211.73542999999998:0.00233%,-186.44547:0.00019%,-211.08346:0.00019%,-211.35747999999998:0.00019%]
[INFO] ** src:[22:37.99416%,9:26.13491%,7:18.24833%,1:17.61911%,21:0.00194%,14:0.00058%,16:0.00019%,15:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1409 (0.27321%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2625 - tp: 67337.0000 - fp: 12663.0000 - tn: 307337.0000 - fn: 12663.0000 - accuracy: 0.9367 - precision: 0.8417 - recall: 0.8417 - auc: 0.9866 - val_loss: 0.2444 - val_tp: 18225.0000 - val_fp: 1775.0000 - val_tn: 78225.0000 - val_fn: 1775.0000 - val_accuracy: 0.9645 - val_precision: 0.9112 - val_recall: 0.9112 - val_auc: 0.9934
[INFO] saving weights to checkpoints/lstm-epoch-3-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0162 - tp: 79933.0000 - fp: 67.0000 - tn: 319933.0000 - fn: 67.0000 - accuracy: 0.9997 - precision: 0.9992 - recall: 0.9992 - auc: 1.0000 - val_loss: 0.0021 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1235 - tp: 77909.0000 - fp: 2091.0000 - tn: 317909.0000 - fn: 2091.0000 - accuracy: 0.9895 - precision: 0.9739 - recall: 0.9739 - auc: 0.9931 - val_loss: 0.0192 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0044 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0016 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0011 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.2400e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 6-6/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99554%,30:0.00349%,31:0.00019%,27:0.00019%,26:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:92.16538%,Single Stage Single Point:7.83462%]
[INFO] ** dst:[21:43.37708%,10:20.7295%,8:18.28517%,9:17.60321%,15:0.00349%,22:0.00039%,25:0.00019%,24:0.00019%,18:0.00019%,12:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.9967%,0:0.0033%]
[INFO] ** i/f_name:[2:99.99651%,3:0.00349%]
[INFO] ** modbus_function_code:[0.02961:99.99554%,-33.760870000000004:0.00446%]
[INFO] ** modbus_function_description:[7:49.99845%,11:49.99709%,0:0.00446%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99961%,1:0.00039%]
[INFO] ** proto:[0:99.99554%,1:0.00349%,2:0.00097%]
[INFO] ** proxy_src_ip:[18:37.94665%,20:26.16012%,13:18.28536%,6:17.60341%,17:0.00349%,14:0.00058%,16:0.00019%,11:0.00019%]
[INFO] ** s_port:[1.45442:26.15973%,-0.32151:20.7295%,-1.27613:18.28478%,-0.23351:17.60302%,-0.33484:17.21715%,-71.33197:0.00349%,-0.24151:0.00019%,-1.2708:0.00019%,-64.19493:0.00019%,-1.02014:0.00019%,13.431270000000001:0.00019%,4.90362:0.00019%,-71.14798:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-1.27347:0.00019%,-68.36943000000001:0.00019%]
[INFO] ** scada_tag:[3:26.15953%,1:20.7293%,5:18.28459%,4:17.60263%,2:17.21696%,0:0.00698%]
[INFO] ** service:[0.0048200000000000005:99.99554%,-211.73542999999998:0.00349%,-186.44547:0.00019%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-201.23771000000002:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:37.94665%,9:26.16012%,7:18.28536%,1:17.60341%,14:0.00349%,2:0.00058%,15:0.00019%,10:0.00019%]
[INFO] ** type:[0:99.99903%,1:0.00097%]
[INFO] ** unixtime:1412 (0.27379%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.6142e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8274e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.1890e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6330e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.1827e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7697e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.4445e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1436e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2145 - tp: 76588.0000 - fp: 3412.0000 - tn: 316588.0000 - fn: 3412.0000 - accuracy: 0.9829 - precision: 0.9574 - recall: 0.9574 - auc: 0.9853 - val_loss: 0.0230 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 7-7/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99535%,30:0.00136%,22:0.00097%,17:0.00078%,26:0.00058%,31:0.00039%,28:0.00019%,27:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:82.14064%,Single Stage Single Point:17.85936%]
[INFO] ** dst:[21:43.36157%,10:20.74695%,8:18.24794%,9:17.63715%,6:0.00155%,22:0.00136%,15:0.00136%,16:0.00078%,24:0.00039%,18:0.00039%,17:0.00039%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99864%,0:0.00136%]
[INFO] ** i/f_name:[2:99.99864%,3:0.00136%]
[INFO] ** modbus_function_code:[0.02961:99.99535%,-33.760870000000004:0.00465%]
[INFO] ** modbus_function_description:[7:49.99845%,11:49.9969%,0:0.00465%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99651%,2:0.00213%,1:0.00136%]
[INFO] ** proxy_src_ip:[18:37.97147%,20:26.13782%,13:18.24833%,6:17.63734%,17:0.00136%,11:0.00078%,1:0.00078%,21:0.00058%,16:0.00039%,14:0.00039%,7:0.00039%,10:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.13685%,-0.32151:20.74695%,-1.27613:18.24774%,-0.23351:17.63695%,-0.33484:17.22452%,-71.33197:0.00136%,-71.14931:0.00097%,-71.14798:0.00058%,1.45709:0.00058%,-1.02014:0.00039%,-1.27347:0.00039%,-0.24151:0.00039%,-58.035180000000004:0.00019%,-1.2708:0.00019%,-5.1466400000000005:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-5.08665:0.00019%,14.253910000000001:0.00019%,-68.79874000000001:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:26.13646%,1:20.74695%,5:18.24774%,4:17.63676%,2:17.22452%,0:0.00756%]
[INFO] ** service:[0.0048200000000000005:99.99535%,-211.73542999999998:0.00136%,-211.08818:0.00097%,-205.44247:0.00078%,-211.08346:0.00058%,-186.43601999999998:0.00039%,-211.09762999999998:0.00019%,-185.9872:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:37.97147%,9:26.13782%,7:18.24833%,1:17.63734%,14:0.00136%,10:0.00078%,3:0.00078%,4:0.00058%,21:0.00039%,15:0.00039%,2:0.00039%,11:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1409 (0.27321%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0065 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0030 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0022 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0016 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2326 - tp: 71523.0000 - fp: 8477.0000 - tn: 311523.0000 - fn: 8477.0000 - accuracy: 0.9576 - precision: 0.8940 - recall: 0.8940 - auc: 0.9896 - val_loss: 0.4504 - val_tp: 12847.0000 - val_fp: 7153.0000 - val_tn: 72847.0000 - val_fn: 7153.0000 - val_accuracy: 0.8569 - val_precision: 0.6424 - val_recall: 0.6424 - val_auc: 0.9680
[INFO] saving weights to checkpoints/lstm-epoch-3-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0139 - tp: 79371.0000 - fp: 629.0000 - tn: 319371.0000 - fn: 629.0000 - accuracy: 0.9969 - precision: 0.9921 - recall: 0.9921 - auc: 1.0000 - val_loss: 0.0011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.5500e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.8776e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 8-8/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99709%,30:0.00097%,0:0.00058%,24:0.00019%,23:0.00019%,22:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:94.45866%,Single Stage Single Point:5.54134%]
[INFO] ** dst:[21:43.43312%,10:20.81133%,8:18.1727%,9:17.57917%,22:0.00136%,15:0.00097%,25:0.00058%,19:0.00039%,26:0.00019%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99942%,0:0.00058%]
[INFO] ** i/f_name:[2:99.99903%,3:0.00097%]
[INFO] ** modbus_function_code:[0.02961:99.99709%,-33.760870000000004:0.00271%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99961%,11:49.99748%,0:0.00271%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99961%,2:0.00039%]
[INFO] ** proto:[0:99.99825%,1:0.00097%,2:0.00078%]
[INFO] ** proxy_src_ip:[18:38.10003%,20:26.14499%,13:18.17193%,6:17.57956%,10:0.00116%,17:0.00097%,16:0.00058%,14:0.00039%,11:0.00019%,5:0.00019%]
[INFO] ** s_port:[1.45442:26.14441%,-0.32151:20.81133%,-1.27613:18.17174%,-0.23351:17.57898%,-0.33484:17.2887%,-71.33197:0.00097%,-15.039579999999999:0.00078%,-1.02014:0.00058%,-64.19493:0.00058%,1.45709:0.00039%,-0.24151:0.00039%,4.66896:0.00039%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-71.14931:0.00019%]
[INFO] ** scada_tag:[3:26.14402%,1:20.81113%,5:18.17174%,4:17.57878%,2:17.28851%,0:0.00582%]
[INFO] ** service:[0.0048200000000000005:99.99787%,-211.73542999999998:0.00097%,-186.44547:0.00058%,-211.07873999999998:0.00039%,-211.08818:0.00019%]
[INFO] ** src:[22:38.10003%,9:26.14499%,7:18.17193%,1:17.57956%,11:0.00116%,15:0.00058%,14:0.00058%,21:0.00039%,2:0.00039%,16:0.00019%,10:0.00019%]
[INFO] ** type:[0:99.99942%,1:0.00039%,2:0.00019%]
[INFO] ** unixtime:1413 (0.27398%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.5944e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.0769e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.4697e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9316e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.5061e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1261e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1633 - tp: 76033.0000 - fp: 3967.0000 - tn: 316033.0000 - fn: 3967.0000 - accuracy: 0.9802 - precision: 0.9504 - recall: 0.9504 - auc: 0.9936 - val_loss: 0.3638 - val_tp: 16360.0000 - val_fp: 3640.0000 - val_tn: 76360.0000 - val_fn: 3640.0000 - val_accuracy: 0.9272 - val_precision: 0.8180 - val_recall: 0.8180 - val_auc: 0.9881
[INFO] saving weights to checkpoints/lstm-epoch-3-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0574 - tp: 78005.0000 - fp: 1995.0000 - tn: 318005.0000 - fn: 1995.0000 - accuracy: 0.9900 - precision: 0.9751 - recall: 0.9751 - auc: 0.9995 - val_loss: 0.0016 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 9-9/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99825%,30:0.00097%,31:0.00039%,26:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:95.67327%,Single Stage Single Point:4.32673%]
[INFO] ** dst:[21:43.3606%,10:20.77351%,8:18.28963%,9:17.57355%,15:0.00097%,22:0.00078%,18:0.00039%,25:0.00019%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99903%,0:0.00097%]
[INFO] ** i/f_name:[2:99.99903%,3:0.00097%]
[INFO] ** modbus_function_code:[0.02961:99.99825%,-33.760870000000004:0.00175%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99825%,0:0.00175%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99981%,2:0.00019%]
[INFO] ** proto:[0:99.99825%,1:0.00097%,2:0.00078%]
[INFO] ** proxy_src_ip:[18:38.00579%,20:26.1289%,13:18.28982%,6:17.57374%,17:0.00097%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.12812%,-0.32151:20.77351%,-1.27613:18.28943%,-0.23351:17.57335%,-0.33484:17.23228%,-71.33197:0.00097%,1.45709:0.00039%,-0.24151:0.00039%,-0.08551:0.00039%,-71.14798:0.00019%,-1.27347:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.12773%,1:20.77332%,5:18.28943%,4:17.57316%,2:17.23228%,0:0.00407%]
[INFO] ** service:[0.0048200000000000005:99.99825%,-211.73542999999998:0.00097%,-186.43601999999998:0.00039%,-186.44547:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.00579%,9:26.1289%,7:18.28982%,1:17.57374%,14:0.00078%,21:0.00019%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1411 (0.2736%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 9.0102e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7065e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1298 - tp: 75735.0000 - fp: 4265.0000 - tn: 315735.0000 - fn: 4265.0000 - accuracy: 0.9787 - precision: 0.9467 - recall: 0.9467 - auc: 0.9961 - val_loss: 0.0629 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0032 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0321e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.2701e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7756e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4955e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2665e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 10-10/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99651%,30:0.00194%,24:0.00019%,23:0.00019%,22:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:94.07648%,Single Stage Single Point:5.92352%]
[INFO] ** dst:[21:43.41489%,10:20.81288%,8:18.22002%,9:17.54853%,15:0.00194%,22:0.00058%,24:0.00039%,19:0.00039%,26:0.00019%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99825%,0:0.00175%]
[INFO] ** i/f_name:[2:99.99806%,3:0.00194%]
[INFO] ** modbus_function_code:[0.02961:99.99651%,-33.760870000000004:0.0033%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99884%,11:49.99767%,0:0.0033%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99922%,1:0.00078%]
[INFO] ** proto:[0:99.99767%,1:0.00194%,2:0.00039%]
[INFO] ** proxy_src_ip:[18:38.09906%,20:26.12909%,13:18.22021%,6:17.54795%,17:0.00194%,10:0.00097%,14:0.00039%,16:0.00019%,5:0.00019%]
[INFO] ** s_port:[1.45442:26.12851%,-0.32151:20.81288%,-1.27613:18.21963%,-0.23351:17.54756%,-0.33484:17.28618%,-71.33197:0.00194%,-10.51843:0.00078%,5.71692:0.00039%,-1.27347:0.00039%,1.46509:0.00019%,1.47576:0.00019%,-0.24950999999999998:0.00019%,1.45709:0.00019%,-0.24151:0.00019%,-71.14931:0.00019%,-1.02014:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.12812%,1:20.81268%,5:18.21963%,4:17.54737%,2:17.28599%,0:0.0062%]
[INFO] ** service:[0.0048200000000000005:99.99729%,-211.73542999999998:0.00194%,-211.07873999999998:0.00039%,-186.44547:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.09906%,9:26.12909%,7:18.22021%,1:17.54795%,14:0.00194%,11:0.00097%,2:0.00039%,16:0.00019%,15:0.00019%]
[INFO] ** type:[0:99.99845%,1:0.00136%,2:0.00019%]
[INFO] ** unixtime:1409 (0.27321%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1647e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.5712e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 8.5152e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.7173 - val_tp: 18412.0000 - val_fp: 1588.0000 - val_tn: 78412.0000 - val_fn: 1588.0000 - val_accuracy: 0.9682 - val_precision: 0.9206 - val_recall: 0.9206 - val_auc: 0.9504
[INFO] saving weights to checkpoints/lstm-epoch-3-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1429 - tp: 77886.0000 - fp: 2114.0000 - tn: 317886.0000 - fn: 2114.0000 - accuracy: 0.9894 - precision: 0.9736 - recall: 0.9736 - auc: 0.9907 - val_loss: 2.2339 - val_tp: 13136.0000 - val_fp: 6864.0000 - val_tn: 73136.0000 - val_fn: 6864.0000 - val_accuracy: 0.8627 - val_precision: 0.6568 - val_recall: 0.6568 - val_auc: 0.8004
[INFO] saving weights to checkpoints/lstm-epoch-3-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0807 - tp: 78456.0000 - fp: 1544.0000 - tn: 318456.0000 - fn: 1544.0000 - accuracy: 0.9923 - precision: 0.9807 - recall: 0.9807 - auc: 0.9960 - val_loss: 8.4213e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.9017e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.1779e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 11-11/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99884%,31:0.00039%,30:0.00039%,26:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.38483%,10:20.88055%,8:18.19791%,9:17.53418%,22:0.00136%,18:0.00039%,15:0.00039%,25:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99961%,3:0.00039%]
[INFO] ** modbus_function_code:[0.02961:99.99884%,-33.760870000000004:0.00116%]
[INFO] ** modbus_function_description:[7:50.00058%,11:49.99825%,0:0.00116%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99884%,2:0.00078%,1:0.00039%]
[INFO] ** proxy_src_ip:[18:38.1487%,20:26.11707%,13:18.19791%,6:17.53457%,16:0.00058%,17:0.00039%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.11649%,-0.32151:20.88055%,-1.27613:18.19772%,-0.23351:17.53399%,-0.33484:17.26815%,-0.24151:0.00058%,-1.02014:0.00058%,-0.08551:0.00039%,-71.33197:0.00039%,-71.14798:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.1161%,1:20.88055%,5:18.19752%,4:17.5336%,2:17.26796%,0:0.00427%]
[INFO] ** service:[0.0048200000000000005:99.99884%,-211.73542999999998:0.00039%,-186.43601999999998:0.00039%,-186.44547:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.1487%,9:26.11707%,7:18.19791%,1:17.53457%,15:0.00058%,14:0.00039%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1410 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.1569e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7497e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1269e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6511e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.1663e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.1153e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.6895e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2395e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.9529e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6843e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 12-12/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99767%,30:0.00213%,9:0.00019%]
[INFO] ** classification:[normal:92.98249%,Single Stage Single Point:7.01751%]
[INFO] ** dst:[21:43.3922%,10:20.87221%,8:18.1919%,9:17.54039%,15:0.00213%,22:0.00058%,24:0.00039%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99825%,0:0.00175%]
[INFO] ** i/f_name:[2:99.99787%,3:0.00213%]
[INFO] ** modbus_function_code:[0.02961:99.99767%,-33.760870000000004:0.00233%]
[INFO] ** modbus_function_description:[7:49.99961%,11:49.99806%,0:0.00233%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99825%,2:0.00175%]
[INFO] ** proto:[0:99.99787%,1:0.00213%]
[INFO] ** proxy_src_ip:[18:38.139%,20:26.1258%,13:18.19209%,6:17.54058%,17:0.00213%,16:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:26.12521%,-0.32151:20.87221%,-1.27613:18.19151%,-0.23351:17.5402%,-0.33484:17.26679%,-71.33197:0.00213%,-1.27347:0.00039%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.12483%,1:20.87221%,5:18.19151%,4:17.53981%,2:17.26679%,0:0.00485%]
[INFO] ** service:[0.0048200000000000005:99.99767%,-211.73542999999998:0.00213%,-183.8612:0.00019%]
[INFO] ** src:[22:38.139%,9:26.1258%,7:18.19209%,1:17.54058%,21:0.00175%,14:0.00039%,15:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1410 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.1852e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1443e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9332e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7394e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2731 - tp: 75394.0000 - fp: 4606.0000 - tn: 315394.0000 - fn: 4606.0000 - accuracy: 0.9770 - precision: 0.9424 - recall: 0.9424 - auc: 0.9841 - val_loss: 0.0309 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1380 - tp: 76109.0000 - fp: 3891.0000 - tn: 316109.0000 - fn: 3891.0000 - accuracy: 0.9805 - precision: 0.9514 - recall: 0.9514 - auc: 0.9965 - val_loss: 0.0366 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0057 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0013 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 13-13/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99632%,31:0.00078%,26:0.00058%,0:0.00058%,30:0.00039%,22:0.00039%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:85.16396%,Single Stage Single Point:14.83604%]
[INFO] ** dst:[21:43.35439%,10:20.80008%,8:18.27935%,9:17.56191%,22:0.00116%,6:0.00097%,18:0.00078%,25:0.00058%,15:0.00039%,24:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99961%,3:0.00039%]
[INFO] ** modbus_function_code:[0.02961:99.99632%,-33.760870000000004:0.00349%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99884%,11:49.99748%,0:0.00349%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99709%,2:0.00252%,1:0.00039%]
[INFO] ** proxy_src_ip:[18:38.05214%,20:26.10272%,13:18.27954%,6:17.56133%,10:0.00116%,11:0.00097%,16:0.00058%,17:0.00039%,7:0.00039%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.10214%,-0.32151:20.80008%,-1.27613:18.27916%,-0.23351:17.56094%,-0.33484:17.25206%,-9.78512:0.00078%,-71.14798:0.00058%,-64.19493:0.00058%,-1.02014:0.00058%,-0.08551:0.00039%,-71.14931:0.00039%,-0.24151:0.00039%,-71.33197:0.00039%,-1.27347:0.00019%,1.46509:0.00019%,-68.79874000000001:0.00019%,14.540560000000001:0.00019%,1.45709:0.00019%,-1.2708:0.00019%,6.1115699999999995:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:26.10175%,1:20.79989%,5:18.27916%,4:17.56094%,2:17.25186%,0:0.0064%]
[INFO] ** service:[0.0048200000000000005:99.99709%,-186.43601999999998:0.00078%,-186.44547:0.00058%,-211.08346:0.00058%,-211.73542999999998:0.00039%,-211.08818:0.00039%,-202.75898:0.00019%]
[INFO] ** src:[22:38.05214%,9:26.10272%,7:18.27954%,1:17.56133%,11:0.00116%,10:0.00097%,15:0.00058%,21:0.00039%,14:0.00039%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1410 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.3842e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.1766e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7095e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.6057e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.9354e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4361e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1860 - tp: 76586.0000 - fp: 3414.0000 - tn: 316586.0000 - fn: 3414.0000 - accuracy: 0.9829 - precision: 0.9573 - recall: 0.9573 - auc: 0.9888 - val_loss: 0.0111 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0041 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0019 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 14-14/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99961%,30:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:95.53308%,Single Stage Single Point:4.46692%]
[INFO] ** dst:[21:43.34722%,10:20.81133%,8:18.26772%,9:17.57219%,22:0.00078%,24:0.00039%,15:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99961%,-33.760870000000004:0.00039%]
[INFO] ** modbus_function_description:[7:50.00097%,11:49.99864%,0:0.00039%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99981%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.05%,20:26.10912%,13:18.26791%,6:17.57238%,17:0.00019%,16:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:26.10834%,-0.32151:20.81133%,-1.27613:18.26733%,-0.23351:17.572%,-0.33484:17.23868%,-1.27347:0.00039%,1.45709:0.00039%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:26.10796%,1:20.81133%,5:18.26714%,4:17.57161%,2:17.23848%,0:0.00349%]
[INFO] ** service:[0.0048200000000000005:99.99961%,-183.8612:0.00019%,-211.73542999999998:0.00019%]
[INFO] ** src:[22:38.05%,9:26.10912%,7:18.26791%,1:17.57238%,15:0.00019%,14:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1409 (0.27321%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1923 - tp: 74348.0000 - fp: 5652.0000 - tn: 314348.0000 - fn: 5652.0000 - accuracy: 0.9717 - precision: 0.9294 - recall: 0.9294 - auc: 0.9933 - val_loss: 0.5154 - val_tp: 12807.0000 - val_fp: 7193.0000 - val_tn: 72807.0000 - val_fn: 7193.0000 - val_accuracy: 0.8561 - val_precision: 0.6403 - val_recall: 0.6403 - val_auc: 0.9677
[INFO] saving weights to checkpoints/lstm-epoch-3-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0194 - tp: 78962.0000 - fp: 1038.0000 - tn: 318962.0000 - fn: 1038.0000 - accuracy: 0.9948 - precision: 0.9870 - recall: 0.9870 - auc: 0.9999 - val_loss: 4.4136e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.0640e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1254e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6832e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3762e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1883e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0391e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 15-15/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (515724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (515724, 17)

[INFO] analyzing data
[INFO] 515724 rows
[INFO] ** appi_name:[21:99.99612%,30:0.0031%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:89.29078%,Single Stage Multi Point:10.70844%,Single Stage Single Point:0.00078%]
[INFO] ** dst:[21:43.29467%,10:20.77507%,8:18.316%,9:17.60884%,15:0.0031%,22:0.00155%,25:0.00019%,24:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.9969%,0:0.0031%]
[INFO] ** i/f_name:[2:99.9969%,3:0.0031%]
[INFO] ** modbus_function_code:[0.02961:99.99612%,-33.760870000000004:0.00388%]
[INFO] ** modbus_function_description:[7:49.99903%,11:49.99709%,0:0.00388%]
[INFO] ** modbus_transaction_id:65536 (12.70757%)
[INFO] ** orig:[0:99.99709%,2:0.00291%]
[INFO] ** proto:[0:99.99651%,1:0.0031%,2:0.00039%]
[INFO] ** proxy_src_ip:[18:38.00424%,20:26.06607%,13:18.3158%,6:17.60942%,17:0.0031%,16:0.00058%,7:0.00039%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.0653%,-0.32151:20.77487%,-1.27613:18.31561%,-0.23351:17.60864%,-0.33484:17.22937%,-71.33197:0.0031%,-1.02014:0.00058%,-0.24151:0.00058%,1.45709:0.00039%,-64.19493:0.00019%,-61.95768:0.00019%,-71.14798:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,10.192739999999999:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%]
[INFO] ** scada_tag:[3:26.06491%,1:20.77468%,5:18.31561%,4:17.60826%,2:17.22918%,0:0.00737%]
[INFO] ** service:[0.0048200000000000005:99.99632%,-211.73542999999998:0.0031%,-186.44547:0.00019%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.00424%,9:26.06607%,7:18.3158%,1:17.60942%,21:0.0033%,15:0.00058%,16:0.00019%,14:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1418 (0.27495%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.4691e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.3949e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1260e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8551e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.3671e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7132e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.1734e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.8930 - val_tp: 18892.0000 - val_fp: 1108.0000 - val_tn: 78892.0000 - val_fn: 1108.0000 - val_accuracy: 0.9778 - val_precision: 0.9446 - val_recall: 0.9446 - val_auc: 0.9654
[INFO] saving weights to checkpoints/lstm-epoch-3-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/515724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5298 - tp: 42627.0000 - fp: 37373.0000 - tn: 282627.0000 - fn: 37373.0000 - accuracy: 0.8131 - precision: 0.5328 - recall: 0.5328 - auc: 0.7080 - val_loss: 7.5473 - val_tp: 10635.0000 - val_fp: 9365.0000 - val_tn: 70635.0000 - val_fn: 9365.0000 - val_accuracy: 0.8127 - val_precision: 0.5318 - val_recall: 0.5318 - val_auc: 0.7073
[INFO] saving weights to checkpoints/lstm-epoch-3-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/515724
[33m[INFO] loading file 16-16/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (455414, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (455414, 17)

[INFO] analyzing data
[INFO] 455414 rows
[INFO] ** appi_name:[21:99.99846%,30:0.00132%,33:0.00022%]
[INFO] ** classification:[normal:83.33626%,Single Stage Multi Point:16.66374%]
[INFO] ** dst:[21:43.35659%,10:20.79844%,8:18.2524%,9:17.58971%,22:0.00132%,15:0.00132%,24:0.00022%]
[INFO] ** i/f_dir:[1:99.99868%,0:0.00132%]
[INFO] ** i/f_name:[2:99.99868%,3:0.00132%]
[INFO] ** modbus_function_code:[0.02961:99.99846%,-33.760870000000004:0.00154%]
[INFO] ** modbus_function_description:[7:50.00066%,11:49.9978%,0:0.00154%]
[INFO] ** modbus_transaction_id:65536 (14.39042%)
[INFO] ** orig:[0:99.99868%,2:0.00132%]
[INFO] ** proto:[0:99.99868%,1:0.00132%]
[INFO] ** proxy_src_ip:[18:38.0478%,20:26.10745%,13:18.25284%,6:17.58993%,17:0.00132%,16:0.00044%,21:0.00022%]
[INFO] ** s_port:[1.45442:26.1068%,-0.32151:20.79822%,-1.27613:18.2524%,-0.23351:17.58949%,-0.33484:17.24958%,-71.33197:0.00132%,1.45709:0.00044%,-0.24151:0.00044%,-1.02014:0.00044%,-1.27347:0.00022%,1.47576:0.00022%,-49.275529999999996:0.00022%,-1.2708:0.00022%]
[INFO] ** scada_tag:[3:26.10636%,1:20.79822%,5:18.25218%,4:17.58905%,2:17.24936%,0:0.00483%]
[INFO] ** service:[0.0048200000000000005:99.99868%,-211.73542999999998:0.00132%]
[INFO] ** src:[22:38.0478%,9:26.10745%,7:18.25284%,1:17.58993%,21:0.00132%,15:0.00044%,4:0.00022%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1246 (0.2736%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/455414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5566 - tp: 42494.0000 - fp: 37506.0000 - tn: 282494.0000 - fn: 37506.0000 - accuracy: 0.8125 - precision: 0.5312 - recall: 0.5312 - auc: 0.7070 - val_loss: 7.5562 - val_tp: 10624.0000 - val_fp: 9376.0000 - val_tn: 70624.0000 - val_fn: 9376.0000 - val_accuracy: 0.8125 - val_precision: 0.5312 - val_recall: 0.5312 - val_auc: 0.7070
[INFO] saving weights to checkpoints/lstm-epoch-3-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/455414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.8442 - tp: 50993.0000 - fp: 29007.0000 - tn: 290993.0000 - fn: 29007.0000 - accuracy: 0.8550 - precision: 0.6374 - recall: 0.6374 - auc: 0.7734 - val_loss: 3.0077e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/455414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.7787e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5785e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/455414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.4123e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2629e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/455414
[33m[INFO] loading file 17-17/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555414, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555414, 17)

[INFO] analyzing data
[INFO] 555414 rows
[INFO] ** appi_name:[21:99.99712%,7:0.00054%,26:0.00036%,0:0.00036%,33:0.00018%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:94.44558%,Multi Stage Multi Point:5.55442%]
[INFO] ** dst:[21:43.3464%,10:20.84661%,8:18.20444%,9:17.59966%,22:0.00072%,6:0.00054%,25:0.00036%,16:0.00036%,2:0.00036%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99712%,-33.760870000000004:0.0027%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99946%,11:49.99766%,0:0.0027%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.79949%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99874%,2:0.00126%]
[INFO] ** proxy_src_ip:[18:38.07718%,20:26.11637%,13:18.2039%,6:17.59948%,10:0.00108%,11:0.0009%,1:0.00036%,21:0.00018%,16:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.11547%,-0.32151:20.84643%,-1.27613:18.20354%,-0.23351:17.5993%,-0.33484:17.23075%,6.0369:0.00072%,1.47576:0.00036%,-71.14798:0.00036%,1.45709:0.00036%,-64.19493:0.00036%,1.46509:0.00018%,-68.79874000000001:0.00018%,-49.275529999999996:0.00018%,-1.27347:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,6.15557:0.00018%,6.06224:0.00018%,8.55414:0.00018%,-3.3787199999999995:0.00018%,-4.3880099999999995:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.11529%,1:20.84625%,5:18.20336%,4:17.59894%,2:17.23075%,0:0.0054%]
[INFO] ** service:[0.0048200000000000005:99.99802%,-211.09762999999998:0.00054%,-211.08346:0.00036%,-186.44547:0.00036%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.07718%,9:26.11637%,7:18.2039%,1:17.59948%,11:0.00108%,10:0.0009%,3:0.00036%,21:0.00018%,15:0.00018%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1517 (0.27313%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1364e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9467e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8123e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6879e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5485e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4401e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7162 - tp: 71482.0000 - fp: 8518.0000 - tn: 311482.0000 - fn: 8518.0000 - accuracy: 0.9574 - precision: 0.8935 - recall: 0.8935 - auc: 0.9335 - val_loss: 2.9456 - val_tp: 16345.0000 - val_fp: 3655.0000 - val_tn: 76345.0000 - val_fn: 3655.0000 - val_accuracy: 0.9269 - val_precision: 0.8173 - val_recall: 0.8173 - val_auc: 0.8858
[INFO] saving weights to checkpoints/lstm-epoch-3-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9154 - tp: 65530.0000 - fp: 14470.0000 - tn: 305530.0000 - fn: 14470.0000 - accuracy: 0.9276 - precision: 0.8191 - recall: 0.8191 - auc: 0.8870 - val_loss: 2.9238 - val_tp: 16372.0000 - val_fp: 3628.0000 - val_tn: 76372.0000 - val_fn: 3628.0000 - val_accuracy: 0.9274 - val_precision: 0.8186 - val_recall: 0.8186 - val_auc: 0.8866
[INFO] saving weights to checkpoints/lstm-epoch-3-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/555414
[33m[INFO] loading file 18-18/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555414, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555414, 17)

[INFO] analyzing data
[INFO] 555414 rows
[INFO] ** appi_name:[21:99.9982%,30:0.00054%,7:0.00054%,31:0.00018%,27:0.00018%,22:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:82.43166%,Multi Stage Multi Point:17.56834%]
[INFO] ** dst:[21:43.34154%,10:20.83311%,8:18.25989%,9:17.56257%,22:0.00072%,15:0.00054%,24:0.00036%,16:0.00036%,2:0.00036%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99946%,0:0.00054%]
[INFO] ** i/f_name:[2:99.99946%,3:0.00054%]
[INFO] ** modbus_function_code:[0.02961:99.9982%,-33.760870000000004:0.0018%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.9982%,0:0.0018%]
[INFO] ** modbus_transaction_id:65536 (11.79949%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99892%,2:0.00054%,1:0.00054%]
[INFO] ** proxy_src_ip:[18:38.07754%,20:26.09765%,13:18.26025%,6:17.56275%,17:0.00054%,11:0.00054%,1:0.00036%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.09693%,-0.32151:20.83311%,-1.27613:18.25971%,-0.23351:17.56239%,-0.33484:17.24443%,-71.33197:0.00054%,-1.27347:0.00036%,1.45709:0.00036%,-0.24151:0.00036%,1.47576:0.00018%,1.46509:0.00018%,3.6236699999999997:0.00018%,-1.2708:0.00018%,-2.48275:0.00018%,6.06224:0.00018%,-3.3787199999999995:0.00018%,8.10082:0.00018%,6.45955:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.09657%,1:20.83293%,5:18.25953%,4:17.56221%,2:17.24425%,0:0.0045%]
[INFO] ** service:[0.0048200000000000005:99.9982%,-211.09762999999998:0.00054%,-211.73542999999998:0.00054%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.07754%,9:26.09765%,7:18.26025%,1:17.56275%,14:0.00054%,10:0.00054%,3:0.00036%,21:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1518 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.4985 - tp: 77526.0000 - fp: 2474.0000 - tn: 317526.0000 - fn: 2474.0000 - accuracy: 0.9876 - precision: 0.9691 - recall: 0.9691 - auc: 0.9807 - val_loss: 6.1305 - val_tp: 12393.0000 - val_fp: 7607.0000 - val_tn: 72393.0000 - val_fn: 7607.0000 - val_accuracy: 0.8479 - val_precision: 0.6197 - val_recall: 0.6197 - val_auc: 0.7623
[INFO] saving weights to checkpoints/lstm-epoch-3-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.1305 - tp: 49572.0000 - fp: 30428.0000 - tn: 289572.0000 - fn: 30428.0000 - accuracy: 0.8479 - precision: 0.6197 - recall: 0.6197 - auc: 0.7623 - val_loss: 6.0395 - val_tp: 12506.0000 - val_fp: 7494.0000 - val_tn: 72506.0000 - val_fn: 7494.0000 - val_accuracy: 0.8501 - val_precision: 0.6253 - val_recall: 0.6253 - val_auc: 0.7658
[INFO] saving weights to checkpoints/lstm-epoch-3-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.1444 - tp: 49503.0000 - fp: 30497.0000 - tn: 289503.0000 - fn: 30497.0000 - accuracy: 0.8475 - precision: 0.6188 - recall: 0.6188 - auc: 0.7617 - val_loss: 6.1474 - val_tp: 12372.0000 - val_fp: 7628.0000 - val_tn: 72372.0000 - val_fn: 7628.0000 - val_accuracy: 0.8474 - val_precision: 0.6186 - val_recall: 0.6186 - val_auc: 0.7616
[INFO] saving weights to checkpoints/lstm-epoch-3-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3067 - tp: 68551.0000 - fp: 11449.0000 - tn: 308551.0000 - fn: 11449.0000 - accuracy: 0.9428 - precision: 0.8569 - recall: 0.8569 - auc: 0.9106 - val_loss: 6.6869e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.2321e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.6991e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/555414
[33m[INFO] loading file 19-19/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555414, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555414, 17)

[INFO] analyzing data
[INFO] 555414 rows
[INFO] ** appi_name:[21:99.99802%,26:0.00036%,0:0.00036%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:87.11592%,Single Stage Multi Point:12.88408%]
[INFO] ** dst:[21:43.38601%,10:20.82591%,8:18.21236%,9:17.57302%,22:0.00126%,6:0.00054%,25:0.00036%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99802%,-33.760870000000004:0.0018%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99802%,0:0.0018%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.79949%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99874%,2:0.00126%]
[INFO] ** proxy_src_ip:[18:38.11337%,20:26.09873%,13:18.21236%,6:17.57302%,10:0.00108%,11:0.0009%,16:0.00054%]
[INFO] ** s_port:[1.45442:26.09765%,-0.32151:20.82591%,-1.27613:18.212%,-0.23351:17.57284%,-0.33484:17.28746%,-5.20264:0.00072%,1.45709:0.00054%,-1.02014:0.00054%,-64.19493:0.00036%,-71.14798:0.00036%,1.46509:0.00036%,-1.27347:0.00018%,-0.24151:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-71.14931:0.00018%,-68.79874000000001:0.00018%,0.75578:0.00018%]
[INFO] ** scada_tag:[3:26.09729%,1:20.82573%,5:18.21182%,4:17.57266%,2:17.28728%,0:0.00522%]
[INFO] ** service:[0.0048200000000000005:99.99874%,-211.08346:0.00036%,-186.44547:0.00036%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.11337%,9:26.09873%,7:18.21236%,1:17.57302%,11:0.00108%,10:0.0009%,15:0.00054%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1519 (0.27349%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.2738e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.7928e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.4198e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.1090e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.7560e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4557e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.2222 - tp: 78897.0000 - fp: 1103.0000 - tn: 318897.0000 - fn: 1103.0000 - accuracy: 0.9945 - precision: 0.9862 - recall: 0.9862 - auc: 0.9914 - val_loss: 9.7974 - val_tp: 7843.0000 - val_fp: 12157.0000 - val_tn: 67843.0000 - val_fn: 12157.0000 - val_accuracy: 0.7569 - val_precision: 0.3922 - val_recall: 0.3922 - val_auc: 0.6201
[INFO] saving weights to checkpoints/lstm-epoch-3-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 9.8375 - tp: 31173.0000 - fp: 48827.0000 - tn: 271173.0000 - fn: 48827.0000 - accuracy: 0.7559 - precision: 0.3897 - recall: 0.3897 - auc: 0.6185 - val_loss: 7.6343 - val_tp: 10527.0000 - val_fp: 9473.0000 - val_tn: 70527.0000 - val_fn: 9473.0000 - val_accuracy: 0.8105 - val_precision: 0.5264 - val_recall: 0.5264 - val_auc: 0.7040
[INFO] saving weights to checkpoints/lstm-epoch-3-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/555414
[33m[INFO] loading file 20-20/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555414, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555414, 17)

[INFO] analyzing data
[INFO] 555414 rows
[INFO] ** appi_name:[21:99.99658%,30:0.00288%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:92.6219%,Single Stage Multi Point:7.3781%]
[INFO] ** dst:[21:43.42508%,10:20.83671%,8:18.16087%,9:17.57248%,15:0.00288%,22:0.00108%,24:0.00036%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99748%,0:0.00252%]
[INFO] ** i/f_name:[2:99.99712%,3:0.00288%]
[INFO] ** modbus_function_code:[0.02961:99.99658%,-33.760870000000004:0.00342%]
[INFO] ** modbus_function_description:[7:49.99946%,11:49.99712%,0:0.00342%]
[INFO] ** modbus_transaction_id:65536 (11.79949%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99658%,1:0.00288%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.11499%,20:26.14734%,13:18.16105%,6:17.57302%,17:0.00288%,14:0.00054%,16:0.00018%]
[INFO] ** s_port:[1.45442:26.14662%,-0.32151:20.83671%,-1.27613:18.16051%,-0.23351:17.5723%,-0.33484:17.27828%,-71.33197:0.00288%,-0.24151:0.00054%,1.45709:0.00036%,-1.27347:0.00036%,13.431270000000001:0.00018%,-1.2708:0.00018%,-1.02014:0.00018%,-71.14798:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:26.14608%,1:20.83653%,5:18.16051%,4:17.57194%,2:17.2781%,0:0.00684%]
[INFO] ** service:[0.0048200000000000005:99.99658%,-211.73542999999998:0.00288%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.11499%,9:26.14734%,7:18.16105%,1:17.57302%,14:0.00288%,2:0.00054%,15:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1518 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.5046e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3311e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.4602 - tp: 67789.0000 - fp: 12211.0000 - tn: 307789.0000 - fn: 12211.0000 - accuracy: 0.9389 - precision: 0.8474 - recall: 0.8474 - auc: 0.9046 - val_loss: 2.9625 - val_tp: 16324.0000 - val_fp: 3676.0000 - val_tn: 76324.0000 - val_fn: 3676.0000 - val_accuracy: 0.9265 - val_precision: 0.8162 - val_recall: 0.8162 - val_auc: 0.8851
[INFO] saving weights to checkpoints/lstm-epoch-3-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9434 - tp: 65391.0000 - fp: 14609.0000 - tn: 305391.0000 - fn: 14609.0000 - accuracy: 0.9270 - precision: 0.8174 - recall: 0.8174 - auc: 0.8859 - val_loss: 2.9424 - val_tp: 16349.0000 - val_fp: 3651.0000 - val_tn: 76349.0000 - val_fn: 3651.0000 - val_accuracy: 0.9270 - val_precision: 0.8174 - val_recall: 0.8174 - val_auc: 0.8859
[INFO] saving weights to checkpoints/lstm-epoch-3-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3765 - tp: 73168.0000 - fp: 6832.0000 - tn: 313168.0000 - fn: 6832.0000 - accuracy: 0.9658 - precision: 0.9146 - recall: 0.9146 - auc: 0.9466 - val_loss: 1.6539e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/555414
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5649e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4658e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/555414
[33m[INFO] loading file 21-21/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555412, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555412, 17)

[INFO] analyzing data
[INFO] 555412 rows
[INFO] ** appi_name:[21:99.99604%,30:0.00108%,7:0.00054%,26:0.00036%,22:0.00036%,0:0.00036%,31:0.00018%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:98.90118%,Multi Stage Single Point:1.09882%]
[INFO] ** dst:[21:43.31001%,10:20.98352%,8:18.16795%,9:17.53365%,15:0.00108%,22:0.0009%,24:0.00072%,6:0.00072%,25:0.00036%,16:0.00036%,2:0.00036%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99604%,-33.760870000000004:0.00378%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99892%,11:49.99712%,0:0.00378%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.79953%)
[INFO] ** orig:[0:99.99928%,2:0.00072%]
[INFO] ** proto:[0:99.99748%,2:0.00144%,1:0.00108%]
[INFO] ** proxy_src_ip:[18:38.30868%,20:25.98449%,13:18.16867%,6:17.53365%,17:0.00108%,10:0.00108%,11:0.0009%,16:0.00054%,1:0.00036%,21:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.98395%,-0.32151:20.9828%,-1.27613:18.16777%,-0.23351:17.53347%,-0.33484:17.32588%,-71.33197:0.00108%,-1.27347:0.00072%,-6.64392:0.00072%,-1.02014:0.00054%,-64.19493:0.00036%,-71.14931:0.00036%,-71.14798:0.00036%,1.47576:0.00018%,1.46509:0.00018%,-1.2708:0.00018%,6.62488:0.00018%,10.15141:0.00018%,-68.79874000000001:0.00018%,7.060860000000001:0.00018%,-3.3787199999999995:0.00018%,-2.2440900000000004:0.00018%,1.45709:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.98341%,1:20.98262%,5:18.16759%,4:17.53311%,2:17.32588%,0:0.00738%]
[INFO] ** service:[0.0048200000000000005:99.99676%,-211.73542999999998:0.00108%,-211.09762999999998:0.00054%,-211.08346:0.00036%,-186.44547:0.00036%,-211.08818:0.00036%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.30868%,9:25.98449%,7:18.16867%,1:17.53365%,11:0.00108%,21:0.0009%,10:0.0009%,15:0.00054%,14:0.00036%,3:0.00036%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1513 (0.27241%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555412
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3757e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2843e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/555412
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2082e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1404e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/555412
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0706e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0099e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/555412
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.6811e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.1220e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/555412
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.6872e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.1433e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/555412
[33m[INFO] loading file 22-22/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (324453, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (324453, 17)

[INFO] analyzing data
[INFO] 324453 rows
[INFO] ** appi_name:[21:99.9926%,30:0.00647%,23:0.00031%,22:0.00031%,18:0.00031%]
[INFO] ** classification:[normal:59.14601%,Multi Stage Single Point:40.85399%]
[INFO] ** dst:[21:43.30365%,10:21.00427%,8:18.10956%,9:17.57389%,15:0.00647%,22:0.00123%,19:0.00062%,26:0.00031%]
[INFO] ** i/f_dir:[1:99.99384%,0:0.00616%]
[INFO] ** i/f_name:[2:99.99353%,3:0.00616%,0:0.00031%]
[INFO] ** modbus_function_code:[0.02961:99.9926%,-33.760870000000004:0.0074%]
[INFO] ** modbus_function_description:[7:49.99707%,11:49.99553%,0:0.0074%]
[INFO] ** modbus_transaction_id:65534 (20.1983%)
[INFO] ** orig:[0:99.99507%,2:0.00431%,1:0.00062%]
[INFO] ** proto:[0:99.99322%,1:0.00647%,2:0.00031%]
[INFO] ** proxy_src_ip:[18:38.32943%,20:25.97942%,13:18.10894%,6:17.57481%,17:0.00647%,14:0.00062%,10:0.00031%]
[INFO] ** s_port:[1.45442:25.97849%,-0.32151:21.00427%,-1.27613:18.10894%,-0.23351:17.57389%,-0.33484:17.32516%,-71.33197:0.00647%,1.45709:0.00062%,-0.24151:0.00062%,7.228860000000001:0.00062%,-0.24950999999999998:0.00031%,1.46509:0.00031%,-71.14931:0.00031%]
[INFO] ** scada_tag:[3:25.97818%,1:21.00427%,5:18.10894%,4:17.57358%,2:17.32516%,0:0.00986%]
[INFO] ** service:[0.0048200000000000005:99.9926%,-211.73542999999998:0.00647%,-211.07873999999998:0.00062%,-211.08818:0.00031%]
[INFO] ** src:[22:38.32943%,9:25.97942%,7:18.10894%,1:17.57481%,21:0.00431%,14:0.00216%,2:0.00062%,11:0.00031%]
[INFO] ** type:[0:99.99815%,1:0.00185%]
[INFO] ** unixtime:895 (0.27585%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/324453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.5530 - tp: 62365.0000 - fp: 17635.0000 - tn: 302365.0000 - fn: 17635.0000 - accuracy: 0.9118 - precision: 0.7796 - recall: 0.7796 - auc: 0.8622 - val_loss: 7.5626 - val_tp: 10616.0000 - val_fp: 9384.0000 - val_tn: 70616.0000 - val_fn: 9384.0000 - val_accuracy: 0.8123 - val_precision: 0.5308 - val_recall: 0.5308 - val_auc: 0.7068
[INFO] saving weights to checkpoints/lstm-epoch-3-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/324453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5699 - tp: 42428.0000 - fp: 37572.0000 - tn: 282428.0000 - fn: 37572.0000 - accuracy: 0.8121 - precision: 0.5304 - recall: 0.5304 - auc: 0.7065 - val_loss: 7.5900 - val_tp: 10582.0000 - val_fp: 9418.0000 - val_tn: 70582.0000 - val_fn: 9418.0000 - val_accuracy: 0.8116 - val_precision: 0.5291 - val_recall: 0.5291 - val_auc: 0.7057
[INFO] saving weights to checkpoints/lstm-epoch-3-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/324453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5856 - tp: 42350.0000 - fp: 37650.0000 - tn: 282350.0000 - fn: 37650.0000 - accuracy: 0.8117 - precision: 0.5294 - recall: 0.5294 - auc: 0.7059 - val_loss: 7.6077 - val_tp: 10560.0000 - val_fp: 9440.0000 - val_tn: 70560.0000 - val_fn: 9440.0000 - val_accuracy: 0.8112 - val_precision: 0.5280 - val_recall: 0.5280 - val_auc: 0.7050
[INFO] saving weights to checkpoints/lstm-epoch-3-files-21-22-batch-200000-300000
[INFO] processing batch 300000-400000/324453
[33m[INFO] loading file 23-23/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524453, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524453, 17)

[INFO] analyzing data
[INFO] 524453 rows
[INFO] ** appi_name:[21:99.99886%,31:0.00038%,30:0.00038%,33:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:96.09345%,Multi Stage Single Point:3.90655%]
[INFO] ** dst:[21:43.32743%,10:21.00303%,8:18.13985%,9:17.5274%,22:0.00095%,24:0.00038%,18:0.00038%,15:0.00038%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99886%,-33.760870000000004:0.00114%]
[INFO] ** modbus_function_description:[7:50.00029%,11:49.99857%,0:0.00114%]
[INFO] ** modbus_transaction_id:65536 (12.49607%)
[INFO] ** orig:[0:99.99981%,2:0.00019%]
[INFO] ** proto:[0:99.99905%,2:0.00057%,1:0.00038%]
[INFO] ** proxy_src_ip:[18:38.34929%,20:25.98136%,13:18.14004%,6:17.5276%,16:0.00057%,17:0.00038%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.98078%,-0.32151:21.00284%,-1.27613:18.13947%,-0.23351:17.52721%,-0.33484:17.34645%,-1.02014:0.00057%,-1.27347:0.00038%,-0.08551:0.00038%,-71.33197:0.00038%,1.45709:0.00019%,-0.24151:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,1.46509:0.00019%,-64.19493:0.00019%,-0.24950999999999998:0.00019%,-49.275529999999996:0.00019%]
[INFO] ** scada_tag:[3:25.9804%,1:21.00284%,5:18.13928%,4:17.52702%,2:17.34626%,0:0.00419%]
[INFO] ** service:[0.0048200000000000005:99.99905%,-211.73542999999998:0.00038%,-186.43601999999998:0.00038%,-186.44547:0.00019%]
[INFO] ** src:[22:38.34929%,9:25.98136%,7:18.14004%,1:17.5276%,15:0.00057%,21:0.00019%,17:0.00019%,14:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1426 (0.2719%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.1278 - tp: 59512.0000 - fp: 20488.0000 - tn: 299512.0000 - fn: 20488.0000 - accuracy: 0.8976 - precision: 0.7439 - recall: 0.7439 - auc: 0.8399 - val_loss: 6.0408e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.8032e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.5614e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.2941e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.1624e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.9334e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.6809e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.5760e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3527e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/524453
[33m[INFO] loading file 24-24/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524453, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524453, 17)

[INFO] analyzing data
[INFO] 524453 rows
[INFO] ** appi_name:[21:99.99295%,30:0.00343%,26:0.00057%,31:0.00038%,27:0.00038%,22:0.00038%,0:0.00038%,24:0.00019%,23:0.00019%,19:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,11:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:95.1416%,Multi Stage Single Point:4.8584%]
[INFO] ** dst:[21:43.35851%,10:21.02324%,8:18.1021%,9:17.50891%,15:0.00343%,22:0.00114%,6:0.00076%,25:0.00038%,19:0.00038%,18:0.00038%,7:0.00038%,26:0.00019%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99676%,0:0.00324%]
[INFO] ** i/f_name:[2:99.99657%,3:0.00343%]
[INFO] ** modbus_function_code:[0.02961:99.99295%,-33.760870000000004:0.00648%,-0.415:0.00019%,0.9188299999999999:0.00019%,0.47422:0.00019%]
[INFO] ** modbus_function_description:[7:49.99743%,11:49.99552%,0:0.00648%,15:0.00019%,10:0.00019%,2:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.49607%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99447%,1:0.00343%,2:0.0021%]
[INFO] ** proxy_src_ip:[18:38.4023%,20:25.98021%,13:18.10191%,6:17.50815%,17:0.00343%,10:0.00133%,14:0.00095%,11:0.00095%,21:0.00038%,16:0.00038%]
[INFO] ** s_port:[1.45442:25.97945%,-0.32151:21.02324%,-1.27613:18.10172%,-0.23351:17.50757%,-0.33484:17.37906%,-71.33197:0.00343%,-9.58113:0.00076%,-71.14798:0.00057%,1.45709:0.00038%,-0.24151:0.00038%,-1.02014:0.00038%,-31.55091:0.00038%,7.6315100000000005:0.00038%,-71.14931:0.00038%,-64.19493:0.00038%,-68.79874000000001:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,-1.27347:0.00019%,7.4901800000000005:0.00019%,13.431270000000001:0.00019%,11.862:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:25.97926%,1:21.02324%,5:18.10153%,4:17.50719%,2:17.37887%,0:0.00992%]
[INFO] ** service:[0.0048200000000000005:99.99409%,-211.73542999999998:0.00343%,-211.08346:0.00057%,-211.07873999999998:0.00038%,-202.75898:0.00038%,-186.44547:0.00038%,-186.43601999999998:0.00038%,-211.08818:0.00038%]
[INFO] ** src:[22:38.4023%,9:25.98021%,7:18.10191%,1:17.50815%,14:0.00343%,11:0.00133%,10:0.00095%,2:0.00095%,15:0.00038%,4:0.00038%]
[INFO] ** type:[0:99.99867%,1:0.00095%,2:0.00038%]
[INFO] ** unixtime:1425 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.2530e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.0479e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.8867e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7667e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.6376e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5168e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.9049e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2748e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9515 - tp: 70314.0000 - fp: 9686.0000 - tn: 310314.0000 - fn: 9686.0000 - accuracy: 0.9516 - precision: 0.8789 - recall: 0.8789 - auc: 0.9243 - val_loss: 5.7340 - val_tp: 12885.0000 - val_fp: 7115.0000 - val_tn: 72885.0000 - val_fn: 7115.0000 - val_accuracy: 0.8577 - val_precision: 0.6442 - val_recall: 0.6442 - val_auc: 0.7777
[INFO] saving weights to checkpoints/lstm-epoch-3-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/524453
[33m[INFO] loading file 25-25/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524453, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524453, 17)

[INFO] analyzing data
[INFO] 524453 rows
[INFO] ** appi_name:[21:99.99619%,30:0.00114%,17:0.00076%,22:0.00057%,31:0.00038%,28:0.00019%,26:0.00019%,12:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** classification:[normal:64.34228%,Multi Stage Single Point:35.65772%]
[INFO] ** dst:[21:43.31523%,10:21.02247%,8:18.14843%,9:17.50929%,15:0.00114%,22:0.00095%,16:0.00076%,6:0.00076%,18:0.00038%,17:0.00038%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99886%,0:0.00114%]
[INFO] ** i/f_name:[2:99.99886%,3:0.00114%]
[INFO] ** modbus_function_code:[0.02961:99.99619%,-33.760870000000004:0.00381%]
[INFO] ** modbus_function_description:[7:49.99895%,11:49.99724%,0:0.00381%]
[INFO] ** modbus_transaction_id:65536 (12.49607%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99771%,2:0.00114%,1:0.00114%]
[INFO] ** proxy_src_ip:[18:38.38533%,20:25.95218%,13:18.14843%,6:17.50986%,17:0.00114%,1:0.00095%,21:0.00076%,16:0.00038%,14:0.00038%,7:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.9518%,-0.32151:21.02209%,-1.27613:18.14805%,-0.23351:17.50929%,-0.33484:17.36323%,-71.33197:0.00114%,-71.14931:0.00057%,-0.24151:0.00038%,-1.02014:0.00038%,-49.275529999999996:0.00038%,1.46509:0.00019%,-5.1466400000000005:0.00019%,-1.27347:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,-0.24950999999999998:0.00019%,2.52505:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,6.1115699999999995:0.00019%,-5.08665:0.00019%,1.45709:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:25.95142%,1:21.0219%,5:18.14786%,4:17.5091%,2:17.36304%,0:0.00667%]
[INFO] ** service:[0.0048200000000000005:99.99657%,-211.73542999999998:0.00114%,-205.44247:0.00076%,-211.08818:0.00057%,-186.43601999999998:0.00038%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.38533%,9:25.95218%,7:18.14843%,1:17.50986%,14:0.00114%,3:0.00095%,4:0.00076%,21:0.00038%,15:0.00038%,2:0.00038%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1425 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.7499 - tp: 51461.0000 - fp: 28539.0000 - tn: 291461.0000 - fn: 28539.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.7770 - val_loss: 5.7421 - val_tp: 12875.0000 - val_fp: 7125.0000 - val_tn: 72875.0000 - val_fn: 7125.0000 - val_accuracy: 0.8575 - val_precision: 0.6438 - val_recall: 0.6438 - val_auc: 0.7773
[INFO] saving weights to checkpoints/lstm-epoch-3-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.7445 - tp: 51488.0000 - fp: 28512.0000 - tn: 291488.0000 - fn: 28512.0000 - accuracy: 0.8574 - precision: 0.6436 - recall: 0.6436 - auc: 0.7772 - val_loss: 5.7453 - val_tp: 12871.0000 - val_fp: 7129.0000 - val_tn: 72871.0000 - val_fn: 7129.0000 - val_accuracy: 0.8574 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.7772
[INFO] saving weights to checkpoints/lstm-epoch-3-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7511 - tp: 51455.0000 - fp: 28545.0000 - tn: 291455.0000 - fn: 28545.0000 - accuracy: 0.8573 - precision: 0.6432 - recall: 0.6432 - auc: 0.7770 - val_loss: 5.7558 - val_tp: 12858.0000 - val_fp: 7142.0000 - val_tn: 72858.0000 - val_fn: 7142.0000 - val_accuracy: 0.8572 - val_precision: 0.6429 - val_recall: 0.6429 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-3-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.7415 - tp: 51503.0000 - fp: 28497.0000 - tn: 291503.0000 - fn: 28497.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.7774 - val_loss: 5.7759 - val_tp: 12833.0000 - val_fp: 7167.0000 - val_tn: 72833.0000 - val_fn: 7167.0000 - val_accuracy: 0.8567 - val_precision: 0.6417 - val_recall: 0.6417 - val_auc: 0.7760
[INFO] saving weights to checkpoints/lstm-epoch-3-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7405 - tp: 51508.0000 - fp: 28492.0000 - tn: 291508.0000 - fn: 28492.0000 - accuracy: 0.8575 - precision: 0.6439 - recall: 0.6439 - auc: 0.7774 - val_loss: 5.7590 - val_tp: 12854.0000 - val_fp: 7146.0000 - val_tn: 72854.0000 - val_fn: 7146.0000 - val_accuracy: 0.8571 - val_precision: 0.6427 - val_recall: 0.6427 - val_auc: 0.7767
[INFO] saving weights to checkpoints/lstm-epoch-3-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/524453
[33m[INFO] loading file 26-26/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (524453, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (524453, 17)

[INFO] analyzing data
[INFO] 524453 rows
[INFO] ** appi_name:[21:99.99847%,7:0.00057%,31:0.00019%,30:0.00019%,22:0.00019%,12:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:64.40005%,Single Stage Single Point:30.45306%,Multi Stage Single Point:5.14689%]
[INFO] ** dst:[21:43.31027%,10:21.08769%,8:18.11907%,9:17.4805%,22:0.00076%,24:0.00038%,16:0.00038%,2:0.00038%,18:0.00019%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99847%,-33.760870000000004:0.00153%]
[INFO] ** modbus_function_description:[7:49.9999%,11:49.99857%,0:0.00153%]
[INFO] ** modbus_transaction_id:65536 (12.49607%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99943%,2:0.00038%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.47094%,20:25.9272%,13:18.11945%,6:17.4805%,1:0.00057%,21:0.00038%,16:0.00038%,17:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.92663%,-0.32151:21.08749%,-1.27613:18.11888%,-0.23351:17.48031%,-0.33484:17.38345%,-1.27347:0.00038%,-1.02014:0.00038%,7.66617:0.00019%,-71.14931:0.00019%,11.57001:0.00019%,-3.3787199999999995:0.00019%,2.52505:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%,1.45709:0.00019%,-49.275529999999996:0.00019%,1.47576:0.00019%,1.46509:0.00019%,14.191239999999999:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.92625%,1:21.08749%,5:18.11888%,4:17.48012%,2:17.38345%,0:0.00381%]
[INFO] ** service:[0.0048200000000000005:99.99867%,-211.09762999999998:0.00057%,-211.35747999999998:0.00019%,-211.73542999999998:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.47094%,9:25.9272%,7:18.11945%,1:17.4805%,3:0.00057%,15:0.00038%,4:0.00038%,21:0.00019%,14:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1423 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.8043 - tp: 72901.0000 - fp: 7005.0000 - tn: 312995.0000 - fn: 7099.0000 - accuracy: 0.9647 - precision: 0.9123 - recall: 0.9113 - auc: 0.9645 - val_loss: 1.0149 - val_tp: 12894.0000 - val_fp: 7106.0000 - val_tn: 72894.0000 - val_fn: 7106.0000 - val_accuracy: 0.8579 - val_precision: 0.6447 - val_recall: 0.6447 - val_auc: 0.9684
[INFO] saving weights to checkpoints/lstm-epoch-3-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0488 - tp: 78478.0000 - fp: 1221.0000 - tn: 318779.0000 - fn: 1522.0000 - accuracy: 0.9931 - precision: 0.9847 - recall: 0.9810 - auc: 0.9998 - val_loss: 0.0056 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0036 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0024 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0013 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.1472e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/524453
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.6299e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8777e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/524453
[33m[INFO] loading file 27-27/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (464583, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (464583, 17)

[INFO] analyzing data
[INFO] 464583 rows
[INFO] ** appi_name:[21:99.99935%,30:0.00065%]
[INFO] ** classification:[normal:64.3377%,Single Stage Single Point:35.6623%]
[INFO] ** dst:[21:43.27192%,10:21.06384%,8:18.18965%,9:17.47287%,22:0.00086%,15:0.00065%,24:0.00022%]
[INFO] ** i/f_dir:[1:99.99978%,0:0.00022%]
[INFO] ** i/f_name:[2:99.99935%,3:0.00065%]
[INFO] ** modbus_function_code:[0.02961:99.99935%,-33.760870000000004:0.00065%]
[INFO] ** modbus_function_description:[7:50.00054%,11:49.99882%,0:0.00065%]
[INFO] ** modbus_transaction_id:65536 (14.10641%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99935%,1:0.00065%]
[INFO] ** proxy_src_ip:[18:38.40433%,20:25.93207%,13:18.18943%,6:17.47309%,17:0.00065%,16:0.00043%]
[INFO] ** s_port:[1.45442:25.93143%,-0.32151:21.06384%,-1.27613:18.18921%,-0.23351:17.47266%,-0.33484:17.3405%,-71.33197:0.00065%,-1.02014:0.00043%,-1.27347:0.00022%,1.45709:0.00022%,-0.24950999999999998:0.00022%,1.46509:0.00022%,1.47576:0.00022%,-0.24151:0.00022%]
[INFO] ** scada_tag:[3:25.931%,1:21.06362%,5:18.189%,4:17.47244%,2:17.34028%,0:0.00366%]
[INFO] ** service:[0.0048200000000000005:99.99935%,-211.73542999999998:0.00065%]
[INFO] ** src:[22:38.40433%,9:25.93207%,7:18.18943%,1:17.47309%,14:0.00065%,15:0.00043%]
[INFO] ** type:[0:99.99957%,1:0.00043%]
[INFO] ** unixtime:1262 (0.27164%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/464583
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5211e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.4833e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/464583
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.3837e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.3753e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/464583
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.6924e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.1204e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/464583
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.7246e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3333e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/464583
[33m[INFO] loading file 28-28/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (398499, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (398499, 17)

[INFO] analyzing data
[INFO] 398499 rows
[INFO] ** appi_name:[21:99.99247%,30:0.00176%,17:0.00125%,22:0.001%,7:0.001%,31:0.00075%,26:0.00075%,28:0.00025%,27:0.00025%,8:0.00025%,0:0.00025%]
[INFO] ** classification:[normal:64.31283%,Single Stage Single Point:35.68717%]
[INFO] ** dst:[21:43.28543%,10:21.01963%,8:18.2023%,9:17.48461%,6:0.00201%,16:0.00176%,18:0.00125%,15:0.00075%,22:0.0005%,17:0.0005%,2:0.0005%,25:0.00025%,7:0.00025%,0:0.00025%]
[INFO] ** i/f_dir:[1:99.99925%,0:0.00075%]
[INFO] ** i/f_name:[2:99.99925%,3:0.00075%]
[INFO] ** modbus_function_code:[0.02961:99.99247%,-33.760870000000004:0.00753%]
[INFO] ** modbus_function_description:[7:49.99636%,11:49.99611%,0:0.00753%]
[INFO] ** modbus_transaction_id:65536 (16.44571%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99548%,2:0.00376%,1:0.00075%]
[INFO] ** proxy_src_ip:[18:38.34263%,20:25.96242%,13:18.20256%,6:17.48486%,1:0.00201%,17:0.00176%,14:0.00151%,7:0.00125%,21:0.00075%,0:0.00025%]
[INFO] ** s_port:[1.45442:25.96217%,-0.32151:21.01963%,-1.27613:18.2023%,-0.23351:17.48436%,-0.33484:17.323%,-71.14798:0.001%,-71.14931:0.001%,-71.33197:0.00075%,-0.08551:0.0005%,-0.24151:0.0005%,7.66617:0.00025%,-58.035180000000004:0.00025%,-1.2708:0.00025%,-64.19493:0.00025%,-5.1466400000000005:0.00025%,13.431270000000001:0.00025%,11.57001:0.00025%,14.4699:0.00025%,1.47576:0.00025%,14.191239999999999:0.00025%,-5.08665:0.00025%,10.192739999999999:0.00025%,-3.3787199999999995:0.00025%,6.1115699999999995:0.00025%,2.05573:0.00025%,-43.76509:0.00025%,2.52505:0.00025%,11.862:0.00025%,-58.032509999999995:0.00025%]
[INFO] ** scada_tag:[3:25.96192%,1:21.01963%,5:18.2023%,4:17.48411%,2:17.323%,0:0.00903%]
[INFO] ** service:[0.0048200000000000005:99.99247%,-205.44247:0.00125%,-186.43601999999998:0.00125%,-211.09762999999998:0.001%,-211.08346:0.001%,-211.08818:0.001%,-211.73542999999998:0.00075%,-186.44547:0.00025%,-183.8612:0.00025%,-185.9872:0.00025%,-211.35747999999998:0.00025%,-202.75898:0.00025%]
[INFO] ** src:[22:38.34263%,9:25.96242%,7:18.20256%,1:17.48486%,3:0.00226%,2:0.00151%,21:0.00125%,4:0.001%,14:0.00075%,8:0.0005%,17:0.00025%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1083 (0.27177%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/398499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3679e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.0918e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/398499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.1854e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6829e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/398499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4078e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4725e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/398499
[33m[INFO] loading file 29-29/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598499, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598499, 17)

[INFO] analyzing data
[INFO] 598499 rows
[INFO] ** appi_name:[21:99.99883%,30:0.0005%,31:0.00017%,26:0.00017%,9:0.00017%,3:0.00017%]
[INFO] ** classification:[normal:64.38123%,Single Stage Single Point:35.61877%]
[INFO] ** dst:[21:43.31536%,10:21.06453%,8:18.14874%,9:17.4697%,22:0.0005%,15:0.0005%,24:0.00017%,18:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99967%,0:0.00033%]
[INFO] ** i/f_name:[2:99.9995%,3:0.0005%]
[INFO] ** modbus_function_code:[0.02961:99.99883%,-33.760870000000004:0.00117%]
[INFO] ** modbus_function_description:[7:49.99975%,11:49.99908%,0:0.00117%]
[INFO] ** modbus_transaction_id:65536 (10.95006%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99916%,1:0.0005%,2:0.00033%]
[INFO] ** proxy_src_ip:[18:38.43214%,20:25.94808%,13:18.14907%,6:17.46937%,17:0.0005%,21:0.00017%,16:0.00017%,7:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.94741%,-0.32151:21.06436%,-1.27613:18.14874%,-0.23351:17.46937%,-0.33484:17.36778%,-71.33197:0.0005%,1.45709:0.00033%,1.47576:0.00033%,-71.14798:0.00017%,-1.27347:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,6.1115699999999995:0.00017%,14.4699:0.00017%]
[INFO] ** scada_tag:[3:25.94708%,1:21.0642%,5:18.14874%,4:17.46904%,2:17.36778%,0:0.00317%]
[INFO] ** service:[0.0048200000000000005:99.999%,-211.73542999999998:0.0005%,-183.8612:0.00017%,-211.08346:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.43214%,9:25.94808%,7:18.14907%,1:17.46937%,14:0.0005%,21:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1625 (0.27151%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7489e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3604e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.1179e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9246e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.7591e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6400e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.5101e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3564e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6182e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1637e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/598499
[33m[INFO] loading file 30-30/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598499, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598499, 17)

[INFO] analyzing data
[INFO] 598499 rows
[INFO] ** appi_name:[21:99.99749%,30:0.00167%,26:0.00017%,17:0.00017%,12:0.00017%,3:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.37287%,Single Stage Single Point:35.62713%]
[INFO] ** dst:[21:43.34143%,10:21.02861%,8:18.14506%,9:17.48173%,15:0.00167%,22:0.00067%,24:0.00033%,25:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.9985%,0:0.0015%]
[INFO] ** i/f_name:[2:99.99833%,3:0.00167%]
[INFO] ** modbus_function_code:[0.02961:99.99749%,-33.760870000000004:0.00251%]
[INFO] ** modbus_function_description:[7:49.99958%,11:49.99791%,0:0.00251%]
[INFO] ** modbus_transaction_id:65536 (10.95006%)
[INFO] ** orig:[0:99.99916%,2:0.0005%,1:0.00033%]
[INFO] ** proto:[0:99.99799%,1:0.00167%,2:0.00033%]
[INFO] ** proxy_src_ip:[18:38.3755%,20:25.9942%,13:18.14539%,6:17.48223%,17:0.00167%,7:0.00033%,0:0.00033%,16:0.00017%,5:0.00017%]
[INFO] ** s_port:[1.45442:25.99403%,-0.32151:21.02827%,-1.27613:18.14489%,-0.23351:17.48157%,-0.33484:17.34723%,-71.33197:0.00167%,-0.24151:0.0005%,-1.27347:0.00033%,-61.95768:0.00033%,-71.14798:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:25.99369%,1:21.02827%,5:18.14473%,4:17.4814%,2:17.34706%,0:0.00485%]
[INFO] ** service:[0.0048200000000000005:99.99783%,-211.73542999999998:0.00167%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.3755%,9:25.9942%,7:18.14539%,1:17.48223%,14:0.00117%,21:0.00084%,8:0.00033%,16:0.00017%,15:0.00017%]
[INFO] ** type:[0:99.99916%,1:0.00084%]
[INFO] ** unixtime:1627 (0.27185%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0864e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0396e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1359e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0212e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8879e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7808e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1684e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4429e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.5369e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2013e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/598499
[33m[INFO] loading file 31-31/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598499, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598499, 17)

[INFO] analyzing data
[INFO] 598499 rows
[INFO] ** appi_name:[21:99.99967%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.37939%,Single Stage Single Point:35.62061%]
[INFO] ** dst:[21:43.32956%,10:21.04849%,8:18.12133%,9:17.49894%,22:0.001%,24:0.00033%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99967%,-33.760870000000004:0.00033%]
[INFO] ** modbus_function_description:[7:50.00008%,11:49.99958%,0:0.00033%]
[INFO] ** modbus_transaction_id:65536 (10.95006%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.3999%,20:25.97882%,13:18.12167%,6:17.49878%,16:0.0005%,7:0.00033%]
[INFO] ** s_port:[1.45442:25.97799%,-0.32151:21.04849%,-1.27613:18.12117%,-0.23351:17.49861%,-0.33484:17.35141%,-1.02014:0.0005%,-1.27347:0.00033%,1.45709:0.00033%,1.47576:0.00033%,-71.14798:0.00017%,1.46509:0.00017%,-0.24151:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.97765%,1:21.04832%,5:18.121%,4:17.49827%,2:17.35124%,0:0.00351%]
[INFO] ** service:[0.0048200000000000005:99.99967%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.3999%,9:25.97882%,7:18.12167%,1:17.49878%,15:0.0005%,21:0.00033%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1626 (0.27168%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6621e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8176e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.5214e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4395e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3718e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3024e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2375e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1765e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.1898e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0609e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/598499
[33m[INFO] loading file 32-32/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598499, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598499, 17)

[INFO] analyzing data
[INFO] 598499 rows
[INFO] ** appi_name:[21:99.99666%,30:0.00284%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.38507%,Single Stage Single Point:35.61493%]
[INFO] ** dst:[21:43.32071%,10:21.06002%,8:18.14907%,9:17.46586%,15:0.00284%,22:0.00084%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99749%,0:0.00251%]
[INFO] ** i/f_name:[2:99.99716%,3:0.00284%]
[INFO] ** modbus_function_code:[0.02961:99.99666%,-33.760870000000004:0.00334%]
[INFO] ** modbus_function_description:[7:49.99908%,11:49.99758%,0:0.00334%]
[INFO] ** modbus_transaction_id:65536 (10.95006%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99666%,1:0.00284%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.4278%,20:25.95326%,13:18.14907%,6:17.46636%,17:0.00284%,14:0.0005%,16:0.00017%]
[INFO] ** s_port:[1.45442:25.95276%,-0.32151:21.06002%,-1.27613:18.14874%,-0.23351:17.46569%,-0.33484:17.36778%,-71.33197:0.00284%,-0.24151:0.0005%,-1.2708:0.00017%,-1.02014:0.00017%,13.431270000000001:0.00017%,-71.14798:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.95242%,1:21.05985%,5:18.14874%,4:17.46536%,2:17.36778%,0:0.00585%]
[INFO] ** service:[0.0048200000000000005:99.99666%,-211.73542999999998:0.00284%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.4278%,9:25.95326%,7:18.14907%,1:17.46636%,14:0.00284%,2:0.0005%,15:0.00017%]
[INFO] ** type:[0:99.99967%,1:0.00033%]
[INFO] ** unixtime:1624 (0.27135%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.0331e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.3849e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8083e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2029e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.4497e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6150e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3187e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5129e-04 - val_tp: 19997.0000 - val_fp: 3.0000 - val_tn: 79997.0000 - val_fn: 3.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.4947e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.5690e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/598499
[33m[INFO] loading file 33-33/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598499, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598499, 17)

[INFO] analyzing data
[INFO] 598499 rows
[INFO] ** appi_name:[21:99.99716%,30:0.001%,17:0.00067%,22:0.0005%,31:0.00017%,28:0.00017%,26:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:64.39259%,Single Stage Single Point:35.60741%]
[INFO] ** dst:[21:43.32656%,10:21.06152%,8:18.12183%,9:17.48558%,22:0.00134%,15:0.001%,16:0.00067%,6:0.00067%,24:0.00033%,17:0.00033%,18:0.00017%]
[INFO] ** i/f_dir:[1:99.999%,0:0.001%]
[INFO] ** i/f_name:[2:99.999%,3:0.001%]
[INFO] ** modbus_function_code:[0.02961:99.99716%,-33.760870000000004:0.00284%]
[INFO] ** modbus_function_description:[7:49.99942%,11:49.99774%,0:0.00284%]
[INFO] ** modbus_transaction_id:65536 (10.95006%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99816%,1:0.001%,2:0.00084%]
[INFO] ** proxy_src_ip:[18:38.41928%,20:25.96963%,13:18.12183%,6:17.48574%,17:0.001%,16:0.00067%,1:0.00067%,21:0.00033%,14:0.00033%,7:0.00033%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.9688%,-0.32151:21.06152%,-1.27613:18.1215%,-0.23351:17.48541%,-0.33484:17.35776%,-71.33197:0.001%,-1.02014:0.00067%,1.45709:0.0005%,-71.14931:0.0005%,-1.27347:0.00033%,-5.08665:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,-71.14798:0.00017%,-58.032509999999995:0.00017%,-58.035180000000004:0.00017%,-0.24151:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.96846%,1:21.06136%,5:18.12133%,4:17.48524%,2:17.35776%,0:0.00585%]
[INFO] ** service:[0.0048200000000000005:99.99716%,-211.73542999999998:0.001%,-205.44247:0.00067%,-211.08818:0.0005%,-211.09762999999998:0.00017%,-211.08346:0.00017%,-185.9872:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.41928%,9:25.96963%,7:18.12183%,1:17.48574%,14:0.001%,15:0.00067%,3:0.00067%,21:0.00033%,4:0.00033%,2:0.00033%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1627 (0.27185%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.3980e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.7640e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0692e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0898e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.2777e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.1968e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.4310e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.4093e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/598499
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.5337e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.9293e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/598499
[33m[INFO] loading file 34-34/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (439932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (439932, 17)

[INFO] analyzing data
[INFO] 439932 rows
[INFO] ** appi_name:[21:99.99773%,30:0.00068%,7:0.00068%,31:0.00023%,22:0.00023%,8:0.00023%,6:0.00023%]
[INFO] ** classification:[normal:64.35745%,Single Stage Single Point:35.64255%]
[INFO] ** dst:[21:43.29737%,10:21.05712%,8:18.18372%,9:17.45906%,22:0.00068%,15:0.00068%,16:0.00045%,2:0.00045%,18:0.00023%,6:0.00023%]
[INFO] ** i/f_dir:[1:99.99932%,0:0.00068%]
[INFO] ** i/f_name:[2:99.99932%,3:0.00068%]
[INFO] ** modbus_function_code:[0.02961:99.99773%,-33.760870000000004:0.00227%]
[INFO] ** modbus_function_description:[7:49.99932%,11:49.99841%,0:0.00227%]
[INFO] ** modbus_transaction_id:65536 (14.89685%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99886%,1:0.00068%,2:0.00045%]
[INFO] ** proxy_src_ip:[18:38.40139%,20:25.95333%,13:18.18349%,6:17.45952%,17:0.00068%,1:0.00068%,21:0.00045%,14:0.00023%,7:0.00023%]
[INFO] ** s_port:[1.45442:25.95287%,-0.32151:21.05689%,-1.27613:18.18349%,-0.23351:17.45883%,-0.33484:17.3445%,-0.24151:0.00068%,-71.33197:0.00068%,-3.0613900000000003:0.00023%,-3.3787199999999995:0.00023%,14.191239999999999:0.00023%,1.46509:0.00023%,1.47576:0.00023%,11.57001:0.00023%,-49.275529999999996:0.00023%,-71.14931:0.00023%,7.66617:0.00023%]
[INFO] ** scada_tag:[3:25.95265%,1:21.05666%,5:18.18326%,4:17.45838%,2:17.3445%,0:0.00455%]
[INFO] ** service:[0.0048200000000000005:99.99795%,-211.09762999999998:0.00068%,-211.73542999999998:0.00068%,-186.43601999999998:0.00023%,-211.35747999999998:0.00023%,-211.08818:0.00023%]
[INFO] ** src:[22:38.40139%,9:25.95333%,7:18.18349%,1:17.45952%,14:0.00068%,3:0.00068%,4:0.00045%,21:0.00023%,2:0.00023%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1195 (0.27163%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/439932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 7.6966e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.3103e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/439932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7011e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1347e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/439932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.9980e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.9633e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/439932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.2757e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.4410e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-33-34-batch-300000-400000
[INFO] processing batch 400000-500000/439932
[33m[INFO] loading file 35-35/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539932, 17)

[INFO] analyzing data
[INFO] 539932 rows
[INFO] ** appi_name:[21:99.99889%,30:0.00111%]
[INFO] ** classification:[normal:64.36866%,Single Stage Single Point:35.63134%]
[INFO] ** dst:[21:43.33305%,10:21.03302%,8:18.15377%,9:17.47794%,22:0.00111%,15:0.00111%]
[INFO] ** i/f_dir:[1:99.99907%,0:0.00093%]
[INFO] ** i/f_name:[2:99.99889%,3:0.00111%]
[INFO] ** modbus_function_code:[0.02961:99.99889%,-33.760870000000004:0.00111%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.9987%,0:0.00111%]
[INFO] ** modbus_transaction_id:65536 (12.13782%)
[INFO] ** orig:[0:99.99963%,1:0.00037%]
[INFO] ** proto:[0:99.99889%,1:0.00111%]
[INFO] ** proxy_src_ip:[18:38.39669%,20:25.96994%,13:18.1534%,6:17.47813%,17:0.00111%,16:0.00074%]
[INFO] ** s_port:[1.45442:25.96938%,-0.32151:21.03302%,-1.27613:18.1534%,-0.23351:17.47776%,-0.33484:17.36367%,-71.33197:0.00111%,-1.02014:0.00074%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.96901%,1:21.03302%,5:18.15321%,4:17.47739%,2:17.36367%,0:0.0037%]
[INFO] ** service:[0.0048200000000000005:99.99889%,-211.73542999999998:0.00111%]
[INFO] ** src:[22:38.39669%,9:25.96994%,7:18.1534%,1:17.47813%,14:0.00111%,15:0.00074%]
[INFO] ** type:[0:99.99907%,1:0.00093%]
[INFO] ** unixtime:1465 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5772e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7665e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5767e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.0340e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7686e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5001e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.4802e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.0780e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.7837e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5512e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/539932
[33m[INFO] loading file 36-36/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539932, 17)

[INFO] analyzing data
[INFO] 539932 rows
[INFO] ** appi_name:[21:99.9987%,30:0.00056%,31:0.00037%,33:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.35496%,Single Stage Single Point:35.64504%]
[INFO] ** dst:[21:43.33138%,10:21.02154%,8:18.15673%,9:17.48813%,22:0.00074%,15:0.00056%,24:0.00037%,18:0.00037%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99944%,0:0.00056%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.9987%,-33.760870000000004:0.0013%]
[INFO] ** modbus_function_description:[7:50.00037%,11:49.99833%,0:0.0013%]
[INFO] ** modbus_transaction_id:65536 (12.13782%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99889%,2:0.00056%,1:0.00056%]
[INFO] ** proxy_src_ip:[18:38.3702%,20:25.9829%,13:18.15692%,6:17.48868%,17:0.00056%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.98235%,-0.32151:21.02135%,-1.27613:18.15636%,-0.23351:17.48794%,-0.33484:17.34885%,-0.24151:0.00056%,-71.33197:0.00056%,-1.27347:0.00037%,-0.08551:0.00037%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-49.275529999999996:0.00019%,-1.2708:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:25.98198%,1:21.02117%,5:18.15618%,4:17.48776%,2:17.34867%,0:0.00426%]
[INFO] ** service:[0.0048200000000000005:99.99889%,-211.73542999999998:0.00056%,-186.43601999999998:0.00037%,-186.44547:0.00019%]
[INFO] ** src:[22:38.3702%,9:25.9829%,7:18.15692%,1:17.48868%,14:0.00056%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1467 (0.2717%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.2877e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1139e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.9190e-05 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3363e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.4986e-04 - tp: 79996.0000 - fp: 4.0000 - tn: 319996.0000 - fn: 4.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 4.9617e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.5857e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8941e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0572e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.0052e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/539932
[33m[INFO] loading file 37-37/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539932, 17)

[INFO] analyzing data
[INFO] 539932 rows
[INFO] ** appi_name:[21:99.99889%,30:0.00074%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.38033%,Single Stage Single Point:35.61967%]
[INFO] ** dst:[21:43.33675%,10:21.04172%,8:18.13691%,9:17.48257%,22:0.00074%,15:0.00074%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99926%,3:0.00074%]
[INFO] ** modbus_function_code:[0.02961:99.99889%,-33.760870000000004:0.00111%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99889%,0:0.00111%]
[INFO] ** modbus_transaction_id:65536 (12.13782%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99907%,1:0.00074%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.39317%,20:25.98568%,13:18.1371%,6:17.48257%,17:0.00074%,16:0.00037%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.98512%,-0.32151:21.04172%,-1.27613:18.13673%,-0.23351:17.48239%,-0.33484:17.35144%,-71.33197:0.00074%,-1.02014:0.00037%,-71.14798:0.00019%,-1.27347:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%,14.4699:0.00019%]
[INFO] ** scada_tag:[3:25.98494%,1:21.04172%,5:18.13654%,4:17.4822%,2:17.35126%,0:0.00333%]
[INFO] ** service:[0.0048200000000000005:99.99889%,-211.73542999999998:0.00074%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.39317%,9:25.98568%,7:18.1371%,1:17.48257%,14:0.00074%,15:0.00037%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1467 (0.2717%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6575e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.5201e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.2623e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4842e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.1006e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7909e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3253e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9904e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.9265e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5376e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/539932
[33m[INFO] loading file 38-38/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539932, 17)

[INFO] analyzing data
[INFO] 539932 rows
[INFO] ** appi_name:[21:99.99907%,30:0.00019%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.40793%,Single Stage Single Point:35.59207%]
[INFO] ** dst:[21:43.32138%,10:21.08451%,8:18.09858%,9:17.49368%,22:0.00093%,25:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99907%,-33.760870000000004:0.00093%]
[INFO] ** modbus_function_description:[7:49.99963%,11:49.99944%,0:0.00093%]
[INFO] ** modbus_transaction_id:65536 (12.13782%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99944%,2:0.00037%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.45373%,20:25.95271%,13:18.09839%,6:17.49405%,7:0.00037%,17:0.00019%,16:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95197%,-0.32151:21.08432%,-1.27613:18.0982%,-0.23351:17.4935%,-0.33484:17.36941%,-0.24151:0.00037%,1.45709:0.00037%,-64.19493:0.00019%,10.192739999999999:0.00019%,-1.02014:0.00019%,-71.14798:0.00019%,-61.95768:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.9516%,1:21.08432%,5:18.0982%,4:17.49331%,2:17.36941%,0:0.00315%]
[INFO] ** service:[0.0048200000000000005:99.99926%,-211.08346:0.00019%,-205.44247:0.00019%,-186.44547:0.00019%,-211.73542999999998:0.00019%]
[INFO] ** src:[22:38.45373%,9:25.95271%,7:18.09839%,1:17.49405%,21:0.00037%,16:0.00019%,15:0.00019%,14:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1468 (0.27189%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.4225e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5857e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3149e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1471e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.2862e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7181e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6873e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7534e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.0215e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5509e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/539932
[33m[INFO] loading file 39-39/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539932, 17)

[INFO] analyzing data
[INFO] 539932 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.41089%,Single Stage Single Point:35.58911%]
[INFO] ** dst:[21:43.32453%,10:21.08543%,8:18.1271%,9:17.46183%,22:0.00093%,24:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99981%]
[INFO] ** modbus_transaction_id:65536 (12.13782%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.45595%,20:25.95438%,13:18.12728%,6:17.46183%,16:0.00056%]
[INFO] ** s_port:[1.45442:25.95382%,-0.32151:21.08543%,-1.27613:18.12691%,-0.23351:17.46164%,-0.33484:17.37052%,-1.02014:0.00056%,-1.27347:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.95345%,1:21.08525%,5:18.12673%,4:17.46164%,2:17.37034%,0:0.00259%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.45595%,9:25.95438%,7:18.12728%,1:17.46183%,15:0.00056%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1465 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1063e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.8833e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.7758e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1811e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0343e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8843e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6553e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7331e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.5879e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4681e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/539932
[33m[INFO] loading file 40-40/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539932, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539932, 17)

[INFO] analyzing data
[INFO] 539932 rows
[INFO] ** appi_name:[21:99.9963%,30:0.00315%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.33847%,Single Stage Single Point:35.66153%]
[INFO] ** dst:[21:43.29453%,10:21.03895%,8:18.19377%,9:17.46794%,15:0.00315%,22:0.00093%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99704%,0:0.00296%]
[INFO] ** i/f_name:[2:99.99685%,3:0.00315%]
[INFO] ** modbus_function_code:[0.02961:99.9963%,-33.760870000000004:0.0037%]
[INFO] ** modbus_function_description:[7:49.99907%,11:49.99722%,0:0.0037%]
[INFO] ** modbus_transaction_id:65536 (12.13782%)
[INFO] ** orig:[0:99.99963%,1:0.00037%]
[INFO] ** proto:[0:99.9963%,1:0.00315%,2:0.00056%]
[INFO] ** proxy_src_ip:[18:38.35668%,20:25.97772%,13:18.19359%,6:17.46831%,17:0.00315%,14:0.00056%]
[INFO] ** s_port:[1.45442:25.97679%,-0.32151:21.03895%,-1.27613:18.1934%,-0.23351:17.46776%,-0.33484:17.31774%,-71.33197:0.00315%,1.45709:0.00056%,-0.24151:0.00037%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,13.431270000000001:0.00019%]
[INFO] ** scada_tag:[3:25.97642%,1:21.03876%,5:18.19322%,4:17.46738%,2:17.31755%,0:0.00667%]
[INFO] ** service:[0.0048200000000000005:99.9963%,-211.73542999999998:0.00315%,-211.08346:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.35668%,9:25.97772%,7:18.19359%,1:17.46831%,14:0.00315%,2:0.00056%]
[INFO] ** type:[0:99.99907%,1:0.00093%]
[INFO] ** unixtime:1468 (0.27189%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3342e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.9075e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0810e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1078e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.8312e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5416e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2490e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8028e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/539932
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.8106e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2595e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/539932
[33m[INFO] loading file 41-41/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (480090, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (480090, 17)

[INFO] analyzing data
[INFO] 480090 rows
[INFO] ** appi_name:[21:99.99646%,30:0.00104%,22:0.00083%,17:0.00083%,32:0.00021%,28:0.00021%,26:0.00021%,7:0.00021%]
[INFO] ** classification:[normal:64.39084%,Single Stage Single Point:35.60916%]
[INFO] ** dst:[21:43.3225%,10:21.06397%,8:18.13535%,9:17.4736%,16:0.00104%,15:0.00104%,6:0.00104%,22:0.00062%,24:0.00042%,17:0.00042%]
[INFO] ** i/f_dir:[1:99.99896%,0:0.00104%]
[INFO] ** i/f_name:[2:99.99896%,3:0.00104%]
[INFO] ** modbus_function_code:[0.02961:99.99646%,-33.760870000000004:0.00354%]
[INFO] ** modbus_function_description:[7:49.99896%,11:49.9975%,0:0.00354%]
[INFO] ** modbus_transaction_id:65536 (13.65077%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99771%,2:0.00125%,1:0.00104%]
[INFO] ** proxy_src_ip:[18:38.43779%,20:25.94888%,13:18.13556%,6:17.47381%,17:0.00104%,1:0.00083%,21:0.00042%,16:0.00042%,14:0.00042%,0:0.00042%,7:0.00021%,2:0.00021%]
[INFO] ** s_port:[1.45442:25.94847%,-0.32151:21.06397%,-1.27613:18.13493%,-0.23351:17.47339%,-0.33484:17.37383%,-71.33197:0.00104%,-71.14931:0.00083%,-1.02014:0.00042%,-1.27347:0.00042%,-71.14798:0.00021%,-0.24151:0.00021%,-58.035180000000004:0.00021%,-1.2708:0.00021%,-5.1466400000000005:0.00021%,1.47576:0.00021%,1.46509:0.00021%,-64.19226:0.00021%,-5.08665:0.00021%,-0.24950999999999998:0.00021%,2.05573:0.00021%,-43.76509:0.00021%,-58.032509999999995:0.00021%]
[INFO] ** scada_tag:[3:25.94826%,1:21.06397%,5:18.13493%,4:17.47318%,2:17.37383%,0:0.00583%]
[INFO] ** service:[0.0048200000000000005:99.99646%,-211.73542999999998:0.00104%,-205.44247:0.00083%,-211.08818:0.00083%,89.64175:0.00021%,-211.09762999999998:0.00021%,-211.08346:0.00021%,-185.9872:0.00021%]
[INFO] ** src:[22:38.43779%,9:25.94888%,7:18.13556%,1:17.47381%,14:0.00104%,3:0.00083%,15:0.00042%,8:0.00042%,4:0.00042%,2:0.00042%,21:0.00021%,17:0.00021%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1302 (0.2712%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/480090
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.5589e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.3731e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/480090
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9361e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6670e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/480090
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5522e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8309e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/480090
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7225e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2534e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/480090
[33m[INFO] loading file 42-42/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (423604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (423604, 17)

[INFO] analyzing data
[INFO] 423604 rows
[INFO] ** appi_name:[21:99.99197%,30:0.00212%,17:0.00118%,31:0.00094%,26:0.00094%,7:0.00094%,22:0.00071%,28:0.00024%,27:0.00024%,9:0.00024%,8:0.00024%,0:0.00024%]
[INFO] ** classification:[normal:64.39104%,Single Stage Single Point:35.60896%]
[INFO] ** dst:[21:43.32702%,10:21.05528%,8:18.16413%,9:17.44436%,16:0.00212%,6:0.00189%,18:0.00118%,22:0.00094%,2:0.00094%,15:0.00071%,17:0.00047%,25:0.00024%,24:0.00024%,7:0.00024%,0:0.00024%]
[INFO] ** i/f_dir:[1:99.99929%,0:0.00071%]
[INFO] ** i/f_name:[2:99.99929%,3:0.00071%]
[INFO] ** modbus_function_code:[0.02961:99.99197%,-33.760870000000004:0.00803%]
[INFO] ** modbus_function_description:[7:49.99693%,11:49.99504%,0:0.00803%]
[INFO] ** modbus_transaction_id:65536 (15.47105%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99575%,2:0.00354%,1:0.00071%]
[INFO] ** proxy_src_ip:[18:38.42079%,20:25.96175%,13:18.16461%,6:17.44436%,17:0.00212%,1:0.00212%,14:0.00142%,21:0.00094%,7:0.00071%,16:0.00047%,0:0.00047%,2:0.00024%]
[INFO] ** s_port:[1.45442:25.96128%,-0.32151:21.05528%,-1.27613:18.16413%,-0.23351:17.44412%,-0.33484:17.36551%,-71.14798:0.00094%,-71.14931:0.00094%,-71.33197:0.00071%,11.57001:0.00047%,-0.08551:0.00047%,-3.3787199999999995:0.00047%,-1.02014:0.00047%,-5.1466400000000005:0.00024%,-0.24151:0.00024%,13.431270000000001:0.00024%,0.31847:0.00024%,-1.2708:0.00024%,-58.035180000000004:0.00024%,7.66617:0.00024%,-64.19493:0.00024%,1.47576:0.00024%,14.4699:0.00024%,15.912510000000001:0.00024%,14.191239999999999:0.00024%,7.9608300000000005:0.00024%,-5.08665:0.00024%,10.192739999999999:0.00024%,-3.0613900000000003:0.00024%,1.45709:0.00024%,2.05573:0.00024%,-43.76509:0.00024%,11.862:0.00024%,-1.27347:0.00024%,-58.032509999999995:0.00024%]
[INFO] ** scada_tag:[3:25.9608%,1:21.05528%,5:18.1639%,4:17.44412%,2:17.36528%,0:0.01062%]
[INFO] ** service:[0.0048200000000000005:99.99197%,-211.09762999999998:0.00165%,-205.44247:0.00118%,-186.43601999999998:0.00118%,-211.08346:0.00094%,-211.08818:0.00094%,-211.73542999999998:0.00071%,-211.35747999999998:0.00047%,-186.44547:0.00024%,-183.8612:0.00024%,-185.9872:0.00024%,-202.75898:0.00024%]
[INFO] ** src:[22:38.42079%,9:25.96175%,7:18.16461%,1:17.44436%,3:0.00283%,2:0.00165%,4:0.00118%,21:0.00094%,14:0.00071%,15:0.00047%,8:0.00047%,17:0.00024%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1150 (0.27148%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/423604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3757e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.0413e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/423604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.0431e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1934e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/423604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9825e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7934e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/423604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.6913e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0212e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-41-42-batch-300000-400000
[INFO] processing batch 400000-500000/423604
[33m[INFO] loading file 43-43/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99924%,30:0.00057%,26:0.00019%]
[INFO] ** classification:[normal:64.39867%,Single Stage Single Point:35.60133%]
[INFO] ** dst:[21:43.3316%,10:21.06535%,8:18.13088%,9:17.47026%,22:0.00095%,15:0.00057%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99924%,-33.760870000000004:0.00076%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99924%,0:0.00076%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99924%,1:0.00057%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.41816%,20:25.97918%,13:18.13107%,6:17.47045%,17:0.00057%,16:0.00038%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.9786%,-0.32151:21.06535%,-1.27613:18.13069%,-0.23351:17.47007%,-0.33484:17.35281%,-71.33197:0.00057%,1.45709:0.00038%,-1.02014:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.97822%,1:21.06535%,5:18.1305%,4:17.46969%,2:17.35262%,0:0.00363%]
[INFO] ** service:[0.0048200000000000005:99.99924%,-211.73542999999998:0.00057%,-211.08346:0.00019%]
[INFO] ** src:[22:38.41816%,9:25.97918%,7:18.13107%,1:17.47045%,14:0.00057%,15:0.00038%,3:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1424 (0.27196%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5813e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4092e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.5439e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.4070e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6110e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5754e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6512e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2158e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.9217e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6781e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 44-44/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99809%,30:0.00076%,31:0.00057%,0:0.00038%,22:0.00019%]
[INFO] ** classification:[normal:64.36868%,Single Stage Single Point:35.63132%]
[INFO] ** dst:[21:43.32282%,10:21.04262%,8:18.16506%,9:17.46606%,22:0.00115%,15:0.00076%,18:0.00057%,25:0.00038%,24:0.00038%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99924%,0:0.00076%]
[INFO] ** i/f_name:[2:99.99924%,3:0.00076%]
[INFO] ** modbus_function_code:[0.02961:99.99809%,-33.760870000000004:0.00191%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.9979%,0:0.00191%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99809%,2:0.00115%,1:0.00076%]
[INFO] ** proxy_src_ip:[18:38.41395%,20:25.95206%,13:18.16525%,6:17.46664%,17:0.00076%,7:0.00038%,16:0.00019%,5:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95129%,-0.32151:21.04262%,-1.27613:18.16468%,-0.23351:17.46587%,-0.33484:17.37133%,-71.33197:0.00076%,-0.24151:0.00057%,1.45709:0.00038%,-64.19493:0.00038%,-0.08551:0.00038%,-1.27347:0.00038%,1.46509:0.00019%,1.47576:0.00019%,-0.24950999999999998:0.00019%,4.42897:0.00019%,-71.14931:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.95072%,1:21.04262%,5:18.16468%,4:17.46549%,2:17.37114%,0:0.00535%]
[INFO] ** service:[0.0048200000000000005:99.99809%,-211.73542999999998:0.00076%,-186.43601999999998:0.00057%,-186.44547:0.00038%,-211.08818:0.00019%]
[INFO] ** src:[22:38.41395%,9:25.95206%,7:18.16525%,1:17.46664%,14:0.00076%,21:0.00038%,17:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1421 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.4250e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8368e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.8567e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2541e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9427e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8636e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5388e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5891e-04 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.2055e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.3091e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 45-45/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99905%,30:0.00057%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.41681%,Single Stage Single Point:35.58319%]
[INFO] ** dst:[21:43.32301%,10:21.09151%,8:18.12152%,9:17.46186%,22:0.00115%,15:0.00057%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99905%,-33.760870000000004:0.00095%]
[INFO] ** modbus_function_description:[7:50.00038%,11:49.99866%,0:0.00095%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99924%,1:0.00057%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.48596%,20:25.92933%,13:18.12133%,6:17.46205%,17:0.00057%,16:0.00038%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.92856%,-0.32151:21.09151%,-1.27613:18.12133%,-0.23351:17.46167%,-0.33484:17.39444%,1.45709:0.00057%,-71.33197:0.00057%,-1.02014:0.00038%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.92799%,1:21.09132%,5:18.12133%,4:17.46167%,2:17.39425%,0:0.00344%]
[INFO] ** service:[0.0048200000000000005:99.99905%,-211.73542999999998:0.00057%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.48596%,9:25.92933%,7:18.12133%,1:17.46205%,14:0.00057%,15:0.00038%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1421 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.9945e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4702e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.2538e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2253e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4860e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9087e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2264e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1348e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0686e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.9681e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 46-46/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99809%,30:0.00115%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.42139%,Single Stage Single Point:35.57861%]
[INFO] ** dst:[21:43.34745%,10:21.07127%,8:18.10624%,9:17.47236%,15:0.00115%,22:0.00095%,25:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99905%,0:0.00095%]
[INFO] ** i/f_name:[2:99.99885%,3:0.00115%]
[INFO] ** modbus_function_code:[0.02961:99.99809%,-33.760870000000004:0.00191%]
[INFO] ** modbus_function_description:[11:49.99924%,7:49.99885%,0:0.00191%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99847%,1:0.00115%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:38.44298%,20:25.97555%,13:18.10624%,6:17.47294%,17:0.00115%,16:0.00038%,7:0.00038%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.97536%,-0.32151:21.07108%,-1.27613:18.10605%,-0.23351:17.47217%,-0.33484:17.37191%,-71.33197:0.00115%,-0.24151:0.00057%,-1.02014:0.00038%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,10.192739999999999:0.00019%,1.47576:0.00019%,-61.95768:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.97497%,1:21.07089%,5:18.10586%,4:17.47179%,2:17.37191%,0:0.00458%]
[INFO] ** service:[0.0048200000000000005:99.99828%,-211.73542999999998:0.00115%,-186.44547:0.00019%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.44298%,9:25.97555%,7:18.10624%,1:17.47294%,14:0.00115%,21:0.00038%,15:0.00038%,16:0.00019%,8:0.00019%]
[INFO] ** type:[0:99.99905%,1:0.00095%]
[INFO] ** unixtime:1423 (0.27177%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1396e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7600e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.3565e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.9553e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 7.6214e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.2703e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7359e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.1590e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.8853e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7237e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 47-47/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99943%,33:0.00019%,26:0.00019%,17:0.00019%]
[INFO] ** classification:[normal:64.3958%,Single Stage Single Point:35.6042%]
[INFO] ** dst:[21:43.30486%,10:21.08884%,8:18.12725%,9:17.47657%,22:0.00172%,24:0.00038%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99943%,-33.760870000000004:0.00057%]
[INFO] ** modbus_function_description:[7:50.00095%,11:49.99847%,0:0.00057%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99981%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.46036%,20:25.9341%,13:18.12763%,6:17.47695%,16:0.00038%,7:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.93315%,-0.32151:21.08884%,-1.27613:18.12706%,-0.23351:17.47638%,-0.33484:17.37153%,1.45709:0.00057%,-0.24151:0.00057%,-1.27347:0.00038%,-1.02014:0.00038%,-71.14798:0.00019%,-61.95635:0.00019%,10.192739999999999:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.93257%,1:21.08865%,5:18.12687%,4:17.47618%,2:17.37133%,0:0.00439%]
[INFO] ** service:[0.0048200000000000005:99.99962%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.46036%,9:25.9341%,7:18.12763%,1:17.47695%,21:0.00038%,15:0.00038%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1421 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.9485e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3338e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0279e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3114e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.5554e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5194e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2108e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2394e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5845e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1444e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 48-48/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99656%,30:0.00267%,33:0.00019%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.41758%,Single Stage Single Point:35.58242%]
[INFO] ** dst:[21:43.33046%,10:21.08311%,8:18.11254%,9:17.4695%,15:0.00267%,22:0.00095%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99771%,0:0.00229%]
[INFO] ** i/f_name:[2:99.99733%,3:0.00267%]
[INFO] ** modbus_function_code:[0.02961:99.99656%,-33.760870000000004:0.00344%]
[INFO] ** modbus_function_description:[7:49.99885%,11:49.99771%,0:0.00344%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99675%,1:0.00267%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.45444%,20:25.95931%,13:18.11293%,6:17.4695%,17:0.00267%,14:0.00057%,16:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95893%,-0.32151:21.08311%,-1.27613:18.11254%,-0.23351:17.46931%,-0.33484:17.37133%,-71.33197:0.00267%,-1.02014:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,1.45709:0.00019%,-61.95635:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,13.431270000000001:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.95855%,1:21.08311%,5:18.11254%,4:17.46931%,2:17.37114%,0:0.00535%]
[INFO] ** service:[0.0048200000000000005:99.99675%,-211.73542999999998:0.00267%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.45444%,9:25.95931%,7:18.11293%,1:17.4695%,14:0.00267%,2:0.00057%,15:0.00038%,8:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1421 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.4567e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6680e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5203e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3820e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3915e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1995e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2431e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0378e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3088e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2669e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 49-49/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (523604, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (523604, 17)

[INFO] analyzing data
[INFO] 523604 rows
[INFO] ** appi_name:[21:99.99733%,30:0.00095%,17:0.00076%,22:0.00038%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.36601%,Single Stage Single Point:35.63399%]
[INFO] ** dst:[21:43.30219%,10:21.05943%,8:18.14367%,9:17.49032%,22:0.00134%,15:0.00095%,16:0.00076%,6:0.00057%,24:0.00038%,17:0.00038%]
[INFO] ** i/f_dir:[1:99.99905%,0:0.00095%]
[INFO] ** i/f_name:[2:99.99905%,3:0.00095%]
[INFO] ** modbus_function_code:[0.02961:99.99733%,-33.760870000000004:0.00267%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99771%,0:0.00267%]
[INFO] ** modbus_transaction_id:65536 (12.51633%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99847%,1:0.00095%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.4193%,20:25.94308%,13:18.14367%,6:17.49089%,17:0.00095%,1:0.00076%,21:0.00038%,16:0.00038%,14:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.94232%,-0.32151:21.05943%,-1.27613:18.14329%,-0.23351:17.49013%,-0.33484:17.35988%,-71.33197:0.00095%,-0.24151:0.00057%,1.45709:0.00038%,-1.02014:0.00038%,-71.14931:0.00038%,-1.27347:0.00038%,-71.14798:0.00019%,-58.035180000000004:0.00019%,-5.1466400000000005:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-5.08665:0.00019%,-0.24950999999999998:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:25.94193%,1:21.05924%,5:18.1431%,4:17.48974%,2:17.35988%,0:0.00611%]
[INFO] ** service:[0.0048200000000000005:99.99733%,-211.73542999999998:0.00095%,-205.44247:0.00076%,-211.08818:0.00038%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.4193%,9:25.94308%,7:18.14367%,1:17.49089%,14:0.00095%,3:0.00076%,15:0.00038%,4:0.00038%,2:0.00038%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1422 (0.27158%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1233e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.1564e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5036e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0116e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1432e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7075e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.6537e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.1363e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/523604
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8389e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2806e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/523604
[33m[INFO] loading file 50-50/50 on epoch 3/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (373586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (373586, 17)

[INFO] analyzing data
[INFO] 373586 rows
[INFO] ** appi_name:[21:99.99732%,30:0.00107%,7:0.0008%,31:0.00027%,22:0.00027%,8:0.00027%]
[INFO] ** classification:[normal:64.29631%,Single Stage Single Point:35.70369%]
[INFO] ** dst:[21:43.25216%,10:21.04094%,8:18.22713%,9:17.4763%,15:0.00107%,22:0.00054%,16:0.00054%,2:0.00054%,24:0.00027%,18:0.00027%,6:0.00027%]
[INFO] ** i/f_dir:[1:99.99893%,0:0.00107%]
[INFO] ** i/f_name:[2:99.99893%,3:0.00107%]
[INFO] ** modbus_function_code:[0.02961:99.99732%,-33.760870000000004:0.00268%]
[INFO] ** modbus_function_description:[11:49.99893%,7:49.99839%,0:0.00268%]
[INFO] ** modbus_transaction_id:65535 (17.54215%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99839%,1:0.00107%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.36145%,20:25.93191%,13:18.2274%,6:17.4763%,17:0.00107%,1:0.0008%,21:0.00027%,16:0.00027%,14:0.00027%,7:0.00027%]
[INFO] ** s_port:[1.45442:25.93138%,-0.32151:21.04094%,-1.27613:18.22686%,-0.23351:17.4763%,-0.33484:17.32051%,-71.33197:0.00107%,-3.3787199999999995:0.00027%,4.33564:0.00027%,15.912510000000001:0.00027%,7.9608300000000005:0.00027%,1.46509:0.00027%,1.45709:0.00027%,-1.27347:0.00027%,-71.14931:0.00027%,-1.02014:0.00027%,-1.2708:0.00027%,0.31847:0.00027%]
[INFO] ** scada_tag:[3:25.93111%,1:21.04067%,5:18.22659%,4:17.4763%,2:17.32024%,0:0.00509%]
[INFO] ** service:[0.0048200000000000005:99.99732%,-211.73542999999998:0.00107%,-211.09762999999998:0.0008%,-186.43601999999998:0.00027%,-211.35747999999998:0.00027%,-211.08818:0.00027%]
[INFO] ** src:[22:38.36145%,9:25.93191%,7:18.2274%,1:17.4763%,14:0.00107%,3:0.0008%,21:0.00027%,15:0.00027%,4:0.00027%,2:0.00027%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1015 (0.27169%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/373586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.2058e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1338e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/373586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.5480e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.9501e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/373586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1437e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0698e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-3-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/373586
[33m[INFO] epoch 4/10[0m
[33m[INFO] loading file 1-1/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99355%,30:0.00105%,22:0.00087%,17:0.0007%,7:0.0007%,31:0.00052%,26:0.00052%,23:0.00035%,18:0.00035%,0:0.00035%,28:0.00017%,27:0.00017%,24:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:77.37096%,Single Stage Single Point:22.62904%]
[INFO] ** dst:[21:43.26762%,10:21.03643%,8:18.17129%,9:17.51769%,6:0.00139%,22:0.00105%,16:0.00105%,15:0.00105%,18:0.00052%,26:0.00035%,25:0.00035%,19:0.00035%,17:0.00035%,24:0.00017%,7:0.00017%,2:0.00017%]
[INFO] ** i/f_dir:[1:99.99895%,0:0.00105%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.99355%,-33.760870000000004:0.00628%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99756%,11:49.99599%,0:0.00628%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99651%,2:0.00244%,1:0.00105%]
[INFO] ** proxy_src_ip:[18:38.39581%,20:25.90788%,13:18.17147%,6:17.51804%,11:0.00122%,10:0.00122%,17:0.00105%,1:0.00105%,14:0.00087%,7:0.00052%,21:0.00035%,16:0.00035%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.90736%,-0.32151:21.03573%,-1.27613:18.17112%,-0.23351:17.51751%,-0.33484:17.36008%,-71.33197:0.00105%,-71.14931:0.00087%,-2.1481:0.0007%,-71.14798:0.00052%,-0.24151:0.00052%,-64.19493:0.00035%,-2.42942:0.00035%,4.44364:0.00035%,-1.02014:0.00035%,1.47576:0.00017%,-5.1466400000000005:0.00017%,-1.27347:0.00017%,10.67005:0.00017%,4.29964:0.00017%,-5.08665:0.00017%,1.45709:0.00017%,-68.79874000000001:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,14.253910000000001:0.00017%,4.076980000000001:0.00017%,-58.032509999999995:0.00017%,-58.035180000000004:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,0.31847:0.00017%]
[INFO] ** scada_tag:[3:25.90719%,1:21.03556%,5:18.17077%,4:17.51734%,2:17.35991%,0:0.00924%]
[INFO] ** service:[0.0048200000000000005:99.99425%,-211.73542999999998:0.00105%,-211.08818:0.00087%,-211.09762999999998:0.0007%,-205.44247:0.0007%,-211.07873999999998:0.0007%,-211.08346:0.00052%,-186.43601999999998:0.00052%,-186.44547:0.00035%,-185.9872:0.00017%,-202.75898:0.00017%]
[INFO] ** src:[22:38.39581%,9:25.90788%,7:18.17147%,1:17.51804%,11:0.00122%,10:0.00122%,14:0.00105%,3:0.00105%,2:0.00087%,21:0.00052%,15:0.00035%,4:0.00035%,8:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1557 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0301 - tp: 79468.0000 - fp: 532.0000 - tn: 319468.0000 - fn: 532.0000 - accuracy: 0.9973 - precision: 0.9934 - recall: 0.9934 - auc: 0.9992 - val_loss: 0.0034 - val_tp: 19986.0000 - val_fp: 14.0000 - val_tn: 79986.0000 - val_fn: 14.0000 - val_accuracy: 0.9997 - val_precision: 0.9993 - val_recall: 0.9993 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.5222e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.6133e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.4901e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7903e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.7240 - tp: 67115.0000 - fp: 12885.0000 - tn: 307115.0000 - fn: 12885.0000 - accuracy: 0.9356 - precision: 0.8389 - recall: 0.8389 - auc: 0.9615 - val_loss: 0.6281 - val_tp: 10612.0000 - val_fp: 9388.0000 - val_tn: 70612.0000 - val_fn: 9388.0000 - val_accuracy: 0.8122 - val_precision: 0.5306 - val_recall: 0.5306 - val_auc: 0.9449
[INFO] saving weights to checkpoints/lstm-epoch-4-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0187 - tp: 79470.0000 - fp: 530.0000 - tn: 319470.0000 - fn: 530.0000 - accuracy: 0.9973 - precision: 0.9934 - recall: 0.9934 - auc: 1.0000 - val_loss: 9.3110e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 2-2/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99861%,30:0.00052%,7:0.00052%,31:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:70.25834%,Single Stage Single Point:29.74166%]
[INFO] ** dst:[21:43.31417%,10:21.02475%,8:18.13677%,9:17.52187%,22:0.00087%,15:0.00052%,16:0.00035%,2:0.00035%,24:0.00017%,18:0.00017%]
[INFO] ** i/f_dir:[1:99.99948%,0:0.00052%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.99861%,-33.760870000000004:0.00139%]
[INFO] ** modbus_function_description:[7:49.99983%,11:49.99878%,0:0.00139%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9993%,1:0.00052%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.37716%,20:25.96228%,13:18.13677%,6:17.52222%,17:0.00052%,1:0.00052%,16:0.00017%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.96158%,-0.32151:21.02475%,-1.27613:18.13643%,-0.23351:17.5217%,-0.33484:17.35241%,-71.33197:0.00052%,-0.24151:0.00035%,1.45709:0.00035%,1.46509:0.00017%,1.47576:0.00017%,12.60597:0.00017%,10.67005:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,4.076980000000001:0.00017%,-3.3787199999999995:0.00017%,4.29964:0.00017%,-1.27347:0.00017%]
[INFO] ** scada_tag:[3:25.96123%,1:21.02475%,5:18.13643%,4:17.52135%,2:17.35224%,0:0.00401%]
[INFO] ** service:[0.0048200000000000005:99.99861%,-211.09762999999998:0.00052%,-211.73542999999998:0.00052%,-211.35747999999998:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.37716%,9:25.96228%,7:18.13677%,1:17.52222%,14:0.00052%,3:0.00052%,21:0.00017%,15:0.00017%,2:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1560 (0.27197%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0275 - tp: 79610.0000 - fp: 390.0000 - tn: 319610.0000 - fn: 390.0000 - accuracy: 0.9980 - precision: 0.9951 - recall: 0.9951 - auc: 0.9986 - val_loss: 0.0038 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0011 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0086 - val_tp: 19980.0000 - val_fp: 20.0000 - val_tn: 79980.0000 - val_fn: 20.0000 - val_accuracy: 0.9996 - val_precision: 0.9990 - val_recall: 0.9990 - val_auc: 0.9994
[INFO] saving weights to checkpoints/lstm-epoch-4-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0627 - tp: 79106.0000 - fp: 894.0000 - tn: 319106.0000 - fn: 894.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9957 - val_loss: 4.3667e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.6287 - tp: 60139.0000 - fp: 19861.0000 - tn: 300139.0000 - fn: 19861.0000 - accuracy: 0.9007 - precision: 0.7517 - recall: 0.7517 - auc: 0.9486 - val_loss: 0.4923 - val_tp: 14812.0000 - val_fp: 5188.0000 - val_tn: 74812.0000 - val_fn: 5188.0000 - val_accuracy: 0.8962 - val_precision: 0.7406 - val_recall: 0.7406 - val_auc: 0.9474
[INFO] saving weights to checkpoints/lstm-epoch-4-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1225 - tp: 75353.0000 - fp: 4647.0000 - tn: 315353.0000 - fn: 4647.0000 - accuracy: 0.9768 - precision: 0.9419 - recall: 0.9419 - auc: 0.9981 - val_loss: 0.0111 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 3-3/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99198%,30:0.00209%,22:0.00105%,31:0.00087%,26:0.00087%,17:0.00087%,7:0.0007%,27:0.00035%,0:0.00035%,28:0.00017%,23:0.00017%,15:0.00017%,8:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:88.37716%,Single Stage Single Point:11.62284%]
[INFO] ** dst:[21:43.30719%,10:21.08054%,8:18.15874%,9:17.44464%,6:0.00209%,15:0.00139%,18:0.00122%,16:0.00122%,22:0.00087%,2:0.00035%,7:0.00035%,25:0.00035%,17:0.00035%,12:0.00017%,24:0.00017%,19:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99861%,0:0.00139%]
[INFO] ** i/f_name:[2:99.99861%,3:0.00139%]
[INFO] ** modbus_function_code:[0.02961:99.99198%,-33.760870000000004:0.00785%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99669%,11:49.99529%,0:0.00785%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99895%,2:0.00105%]
[INFO] ** proto:[0:99.99442%,2:0.00418%,1:0.00139%]
[INFO] ** proxy_src_ip:[18:38.40523%,20:25.98268%,13:18.15909%,6:17.44499%,17:0.00209%,1:0.00139%,14:0.00122%,7:0.00087%,11:0.0007%,10:0.0007%,21:0.00052%,16:0.00017%,15:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.98198%,-0.32151:21.08036%,-1.27613:18.15839%,-0.23351:17.44446%,-0.33484:17.32486%,-71.33197:0.00139%,-71.14931:0.00105%,-71.14798:0.00105%,-64.19493:0.00035%,-1.2708:0.00035%,-0.08551:0.00035%,1.45709:0.00035%,-0.24151:0.00035%,13.86459:0.00017%,2.05573:0.00017%,6.1115699999999995:0.00017%,4.44364:0.00017%,-5.08665:0.00017%,-3.3787199999999995:0.00017%,10.192739999999999:0.00017%,4.29964:0.00017%,14.4699:0.00017%,-43.76509:0.00017%,-58.035180000000004:0.00017%,4.90362:0.00017%,4.076980000000001:0.00017%,-58.032509999999995:0.00017%,-1.27347:0.00017%,-1.02014:0.00017%,-5.1466400000000005:0.00017%,13.431270000000001:0.00017%,12.60597:0.00017%,1.47576:0.00017%,1.46509:0.00017%,14.253910000000001:0.00017%,-68.79874000000001:0.00017%,-0.24950999999999998:0.00017%,-2.1481:0.00017%,10.67005:0.00017%,-68.36943000000001:0.00017%]
[INFO] ** scada_tag:[3:25.98163%,1:21.08019%,5:18.15822%,4:17.44429%,2:17.32469%,0:0.01098%]
[INFO] ** service:[0.0048200000000000005:99.99215%,-211.73542999999998:0.00139%,-186.43601999999998:0.00122%,-211.08346:0.00105%,-211.08818:0.00105%,-205.44247:0.00087%,-211.09762999999998:0.0007%,-202.75898:0.00035%,-186.44547:0.00035%,-183.8612:0.00017%,-185.9872:0.00017%,-201.23771000000002:0.00017%,-211.35747999999998:0.00017%,-211.07873999999998:0.00017%]
[INFO] ** src:[22:38.40523%,9:25.98268%,7:18.15909%,1:17.44499%,21:0.00192%,3:0.00157%,2:0.00122%,11:0.0007%,10:0.0007%,4:0.0007%,14:0.00035%,8:0.00035%,17:0.00017%,15:0.00017%,13:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1558 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0493 - tp: 79101.0000 - fp: 899.0000 - tn: 319101.0000 - fn: 899.0000 - accuracy: 0.9955 - precision: 0.9888 - recall: 0.9888 - auc: 0.9986 - val_loss: 2.4720 - val_tp: 10572.0000 - val_fp: 9428.0000 - val_tn: 70572.0000 - val_fn: 9428.0000 - val_accuracy: 0.8114 - val_precision: 0.5286 - val_recall: 0.5286 - val_auc: 0.8275
[INFO] saving weights to checkpoints/lstm-epoch-4-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3119 - tp: 71935.0000 - fp: 8065.0000 - tn: 311935.0000 - fn: 8065.0000 - accuracy: 0.9597 - precision: 0.8992 - recall: 0.8992 - auc: 0.9871 - val_loss: 0.0140 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3244 - tp: 69357.0000 - fp: 10643.0000 - tn: 309357.0000 - fn: 10643.0000 - accuracy: 0.9468 - precision: 0.8670 - recall: 0.8670 - auc: 0.9827 - val_loss: 0.1499 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0062 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8177e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.5527e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6901e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 4-4/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99773%,30:0.00122%,31:0.00035%,33:0.00017%,26:0.00017%,23:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:92.36732%,Single Stage Single Point:7.63268%]
[INFO] ** dst:[21:43.34938%,10:20.951%,8:18.17565%,9:17.5203%,22:0.00122%,15:0.00122%,24:0.00035%,18:0.00035%,19:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99895%,0:0.00105%]
[INFO] ** i/f_name:[2:99.99878%,3:0.00122%]
[INFO] ** modbus_function_code:[0.02961:99.99773%,-33.760870000000004:0.00227%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99773%,0:0.00227%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99895%,2:0.00105%]
[INFO] ** proto:[0:99.99826%,1:0.00122%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.26227%,20:26.03847%,13:18.17583%,6:17.52065%,17:0.00122%,16:0.00052%,21:0.00035%,14:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.03777%,-0.32151:20.95083%,-1.27613:18.1753%,-0.23351:17.52013%,-0.33484:17.31144%,-71.33197:0.00122%,-1.02014:0.00052%,1.45709:0.00035%,-0.08551:0.00035%,-1.27347:0.00035%,-0.24151:0.00035%,14.4699:0.00017%,4.44364:0.00017%,-71.14798:0.00017%,-1.2708:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:26.03742%,1:20.95065%,5:18.1753%,4:17.51978%,2:17.31127%,0:0.00558%]
[INFO] ** service:[0.0048200000000000005:99.99791%,-211.73542999999998:0.00122%,-186.43601999999998:0.00035%,-183.8612:0.00017%,-211.08346:0.00017%,-211.07873999999998:0.00017%]
[INFO] ** src:[22:38.26227%,9:26.03847%,7:18.17583%,1:17.52065%,21:0.00105%,15:0.00052%,4:0.00035%,17:0.00017%,14:0.00017%,8:0.00017%,3:0.00017%,2:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1568 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.2155e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6491e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4220e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2114e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.2176e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0085e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.2343e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.1190e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.5875 - tp: 54502.0000 - fp: 25498.0000 - tn: 294502.0000 - fn: 25498.0000 - accuracy: 0.8725 - precision: 0.6813 - recall: 0.6813 - auc: 0.9409 - val_loss: 0.4310 - val_tp: 14284.0000 - val_fp: 5716.0000 - val_tn: 74284.0000 - val_fn: 5716.0000 - val_accuracy: 0.8857 - val_precision: 0.7142 - val_recall: 0.7142 - val_auc: 0.9557
[INFO] saving weights to checkpoints/lstm-epoch-4-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 5-5/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99616%,30:0.00279%,37:0.00017%,26:0.00017%,12:0.00017%,9:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:88.95144%,Single Stage Single Point:11.04856%]
[INFO] ** dst:[21:43.36473%,10:20.77108%,8:18.23737%,9:17.62229%,15:0.00279%,22:0.00087%,25:0.00017%,24:0.00017%,6:0.00017%,2:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99756%,0:0.00244%]
[INFO] ** i/f_name:[2:99.99721%,3:0.00279%]
[INFO] ** modbus_function_code:[0.02961:99.99616%,-33.760870000000004:0.00384%]
[INFO] ** modbus_function_description:[7:49.99861%,11:49.99756%,0:0.00384%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99773%,2:0.00227%]
[INFO] ** proto:[0:99.99686%,1:0.00279%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.00895%,20:26.12721%,13:18.23737%,6:17.62247%,17:0.00279%,1:0.00035%,21:0.00017%,16:0.00017%,7:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.12651%,-0.32151:20.77073%,-1.27613:18.2372%,-0.23351:17.62212%,-0.33484:17.23822%,-71.33197:0.00279%,-0.24151:0.00035%,1.45709:0.00035%,1.47576:0.00017%,1.46509:0.00017%,-49.275529999999996:0.00017%,-1.27347:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,2.22906:0.00017%,14.4699:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.12616%,1:20.77056%,5:18.23702%,4:17.62212%,2:17.23822%,0:0.00593%]
[INFO] ** service:[0.0048200000000000005:99.99651%,-211.73542999999998:0.00279%,-183.8612:0.00017%,-211.08346:0.00017%,-211.35747999999998:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.00895%,9:26.12721%,7:18.23737%,1:17.62247%,21:0.00244%,14:0.00052%,3:0.00035%,16:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1571 (0.27389%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.2637 - tp: 72789.0000 - fp: 7211.0000 - tn: 312789.0000 - fn: 7211.0000 - accuracy: 0.9639 - precision: 0.9099 - recall: 0.9099 - auc: 0.9870 - val_loss: 0.0528 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1646 - tp: 76575.0000 - fp: 3425.0000 - tn: 316575.0000 - fn: 3425.0000 - accuracy: 0.9829 - precision: 0.9572 - recall: 0.9572 - auc: 0.9930 - val_loss: 0.0225 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.2000 - tp: 73485.0000 - fp: 6515.0000 - tn: 313485.0000 - fn: 6515.0000 - accuracy: 0.9674 - precision: 0.9186 - recall: 0.9186 - auc: 0.9926 - val_loss: 0.5413 - val_tp: 12828.0000 - val_fp: 7172.0000 - val_tn: 72828.0000 - val_fn: 7172.0000 - val_accuracy: 0.8566 - val_precision: 0.6414 - val_recall: 0.6414 - val_auc: 0.9679
[INFO] saving weights to checkpoints/lstm-epoch-4-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0167 - tp: 79191.0000 - fp: 809.0000 - tn: 319191.0000 - fn: 809.0000 - accuracy: 0.9960 - precision: 0.9899 - recall: 0.9899 - auc: 1.0000 - val_loss: 7.0657e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.4747e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2760e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 6-6/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99599%,30:0.00314%,31:0.00017%,27:0.00017%,26:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:92.95572%,Single Stage Single Point:7.04428%]
[INFO] ** dst:[21:43.37606%,10:20.73046%,8:18.27869%,9:17.61009%,15:0.00314%,22:0.00052%,25:0.00017%,24:0.00017%,18:0.00017%,12:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99704%,0:0.00296%]
[INFO] ** i/f_name:[2:99.99686%,3:0.00314%]
[INFO] ** modbus_function_code:[0.02961:99.99599%,-33.760870000000004:0.00401%]
[INFO] ** modbus_function_description:[7:49.99878%,11:49.99721%,0:0.00401%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99965%,1:0.00035%]
[INFO] ** proto:[0:99.99599%,1:0.00314%,2:0.00087%]
[INFO] ** proxy_src_ip:[18:37.94061%,20:26.16608%,13:18.27886%,6:17.61026%,17:0.00314%,14:0.00052%,16:0.00035%,11:0.00017%]
[INFO] ** s_port:[1.45442:26.16574%,-0.32151:20.73046%,-1.27613:18.27834%,-0.23351:17.60991%,-0.33484:17.21015%,-71.33197:0.00314%,-1.02014:0.00035%,-71.14798:0.00017%,-64.19493:0.00017%,4.90362:0.00017%,-1.2708:0.00017%,-0.24151:0.00017%,13.431270000000001:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-68.36943000000001:0.00017%]
[INFO] ** scada_tag:[3:26.16556%,1:20.73011%,5:18.27817%,4:17.60957%,2:17.20997%,0:0.00662%]
[INFO] ** service:[0.0048200000000000005:99.99599%,-211.73542999999998:0.00314%,-211.08346:0.00017%,-201.23771000000002:0.00017%,-202.75898:0.00017%,-186.44547:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:37.94061%,9:26.16608%,7:18.27886%,1:17.61026%,14:0.00314%,2:0.00052%,15:0.00035%,10:0.00017%]
[INFO] ** type:[0:99.99913%,1:0.00087%]
[INFO] ** unixtime:1570 (0.27372%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.1273e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0985e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.2761e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.6366e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.7254e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4454e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.3012e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1793e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2373 - tp: 73340.0000 - fp: 6660.0000 - tn: 313340.0000 - fn: 6660.0000 - accuracy: 0.9667 - precision: 0.9168 - recall: 0.9168 - auc: 0.9899 - val_loss: 0.5214 - val_tp: 12742.0000 - val_fp: 7258.0000 - val_tn: 72742.0000 - val_fn: 7258.0000 - val_accuracy: 0.8548 - val_precision: 0.6371 - val_recall: 0.6371 - val_auc: 0.9671
[INFO] saving weights to checkpoints/lstm-epoch-4-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 7-7/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99547%,30:0.00157%,22:0.00087%,17:0.0007%,26:0.00052%,31:0.00035%,28:0.00017%,27:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:80.31577%,Single Stage Single Point:19.68423%]
[INFO] ** dst:[21:43.36368%,10:20.73848%,8:18.25149%,9:17.64007%,15:0.00157%,22:0.00139%,6:0.00139%,16:0.0007%,24:0.00035%,18:0.00035%,17:0.00035%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.99843%,0:0.00157%]
[INFO] ** i/f_name:[2:99.99843%,3:0.00157%]
[INFO] ** modbus_function_code:[0.02961:99.99547%,-33.760870000000004:0.00453%]
[INFO] ** modbus_function_description:[7:49.99843%,11:49.99704%,0:0.00453%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99651%,2:0.00192%,1:0.00157%]
[INFO] ** proxy_src_ip:[18:37.96031%,20:26.14255%,13:18.25184%,6:17.64025%,17:0.00157%,11:0.0007%,1:0.0007%,21:0.00052%,16:0.00052%,14:0.00035%,7:0.00035%,10:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.14168%,-0.32151:20.73848%,-1.27613:18.25132%,-0.23351:17.6399%,-0.33484:17.22183%,-71.33197:0.00157%,-71.14931:0.00087%,-1.02014:0.00052%,-71.14798:0.00052%,1.45709:0.00052%,-0.24151:0.00035%,-1.27347:0.00035%,1.47576:0.00017%,1.46509:0.00017%,14.253910000000001:0.00017%,-1.2708:0.00017%,-58.035180000000004:0.00017%,-58.032509999999995:0.00017%,-68.79874000000001:0.00017%,-43.76509:0.00017%,2.05573:0.00017%,6.1115699999999995:0.00017%,-5.08665:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:26.14133%,1:20.73848%,5:18.25114%,4:17.63973%,2:17.22165%,0:0.00767%]
[INFO] ** service:[0.0048200000000000005:99.99547%,-211.73542999999998:0.00157%,-211.08818:0.00087%,-205.44247:0.0007%,-211.08346:0.00052%,-186.43601999999998:0.00035%,-211.09762999999998:0.00017%,-185.9872:0.00017%,-202.75898:0.00017%]
[INFO] ** src:[22:37.96031%,9:26.14255%,7:18.25184%,1:17.64025%,14:0.00157%,10:0.0007%,3:0.0007%,15:0.00052%,4:0.00052%,21:0.00035%,2:0.00035%,11:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1567 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0244 - tp: 78843.0000 - fp: 1157.0000 - tn: 318843.0000 - fn: 1157.0000 - accuracy: 0.9942 - precision: 0.9855 - recall: 0.9855 - auc: 0.9999 - val_loss: 7.4196e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.4186e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2712e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.6702e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.4513e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2421 - tp: 73742.0000 - fp: 6258.0000 - tn: 313742.0000 - fn: 6258.0000 - accuracy: 0.9687 - precision: 0.9218 - recall: 0.9218 - auc: 0.9886 - val_loss: 0.0764 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0100 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.3191e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 8-8/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99721%,30:0.00105%,0:0.00052%,24:0.00017%,23:0.00017%,22:0.00017%,18:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:95.01766%,Single Stage Single Point:4.98234%]
[INFO] ** dst:[21:43.4179%,10:20.80176%,8:18.19483%,9:17.58202%,22:0.00122%,15:0.00105%,25:0.00052%,19:0.00035%,26:0.00017%,24:0.00017%]
[INFO] ** i/f_dir:[1:99.9993%,0:0.0007%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.99721%,-33.760870000000004:0.00262%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99965%,11:49.99756%,0:0.00262%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99965%,2:0.00035%]
[INFO] ** proto:[0:99.99826%,1:0.00105%,2:0.0007%]
[INFO] ** proxy_src_ip:[18:38.08461%,20:26.13558%,13:18.19413%,6:17.58237%,17:0.00105%,10:0.00105%,16:0.00052%,14:0.00035%,11:0.00017%,5:0.00017%]
[INFO] ** s_port:[1.45442:26.13505%,-0.32151:20.80176%,-1.27613:18.19396%,-0.23351:17.58184%,-0.33484:17.28285%,-71.33197:0.00105%,-15.039579999999999:0.0007%,-1.02014:0.00052%,-64.19493:0.00052%,1.45709:0.00035%,-0.24151:0.00035%,4.66896:0.00035%,-1.27347:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,-71.14931:0.00017%]
[INFO] ** scada_tag:[3:26.13453%,1:20.80159%,5:18.19396%,4:17.58167%,2:17.28267%,0:0.00558%]
[INFO] ** service:[0.0048200000000000005:99.99791%,-211.73542999999998:0.00105%,-186.44547:0.00052%,-211.07873999999998:0.00035%,-211.08818:0.00017%]
[INFO] ** src:[22:38.08461%,9:26.13558%,7:18.19413%,1:17.58237%,11:0.00105%,14:0.0007%,15:0.00052%,21:0.00035%,2:0.00035%,16:0.00017%,10:0.00017%]
[INFO] ** type:[0:99.99948%,1:0.00035%,2:0.00017%]
[INFO] ** unixtime:1570 (0.27372%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.7980e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6520e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1057e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5423e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3871e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0463e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.3071e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.2939e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2156 - tp: 73561.0000 - fp: 6439.0000 - tn: 313561.0000 - fn: 6439.0000 - accuracy: 0.9678 - precision: 0.9195 - recall: 0.9195 - auc: 0.9912 - val_loss: 0.0337 - val_tp: 19996.0000 - val_fp: 4.0000 - val_tn: 79996.0000 - val_fn: 4.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 9-9/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99826%,30:0.00105%,31:0.00035%,26:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:94.27636%,Single Stage Single Point:5.72364%]
[INFO] ** dst:[21:43.37362%,10:20.77387%,8:18.27782%,9:17.57191%,15:0.00105%,22:0.00087%,18:0.00035%,25:0.00017%,24:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99895%,0:0.00105%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.99826%,-33.760870000000004:0.00174%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99826%,0:0.00174%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99965%,2:0.00035%]
[INFO] ** proto:[0:99.99826%,1:0.00105%,2:0.0007%]
[INFO] ** proxy_src_ip:[18:38.01069%,20:26.13732%,13:18.27782%,6:17.57226%,17:0.00105%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.13662%,-0.32151:20.77387%,-1.27613:18.27747%,-0.23351:17.57173%,-0.33484:17.23682%,-71.33197:0.00105%,-0.24151:0.00035%,1.45709:0.00035%,-0.08551:0.00035%,1.46509:0.00017%,1.47576:0.00017%,-1.27347:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.13627%,1:20.77369%,5:18.27747%,4:17.57156%,2:17.23665%,0:0.00436%]
[INFO] ** service:[0.0048200000000000005:99.99826%,-211.73542999999998:0.00105%,-186.43601999999998:0.00035%,-211.08346:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.01069%,9:26.13732%,7:18.27782%,1:17.57226%,14:0.0007%,21:0.00035%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1570 (0.27372%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0049 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0031 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0079 - tp: 79911.0000 - fp: 89.0000 - tn: 319911.0000 - fn: 89.0000 - accuracy: 0.9996 - precision: 0.9989 - recall: 0.9989 - auc: 0.9997 - val_loss: 0.9420 - val_tp: 16355.0000 - val_fp: 3645.0000 - val_tn: 76355.0000 - val_fn: 3645.0000 - val_accuracy: 0.9271 - val_precision: 0.8177 - val_recall: 0.8177 - val_auc: 0.9554
[INFO] saving weights to checkpoints/lstm-epoch-4-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0140 - tp: 79699.0000 - fp: 301.0000 - tn: 319699.0000 - fn: 301.0000 - accuracy: 0.9985 - precision: 0.9962 - recall: 0.9962 - auc: 0.9998 - val_loss: 2.8355e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.4584e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1650e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9216e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7697e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 10-10/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99634%,30:0.00174%,31:0.00035%,26:0.00017%,24:0.00017%,23:0.00017%,22:0.00017%,18:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:94.67403%,Single Stage Single Point:5.32597%]
[INFO] ** dst:[21:43.4118%,10:20.80769%,8:18.2222%,9:17.55447%,15:0.00174%,22:0.00052%,24:0.00035%,19:0.00035%,18:0.00035%,26:0.00017%,25:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99843%,0:0.00157%]
[INFO] ** i/f_name:[2:99.99826%,3:0.00174%]
[INFO] ** modbus_function_code:[0.02961:99.99634%,-33.760870000000004:0.00349%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99895%,11:49.99738%,0:0.00349%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.9993%,1:0.0007%]
[INFO] ** proto:[0:99.99738%,1:0.00174%,2:0.00087%]
[INFO] ** proxy_src_ip:[18:38.08426%,20:26.13575%,13:18.22238%,6:17.55378%,17:0.00174%,10:0.00087%,14:0.00035%,21:0.00017%,16:0.00017%,5:0.00017%,2:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.13505%,-0.32151:20.80769%,-1.27613:18.22185%,-0.23351:17.55343%,-0.33484:17.27657%,-71.33197:0.00174%,-10.51843:0.0007%,-0.08551:0.00035%,-1.27347:0.00035%,5.71692:0.00035%,1.47576:0.00035%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-71.14931:0.00017%,-64.19493:0.00017%,1.45709:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.1347%,1:20.80752%,5:18.22185%,4:17.55325%,2:17.2764%,0:0.00628%]
[INFO] ** service:[0.0048200000000000005:99.99704%,-211.73542999999998:0.00174%,-211.07873999999998:0.00035%,-186.43601999999998:0.00035%,-211.08346:0.00017%,-186.44547:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.08426%,9:26.13575%,7:18.22238%,1:17.55378%,14:0.00174%,11:0.00087%,2:0.00035%,17:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%]
[INFO] ** type:[0:99.99861%,1:0.00122%,2:0.00017%]
[INFO] ** unixtime:1567 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6158e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5351e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4265e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3492e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2773 - tp: 70323.0000 - fp: 9677.0000 - tn: 310323.0000 - fn: 9677.0000 - accuracy: 0.9516 - precision: 0.8790 - recall: 0.8790 - auc: 0.9860 - val_loss: 0.3779 - val_tp: 12820.0000 - val_fp: 7180.0000 - val_tn: 72820.0000 - val_fn: 7180.0000 - val_accuracy: 0.8564 - val_precision: 0.6410 - val_recall: 0.6410 - val_auc: 0.9677
[INFO] saving weights to checkpoints/lstm-epoch-4-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2496 - tp: 65818.0000 - fp: 14182.0000 - tn: 305818.0000 - fn: 14182.0000 - accuracy: 0.9291 - precision: 0.8227 - recall: 0.8227 - auc: 0.9842 - val_loss: 0.2381 - val_tp: 19308.0000 - val_fp: 692.0000 - val_tn: 79308.0000 - val_fn: 692.0000 - val_accuracy: 0.9862 - val_precision: 0.9654 - val_recall: 0.9654 - val_auc: 0.9976
[INFO] saving weights to checkpoints/lstm-epoch-4-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0139 - tp: 79975.0000 - fp: 25.0000 - tn: 319975.0000 - fn: 25.0000 - accuracy: 0.9999 - precision: 0.9997 - recall: 0.9997 - auc: 1.0000 - val_loss: 2.8871e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 11-11/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99895%,31:0.00035%,30:0.00035%,26:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.39314%,10:20.87411%,8:18.19344%,9:17.53704%,22:0.00122%,18:0.00035%,15:0.00035%,25:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99965%,0:0.00035%]
[INFO] ** i/f_name:[2:99.99965%,3:0.00035%]
[INFO] ** modbus_function_code:[0.02961:99.99895%,-33.760870000000004:0.00105%]
[INFO] ** modbus_function_description:[7:50.00052%,11:49.99843%,0:0.00105%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99895%,2:0.0007%,1:0.00035%]
[INFO] ** proxy_src_ip:[18:38.15069%,20:26.11692%,13:18.19344%,6:17.53739%,16:0.00052%,17:0.00035%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.1164%,-0.32151:20.87411%,-1.27613:18.19326%,-0.23351:17.53686%,-0.33484:17.27657%,-0.24151:0.00052%,-1.02014:0.00052%,-0.08551:0.00035%,-71.33197:0.00035%,-71.14798:0.00017%,1.45709:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:26.11605%,1:20.87394%,5:18.19309%,4:17.53652%,2:17.2764%,0:0.00401%]
[INFO] ** service:[0.0048200000000000005:99.99895%,-211.73542999999998:0.00035%,-186.43601999999998:0.00035%,-211.08346:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.15069%,9:26.11692%,7:18.19344%,1:17.53739%,15:0.00052%,14:0.00035%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1568 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0852e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4011e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1262e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.3428e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.9196e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.8107e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7596e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8206e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.2922e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8600e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 12-12/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99791%,30:0.00192%,9:0.00017%]
[INFO] ** classification:[normal:93.6904%,Single Stage Single Point:6.3096%]
[INFO] ** dst:[21:43.40657%,10:20.8851%,8:18.17635%,9:17.52902%,15:0.00192%,22:0.00052%,24:0.00035%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99843%,0:0.00157%]
[INFO] ** i/f_name:[2:99.99808%,3:0.00192%]
[INFO] ** modbus_function_code:[0.02961:99.99791%,-33.760870000000004:0.00209%]
[INFO] ** modbus_function_description:[7:49.99965%,11:49.99826%,0:0.00209%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99843%,2:0.00157%]
[INFO] ** proto:[0:99.99808%,1:0.00192%]
[INFO] ** proxy_src_ip:[18:38.15871%,20:26.13331%,13:18.17652%,6:17.52919%,17:0.00192%,16:0.00017%,1:0.00017%]
[INFO] ** s_port:[1.45442:26.13279%,-0.32151:20.8851%,-1.27613:18.176%,-0.23351:17.52884%,-0.33484:17.27361%,-71.33197:0.00192%,-1.27347:0.00035%,1.45709:0.00017%,-0.24950999999999998:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,14.4699:0.00017%]
[INFO] ** scada_tag:[3:26.13244%,1:20.8851%,5:18.176%,4:17.5285%,2:17.27361%,0:0.00436%]
[INFO] ** service:[0.0048200000000000005:99.99791%,-211.73542999999998:0.00192%,-183.8612:0.00017%]
[INFO] ** src:[22:38.15871%,9:26.13331%,7:18.17652%,1:17.52919%,21:0.00157%,14:0.00035%,15:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1568 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.6483e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2104e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9513e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6926e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.2024 - tp: 74390.0000 - fp: 5610.0000 - tn: 314390.0000 - fn: 5610.0000 - accuracy: 0.9720 - precision: 0.9299 - recall: 0.9299 - auc: 0.9918 - val_loss: 0.6040 - val_tp: 12841.0000 - val_fp: 7159.0000 - val_tn: 72841.0000 - val_fn: 7159.0000 - val_accuracy: 0.8568 - val_precision: 0.6421 - val_recall: 0.6421 - val_auc: 0.9680
[INFO] saving weights to checkpoints/lstm-epoch-4-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.1853 - tp: 73858.0000 - fp: 6142.0000 - tn: 313858.0000 - fn: 6142.0000 - accuracy: 0.9693 - precision: 0.9232 - recall: 0.9232 - auc: 0.9938 - val_loss: 0.6256 - val_tp: 12854.0000 - val_fp: 7146.0000 - val_tn: 72854.0000 - val_fn: 7146.0000 - val_accuracy: 0.8571 - val_precision: 0.6427 - val_recall: 0.6427 - val_auc: 0.9681
[INFO] saving weights to checkpoints/lstm-epoch-4-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0344 - tp: 78566.0000 - fp: 1434.0000 - tn: 318566.0000 - fn: 1434.0000 - accuracy: 0.9928 - precision: 0.9821 - recall: 0.9821 - auc: 0.9998 - val_loss: 0.0015 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 13-13/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99651%,31:0.0007%,30:0.00052%,26:0.00052%,0:0.00052%,22:0.00035%,27:0.00017%,24:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:86.66059%,Single Stage Single Point:13.33941%]
[INFO] ** dst:[21:43.35653%,10:20.80368%,8:18.27695%,9:17.55883%,22:0.00105%,6:0.00087%,18:0.0007%,25:0.00052%,15:0.00052%,24:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.99965%,0:0.00035%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.99651%,-33.760870000000004:0.00331%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99878%,11:49.99773%,0:0.00331%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99721%,2:0.00227%,1:0.00052%]
[INFO] ** proxy_src_ip:[18:38.05027%,20:26.1103%,13:18.27712%,6:17.55831%,10:0.00105%,11:0.00087%,17:0.00052%,16:0.00052%,7:0.00035%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.10977%,-0.32151:20.80368%,-1.27613:18.27677%,-0.23351:17.55796%,-0.33484:17.24659%,-9.78512:0.0007%,-64.19493:0.00052%,-1.02014:0.00052%,-71.14798:0.00052%,-71.33197:0.00052%,-0.24151:0.00035%,-71.14931:0.00035%,-0.08551:0.00035%,1.47576:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-1.2708:0.00017%,-68.79874000000001:0.00017%,6.1115699999999995:0.00017%,14.540560000000001:0.00017%,1.45709:0.00017%]
[INFO] ** scada_tag:[3:26.10942%,1:20.80351%,5:18.27677%,4:17.55796%,2:17.24641%,0:0.00593%]
[INFO] ** service:[0.0048200000000000005:99.99721%,-186.43601999999998:0.0007%,-211.08346:0.00052%,-186.44547:0.00052%,-211.73542999999998:0.00052%,-211.08818:0.00035%,-202.75898:0.00017%]
[INFO] ** src:[22:38.05027%,9:26.1103%,7:18.27712%,1:17.55831%,11:0.00105%,10:0.00087%,15:0.00052%,14:0.00052%,21:0.00035%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99965%,2:0.00017%,1:0.00017%]
[INFO] ** unixtime:1567 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0010 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.9181e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.2031e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.0499e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.2433e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5655e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2456 - tp: 72770.0000 - fp: 7230.0000 - tn: 312770.0000 - fn: 7230.0000 - accuracy: 0.9639 - precision: 0.9096 - recall: 0.9096 - auc: 0.9883 - val_loss: 0.5097 - val_tp: 12841.0000 - val_fp: 7159.0000 - val_tn: 72841.0000 - val_fn: 7159.0000 - val_accuracy: 0.8568 - val_precision: 0.6421 - val_recall: 0.6421 - val_auc: 0.9680
[INFO] saving weights to checkpoints/lstm-epoch-4-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0430 - tp: 77927.0000 - fp: 2073.0000 - tn: 317927.0000 - fn: 2073.0000 - accuracy: 0.9896 - precision: 0.9741 - recall: 0.9741 - auc: 0.9997 - val_loss: 0.0016 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 14-14/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99895%,31:0.00035%,30:0.00035%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:92.37272%,Single Stage Single Point:7.62728%]
[INFO] ** dst:[21:43.35392%,10:20.80856%,8:18.26474%,9:17.57069%,22:0.0007%,24:0.00035%,18:0.00035%,15:0.00035%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99983%,0:0.00017%]
[INFO] ** i/f_name:[2:99.99965%,3:0.00035%]
[INFO] ** modbus_function_code:[0.02961:99.99895%,-33.760870000000004:0.00105%]
[INFO] ** modbus_function_description:[7:50.00035%,11:49.99861%,0:0.00105%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99913%,2:0.00052%,1:0.00035%]
[INFO] ** proxy_src_ip:[18:38.05253%,20:26.11047%,13:18.26492%,6:17.57086%,17:0.00035%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.10977%,-0.32151:20.80856%,-1.27613:18.26439%,-0.23351:17.57051%,-0.33484:17.24397%,-1.27347:0.00035%,-0.08551:0.00035%,-71.33197:0.00035%,1.45709:0.00035%,1.47576:0.00017%,1.46509:0.00017%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,-0.24950999999999998:0.00017%,14.4699:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.10942%,1:20.80856%,5:18.26422%,4:17.57016%,2:17.2438%,0:0.00384%]
[INFO] ** service:[0.0048200000000000005:99.99895%,-211.73542999999998:0.00035%,-186.43601999999998:0.00035%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.05253%,9:26.11047%,7:18.26492%,1:17.57086%,14:0.00035%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1567 (0.27319%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0011 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.7800e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3011 - tp: 70567.0000 - fp: 9433.0000 - tn: 310567.0000 - fn: 9433.0000 - accuracy: 0.9528 - precision: 0.8821 - recall: 0.8821 - auc: 0.9837 - val_loss: 0.1172 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0074 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6642e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.9481e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4822e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2441e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0213e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 15-15/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (573586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (573586, 17)

[INFO] analyzing data
[INFO] 573586 rows
[INFO] ** appi_name:[21:99.99634%,30:0.00296%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:90.3711%,Single Stage Multi Point:9.6282%,Single Stage Single Point:0.0007%]
[INFO] ** dst:[21:43.30528%,10:20.77666%,8:18.31112%,9:17.60172%,15:0.00296%,22:0.00157%,25:0.00017%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99721%,0:0.00279%]
[INFO] ** i/f_name:[2:99.99704%,3:0.00296%]
[INFO] ** modbus_function_code:[0.02961:99.99634%,-33.760870000000004:0.00366%]
[INFO] ** modbus_function_description:[7:49.99913%,11:49.99721%,0:0.00366%]
[INFO] ** modbus_transaction_id:65536 (11.42566%)
[INFO] ** orig:[0:99.99738%,2:0.00262%]
[INFO] ** proto:[0:99.99669%,1:0.00296%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.00999%,20:26.07264%,13:18.31077%,6:17.60224%,17:0.00296%,16:0.0007%,7:0.00035%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.07177%,-0.32151:20.77648%,-1.27613:18.31059%,-0.23351:17.60155%,-0.33484:17.23351%,-71.33197:0.00296%,-1.02014:0.0007%,-0.24151:0.00052%,1.46509:0.00035%,1.45709:0.00035%,1.47576:0.00017%,-1.27347:0.00017%,-0.24950999999999998:0.00017%,-61.95768:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.07142%,1:20.77631%,5:18.31059%,4:17.6012%,2:17.23316%,0:0.00732%]
[INFO] ** service:[0.0048200000000000005:99.99651%,-211.73542999999998:0.00296%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.00999%,9:26.07264%,7:18.31077%,1:17.60224%,21:0.00296%,15:0.0007%,14:0.00035%,16:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1576 (0.27476%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0593e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.3660e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0723e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.8439e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.3161e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7942e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.3430e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.7645e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/573586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3013 - tp: 68578.0000 - fp: 11422.0000 - tn: 308578.0000 - fn: 11422.0000 - accuracy: 0.9429 - precision: 0.8572 - recall: 0.8572 - auc: 0.9108 - val_loss: 7.5377 - val_tp: 10647.0000 - val_fp: 9353.0000 - val_tn: 70647.0000 - val_fn: 9353.0000 - val_accuracy: 0.8129 - val_precision: 0.5324 - val_recall: 0.5324 - val_auc: 0.7077
[INFO] saving weights to checkpoints/lstm-epoch-4-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/573586
[33m[INFO] loading file 16-16/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513276, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513276, 17)

[INFO] analyzing data
[INFO] 513276 rows
[INFO] ** appi_name:[21:99.99805%,30:0.00175%,33:0.00019%]
[INFO] ** classification:[normal:79.94062%,Single Stage Multi Point:20.05938%]
[INFO] ** dst:[21:43.34276%,10:20.79486%,8:18.26152%,9:17.59774%,15:0.00175%,22:0.00117%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99825%,0:0.00175%]
[INFO] ** i/f_name:[2:99.99825%,3:0.00175%]
[INFO] ** modbus_function_code:[0.02961:99.99805%,-33.760870000000004:0.00195%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99805%,0:0.00195%]
[INFO] ** modbus_transaction_id:65536 (12.76818%)
[INFO] ** orig:[0:99.99825%,2:0.00175%]
[INFO] ** proto:[0:99.99825%,1:0.00175%]
[INFO] ** proxy_src_ip:[18:38.04035%,20:26.09746%,13:18.26191%,6:17.59794%,17:0.00175%,16:0.00039%,21:0.00019%]
[INFO] ** s_port:[1.45442:26.09688%,-0.32151:20.79466%,-1.27613:18.26152%,-0.23351:17.59755%,-0.33484:17.24569%,-71.33197:0.00175%,1.45709:0.00039%,-0.24151:0.00039%,-1.02014:0.00039%,-1.27347:0.00019%,1.47576:0.00019%,-49.275529999999996:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.09649%,1:20.79447%,5:18.26133%,4:17.59716%,2:17.2455%,0:0.00507%]
[INFO] ** service:[0.0048200000000000005:99.99825%,-211.73542999999998:0.00175%]
[INFO] ** src:[22:38.04035%,9:26.09746%,7:18.26191%,1:17.59794%,21:0.00175%,15:0.00039%,4:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1406 (0.27393%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5501 - tp: 42526.0000 - fp: 37474.0000 - tn: 282526.0000 - fn: 37474.0000 - accuracy: 0.8126 - precision: 0.5316 - recall: 0.5316 - auc: 0.7072 - val_loss: 7.5812 - val_tp: 10593.0000 - val_fp: 9407.0000 - val_tn: 70593.0000 - val_fn: 9407.0000 - val_accuracy: 0.8119 - val_precision: 0.5296 - val_recall: 0.5296 - val_auc: 0.7060
[INFO] saving weights to checkpoints/lstm-epoch-4-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5461 - tp: 42546.0000 - fp: 37454.0000 - tn: 282546.0000 - fn: 37454.0000 - accuracy: 0.8127 - precision: 0.5318 - recall: 0.5318 - auc: 0.7074 - val_loss: 7.5465 - val_tp: 10636.0000 - val_fp: 9364.0000 - val_tn: 70636.0000 - val_fn: 9364.0000 - val_accuracy: 0.8127 - val_precision: 0.5318 - val_recall: 0.5318 - val_auc: 0.7074
[INFO] saving weights to checkpoints/lstm-epoch-4-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8659 - tp: 70739.0000 - fp: 9261.0000 - tn: 310739.0000 - fn: 9261.0000 - accuracy: 0.9537 - precision: 0.8842 - recall: 0.8842 - auc: 0.9276 - val_loss: 2.8046e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.5545e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3493e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1747e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9968e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-15-16-batch-400000-500000
[INFO] processing batch 500000-600000/513276
[33m[INFO] loading file 17-17/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513276, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513276, 17)

[INFO] analyzing data
[INFO] 513276 rows
[INFO] ** appi_name:[21:99.99708%,7:0.00058%,26:0.00039%,0:0.00039%,31:0.00019%,27:0.00019%,24:0.00019%,22:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:93.98959%,Multi Stage Multi Point:6.01041%]
[INFO] ** dst:[21:43.34802%,10:20.85038%,8:18.2019%,9:17.59658%,22:0.00078%,6:0.00058%,25:0.00039%,16:0.00039%,2:0.00039%,24:0.00019%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99708%,-33.760870000000004:0.00273%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99961%,11:49.99747%,0:0.00273%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.76818%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99864%,2:0.00136%]
[INFO] ** proxy_src_ip:[18:38.08633%,20:26.11285%,13:18.20132%,6:17.59638%,10:0.00117%,11:0.00097%,1:0.00039%,16:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.11188%,-0.32151:20.85038%,-1.27613:18.20093%,-0.23351:17.59619%,-0.33484:17.23595%,6.0369:0.00078%,-64.19493:0.00039%,1.47576:0.00039%,-71.14798:0.00039%,1.45709:0.00039%,-3.3787199999999995:0.00019%,-68.79874000000001:0.00019%,-1.27347:0.00019%,1.46509:0.00019%,8.55414:0.00019%,6.06224:0.00019%,-4.3880099999999995:0.00019%,-0.24151:0.00019%,-71.14931:0.00019%,-1.02014:0.00019%,6.15557:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.11168%,1:20.85019%,5:18.20073%,4:17.5958%,2:17.23595%,0:0.00565%]
[INFO] ** service:[0.0048200000000000005:99.99786%,-211.09762999999998:0.00058%,-186.44547:0.00039%,-211.08346:0.00039%,-186.43601999999998:0.00019%,-211.35747999999998:0.00019%,-211.08818:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.08633%,9:26.11285%,7:18.20132%,1:17.59638%,11:0.00117%,10:0.00097%,3:0.00039%,21:0.00019%,15:0.00019%,2:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1403 (0.27334%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.7320e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6904e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 9.3546e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4536e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3855e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2975 - val_tp: 18390.0000 - val_fp: 1610.0000 - val_tn: 78390.0000 - val_fn: 1610.0000 - val_accuracy: 0.9678 - val_precision: 0.9195 - val_recall: 0.9195 - val_auc: 0.9497
[INFO] saving weights to checkpoints/lstm-epoch-4-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9367 - tp: 65424.0000 - fp: 14576.0000 - tn: 305424.0000 - fn: 14576.0000 - accuracy: 0.9271 - precision: 0.8178 - recall: 0.8178 - auc: 0.8861 - val_loss: 2.8997 - val_tp: 16402.0000 - val_fp: 3598.0000 - val_tn: 76402.0000 - val_fn: 3598.0000 - val_accuracy: 0.9280 - val_precision: 0.8201 - val_recall: 0.8201 - val_auc: 0.8876
[INFO] saving weights to checkpoints/lstm-epoch-4-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.2295 - tp: 68934.0000 - fp: 11066.0000 - tn: 308934.0000 - fn: 11066.0000 - accuracy: 0.9447 - precision: 0.8617 - recall: 0.8617 - auc: 0.9135 - val_loss: 1.0774e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/513276
[33m[INFO] loading file 18-18/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513276, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513276, 17)

[INFO] analyzing data
[INFO] 513276 rows
[INFO] ** appi_name:[21:99.99805%,30:0.00058%,7:0.00058%,31:0.00019%,27:0.00019%,22:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:81.10218%,Multi Stage Multi Point:18.89782%]
[INFO] ** dst:[21:43.34413%,10:20.82661%,8:18.26678%,9:17.55936%,22:0.00078%,15:0.00058%,24:0.00039%,16:0.00039%,2:0.00039%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99942%,0:0.00058%]
[INFO] ** i/f_name:[2:99.99942%,3:0.00058%]
[INFO] ** modbus_function_code:[0.02961:99.99805%,-33.760870000000004:0.00195%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99786%,0:0.00195%]
[INFO] ** modbus_transaction_id:65536 (12.76818%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99883%,2:0.00058%,1:0.00058%]
[INFO] ** proxy_src_ip:[18:38.0686%,20:26.10272%,13:18.26717%,6:17.55956%,17:0.00058%,11:0.00058%,1:0.00039%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.10194%,-0.32151:20.82661%,-1.27613:18.26659%,-0.23351:17.55917%,-0.33484:17.24199%,-71.33197:0.00058%,1.45709:0.00039%,-0.24151:0.00039%,-1.27347:0.00039%,-1.2708:0.00019%,-71.14931:0.00019%,6.45955:0.00019%,-2.48275:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-3.3787199999999995:0.00019%,3.6236699999999997:0.00019%,6.06224:0.00019%,8.10082:0.00019%]
[INFO] ** scada_tag:[3:26.10155%,1:20.82642%,5:18.26639%,4:17.55897%,2:17.2418%,0:0.00487%]
[INFO] ** service:[0.0048200000000000005:99.99805%,-211.09762999999998:0.00058%,-211.73542999999998:0.00058%,-186.43601999999998:0.00019%,-211.35747999999998:0.00019%,-211.08818:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.0686%,9:26.10272%,7:18.26717%,1:17.55956%,14:0.00058%,10:0.00058%,3:0.00039%,21:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1403 (0.27334%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.6145 - tp: 62060.0000 - fp: 17940.0000 - tn: 302060.0000 - fn: 17940.0000 - accuracy: 0.9103 - precision: 0.7757 - recall: 0.7757 - auc: 0.8598 - val_loss: 6.1023 - val_tp: 12428.0000 - val_fp: 7572.0000 - val_tn: 72428.0000 - val_fn: 7572.0000 - val_accuracy: 0.8486 - val_precision: 0.6214 - val_recall: 0.6214 - val_auc: 0.7634
[INFO] saving weights to checkpoints/lstm-epoch-4-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.1235 - tp: 49607.0000 - fp: 30393.0000 - tn: 289607.0000 - fn: 30393.0000 - accuracy: 0.8480 - precision: 0.6201 - recall: 0.6201 - auc: 0.7626 - val_loss: 6.1587 - val_tp: 12358.0000 - val_fp: 7642.0000 - val_tn: 72358.0000 - val_fn: 7642.0000 - val_accuracy: 0.8472 - val_precision: 0.6179 - val_recall: 0.6179 - val_auc: 0.7612
[INFO] saving weights to checkpoints/lstm-epoch-4-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.1261 - tp: 49594.0000 - fp: 30406.0000 - tn: 289594.0000 - fn: 30406.0000 - accuracy: 0.8480 - precision: 0.6199 - recall: 0.6199 - auc: 0.7625 - val_loss: 2.4540 - val_tp: 16955.0000 - val_fp: 3045.0000 - val_tn: 76955.0000 - val_fn: 3045.0000 - val_accuracy: 0.9391 - val_precision: 0.8478 - val_recall: 0.8478 - val_auc: 0.9048
[INFO] saving weights to checkpoints/lstm-epoch-4-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.2012e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.7816e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.3905e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.0114e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/513276
[33m[INFO] loading file 19-19/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513276, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513276, 17)

[INFO] analyzing data
[INFO] 513276 rows
[INFO] ** appi_name:[21:99.99786%,26:0.00039%,0:0.00039%,31:0.00019%,27:0.00019%,24:0.00019%,22:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:86.05818%,Single Stage Multi Point:13.94182%]
[INFO] ** dst:[21:43.38075%,10:20.82895%,8:18.21437%,9:17.573%,22:0.00136%,6:0.00058%,25:0.00039%,24:0.00019%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99786%,-33.760870000000004:0.00195%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99786%,0:0.00195%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.76818%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99864%,2:0.00136%]
[INFO] ** proxy_src_ip:[18:38.11828%,20:26.09142%,13:18.21457%,6:17.573%,10:0.00117%,11:0.00097%,16:0.00058%]
[INFO] ** s_port:[1.45442:26.09045%,-0.32151:20.82895%,-1.27613:18.21418%,-0.23351:17.57281%,-0.33484:17.28933%,-5.20264:0.00078%,1.45709:0.00058%,-1.02014:0.00058%,-64.19493:0.00039%,-71.14798:0.00039%,-1.27347:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-71.14931:0.00019%,1.46509:0.00019%,-68.79874000000001:0.00019%,-1.2708:0.00019%,0.75578:0.00019%]
[INFO] ** scada_tag:[3:26.09006%,1:20.82875%,5:18.21398%,4:17.57261%,2:17.28933%,0:0.00526%]
[INFO] ** service:[0.0048200000000000005:99.99864%,-186.44547:0.00039%,-211.08346:0.00039%,-186.43601999999998:0.00019%,-211.08818:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.11828%,9:26.09142%,7:18.21457%,1:17.573%,11:0.00117%,10:0.00097%,15:0.00058%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1404 (0.27354%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.4000e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.3150e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.9626e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.6843e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.3624e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.0801e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.3824 - tp: 53285.0000 - fp: 26715.0000 - tn: 293285.0000 - fn: 26715.0000 - accuracy: 0.8664 - precision: 0.6661 - recall: 0.6661 - auc: 0.7913 - val_loss: 9.8530 - val_tp: 7774.0000 - val_fp: 12226.0000 - val_tn: 67774.0000 - val_fn: 12226.0000 - val_accuracy: 0.7555 - val_precision: 0.3887 - val_recall: 0.3887 - val_auc: 0.6179
[INFO] saving weights to checkpoints/lstm-epoch-4-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 6.5720 - tp: 47381.0000 - fp: 32619.0000 - tn: 287381.0000 - fn: 32619.0000 - accuracy: 0.8369 - precision: 0.5923 - recall: 0.5923 - auc: 0.7452 - val_loss: 4.3986e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/513276
[33m[INFO] loading file 20-20/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513276, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513276, 17)

[INFO] analyzing data
[INFO] 513276 rows
[INFO] ** appi_name:[21:99.9963%,30:0.00312%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:92.01619%,Single Stage Multi Point:7.98381%]
[INFO] ** dst:[21:43.42245%,10:20.8385%,8:18.16528%,9:17.56852%,15:0.00312%,22:0.00117%,24:0.00039%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99727%,0:0.00273%]
[INFO] ** i/f_name:[2:99.99688%,3:0.00312%]
[INFO] ** modbus_function_code:[0.02961:99.9963%,-33.760870000000004:0.0037%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99649%,0:0.0037%]
[INFO] ** modbus_transaction_id:65536 (12.76818%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9963%,1:0.00312%,2:0.00058%]
[INFO] ** proxy_src_ip:[18:38.1175%,20:26.14402%,13:18.16547%,6:17.56911%,17:0.00312%,14:0.00058%,16:0.00019%]
[INFO] ** s_port:[1.45442:26.14324%,-0.32151:20.8385%,-1.27613:18.16489%,-0.23351:17.56833%,-0.33484:17.27901%,-71.33197:0.00312%,-0.24151:0.00058%,1.45709:0.00039%,-1.27347:0.00039%,-1.2708:0.00019%,-1.02014:0.00019%,13.431270000000001:0.00019%,-71.14798:0.00019%,1.47576:0.00019%,-0.24950999999999998:0.00019%,11.862:0.00019%,1.46509:0.00019%]
[INFO] ** scada_tag:[3:26.14285%,1:20.8383%,5:18.16489%,4:17.56794%,2:17.27881%,0:0.00721%]
[INFO] ** service:[0.0048200000000000005:99.9963%,-211.73542999999998:0.00312%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.1175%,9:26.14402%,7:18.16547%,1:17.56911%,14:0.00312%,2:0.00058%,15:0.00019%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1403 (0.27334%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.3355 - tp: 78335.0000 - fp: 1665.0000 - tn: 318335.0000 - fn: 1665.0000 - accuracy: 0.9917 - precision: 0.9792 - recall: 0.9792 - auc: 0.9870 - val_loss: 2.9262 - val_tp: 16369.0000 - val_fp: 3631.0000 - val_tn: 76369.0000 - val_fn: 3631.0000 - val_accuracy: 0.9274 - val_precision: 0.8184 - val_recall: 0.8184 - val_auc: 0.8865
[INFO] saving weights to checkpoints/lstm-epoch-4-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.9424 - tp: 65396.0000 - fp: 14604.0000 - tn: 305396.0000 - fn: 14604.0000 - accuracy: 0.9270 - precision: 0.8174 - recall: 0.8174 - auc: 0.8859 - val_loss: 2.9609 - val_tp: 16326.0000 - val_fp: 3674.0000 - val_tn: 76326.0000 - val_fn: 3674.0000 - val_accuracy: 0.9265 - val_precision: 0.8163 - val_recall: 0.8163 - val_auc: 0.8852
[INFO] saving weights to checkpoints/lstm-epoch-4-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.9424 - tp: 65396.0000 - fp: 14604.0000 - tn: 305396.0000 - fn: 14604.0000 - accuracy: 0.9270 - precision: 0.8174 - recall: 0.8174 - auc: 0.8859 - val_loss: 2.2573 - val_tp: 17199.0000 - val_fp: 2801.0000 - val_tn: 77199.0000 - val_fn: 2801.0000 - val_accuracy: 0.9440 - val_precision: 0.8600 - val_recall: 0.8600 - val_auc: 0.9125
[INFO] saving weights to checkpoints/lstm-epoch-4-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9362e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7343e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/513276
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.5470e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3786e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/513276
[33m[INFO] loading file 21-21/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513274, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513274, 17)

[INFO] analyzing data
[INFO] 513274 rows
[INFO] ** appi_name:[21:99.9961%,30:0.00078%,7:0.00058%,26:0.00039%,22:0.00039%,0:0.00039%,31:0.00019%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:98.81097%,Multi Stage Single Point:1.18903%]
[INFO] ** dst:[21:43.30767%,10:20.99892%,8:18.16301%,9:17.52592%,22:0.00097%,15:0.00078%,6:0.00078%,25:0.00039%,24:0.00039%,16:0.00039%,2:0.00039%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name:[2:99.99922%,3:0.00078%]
[INFO] ** modbus_function_code:[0.02961:99.9961%,-33.760870000000004:0.0037%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99883%,11:49.99727%,0:0.0037%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.76823%)
[INFO] ** orig:[0:99.99922%,2:0.00078%]
[INFO] ** proto:[0:99.99766%,2:0.00156%,1:0.00078%]
[INFO] ** proxy_src_ip:[18:38.33352%,20:25.97287%,13:18.1632%,6:17.52592%,10:0.00117%,11:0.00097%,17:0.00078%,16:0.00058%,1:0.00039%,21:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.97229%,-0.32151:20.99814%,-1.27613:18.16281%,-0.23351:17.52573%,-0.33484:17.33538%,-6.64392:0.00078%,-71.33197:0.00078%,-1.02014:0.00058%,-1.27347:0.00039%,-71.14931:0.00039%,-71.14798:0.00039%,-64.19493:0.00039%,1.45709:0.00019%,-2.2440900000000004:0.00019%,-3.3787199999999995:0.00019%,-68.79874000000001:0.00019%,10.15141:0.00019%,1.46509:0.00019%,1.47576:0.00019%,7.060860000000001:0.00019%,-0.24151:0.00019%,6.62488:0.00019%]
[INFO] ** scada_tag:[3:25.9719%,1:20.99795%,5:18.16262%,4:17.52553%,2:17.33538%,0:0.00662%]
[INFO] ** service:[0.0048200000000000005:99.99688%,-211.73542999999998:0.00078%,-211.09762999999998:0.00058%,-186.44547:0.00039%,-211.08346:0.00039%,-211.08818:0.00039%,-186.43601999999998:0.00019%,-211.35747999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.33352%,9:25.97287%,7:18.1632%,1:17.52592%,11:0.00117%,21:0.00097%,10:0.00097%,15:0.00058%,3:0.00039%,4:0.00019%,2:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1398 (0.27237%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513274
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1582e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0346e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/513274
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8880e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7316e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/513274
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5833e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4403e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/513274
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2781e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1221e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/513274
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.5717e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.0807e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/513274
[33m[INFO] loading file 22-22/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (282315, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (282315, 17)

[INFO] analyzing data
[INFO] 282315 rows
[INFO] ** appi_name:[21:99.99221%,30:0.00673%,23:0.00035%,22:0.00035%,18:0.00035%]
[INFO] ** classification:[normal:53.04819%,Multi Stage Single Point:46.95181%]
[INFO] ** dst:[21:43.30907%,10:21.00703%,8:18.10177%,9:17.57292%,15:0.00673%,22:0.00142%,19:0.00071%,26:0.00035%]
[INFO] ** i/f_dir:[1:99.99362%,0:0.00638%]
[INFO] ** i/f_name:[2:99.99327%,3:0.00638%,0:0.00035%]
[INFO] ** modbus_function_code:[0.02961:99.99221%,-33.760870000000004:0.00779%]
[INFO] ** modbus_function_description:[7:49.99699%,11:49.99522%,0:0.00779%]
[INFO] ** modbus_transaction_id:65534 (23.21308%)
[INFO] ** orig:[0:99.99504%,2:0.00425%,1:0.00071%]
[INFO] ** proto:[0:99.99292%,1:0.00673%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.33023%,20:25.98693%,13:18.10106%,6:17.57399%,17:0.00673%,14:0.00071%,10:0.00035%]
[INFO] ** s_port:[1.45442:25.98587%,-0.32151:21.00703%,-1.27613:18.10106%,-0.23351:17.57292%,-0.33484:17.3232%,-71.33197:0.00673%,1.45709:0.00071%,-0.24151:0.00071%,7.228860000000001:0.00071%,-0.24950999999999998:0.00035%,1.46509:0.00035%,-71.14931:0.00035%]
[INFO] ** scada_tag:[3:25.98551%,1:21.00703%,5:18.10106%,4:17.57257%,2:17.3232%,0:0.01063%]
[INFO] ** service:[0.0048200000000000005:99.99221%,-211.73542999999998:0.00673%,-211.07873999999998:0.00071%,-211.08818:0.00035%]
[INFO] ** src:[22:38.33023%,9:25.98693%,7:18.10106%,1:17.57399%,21:0.00425%,14:0.00248%,2:0.00071%,11:0.00035%]
[INFO] ** type:[0:99.99787%,1:0.00213%]
[INFO] ** unixtime:779 (0.27593%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/282315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5354 - tp: 42599.0000 - fp: 37401.0000 - tn: 282599.0000 - fn: 37401.0000 - accuracy: 0.8130 - precision: 0.5325 - recall: 0.5325 - auc: 0.7078 - val_loss: 7.5763 - val_tp: 10599.0000 - val_fp: 9401.0000 - val_tn: 70599.0000 - val_fn: 9401.0000 - val_accuracy: 0.8120 - val_precision: 0.5300 - val_recall: 0.5300 - val_auc: 0.7062
[INFO] saving weights to checkpoints/lstm-epoch-4-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/282315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5910 - tp: 42323.0000 - fp: 37677.0000 - tn: 282323.0000 - fn: 37677.0000 - accuracy: 0.8116 - precision: 0.5290 - recall: 0.5290 - auc: 0.7056 - val_loss: 7.5997 - val_tp: 10570.0000 - val_fp: 9430.0000 - val_tn: 70570.0000 - val_fn: 9430.0000 - val_accuracy: 0.8114 - val_precision: 0.5285 - val_recall: 0.5285 - val_auc: 0.7053
[INFO] saving weights to checkpoints/lstm-epoch-4-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/282315
[33m[INFO] loading file 23-23/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582315, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582315, 17)

[INFO] analyzing data
[INFO] 582315 rows
[INFO] ** appi_name:[21:99.99828%,30:0.00103%,31:0.00034%,33:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:91.81234%,Multi Stage Single Point:8.18766%]
[INFO] ** dst:[21:43.32397%,10:20.99809%,8:18.14053%,9:17.5345%,22:0.00103%,15:0.00103%,24:0.00034%,18:0.00034%,25:0.00017%]
[INFO] ** i/f_dir:[1:99.99897%,0:0.00103%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.99828%,-33.760870000000004:0.00172%]
[INFO] ** modbus_function_description:[7:50.00009%,11:49.9982%,0:0.00172%]
[INFO] ** modbus_transaction_id:65536 (11.25439%)
[INFO] ** orig:[0:99.99948%,2:0.00052%]
[INFO] ** proto:[0:99.99845%,1:0.00103%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.33561%,20:25.98697%,13:18.14053%,6:17.53467%,17:0.00103%,16:0.00052%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.98611%,-0.32151:20.99791%,-1.27613:18.14001%,-0.23351:17.53432%,-0.33484:17.3377%,-71.33197:0.00103%,-1.02014:0.00052%,-0.08551:0.00034%,-1.27347:0.00034%,1.45709:0.00034%,1.46509:0.00034%,-0.24151:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:25.98576%,1:20.99791%,5:18.13984%,4:17.53415%,2:17.33752%,0:0.00481%]
[INFO] ** service:[0.0048200000000000005:99.99845%,-211.73542999999998:0.00103%,-186.43601999999998:0.00034%,-186.44547:0.00017%]
[INFO] ** src:[22:38.33561%,9:25.98697%,7:18.14053%,1:17.53467%,21:0.00052%,15:0.00052%,14:0.00052%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1586 (0.27236%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5670 - tp: 42442.0000 - fp: 37558.0000 - tn: 282442.0000 - fn: 37558.0000 - accuracy: 0.8122 - precision: 0.5305 - recall: 0.5305 - auc: 0.7066 - val_loss: 7.5747 - val_tp: 10601.0000 - val_fp: 9399.0000 - val_tn: 70601.0000 - val_fn: 9399.0000 - val_accuracy: 0.8120 - val_precision: 0.5300 - val_recall: 0.5300 - val_auc: 0.7063
[INFO] saving weights to checkpoints/lstm-epoch-4-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1453 - tp: 79279.0000 - fp: 721.0000 - tn: 319279.0000 - fn: 721.0000 - accuracy: 0.9964 - precision: 0.9910 - recall: 0.9910 - auc: 0.9944 - val_loss: 4.0860e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.6754e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2367e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.0316e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8531e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6792e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5223e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/582315
[33m[INFO] loading file 24-24/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582315, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582315, 17)

[INFO] analyzing data
[INFO] 582315 rows
[INFO] ** appi_name:[21:99.99365%,30:0.00309%,26:0.00052%,31:0.00034%,27:0.00034%,22:0.00034%,0:0.00034%,24:0.00017%,23:0.00017%,19:0.00017%,18:0.00017%,16:0.00017%,15:0.00017%,11:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:95.62436%,Multi Stage Single Point:4.37564%]
[INFO] ** dst:[21:43.36897%,10:21.0089%,8:18.1%,9:17.51526%,15:0.00309%,22:0.0012%,6:0.00069%,25:0.00034%,24:0.00034%,19:0.00034%,18:0.00034%,7:0.00034%,26:0.00017%]
[INFO] ** i/f_dir:[1:99.99708%,0:0.00292%]
[INFO] ** i/f_name:[2:99.99691%,3:0.00309%]
[INFO] ** modbus_function_code:[0.02961:99.99365%,-33.760870000000004:0.00584%,-0.415:0.00017%,0.9188299999999999:0.00017%,0.47422:0.00017%]
[INFO] ** modbus_function_description:[7:49.9982%,11:49.99545%,0:0.00584%,15:0.00017%,10:0.00017%,2:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.25439%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.99502%,1:0.00309%,2:0.00189%]
[INFO] ** proxy_src_ip:[18:38.38575%,20:25.99315%,13:18.09983%,6:17.51458%,17:0.00309%,10:0.0012%,14:0.00086%,11:0.00086%,21:0.00034%,16:0.00034%]
[INFO] ** s_port:[1.45442:25.99212%,-0.32151:21.0089%,-1.27613:18.09948%,-0.23351:17.51389%,-0.33484:17.37685%,-71.33197:0.00309%,-9.58113:0.00069%,-71.14798:0.00052%,1.45709:0.00052%,-0.24950999999999998:0.00034%,-1.27347:0.00034%,-0.24151:0.00034%,-1.02014:0.00034%,-31.55091:0.00034%,7.6315100000000005:0.00034%,-71.14931:0.00034%,-64.19493:0.00034%,1.47576:0.00034%,-68.79874000000001:0.00017%,1.46509:0.00017%,7.4901800000000005:0.00017%,13.431270000000001:0.00017%,11.862:0.00017%]
[INFO] ** scada_tag:[3:25.99195%,1:21.0089%,5:18.09931%,4:17.51355%,2:17.37668%,0:0.00962%]
[INFO] ** service:[0.0048200000000000005:99.99468%,-211.73542999999998:0.00309%,-211.08346:0.00052%,-211.07873999999998:0.00034%,-202.75898:0.00034%,-186.44547:0.00034%,-186.43601999999998:0.00034%,-211.08818:0.00034%]
[INFO] ** src:[22:38.38575%,9:25.99315%,7:18.09983%,1:17.51458%,14:0.00309%,11:0.0012%,10:0.00086%,2:0.00086%,15:0.00034%,4:0.00034%]
[INFO] ** type:[0:99.9988%,1:0.00086%,2:0.00034%]
[INFO] ** unixtime:1582 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.4685e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3484e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.2074e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1079e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0419e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9397e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.8682e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7882e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7353e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6762e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/582315
[33m[INFO] loading file 25-25/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582315, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582315, 17)

[INFO] analyzing data
[INFO] 582315 rows
[INFO] ** appi_name:[21:99.99657%,30:0.00103%,17:0.00069%,22:0.00052%,31:0.00034%,28:0.00017%,26:0.00017%,12:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** classification:[normal:65.00021%,Multi Stage Single Point:34.99979%]
[INFO] ** dst:[21:43.32535%,10:21.02968%,8:18.12696%,9:17.51389%,15:0.00103%,22:0.00086%,16:0.00069%,6:0.00069%,18:0.00034%,17:0.00034%,24:0.00017%]
[INFO] ** i/f_dir:[1:99.99897%,0:0.00103%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.99657%,-33.760870000000004:0.00343%]
[INFO] ** modbus_function_description:[7:49.99906%,11:49.99751%,0:0.00343%]
[INFO] ** modbus_transaction_id:65536 (11.25439%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99794%,2:0.00103%,1:0.00103%]
[INFO] ** proxy_src_ip:[18:38.39674%,20:25.95829%,13:18.12696%,6:17.51423%,17:0.00103%,1:0.00086%,21:0.00069%,16:0.00034%,14:0.00034%,7:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95777%,-0.32151:21.02934%,-1.27613:18.12662%,-0.23351:17.51372%,-0.33484:17.3674%,-71.33197:0.00103%,-71.14931:0.00052%,-49.275529999999996:0.00034%,-0.24151:0.00034%,-1.02014:0.00034%,-58.032509999999995:0.00017%,-5.08665:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,2.52505:0.00017%,-71.14798:0.00017%,-58.035180000000004:0.00017%,-1.2708:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.95743%,1:21.02917%,5:18.12644%,4:17.51355%,2:17.36723%,0:0.00618%]
[INFO] ** service:[0.0048200000000000005:99.99691%,-211.73542999999998:0.00103%,-205.44247:0.00069%,-211.08818:0.00052%,-186.43601999999998:0.00034%,-211.09762999999998:0.00017%,-211.08346:0.00017%,-185.9872:0.00017%]
[INFO] ** src:[22:38.39674%,9:25.95829%,7:18.12696%,1:17.51423%,14:0.00103%,3:0.00086%,4:0.00069%,21:0.00034%,15:0.00034%,2:0.00034%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1582 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.9696 - tp: 55334.0000 - fp: 24666.0000 - tn: 295334.0000 - fn: 24666.0000 - accuracy: 0.8767 - precision: 0.6917 - recall: 0.6917 - auc: 0.8073 - val_loss: 5.7582 - val_tp: 12855.0000 - val_fp: 7145.0000 - val_tn: 72855.0000 - val_fn: 7145.0000 - val_accuracy: 0.8571 - val_precision: 0.6428 - val_recall: 0.6428 - val_auc: 0.7767
[INFO] saving weights to checkpoints/lstm-epoch-4-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7523 - tp: 51449.0000 - fp: 28551.0000 - tn: 291449.0000 - fn: 28551.0000 - accuracy: 0.8572 - precision: 0.6431 - recall: 0.6431 - auc: 0.7769 - val_loss: 5.7445 - val_tp: 12872.0000 - val_fp: 7128.0000 - val_tn: 72872.0000 - val_fn: 7128.0000 - val_accuracy: 0.8574 - val_precision: 0.6436 - val_recall: 0.6436 - val_auc: 0.7772
[INFO] saving weights to checkpoints/lstm-epoch-4-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7491 - tp: 51465.0000 - fp: 28535.0000 - tn: 291465.0000 - fn: 28535.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.7771 - val_loss: 5.7453 - val_tp: 12871.0000 - val_fp: 7129.0000 - val_tn: 72871.0000 - val_fn: 7129.0000 - val_accuracy: 0.8574 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.7772
[INFO] saving weights to checkpoints/lstm-epoch-4-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.7463 - tp: 51479.0000 - fp: 28521.0000 - tn: 291479.0000 - fn: 28521.0000 - accuracy: 0.8574 - precision: 0.6435 - recall: 0.6435 - auc: 0.7772 - val_loss: 5.7276 - val_tp: 12893.0000 - val_fp: 7107.0000 - val_tn: 72893.0000 - val_fn: 7107.0000 - val_accuracy: 0.8579 - val_precision: 0.6446 - val_recall: 0.6446 - val_auc: 0.7779
[INFO] saving weights to checkpoints/lstm-epoch-4-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7570 - tp: 51426.0000 - fp: 28574.0000 - tn: 291426.0000 - fn: 28574.0000 - accuracy: 0.8571 - precision: 0.6428 - recall: 0.6428 - auc: 0.7768 - val_loss: 5.7630 - val_tp: 12849.0000 - val_fp: 7151.0000 - val_tn: 72849.0000 - val_fn: 7151.0000 - val_accuracy: 0.8570 - val_precision: 0.6424 - val_recall: 0.6424 - val_auc: 0.7765
[INFO] saving weights to checkpoints/lstm-epoch-4-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/582315
[33m[INFO] loading file 26-26/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (582315, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (582315, 17)

[INFO] analyzing data
[INFO] 582315 rows
[INFO] ** appi_name:[21:99.99828%,30:0.00052%,7:0.00052%,31:0.00017%,22:0.00017%,12:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:64.40191%,Single Stage Single Point:27.42708%,Multi Stage Single Point:8.17101%]
[INFO] ** dst:[21:43.30938%,10:21.09013%,8:18.11923%,9:17.47851%,22:0.00086%,15:0.00052%,24:0.00034%,16:0.00034%,2:0.00034%,18:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99948%,0:0.00052%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.99828%,-33.760870000000004:0.00172%]
[INFO] ** modbus_function_description:[7:49.99974%,11:49.99854%,0:0.00172%]
[INFO] ** modbus_transaction_id:65536 (11.25439%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99914%,1:0.00052%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.4699%,20:25.92978%,13:18.11957%,6:17.47868%,17:0.00052%,1:0.00052%,21:0.00034%,16:0.00034%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.92927%,-0.32151:21.08996%,-1.27613:18.11906%,-0.23351:17.47834%,-0.33484:17.37994%,-71.33197:0.00052%,-1.02014:0.00034%,-1.27347:0.00034%,-0.24151:0.00034%,-49.275529999999996:0.00017%,1.47576:0.00017%,1.45709:0.00017%,1.46509:0.00017%,-1.2708:0.00017%,14.191239999999999:0.00017%,2.52505:0.00017%,-3.3787199999999995:0.00017%,11.57001:0.00017%,-71.14931:0.00017%,7.66617:0.00017%]
[INFO] ** scada_tag:[3:25.92892%,1:21.08996%,5:18.11889%,4:17.47817%,2:17.37994%,0:0.00412%]
[INFO] ** service:[0.0048200000000000005:99.99845%,-211.09762999999998:0.00052%,-211.73542999999998:0.00052%,-211.35747999999998:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.4699%,9:25.92978%,7:18.11957%,1:17.47868%,14:0.00052%,3:0.00052%,15:0.00034%,4:0.00034%,21:0.00017%,2:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1581 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7378 - tp: 51521.0000 - fp: 28479.0000 - tn: 291521.0000 - fn: 28479.0000 - accuracy: 0.8576 - precision: 0.6440 - recall: 0.6440 - auc: 0.7775 - val_loss: 5.7356 - val_tp: 12883.0000 - val_fp: 7117.0000 - val_tn: 72883.0000 - val_fn: 7117.0000 - val_accuracy: 0.8577 - val_precision: 0.6442 - val_recall: 0.6442 - val_auc: 0.7776
[INFO] saving weights to checkpoints/lstm-epoch-4-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1020 - tp: 63740.0000 - fp: 13350.0000 - tn: 306650.0000 - fn: 16260.0000 - accuracy: 0.9260 - precision: 0.8268 - recall: 0.7968 - auc: 0.9488 - val_loss: 0.1816 - val_tp: 19987.0000 - val_fp: 12.0000 - val_tn: 79988.0000 - val_fn: 13.0000 - val_accuracy: 0.9997 - val_precision: 0.9994 - val_recall: 0.9994 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0130 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0032 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0025 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0019 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/582315
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0017 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0014 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/582315
[33m[INFO] loading file 27-27/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (522445, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (522445, 17)

[INFO] analyzing data
[INFO] 522445 rows
[INFO] ** appi_name:[21:99.99943%,30:0.00057%]
[INFO] ** classification:[normal:64.35816%,Single Stage Single Point:35.64184%]
[INFO] ** dst:[21:43.28838%,10:21.06806%,8:18.1711%,9:17.47093%,22:0.00077%,15:0.00057%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99943%,-33.760870000000004:0.00057%]
[INFO] ** modbus_function_description:[7:50.00048%,11:49.99895%,0:0.00057%]
[INFO] ** modbus_transaction_id:65536 (12.5441%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99943%,1:0.00057%]
[INFO] ** proxy_src_ip:[18:38.42089%,20:25.93613%,13:18.17091%,6:17.47112%,17:0.00057%,16:0.00038%]
[INFO] ** s_port:[1.45442:25.93555%,-0.32151:21.06806%,-1.27613:18.17072%,-0.23351:17.47074%,-0.33484:17.35283%,-71.33197:0.00057%,-1.02014:0.00038%,-1.27347:0.00019%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.93517%,1:21.06786%,5:18.17053%,4:17.47055%,2:17.35264%,0:0.00325%]
[INFO] ** service:[0.0048200000000000005:99.99943%,-211.73542999999998:0.00057%]
[INFO] ** src:[22:38.42089%,9:25.93613%,7:18.17091%,1:17.47112%,14:0.00057%,15:0.00038%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1419 (0.27161%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/522445
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 0.0044 - tp: 79957.0000 - fp: 43.0000 - tn: 319957.0000 - fn: 43.0000 - accuracy: 0.9998 - precision: 0.9995 - recall: 0.9995 - auc: 0.9998 - val_loss: 0.6739 - val_tp: 17810.0000 - val_fp: 2190.0000 - val_tn: 77810.0000 - val_fn: 2190.0000 - val_accuracy: 0.9562 - val_precision: 0.8905 - val_recall: 0.8905 - val_auc: 0.9413
[INFO] saving weights to checkpoints/lstm-epoch-4-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/522445
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 8s - loss: 0.0083 - tp: 79899.0000 - fp: 101.0000 - tn: 319899.0000 - fn: 101.0000 - accuracy: 0.9995 - precision: 0.9987 - recall: 0.9987 - auc: 0.9995 - val_loss: 0.0012 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/522445
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 0.0012 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.5480e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/522445
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 8.6436e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.7630e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/522445
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 7.1734e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.5576e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-26-27-batch-400000-500000
[INFO] processing batch 500000-600000/522445
[33m[INFO] loading file 28-28/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (356361, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (356361, 17)

[INFO] analyzing data
[INFO] 356361 rows
[INFO] ** appi_name:[21:99.99186%,30:0.00168%,17:0.0014%,22:0.00112%,7:0.00112%,31:0.00084%,26:0.00084%,28:0.00028%,27:0.00028%,8:0.00028%,0:0.00028%]
[INFO] ** classification:[normal:64.2994%,Single Stage Single Point:35.7006%]
[INFO] ** dst:[21:43.27718%,10:21.0138%,8:18.21383%,9:17.48648%,6:0.00224%,16:0.00196%,18:0.0014%,22:0.00056%,17:0.00056%,15:0.00056%,2:0.00056%,25:0.00028%,7:0.00028%,0:0.00028%]
[INFO] ** i/f_dir:[1:99.99944%,0:0.00056%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.99186%,-33.760870000000004:0.00814%]
[INFO] ** modbus_function_description:[11:49.99593%,7:49.99593%,0:0.00814%]
[INFO] ** modbus_transaction_id:65535 (18.39006%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99523%,2:0.00421%,1:0.00056%]
[INFO] ** proxy_src_ip:[18:38.32967%,20:25.96131%,13:18.21411%,6:17.48676%,1:0.00224%,17:0.00168%,14:0.00168%,7:0.0014%,21:0.00084%,0:0.00028%]
[INFO] ** s_port:[1.45442:25.96103%,-0.32151:21.0138%,-1.27613:18.21383%,-0.23351:17.4862%,-0.33484:17.31587%,-71.14798:0.00112%,-71.14931:0.00112%,-71.33197:0.00056%,-0.08551:0.00056%,-0.24151:0.00056%,7.66617:0.00028%,-58.035180000000004:0.00028%,-1.2708:0.00028%,-64.19493:0.00028%,-5.1466400000000005:0.00028%,13.431270000000001:0.00028%,11.57001:0.00028%,14.4699:0.00028%,1.47576:0.00028%,14.191239999999999:0.00028%,-5.08665:0.00028%,10.192739999999999:0.00028%,-3.3787199999999995:0.00028%,6.1115699999999995:0.00028%,2.05573:0.00028%,-43.76509:0.00028%,2.52505:0.00028%,11.862:0.00028%,-58.032509999999995:0.00028%]
[INFO] ** scada_tag:[3:25.96103%,1:21.0138%,5:18.21383%,4:17.48592%,2:17.31587%,0:0.00954%]
[INFO] ** service:[0.0048200000000000005:99.99186%,-205.44247:0.0014%,-186.43601999999998:0.0014%,-211.09762999999998:0.00112%,-211.08346:0.00112%,-211.08818:0.00112%,-211.73542999999998:0.00056%,-186.44547:0.00028%,-183.8612:0.00028%,-185.9872:0.00028%,-211.35747999999998:0.00028%,-202.75898:0.00028%]
[INFO] ** src:[22:38.32967%,9:25.96131%,7:18.21411%,1:17.48676%,3:0.00253%,2:0.00168%,21:0.0014%,4:0.00112%,14:0.00056%,8:0.00056%,17:0.00028%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:969 (0.27192%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/356361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.8010e-04 - tp: 79996.0000 - fp: 4.0000 - tn: 319996.0000 - fn: 4.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 5.5852e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/356361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.1613e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.6718e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/356361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.2175e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9447e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/356361
[33m[INFO] loading file 29-29/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (556361, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (556361, 17)

[INFO] analyzing data
[INFO] 556361 rows
[INFO] ** appi_name:[21:99.99874%,30:0.00054%,31:0.00018%,26:0.00018%,9:0.00018%,3:0.00018%]
[INFO] ** classification:[normal:64.39668%,Single Stage Single Point:35.60332%]
[INFO] ** dst:[21:43.33356%,10:21.06168%,8:18.13786%,9:17.4651%,22:0.00054%,15:0.00054%,24:0.00018%,18:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99946%,3:0.00054%]
[INFO] ** modbus_function_code:[0.02961:99.99874%,-33.760870000000004:0.00126%]
[INFO] ** modbus_function_description:[7:49.99973%,11:49.99901%,0:0.00126%]
[INFO] ** modbus_transaction_id:65536 (11.7794%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9991%,1:0.00054%,2:0.00036%]
[INFO] ** proxy_src_ip:[18:38.44303%,20:25.95239%,13:18.13822%,6:17.46492%,17:0.00054%,21:0.00018%,16:0.00018%,7:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95186%,-0.32151:21.06151%,-1.27613:18.13786%,-0.23351:17.46492%,-0.33484:17.38152%,-71.33197:0.00054%,1.45709:0.00036%,-71.14798:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,6.1115699999999995:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.9515%,1:21.06133%,5:18.13786%,4:17.46456%,2:17.38152%,0:0.00324%]
[INFO] ** service:[0.0048200000000000005:99.99892%,-211.73542999999998:0.00054%,-183.8612:0.00018%,-211.08346:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.44303%,9:25.95239%,7:18.13822%,1:17.46492%,14:0.00054%,21:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1511 (0.27159%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.9959e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3230e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9776e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6669e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.4064e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1539e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9825e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.8044e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6265e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5198e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/556361
[33m[INFO] loading file 30-30/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (556361, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (556361, 17)

[INFO] analyzing data
[INFO] 556361 rows
[INFO] ** appi_name:[21:99.99748%,30:0.0018%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.36864%,Single Stage Single Point:35.63136%]
[INFO] ** dst:[21:43.33769%,10:21.02789%,8:18.14829%,9:17.48271%,15:0.0018%,22:0.00072%,24:0.00036%,25:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99838%,0:0.00162%]
[INFO] ** i/f_name:[2:99.9982%,3:0.0018%]
[INFO] ** modbus_function_code:[0.02961:99.99748%,-33.760870000000004:0.00252%]
[INFO] ** modbus_function_description:[7:49.99973%,11:49.99775%,0:0.00252%]
[INFO] ** modbus_transaction_id:65536 (11.7794%)
[INFO] ** orig:[0:99.9991%,2:0.00054%,1:0.00036%]
[INFO] ** proto:[0:99.99784%,1:0.0018%,2:0.00036%]
[INFO] ** proxy_src_ip:[18:38.36825%,20:25.99715%,13:18.14865%,6:17.48325%,17:0.0018%,7:0.00036%,16:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.99697%,-0.32151:21.02771%,-1.27613:18.14811%,-0.23351:17.48253%,-0.33484:17.34054%,-71.33197:0.0018%,-0.24151:0.00054%,-1.27347:0.00036%,-71.14798:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:25.99661%,1:21.02771%,5:18.14793%,4:17.48235%,2:17.34036%,0:0.00503%]
[INFO] ** service:[0.0048200000000000005:99.99766%,-211.73542999999998:0.0018%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.36825%,9:25.99715%,7:18.14865%,1:17.48325%,14:0.00126%,21:0.0009%,16:0.00018%,15:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.9991%,1:0.0009%]
[INFO] ** unixtime:1513 (0.27195%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5477e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3067e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3153e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0759e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9925e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.3419e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8648e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.1761e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1418e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.2504e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/556361
[33m[INFO] loading file 31-31/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (556361, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (556361, 17)

[INFO] analyzing data
[INFO] 556361 rows
[INFO] ** appi_name:[21:99.99964%,26:0.00018%,17:0.00018%]
[INFO] ** classification:[normal:64.37547%,Single Stage Single Point:35.62453%]
[INFO] ** dst:[21:43.32115%,10:21.0527%,8:18.12528%,9:17.49907%,22:0.00108%,24:0.00036%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99964%,-33.760870000000004:0.00036%]
[INFO] ** modbus_function_description:[7:50.00009%,11:49.99955%,0:0.00036%]
[INFO] ** modbus_transaction_id:65536 (11.7794%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.39557%,20:25.979%,13:18.12546%,6:17.49907%,16:0.00054%,7:0.00036%]
[INFO] ** s_port:[1.45442:25.97828%,-0.32151:21.0527%,-1.27613:18.1251%,-0.23351:17.49889%,-0.33484:17.34288%,-1.02014:0.00054%,-1.27347:0.00036%,1.45709:0.00036%,-71.14798:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,10.192739999999999:0.00018%]
[INFO] ** scada_tag:[3:25.97792%,1:21.05252%,5:18.12492%,4:17.49853%,2:17.3427%,0:0.00342%]
[INFO] ** service:[0.0048200000000000005:99.99964%,-211.08346:0.00018%,-205.44247:0.00018%]
[INFO] ** src:[22:38.39557%,9:25.979%,7:18.12546%,1:17.49907%,15:0.00054%,21:0.00036%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1512 (0.27177%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9297e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.5357e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 6.1876e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7910e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.4307e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.0641e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.7920e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5087e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.2342e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9815e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/556361
[33m[INFO] loading file 32-32/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (556361, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (556361, 17)

[INFO] analyzing data
[INFO] 556361 rows
[INFO] ** appi_name:[21:99.99641%,30:0.00306%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.37583%,Single Stage Single Point:35.62417%]
[INFO] ** dst:[21:43.32331%,10:21.04784%,8:18.15907%,9:17.4651%,15:0.00306%,22:0.0009%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.9973%,0:0.0027%]
[INFO] ** i/f_name:[2:99.99694%,3:0.00306%]
[INFO] ** modbus_function_code:[0.02961:99.99641%,-33.760870000000004:0.00359%]
[INFO] ** modbus_function_description:[7:49.99919%,11:49.99721%,0:0.00359%]
[INFO] ** modbus_transaction_id:65536 (11.7794%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99641%,1:0.00306%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.41373%,20:25.95779%,13:18.15907%,6:17.46564%,17:0.00306%,14:0.00054%,16:0.00018%]
[INFO] ** s_port:[1.45442:25.95725%,-0.32151:21.04784%,-1.27613:18.15871%,-0.23351:17.46492%,-0.33484:17.36588%,-71.33197:0.00306%,-0.24151:0.00054%,-1.2708:0.00018%,-1.02014:0.00018%,13.431270000000001:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,1.45709:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:25.95689%,1:21.04767%,5:18.15871%,4:17.46456%,2:17.36588%,0:0.00629%]
[INFO] ** service:[0.0048200000000000005:99.99641%,-211.73542999999998:0.00306%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.41373%,9:25.95779%,7:18.15907%,1:17.46564%,14:0.00306%,2:0.00054%,15:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1510 (0.27141%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0772e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.0021e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.7847e-04 - tp: 79997.0000 - fp: 3.0000 - tn: 319997.0000 - fn: 3.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8766e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.5530e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.6723e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9325e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4297e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5230e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0212e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/556361
[33m[INFO] loading file 33-33/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (556361, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (556361, 17)

[INFO] analyzing data
[INFO] 556361 rows
[INFO] ** appi_name:[21:99.99694%,30:0.00108%,17:0.00072%,22:0.00054%,31:0.00018%,28:0.00018%,26:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.39218%,Single Stage Single Point:35.60782%]
[INFO] ** dst:[21:43.32421%,10:21.06312%,8:18.12151%,9:17.48631%,22:0.00144%,15:0.00108%,16:0.00072%,6:0.00072%,24:0.00036%,17:0.00036%,18:0.00018%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99694%,-33.760870000000004:0.00306%]
[INFO] ** modbus_function_description:[7:49.99955%,11:49.99739%,0:0.00306%]
[INFO] ** modbus_transaction_id:65536 (11.7794%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99802%,1:0.00108%,2:0.0009%]
[INFO] ** proxy_src_ip:[18:38.42146%,20:25.96677%,13:18.12151%,6:17.48649%,17:0.00108%,16:0.00072%,1:0.00072%,21:0.00036%,14:0.00036%,7:0.00036%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.96587%,-0.32151:21.06312%,-1.27613:18.12115%,-0.23351:17.48613%,-0.33484:17.35833%,-71.33197:0.00108%,-1.02014:0.00072%,1.45709:0.00054%,-71.14931:0.00054%,-1.27347:0.00036%,-5.08665:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,-43.76509:0.00018%,-71.14798:0.00018%,-58.032509999999995:0.00018%,-58.035180000000004:0.00018%,-0.24151:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:25.96552%,1:21.06312%,5:18.12097%,4:17.48595%,2:17.35833%,0:0.00611%]
[INFO] ** service:[0.0048200000000000005:99.99694%,-211.73542999999998:0.00108%,-205.44247:0.00072%,-211.08818:0.00054%,-211.09762999999998:0.00018%,-211.08346:0.00018%,-185.9872:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.42146%,9:25.96677%,7:18.12151%,1:17.48649%,14:0.00108%,15:0.00072%,3:0.00072%,21:0.00036%,4:0.00036%,2:0.00036%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1513 (0.27195%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7340e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0501e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.2826e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.0055e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.4523e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.6199e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.2535e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.6228e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/556361
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5443e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.3752e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/556361
[33m[INFO] loading file 34-34/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (397794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (397794, 17)

[INFO] analyzing data
[INFO] 397794 rows
[INFO] ** appi_name:[21:99.99749%,30:0.00075%,7:0.00075%,31:0.00025%,22:0.00025%,8:0.00025%,6:0.00025%]
[INFO] ** classification:[normal:64.33858%,Single Stage Single Point:35.66142%]
[INFO] ** dst:[21:43.27592%,10:21.05939%,8:18.19535%,9:17.46633%,22:0.00075%,15:0.00075%,16:0.0005%,2:0.0005%,18:0.00025%,6:0.00025%]
[INFO] ** i/f_dir:[1:99.99925%,0:0.00075%]
[INFO] ** i/f_name:[2:99.99925%,3:0.00075%]
[INFO] ** modbus_function_code:[0.02961:99.99749%,-33.760870000000004:0.00251%]
[INFO] ** modbus_function_description:[7:49.99925%,11:49.99824%,0:0.00251%]
[INFO] ** modbus_transaction_id:65536 (16.47486%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99874%,1:0.00075%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.38997%,20:25.94559%,13:18.1951%,6:17.46683%,17:0.00075%,1:0.00075%,21:0.0005%,14:0.00025%,7:0.00025%]
[INFO] ** s_port:[1.45442:25.94509%,-0.32151:21.05914%,-1.27613:18.1951%,-0.23351:17.46608%,-0.33484:17.33083%,-0.24151:0.00075%,-71.33197:0.00075%,-3.0613900000000003:0.00025%,-3.3787199999999995:0.00025%,14.191239999999999:0.00025%,1.46509:0.00025%,1.47576:0.00025%,11.57001:0.00025%,-49.275529999999996:0.00025%,-71.14931:0.00025%,7.66617:0.00025%]
[INFO] ** scada_tag:[3:25.94484%,1:21.05889%,5:18.19484%,4:17.46557%,2:17.33083%,0:0.00503%]
[INFO] ** service:[0.0048200000000000005:99.99774%,-211.09762999999998:0.00075%,-211.73542999999998:0.00075%,-186.43601999999998:0.00025%,-211.35747999999998:0.00025%,-211.08818:0.00025%]
[INFO] ** src:[22:38.38997%,9:25.94559%,7:18.1951%,1:17.46683%,14:0.00075%,3:0.00075%,4:0.0005%,21:0.00025%,2:0.00025%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1080 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/397794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.2648e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.2698e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/397794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2946e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1016e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/397794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.8150e-04 - tp: 79997.0000 - fp: 3.0000 - tn: 319997.0000 - fn: 3.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2921e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/397794
[33m[INFO] loading file 35-35/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597794, 17)

[INFO] analyzing data
[INFO] 597794 rows
[INFO] ** appi_name:[21:99.999%,30:0.001%]
[INFO] ** classification:[normal:64.35745%,Single Stage Single Point:35.64255%]
[INFO] ** dst:[21:43.31994%,10:21.03501%,8:18.16863%,9:17.47425%,22:0.00117%,15:0.001%]
[INFO] ** i/f_dir:[1:99.99916%,0:0.00084%]
[INFO] ** i/f_name:[2:99.999%,3:0.001%]
[INFO] ** modbus_function_code:[0.02961:99.999%,-33.760870000000004:0.001%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.99883%,0:0.001%]
[INFO] ** modbus_transaction_id:65536 (10.96297%)
[INFO] ** orig:[0:99.99967%,1:0.00033%]
[INFO] ** proto:[0:99.999%,1:0.001%]
[INFO] ** proxy_src_ip:[18:38.3868%,20:25.96864%,13:18.1683%,6:17.47458%,17:0.001%,16:0.00067%]
[INFO] ** s_port:[1.45442:25.96814%,-0.32151:21.03501%,-1.27613:18.1683%,-0.23351:17.47408%,-0.33484:17.3518%,-71.33197:0.001%,-1.02014:0.00067%,-0.24151:0.00033%,1.45709:0.00017%,-0.24950999999999998:0.00017%,1.46509:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.96781%,1:21.03501%,5:18.16813%,4:17.47375%,2:17.3518%,0:0.00351%]
[INFO] ** service:[0.0048200000000000005:99.999%,-211.73542999999998:0.001%]
[INFO] ** src:[22:38.3868%,9:25.96864%,7:18.1683%,1:17.47458%,14:0.001%,15:0.00067%]
[INFO] ** type:[0:99.99916%,1:0.00084%]
[INFO] ** unixtime:1623 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2015e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6191e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.3555e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.7382e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3332e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0712e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2909e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0157e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.9751e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.4086e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/597794
[33m[INFO] loading file 36-36/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597794, 17)

[INFO] analyzing data
[INFO] 597794 rows
[INFO] ** appi_name:[21:99.99866%,30:0.00067%,31:0.00033%,33:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.36448%,Single Stage Single Point:35.63552%]
[INFO] ** dst:[21:43.33031%,10:21.03199%,8:18.14973%,9:17.48562%,22:0.00084%,15:0.00067%,24:0.00033%,18:0.00033%,25:0.00017%]
[INFO] ** i/f_dir:[1:99.99933%,0:0.00067%]
[INFO] ** i/f_name:[2:99.99933%,3:0.00067%]
[INFO] ** modbus_function_code:[0.02961:99.99866%,-33.760870000000004:0.00134%]
[INFO] ** modbus_function_description:[7:50.00033%,11:49.99833%,0:0.00134%]
[INFO] ** modbus_transaction_id:65536 (10.96297%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99883%,1:0.00067%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.3853%,20:25.97718%,13:18.1499%,6:17.48612%,17:0.00067%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.97667%,-0.32151:21.03183%,-1.27613:18.1494%,-0.23351:17.48545%,-0.33484:17.35347%,-71.33197:0.00067%,-0.24151:0.0005%,-0.08551:0.00033%,-1.27347:0.00033%,1.45709:0.00017%,1.47576:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,-64.19493:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:25.97634%,1:21.03166%,5:18.14923%,4:17.48529%,2:17.3533%,0:0.00418%]
[INFO] ** service:[0.0048200000000000005:99.99883%,-211.73542999999998:0.00067%,-186.43601999999998:0.00033%,-186.44547:0.00017%]
[INFO] ** src:[22:38.3853%,9:25.97718%,7:18.1499%,1:17.48612%,14:0.00067%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1623 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.5133e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5688e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.1430e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5137e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.8519e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3531e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.8674e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5103e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.1284e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2380e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/597794
[33m[INFO] loading file 37-37/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597794, 17)

[INFO] analyzing data
[INFO] 597794 rows
[INFO] ** appi_name:[21:99.99849%,30:0.00067%,31:0.00033%,33:0.00017%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:64.37686%,Single Stage Single Point:35.62314%]
[INFO] ** dst:[21:43.33767%,10:21.03701%,8:18.14036%,9:17.48278%,22:0.00067%,15:0.00067%,18:0.00033%,24:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99967%,0:0.00033%]
[INFO] ** i/f_name:[2:99.99933%,3:0.00067%]
[INFO] ** modbus_function_code:[0.02961:99.99849%,-33.760870000000004:0.00151%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99849%,0:0.00151%]
[INFO] ** modbus_transaction_id:65536 (10.96297%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99883%,1:0.00067%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.38346%,20:25.9914%,13:18.14036%,6:17.48295%,17:0.00067%,21:0.00033%,16:0.00033%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.99089%,-0.32151:21.03685%,-1.27613:18.14003%,-0.23351:17.48261%,-0.33484:17.34661%,-71.33197:0.00067%,-0.08551:0.00033%,-1.02014:0.00033%,-0.24151:0.00017%,14.4699:0.00017%,-1.2708:0.00017%,-71.14798:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:25.99056%,1:21.03685%,5:18.13986%,4:17.48244%,2:17.34644%,0:0.00385%]
[INFO] ** service:[0.0048200000000000005:99.99866%,-211.73542999999998:0.00067%,-186.43601999999998:0.00033%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.38346%,9:25.9914%,7:18.14036%,1:17.48295%,14:0.00067%,15:0.00033%,4:0.00033%,17:0.00017%,8:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99967%,1:0.00033%]
[INFO] ** unixtime:1624 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.3434e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.6181e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.0952e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.5343e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.4896e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.1430e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7160e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5023e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6393e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4927e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/597794
[33m[INFO] loading file 38-38/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597794, 17)

[INFO] analyzing data
[INFO] 597794 rows
[INFO] ** appi_name:[21:99.999%,30:0.00033%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.41048%,Single Stage Single Point:35.58952%]
[INFO] ** dst:[21:43.32379%,10:21.08469%,8:18.09486%,9:17.49482%,22:0.00084%,15:0.00033%,25:0.00017%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99983%,0:0.00017%]
[INFO] ** i/f_name:[2:99.99967%,3:0.00033%]
[INFO] ** modbus_function_code:[0.02961:99.999%,-33.760870000000004:0.001%]
[INFO] ** modbus_function_description:[7:49.99967%,11:49.99933%,0:0.001%]
[INFO] ** modbus_transaction_id:65536 (10.96297%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99933%,2:0.00033%,1:0.00033%]
[INFO] ** proxy_src_ip:[18:38.44669%,20:25.96246%,13:18.09469%,6:17.49499%,17:0.00033%,7:0.00033%,16:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.96162%,-0.32151:21.08452%,-1.27613:18.09453%,-0.23351:17.49449%,-0.33484:17.36217%,1.47576:0.00033%,-0.24151:0.00033%,-71.33197:0.00033%,1.45709:0.00033%,-1.27347:0.00017%,1.46509:0.00017%,-61.95768:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:25.96128%,1:21.08452%,5:18.09453%,4:17.49432%,2:17.362%,0:0.00335%]
[INFO] ** service:[0.0048200000000000005:99.99916%,-211.73542999999998:0.00033%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.44669%,9:25.96246%,7:18.09469%,1:17.49499%,21:0.00033%,14:0.00033%,16:0.00017%,15:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1624 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1942e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5001e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.5097e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6538e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.0717e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6059e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1802e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5189e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0588e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3872e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/597794
[33m[INFO] loading file 39-39/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597794, 17)

[INFO] analyzing data
[INFO] 597794 rows
[INFO] ** appi_name:[21:99.99967%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.39593%,Single Stage Single Point:35.60407%]
[INFO] ** dst:[21:43.31158%,10:21.08302%,8:18.13668%,9:17.46722%,22:0.001%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99967%,-33.760870000000004:0.00033%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.9995%,0:0.00033%]
[INFO] ** modbus_transaction_id:65536 (10.96297%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.44451%,20:25.95058%,13:18.13685%,6:17.46722%,16:0.0005%,7:0.00033%]
[INFO] ** s_port:[1.45442:25.94991%,-0.32151:21.08302%,-1.27613:18.13652%,-0.23351:17.46705%,-0.33484:17.3615%,-1.02014:0.0005%,1.45709:0.00033%,-71.14798:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-0.24151:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.94957%,1:21.08285%,5:18.13635%,4:17.46705%,2:17.36133%,0:0.00284%]
[INFO] ** service:[0.0048200000000000005:99.99967%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.44451%,9:25.95058%,7:18.13685%,1:17.46722%,15:0.0005%,21:0.00033%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1622 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.9710e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.4947e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1255e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9793e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.7190e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4732e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3358e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1835e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1432e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8897e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/597794
[33m[INFO] loading file 40-40/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597794, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597794, 17)

[INFO] analyzing data
[INFO] 597794 rows
[INFO] ** appi_name:[21:99.99665%,30:0.00284%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.33253%,Single Stage Single Point:35.66747%]
[INFO] ** dst:[21:43.291%,10:21.03701%,8:18.20192%,9:17.46572%,15:0.00284%,22:0.00084%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99732%,0:0.00268%]
[INFO] ** i/f_name:[2:99.99716%,3:0.00284%]
[INFO] ** modbus_function_code:[0.02961:99.99665%,-33.760870000000004:0.00335%]
[INFO] ** modbus_function_description:[7:49.99933%,11:49.99732%,0:0.00335%]
[INFO] ** modbus_transaction_id:65536 (10.96297%)
[INFO] ** orig:[0:99.99967%,1:0.00033%]
[INFO] ** proto:[0:99.99665%,1:0.00284%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.35652%,20:25.97232%,13:18.20176%,6:17.46605%,17:0.00284%,14:0.0005%]
[INFO] ** s_port:[1.45442:25.97149%,-0.32151:21.03701%,-1.27613:18.20159%,-0.23351:17.46555%,-0.33484:17.31951%,-71.33197:0.00284%,1.45709:0.0005%,-0.24151:0.00033%,-71.14798:0.00017%,-1.27347:0.00017%,11.862:0.00017%,-0.24950999999999998:0.00017%,1.46509:0.00017%,1.47576:0.00017%,13.431270000000001:0.00017%]
[INFO] ** scada_tag:[3:25.97115%,1:21.03685%,5:18.20142%,4:17.46521%,2:17.31934%,0:0.00602%]
[INFO] ** service:[0.0048200000000000005:99.99665%,-211.73542999999998:0.00284%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.35652%,9:25.97232%,7:18.20176%,1:17.46605%,14:0.00284%,2:0.0005%]
[INFO] ** type:[0:99.99916%,1:0.00084%]
[INFO] ** unixtime:1625 (0.27183%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3446e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0998e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9415e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2674e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.5152e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3841e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.3506e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0260e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/597794
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.6590e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7118e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/597794
[33m[INFO] loading file 41-41/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (537952, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (537952, 17)

[INFO] analyzing data
[INFO] 537952 rows
[INFO] ** appi_name:[21:99.99684%,30:0.00093%,22:0.00074%,17:0.00074%,32:0.00019%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.38511%,Single Stage Single Point:35.61489%]
[INFO] ** dst:[21:43.32654%,10:21.05467%,8:18.14418%,9:17.47052%,16:0.00093%,15:0.00093%,6:0.00093%,22:0.00056%,24:0.00037%,17:0.00037%]
[INFO] ** i/f_dir:[1:99.99907%,0:0.00093%]
[INFO] ** i/f_name:[2:99.99907%,3:0.00093%]
[INFO] ** modbus_function_code:[0.02961:99.99684%,-33.760870000000004:0.00316%]
[INFO] ** modbus_function_description:[7:49.99907%,11:49.99777%,0:0.00316%]
[INFO] ** modbus_transaction_id:65536 (12.1825%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99796%,2:0.00112%,1:0.00093%]
[INFO] ** proxy_src_ip:[18:38.42425%,20:25.95715%,13:18.14437%,6:17.4707%,17:0.00093%,1:0.00074%,21:0.00037%,16:0.00037%,14:0.00037%,0:0.00037%,7:0.00019%,2:0.00019%]
[INFO] ** s_port:[1.45442:25.95678%,-0.32151:21.05467%,-1.27613:18.14381%,-0.23351:17.47033%,-0.33484:17.36958%,-71.33197:0.00093%,-71.14931:0.00074%,-1.27347:0.00037%,-1.02014:0.00037%,-0.24151:0.00019%,-5.1466400000000005:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,1.46509:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,-5.08665:0.00019%,-64.19226:0.00019%,-0.24950999999999998:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:25.95641%,1:21.05467%,5:18.14381%,4:17.47015%,2:17.36939%,0:0.00558%]
[INFO] ** service:[0.0048200000000000005:99.99684%,-211.73542999999998:0.00093%,-205.44247:0.00074%,-211.08818:0.00074%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%,89.64175:0.00019%]
[INFO] ** src:[22:38.42425%,9:25.95715%,7:18.14437%,1:17.4707%,14:0.00093%,3:0.00074%,15:0.00037%,8:0.00037%,4:0.00037%,2:0.00037%,21:0.00019%,17:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1459 (0.27121%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/537952
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.3515e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5864e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/537952
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.6659e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7949e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/537952
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7077e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4176e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/537952
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.0130e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5773e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/537952
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.0246e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.8194e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-40-41-batch-400000-500000
[INFO] processing batch 500000-600000/537952
[33m[INFO] loading file 42-42/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (381466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (381466, 17)

[INFO] analyzing data
[INFO] 381466 rows
[INFO] ** appi_name:[21:99.99109%,30:0.00236%,17:0.00131%,31:0.00105%,26:0.00105%,7:0.00105%,22:0.00079%,28:0.00026%,27:0.00026%,9:0.00026%,8:0.00026%,0:0.00026%]
[INFO] ** classification:[normal:64.36563%,Single Stage Single Point:35.63437%]
[INFO] ** dst:[21:43.31159%,10:21.0446%,8:18.18511%,9:17.449%,16:0.00236%,6:0.0021%,18:0.00131%,2:0.00105%,22:0.00079%,15:0.00079%,17:0.00052%,25:0.00026%,7:0.00026%,0:0.00026%]
[INFO] ** i/f_dir:[1:99.99921%,0:0.00079%]
[INFO] ** i/f_name:[2:99.99921%,3:0.00079%]
[INFO] ** modbus_function_code:[0.02961:99.99109%,-33.760870000000004:0.00891%]
[INFO] ** modbus_function_description:[7:49.99633%,11:49.99476%,0:0.00891%]
[INFO] ** modbus_transaction_id:65536 (17.18004%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99528%,2:0.00393%,1:0.00079%]
[INFO] ** proxy_src_ip:[18:38.40395%,20:25.95251%,13:18.18537%,6:17.449%,17:0.00236%,1:0.00236%,14:0.00157%,21:0.00105%,7:0.00079%,0:0.00052%,16:0.00026%,2:0.00026%]
[INFO] ** s_port:[1.45442:25.95199%,-0.32151:21.0446%,-1.27613:18.18511%,-0.23351:17.44874%,-0.33484:17.35935%,-71.14931:0.00105%,-71.14798:0.00105%,-71.33197:0.00079%,-3.3787199999999995:0.00052%,-0.08551:0.00052%,11.57001:0.00052%,13.431270000000001:0.00026%,-5.1466400000000005:0.00026%,0.31847:0.00026%,-1.02014:0.00026%,-64.19493:0.00026%,-1.2708:0.00026%,-58.035180000000004:0.00026%,7.66617:0.00026%,-0.24151:0.00026%,1.47576:0.00026%,14.4699:0.00026%,15.912510000000001:0.00026%,14.191239999999999:0.00026%,7.9608300000000005:0.00026%,-5.08665:0.00026%,10.192739999999999:0.00026%,-3.0613900000000003:0.00026%,1.45709:0.00026%,2.05573:0.00026%,-43.76509:0.00026%,11.862:0.00026%,-58.032509999999995:0.00026%]
[INFO] ** scada_tag:[3:25.95146%,1:21.0446%,5:18.18484%,4:17.44874%,2:17.35908%,0:0.01127%]
[INFO] ** service:[0.0048200000000000005:99.99109%,-211.09762999999998:0.00184%,-205.44247:0.00131%,-186.43601999999998:0.00131%,-211.08346:0.00105%,-211.08818:0.00105%,-211.73542999999998:0.00079%,-211.35747999999998:0.00052%,-186.44547:0.00026%,-183.8612:0.00026%,-185.9872:0.00026%,-202.75898:0.00026%]
[INFO] ** src:[22:38.40395%,9:25.95251%,7:18.18537%,1:17.449%,3:0.00315%,2:0.00184%,4:0.00131%,21:0.00105%,14:0.00079%,8:0.00052%,17:0.00026%,15:0.00026%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1035 (0.27132%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/381466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1825e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4804e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/381466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4349e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5657e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/381466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3312e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2944e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/381466
[33m[INFO] loading file 43-43/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.9988%,30:0.00052%,26:0.00034%,8:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:64.39276%,Single Stage Single Point:35.60724%]
[INFO] ** dst:[21:43.32085%,10:21.06968%,8:18.13623%,9:17.47084%,22:0.00103%,15:0.00052%,6:0.00034%,2:0.00034%,24:0.00017%]
[INFO] ** i/f_dir:[1:99.99983%,0:0.00017%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.9988%,-33.760870000000004:0.0012%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.9988%,0:0.0012%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99914%,1:0.00052%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.4179%,20:25.97314%,13:18.1364%,6:17.47101%,17:0.00052%,1:0.00052%,16:0.00034%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.97246%,-0.32151:21.06968%,-1.27613:18.13606%,-0.23351:17.4705%,-0.33484:17.34822%,-71.33197:0.00052%,-71.14798:0.00034%,1.45709:0.00034%,1.47576:0.00034%,-0.24151:0.00034%,-1.02014:0.00034%,0.31847:0.00017%,-1.27347:0.00017%,-0.24950999999999998:0.00017%,-1.2708:0.00017%,-3.3787199999999995:0.00017%]
[INFO] ** scada_tag:[3:25.97211%,1:21.06968%,5:18.13588%,4:17.47015%,2:17.34805%,0:0.00413%]
[INFO] ** service:[0.0048200000000000005:99.9988%,-211.73542999999998:0.00052%,-211.08346:0.00034%,-211.09762999999998:0.00017%,-211.35747999999998:0.00017%]
[INFO] ** src:[22:38.4179%,9:25.97314%,7:18.1364%,1:17.47101%,14:0.00052%,3:0.00052%,15:0.00034%,21:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1581 (0.2719%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5528e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1719e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.3551e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5110e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5217e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5927e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 6.4387e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8264e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8214e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.0164e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 44-44/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.99828%,30:0.00069%,31:0.00052%,0:0.00034%,22:0.00017%]
[INFO] ** classification:[normal:64.39345%,Single Stage Single Point:35.60655%]
[INFO] ** dst:[21:43.33512%,10:21.0554%,8:18.14981%,9:17.45657%,22:0.00103%,15:0.00069%,18:0.00052%,25:0.00034%,24:0.00034%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99931%,0:0.00069%]
[INFO] ** i/f_name:[2:99.99931%,3:0.00069%]
[INFO] ** modbus_function_code:[0.02961:99.99828%,-33.760870000000004:0.00172%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.99811%,0:0.00172%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99828%,2:0.00103%,1:0.00069%]
[INFO] ** proxy_src_ip:[18:38.4375%,20:25.95354%,13:18.14999%,6:17.45708%,17:0.00069%,7:0.00034%,16:0.00017%,5:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95285%,-0.32151:21.0554%,-1.27613:18.14947%,-0.23351:17.45639%,-0.33484:17.3821%,-71.33197:0.00069%,-0.24151:0.00052%,-0.08551:0.00034%,-64.19493:0.00034%,-1.27347:0.00034%,1.45709:0.00034%,-1.02014:0.00017%,-1.2708:0.00017%,1.47576:0.00017%,-71.14931:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,4.42897:0.00017%]
[INFO] ** scada_tag:[3:25.95233%,1:21.0554%,5:18.14947%,4:17.45605%,2:17.38193%,0:0.00482%]
[INFO] ** service:[0.0048200000000000005:99.99828%,-211.73542999999998:0.00069%,-186.43601999999998:0.00052%,-186.44547:0.00034%,-211.08818:0.00017%]
[INFO] ** src:[22:38.4375%,9:25.95354%,7:18.14999%,1:17.45708%,14:0.00069%,21:0.00034%,17:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1578 (0.27138%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.0252e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9369e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9545e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3049e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9886e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7175e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6552e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4840e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 6.0698e-05 - tp: 79997.0000 - fp: 3.0000 - tn: 319997.0000 - fn: 3.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2372e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 45-45/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.9988%,30:0.00052%,31:0.00034%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:64.41649%,Single Stage Single Point:35.58351%]
[INFO] ** dst:[21:43.32308%,10:21.09066%,8:18.12832%,9:17.45536%,22:0.00138%,15:0.00052%,18:0.00034%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99966%,0:0.00034%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.9988%,-33.760870000000004:0.0012%]
[INFO] ** modbus_function_description:[7:50.00052%,11:49.99828%,0:0.0012%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99897%,2:0.00052%,1:0.00052%]
[INFO] ** proxy_src_ip:[18:38.48342%,20:25.93101%,13:18.12815%,6:17.45588%,17:0.00052%,16:0.00034%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.93032%,-0.32151:21.09066%,-1.27613:18.12815%,-0.23351:17.45519%,-0.33484:17.39276%,1.45709:0.00052%,-0.24151:0.00052%,-71.33197:0.00052%,-1.02014:0.00034%,-0.08551:0.00034%,-71.14798:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,14.4699:0.00017%]
[INFO] ** scada_tag:[3:25.92981%,1:21.09049%,5:18.12815%,4:17.45519%,2:17.39259%,0:0.00378%]
[INFO] ** service:[0.0048200000000000005:99.9988%,-211.73542999999998:0.00052%,-186.43601999999998:0.00034%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.48342%,9:25.93101%,7:18.12815%,1:17.45588%,14:0.00052%,15:0.00034%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1578 (0.27138%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.1222e-04 - tp: 79997.0000 - fp: 3.0000 - tn: 319997.0000 - fn: 3.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.2972e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.0171e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2725e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.2768e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8201e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.3129e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6174e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.4990e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4486e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 46-46/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.99828%,30:0.00103%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.41924%,Single Stage Single Point:35.58076%]
[INFO] ** dst:[21:43.34578%,10:21.07088%,8:18.1082%,9:17.47256%,22:0.00103%,15:0.00103%,25:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99914%,0:0.00086%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.99828%,-33.760870000000004:0.00172%]
[INFO] ** modbus_function_description:[11:49.99931%,7:49.99897%,0:0.00172%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.99862%,1:0.00103%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.44163%,20:25.97504%,13:18.1082%,6:17.47308%,17:0.00103%,16:0.00034%,7:0.00034%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.97469%,-0.32151:21.07071%,-1.27613:18.10802%,-0.23351:17.47239%,-0.33484:17.37092%,-71.33197:0.00103%,-0.24151:0.00052%,-1.02014:0.00034%,-71.14798:0.00017%,1.45709:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,-61.95768:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:25.97435%,1:21.07054%,5:18.10785%,4:17.47204%,2:17.37092%,0:0.0043%]
[INFO] ** service:[0.0048200000000000005:99.99845%,-211.73542999999998:0.00103%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.44163%,9:25.97504%,7:18.1082%,1:17.47308%,14:0.00103%,21:0.00034%,15:0.00034%,16:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99914%,1:0.00086%]
[INFO] ** unixtime:1581 (0.2719%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3072e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2670e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6522e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9333e-04 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3312e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5065e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.5200e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4466e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.4160e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9299e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 47-47/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.99948%,33:0.00017%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.39603%,Single Stage Single Point:35.60397%]
[INFO] ** dst:[21:43.31018%,10:21.08395%,8:18.1278%,9:17.47583%,22:0.00155%,24:0.00034%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99948%,-33.760870000000004:0.00052%]
[INFO] ** modbus_function_description:[7:50.00103%,11:49.99845%,0:0.00052%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.45401%,20:25.94081%,13:18.12815%,6:17.47617%,16:0.00034%,7:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.93995%,-0.32151:21.08395%,-1.27613:18.12763%,-0.23351:17.47566%,-0.33484:17.37006%,1.45709:0.00052%,-0.24151:0.00052%,-1.27347:0.00034%,-1.02014:0.00034%,-71.14798:0.00017%,-61.95635:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.93944%,1:21.08378%,5:18.12746%,4:17.47548%,2:17.36989%,0:0.00396%]
[INFO] ** service:[0.0048200000000000005:99.99966%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.45401%,9:25.94081%,7:18.12815%,1:17.47617%,21:0.00034%,15:0.00034%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1579 (0.27156%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.2267e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1612e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.9320e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7535e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9805e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1555e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7496e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8819e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.4030e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0717e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 48-48/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.9969%,30:0.00241%,33:0.00017%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.42973%,Single Stage Single Point:35.57027%]
[INFO] ** dst:[21:43.33031%,10:21.09564%,8:18.10407%,9:17.46603%,15:0.00241%,22:0.00086%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99794%,0:0.00206%]
[INFO] ** i/f_name:[2:99.99759%,3:0.00241%]
[INFO] ** modbus_function_code:[0.02961:99.9969%,-33.760870000000004:0.0031%]
[INFO] ** modbus_function_description:[7:49.99897%,11:49.99794%,0:0.0031%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99708%,1:0.00241%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.47207%,20:25.95423%,13:18.10424%,6:17.46603%,17:0.00241%,14:0.00052%,16:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95371%,-0.32151:21.09564%,-1.27613:18.1039%,-0.23351:17.46585%,-0.33484:17.37642%,-71.33197:0.00241%,-1.02014:0.00034%,-1.2708:0.00017%,13.431270000000001:0.00017%,-0.24151:0.00017%,-71.14798:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-61.95635:0.00017%,1.45709:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.95337%,1:21.09547%,5:18.1039%,4:17.46585%,2:17.37625%,0:0.00516%]
[INFO] ** service:[0.0048200000000000005:99.99708%,-211.73542999999998:0.00241%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.47207%,9:25.95423%,7:18.10424%,1:17.46603%,14:0.00241%,2:0.00052%,15:0.00034%,8:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1578 (0.27138%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.2784e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.2481e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.1623e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2462e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8907e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6020e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4565e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7217e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8839e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5069e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 49-49/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (581466, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (581466, 17)

[INFO] analyzing data
[INFO] 581466 rows
[INFO] ** appi_name:[21:99.99742%,30:0.00086%,17:0.00069%,26:0.00034%,22:0.00034%,28:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:64.38124%,Single Stage Single Point:35.61876%]
[INFO] ** dst:[21:43.31878%,10:21.05815%,8:18.12866%,9:17.48993%,22:0.00155%,15:0.00086%,16:0.00069%,6:0.00069%,24:0.00034%,17:0.00034%]
[INFO] ** i/f_dir:[1:99.99914%,0:0.00086%]
[INFO] ** i/f_name:[2:99.99914%,3:0.00086%]
[INFO] ** modbus_function_code:[0.02961:99.99742%,-33.760870000000004:0.00258%]
[INFO] ** modbus_function_description:[7:49.99983%,11:49.99759%,0:0.00258%]
[INFO] ** modbus_transaction_id:65536 (11.27082%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99845%,1:0.00086%,2:0.00069%]
[INFO] ** proxy_src_ip:[18:38.4234%,20:25.95423%,13:18.12883%,6:17.49062%,17:0.00086%,1:0.00069%,14:0.00052%,21:0.00034%,16:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95337%,-0.32151:21.05815%,-1.27613:18.12832%,-0.23351:17.48976%,-0.33484:17.36525%,-71.33197:0.00086%,-0.24151:0.00069%,1.45709:0.00052%,-1.27347:0.00034%,-71.14931:0.00034%,-1.02014:0.00034%,-71.14798:0.00034%,1.47576:0.00017%,-1.2708:0.00017%,-58.035180000000004:0.00017%,-58.032509999999995:0.00017%,1.46509:0.00017%,-43.76509:0.00017%,2.05573:0.00017%,-5.08665:0.00017%,-0.24950999999999998:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.95302%,1:21.05798%,5:18.12815%,4:17.48941%,2:17.36525%,0:0.00619%]
[INFO] ** service:[0.0048200000000000005:99.99742%,-211.73542999999998:0.00086%,-205.44247:0.00069%,-211.08346:0.00034%,-211.08818:0.00034%,-211.09762999999998:0.00017%,-185.9872:0.00017%]
[INFO] ** src:[22:38.4234%,9:25.95423%,7:18.12883%,1:17.49062%,14:0.00086%,3:0.00069%,2:0.00052%,15:0.00034%,4:0.00034%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1579 (0.27156%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.3509e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3059e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1545e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9290e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.9362e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0682e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 9.4712e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.5716e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/581466
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.6910e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6959e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/581466
[33m[INFO] loading file 50-50/50 on epoch 4/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (431448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (431448, 17)

[INFO] analyzing data
[INFO] 431448 rows
[INFO] ** appi_name:[21:99.99745%,30:0.00116%,7:0.0007%,31:0.00023%,22:0.00023%,8:0.00023%]
[INFO] ** classification:[normal:64.3132%,Single Stage Single Point:35.6868%]
[INFO] ** dst:[21:43.26593%,10:21.04402%,8:18.21425%,9:17.47233%,15:0.00116%,22:0.0007%,16:0.00046%,2:0.00046%,24:0.00023%,18:0.00023%,6:0.00023%]
[INFO] ** i/f_dir:[1:99.99884%,0:0.00116%]
[INFO] ** i/f_name:[2:99.99884%,3:0.00116%]
[INFO] ** modbus_function_code:[0.02961:99.99745%,-33.760870000000004:0.00255%]
[INFO] ** modbus_function_description:[7:49.99884%,11:49.99861%,0:0.00255%]
[INFO] ** modbus_transaction_id:65536 (15.18978%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99838%,1:0.00116%,2:0.00046%]
[INFO] ** proxy_src_ip:[18:38.3694%,20:25.94079%,13:18.21448%,6:17.47233%,17:0.00116%,1:0.0007%,16:0.00046%,21:0.00023%,14:0.00023%,7:0.00023%]
[INFO] ** s_port:[1.45442:25.94032%,-0.32151:21.04402%,-1.27613:18.21401%,-0.23351:17.47233%,-0.33484:17.32538%,-71.33197:0.00116%,-1.02014:0.00046%,-3.3787199999999995:0.00023%,4.33564:0.00023%,15.912510000000001:0.00023%,7.9608300000000005:0.00023%,1.46509:0.00023%,1.45709:0.00023%,-1.27347:0.00023%,-71.14931:0.00023%,-1.2708:0.00023%,0.31847:0.00023%]
[INFO] ** scada_tag:[3:25.94009%,1:21.04379%,5:18.21378%,4:17.47233%,2:17.32515%,0:0.00487%]
[INFO] ** service:[0.0048200000000000005:99.99745%,-211.73542999999998:0.00116%,-211.09762999999998:0.0007%,-186.43601999999998:0.00023%,-211.35747999999998:0.00023%,-211.08818:0.00023%]
[INFO] ** src:[22:38.3694%,9:25.94079%,7:18.21448%,1:17.47233%,14:0.00116%,3:0.0007%,15:0.00046%,21:0.00023%,4:0.00023%,2:0.00023%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1172 (0.27164%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/431448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3571e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3528e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/431448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2430e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1556e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/431448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6312e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0433e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/431448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.7987e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.5578e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-4-files-49-50-batch-300000-400000
[INFO] processing batch 400000-500000/431448
[33m[INFO] epoch 5/10[0m
[33m[INFO] loading file 1-1/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99323%,30:0.00113%,22:0.00094%,17:0.00075%,31:0.00056%,26:0.00056%,7:0.00056%,23:0.00038%,18:0.00038%,0:0.00038%,28:0.00019%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:78.41614%,Single Stage Single Point:21.58386%]
[INFO] ** dst:[21:43.27272%,10:21.04063%,8:18.16321%,9:17.51611%,6:0.00151%,22:0.00113%,16:0.00113%,15:0.00113%,18:0.00056%,26:0.00038%,25:0.00038%,19:0.00038%,17:0.00038%,24:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99887%,0:0.00113%]
[INFO] ** i/f_name:[2:99.99887%,3:0.00113%]
[INFO] ** modbus_function_code:[0.02961:99.99323%,-33.760870000000004:0.00659%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99755%,11:49.99567%,0:0.00659%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99624%,2:0.00263%,1:0.00113%]
[INFO] ** proxy_src_ip:[18:38.40413%,20:25.90884%,13:18.1634%,6:17.51648%,11:0.00132%,10:0.00132%,17:0.00113%,14:0.00094%,1:0.00094%,7:0.00056%,21:0.00038%,16:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.90827%,-0.32151:21.03988%,-1.27613:18.16302%,-0.23351:17.51592%,-0.33484:17.36426%,-71.33197:0.00113%,-71.14931:0.00094%,-2.1481:0.00075%,-0.24151:0.00056%,-71.14798:0.00056%,-1.02014:0.00038%,-64.19493:0.00038%,-2.42942:0.00038%,4.44364:0.00038%,-43.76509:0.00019%,10.67005:0.00019%,4.29964:0.00019%,-5.08665:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,1.47576:0.00019%,1.46509:0.00019%,4.076980000000001:0.00019%,-58.032509999999995:0.00019%,-58.035180000000004:0.00019%,-1.2708:0.00019%,-1.27347:0.00019%,-5.1466400000000005:0.00019%,-68.79874000000001:0.00019%,14.253910000000001:0.00019%,1.45709:0.00019%]
[INFO] ** scada_tag:[3:25.90809%,1:21.03969%,5:18.16264%,4:17.51573%,2:17.36407%,0:0.00978%]
[INFO] ** service:[0.0048200000000000005:99.99398%,-211.73542999999998:0.00113%,-211.08818:0.00094%,-205.44247:0.00075%,-211.07873999999998:0.00075%,-211.09762999999998:0.00056%,-211.08346:0.00056%,-186.43601999999998:0.00056%,-186.44547:0.00038%,-185.9872:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.40413%,9:25.90884%,7:18.1634%,1:17.51648%,11:0.00132%,10:0.00132%,14:0.00113%,3:0.00094%,2:0.00094%,21:0.00056%,15:0.00038%,4:0.00038%,8:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1442 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1391 - tp: 78328.0000 - fp: 1672.0000 - tn: 318328.0000 - fn: 1672.0000 - accuracy: 0.9916 - precision: 0.9791 - recall: 0.9791 - auc: 0.9932 - val_loss: 0.0015 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2402e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.4104e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.9526e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6534e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.5189 - tp: 67077.0000 - fp: 12923.0000 - tn: 307077.0000 - fn: 12923.0000 - accuracy: 0.9354 - precision: 0.8385 - recall: 0.8385 - auc: 0.9646 - val_loss: 0.0677 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0082 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.8194e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 2-2/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99868%,7:0.00056%,30:0.00038%,31:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:71.62432%,Single Stage Single Point:28.37568%]
[INFO] ** dst:[21:43.31186%,10:21.0267%,8:18.14759%,9:17.51159%,22:0.00075%,16:0.00038%,15:0.00038%,2:0.00038%,24:0.00019%,18:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99868%,-33.760870000000004:0.00132%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99868%,0:0.00132%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99944%,1:0.00038%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.37741%,20:25.96171%,13:18.14759%,6:17.51178%,1:0.00056%,17:0.00038%,16:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.96096%,-0.32151:21.0267%,-1.27613:18.14721%,-0.23351:17.5114%,-0.33484:17.35071%,-71.33197:0.00038%,1.45709:0.00038%,1.46509:0.00019%,1.47576:0.00019%,12.60597:0.00019%,10.67005:0.00019%,-0.24950999999999998:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,4.076980000000001:0.00019%,-3.3787199999999995:0.00019%,4.29964:0.00019%,-1.27347:0.00019%]
[INFO] ** scada_tag:[3:25.96058%,1:21.0267%,5:18.14721%,4:17.51121%,2:17.35052%,0:0.00376%]
[INFO] ** service:[0.0048200000000000005:99.99868%,-211.09762999999998:0.00056%,-211.73542999999998:0.00038%,-211.35747999999998:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.37741%,9:25.96171%,7:18.14759%,1:17.51178%,3:0.00056%,14:0.00038%,21:0.00019%,15:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1446 (0.27209%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.2035e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4013e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3259 - tp: 69168.0000 - fp: 10832.0000 - tn: 309168.0000 - fn: 10832.0000 - accuracy: 0.9458 - precision: 0.8646 - recall: 0.8646 - auc: 0.9820 - val_loss: 0.5681 - val_tp: 10648.0000 - val_fp: 9352.0000 - val_tn: 70648.0000 - val_fn: 9352.0000 - val_accuracy: 0.8130 - val_precision: 0.5324 - val_recall: 0.5324 - val_auc: 0.9453
[INFO] saving weights to checkpoints/lstm-epoch-5-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0122 - tp: 79364.0000 - fp: 636.0000 - tn: 319364.0000 - fn: 636.0000 - accuracy: 0.9968 - precision: 0.9920 - recall: 0.9920 - auc: 1.0000 - val_loss: 1.0822 - val_tp: 17800.0000 - val_fp: 2200.0000 - val_tn: 77800.0000 - val_fn: 2200.0000 - val_accuracy: 0.9560 - val_precision: 0.8900 - val_recall: 0.8900 - val_auc: 0.9363
[INFO] saving weights to checkpoints/lstm-epoch-5-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.1282 - tp: 77866.0000 - fp: 2134.0000 - tn: 317866.0000 - fn: 2134.0000 - accuracy: 0.9893 - precision: 0.9733 - recall: 0.9733 - auc: 0.9937 - val_loss: 0.0016 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.3073 - tp: 69602.0000 - fp: 10398.0000 - tn: 309602.0000 - fn: 10398.0000 - accuracy: 0.9480 - precision: 0.8700 - recall: 0.8700 - auc: 0.9830 - val_loss: 0.6218 - val_tp: 10581.0000 - val_fp: 9419.0000 - val_tn: 70581.0000 - val_fn: 9419.0000 - val_accuracy: 0.8116 - val_precision: 0.5290 - val_recall: 0.5290 - val_auc: 0.9446
[INFO] saving weights to checkpoints/lstm-epoch-5-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 3-3/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99134%,30:0.00226%,22:0.00113%,31:0.00094%,26:0.00094%,17:0.00094%,7:0.00075%,27:0.00038%,0:0.00038%,28:0.00019%,23:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:87.49793%,Single Stage Single Point:12.50207%]
[INFO] ** dst:[21:43.3049%,10:21.08899%,8:18.15493%,9:17.44159%,6:0.00226%,15:0.00151%,18:0.00132%,16:0.00132%,22:0.00094%,2:0.00038%,7:0.00038%,25:0.00038%,17:0.00038%,12:0.00019%,24:0.00019%,19:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99849%,0:0.00151%]
[INFO] ** i/f_name:[2:99.99849%,3:0.00151%]
[INFO] ** modbus_function_code:[0.02961:99.99134%,-33.760870000000004:0.00847%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99642%,11:49.99492%,0:0.00847%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99887%,2:0.00113%]
[INFO] ** proto:[0:99.99398%,2:0.00452%,1:0.00151%]
[INFO] ** proxy_src_ip:[18:38.41731%,20:25.97695%,13:18.15512%,6:17.44197%,17:0.00226%,1:0.00151%,14:0.00132%,7:0.00094%,11:0.00075%,10:0.00075%,21:0.00056%,16:0.00019%,15:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.9762%,-0.32151:21.0888%,-1.27613:18.15455%,-0.23351:17.44141%,-0.33484:17.32851%,-71.33197:0.00151%,-71.14931:0.00113%,-71.14798:0.00113%,-64.19493:0.00038%,-0.08551:0.00038%,1.45709:0.00038%,-0.24151:0.00038%,14.4699:0.00019%,4.29964:0.00019%,4.90362:0.00019%,10.192739999999999:0.00019%,-3.3787199999999995:0.00019%,13.86459:0.00019%,4.44364:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-5.08665:0.00019%,-58.035180000000004:0.00019%,4.076980000000001:0.00019%,-58.032509999999995:0.00019%,-1.27347:0.00019%,-1.2708:0.00019%,-1.02014:0.00019%,-5.1466400000000005:0.00019%,13.431270000000001:0.00019%,12.60597:0.00019%,1.47576:0.00019%,1.46509:0.00019%,14.253910000000001:0.00019%,-68.79874000000001:0.00019%,-0.24950999999999998:0.00019%,-2.1481:0.00019%,10.67005:0.00019%,-68.36943000000001:0.00019%]
[INFO] ** scada_tag:[3:25.97582%,1:21.08861%,5:18.15436%,4:17.44122%,2:17.32832%,0:0.01167%]
[INFO] ** service:[0.0048200000000000005:99.99153%,-211.73542999999998:0.00151%,-186.43601999999998:0.00132%,-211.08346:0.00113%,-211.08818:0.00113%,-205.44247:0.00094%,-211.09762999999998:0.00075%,-202.75898:0.00038%,-186.44547:0.00038%,-183.8612:0.00019%,-185.9872:0.00019%,-201.23771000000002:0.00019%,-211.35747999999998:0.00019%,-211.07873999999998:0.00019%]
[INFO] ** src:[22:38.41731%,9:25.97695%,7:18.15512%,1:17.44197%,21:0.00207%,3:0.00169%,2:0.00132%,11:0.00075%,10:0.00075%,4:0.00075%,14:0.00038%,8:0.00038%,17:0.00019%,15:0.00019%,13:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1443 (0.27152%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1398 - tp: 75770.0000 - fp: 4230.0000 - tn: 315770.0000 - fn: 4230.0000 - accuracy: 0.9788 - precision: 0.9471 - recall: 0.9471 - auc: 0.9967 - val_loss: 0.0563 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0418 - tp: 79385.0000 - fp: 615.0000 - tn: 319385.0000 - fn: 615.0000 - accuracy: 0.9969 - precision: 0.9923 - recall: 0.9923 - auc: 0.9991 - val_loss: 1.8495 - val_tp: 10581.0000 - val_fp: 9419.0000 - val_tn: 70581.0000 - val_fn: 9419.0000 - val_accuracy: 0.8116 - val_precision: 0.5290 - val_recall: 0.5290 - val_auc: 0.9445
[INFO] saving weights to checkpoints/lstm-epoch-5-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0559 - tp: 78334.0000 - fp: 1666.0000 - tn: 318334.0000 - fn: 1666.0000 - accuracy: 0.9917 - precision: 0.9792 - recall: 0.9792 - auc: 0.9998 - val_loss: 9.2836e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.6054e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.0128e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.4897e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.9595e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 4-4/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99774%,30:0.00132%,31:0.00038%,33:0.00019%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:91.76213%,Single Stage Single Point:8.23787%]
[INFO] ** dst:[21:43.35118%,10:20.9409%,8:18.17694%,9:17.52759%,15:0.00132%,22:0.00113%,18:0.00038%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99887%,0:0.00113%]
[INFO] ** i/f_name:[2:99.99868%,3:0.00132%]
[INFO] ** modbus_function_code:[0.02961:99.99774%,-33.760870000000004:0.00226%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99812%,0:0.00226%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99887%,2:0.00113%]
[INFO] ** proto:[0:99.99812%,1:0.00132%,2:0.00056%]
[INFO] ** proxy_src_ip:[18:38.25398%,20:26.03848%,13:18.17694%,6:17.52796%,17:0.00132%,21:0.00038%,16:0.00038%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.03773%,-0.32151:20.94071%,-1.27613:18.17657%,-0.23351:17.5274%,-0.33484:17.31326%,-71.33197:0.00132%,-1.02014:0.00038%,1.45709:0.00038%,-0.08551:0.00038%,-0.24151:0.00038%,14.4699:0.00019%,-1.2708:0.00019%,-71.14798:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-49.275529999999996:0.00019%]
[INFO] ** scada_tag:[3:26.03754%,1:20.94052%,5:18.17657%,4:17.52702%,2:17.31308%,0:0.00527%]
[INFO] ** service:[0.0048200000000000005:99.99793%,-211.73542999999998:0.00132%,-186.43601999999998:0.00038%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.25398%,9:26.03848%,7:18.17694%,1:17.52796%,21:0.00113%,15:0.00038%,4:0.00038%,17:0.00019%,14:0.00019%,8:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1453 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.3268e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.2401e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8164e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.6457e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.2842e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.9873e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.7604e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.7827 - val_tp: 18508.0000 - val_fp: 1492.0000 - val_tn: 78508.0000 - val_fn: 1492.0000 - val_accuracy: 0.9702 - val_precision: 0.9254 - val_recall: 0.9254 - val_auc: 0.9534
[INFO] saving weights to checkpoints/lstm-epoch-5-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.5441 - tp: 67026.0000 - fp: 12974.0000 - tn: 307026.0000 - fn: 12974.0000 - accuracy: 0.9351 - precision: 0.8378 - recall: 0.8378 - auc: 0.9598 - val_loss: 1.2110 - val_tp: 7784.0000 - val_fp: 12216.0000 - val_tn: 67784.0000 - val_fn: 12216.0000 - val_accuracy: 0.7557 - val_precision: 0.3892 - val_recall: 0.3892 - val_auc: 0.9055
[INFO] saving weights to checkpoints/lstm-epoch-5-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 5-5/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99642%,30:0.00245%,37:0.00019%,26:0.00019%,12:0.00019%,9:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:89.39783%,Single Stage Single Point:10.60217%]
[INFO] ** dst:[21:43.36229%,10:20.76779%,8:18.24261%,9:17.62317%,15:0.00245%,22:0.00075%,25:0.00019%,24:0.00019%,6:0.00019%,2:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99793%,0:0.00207%]
[INFO] ** i/f_name:[2:99.99755%,3:0.00245%]
[INFO] ** modbus_function_code:[0.02961:99.99642%,-33.760870000000004:0.00358%]
[INFO] ** modbus_function_description:[7:49.99868%,11:49.99774%,0:0.00358%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99812%,2:0.00188%]
[INFO] ** proto:[0:99.99718%,1:0.00245%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:38.00108%,20:26.12899%,13:18.2428%,6:17.62336%,17:0.00245%,1:0.00038%,21:0.00019%,16:0.00019%,7:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.12861%,-0.32151:20.76741%,-1.27613:18.24261%,-0.23351:17.62298%,-0.33484:17.23367%,-71.33197:0.00245%,-0.24151:0.00038%,1.47576:0.00019%,-49.275529999999996:0.00019%,-1.27347:0.00019%,-61.95768:0.00019%,-1.02014:0.00019%,1.45709:0.00019%,2.22906:0.00019%,14.4699:0.00019%,-64.19493:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:26.12824%,1:20.76722%,5:18.24242%,4:17.62298%,2:17.23367%,0:0.00546%]
[INFO] ** service:[0.0048200000000000005:99.9968%,-211.73542999999998:0.00245%,-183.8612:0.00019%,-211.08346:0.00019%,-211.35747999999998:0.00019%,-186.44547:0.00019%]
[INFO] ** src:[22:38.00108%,9:26.12899%,7:18.2428%,1:17.62336%,21:0.00207%,14:0.00056%,3:0.00038%,16:0.00019%,15:0.00019%,8:0.00019%,4:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1453 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1925 - tp: 72297.0000 - fp: 7703.0000 - tn: 312297.0000 - fn: 7703.0000 - accuracy: 0.9615 - precision: 0.9037 - recall: 0.9037 - auc: 0.9934 - val_loss: 0.3340 - val_tp: 12832.0000 - val_fp: 7168.0000 - val_tn: 72832.0000 - val_fn: 7168.0000 - val_accuracy: 0.8566 - val_precision: 0.6416 - val_recall: 0.6416 - val_auc: 0.9678
[INFO] saving weights to checkpoints/lstm-epoch-5-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0227 - tp: 79525.0000 - fp: 475.0000 - tn: 319525.0000 - fn: 475.0000 - accuracy: 0.9976 - precision: 0.9941 - recall: 0.9941 - auc: 1.0000 - val_loss: 0.0030 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2490 - tp: 72067.0000 - fp: 7933.0000 - tn: 312067.0000 - fn: 7933.0000 - accuracy: 0.9603 - precision: 0.9008 - recall: 0.9008 - auc: 0.9890 - val_loss: 0.0872 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0063 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.9144e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.5906e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3648e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 6-6/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99567%,30:0.00339%,31:0.00019%,27:0.00019%,26:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:92.39719%,Single Stage Single Point:7.60281%]
[INFO] ** dst:[21:43.37903%,10:20.72846%,8:18.28288%,9:17.60473%,15:0.00339%,22:0.00038%,25:0.00019%,24:0.00019%,18:0.00019%,12:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.9968%,0:0.0032%]
[INFO] ** i/f_name:[2:99.99661%,3:0.00339%]
[INFO] ** modbus_function_code:[0.02961:99.99567%,-33.760870000000004:0.00433%]
[INFO] ** modbus_function_description:[7:49.99831%,11:49.99737%,0:0.00433%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99567%,1:0.00339%,2:0.00094%]
[INFO] ** proxy_src_ip:[18:37.94219%,20:26.1655%,13:18.28307%,6:17.60492%,17:0.00339%,14:0.00056%,16:0.00019%,11:0.00019%]
[INFO] ** s_port:[1.45442:26.16512%,-0.32151:20.72846%,-1.27613:18.2825%,-0.23351:17.60454%,-0.33484:17.21373%,-71.33197:0.00339%,-71.14798:0.00019%,-1.02014:0.00019%,-64.19493:0.00019%,4.90362:0.00019%,-1.2708:0.00019%,-0.24151:0.00019%,13.431270000000001:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-68.36943000000001:0.00019%]
[INFO] ** scada_tag:[3:26.16493%,1:20.72827%,5:18.28232%,4:17.60417%,2:17.21354%,0:0.00677%]
[INFO] ** service:[0.0048200000000000005:99.99567%,-211.73542999999998:0.00339%,-211.08346:0.00019%,-201.23771000000002:0.00019%,-202.75898:0.00019%,-186.44547:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:37.94219%,9:26.1655%,7:18.28307%,1:17.60492%,14:0.00339%,2:0.00056%,15:0.00019%,10:0.00019%]
[INFO] ** type:[0:99.99906%,1:0.00094%]
[INFO] ** unixtime:1455 (0.27378%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3923e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8133e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.2317e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8445e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5980e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4158e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2288e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1292e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2844 - tp: 71968.0000 - fp: 8032.0000 - tn: 311968.0000 - fn: 8032.0000 - accuracy: 0.9598 - precision: 0.8996 - recall: 0.8996 - auc: 0.9862 - val_loss: 0.0866 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 7-7/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99511%,30:0.00169%,22:0.00094%,17:0.00075%,26:0.00056%,31:0.00038%,28:0.00019%,27:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:81.6046%,Single Stage Single Point:18.3954%]
[INFO] ** dst:[21:43.36134%,10:20.74408%,8:18.25353%,9:17.63427%,15:0.00169%,22:0.00151%,6:0.00151%,16:0.00075%,24:0.00038%,18:0.00038%,17:0.00038%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99831%,0:0.00169%]
[INFO] ** i/f_name:[2:99.99831%,3:0.00169%]
[INFO] ** modbus_function_code:[0.02961:99.99511%,-33.760870000000004:0.00489%]
[INFO] ** modbus_function_description:[7:49.99831%,11:49.9968%,0:0.00489%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99624%,2:0.00207%,1:0.00169%]
[INFO] ** proxy_src_ip:[18:37.96853%,20:26.13765%,13:18.2539%,6:17.63446%,17:0.00169%,11:0.00075%,1:0.00075%,21:0.00056%,16:0.00056%,14:0.00038%,7:0.00038%,10:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.13671%,-0.32151:20.74408%,-1.27613:18.25334%,-0.23351:17.63409%,-0.33484:17.22445%,-71.33197:0.00169%,-71.14931:0.00094%,-1.02014:0.00056%,-71.14798:0.00056%,1.45709:0.00056%,-0.24151:0.00038%,-1.27347:0.00038%,1.47576:0.00019%,1.46509:0.00019%,14.253910000000001:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,-68.79874000000001:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,6.1115699999999995:0.00019%,-5.08665:0.00019%,-5.1466400000000005:0.00019%]
[INFO] ** scada_tag:[3:26.13633%,1:20.74408%,5:18.25315%,4:17.6339%,2:17.22445%,0:0.00809%]
[INFO] ** service:[0.0048200000000000005:99.99511%,-211.73542999999998:0.00169%,-211.08818:0.00094%,-205.44247:0.00075%,-211.08346:0.00056%,-186.43601999999998:0.00038%,-211.09762999999998:0.00019%,-185.9872:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:37.96853%,9:26.13765%,7:18.2539%,1:17.63446%,14:0.00169%,10:0.00075%,3:0.00075%,15:0.00056%,4:0.00056%,21:0.00038%,2:0.00038%,11:0.00019%,8:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1452 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0187 - tp: 79779.0000 - fp: 221.0000 - tn: 319779.0000 - fn: 221.0000 - accuracy: 0.9989 - precision: 0.9972 - recall: 0.9972 - auc: 0.9998 - val_loss: 0.0029 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0019 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0014 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1227 - tp: 77291.0000 - fp: 2709.0000 - tn: 317291.0000 - fn: 2709.0000 - accuracy: 0.9865 - precision: 0.9661 - recall: 0.9661 - auc: 0.9960 - val_loss: 0.8518 - val_tp: 12857.0000 - val_fp: 7143.0000 - val_tn: 72857.0000 - val_fn: 7143.0000 - val_accuracy: 0.8571 - val_precision: 0.6428 - val_recall: 0.6428 - val_auc: 0.9681
[INFO] saving weights to checkpoints/lstm-epoch-5-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0352 - tp: 78589.0000 - fp: 1411.0000 - tn: 318589.0000 - fn: 1411.0000 - accuracy: 0.9929 - precision: 0.9824 - recall: 0.9824 - auc: 0.9998 - val_loss: 2.4958e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.3387e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.1982e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 8-8/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99699%,30:0.00113%,0:0.00056%,24:0.00019%,23:0.00019%,22:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:94.62262%,Single Stage Single Point:5.37738%]
[INFO] ** dst:[21:43.4272%,10:20.80975%,8:18.17901%,9:17.58027%,22:0.00132%,15:0.00113%,25:0.00056%,19:0.00038%,26:0.00019%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99925%,0:0.00075%]
[INFO] ** i/f_name:[2:99.99887%,3:0.00113%]
[INFO] ** modbus_function_code:[0.02961:99.99699%,-33.760870000000004:0.00282%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99737%,0:0.00282%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99962%,2:0.00038%]
[INFO] ** proto:[0:99.99812%,1:0.00113%,2:0.00075%]
[INFO] ** proxy_src_ip:[18:38.09686%,20:26.14066%,13:18.17826%,6:17.58065%,17:0.00113%,10:0.00113%,16:0.00056%,14:0.00038%,11:0.00019%,5:0.00019%]
[INFO] ** s_port:[1.45442:26.14009%,-0.32151:20.80975%,-1.27613:18.17807%,-0.23351:17.58008%,-0.33484:17.28711%,-71.33197:0.00113%,-15.039579999999999:0.00075%,-1.02014:0.00056%,-64.19493:0.00056%,1.45709:0.00038%,-0.24151:0.00038%,4.66896:0.00038%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-71.14931:0.00019%]
[INFO] ** scada_tag:[3:26.13972%,1:20.80956%,5:18.17807%,4:17.57989%,2:17.28692%,0:0.00583%]
[INFO] ** service:[0.0048200000000000005:99.99774%,-211.73542999999998:0.00113%,-186.44547:0.00056%,-211.07873999999998:0.00038%,-211.08818:0.00019%]
[INFO] ** src:[22:38.09686%,9:26.14066%,7:18.17826%,1:17.58065%,11:0.00113%,14:0.00075%,15:0.00056%,21:0.00038%,2:0.00038%,16:0.00019%,10:0.00019%]
[INFO] ** type:[0:99.99944%,1:0.00038%,2:0.00019%]
[INFO] ** unixtime:1456 (0.27397%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.0550e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2103e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.1834e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5766e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0682e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5613e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0600 - tp: 78864.0000 - fp: 1136.0000 - tn: 318864.0000 - fn: 1136.0000 - accuracy: 0.9943 - precision: 0.9858 - recall: 0.9858 - auc: 0.9987 - val_loss: 0.4778 - val_tp: 16406.0000 - val_fp: 3594.0000 - val_tn: 76406.0000 - val_fn: 3594.0000 - val_accuracy: 0.9281 - val_precision: 0.8203 - val_recall: 0.8203 - val_auc: 0.9919
[INFO] saving weights to checkpoints/lstm-epoch-5-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0239 - tp: 79283.0000 - fp: 717.0000 - tn: 319283.0000 - fn: 717.0000 - accuracy: 0.9964 - precision: 0.9910 - recall: 0.9910 - auc: 0.9999 - val_loss: 0.0012 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 9-9/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99831%,30:0.00094%,31:0.00038%,26:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:95.26332%,Single Stage Single Point:4.73668%]
[INFO] ** dst:[21:43.36341%,10:20.77776%,8:18.28646%,9:17.56973%,15:0.00094%,22:0.00075%,18:0.00038%,25:0.00019%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99906%,0:0.00094%]
[INFO] ** i/f_name:[2:99.99906%,3:0.00094%]
[INFO] ** modbus_function_code:[0.02961:99.99831%,-33.760870000000004:0.00169%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99849%,0:0.00169%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99981%,2:0.00019%]
[INFO] ** proto:[0:99.99831%,1:0.00094%,2:0.00075%]
[INFO] ** proxy_src_ip:[18:38.01407%,20:26.12767%,13:18.28664%,6:17.56992%,17:0.00094%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.12692%,-0.32151:20.77776%,-1.27613:18.28627%,-0.23351:17.56955%,-0.33484:17.23631%,-71.33197:0.00094%,1.45709:0.00038%,-0.24151:0.00038%,-0.08551:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:26.12654%,1:20.77757%,5:18.28627%,4:17.56936%,2:17.23631%,0:0.00395%]
[INFO] ** service:[0.0048200000000000005:99.99831%,-211.73542999999998:0.00094%,-186.43601999999998:0.00038%,-211.08346:0.00019%,-186.44547:0.00019%]
[INFO] ** src:[22:38.01407%,9:26.12767%,7:18.28664%,1:17.56992%,14:0.00075%,21:0.00019%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1454 (0.27359%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.3860e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1340e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1583 - tp: 72736.0000 - fp: 7264.0000 - tn: 312736.0000 - fn: 7264.0000 - accuracy: 0.9637 - precision: 0.9092 - recall: 0.9092 - auc: 0.9942 - val_loss: 0.1149 - val_tp: 19180.0000 - val_fp: 820.0000 - val_tn: 79180.0000 - val_fn: 820.0000 - val_accuracy: 0.9836 - val_precision: 0.9590 - val_recall: 0.9590 - val_auc: 0.9988
[INFO] saving weights to checkpoints/lstm-epoch-5-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0045 - tp: 79971.0000 - fp: 29.0000 - tn: 319971.0000 - fn: 29.0000 - accuracy: 0.9999 - precision: 0.9996 - recall: 0.9996 - auc: 1.0000 - val_loss: 1.2945e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0442e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.4279e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.1985e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.4129e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 10-10/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99605%,30:0.00188%,31:0.00038%,26:0.00019%,24:0.00019%,23:0.00019%,22:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:94.25174%,Single Stage Single Point:5.74826%]
[INFO] ** dst:[21:43.4097%,10:20.81107%,8:18.22605%,9:17.54904%,15:0.00188%,22:0.00056%,24:0.00038%,19:0.00038%,18:0.00038%,26:0.00019%,25:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99831%,0:0.00169%]
[INFO] ** i/f_name:[2:99.99812%,3:0.00188%]
[INFO] ** modbus_function_code:[0.02961:99.99605%,-33.760870000000004:0.00376%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99868%,11:49.99737%,0:0.00376%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99925%,1:0.00075%]
[INFO] ** proto:[0:99.99718%,1:0.00188%,2:0.00094%]
[INFO] ** proxy_src_ip:[18:38.09234%,20:26.1288%,13:18.22624%,6:17.54847%,17:0.00188%,10:0.00094%,14:0.00038%,21:0.00019%,16:0.00019%,5:0.00019%,2:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.12824%,-0.32151:20.81107%,-1.27613:18.22568%,-0.23351:17.5481%,-0.33484:17.28128%,-71.33197:0.00188%,-10.51843:0.00075%,-0.08551:0.00038%,-1.27347:0.00038%,5.71692:0.00038%,1.47576:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-71.14931:0.00019%,-64.19493:0.00019%,1.45709:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:26.12786%,1:20.81088%,5:18.22568%,4:17.54791%,2:17.28109%,0:0.00659%]
[INFO] ** service:[0.0048200000000000005:99.9968%,-211.73542999999998:0.00188%,-211.07873999999998:0.00038%,-186.43601999999998:0.00038%,-211.08346:0.00019%,-186.44547:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.09234%,9:26.1288%,7:18.22624%,1:17.54847%,14:0.00188%,11:0.00094%,2:0.00038%,17:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,4:0.00019%]
[INFO] ** type:[0:99.99849%,1:0.00132%,2:0.00019%]
[INFO] ** unixtime:1452 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.4862e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.2959e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.8302e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.4687e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2517 - tp: 74611.0000 - fp: 5389.0000 - tn: 314611.0000 - fn: 5389.0000 - accuracy: 0.9731 - precision: 0.9326 - recall: 0.9326 - auc: 0.9872 - val_loss: 0.1667 - val_tp: 18766.0000 - val_fp: 1234.0000 - val_tn: 78766.0000 - val_fn: 1234.0000 - val_accuracy: 0.9753 - val_precision: 0.9383 - val_recall: 0.9383 - val_auc: 0.9944
[INFO] saving weights to checkpoints/lstm-epoch-5-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0177 - tp: 79172.0000 - fp: 828.0000 - tn: 319172.0000 - fn: 828.0000 - accuracy: 0.9959 - precision: 0.9897 - recall: 0.9897 - auc: 1.0000 - val_loss: 5.1908e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.6658e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5066e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 11-11/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99887%,31:0.00038%,30:0.00038%,26:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.38298%,10:20.87617%,8:18.20178%,9:17.53662%,22:0.00132%,18:0.00038%,15:0.00038%,25:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99887%,-33.760870000000004:0.00113%]
[INFO] ** modbus_function_description:[7:50.00056%,11:49.99831%,0:0.00113%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99887%,2:0.00075%,1:0.00038%]
[INFO] ** proxy_src_ip:[18:38.14371%,20:26.11582%,13:18.20178%,6:17.53699%,16:0.00056%,17:0.00038%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.11525%,-0.32151:20.87617%,-1.27613:18.20159%,-0.23351:17.53643%,-0.33484:17.26754%,-0.24151:0.00056%,-1.02014:0.00056%,-0.08551:0.00038%,-71.33197:0.00038%,-71.14798:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:26.11488%,1:20.87617%,5:18.2014%,4:17.53605%,2:17.26735%,0:0.00414%]
[INFO] ** service:[0.0048200000000000005:99.99887%,-211.73542999999998:0.00038%,-186.43601999999998:0.00038%,-211.08346:0.00019%,-186.44547:0.00019%]
[INFO] ** src:[22:38.14371%,9:26.11582%,7:18.20178%,1:17.53699%,15:0.00056%,14:0.00038%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1453 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7312e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8955e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5777e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4083e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2387e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0727e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0009e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.4836e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.8217e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.2016e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 12-12/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99774%,30:0.00207%,9:0.00019%]
[INFO] ** classification:[normal:93.19011%,Single Stage Single Point:6.80989%]
[INFO] ** dst:[21:43.39672%,10:20.87542%,8:18.19011%,9:17.53455%,15:0.00207%,22:0.00056%,24:0.00038%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99831%,0:0.00169%]
[INFO] ** i/f_name:[2:99.99793%,3:0.00207%]
[INFO] ** modbus_function_code:[0.02961:99.99774%,-33.760870000000004:0.00226%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99812%,0:0.00226%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99831%,2:0.00169%]
[INFO] ** proto:[0:99.99793%,1:0.00207%]
[INFO] ** proxy_src_ip:[18:38.14729%,20:26.12523%,13:18.1903%,6:17.53474%,17:0.00207%,16:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:26.12466%,-0.32151:20.87542%,-1.27613:18.18974%,-0.23351:17.53436%,-0.33484:17.27187%,-71.33197:0.00207%,-1.27347:0.00038%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,14.4699:0.00019%]
[INFO] ** scada_tag:[3:26.12429%,1:20.87542%,5:18.18974%,4:17.53398%,2:17.27187%,0:0.0047%]
[INFO] ** service:[0.0048200000000000005:99.99774%,-211.73542999999998:0.00207%,-183.8612:0.00019%]
[INFO] ** src:[22:38.14729%,9:26.12523%,7:18.1903%,1:17.53474%,21:0.00169%,14:0.00038%,15:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1453 (0.2734%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.8575e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.4007e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.0644e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.6388e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3285 - tp: 70696.0000 - fp: 9304.0000 - tn: 310696.0000 - fn: 9304.0000 - accuracy: 0.9535 - precision: 0.8837 - recall: 0.8837 - auc: 0.9830 - val_loss: 0.1428 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2209 - tp: 71383.0000 - fp: 8617.0000 - tn: 311383.0000 - fn: 8617.0000 - accuracy: 0.9569 - precision: 0.8923 - recall: 0.8923 - auc: 0.9905 - val_loss: 0.1157 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0067 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7095e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 13-13/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99642%,31:0.00075%,26:0.00056%,0:0.00056%,30:0.00038%,22:0.00038%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:85.60292%,Single Stage Single Point:14.39708%]
[INFO] ** dst:[21:43.35457%,10:20.79921%,8:18.28025%,9:17.56183%,22:0.00113%,6:0.00094%,18:0.00075%,25:0.00056%,15:0.00038%,24:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99642%,-33.760870000000004:0.00339%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99868%,11:49.99774%,0:0.00339%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99718%,2:0.00245%,1:0.00038%]
[INFO] ** proxy_src_ip:[18:38.05114%,20:26.10302%,13:18.28043%,6:17.56127%,10:0.00113%,11:0.00094%,16:0.00056%,17:0.00038%,7:0.00038%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.10246%,-0.32151:20.79921%,-1.27613:18.28006%,-0.23351:17.56089%,-0.33484:17.25192%,-9.78512:0.00075%,-64.19493:0.00056%,-1.02014:0.00056%,-71.14798:0.00056%,-0.24151:0.00038%,-71.14931:0.00038%,-0.08551:0.00038%,-71.33197:0.00038%,1.47576:0.00019%,-1.27347:0.00019%,1.46509:0.00019%,-1.2708:0.00019%,-68.79874000000001:0.00019%,6.1115699999999995:0.00019%,14.540560000000001:0.00019%,1.45709:0.00019%]
[INFO] ** scada_tag:[3:26.10208%,1:20.79902%,5:18.28006%,4:17.56089%,2:17.25173%,0:0.00621%]
[INFO] ** service:[0.0048200000000000005:99.99718%,-186.43601999999998:0.00075%,-211.08346:0.00056%,-186.44547:0.00056%,-211.73542999999998:0.00038%,-211.08818:0.00038%,-202.75898:0.00019%]
[INFO] ** src:[22:38.05114%,9:26.10302%,7:18.28043%,1:17.56127%,11:0.00113%,10:0.00094%,15:0.00056%,21:0.00038%,14:0.00038%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1452 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.4880e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2768e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.8655e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4733e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2118e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0158e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2848 - tp: 72370.0000 - fp: 7630.0000 - tn: 312370.0000 - fn: 7630.0000 - accuracy: 0.9618 - precision: 0.9046 - recall: 0.9046 - auc: 0.9856 - val_loss: 0.0886 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0074 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.2260e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 14-14/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99962%,30:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:94.60248%,Single Stage Single Point:5.39752%]
[INFO] ** dst:[21:43.34629%,10:20.80994%,8:18.26651%,9:17.57576%,22:0.00075%,24:0.00038%,15:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99962%,-33.760870000000004:0.00038%]
[INFO] ** modbus_function_description:[7:50.00075%,11:49.99887%,0:0.00038%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99981%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.04775%,20:26.10905%,13:18.2667%,6:17.57594%,17:0.00019%,16:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:26.10829%,-0.32151:20.80994%,-1.27613:18.26613%,-0.23351:17.57557%,-0.33484:17.23781%,-1.27347:0.00038%,1.45709:0.00038%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,14.4699:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:26.10792%,1:20.80994%,5:18.26595%,4:17.57519%,2:17.23762%,0:0.00339%]
[INFO] ** service:[0.0048200000000000005:99.99962%,-183.8612:0.00019%,-211.73542999999998:0.00019%]
[INFO] ** src:[22:38.04775%,9:26.10905%,7:18.2667%,1:17.57594%,15:0.00019%,14:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1452 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.2655e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2633 - val_tp: 12830.0000 - val_fp: 7170.0000 - val_tn: 72830.0000 - val_fn: 7170.0000 - val_accuracy: 0.8566 - val_precision: 0.6415 - val_recall: 0.6415 - val_auc: 0.7761
[INFO] saving weights to checkpoints/lstm-epoch-5-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1129 - tp: 78087.0000 - fp: 1913.0000 - tn: 318087.0000 - fn: 1913.0000 - accuracy: 0.9904 - precision: 0.9761 - recall: 0.9761 - auc: 0.9940 - val_loss: 0.0011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.3999e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7725e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.3719e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9100e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3759e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6137e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 15-15/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (531448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (531448, 17)

[INFO] analyzing data
[INFO] 531448 rows
[INFO] ** appi_name:[21:99.99624%,30:0.00301%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:89.60764%,Single Stage Multi Point:10.39161%,Single Stage Single Point:0.00075%]
[INFO] ** dst:[21:43.29963%,10:20.774%,8:18.31355%,9:17.60756%,15:0.00301%,22:0.00151%,25:0.00019%,24:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99699%,0:0.00301%]
[INFO] ** i/f_name:[2:99.99699%,3:0.00301%]
[INFO] ** modbus_function_code:[0.02961:99.99624%,-33.760870000000004:0.00376%]
[INFO] ** modbus_function_description:[7:49.99906%,11:49.99718%,0:0.00376%]
[INFO] ** modbus_transaction_id:65536 (12.33159%)
[INFO] ** orig:[0:99.99718%,2:0.00282%]
[INFO] ** proto:[0:99.99661%,1:0.00301%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:38.00579%,20:26.0684%,13:18.31336%,6:17.60812%,17:0.00301%,16:0.00056%,7:0.00038%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.06765%,-0.32151:20.77381%,-1.27613:18.31317%,-0.23351:17.60737%,-0.33484:17.23198%,-71.33197:0.00301%,-0.24151:0.00056%,-1.02014:0.00056%,1.45709:0.00038%,1.46509:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,-61.95768:0.00019%,10.192739999999999:0.00019%,-64.19493:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:26.06727%,1:20.77362%,5:18.31317%,4:17.60699%,2:17.23179%,0:0.00715%]
[INFO] ** service:[0.0048200000000000005:99.99642%,-211.73542999999998:0.00301%,-211.08346:0.00019%,-205.44247:0.00019%,-186.44547:0.00019%]
[INFO] ** src:[22:38.00579%,9:26.0684%,7:18.31336%,1:17.60812%,21:0.0032%,15:0.00056%,16:0.00019%,14:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1461 (0.27491%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.9024e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1165e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.1947e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.9230e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7544e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.4136e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6737e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8994e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/531448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.2659 - tp: 48900.0000 - fp: 31100.0000 - tn: 288900.0000 - fn: 31100.0000 - accuracy: 0.8445 - precision: 0.6112 - recall: 0.6112 - auc: 0.7570 - val_loss: 7.5514 - val_tp: 10630.0000 - val_fp: 9370.0000 - val_tn: 70630.0000 - val_fn: 9370.0000 - val_accuracy: 0.8126 - val_precision: 0.5315 - val_recall: 0.5315 - val_auc: 0.7072
[INFO] saving weights to checkpoints/lstm-epoch-5-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/531448
[33m[INFO] loading file 16-16/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (471138, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (471138, 17)

[INFO] analyzing data
[INFO] 471138 rows
[INFO] ** appi_name:[21:99.9983%,30:0.00149%,33:0.00021%]
[INFO] ** classification:[normal:82.32683%,Single Stage Multi Point:17.67317%]
[INFO] ** dst:[21:43.35312%,10:20.80049%,8:18.2507%,9:17.59272%,15:0.00149%,22:0.00127%,24:0.00021%]
[INFO] ** i/f_dir:[1:99.99851%,0:0.00149%]
[INFO] ** i/f_name:[2:99.99851%,3:0.00149%]
[INFO] ** modbus_function_code:[0.02961:99.9983%,-33.760870000000004:0.0017%]
[INFO] ** modbus_function_description:[7:50.00042%,11:49.99788%,0:0.0017%]
[INFO] ** modbus_transaction_id:65536 (13.91015%)
[INFO] ** orig:[0:99.99851%,2:0.00149%]
[INFO] ** proto:[0:99.99851%,1:0.00149%]
[INFO] ** proxy_src_ip:[18:38.0483%,20:26.10551%,13:18.25113%,6:17.59293%,17:0.00149%,16:0.00042%,21:0.00021%]
[INFO] ** s_port:[1.45442:26.10488%,-0.32151:20.80028%,-1.27613:18.2507%,-0.23351:17.59251%,-0.33484:17.24802%,-71.33197:0.00149%,1.45709:0.00042%,-0.24151:0.00042%,-1.02014:0.00042%,-1.27347:0.00021%,1.47576:0.00021%,-49.275529999999996:0.00021%,-1.2708:0.00021%]
[INFO] ** scada_tag:[3:26.10445%,1:20.80028%,5:18.25049%,4:17.59209%,2:17.24781%,0:0.00488%]
[INFO] ** service:[0.0048200000000000005:99.99851%,-211.73542999999998:0.00149%]
[INFO] ** src:[22:38.0483%,9:26.10551%,7:18.25113%,1:17.59293%,21:0.00149%,15:0.00042%,4:0.00021%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1289 (0.27359%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/471138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5616 - tp: 42469.0000 - fp: 37531.0000 - tn: 282469.0000 - fn: 37531.0000 - accuracy: 0.8123 - precision: 0.5309 - recall: 0.5309 - auc: 0.7068 - val_loss: 7.5425 - val_tp: 10641.0000 - val_fp: 9359.0000 - val_tn: 70641.0000 - val_fn: 9359.0000 - val_accuracy: 0.8128 - val_precision: 0.5321 - val_recall: 0.5321 - val_auc: 0.7075
[INFO] saving weights to checkpoints/lstm-epoch-5-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/471138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.3287 - tp: 43625.0000 - fp: 36375.0000 - tn: 283625.0000 - fn: 36375.0000 - accuracy: 0.8181 - precision: 0.5453 - recall: 0.5453 - auc: 0.7158 - val_loss: 1.8352e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/471138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6424e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5178e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/471138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2522e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1377e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/471138
[33m[INFO] loading file 17-17/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571138, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571138, 17)

[INFO] analyzing data
[INFO] 571138 rows
[INFO] ** appi_name:[21:99.9972%,7:0.00053%,26:0.00035%,0:0.00035%,33:0.00018%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:94.5985%,Multi Stage Multi Point:5.4015%]
[INFO] ** dst:[21:43.35257%,10:20.84172%,8:18.20348%,9:17.59942%,22:0.0007%,6:0.00053%,25:0.00035%,16:0.00035%,2:0.00035%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.9972%,-33.760870000000004:0.00263%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99965%,11:49.99755%,0:0.00263%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.47463%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99877%,2:0.00123%]
[INFO] ** proxy_src_ip:[18:38.07871%,20:26.11611%,13:18.20296%,6:17.59925%,10:0.00105%,11:0.00088%,1:0.00035%,21:0.00018%,16:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.11523%,-0.32151:20.84155%,-1.27613:18.20261%,-0.23351:17.59907%,-0.33484:17.23717%,6.0369:0.0007%,1.47576:0.00035%,-71.14798:0.00035%,1.45709:0.00035%,-64.19493:0.00035%,1.46509:0.00018%,-68.79874000000001:0.00018%,-49.275529999999996:0.00018%,-1.27347:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,6.15557:0.00018%,6.06224:0.00018%,8.55414:0.00018%,-3.3787199999999995:0.00018%,-4.3880099999999995:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.11505%,1:20.84137%,5:18.20243%,4:17.59855%,2:17.23717%,0:0.00543%]
[INFO] ** service:[0.0048200000000000005:99.99807%,-211.09762999999998:0.00053%,-211.08346:0.00035%,-186.44547:0.00035%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.07871%,9:26.11611%,7:18.20296%,1:17.59925%,11:0.00105%,10:0.00088%,3:0.00035%,21:0.00018%,15:0.00018%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1560 (0.27314%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0226e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.4971e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.4630e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.0338e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.9467e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.3637e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1400 - tp: 74342.0000 - fp: 5658.0000 - tn: 314342.0000 - fn: 5658.0000 - accuracy: 0.9717 - precision: 0.9293 - recall: 0.9293 - auc: 0.9558 - val_loss: 2.9367 - val_tp: 16356.0000 - val_fp: 3644.0000 - val_tn: 76356.0000 - val_fn: 3644.0000 - val_accuracy: 0.9271 - val_precision: 0.8178 - val_recall: 0.8178 - val_auc: 0.8861
[INFO] saving weights to checkpoints/lstm-epoch-5-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9170 - tp: 65522.0000 - fp: 14478.0000 - tn: 305522.0000 - fn: 14478.0000 - accuracy: 0.9276 - precision: 0.8190 - recall: 0.8190 - auc: 0.8869 - val_loss: 2.9222 - val_tp: 16374.0000 - val_fp: 3626.0000 - val_tn: 76374.0000 - val_fn: 3626.0000 - val_accuracy: 0.9275 - val_precision: 0.8187 - val_recall: 0.8187 - val_auc: 0.8867
[INFO] saving weights to checkpoints/lstm-epoch-5-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/571138
[33m[INFO] loading file 18-18/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571138, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571138, 17)

[INFO] analyzing data
[INFO] 571138 rows
[INFO] ** appi_name:[21:99.99825%,30:0.00053%,7:0.00053%,31:0.00018%,27:0.00018%,22:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:82.41371%,Multi Stage Multi Point:17.58629%]
[INFO] ** dst:[21:43.34224%,10:20.83279%,8:18.25881%,9:17.56336%,22:0.0007%,15:0.00053%,24:0.00035%,16:0.00035%,2:0.00035%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99947%,0:0.00053%]
[INFO] ** i/f_name:[2:99.99947%,3:0.00053%]
[INFO] ** modbus_function_code:[0.02961:99.99825%,-33.760870000000004:0.00175%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99825%,0:0.00175%]
[INFO] ** modbus_transaction_id:65536 (11.47463%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99895%,2:0.00053%,1:0.00053%]
[INFO] ** proxy_src_ip:[18:38.08029%,20:26.09527%,13:18.25916%,6:17.56353%,17:0.00053%,11:0.00053%,1:0.00035%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.09457%,-0.32151:20.83279%,-1.27613:18.25863%,-0.23351:17.56318%,-0.33484:17.2475%,-71.33197:0.00053%,-1.27347:0.00035%,1.45709:0.00035%,-0.24151:0.00035%,1.47576:0.00018%,1.46509:0.00018%,3.6236699999999997:0.00018%,-1.2708:0.00018%,-2.48275:0.00018%,6.06224:0.00018%,-3.3787199999999995:0.00018%,8.10082:0.00018%,6.45955:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.09422%,1:20.83262%,5:18.25846%,4:17.56301%,2:17.24732%,0:0.00438%]
[INFO] ** service:[0.0048200000000000005:99.99825%,-211.09762999999998:0.00053%,-211.73542999999998:0.00053%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.08029%,9:26.09527%,7:18.25916%,1:17.56353%,14:0.00053%,10:0.00053%,3:0.00035%,21:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1561 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.6939 - tp: 76556.0000 - fp: 3444.0000 - tn: 316556.0000 - fn: 3444.0000 - accuracy: 0.9828 - precision: 0.9570 - recall: 0.9570 - auc: 0.9731 - val_loss: 2.8328 - val_tp: 16485.0000 - val_fp: 3515.0000 - val_tn: 76485.0000 - val_fn: 3515.0000 - val_accuracy: 0.9297 - val_precision: 0.8242 - val_recall: 0.8242 - val_auc: 0.8902
[INFO] saving weights to checkpoints/lstm-epoch-5-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 6.1190 - tp: 49629.0000 - fp: 30371.0000 - tn: 289629.0000 - fn: 30371.0000 - accuracy: 0.8481 - precision: 0.6204 - recall: 0.6204 - auc: 0.7627 - val_loss: 6.1620 - val_tp: 12354.0000 - val_fp: 7646.0000 - val_tn: 72354.0000 - val_fn: 7646.0000 - val_accuracy: 0.8471 - val_precision: 0.6177 - val_recall: 0.6177 - val_auc: 0.7611
[INFO] saving weights to checkpoints/lstm-epoch-5-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 6.1317 - tp: 49566.0000 - fp: 30434.0000 - tn: 289566.0000 - fn: 30434.0000 - accuracy: 0.8478 - precision: 0.6196 - recall: 0.6196 - auc: 0.7622 - val_loss: 6.0983 - val_tp: 12433.0000 - val_fp: 7567.0000 - val_tn: 72433.0000 - val_fn: 7567.0000 - val_accuracy: 0.8487 - val_precision: 0.6216 - val_recall: 0.6216 - val_auc: 0.7635
[INFO] saving weights to checkpoints/lstm-epoch-5-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.5188 - tp: 62535.0000 - fp: 17465.0000 - tn: 302535.0000 - fn: 17465.0000 - accuracy: 0.9127 - precision: 0.7817 - recall: 0.7817 - auc: 0.8636 - val_loss: 2.1919e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.9959e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7446e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/571138
[33m[INFO] loading file 19-19/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571138, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571138, 17)

[INFO] analyzing data
[INFO] 571138 rows
[INFO] ** appi_name:[21:99.99807%,26:0.00035%,0:0.00035%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:87.47063%,Single Stage Multi Point:12.52937%]
[INFO] ** dst:[21:43.39161%,10:20.82439%,8:18.20803%,9:17.57334%,22:0.00123%,6:0.00053%,25:0.00035%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99807%,-33.760870000000004:0.00175%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99807%,0:0.00175%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.47463%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99877%,2:0.00123%]
[INFO] ** proxy_src_ip:[18:38.1118%,20:26.10437%,13:18.20803%,6:17.57334%,10:0.00105%,11:0.00088%,16:0.00053%]
[INFO] ** s_port:[1.45442:26.10332%,-0.32151:20.82439%,-1.27613:18.20768%,-0.23351:17.57316%,-0.33484:17.28742%,-5.20264:0.0007%,1.45709:0.00053%,-1.02014:0.00053%,-64.19493:0.00035%,-71.14798:0.00035%,1.46509:0.00035%,-1.27347:0.00018%,-0.24151:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-71.14931:0.00018%,-68.79874000000001:0.00018%,0.75578:0.00018%]
[INFO] ** scada_tag:[3:26.10297%,1:20.82421%,5:18.20751%,4:17.57299%,2:17.28724%,0:0.00508%]
[INFO] ** service:[0.0048200000000000005:99.99877%,-211.08346:0.00035%,-186.44547:0.00035%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.1118%,9:26.10437%,7:18.20803%,1:17.57334%,11:0.00105%,10:0.00088%,15:0.00053%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1562 (0.27349%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.6568e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4416e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 8s - loss: 1.2938e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2107e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 8s - loss: 1.1161e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.7086e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 9.3318e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9818 - val_tp: 16300.0000 - val_fp: 3700.0000 - val_tn: 76300.0000 - val_fn: 3700.0000 - val_accuracy: 0.9260 - val_precision: 0.8150 - val_recall: 0.8150 - val_auc: 0.8844
[INFO] saving weights to checkpoints/lstm-epoch-5-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 9.8232 - tp: 31244.0000 - fp: 48756.0000 - tn: 271244.0000 - fn: 48756.0000 - accuracy: 0.7562 - precision: 0.3905 - recall: 0.3905 - auc: 0.6191 - val_loss: 9.8667 - val_tp: 7757.0000 - val_fp: 12243.0000 - val_tn: 67757.0000 - val_fn: 12243.0000 - val_accuracy: 0.7551 - val_precision: 0.3878 - val_recall: 0.3878 - val_auc: 0.6174
[INFO] saving weights to checkpoints/lstm-epoch-5-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/571138
[33m[INFO] loading file 20-20/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571138, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571138, 17)

[INFO] analyzing data
[INFO] 571138 rows
[INFO] ** appi_name:[21:99.99667%,30:0.0028%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:91.62374%,Single Stage Multi Point:8.37626%]
[INFO] ** dst:[21:43.42313%,10:20.8377%,8:18.16006%,9:17.57421%,15:0.0028%,22:0.00123%,24:0.00035%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99755%,0:0.00245%]
[INFO] ** i/f_name:[2:99.9972%,3:0.0028%]
[INFO] ** modbus_function_code:[0.02961:99.99667%,-33.760870000000004:0.00333%]
[INFO] ** modbus_function_description:[7:49.99982%,11:49.99685%,0:0.00333%]
[INFO] ** modbus_transaction_id:65536 (11.47463%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99667%,1:0.0028%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.11303%,20:26.1485%,13:18.16023%,6:17.57474%,17:0.0028%,14:0.00053%,16:0.00018%]
[INFO] ** s_port:[1.45442:26.14762%,-0.32151:20.8377%,-1.27613:18.15971%,-0.23351:17.57404%,-0.33484:17.27533%,-71.33197:0.0028%,1.45709:0.00053%,-0.24151:0.00053%,-1.27347:0.00035%,13.431270000000001:0.00018%,-1.2708:0.00018%,-1.02014:0.00018%,-71.14798:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:26.1471%,1:20.83752%,5:18.15971%,4:17.57369%,2:17.27516%,0:0.00683%]
[INFO] ** service:[0.0048200000000000005:99.99667%,-211.73542999999998:0.0028%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.11303%,9:26.1485%,7:18.16023%,1:17.57474%,14:0.0028%,2:0.00053%,15:0.00018%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1561 (0.27331%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.3823 - tp: 73139.0000 - fp: 6861.0000 - tn: 313139.0000 - fn: 6861.0000 - accuracy: 0.9657 - precision: 0.9142 - recall: 0.9142 - auc: 0.9464 - val_loss: 7.1695e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8860 - tp: 70639.0000 - fp: 9361.0000 - tn: 310639.0000 - fn: 9361.0000 - accuracy: 0.9532 - precision: 0.8830 - recall: 0.8830 - auc: 0.9269 - val_loss: 2.9222 - val_tp: 16374.0000 - val_fp: 3626.0000 - val_tn: 76374.0000 - val_fn: 3626.0000 - val_accuracy: 0.9275 - val_precision: 0.8187 - val_recall: 0.8187 - val_auc: 0.8867
[INFO] saving weights to checkpoints/lstm-epoch-5-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9569 - tp: 65324.0000 - fp: 14676.0000 - tn: 305324.0000 - fn: 14676.0000 - accuracy: 0.9266 - precision: 0.8166 - recall: 0.8166 - auc: 0.8853 - val_loss: 2.9077 - val_tp: 16392.0000 - val_fp: 3608.0000 - val_tn: 76392.0000 - val_fn: 3608.0000 - val_accuracy: 0.9278 - val_precision: 0.8196 - val_recall: 0.8196 - val_auc: 0.8873
[INFO] saving weights to checkpoints/lstm-epoch-5-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9559 - tp: 70292.0000 - fp: 9708.0000 - tn: 310292.0000 - fn: 9708.0000 - accuracy: 0.9515 - precision: 0.8787 - recall: 0.8787 - auc: 0.9242 - val_loss: 5.3942e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/571138
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.0699e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8863e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/571138
[33m[INFO] loading file 21-21/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571136, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571136, 17)

[INFO] analyzing data
[INFO] 571136 rows
[INFO] ** appi_name:[21:99.99615%,30:0.00105%,7:0.00053%,26:0.00035%,22:0.00035%,0:0.00035%,31:0.00018%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:98.93143%,Multi Stage Single Point:1.06857%]
[INFO] ** dst:[21:43.31718%,10:20.98029%,8:18.16275%,9:17.53505%,15:0.00105%,22:0.00088%,24:0.0007%,6:0.0007%,25:0.00035%,16:0.00035%,2:0.00035%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99895%,0:0.00105%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.99615%,-33.760870000000004:0.00368%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99912%,11:49.99702%,0:0.00368%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.47468%)
[INFO] ** orig:[0:99.9993%,2:0.0007%]
[INFO] ** proto:[0:99.99755%,2:0.0014%,1:0.00105%]
[INFO] ** proxy_src_ip:[18:38.30594%,20:25.99136%,13:18.16345%,6:17.53488%,17:0.00105%,10:0.00105%,11:0.00088%,16:0.00053%,1:0.00035%,21:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.99066%,-0.32151:20.97959%,-1.27613:18.16257%,-0.23351:17.5347%,-0.33484:17.32635%,-71.33197:0.00105%,-1.27347:0.0007%,-6.64392:0.0007%,-1.02014:0.00053%,-64.19493:0.00035%,-71.14931:0.00035%,-71.14798:0.00035%,1.47576:0.00035%,1.46509:0.00018%,-1.2708:0.00018%,6.62488:0.00018%,10.15141:0.00018%,-68.79874000000001:0.00018%,7.060860000000001:0.00018%,-3.3787199999999995:0.00018%,-2.2440900000000004:0.00018%,1.45709:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.99013%,1:20.97942%,5:18.1624%,4:17.53435%,2:17.32635%,0:0.00735%]
[INFO] ** service:[0.0048200000000000005:99.99685%,-211.73542999999998:0.00105%,-211.09762999999998:0.00053%,-211.08346:0.00035%,-186.44547:0.00035%,-211.08818:0.00035%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.30594%,9:25.99136%,7:18.16345%,1:17.53488%,11:0.00105%,21:0.00088%,10:0.00088%,15:0.00053%,14:0.00035%,3:0.00035%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1556 (0.27244%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571136
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.1637e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.4686e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/571136
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.2294e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.0883e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/571136
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.3464e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7423e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/571136
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.6077e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4570e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/571136
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.3521e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9854e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/571136
[33m[INFO] loading file 22-22/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (340177, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (340177, 17)

[INFO] analyzing data
[INFO] 340177 rows
[INFO] ** appi_name:[21:99.99265%,30:0.00647%,23:0.00029%,22:0.00029%,18:0.00029%]
[INFO] ** classification:[normal:61.0344%,Multi Stage Single Point:38.9656%]
[INFO] ** dst:[21:43.31392%,10:21.00171%,8:18.09911%,9:17.57673%,15:0.00647%,22:0.00118%,19:0.00059%,26:0.00029%]
[INFO] ** i/f_dir:[1:99.99383%,0:0.00617%]
[INFO] ** i/f_name:[2:99.99353%,3:0.00617%,0:0.00029%]
[INFO] ** modbus_function_code:[0.02961:99.99265%,-33.760870000000004:0.00735%]
[INFO] ** modbus_function_description:[7:49.99721%,11:49.99544%,0:0.00735%]
[INFO] ** modbus_transaction_id:65534 (19.26468%)
[INFO] ** orig:[0:99.995%,2:0.00441%,1:0.00059%]
[INFO] ** proto:[0:99.99324%,1:0.00647%,2:0.00029%]
[INFO] ** proxy_src_ip:[18:38.32622%,20:25.99029%,13:18.09852%,6:17.57761%,17:0.00647%,14:0.00059%,10:0.00029%]
[INFO] ** s_port:[1.45442:25.98941%,-0.32151:21.00171%,-1.27613:18.09852%,-0.23351:17.57673%,-0.33484:17.32451%,-71.33197:0.00647%,1.45709:0.00059%,-0.24151:0.00059%,7.228860000000001:0.00059%,-0.24950999999999998:0.00029%,1.46509:0.00029%,-71.14931:0.00029%]
[INFO] ** scada_tag:[3:25.98912%,1:21.00171%,5:18.09852%,4:17.57644%,2:17.32451%,0:0.0097%]
[INFO] ** service:[0.0048200000000000005:99.99265%,-211.73542999999998:0.00647%,-211.07873999999998:0.00059%,-211.08818:0.00029%]
[INFO] ** src:[22:38.32622%,9:25.99029%,7:18.09852%,1:17.57761%,21:0.00441%,14:0.00206%,2:0.00059%,11:0.00029%]
[INFO] ** type:[0:99.99824%,1:0.00176%]
[INFO] ** unixtime:939 (0.27603%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/340177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0649 - tp: 69751.0000 - fp: 10249.0000 - tn: 309751.0000 - fn: 10249.0000 - accuracy: 0.9488 - precision: 0.8719 - recall: 0.8719 - auc: 0.9199 - val_loss: 7.5594 - val_tp: 10620.0000 - val_fp: 9380.0000 - val_tn: 70620.0000 - val_fn: 9380.0000 - val_accuracy: 0.8124 - val_precision: 0.5310 - val_recall: 0.5310 - val_auc: 0.7069
[INFO] saving weights to checkpoints/lstm-epoch-5-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/340177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5721 - tp: 42417.0000 - fp: 37583.0000 - tn: 282417.0000 - fn: 37583.0000 - accuracy: 0.8121 - precision: 0.5302 - recall: 0.5302 - auc: 0.7064 - val_loss: 7.5666 - val_tp: 10611.0000 - val_fp: 9389.0000 - val_tn: 70611.0000 - val_fn: 9389.0000 - val_accuracy: 0.8122 - val_precision: 0.5306 - val_recall: 0.5306 - val_auc: 0.7066
[INFO] saving weights to checkpoints/lstm-epoch-5-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/340177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5959 - tp: 42299.0000 - fp: 37701.0000 - tn: 282299.0000 - fn: 37701.0000 - accuracy: 0.8115 - precision: 0.5287 - recall: 0.5287 - auc: 0.7055 - val_loss: 7.5546 - val_tp: 10626.0000 - val_fp: 9374.0000 - val_tn: 70626.0000 - val_fn: 9374.0000 - val_accuracy: 0.8125 - val_precision: 0.5313 - val_recall: 0.5313 - val_auc: 0.7071
[INFO] saving weights to checkpoints/lstm-epoch-5-files-21-22-batch-200000-300000
[INFO] processing batch 300000-400000/340177
[33m[INFO] loading file 23-23/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540177, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540177, 17)

[INFO] analyzing data
[INFO] 540177 rows
[INFO] ** appi_name:[21:99.99889%,31:0.00037%,30:0.00037%,33:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:94.83299%,Multi Stage Single Point:5.16701%]
[INFO] ** dst:[21:43.33098%,10:21.00793%,8:18.13369%,9:17.52518%,22:0.00093%,24:0.00037%,18:0.00037%,15:0.00037%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99963%,3:0.00037%]
[INFO] ** modbus_function_code:[0.02961:99.99889%,-33.760870000000004:0.00111%]
[INFO] ** modbus_function_description:[7:50.00028%,11:49.99861%,0:0.00111%]
[INFO] ** modbus_transaction_id:65536 (12.13232%)
[INFO] ** orig:[0:99.99981%,2:0.00019%]
[INFO] ** proto:[0:99.99907%,2:0.00056%,1:0.00037%]
[INFO] ** proxy_src_ip:[18:38.35613%,20:25.98296%,13:18.13387%,6:17.52537%,16:0.00056%,17:0.00037%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.98241%,-0.32151:21.00774%,-1.27613:18.13332%,-0.23351:17.525%,-0.33484:17.34839%,-1.02014:0.00056%,-1.27347:0.00037%,-0.08551:0.00037%,-71.33197:0.00037%,1.45709:0.00019%,-0.24151:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,1.46509:0.00019%,-64.19493:0.00019%,-0.24950999999999998:0.00019%,-49.275529999999996:0.00019%]
[INFO] ** scada_tag:[3:25.98204%,1:21.00774%,5:18.13313%,4:17.52481%,2:17.3482%,0:0.00407%]
[INFO] ** service:[0.0048200000000000005:99.99907%,-211.73542999999998:0.00037%,-186.43601999999998:0.00037%,-186.44547:0.00019%]
[INFO] ** src:[22:38.35613%,9:25.98296%,7:18.13387%,1:17.52537%,15:0.00056%,21:0.00019%,17:0.00019%,14:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1469 (0.27195%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.6234 - tp: 52089.0000 - fp: 27911.0000 - tn: 292089.0000 - fn: 27911.0000 - accuracy: 0.8604 - precision: 0.6511 - recall: 0.6511 - auc: 0.7819 - val_loss: 2.6467e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.5699e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4919e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.4377e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4093e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.2972e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2099e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.2030e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1240e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/540177
[33m[INFO] loading file 24-24/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540177, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540177, 17)

[INFO] analyzing data
[INFO] 540177 rows
[INFO] ** appi_name:[21:99.99315%,30:0.00333%,26:0.00056%,31:0.00037%,27:0.00037%,22:0.00037%,0:0.00037%,24:0.00019%,23:0.00019%,19:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,11:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:95.28303%,Multi Stage Single Point:4.71697%]
[INFO] ** dst:[21:43.35671%,10:21.02403%,8:18.10481%,9:17.50722%,15:0.00333%,22:0.00111%,6:0.00074%,25:0.00037%,24:0.00037%,19:0.00037%,18:0.00037%,7:0.00037%,26:0.00019%]
[INFO] ** i/f_dir:[1:99.99685%,0:0.00315%]
[INFO] ** i/f_name:[2:99.99667%,3:0.00333%]
[INFO] ** modbus_function_code:[0.02961:99.99315%,-33.760870000000004:0.00629%,-0.415:0.00019%,0.9188299999999999:0.00019%,0.47422:0.00019%]
[INFO] ** modbus_function_description:[7:49.9975%,11:49.99565%,0:0.00629%,15:0.00019%,10:0.00019%,2:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.13232%)
[INFO] ** orig:[0:99.99963%,1:0.00037%]
[INFO] ** proto:[0:99.99463%,1:0.00333%,2:0.00204%]
[INFO] ** proxy_src_ip:[18:38.40223%,20:25.97926%,13:18.10481%,6:17.50648%,17:0.00333%,10:0.0013%,14:0.00093%,11:0.00093%,21:0.00037%,16:0.00037%]
[INFO] ** s_port:[1.45442:25.97852%,-0.32151:21.02403%,-1.27613:18.10444%,-0.23351:17.50593%,-0.33484:17.37819%,-71.33197:0.00333%,-9.58113:0.00074%,-71.14798:0.00056%,-1.27347:0.00037%,1.45709:0.00037%,-0.24151:0.00037%,-1.02014:0.00037%,-31.55091:0.00037%,7.6315100000000005:0.00037%,-71.14931:0.00037%,-64.19493:0.00037%,-68.79874000000001:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,7.4901800000000005:0.00019%,13.431270000000001:0.00019%,11.862:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:25.97834%,1:21.02403%,5:18.10425%,4:17.50556%,2:17.37801%,0:0.00981%]
[INFO] ** service:[0.0048200000000000005:99.99426%,-211.73542999999998:0.00333%,-211.08346:0.00056%,-211.07873999999998:0.00037%,-202.75898:0.00037%,-186.44547:0.00037%,-186.43601999999998:0.00037%,-211.08818:0.00037%]
[INFO] ** src:[22:38.40223%,9:25.97926%,7:18.10481%,1:17.50648%,14:0.00333%,11:0.0013%,10:0.00093%,2:0.00093%,15:0.00037%,4:0.00037%]
[INFO] ** type:[0:99.9987%,1:0.00093%,2:0.00037%]
[INFO] ** unixtime:1467 (0.27158%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.2012e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0165e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9795e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9300e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8885e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1692e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8324e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1916e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.8325 - tp: 75868.0000 - fp: 4132.0000 - tn: 315868.0000 - fn: 4132.0000 - accuracy: 0.9793 - precision: 0.9484 - recall: 0.9484 - auc: 0.9677 - val_loss: 5.7106 - val_tp: 12914.0000 - val_fp: 7086.0000 - val_tn: 72914.0000 - val_fn: 7086.0000 - val_accuracy: 0.8583 - val_precision: 0.6457 - val_recall: 0.6457 - val_auc: 0.7786
[INFO] saving weights to checkpoints/lstm-epoch-5-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/540177
[33m[INFO] loading file 25-25/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540177, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540177, 17)

[INFO] analyzing data
[INFO] 540177 rows
[INFO] ** appi_name:[21:99.9963%,30:0.00111%,17:0.00074%,22:0.00056%,31:0.00037%,28:0.00019%,26:0.00019%,12:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** classification:[normal:64.34669%,Multi Stage Single Point:35.65331%]
[INFO] ** dst:[21:43.31932%,10:21.02292%,8:18.14424%,9:17.50908%,15:0.00111%,22:0.00093%,16:0.00074%,6:0.00074%,18:0.00037%,17:0.00037%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99889%,0:0.00111%]
[INFO] ** i/f_name:[2:99.99889%,3:0.00111%]
[INFO] ** modbus_function_code:[0.02961:99.9963%,-33.760870000000004:0.0037%]
[INFO] ** modbus_function_description:[7:49.99898%,11:49.99732%,0:0.0037%]
[INFO] ** modbus_transaction_id:65536 (12.13232%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99778%,2:0.00111%,1:0.00111%]
[INFO] ** proxy_src_ip:[18:38.38631%,20:25.95575%,13:18.14424%,6:17.50963%,17:0.00111%,1:0.00093%,21:0.00074%,16:0.00037%,14:0.00037%,7:0.00037%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95538%,-0.32151:21.02255%,-1.27613:18.14387%,-0.23351:17.50908%,-0.33484:17.36375%,-71.33197:0.00111%,-71.14931:0.00056%,-0.24151:0.00037%,-1.02014:0.00037%,-49.275529999999996:0.00037%,1.46509:0.00019%,-5.1466400000000005:0.00019%,-1.27347:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,-0.24950999999999998:0.00019%,2.52505:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,6.1115699999999995:0.00019%,-5.08665:0.00019%,1.45709:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:25.95501%,1:21.02237%,5:18.14368%,4:17.50889%,2:17.36357%,0:0.00648%]
[INFO] ** service:[0.0048200000000000005:99.99667%,-211.73542999999998:0.00111%,-205.44247:0.00074%,-211.08818:0.00056%,-186.43601999999998:0.00037%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.38631%,9:25.95575%,7:18.14424%,1:17.50963%,14:0.00111%,3:0.00093%,4:0.00074%,21:0.00037%,15:0.00037%,2:0.00037%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1468 (0.27176%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.7421 - tp: 51500.0000 - fp: 28500.0000 - tn: 291500.0000 - fn: 28500.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.7773 - val_loss: 5.7614 - val_tp: 12851.0000 - val_fp: 7149.0000 - val_tn: 72851.0000 - val_fn: 7149.0000 - val_accuracy: 0.8570 - val_precision: 0.6425 - val_recall: 0.6425 - val_auc: 0.7766
[INFO] saving weights to checkpoints/lstm-epoch-5-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 5.7487 - tp: 51467.0000 - fp: 28533.0000 - tn: 291467.0000 - fn: 28533.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.7771 - val_loss: 5.7219 - val_tp: 12900.0000 - val_fp: 7100.0000 - val_tn: 72900.0000 - val_fn: 7100.0000 - val_accuracy: 0.8580 - val_precision: 0.6450 - val_recall: 0.6450 - val_auc: 0.7781
[INFO] saving weights to checkpoints/lstm-epoch-5-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 5.7473 - tp: 51474.0000 - fp: 28526.0000 - tn: 291474.0000 - fn: 28526.0000 - accuracy: 0.8574 - precision: 0.6434 - recall: 0.6434 - auc: 0.7771 - val_loss: 5.7671 - val_tp: 12844.0000 - val_fp: 7156.0000 - val_tn: 72844.0000 - val_fn: 7156.0000 - val_accuracy: 0.8569 - val_precision: 0.6422 - val_recall: 0.6422 - val_auc: 0.7764
[INFO] saving weights to checkpoints/lstm-epoch-5-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 5.7415 - tp: 51503.0000 - fp: 28497.0000 - tn: 291503.0000 - fn: 28497.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.7774 - val_loss: 5.7646 - val_tp: 12847.0000 - val_fp: 7153.0000 - val_tn: 72847.0000 - val_fn: 7153.0000 - val_accuracy: 0.8569 - val_precision: 0.6424 - val_recall: 0.6424 - val_auc: 0.7765
[INFO] saving weights to checkpoints/lstm-epoch-5-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.7497 - tp: 51462.0000 - fp: 28538.0000 - tn: 291462.0000 - fn: 28538.0000 - accuracy: 0.8573 - precision: 0.6433 - recall: 0.6433 - auc: 0.7770 - val_loss: 5.7421 - val_tp: 12875.0000 - val_fp: 7125.0000 - val_tn: 72875.0000 - val_fn: 7125.0000 - val_accuracy: 0.8575 - val_precision: 0.6438 - val_recall: 0.6438 - val_auc: 0.7773
[INFO] saving weights to checkpoints/lstm-epoch-5-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/540177
[33m[INFO] loading file 26-26/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (540177, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (540177, 17)

[INFO] analyzing data
[INFO] 540177 rows
[INFO] ** appi_name:[21:99.99852%,7:0.00056%,31:0.00019%,30:0.00019%,22:0.00019%,12:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:64.39963%,Single Stage Single Point:29.56661%,Multi Stage Single Point:6.03376%]
[INFO] ** dst:[21:43.31173%,10:21.08587%,8:18.11647%,9:17.48353%,22:0.00074%,24:0.00037%,16:0.00037%,2:0.00037%,18:0.00019%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99852%,-33.760870000000004:0.00148%]
[INFO] ** modbus_function_description:[7:49.99991%,11:49.99861%,0:0.00148%]
[INFO] ** modbus_transaction_id:65536 (12.13232%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99944%,2:0.00037%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.46721%,20:25.93057%,13:18.11684%,6:17.48353%,1:0.00056%,21:0.00037%,16:0.00037%,17:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.93002%,-0.32151:21.08568%,-1.27613:18.11628%,-0.23351:17.48334%,-0.33484:17.38152%,-1.27347:0.00037%,-1.02014:0.00037%,7.66617:0.00019%,-71.14931:0.00019%,11.57001:0.00019%,-3.3787199999999995:0.00019%,2.52505:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%,1.45709:0.00019%,-49.275529999999996:0.00019%,1.47576:0.00019%,1.46509:0.00019%,14.191239999999999:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.92965%,1:21.08568%,5:18.11628%,4:17.48316%,2:17.38152%,0:0.0037%]
[INFO] ** service:[0.0048200000000000005:99.9987%,-211.09762999999998:0.00056%,-211.35747999999998:0.00019%,-211.73542999999998:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.46721%,9:25.93057%,7:18.11684%,1:17.48353%,3:0.00056%,15:0.00037%,4:0.00037%,21:0.00019%,14:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1466 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.7382 - tp: 51519.0000 - fp: 28481.0000 - tn: 291519.0000 - fn: 28481.0000 - accuracy: 0.8576 - precision: 0.6440 - recall: 0.6440 - auc: 0.7775 - val_loss: 5.7104 - val_tp: 12874.0000 - val_fp: 7126.0000 - val_tn: 72874.0000 - val_fn: 7126.0000 - val_accuracy: 0.8575 - val_precision: 0.6437 - val_recall: 0.6437 - val_auc: 0.7773
[INFO] saving weights to checkpoints/lstm-epoch-5-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.2479 - tp: 77819.0000 - fp: 2181.0000 - tn: 317819.0000 - fn: 2181.0000 - accuracy: 0.9891 - precision: 0.9727 - recall: 0.9727 - auc: 0.9880 - val_loss: 3.7432e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.7567e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7330e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3763e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0700e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/540177
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3901e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.6996e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/540177
[33m[INFO] loading file 27-27/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (480307, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (480307, 17)

[INFO] analyzing data
[INFO] 480307 rows
[INFO] ** appi_name:[21:99.99938%,30:0.00062%]
[INFO] ** classification:[normal:64.33802%,Single Stage Single Point:35.66198%]
[INFO] ** dst:[21:43.27149%,10:21.06465%,8:18.18733%,9:17.47487%,22:0.00083%,15:0.00062%,24:0.00021%]
[INFO] ** i/f_dir:[1:99.99979%,0:0.00021%]
[INFO] ** i/f_name:[2:99.99938%,3:0.00062%]
[INFO] ** modbus_function_code:[0.02961:99.99938%,-33.760870000000004:0.00062%]
[INFO] ** modbus_function_description:[7:50.00031%,11:49.99906%,0:0.00062%]
[INFO] ** modbus_transaction_id:65536 (13.64461%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99938%,1:0.00062%]
[INFO] ** proxy_src_ip:[18:38.40585%,20:25.93092%,13:18.18712%,6:17.47507%,17:0.00062%,16:0.00042%]
[INFO] ** s_port:[1.45442:25.93029%,-0.32151:21.06465%,-1.27613:18.18691%,-0.23351:17.47466%,-0.33484:17.3412%,-71.33197:0.00062%,-1.02014:0.00042%,-1.27347:0.00021%,1.45709:0.00021%,-0.24950999999999998:0.00021%,1.46509:0.00021%,1.47576:0.00021%,-0.24151:0.00021%]
[INFO] ** scada_tag:[3:25.92987%,1:21.06444%,5:18.1867%,4:17.47445%,2:17.34099%,0:0.00354%]
[INFO] ** service:[0.0048200000000000005:99.99938%,-211.73542999999998:0.00062%]
[INFO] ** src:[22:38.40585%,9:25.93092%,7:18.18712%,1:17.47507%,14:0.00062%,15:0.00042%]
[INFO] ** type:[0:99.99958%,1:0.00042%]
[INFO] ** unixtime:1305 (0.2717%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/480307
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.5768e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.1936e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/480307
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.0412e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3448e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/480307
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.7968e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3342e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/480307
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.9324e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2888e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/480307
[33m[INFO] loading file 28-28/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (414223, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (414223, 17)

[INFO] analyzing data
[INFO] 414223 rows
[INFO] ** appi_name:[21:99.99276%,30:0.00169%,17:0.00121%,22:0.00097%,7:0.00097%,31:0.00072%,26:0.00072%,28:0.00024%,27:0.00024%,8:0.00024%,0:0.00024%]
[INFO] ** classification:[normal:64.31922%,Single Stage Single Point:35.68078%]
[INFO] ** dst:[21:43.28272%,10:21.02901%,8:18.20203%,9:17.47851%,6:0.00193%,16:0.00169%,18:0.00121%,15:0.00072%,22:0.00048%,17:0.00048%,2:0.00048%,25:0.00024%,7:0.00024%,0:0.00024%]
[INFO] ** i/f_dir:[1:99.99928%,0:0.00072%]
[INFO] ** i/f_name:[2:99.99928%,3:0.00072%]
[INFO] ** modbus_function_code:[0.02961:99.99276%,-33.760870000000004:0.00724%]
[INFO] ** modbus_function_description:[7:49.9965%,11:49.99626%,0:0.00724%]
[INFO] ** modbus_transaction_id:65536 (15.82143%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99565%,2:0.00362%,1:0.00072%]
[INFO] ** proxy_src_ip:[18:38.35132%,20:25.96041%,13:18.20227%,6:17.47875%,1:0.00193%,17:0.00169%,14:0.00145%,7:0.00121%,21:0.00072%,0:0.00024%]
[INFO] ** s_port:[1.45442:25.96017%,-0.32151:21.02901%,-1.27613:18.20203%,-0.23351:17.47827%,-0.33484:17.32231%,-71.14798:0.00097%,-71.14931:0.00097%,-71.33197:0.00072%,-0.08551:0.00048%,-0.24151:0.00048%,7.66617:0.00024%,-58.035180000000004:0.00024%,-1.2708:0.00024%,-64.19493:0.00024%,-5.1466400000000005:0.00024%,13.431270000000001:0.00024%,11.57001:0.00024%,14.4699:0.00024%,1.47576:0.00024%,14.191239999999999:0.00024%,-5.08665:0.00024%,10.192739999999999:0.00024%,-3.3787199999999995:0.00024%,6.1115699999999995:0.00024%,2.05573:0.00024%,-43.76509:0.00024%,2.52505:0.00024%,11.862:0.00024%,-58.032509999999995:0.00024%]
[INFO] ** scada_tag:[3:25.95993%,1:21.02877%,5:18.20203%,4:17.47778%,2:17.32231%,0:0.00917%]
[INFO] ** service:[0.0048200000000000005:99.99276%,-205.44247:0.00121%,-186.43601999999998:0.00121%,-211.09762999999998:0.00097%,-211.08346:0.00097%,-211.08818:0.00097%,-211.73542999999998:0.00072%,-186.44547:0.00024%,-183.8612:0.00024%,-185.9872:0.00024%,-211.35747999999998:0.00024%,-202.75898:0.00024%]
[INFO] ** src:[22:38.35132%,9:25.96041%,7:18.20227%,1:17.47875%,3:0.00217%,2:0.00145%,21:0.00121%,4:0.00097%,14:0.00072%,8:0.00048%,17:0.00024%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1126 (0.27183%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/414223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.4169e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1541e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/414223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.5763e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2254e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/414223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.8679e-05 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8787e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/414223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3407e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6669e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-27-28-batch-300000-400000
[INFO] processing batch 400000-500000/414223
[33m[INFO] loading file 29-29/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (514223, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (514223, 17)

[INFO] analyzing data
[INFO] 514223 rows
[INFO] ** appi_name:[21:99.99883%,30:0.00058%,26:0.00019%,9:0.00019%,3:0.00019%]
[INFO] ** classification:[normal:64.38666%,Single Stage Single Point:35.61334%]
[INFO] ** dst:[21:43.32809%,10:21.05721%,8:18.14602%,9:17.46694%,22:0.00058%,15:0.00058%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99942%,3:0.00058%]
[INFO] ** modbus_function_code:[0.02961:99.99883%,-33.760870000000004:0.00117%]
[INFO] ** modbus_function_description:[7:49.9999%,11:49.99893%,0:0.00117%]
[INFO] ** modbus_transaction_id:65536 (12.74467%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99922%,1:0.00058%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.43955%,20:25.94594%,13:18.14641%,6:17.46674%,17:0.00058%,21:0.00019%,16:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.94536%,-0.32151:21.05701%,-1.27613:18.14602%,-0.23351:17.46674%,-0.33484:17.38254%,-71.33197:0.00058%,1.45709:0.00039%,-71.14798:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-61.95768:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.94497%,1:21.05682%,5:18.14602%,4:17.46635%,2:17.38254%,0:0.00331%]
[INFO] ** service:[0.0048200000000000005:99.99903%,-211.73542999999998:0.00058%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.43955%,9:25.94594%,7:18.14641%,1:17.46674%,14:0.00058%,15:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1397 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9265e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2806e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1883e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0850e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.7109e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0857e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0830e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2345e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1614e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.3409e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/514223
[33m[INFO] loading file 30-30/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (514223, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (514223, 17)

[INFO] analyzing data
[INFO] 514223 rows
[INFO] ** appi_name:[21:99.99747%,30:0.00175%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.36779%,Single Stage Single Point:35.63221%]
[INFO] ** dst:[21:43.34034%,10:21.02434%,8:18.14407%,9:17.48774%,15:0.00175%,22:0.00078%,24:0.00039%,25:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99825%,0:0.00175%]
[INFO] ** i/f_name:[2:99.99825%,3:0.00175%]
[INFO] ** modbus_function_code:[0.02961:99.99747%,-33.760870000000004:0.00253%]
[INFO] ** modbus_function_description:[7:49.9999%,11:49.99757%,0:0.00253%]
[INFO] ** modbus_transaction_id:65536 (12.74467%)
[INFO] ** orig:[0:99.99903%,2:0.00058%,1:0.00039%]
[INFO] ** proto:[0:99.99786%,1:0.00175%,2:0.00039%]
[INFO] ** proxy_src_ip:[18:38.36487%,20:25.99961%,13:18.14446%,6:17.48833%,17:0.00175%,7:0.00039%,16:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.99942%,-0.32151:21.02415%,-1.27613:18.14388%,-0.23351:17.48755%,-0.33484:17.34073%,-71.33197:0.00175%,-0.24151:0.00058%,-1.27347:0.00039%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,10.192739999999999:0.00019%,1.47576:0.00019%,-61.95768:0.00019%,-1.02014:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.99903%,1:21.02415%,5:18.14368%,4:17.48735%,2:17.34053%,0:0.00525%]
[INFO] ** service:[0.0048200000000000005:99.99767%,-211.73542999999998:0.00175%,-186.44547:0.00019%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.36487%,9:25.99961%,7:18.14446%,1:17.48833%,14:0.00117%,21:0.00097%,16:0.00019%,15:0.00019%,8:0.00019%]
[INFO] ** type:[0:99.99922%,1:0.00078%]
[INFO] ** unixtime:1398 (0.27187%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.0588e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.6213e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.9726e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.4085e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.6934e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7409e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.3544e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.5087e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.8102e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.7091e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/514223
[33m[INFO] loading file 31-31/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (514223, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (514223, 17)

[INFO] analyzing data
[INFO] 514223 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.37674%,Single Stage Single Point:35.62326%]
[INFO] ** dst:[21:43.31642%,10:21.05915%,8:18.12521%,9:17.49786%,22:0.00097%,24:0.00039%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.0001%,11:49.9999%]
[INFO] ** modbus_transaction_id:65536 (12.74467%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.40688%,20:25.96947%,13:18.1254%,6:17.49786%,16:0.00039%]
[INFO] ** s_port:[1.45442:25.96869%,-0.32151:21.05915%,-1.27613:18.12502%,-0.23351:17.49766%,-0.33484:17.34773%,-1.27347:0.00039%,1.45709:0.00039%,-1.02014:0.00039%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.96831%,1:21.05896%,5:18.12482%,4:17.49747%,2:17.34753%,0:0.00292%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.40688%,9:25.96947%,7:18.1254%,1:17.49786%,15:0.00039%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1397 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.2610e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.6361e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.2716e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9895e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.7509e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5257e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.6862e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1237e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9401e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2795e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/514223
[33m[INFO] loading file 32-32/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (514223, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (514223, 17)

[INFO] analyzing data
[INFO] 514223 rows
[INFO] ** appi_name:[21:99.99611%,30:0.00331%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.37674%,Single Stage Single Point:35.62326%]
[INFO] ** dst:[21:43.3205%,10:21.05118%,8:18.16002%,9:17.46344%,15:0.00331%,22:0.00097%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99708%,0:0.00292%]
[INFO] ** i/f_name:[2:99.99669%,3:0.00331%]
[INFO] ** modbus_function_code:[0.02961:99.99611%,-33.760870000000004:0.00389%]
[INFO] ** modbus_function_description:[7:49.99893%,11:49.99718%,0:0.00389%]
[INFO] ** modbus_transaction_id:65536 (12.74467%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99611%,1:0.00331%,2:0.00058%]
[INFO] ** proxy_src_ip:[18:38.40999%,20:25.96208%,13:18.15983%,6:17.46402%,17:0.00331%,14:0.00058%,16:0.00019%]
[INFO] ** s_port:[1.45442:25.9615%,-0.32151:21.05118%,-1.27613:18.15963%,-0.23351:17.46324%,-0.33484:17.35881%,-71.33197:0.00331%,-0.24151:0.00058%,-71.14798:0.00019%,11.862:0.00019%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,13.431270000000001:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.96111%,1:21.05098%,5:18.15963%,4:17.46285%,2:17.35881%,0:0.00661%]
[INFO] ** service:[0.0048200000000000005:99.99611%,-211.73542999999998:0.00331%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.40999%,9:25.96208%,7:18.15983%,1:17.46402%,14:0.00331%,2:0.00058%,15:0.00019%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1396 (0.27148%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7192e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.8987e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1424e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7146e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.3370e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9269e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6209e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4709e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3808e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2652e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/514223
[33m[INFO] loading file 33-33/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (514223, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (514223, 17)

[INFO] analyzing data
[INFO] 514223 rows
[INFO] ** appi_name:[21:99.99669%,30:0.00117%,17:0.00078%,22:0.00058%,31:0.00019%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.40008%,Single Stage Single Point:35.59992%]
[INFO] ** dst:[21:43.33587%,10:21.05915%,8:18.10985%,9:17.49008%,22:0.00136%,15:0.00117%,16:0.00078%,6:0.00078%,24:0.00039%,17:0.00039%,18:0.00019%]
[INFO] ** i/f_dir:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name:[2:99.99883%,3:0.00117%]
[INFO] ** modbus_function_code:[0.02961:99.99669%,-33.760870000000004:0.00331%]
[INFO] ** modbus_function_description:[7:49.99951%,11:49.99718%,0:0.00331%]
[INFO] ** modbus_transaction_id:65536 (12.74467%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99786%,1:0.00117%,2:0.00097%]
[INFO] ** proxy_src_ip:[18:38.42516%,20:25.97064%,13:18.10985%,6:17.49027%,17:0.00117%,16:0.00078%,1:0.00078%,21:0.00039%,14:0.00039%,7:0.00039%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.96986%,-0.32151:21.05915%,-1.27613:18.10946%,-0.23351:17.48988%,-0.33484:17.36601%,-71.33197:0.00117%,-1.02014:0.00078%,-71.14931:0.00058%,1.45709:0.00039%,-1.27347:0.00039%,-71.14798:0.00019%,-58.035180000000004:0.00019%,-5.1466400000000005:0.00019%,-0.24151:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-5.08665:0.00019%,-0.24950999999999998:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:25.96947%,1:21.05915%,5:18.10926%,4:17.48969%,2:17.36601%,0:0.00642%]
[INFO] ** service:[0.0048200000000000005:99.99669%,-211.73542999999998:0.00117%,-205.44247:0.00078%,-211.08818:0.00058%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.42516%,9:25.97064%,7:18.10985%,1:17.49027%,14:0.00117%,15:0.00078%,3:0.00078%,21:0.00039%,4:0.00039%,2:0.00039%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1399 (0.27206%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.7462e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.5663e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.4882e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7916e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7141e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6559e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8729e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9080e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/514223
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6659e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4812e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/514223
[33m[INFO] loading file 34-34/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (355656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (355656, 17)

[INFO] analyzing data
[INFO] 355656 rows
[INFO] ** appi_name:[21:99.99747%,7:0.00084%,30:0.00056%,31:0.00028%,22:0.00028%,8:0.00028%,6:0.00028%]
[INFO] ** classification:[normal:64.33014%,Single Stage Single Point:35.66986%]
[INFO] ** dst:[21:43.26934%,10:21.05771%,8:18.21564%,9:17.45423%,22:0.00084%,16:0.00056%,15:0.00056%,2:0.00056%,18:0.00028%,6:0.00028%]
[INFO] ** i/f_dir:[1:99.99944%,0:0.00056%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.99747%,-33.760870000000004:0.00253%]
[INFO] ** modbus_function_description:[7:49.99916%,11:49.99831%,0:0.00253%]
[INFO] ** modbus_transaction_id:65536 (18.42679%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99888%,2:0.00056%,1:0.00056%]
[INFO] ** proxy_src_ip:[18:38.3795%,20:25.94754%,13:18.21564%,6:17.45479%,1:0.00084%,21:0.00056%,17:0.00056%,14:0.00028%,7:0.00028%]
[INFO] ** s_port:[1.45442:25.94726%,-0.32151:21.05743%,-1.27613:18.21564%,-0.23351:17.45394%,-0.33484:17.32208%,-0.24151:0.00084%,-71.33197:0.00056%,-3.0613900000000003:0.00028%,-3.3787199999999995:0.00028%,14.191239999999999:0.00028%,1.47576:0.00028%,11.57001:0.00028%,-49.275529999999996:0.00028%,-71.14931:0.00028%,7.66617:0.00028%]
[INFO] ** scada_tag:[3:25.94698%,1:21.05715%,5:18.21535%,4:17.45366%,2:17.32208%,0:0.00478%]
[INFO] ** service:[0.0048200000000000005:99.99775%,-211.09762999999998:0.00084%,-211.73542999999998:0.00056%,-186.43601999999998:0.00028%,-211.35747999999998:0.00028%,-211.08818:0.00028%]
[INFO] ** src:[22:38.3795%,9:25.94754%,7:18.21564%,1:17.45479%,3:0.00084%,14:0.00056%,4:0.00056%,21:0.00028%,2:0.00028%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:966 (0.27161%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/355656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.5001e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1064e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/355656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5784e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.4704e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/355656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.6963e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.5221e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/355656
[33m[INFO] loading file 35-35/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555656, 17)

[INFO] analyzing data
[INFO] 555656 rows
[INFO] ** appi_name:[21:99.99892%,30:0.00108%]
[INFO] ** classification:[normal:64.36716%,Single Stage Single Point:35.63284%]
[INFO] ** dst:[21:43.32771%,10:21.03694%,8:18.15782%,9:17.47538%,22:0.00108%,15:0.00108%]
[INFO] ** i/f_dir:[1:99.9991%,0:0.0009%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.99892%,-33.760870000000004:0.00108%]
[INFO] ** modbus_function_description:[7:50.00036%,11:49.99856%,0:0.00108%]
[INFO] ** modbus_transaction_id:65536 (11.79435%)
[INFO] ** orig:[0:99.99964%,1:0.00036%]
[INFO] ** proto:[0:99.99892%,1:0.00108%]
[INFO] ** proxy_src_ip:[18:38.39714%,20:25.96804%,13:18.15746%,6:17.47556%,17:0.00108%,16:0.00072%]
[INFO] ** s_port:[1.45442:25.96751%,-0.32151:21.03694%,-1.27613:18.15746%,-0.23351:17.4752%,-0.33484:17.3602%,-71.33197:0.00108%,-1.02014:0.00072%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.96715%,1:21.03694%,5:18.15728%,4:17.47484%,2:17.3602%,0:0.0036%]
[INFO] ** service:[0.0048200000000000005:99.99892%,-211.73542999999998:0.00108%]
[INFO] ** src:[22:38.39714%,9:25.96804%,7:18.15746%,1:17.47556%,14:0.00108%,15:0.00072%]
[INFO] ** type:[0:99.9991%,1:0.0009%]
[INFO] ** unixtime:1508 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4906e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.4242e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.1167e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7351e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2117e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5233e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1260e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.8940e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.7879e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.0231e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/555656
[33m[INFO] loading file 36-36/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555656, 17)

[INFO] analyzing data
[INFO] 555656 rows
[INFO] ** appi_name:[21:99.99856%,30:0.00072%,31:0.00036%,33:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.36158%,Single Stage Single Point:35.63842%]
[INFO] ** dst:[21:43.33149%,10:21.02776%,8:18.14828%,9:17.48996%,22:0.0009%,15:0.00072%,24:0.00036%,18:0.00036%,25:0.00018%]
[INFO] ** i/f_dir:[1:99.99928%,0:0.00072%]
[INFO] ** i/f_name:[2:99.99928%,3:0.00072%]
[INFO] ** modbus_function_code:[0.02961:99.99856%,-33.760870000000004:0.00144%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99838%,0:0.00144%]
[INFO] ** modbus_transaction_id:65536 (11.79435%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99874%,1:0.00072%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.37734%,20:25.98208%,13:18.14846%,6:17.4905%,17:0.00072%,21:0.00018%,16:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.98154%,-0.32151:21.02758%,-1.27613:18.14792%,-0.23351:17.48978%,-0.33484:17.34976%,-71.33197:0.00072%,-0.24151:0.00054%,-0.08551:0.00036%,-1.27347:0.00036%,1.45709:0.00018%,1.47576:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,1.46509:0.00018%,-64.19493:0.00018%,-0.24950999999999998:0.00018%,-49.275529999999996:0.00018%]
[INFO] ** scada_tag:[3:25.98118%,1:21.0274%,5:18.14774%,4:17.4896%,2:17.34958%,0:0.0045%]
[INFO] ** service:[0.0048200000000000005:99.99874%,-211.73542999999998:0.00072%,-186.43601999999998:0.00036%,-186.44547:0.00018%]
[INFO] ** src:[22:38.37734%,9:25.98208%,7:18.14846%,1:17.4905%,14:0.00072%,17:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1509 (0.27157%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.1579e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9194e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.1661e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6629e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.1962e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8265e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.8205e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.6109e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6875e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.0610e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/555656
[33m[INFO] loading file 37-37/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555656, 17)

[INFO] analyzing data
[INFO] 555656 rows
[INFO] ** appi_name:[21:99.99892%,30:0.00072%,26:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:64.37436%,Single Stage Single Point:35.62564%]
[INFO] ** dst:[21:43.33311%,10:21.03928%,8:18.13856%,9:17.48708%,22:0.00072%,15:0.00072%,24:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99928%,3:0.00072%]
[INFO] ** modbus_function_code:[0.02961:99.99892%,-33.760870000000004:0.00108%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99874%,0:0.00108%]
[INFO] ** modbus_transaction_id:65536 (11.79435%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9991%,1:0.00072%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.38634%,20:25.9864%,13:18.13856%,6:17.48726%,17:0.00072%,16:0.00036%,21:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:25.98586%,-0.32151:21.03928%,-1.27613:18.1382%,-0.23351:17.4869%,-0.33484:17.34706%,-71.33197:0.00072%,-1.02014:0.00036%,-71.14798:0.00018%,-1.27347:0.00018%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.2708:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.98568%,1:21.03928%,5:18.13802%,4:17.48672%,2:17.34688%,0:0.00342%]
[INFO] ** service:[0.0048200000000000005:99.99892%,-211.73542999999998:0.00072%,-183.8612:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.38634%,9:25.9864%,7:18.13856%,1:17.48726%,14:0.00072%,15:0.00036%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1509 (0.27157%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2562e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.3367e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.2804e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4686e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0247e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6699e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 8.0553e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6147e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6952e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9934e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/555656
[33m[INFO] loading file 38-38/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555656, 17)

[INFO] analyzing data
[INFO] 555656 rows
[INFO] ** appi_name:[21:99.9991%,30:0.00018%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.40981%,Single Stage Single Point:35.59019%]
[INFO] ** dst:[21:43.31889%,10:21.08895%,8:18.09681%,9:17.49356%,22:0.0009%,25:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99982%,0:0.00018%]
[INFO] ** i/f_name:[2:99.99982%,3:0.00018%]
[INFO] ** modbus_function_code:[0.02961:99.9991%,-33.760870000000004:0.0009%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.99946%,0:0.0009%]
[INFO] ** modbus_transaction_id:65536 (11.79435%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99946%,2:0.00036%,1:0.00018%]
[INFO] ** proxy_src_ip:[18:38.45689%,20:25.95149%,13:18.09663%,6:17.49392%,7:0.00036%,17:0.00018%,16:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95077%,-0.32151:21.08877%,-1.27613:18.09645%,-0.23351:17.49338%,-0.33484:17.36812%,-0.24151:0.00036%,1.45709:0.00036%,-64.19493:0.00018%,10.192739999999999:0.00018%,-1.02014:0.00018%,-71.14798:0.00018%,-61.95768:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-71.33197:0.00018%]
[INFO] ** scada_tag:[3:25.95041%,1:21.08877%,5:18.09645%,4:17.4932%,2:17.36812%,0:0.00306%]
[INFO] ** service:[0.0048200000000000005:99.99928%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%,-211.73542999999998:0.00018%]
[INFO] ** src:[22:38.45689%,9:25.95149%,7:18.09663%,1:17.49392%,21:0.00036%,16:0.00018%,15:0.00018%,14:0.00018%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1510 (0.27175%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.8028e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5263e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3537e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1990e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.1579e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.6196e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6203e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3026e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1657e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0691e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/555656
[33m[INFO] loading file 39-39/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555656, 17)

[INFO] analyzing data
[INFO] 555656 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.40208%,Single Stage Single Point:35.59792%]
[INFO] ** dst:[21:43.32177%,10:21.07941%,8:18.13316%,9:17.46458%,22:0.0009%,24:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99982%]
[INFO] ** modbus_transaction_id:65536 (11.79435%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.44807%,20:25.95347%,13:18.13334%,6:17.46458%,16:0.00054%]
[INFO] ** s_port:[1.45442:25.95293%,-0.32151:21.07941%,-1.27613:18.13298%,-0.23351:17.4644%,-0.33484:17.36866%,-1.02014:0.00054%,-1.27347:0.00018%,1.45709:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.2708:0.00018%]
[INFO] ** scada_tag:[3:25.95257%,1:21.07923%,5:18.1328%,4:17.4644%,2:17.36848%,0:0.00252%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.44807%,9:25.95347%,7:18.13334%,1:17.46458%,15:0.00054%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1508 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7669e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8030e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.6087e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4503e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.3134e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2207e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3569e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0261e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.5960e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.9288e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/555656
[33m[INFO] loading file 40-40/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555656, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555656, 17)

[INFO] analyzing data
[INFO] 555656 rows
[INFO] ** appi_name:[21:99.9964%,30:0.00306%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.33801%,Single Stage Single Point:35.66199%]
[INFO] ** dst:[21:43.29621%,10:21.03694%,8:18.19615%,9:17.46602%,15:0.00306%,22:0.0009%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99712%,0:0.00288%]
[INFO] ** i/f_name:[2:99.99694%,3:0.00306%]
[INFO] ** modbus_function_code:[0.02961:99.9964%,-33.760870000000004:0.0036%]
[INFO] ** modbus_function_description:[7:49.99928%,11:49.99712%,0:0.0036%]
[INFO] ** modbus_transaction_id:65536 (11.79435%)
[INFO] ** orig:[0:99.99964%,1:0.00036%]
[INFO] ** proto:[0:99.9964%,1:0.00306%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.35665%,20:25.9774%,13:18.19597%,6:17.46638%,17:0.00306%,14:0.00054%]
[INFO] ** s_port:[1.45442:25.9765%,-0.32151:21.03694%,-1.27613:18.19579%,-0.23351:17.46584%,-0.33484:17.31971%,-71.33197:0.00306%,1.45709:0.00054%,-0.24151:0.00036%,-71.14798:0.00018%,-1.27347:0.00018%,11.862:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,13.431270000000001:0.00018%]
[INFO] ** scada_tag:[3:25.97614%,1:21.03676%,5:18.19561%,4:17.46548%,2:17.31953%,0:0.00648%]
[INFO] ** service:[0.0048200000000000005:99.9964%,-211.73542999999998:0.00306%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.35665%,9:25.9774%,7:18.19597%,1:17.46638%,14:0.00306%,2:0.00054%]
[INFO] ** type:[0:99.9991%,1:0.0009%]
[INFO] ** unixtime:1511 (0.27193%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.6344e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.1074e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5126e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1572e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.5434e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.0767e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7949e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5556e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/555656
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1447e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.5728e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/555656
[33m[INFO] loading file 41-41/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (495814, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (495814, 17)

[INFO] analyzing data
[INFO] 495814 rows
[INFO] ** appi_name:[21:99.99657%,30:0.00101%,22:0.00081%,17:0.00081%,32:0.0002%,28:0.0002%,26:0.0002%,7:0.0002%]
[INFO] ** classification:[normal:64.38786%,Single Stage Single Point:35.61214%]
[INFO] ** dst:[21:43.32008%,10:21.06354%,8:18.14108%,9:17.47087%,16:0.00101%,15:0.00101%,6:0.00101%,22:0.00061%,24:0.0004%,17:0.0004%]
[INFO] ** i/f_dir:[1:99.99899%,0:0.00101%]
[INFO] ** i/f_name:[2:99.99899%,3:0.00101%]
[INFO] ** modbus_function_code:[0.02961:99.99657%,-33.760870000000004:0.00343%]
[INFO] ** modbus_function_description:[7:49.99899%,11:49.99758%,0:0.00343%]
[INFO] ** modbus_transaction_id:65536 (13.21786%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99778%,2:0.00121%,1:0.00101%]
[INFO] ** proxy_src_ip:[18:38.43256%,20:25.95126%,13:18.14128%,6:17.47107%,17:0.00101%,1:0.00081%,21:0.0004%,16:0.0004%,14:0.0004%,0:0.0004%,7:0.0002%,2:0.0002%]
[INFO] ** s_port:[1.45442:25.95086%,-0.32151:21.06354%,-1.27613:18.14067%,-0.23351:17.47066%,-0.33484:17.36901%,-71.33197:0.00101%,-71.14931:0.00081%,-1.02014:0.0004%,-1.27347:0.0004%,-71.14798:0.0002%,-0.24151:0.0002%,-58.035180000000004:0.0002%,-1.2708:0.0002%,-5.1466400000000005:0.0002%,1.47576:0.0002%,1.46509:0.0002%,-64.19226:0.0002%,-5.08665:0.0002%,-0.24950999999999998:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** scada_tag:[3:25.95066%,1:21.06354%,5:18.14067%,4:17.47046%,2:17.36901%,0:0.00565%]
[INFO] ** service:[0.0048200000000000005:99.99657%,-211.73542999999998:0.00101%,-205.44247:0.00081%,-211.08818:0.00081%,89.64175:0.0002%,-211.09762999999998:0.0002%,-211.08346:0.0002%,-185.9872:0.0002%]
[INFO] ** src:[22:38.43256%,9:25.95126%,7:18.14128%,1:17.47107%,14:0.00101%,3:0.00081%,15:0.0004%,8:0.0004%,4:0.0004%,2:0.0004%,21:0.0002%,17:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1345 (0.27127%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/495814
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0404e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.3137e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/495814
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.9835e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.2507e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/495814
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.8225e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.2574e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/495814
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2910e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.1233e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/495814
[33m[INFO] loading file 42-42/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (439328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (439328, 17)

[INFO] analyzing data
[INFO] 439328 rows
[INFO] ** appi_name:[21:99.99203%,30:0.00228%,17:0.00114%,31:0.00091%,26:0.00091%,7:0.00091%,22:0.00068%,28:0.00023%,27:0.00023%,9:0.00023%,8:0.00023%,0:0.00023%]
[INFO] ** classification:[normal:64.38037%,Single Stage Single Point:35.61963%]
[INFO] ** dst:[21:43.31843%,10:21.05329%,8:18.17139%,9:17.44778%,16:0.00205%,6:0.00182%,18:0.00114%,22:0.00091%,15:0.00091%,2:0.00091%,17:0.00046%,25:0.00023%,24:0.00023%,7:0.00023%,0:0.00023%]
[INFO] ** i/f_dir:[1:99.99909%,0:0.00091%]
[INFO] ** i/f_name:[2:99.99909%,3:0.00091%]
[INFO] ** modbus_function_code:[0.02961:99.99203%,-33.760870000000004:0.00797%]
[INFO] ** modbus_function_description:[7:49.99704%,11:49.99499%,0:0.00797%]
[INFO] ** modbus_transaction_id:65536 (14.91733%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99568%,2:0.00341%,1:0.00091%]
[INFO] ** proxy_src_ip:[18:38.41003%,20:25.96192%,13:18.17184%,6:17.44778%,17:0.00228%,1:0.00205%,14:0.00137%,21:0.00091%,7:0.00068%,16:0.00046%,0:0.00046%,2:0.00023%]
[INFO] ** s_port:[1.45442:25.96147%,-0.32151:21.05329%,-1.27613:18.17139%,-0.23351:17.44756%,-0.33484:17.35674%,-71.14798:0.00091%,-71.33197:0.00091%,-71.14931:0.00091%,11.57001:0.00046%,-0.08551:0.00046%,-3.3787199999999995:0.00046%,-1.02014:0.00046%,-5.1466400000000005:0.00023%,-0.24151:0.00023%,13.431270000000001:0.00023%,0.31847:0.00023%,-1.2708:0.00023%,-58.035180000000004:0.00023%,7.66617:0.00023%,-64.19493:0.00023%,1.47576:0.00023%,14.4699:0.00023%,15.912510000000001:0.00023%,14.191239999999999:0.00023%,7.9608300000000005:0.00023%,-5.08665:0.00023%,10.192739999999999:0.00023%,-3.0613900000000003:0.00023%,1.45709:0.00023%,2.05573:0.00023%,-43.76509:0.00023%,11.862:0.00023%,-1.27347:0.00023%,-58.032509999999995:0.00023%]
[INFO] ** scada_tag:[3:25.96101%,1:21.05329%,5:18.17116%,4:17.44756%,2:17.35651%,0:0.01047%]
[INFO] ** service:[0.0048200000000000005:99.99203%,-211.09762999999998:0.00159%,-205.44247:0.00114%,-186.43601999999998:0.00114%,-211.08346:0.00091%,-211.73542999999998:0.00091%,-211.08818:0.00091%,-211.35747999999998:0.00046%,-186.44547:0.00023%,-183.8612:0.00023%,-185.9872:0.00023%,-202.75898:0.00023%]
[INFO] ** src:[22:38.41003%,9:25.96192%,7:18.17184%,1:17.44778%,3:0.00273%,2:0.00159%,4:0.00114%,21:0.00091%,14:0.00091%,15:0.00046%,8:0.00046%,17:0.00023%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1192 (0.27132%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/439328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6989e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0383e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/439328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.0540e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.1968e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/439328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.2732e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.1155e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/439328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 6.4536e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.9850e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-41-42-batch-300000-400000
[INFO] processing batch 400000-500000/439328
[33m[INFO] loading file 43-43/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99926%,30:0.00056%,26:0.00019%]
[INFO] ** classification:[normal:64.39569%,Single Stage Single Point:35.60431%]
[INFO] ** dst:[21:43.32688%,10:21.06714%,8:18.13182%,9:17.4723%,22:0.00093%,15:0.00056%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.99926%,-33.760870000000004:0.00074%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99907%,0:0.00074%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99926%,1:0.00056%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.41577%,20:25.97881%,13:18.13201%,6:17.4723%,17:0.00056%,16:0.00037%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.97807%,-0.32151:21.06714%,-1.27613:18.13164%,-0.23351:17.47193%,-0.33484:17.34863%,-71.33197:0.00056%,1.45709:0.00037%,1.47576:0.00037%,-1.02014:0.00037%,-71.14798:0.00019%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.9777%,1:21.06714%,5:18.13145%,4:17.47156%,2:17.34844%,0:0.00371%]
[INFO] ** service:[0.0048200000000000005:99.99926%,-211.73542999999998:0.00056%,-211.08346:0.00019%]
[INFO] ** src:[22:38.41577%,9:25.97881%,7:18.13201%,1:17.4723%,14:0.00056%,15:0.00037%,3:0.00019%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1467 (0.27201%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 1.4655e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4130e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 1.0628e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2260e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.4964e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4445e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.9585e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6180e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.4297e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2133e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 44-44/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99815%,30:0.00074%,31:0.00056%,0:0.00037%,22:0.00019%]
[INFO] ** classification:[normal:64.38123%,Single Stage Single Point:35.61877%]
[INFO] ** dst:[21:43.33411%,10:21.04397%,8:18.15611%,9:17.46247%,22:0.00111%,15:0.00074%,18:0.00056%,25:0.00037%,24:0.00037%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99926%,0:0.00074%]
[INFO] ** i/f_name:[2:99.99926%,3:0.00074%]
[INFO] ** modbus_function_code:[0.02961:99.99815%,-33.760870000000004:0.00185%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99796%,0:0.00185%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99815%,2:0.00111%,1:0.00074%]
[INFO] ** proxy_src_ip:[18:38.42226%,20:25.95638%,13:18.1563%,6:17.46303%,17:0.00074%,7:0.00037%,16:0.00019%,5:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95563%,-0.32151:21.04397%,-1.27613:18.15574%,-0.23351:17.46229%,-0.33484:17.37829%,-71.33197:0.00074%,-0.24151:0.00056%,-0.08551:0.00037%,-64.19493:0.00037%,-1.27347:0.00037%,1.45709:0.00037%,-1.02014:0.00019%,-1.2708:0.00019%,1.47576:0.00019%,-71.14931:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,4.42897:0.00019%]
[INFO] ** scada_tag:[3:25.95508%,1:21.04397%,5:18.15574%,4:17.46192%,2:17.37811%,0:0.00519%]
[INFO] ** service:[0.0048200000000000005:99.99815%,-211.73542999999998:0.00074%,-186.43601999999998:0.00056%,-186.44547:0.00037%,-211.08818:0.00019%]
[INFO] ** src:[22:38.42226%,9:25.95638%,7:18.1563%,1:17.46303%,14:0.00074%,21:0.00037%,17:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1463 (0.27126%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.6039e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.6166e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.9491e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.7922e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.3538e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.6410e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7036e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2847e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.5295e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.7340e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 45-45/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99907%,30:0.00056%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.41813%,Single Stage Single Point:35.58187%]
[INFO] ** dst:[21:43.3254%,10:21.09032%,8:18.11884%,9:17.46321%,22:0.0013%,15:0.00056%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.99907%,-33.760870000000004:0.00093%]
[INFO] ** modbus_function_description:[7:50.00074%,11:49.99833%,0:0.00093%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99926%,1:0.00056%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.49012%,20:25.92634%,13:18.11866%,6:17.46358%,17:0.00056%,16:0.00037%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.9256%,-0.32151:21.09032%,-1.27613:18.11866%,-0.23351:17.46303%,-0.33484:17.3998%,1.45709:0.00056%,-71.33197:0.00056%,-0.24151:0.00037%,-1.02014:0.00037%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,14.4699:0.00019%]
[INFO] ** scada_tag:[3:25.92504%,1:21.09013%,5:18.11866%,4:17.46303%,2:17.39962%,0:0.00352%]
[INFO] ** service:[0.0048200000000000005:99.99907%,-211.73542999999998:0.00056%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.49012%,9:25.92634%,7:18.11866%,1:17.46358%,14:0.00056%,15:0.00037%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1463 (0.27126%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.3276e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2249e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6320e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0687e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.2100e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5231e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0787e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.0044e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.3398e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.2904e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 46-46/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99815%,30:0.00111%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.42925%,Single Stage Single Point:35.57075%]
[INFO] ** dst:[21:43.35136%,10:21.07512%,8:18.09808%,9:17.47267%,22:0.00111%,15:0.00111%,25:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99907%,0:0.00093%]
[INFO] ** i/f_name:[2:99.99889%,3:0.00111%]
[INFO] ** modbus_function_code:[0.02961:99.99815%,-33.760870000000004:0.00185%]
[INFO] ** modbus_function_description:[11:49.99907%,7:49.99907%,0:0.00185%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:99.99963%,1:0.00037%]
[INFO] ** proto:[0:99.99852%,1:0.00111%,2:0.00037%]
[INFO] ** proxy_src_ip:[18:38.45452%,20:25.97195%,13:18.09808%,6:17.47323%,17:0.00111%,16:0.00037%,7:0.00037%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.97158%,-0.32151:21.07493%,-1.27613:18.09789%,-0.23351:17.47248%,-0.33484:17.37959%,-71.33197:0.00111%,-0.24151:0.00056%,-1.02014:0.00037%,-71.14798:0.00019%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-61.95768:0.00019%,-1.2708:0.00019%,10.192739999999999:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:25.97121%,1:21.07474%,5:18.09771%,4:17.47211%,2:17.37959%,0:0.00464%]
[INFO] ** service:[0.0048200000000000005:99.99833%,-211.73542999999998:0.00111%,-211.08346:0.00019%,-205.44247:0.00019%,-186.44547:0.00019%]
[INFO] ** src:[22:38.45452%,9:25.97195%,7:18.09808%,1:17.47323%,14:0.00111%,21:0.00037%,15:0.00037%,16:0.00019%,8:0.00019%]
[INFO] ** type:[0:99.99907%,1:0.00093%]
[INFO] ** unixtime:1466 (0.27182%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.0630e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3599e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.4060e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2590e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.9878e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7926e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.2266e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9399e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.0943e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.4828e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 47-47/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99944%,33:0.00019%,26:0.00019%,17:0.00019%]
[INFO] ** classification:[normal:64.39458%,Single Stage Single Point:35.60542%]
[INFO] ** dst:[21:43.30704%,10:21.0855%,8:18.12719%,9:17.47786%,22:0.00167%,24:0.00037%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99944%,-33.760870000000004:0.00056%]
[INFO] ** modbus_function_description:[7:50.00111%,11:49.99833%,0:0.00056%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99981%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.45712%,20:25.93617%,13:18.12756%,6:17.47823%,16:0.00037%,7:0.00037%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.93524%,-0.32151:21.0855%,-1.27613:18.127%,-0.23351:17.47768%,-0.33484:17.37162%,1.45709:0.00056%,-0.24151:0.00056%,-1.27347:0.00037%,-1.02014:0.00037%,-71.14798:0.00019%,-61.95635:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,10.192739999999999:0.00019%]
[INFO] ** scada_tag:[3:25.93468%,1:21.08531%,5:18.12682%,4:17.47749%,2:17.37143%,0:0.00426%]
[INFO] ** service:[0.0048200000000000005:99.99963%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.45712%,9:25.93617%,7:18.12756%,1:17.47823%,21:0.00037%,15:0.00037%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1464 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.6831e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.6033e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.5851e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.5593e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.3276e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5709e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.6603e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2127e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.9251e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3943e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 48-48/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99666%,30:0.0026%,33:0.00019%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.42313%,Single Stage Single Point:35.57687%]
[INFO] ** dst:[21:43.33485%,10:21.08439%,8:18.11106%,9:17.46544%,15:0.0026%,22:0.00093%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99778%,0:0.00222%]
[INFO] ** i/f_name:[2:99.9974%,3:0.0026%]
[INFO] ** modbus_function_code:[0.02961:99.99666%,-33.760870000000004:0.00334%]
[INFO] ** modbus_function_description:[7:49.99889%,11:49.99778%,0:0.00334%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99685%,1:0.0026%,2:0.00056%]
[INFO] ** proxy_src_ip:[18:38.4586%,20:25.96083%,13:18.11143%,6:17.46544%,17:0.0026%,14:0.00056%,16:0.00037%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.96045%,-0.32151:21.08439%,-1.27613:18.11106%,-0.23351:17.46525%,-0.33484:17.37421%,-71.33197:0.0026%,-1.02014:0.00037%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,1.45709:0.00019%,-61.95635:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,13.431270000000001:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.96008%,1:21.08439%,5:18.11106%,4:17.46525%,2:17.37403%,0:0.00519%]
[INFO] ** service:[0.0048200000000000005:99.99685%,-211.73542999999998:0.0026%,-211.08346:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.4586%,9:25.96083%,7:18.11143%,1:17.46544%,14:0.0026%,2:0.00056%,15:0.00037%,8:0.00019%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1463 (0.27126%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4708e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.4808e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.6117e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.3108e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1425e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7250e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.3916e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.3765e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2202e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4273e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 49-49/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (539328, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (539328, 17)

[INFO] analyzing data
[INFO] 539328 rows
[INFO] ** appi_name:[21:99.99722%,30:0.00093%,17:0.00074%,26:0.00037%,22:0.00037%,28:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.37048%,Single Stage Single Point:35.62952%]
[INFO] ** dst:[21:43.30964%,10:21.05639%,8:18.13813%,9:17.4914%,22:0.0013%,15:0.00093%,16:0.00074%,6:0.00074%,24:0.00037%,17:0.00037%]
[INFO] ** i/f_dir:[1:99.99907%,0:0.00093%]
[INFO] ** i/f_name:[2:99.99907%,3:0.00093%]
[INFO] ** modbus_function_code:[0.02961:99.99722%,-33.760870000000004:0.00278%]
[INFO] ** modbus_function_description:[7:49.99944%,11:49.99778%,0:0.00278%]
[INFO] ** modbus_transaction_id:65536 (12.15142%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99833%,1:0.00093%,2:0.00074%]
[INFO] ** proxy_src_ip:[18:38.41762%,20:25.94914%,13:18.13813%,6:17.49195%,17:0.00093%,1:0.00074%,14:0.00056%,21:0.00037%,16:0.00037%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.9484%,-0.32151:21.05639%,-1.27613:18.13776%,-0.23351:17.49121%,-0.33484:17.36123%,-71.33197:0.00093%,-0.24151:0.00056%,-1.27347:0.00037%,-1.02014:0.00037%,1.45709:0.00037%,-71.14931:0.00037%,-71.14798:0.00037%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-5.1466400000000005:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,-5.08665:0.00019%]
[INFO] ** scada_tag:[3:25.94803%,1:21.0562%,5:18.13757%,4:17.49084%,2:17.36123%,0:0.00612%]
[INFO] ** service:[0.0048200000000000005:99.99722%,-211.73542999999998:0.00093%,-205.44247:0.00074%,-211.08346:0.00037%,-211.08818:0.00037%,-211.09762999999998:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.41762%,9:25.94914%,7:18.13813%,1:17.49195%,14:0.00093%,3:0.00074%,2:0.00056%,15:0.00037%,4:0.00037%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1465 (0.27163%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.8610e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1613e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8023e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2956e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.2932e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5663e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4284e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2066e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/539328
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2589e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3177e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/539328
[33m[INFO] loading file 50-50/50 on epoch 5/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (389310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (389310, 17)

[INFO] analyzing data
[INFO] 389310 rows
[INFO] ** appi_name:[21:99.99743%,30:0.00103%,7:0.00077%,31:0.00026%,22:0.00026%,8:0.00026%]
[INFO] ** classification:[normal:64.30197%,Single Stage Single Point:35.69803%]
[INFO] ** dst:[21:43.25884%,10:21.04005%,8:18.22301%,9:17.47476%,15:0.00103%,22:0.00051%,16:0.00051%,2:0.00051%,24:0.00026%,18:0.00026%,6:0.00026%]
[INFO] ** i/f_dir:[1:99.99897%,0:0.00103%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.99743%,-33.760870000000004:0.00257%]
[INFO] ** modbus_function_description:[11:49.99872%,7:49.99872%,0:0.00257%]
[INFO] ** modbus_transaction_id:65536 (16.83389%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99846%,1:0.00103%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.36583%,20:25.93332%,13:18.22327%,6:17.47476%,17:0.00103%,1:0.00077%,21:0.00026%,16:0.00026%,14:0.00026%,7:0.00026%]
[INFO] ** s_port:[1.45442:25.9328%,-0.32151:21.04005%,-1.27613:18.22275%,-0.23351:17.47476%,-0.33484:17.32578%,-71.33197:0.00103%,-3.3787199999999995:0.00026%,4.33564:0.00026%,15.912510000000001:0.00026%,7.9608300000000005:0.00026%,1.46509:0.00026%,1.45709:0.00026%,-1.27347:0.00026%,-71.14931:0.00026%,-1.02014:0.00026%,-1.2708:0.00026%,0.31847:0.00026%]
[INFO] ** scada_tag:[3:25.93255%,1:21.03979%,5:18.2225%,4:17.47476%,2:17.32552%,0:0.00488%]
[INFO] ** service:[0.0048200000000000005:99.99743%,-211.73542999999998:0.00103%,-211.09762999999998:0.00077%,-186.43601999999998:0.00026%,-211.35747999999998:0.00026%,-211.08818:0.00026%]
[INFO] ** src:[22:38.36583%,9:25.93332%,7:18.22327%,1:17.47476%,14:0.00103%,3:0.00077%,21:0.00026%,15:0.00026%,4:0.00026%,2:0.00026%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1058 (0.27176%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/389310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1428e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0139e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/389310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.4788e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0313e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/389310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.9482e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.4060e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-5-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/389310
[33m[INFO] epoch 6/10[0m
[33m[INFO] loading file 1-1/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99338%,22:0.00102%,30:0.00102%,7:0.00068%,17:0.00068%,31:0.00051%,26:0.00051%,23:0.00034%,18:0.00034%,0:0.00034%,24:0.00017%,27:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,28:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:77.01872%,Single Stage Single Point:22.98128%]
[INFO] ** dst:[21:43.27043%,10:21.02968%,8:18.17481%,9:17.51794%,6:0.00153%,22:0.00102%,16:0.00102%,15:0.00102%,18:0.00051%,26:0.00034%,25:0.00034%,19:0.00034%,17:0.00034%,2:0.00034%,24:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.99898%,0:0.00102%]
[INFO] ** i/f_name:[2:99.99898%,3:0.00102%]
[INFO] ** modbus_function_code:[0.02961:99.99338%,-33.760870000000004:0.00645%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99762%,11:49.99576%,0:0.00645%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99644%,2:0.00255%,1:0.00102%]
[INFO] ** proxy_src_ip:[18:38.38896%,20:25.91081%,13:18.17498%,6:17.51828%,11:0.00119%,10:0.00119%,1:0.00119%,17:0.00102%,14:0.00085%,21:0.00051%,7:0.00051%,16:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.9103%,-0.32151:21.029%,-1.27613:18.17464%,-0.23351:17.51778%,-0.33484:17.35996%,-71.33197:0.00102%,-71.14931:0.00102%,-2.1481:0.00068%,-71.14798:0.00051%,-0.24151:0.00051%,-64.19493:0.00034%,-2.42942:0.00034%,4.44364:0.00034%,-1.02014:0.00034%,1.47576:0.00017%,6.1115699999999995:0.00017%,-1.27347:0.00017%,10.67005:0.00017%,4.29964:0.00017%,-5.08665:0.00017%,-3.3787199999999995:0.00017%,1.45709:0.00017%,-68.79874000000001:0.00017%,2.05573:0.00017%,-5.1466400000000005:0.00017%,-43.76509:0.00017%,14.253910000000001:0.00017%,4.076980000000001:0.00017%,-58.032509999999995:0.00017%,-58.035180000000004:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,0.31847:0.00017%]
[INFO] ** scada_tag:[3:25.91013%,1:21.02883%,5:18.17431%,4:17.51761%,2:17.35979%,0:0.00933%]
[INFO] ** service:[0.0048200000000000005:99.99406%,-211.73542999999998:0.00102%,-211.08818:0.00102%,-211.09762999999998:0.00068%,-205.44247:0.00068%,-211.07873999999998:0.00068%,-211.08346:0.00051%,-186.43601999999998:0.00051%,-186.44547:0.00034%,-185.9872:0.00017%,-211.35747999999998:0.00017%,-202.75898:0.00017%]
[INFO] ** src:[22:38.38896%,9:25.91081%,7:18.17498%,1:17.51828%,11:0.00119%,10:0.00119%,3:0.00119%,14:0.00102%,2:0.00085%,21:0.00051%,4:0.00051%,15:0.00034%,8:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1599 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.0323e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6679 - val_tp: 16218.0000 - val_fp: 3782.0000 - val_tn: 76218.0000 - val_fn: 3782.0000 - val_accuracy: 0.9244 - val_precision: 0.8109 - val_recall: 0.8109 - val_auc: 0.8818
[INFO] saving weights to checkpoints/lstm-epoch-6-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1649 - tp: 78358.0000 - fp: 1642.0000 - tn: 318358.0000 - fn: 1642.0000 - accuracy: 0.9918 - precision: 0.9795 - recall: 0.9795 - auc: 0.9917 - val_loss: 1.0903e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 7.9822e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.0776e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2440 - tp: 74753.0000 - fp: 5247.0000 - tn: 314753.0000 - fn: 5247.0000 - accuracy: 0.9738 - precision: 0.9344 - recall: 0.9344 - auc: 0.9881 - val_loss: 1.0591 - val_tp: 10573.0000 - val_fp: 9427.0000 - val_tn: 70573.0000 - val_fn: 9427.0000 - val_accuracy: 0.8115 - val_precision: 0.5286 - val_recall: 0.5286 - val_auc: 0.9440
[INFO] saving weights to checkpoints/lstm-epoch-6-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0984 - tp: 77066.0000 - fp: 2934.0000 - tn: 317066.0000 - fn: 2934.0000 - accuracy: 0.9853 - precision: 0.9633 - recall: 0.9633 - auc: 0.9990 - val_loss: 0.0113 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 2-2/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99864%,30:0.00051%,7:0.00051%,31:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:69.79943%,Single Stage Single Point:30.20057%]
[INFO] ** dst:[21:43.30895%,10:21.02985%,8:18.13579%,9:17.52304%,22:0.00085%,15:0.00051%,16:0.00034%,2:0.00034%,24:0.00017%,18:0.00017%]
[INFO] ** i/f_dir:[1:99.99949%,0:0.00051%]
[INFO] ** i/f_name:[2:99.99949%,3:0.00051%]
[INFO] ** modbus_function_code:[0.02961:99.99864%,-33.760870000000004:0.00136%]
[INFO] ** modbus_function_description:[7:49.99983%,11:49.99881%,0:0.00136%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99932%,1:0.00051%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.38336%,20:25.95595%,13:18.13579%,6:17.52337%,17:0.00051%,1:0.00051%,16:0.00017%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.95527%,-0.32151:21.02985%,-1.27613:18.13545%,-0.23351:17.52287%,-0.33484:17.35352%,-71.33197:0.00051%,-0.24151:0.00034%,1.45709:0.00034%,1.46509:0.00017%,1.47576:0.00017%,12.60597:0.00017%,10.67005:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,4.076980000000001:0.00017%,-3.3787199999999995:0.00017%,4.29964:0.00017%,-1.27347:0.00017%]
[INFO] ** scada_tag:[3:25.95493%,1:21.02985%,5:18.13545%,4:17.52253%,2:17.35335%,0:0.0039%]
[INFO] ** service:[0.0048200000000000005:99.99864%,-211.09762999999998:0.00051%,-211.73542999999998:0.00051%,-211.35747999999998:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.38336%,9:25.95595%,7:18.13579%,1:17.52337%,14:0.00051%,3:0.00051%,21:0.00017%,15:0.00017%,2:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1602 (0.27184%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0107 - tp: 79927.0000 - fp: 73.0000 - tn: 319927.0000 - fn: 73.0000 - accuracy: 0.9996 - precision: 0.9991 - recall: 0.9991 - auc: 1.0000 - val_loss: 0.0663 - val_tp: 19301.0000 - val_fp: 699.0000 - val_tn: 79301.0000 - val_fn: 699.0000 - val_accuracy: 0.9860 - val_precision: 0.9650 - val_recall: 0.9650 - val_auc: 0.9995
[INFO] saving weights to checkpoints/lstm-epoch-6-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0059 - tp: 79970.0000 - fp: 30.0000 - tn: 319970.0000 - fn: 30.0000 - accuracy: 0.9998 - precision: 0.9996 - recall: 0.9996 - auc: 1.0000 - val_loss: 0.0036 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3153 - tp: 71768.0000 - fp: 8232.0000 - tn: 311768.0000 - fn: 8232.0000 - accuracy: 0.9588 - precision: 0.8971 - recall: 0.8971 - auc: 0.9832 - val_loss: 0.1109 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3043 - tp: 67399.0000 - fp: 12601.0000 - tn: 307399.0000 - fn: 12601.0000 - accuracy: 0.9370 - precision: 0.8425 - recall: 0.8425 - auc: 0.9813 - val_loss: 0.5069 - val_tp: 10605.0000 - val_fp: 9395.0000 - val_tn: 70605.0000 - val_fn: 9395.0000 - val_accuracy: 0.8121 - val_precision: 0.5303 - val_recall: 0.5303 - val_auc: 0.9448
[INFO] saving weights to checkpoints/lstm-epoch-6-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0213 - tp: 79199.0000 - fp: 801.0000 - tn: 319199.0000 - fn: 801.0000 - accuracy: 0.9960 - precision: 0.9900 - recall: 0.9900 - auc: 1.0000 - val_loss: 0.0050 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 3-3/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99219%,30:0.00204%,22:0.00102%,31:0.00085%,26:0.00085%,17:0.00085%,7:0.00068%,27:0.00034%,0:0.00034%,28:0.00017%,23:0.00017%,15:0.00017%,8:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:87.43514%,Single Stage Single Point:12.56486%]
[INFO] ** dst:[21:43.30794%,10:21.07804%,8:18.15971%,9:17.44566%,6:0.00204%,15:0.00136%,18:0.00119%,16:0.00119%,22:0.00085%,2:0.00034%,7:0.00034%,25:0.00034%,17:0.00034%,12:0.00017%,24:0.00017%,19:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99864%,0:0.00136%]
[INFO] ** i/f_name:[2:99.99864%,3:0.00136%]
[INFO] ** modbus_function_code:[0.02961:99.99219%,-33.760870000000004:0.00764%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99695%,11:49.99525%,0:0.00764%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99898%,2:0.00102%]
[INFO] ** proto:[0:99.99457%,2:0.00407%,1:0.00136%]
[INFO] ** proxy_src_ip:[18:38.40457%,20:25.98157%,13:18.16005%,6:17.446%,17:0.00204%,1:0.00136%,14:0.00119%,7:0.00085%,11:0.00068%,10:0.00068%,21:0.00051%,16:0.00017%,15:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.98089%,-0.32151:21.07787%,-1.27613:18.15937%,-0.23351:17.44549%,-0.33484:17.3267%,-71.33197:0.00136%,-71.14931:0.00102%,-71.14798:0.00102%,-64.19493:0.00034%,-1.2708:0.00034%,-0.08551:0.00034%,1.45709:0.00034%,-0.24151:0.00034%,13.86459:0.00017%,2.05573:0.00017%,6.1115699999999995:0.00017%,4.44364:0.00017%,-5.08665:0.00017%,-3.3787199999999995:0.00017%,10.192739999999999:0.00017%,4.29964:0.00017%,14.4699:0.00017%,-43.76509:0.00017%,-58.035180000000004:0.00017%,4.90362:0.00017%,4.076980000000001:0.00017%,-58.032509999999995:0.00017%,-1.27347:0.00017%,-1.02014:0.00017%,-5.1466400000000005:0.00017%,13.431270000000001:0.00017%,12.60597:0.00017%,1.47576:0.00017%,1.46509:0.00017%,14.253910000000001:0.00017%,-68.79874000000001:0.00017%,-0.24950999999999998:0.00017%,-2.1481:0.00017%,10.67005:0.00017%,-68.36943000000001:0.00017%]
[INFO] ** scada_tag:[3:25.98055%,1:21.0777%,5:18.1592%,4:17.44532%,2:17.32653%,0:0.01069%]
[INFO] ** service:[0.0048200000000000005:99.99236%,-211.73542999999998:0.00136%,-186.43601999999998:0.00119%,-211.08346:0.00102%,-211.08818:0.00102%,-205.44247:0.00085%,-211.09762999999998:0.00068%,-202.75898:0.00034%,-186.44547:0.00034%,-183.8612:0.00017%,-185.9872:0.00017%,-201.23771000000002:0.00017%,-211.35747999999998:0.00017%,-211.07873999999998:0.00017%]
[INFO] ** src:[22:38.40457%,9:25.98157%,7:18.16005%,1:17.446%,21:0.00187%,3:0.00153%,2:0.00119%,11:0.00068%,10:0.00068%,4:0.00068%,14:0.00034%,8:0.00034%,17:0.00017%,15:0.00017%,13:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1601 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2944 - tp: 71876.0000 - fp: 8124.0000 - tn: 311876.0000 - fn: 8124.0000 - accuracy: 0.9594 - precision: 0.8985 - recall: 0.8985 - auc: 0.9855 - val_loss: 0.2599 - val_tp: 17863.0000 - val_fp: 2137.0000 - val_tn: 77863.0000 - val_fn: 2137.0000 - val_accuracy: 0.9573 - val_precision: 0.8931 - val_recall: 0.8931 - val_auc: 0.9878
[INFO] saving weights to checkpoints/lstm-epoch-6-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0576 - tp: 78567.0000 - fp: 1433.0000 - tn: 318567.0000 - fn: 1433.0000 - accuracy: 0.9928 - precision: 0.9821 - recall: 0.9821 - auc: 0.9998 - val_loss: 0.0036 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3792 - tp: 61785.0000 - fp: 18215.0000 - tn: 301785.0000 - fn: 18215.0000 - accuracy: 0.9089 - precision: 0.7723 - recall: 0.7723 - auc: 0.9720 - val_loss: 0.3062 - val_tp: 17282.0000 - val_fp: 2718.0000 - val_tn: 77282.0000 - val_fn: 2718.0000 - val_accuracy: 0.9456 - val_precision: 0.8641 - val_recall: 0.8641 - val_auc: 0.9871
[INFO] saving weights to checkpoints/lstm-epoch-6-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0100 - tp: 79917.0000 - fp: 83.0000 - tn: 319917.0000 - fn: 83.0000 - accuracy: 0.9996 - precision: 0.9990 - recall: 0.9990 - auc: 1.0000 - val_loss: 2.2489e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6170e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1908e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 4-4/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99779%,30:0.00119%,31:0.00034%,33:0.00017%,26:0.00017%,23:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:92.57097%,Single Stage Single Point:7.42903%]
[INFO] ** dst:[21:43.35019%,10:20.95026%,8:18.17651%,9:17.51947%,22:0.00119%,15:0.00119%,24:0.00034%,18:0.00034%,19:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99898%,0:0.00102%]
[INFO] ** i/f_name:[2:99.99881%,3:0.00119%]
[INFO] ** modbus_function_code:[0.02961:99.99779%,-33.760870000000004:0.00221%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99779%,0:0.00221%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99898%,2:0.00102%]
[INFO] ** proto:[0:99.9983%,1:0.00119%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.26034%,20:26.04045%,13:18.17668%,6:17.51981%,17:0.00119%,16:0.00051%,21:0.00034%,14:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.03978%,-0.32151:20.95009%,-1.27613:18.17617%,-0.23351:17.5193%,-0.33484:17.31024%,-71.33197:0.00119%,-1.02014:0.00051%,1.45709:0.00034%,-0.08551:0.00034%,-1.27347:0.00034%,-0.24151:0.00034%,14.4699:0.00017%,4.44364:0.00017%,-71.14798:0.00017%,-1.2708:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:26.03944%,1:20.94992%,5:18.17617%,4:17.51896%,2:17.31007%,0:0.00543%]
[INFO] ** service:[0.0048200000000000005:99.99796%,-211.73542999999998:0.00119%,-186.43601999999998:0.00034%,-183.8612:0.00017%,-211.08346:0.00017%,-211.07873999999998:0.00017%]
[INFO] ** src:[22:38.26034%,9:26.04045%,7:18.17668%,1:17.51981%,21:0.00102%,15:0.00051%,4:0.00034%,17:0.00017%,14:0.00017%,8:0.00017%,3:0.00017%,2:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1611 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0210e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.3348e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.3065e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.4779e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7005e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.5771e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.1913e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.6461e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.4806 - tp: 64872.0000 - fp: 15128.0000 - tn: 304872.0000 - fn: 15128.0000 - accuracy: 0.9244 - precision: 0.8109 - recall: 0.8109 - auc: 0.9643 - val_loss: 0.7737 - val_tp: 7812.0000 - val_fp: 12188.0000 - val_tn: 67812.0000 - val_fn: 12188.0000 - val_accuracy: 0.7562 - val_precision: 0.3906 - val_recall: 0.3906 - val_auc: 0.9072
[INFO] saving weights to checkpoints/lstm-epoch-6-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 5-5/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99627%,30:0.00272%,37:0.00017%,26:0.00017%,12:0.00017%,9:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:87.62298%,Single Stage Single Point:12.37702%]
[INFO] ** dst:[21:43.36224%,10:20.77005%,8:18.24252%,9:17.62078%,15:0.00272%,22:0.00085%,25:0.00017%,24:0.00017%,6:0.00017%,2:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99762%,0:0.00238%]
[INFO] ** i/f_name:[2:99.99728%,3:0.00272%]
[INFO] ** modbus_function_code:[0.02961:99.99627%,-33.760870000000004:0.00373%]
[INFO] ** modbus_function_description:[7:49.99864%,11:49.99762%,0:0.00373%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99779%,2:0.00221%]
[INFO] ** proto:[0:99.99695%,1:0.00272%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.00682%,20:26.12581%,13:18.24252%,6:17.62095%,17:0.00272%,1:0.00034%,21:0.00017%,16:0.00017%,7:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.12513%,-0.32151:20.76971%,-1.27613:18.24235%,-0.23351:17.62061%,-0.33484:17.23711%,-71.33197:0.00272%,-0.24151:0.00034%,1.45709:0.00034%,1.47576:0.00017%,1.46509:0.00017%,-49.275529999999996:0.00017%,-1.27347:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,2.22906:0.00017%,14.4699:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.12479%,1:20.76954%,5:18.24218%,4:17.62061%,2:17.23694%,0:0.00594%]
[INFO] ** service:[0.0048200000000000005:99.99661%,-211.73542999999998:0.00272%,-183.8612:0.00017%,-211.08346:0.00017%,-211.35747999999998:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.00682%,9:26.12581%,7:18.24252%,1:17.62095%,21:0.00238%,14:0.00051%,3:0.00034%,16:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1614 (0.27388%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3973 - tp: 63392.0000 - fp: 16608.0000 - tn: 303392.0000 - fn: 16608.0000 - accuracy: 0.9170 - precision: 0.7924 - recall: 0.7924 - auc: 0.9685 - val_loss: 0.2576 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2498 - tp: 71462.0000 - fp: 8538.0000 - tn: 311462.0000 - fn: 8538.0000 - accuracy: 0.9573 - precision: 0.8933 - recall: 0.8933 - auc: 0.9893 - val_loss: 0.0903 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0521 - tp: 79146.0000 - fp: 854.0000 - tn: 319146.0000 - fn: 854.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9990 - val_loss: 1.4450 - val_tp: 12817.0000 - val_fp: 7183.0000 - val_tn: 72817.0000 - val_fn: 7183.0000 - val_accuracy: 0.8563 - val_precision: 0.6409 - val_recall: 0.6409 - val_auc: 0.9675
[INFO] saving weights to checkpoints/lstm-epoch-6-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0305 - tp: 79135.0000 - fp: 865.0000 - tn: 319135.0000 - fn: 865.0000 - accuracy: 0.9957 - precision: 0.9892 - recall: 0.9892 - auc: 0.9999 - val_loss: 2.7726e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.0389e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5134e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 6-6/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.9961%,30:0.00305%,31:0.00017%,27:0.00017%,26:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:93.14368%,Single Stage Single Point:6.85632%]
[INFO] ** dst:[21:43.37785%,10:20.73221%,8:18.27833%,9:17.60703%,15:0.00305%,22:0.00051%,25:0.00017%,24:0.00017%,18:0.00017%,12:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99712%,0:0.00288%]
[INFO] ** i/f_name:[2:99.99695%,3:0.00305%]
[INFO] ** modbus_function_code:[0.02961:99.9961%,-33.760870000000004:0.0039%]
[INFO] ** modbus_function_description:[7:49.99864%,11:49.99745%,0:0.0039%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.9961%,1:0.00305%,2:0.00085%]
[INFO] ** proxy_src_ip:[18:37.95031%,20:26.15992%,13:18.2785%,6:17.6072%,17:0.00305%,14:0.00051%,16:0.00034%,11:0.00017%]
[INFO] ** s_port:[1.45442:26.15958%,-0.32151:20.73221%,-1.27613:18.27799%,-0.23351:17.60686%,-0.33484:17.2181%,-71.33197:0.00305%,-1.02014:0.00034%,-71.14798:0.00017%,-64.19493:0.00017%,4.90362:0.00017%,-1.2708:0.00017%,-0.24151:0.00017%,13.431270000000001:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-68.36943000000001:0.00017%]
[INFO] ** scada_tag:[3:26.15941%,1:20.73187%,5:18.27782%,4:17.60652%,2:17.21793%,0:0.00645%]
[INFO] ** service:[0.0048200000000000005:99.9961%,-211.73542999999998:0.00305%,-211.08346:0.00017%,-201.23771000000002:0.00017%,-202.75898:0.00017%,-186.44547:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:37.95031%,9:26.15992%,7:18.2785%,1:17.6072%,14:0.00305%,2:0.00051%,15:0.00034%,10:0.00017%]
[INFO] ** type:[0:99.99915%,1:0.00085%]
[INFO] ** unixtime:1613 (0.27371%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.9710e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.7928e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.1014e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.7151e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.7321e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.0922e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.2273e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.7048e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0664 - tp: 78956.0000 - fp: 1044.0000 - tn: 318956.0000 - fn: 1044.0000 - accuracy: 0.9948 - precision: 0.9869 - recall: 0.9869 - auc: 0.9976 - val_loss: 1.1431 - val_tp: 12837.0000 - val_fp: 7163.0000 - val_tn: 72837.0000 - val_fn: 7163.0000 - val_accuracy: 0.8567 - val_precision: 0.6418 - val_recall: 0.6418 - val_auc: 0.9679
[INFO] saving weights to checkpoints/lstm-epoch-6-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 7-7/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99525%,30:0.00187%,22:0.00085%,17:0.00068%,26:0.00051%,31:0.00034%,28:0.00017%,27:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:79.87188%,Single Stage Single Point:20.12812%]
[INFO] ** dst:[21:43.36275%,10:20.7278%,8:18.2583%,9:17.6447%,15:0.00187%,22:0.00136%,6:0.00136%,16:0.00068%,24:0.00034%,18:0.00034%,17:0.00034%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.99813%,0:0.00187%]
[INFO] ** i/f_name:[2:99.99813%,3:0.00187%]
[INFO] ** modbus_function_code:[0.02961:99.99525%,-33.760870000000004:0.00475%]
[INFO] ** modbus_function_description:[7:49.9983%,11:49.99695%,0:0.00475%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.99627%,2:0.00187%,1:0.00187%]
[INFO] ** proxy_src_ip:[18:37.94913%,20:26.1421%,13:18.25864%,6:17.64487%,17:0.00187%,11:0.00068%,1:0.00068%,21:0.00051%,16:0.00051%,14:0.00034%,7:0.00034%,10:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.14125%,-0.32151:20.7278%,-1.27613:18.25813%,-0.23351:17.64453%,-0.33484:17.22133%,-71.33197:0.00187%,-71.14931:0.00085%,-1.02014:0.00051%,-71.14798:0.00051%,1.45709:0.00051%,-0.24151:0.00034%,-1.27347:0.00034%,1.47576:0.00017%,1.46509:0.00017%,14.253910000000001:0.00017%,-1.2708:0.00017%,-58.035180000000004:0.00017%,-58.032509999999995:0.00017%,-68.79874000000001:0.00017%,-43.76509:0.00017%,2.05573:0.00017%,6.1115699999999995:0.00017%,-5.08665:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:26.14091%,1:20.7278%,5:18.25796%,4:17.64436%,2:17.22116%,0:0.00781%]
[INFO] ** service:[0.0048200000000000005:99.99525%,-211.73542999999998:0.00187%,-211.08818:0.00085%,-205.44247:0.00068%,-211.08346:0.00051%,-186.43601999999998:0.00034%,-211.09762999999998:0.00017%,-185.9872:0.00017%,-202.75898:0.00017%]
[INFO] ** src:[22:37.94913%,9:26.1421%,7:18.25864%,1:17.64487%,14:0.00187%,10:0.00068%,3:0.00068%,15:0.00051%,4:0.00051%,21:0.00034%,2:0.00034%,11:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99932%,1:0.00068%]
[INFO] ** unixtime:1611 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0387 - tp: 78955.0000 - fp: 1045.0000 - tn: 318955.0000 - fn: 1045.0000 - accuracy: 0.9948 - precision: 0.9869 - recall: 0.9869 - auc: 0.9997 - val_loss: 0.0045 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0013 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.7753e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.8205e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1505e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3054 - tp: 68430.0000 - fp: 11570.0000 - tn: 308430.0000 - fn: 11570.0000 - accuracy: 0.9421 - precision: 0.8554 - recall: 0.8554 - auc: 0.9833 - val_loss: 0.1637 - val_tp: 19984.0000 - val_fp: 16.0000 - val_tn: 79984.0000 - val_fn: 16.0000 - val_accuracy: 0.9997 - val_precision: 0.9992 - val_recall: 0.9992 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0071 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.4146e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 8-8/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99678%,30:0.00102%,0:0.00051%,28:0.00017%,26:0.00017%,24:0.00017%,23:0.00017%,22:0.00017%,18:0.00017%,17:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:95.1506%,Single Stage Single Point:4.8494%]
[INFO] ** dst:[21:43.4162%,10:20.80179%,8:18.19535%,9:17.5826%,22:0.00136%,15:0.00102%,25:0.00051%,19:0.00034%,17:0.00034%,26:0.00017%,24:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99932%,0:0.00068%]
[INFO] ** i/f_name:[2:99.99898%,3:0.00102%]
[INFO] ** modbus_function_code:[0.02961:99.99678%,-33.760870000000004:0.00305%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99966%,11:49.99712%,0:0.00305%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99966%,2:0.00034%]
[INFO] ** proto:[0:99.99813%,1:0.00102%,2:0.00085%]
[INFO] ** proxy_src_ip:[18:38.08284%,20:26.13548%,13:18.19484%,6:17.58294%,17:0.00102%,10:0.00102%,16:0.00068%,1:0.00051%,14:0.00034%,11:0.00017%,5:0.00017%]
[INFO] ** s_port:[1.45442:26.13497%,-0.32151:20.80179%,-1.27613:18.1945%,-0.23351:17.58243%,-0.33484:17.28106%,-71.33197:0.00102%,-1.02014:0.00068%,-15.039579999999999:0.00068%,-64.19493:0.00051%,4.66896:0.00034%,-0.24151:0.00034%,1.45709:0.00034%,-5.1466400000000005:0.00017%,-1.27347:0.00017%,-1.2708:0.00017%,1.47576:0.00017%,-5.08665:0.00017%,-71.14931:0.00017%,-0.24950999999999998:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.13446%,1:20.80162%,5:18.1945%,4:17.58226%,2:17.28089%,0:0.00628%]
[INFO] ** service:[0.0048200000000000005:99.99745%,-211.73542999999998:0.00102%,-186.44547:0.00051%,-211.07873999999998:0.00034%,-211.08346:0.00017%,-185.9872:0.00017%,-205.44247:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.08284%,9:26.13548%,7:18.19484%,1:17.58294%,11:0.00102%,15:0.00068%,14:0.00068%,3:0.00051%,21:0.00034%,2:0.00034%,16:0.00017%,10:0.00017%]
[INFO] ** type:[0:99.99949%,1:0.00034%,2:0.00017%]
[INFO] ** unixtime:1613 (0.27371%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.0495e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8657e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.2059e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7172e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.3939e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1032e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.1183e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.5104e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1920 - tp: 73005.0000 - fp: 6995.0000 - tn: 313005.0000 - fn: 6995.0000 - accuracy: 0.9650 - precision: 0.9126 - recall: 0.9126 - auc: 0.9924 - val_loss: 0.0815 - val_tp: 19988.0000 - val_fp: 12.0000 - val_tn: 79988.0000 - val_fn: 12.0000 - val_accuracy: 0.9998 - val_precision: 0.9994 - val_recall: 0.9994 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 9-9/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.9983%,30:0.00102%,31:0.00034%,26:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:93.94597%,Single Stage Single Point:6.05403%]
[INFO] ** dst:[21:43.38124%,10:20.77243%,8:18.27323%,9:17.57038%,15:0.00102%,22:0.00085%,18:0.00034%,25:0.00017%,24:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99898%,0:0.00102%]
[INFO] ** i/f_name:[2:99.99898%,3:0.00102%]
[INFO] ** modbus_function_code:[0.02961:99.9983%,-33.760870000000004:0.0017%]
[INFO] ** modbus_function_description:[7:49.99983%,11:49.99847%,0:0.0017%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99966%,2:0.00034%]
[INFO] ** proto:[0:99.9983%,1:0.00102%,2:0.00068%]
[INFO] ** proxy_src_ip:[18:38.01225%,20:26.14193%,13:18.27323%,6:17.57072%,17:0.00102%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.14125%,-0.32151:20.77243%,-1.27613:18.2729%,-0.23351:17.57021%,-0.33484:17.23982%,-71.33197:0.00102%,-0.24151:0.00034%,1.45709:0.00034%,-0.08551:0.00034%,1.46509:0.00017%,1.47576:0.00017%,-1.27347:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.14091%,1:20.77226%,5:18.2729%,4:17.57004%,2:17.23965%,0:0.00424%]
[INFO] ** service:[0.0048200000000000005:99.9983%,-211.73542999999998:0.00102%,-186.43601999999998:0.00034%,-211.08346:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.01225%,9:26.14193%,7:18.27323%,1:17.57072%,14:0.00068%,21:0.00034%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1614 (0.27388%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0079 - tp: 79947.0000 - fp: 53.0000 - tn: 319947.0000 - fn: 53.0000 - accuracy: 0.9997 - precision: 0.9993 - recall: 0.9993 - auc: 1.0000 - val_loss: 0.0047 - val_tp: 19992.0000 - val_fp: 8.0000 - val_tn: 79992.0000 - val_fn: 8.0000 - val_accuracy: 0.9998 - val_precision: 0.9996 - val_recall: 0.9996 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0012 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.3078 - val_tp: 19149.0000 - val_fp: 851.0000 - val_tn: 79149.0000 - val_fn: 851.0000 - val_accuracy: 0.9830 - val_precision: 0.9574 - val_recall: 0.9574 - val_auc: 0.9759
[INFO] saving weights to checkpoints/lstm-epoch-6-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0222 - tp: 79655.0000 - fp: 345.0000 - tn: 319655.0000 - fn: 345.0000 - accuracy: 0.9983 - precision: 0.9957 - recall: 0.9957 - auc: 0.9986 - val_loss: 3.1487e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.1415e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0116e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9586e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8765e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 10-10/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99644%,30:0.0017%,31:0.00034%,26:0.00017%,24:0.00017%,23:0.00017%,22:0.00017%,18:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:94.81614%,Single Stage Single Point:5.18386%]
[INFO] ** dst:[21:43.40924%,10:20.80891%,8:18.22793%,9:17.55002%,15:0.0017%,24:0.00051%,22:0.00051%,19:0.00034%,18:0.00034%,26:0.00017%,25:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99847%,0:0.00153%]
[INFO] ** i/f_name:[2:99.9983%,3:0.0017%]
[INFO] ** modbus_function_code:[0.02961:99.99644%,-33.760870000000004:0.00339%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99915%,11:49.99728%,0:0.00339%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99932%,1:0.00068%]
[INFO] ** proto:[0:99.99745%,1:0.0017%,2:0.00085%]
[INFO] ** proxy_src_ip:[18:38.08165%,20:26.13701%,13:18.22827%,6:17.54934%,17:0.0017%,10:0.00085%,14:0.00034%,21:0.00017%,16:0.00017%,5:0.00017%,2:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.13633%,-0.32151:20.80891%,-1.27613:18.22759%,-0.23351:17.549%,-0.33484:17.27274%,-71.33197:0.0017%,-10.51843:0.00068%,-1.27347:0.00051%,-0.08551:0.00034%,5.71692:0.00034%,1.47576:0.00034%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-71.14931:0.00017%,-64.19493:0.00017%,1.45709:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.13599%,1:20.80874%,5:18.22759%,4:17.54883%,2:17.27257%,0:0.00628%]
[INFO] ** service:[0.0048200000000000005:99.99712%,-211.73542999999998:0.0017%,-211.07873999999998:0.00034%,-186.43601999999998:0.00034%,-211.08346:0.00017%,-186.44547:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.08165%,9:26.13701%,7:18.22827%,1:17.54934%,14:0.0017%,11:0.00085%,2:0.00034%,17:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%]
[INFO] ** type:[0:99.99864%,1:0.00119%,2:0.00017%]
[INFO] ** unixtime:1610 (0.2732%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.2251e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3592e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.7030e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5802e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.1685 - tp: 76097.0000 - fp: 3903.0000 - tn: 316097.0000 - fn: 3903.0000 - accuracy: 0.9805 - precision: 0.9512 - recall: 0.9512 - auc: 0.9941 - val_loss: 0.7289 - val_tp: 12829.0000 - val_fp: 7171.0000 - val_tn: 72829.0000 - val_fn: 7171.0000 - val_accuracy: 0.8566 - val_precision: 0.6414 - val_recall: 0.6414 - val_auc: 0.9679
[INFO] saving weights to checkpoints/lstm-epoch-6-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.2345 - tp: 70420.0000 - fp: 9580.0000 - tn: 310420.0000 - fn: 9580.0000 - accuracy: 0.9521 - precision: 0.8802 - recall: 0.8802 - auc: 0.9893 - val_loss: 0.3678 - val_tp: 12839.0000 - val_fp: 7161.0000 - val_tn: 72839.0000 - val_fn: 7161.0000 - val_accuracy: 0.8568 - val_precision: 0.6420 - val_recall: 0.6420 - val_auc: 0.9679
[INFO] saving weights to checkpoints/lstm-epoch-6-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0130 - tp: 79413.0000 - fp: 587.0000 - tn: 319413.0000 - fn: 587.0000 - accuracy: 0.9971 - precision: 0.9927 - recall: 0.9927 - auc: 1.0000 - val_loss: 2.9205e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 11-11/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99898%,31:0.00034%,30:0.00034%,26:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.39465%,10:20.86983%,8:18.19331%,9:17.54%,22:0.00119%,18:0.00034%,15:0.00034%,25:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99966%,0:0.00034%]
[INFO] ** i/f_name:[2:99.99966%,3:0.00034%]
[INFO] ** modbus_function_code:[0.02961:99.99898%,-33.760870000000004:0.00102%]
[INFO] ** modbus_function_description:[7:50.00068%,11:49.9983%,0:0.00102%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99898%,2:0.00068%,1:0.00034%]
[INFO] ** proxy_src_ip:[18:38.14444%,20:26.12038%,13:18.19331%,6:17.54034%,16:0.00051%,17:0.00034%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.11987%,-0.32151:20.86983%,-1.27613:18.19314%,-0.23351:17.53983%,-0.33484:17.27461%,-0.24151:0.00051%,-1.02014:0.00051%,-0.08551:0.00034%,-71.33197:0.00034%,-71.14798:0.00017%,1.45709:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:26.11953%,1:20.86966%,5:18.19297%,4:17.5395%,2:17.27444%,0:0.0039%]
[INFO] ** service:[0.0048200000000000005:99.99898%,-211.73542999999998:0.00034%,-186.43601999999998:0.00034%,-211.08346:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.14444%,9:26.12038%,7:18.19331%,1:17.54034%,15:0.00051%,14:0.00034%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1610 (0.2732%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6927e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2592e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0943e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.9636e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.4682e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.1699e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.9181e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1534e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9154e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7333e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 12-12/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99728%,30:0.00204%,31:0.00034%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:93.85875%,Single Stage Single Point:6.14125%]
[INFO] ** dst:[21:43.40602%,10:20.88205%,8:18.17923%,9:17.52914%,15:0.00204%,22:0.00051%,24:0.00034%,18:0.00034%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.9983%,0:0.0017%]
[INFO] ** i/f_name:[2:99.99796%,3:0.00204%]
[INFO] ** modbus_function_code:[0.02961:99.99728%,-33.760870000000004:0.00272%]
[INFO] ** modbus_function_description:[7:49.99932%,11:49.99796%,0:0.00272%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99847%,2:0.00153%]
[INFO] ** proto:[0:99.99745%,1:0.00204%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.15309%,20:26.13531%,13:18.1794%,6:17.52931%,17:0.00204%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.1348%,-0.32151:20.88205%,-1.27613:18.17889%,-0.23351:17.52897%,-0.33484:17.27105%,-71.33197:0.00204%,-1.27347:0.00034%,-0.08551:0.00034%,1.46509:0.00017%,1.47576:0.00017%,-0.24950999999999998:0.00017%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,1.45709:0.00017%,14.4699:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.13446%,1:20.88205%,5:18.17889%,4:17.52864%,2:17.27105%,0:0.00492%]
[INFO] ** service:[0.0048200000000000005:99.99728%,-211.73542999999998:0.00204%,-186.43601999999998:0.00034%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.15309%,9:26.13531%,7:18.1794%,1:17.52931%,21:0.00153%,14:0.00051%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1611 (0.27337%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.2733e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2726e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.2804e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1515e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.9983e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7720 - val_tp: 12867.0000 - val_fp: 7133.0000 - val_tn: 72867.0000 - val_fn: 7133.0000 - val_accuracy: 0.8573 - val_precision: 0.6434 - val_recall: 0.6434 - val_auc: 0.7771
[INFO] saving weights to checkpoints/lstm-epoch-6-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.1332 - tp: 78083.0000 - fp: 1917.0000 - tn: 318083.0000 - fn: 1917.0000 - accuracy: 0.9904 - precision: 0.9760 - recall: 0.9760 - auc: 0.9926 - val_loss: 2.9078 - val_tp: 13241.0000 - val_fp: 6759.0000 - val_tn: 73241.0000 - val_fn: 6759.0000 - val_accuracy: 0.8648 - val_precision: 0.6621 - val_recall: 0.6621 - val_auc: 0.8088
[INFO] saving weights to checkpoints/lstm-epoch-6-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.1394 - tp: 77583.0000 - fp: 2417.0000 - tn: 317583.0000 - fn: 2417.0000 - accuracy: 0.9879 - precision: 0.9698 - recall: 0.9698 - auc: 0.9929 - val_loss: 6.3221e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 13-13/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99661%,31:0.00068%,30:0.00051%,26:0.00051%,0:0.00051%,22:0.00034%,27:0.00017%,24:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:87.01651%,Single Stage Single Point:12.98349%]
[INFO] ** dst:[21:43.35766%,10:20.80908%,8:18.2729%,9:17.55646%,22:0.00102%,6:0.00085%,18:0.00068%,25:0.00051%,15:0.00051%,24:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.99966%,0:0.00034%]
[INFO] ** i/f_name:[2:99.99949%,3:0.00051%]
[INFO] ** modbus_function_code:[0.02961:99.99661%,-33.760870000000004:0.00322%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99881%,11:49.99779%,0:0.00322%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99728%,2:0.00221%,1:0.00051%]
[INFO] ** proxy_src_ip:[18:38.05433%,20:26.11274%,13:18.27307%,6:17.55596%,10:0.00102%,11:0.00085%,17:0.00051%,16:0.00051%,7:0.00034%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.11223%,-0.32151:20.80908%,-1.27613:18.27273%,-0.23351:17.55562%,-0.33484:17.24525%,-9.78512:0.00068%,-64.19493:0.00051%,-1.02014:0.00051%,-71.14798:0.00051%,-71.33197:0.00051%,-0.24151:0.00034%,-71.14931:0.00034%,-0.08551:0.00034%,1.47576:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-1.2708:0.00017%,-68.79874000000001:0.00017%,6.1115699999999995:0.00017%,14.540560000000001:0.00017%,1.45709:0.00017%]
[INFO] ** scada_tag:[3:26.11189%,1:20.80891%,5:18.27273%,4:17.55562%,2:17.24508%,0:0.00577%]
[INFO] ** service:[0.0048200000000000005:99.99728%,-186.43601999999998:0.00068%,-211.08346:0.00051%,-186.44547:0.00051%,-211.73542999999998:0.00051%,-211.08818:0.00034%,-202.75898:0.00017%]
[INFO] ** src:[22:38.05433%,9:26.11274%,7:18.27307%,1:17.55596%,11:0.00102%,10:0.00085%,15:0.00051%,14:0.00051%,21:0.00034%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99966%,2:0.00017%,1:0.00017%]
[INFO] ** unixtime:1610 (0.2732%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.4037e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6208e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.2755e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9016e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.6495e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4667e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.1015 - tp: 78410.0000 - fp: 1590.0000 - tn: 318410.0000 - fn: 1590.0000 - accuracy: 0.9921 - precision: 0.9801 - recall: 0.9801 - auc: 0.9948 - val_loss: 0.9992 - val_tp: 12841.0000 - val_fp: 7159.0000 - val_tn: 72841.0000 - val_fn: 7159.0000 - val_accuracy: 0.8568 - val_precision: 0.6421 - val_recall: 0.6421 - val_auc: 0.9680
[INFO] saving weights to checkpoints/lstm-epoch-6-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0615 - tp: 77694.0000 - fp: 2306.0000 - tn: 317694.0000 - fn: 2306.0000 - accuracy: 0.9885 - precision: 0.9712 - recall: 0.9712 - auc: 0.9996 - val_loss: 0.0016 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 14-14/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99898%,31:0.00034%,30:0.00034%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:91.61613%,Single Stage Single Point:8.38387%]
[INFO] ** dst:[21:43.35341%,10:20.80518%,8:18.26848%,9:17.57089%,22:0.00068%,24:0.00034%,18:0.00034%,15:0.00034%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99983%,0:0.00017%]
[INFO] ** i/f_name:[2:99.99966%,3:0.00034%]
[INFO] ** modbus_function_code:[0.02961:99.99898%,-33.760870000000004:0.00102%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.99881%,0:0.00102%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99915%,2:0.00051%,1:0.00034%]
[INFO] ** proxy_src_ip:[18:38.04297%,20:26.11614%,13:18.26865%,6:17.57106%,17:0.00034%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.11546%,-0.32151:20.80518%,-1.27613:18.26814%,-0.23351:17.57072%,-0.33484:17.23779%,-1.27347:0.00034%,-0.08551:0.00034%,-71.33197:0.00034%,1.45709:0.00034%,1.47576:0.00017%,1.46509:0.00017%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,-0.24950999999999998:0.00017%,14.4699:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.11512%,1:20.80518%,5:18.26797%,4:17.57038%,2:17.23762%,0:0.00373%]
[INFO] ** service:[0.0048200000000000005:99.99898%,-211.73542999999998:0.00034%,-186.43601999999998:0.00034%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.04297%,9:26.11614%,7:18.26865%,1:17.57106%,14:0.00034%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1610 (0.2732%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0012 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.0847e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2978 - tp: 65724.0000 - fp: 14276.0000 - tn: 305724.0000 - fn: 14276.0000 - accuracy: 0.9286 - precision: 0.8216 - recall: 0.8216 - auc: 0.9812 - val_loss: 0.2270 - val_tp: 19424.0000 - val_fp: 576.0000 - val_tn: 79424.0000 - val_fn: 576.0000 - val_accuracy: 0.9885 - val_precision: 0.9712 - val_recall: 0.9712 - val_auc: 0.9983
[INFO] saving weights to checkpoints/lstm-epoch-6-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0201 - tp: 79954.0000 - fp: 46.0000 - tn: 319954.0000 - fn: 46.0000 - accuracy: 0.9998 - precision: 0.9994 - recall: 0.9994 - auc: 1.0000 - val_loss: 2.1197e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0817e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.0913e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.5213e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1252e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 15-15/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (589310, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (589310, 17)

[INFO] analyzing data
[INFO] 589310 rows
[INFO] ** appi_name:[21:99.99644%,30:0.00288%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:90.62802%,Single Stage Multi Point:9.3713%,Single Stage Single Point:0.00068%]
[INFO] ** dst:[21:43.30285%,10:20.78363%,8:18.31023%,9:17.59821%,15:0.00288%,22:0.00153%,25:0.00017%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99728%,0:0.00272%]
[INFO] ** i/f_name:[2:99.99712%,3:0.00288%]
[INFO] ** modbus_function_code:[0.02961:99.99644%,-33.760870000000004:0.00356%]
[INFO] ** modbus_function_description:[7:49.99915%,11:49.99728%,0:0.00356%]
[INFO] ** modbus_transaction_id:65536 (11.1208%)
[INFO] ** orig:[0:99.99745%,2:0.00255%]
[INFO] ** proto:[0:99.99678%,1:0.00288%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.01972%,20:26.06743%,13:18.30989%,6:17.59872%,17:0.00288%,16:0.00068%,7:0.00034%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:26.06659%,-0.32151:20.78346%,-1.27613:18.30972%,-0.23351:17.59804%,-0.33484:17.23626%,-71.33197:0.00288%,-1.02014:0.00068%,-0.24151:0.00051%,1.46509:0.00034%,1.45709:0.00034%,1.47576:0.00017%,-1.27347:0.00017%,-0.24950999999999998:0.00017%,-61.95768:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:26.06625%,1:20.78329%,5:18.30972%,4:17.5977%,2:17.23592%,0:0.00713%]
[INFO] ** service:[0.0048200000000000005:99.99661%,-211.73542999999998:0.00288%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.01972%,9:26.06743%,7:18.30989%,1:17.59872%,21:0.00288%,15:0.00068%,14:0.00034%,16:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1618 (0.27456%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.8697e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.1798e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7611e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0499e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.3681e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1236e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.3575e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.2440e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/589310
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.8210 - tp: 75925.0000 - fp: 4075.0000 - tn: 315925.0000 - fn: 4075.0000 - accuracy: 0.9796 - precision: 0.9491 - recall: 0.9491 - auc: 0.9682 - val_loss: 7.5368 - val_tp: 10648.0000 - val_fp: 9352.0000 - val_tn: 70648.0000 - val_fn: 9352.0000 - val_accuracy: 0.8130 - val_precision: 0.5324 - val_recall: 0.5324 - val_auc: 0.7078
[INFO] saving weights to checkpoints/lstm-epoch-6-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/589310
[33m[INFO] loading file 16-16/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529000, 17)

[INFO] analyzing data
[INFO] 529000 rows
[INFO] ** appi_name:[21:99.99792%,30:0.0017%,33:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:79.14783%,Single Stage Multi Point:20.85217%]
[INFO] ** dst:[21:43.33724%,10:20.79565%,8:18.26749%,9:17.59641%,15:0.0017%,22:0.00113%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.9983%,0:0.0017%]
[INFO] ** i/f_name:[2:99.9983%,3:0.0017%]
[INFO] ** modbus_function_code:[0.02961:99.99792%,-33.760870000000004:0.00208%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99792%,0:0.00208%]
[INFO] ** modbus_transaction_id:65536 (12.38866%)
[INFO] ** orig:[0:99.9983%,2:0.0017%]
[INFO] ** proto:[0:99.99811%,1:0.0017%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.04121%,20:26.09187%,13:18.26786%,6:17.5966%,17:0.0017%,16:0.00038%,21:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.0913%,-0.32151:20.79546%,-1.27613:18.26749%,-0.23351:17.59622%,-0.33484:17.24575%,-71.33197:0.0017%,1.45709:0.00038%,-0.24151:0.00038%,-1.02014:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,-49.275529999999996:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.09093%,1:20.79527%,5:18.2673%,4:17.59584%,2:17.24556%,0:0.0051%]
[INFO] ** service:[0.0048200000000000005:99.99811%,-211.73542999999998:0.0017%,-211.08346:0.00019%]
[INFO] ** src:[22:38.04121%,9:26.09187%,7:18.26786%,1:17.5966%,21:0.00189%,15:0.00038%,4:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1449 (0.27391%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5394 - tp: 42579.0000 - fp: 37421.0000 - tn: 282579.0000 - fn: 37421.0000 - accuracy: 0.8129 - precision: 0.5322 - recall: 0.5322 - auc: 0.7076 - val_loss: 7.5884 - val_tp: 10584.0000 - val_fp: 9416.0000 - val_tn: 70584.0000 - val_fn: 9416.0000 - val_accuracy: 0.8117 - val_precision: 0.5292 - val_recall: 0.5292 - val_auc: 0.7058
[INFO] saving weights to checkpoints/lstm-epoch-6-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5485 - tp: 42534.0000 - fp: 37466.0000 - tn: 282534.0000 - fn: 37466.0000 - accuracy: 0.8127 - precision: 0.5317 - recall: 0.5317 - auc: 0.7073 - val_loss: 7.5586 - val_tp: 10621.0000 - val_fp: 9379.0000 - val_tn: 70621.0000 - val_fn: 9379.0000 - val_accuracy: 0.8124 - val_precision: 0.5311 - val_recall: 0.5311 - val_auc: 0.7069
[INFO] saving weights to checkpoints/lstm-epoch-6-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.3497 - tp: 63374.0000 - fp: 16626.0000 - tn: 303374.0000 - fn: 16626.0000 - accuracy: 0.9169 - precision: 0.7922 - recall: 0.7922 - auc: 0.8701 - val_loss: 5.0843e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.7554e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3904e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.0886e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8520e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-15-16-batch-400000-500000
[INFO] processing batch 500000-600000/529000
[33m[INFO] loading file 17-17/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529000, 17)

[INFO] analyzing data
[INFO] 529000 rows
[INFO] ** appi_name:[21:99.99716%,7:0.00057%,26:0.00038%,0:0.00038%,31:0.00019%,27:0.00019%,24:0.00019%,22:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:94.16824%,Multi Stage Multi Point:5.83176%]
[INFO] ** dst:[21:43.34556%,10:20.84934%,8:18.20359%,9:17.59849%,22:0.00076%,6:0.00057%,25:0.00038%,16:0.00038%,2:0.00038%,24:0.00019%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99716%,-33.760870000000004:0.00265%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99754%,0:0.00265%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.38866%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99868%,2:0.00132%]
[INFO] ** proxy_src_ip:[18:38.08299%,20:26.11267%,13:18.20302%,6:17.5983%,10:0.00113%,11:0.00095%,1:0.00038%,16:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.11172%,-0.32151:20.84934%,-1.27613:18.20265%,-0.23351:17.59811%,-0.33484:17.23365%,6.0369:0.00076%,-71.14798:0.00038%,1.47576:0.00038%,-64.19493:0.00038%,1.45709:0.00038%,1.46509:0.00019%,-68.79874000000001:0.00019%,-1.27347:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,6.15557:0.00019%,6.06224:0.00019%,8.55414:0.00019%,-3.3787199999999995:0.00019%,-4.3880099999999995:0.00019%,-71.14931:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:26.11153%,1:20.84915%,5:18.20246%,4:17.59773%,2:17.23365%,0:0.00548%]
[INFO] ** service:[0.0048200000000000005:99.99792%,-211.09762999999998:0.00057%,-211.08346:0.00038%,-186.44547:0.00038%,-211.35747999999998:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.08299%,9:26.11267%,7:18.20302%,1:17.5983%,11:0.00113%,10:0.00095%,3:0.00038%,21:0.00019%,15:0.00019%,2:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1446 (0.27335%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.0918e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2521e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4600e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7514e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.5474e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3994e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6909 - tp: 66644.0000 - fp: 13356.0000 - tn: 306644.0000 - fn: 13356.0000 - accuracy: 0.9332 - precision: 0.8331 - recall: 0.8331 - auc: 0.8957 - val_loss: 2.9005 - val_tp: 16401.0000 - val_fp: 3599.0000 - val_tn: 76401.0000 - val_fn: 3599.0000 - val_accuracy: 0.9280 - val_precision: 0.8201 - val_recall: 0.8201 - val_auc: 0.8875
[INFO] saving weights to checkpoints/lstm-epoch-6-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.7995 - tp: 66105.0000 - fp: 13895.0000 - tn: 306105.0000 - fn: 13895.0000 - accuracy: 0.9305 - precision: 0.8263 - recall: 0.8263 - auc: 0.8914 - val_loss: 1.9445e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/529000
[33m[INFO] loading file 18-18/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529000, 17)

[INFO] analyzing data
[INFO] 529000 rows
[INFO] ** appi_name:[21:99.99811%,30:0.00057%,7:0.00057%,31:0.00019%,27:0.00019%,22:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:81.66389%,Multi Stage Multi Point:18.33611%]
[INFO] ** dst:[21:43.33894%,10:20.83251%,8:18.26578%,9:17.55974%,22:0.00076%,15:0.00057%,24:0.00038%,16:0.00038%,2:0.00038%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99943%,0:0.00057%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99811%,-33.760870000000004:0.00189%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99811%,0:0.00189%]
[INFO] ** modbus_transaction_id:65536 (12.38866%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99887%,2:0.00057%,1:0.00057%]
[INFO] ** proxy_src_ip:[18:38.07524%,20:26.09679%,13:18.26616%,6:17.55992%,17:0.00057%,11:0.00057%,1:0.00038%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:26.09603%,-0.32151:20.83251%,-1.27613:18.2656%,-0.23351:17.55955%,-0.33484:17.24272%,-71.33197:0.00057%,-1.27347:0.00038%,1.45709:0.00038%,-0.24151:0.00038%,1.47576:0.00019%,1.46509:0.00019%,3.6236699999999997:0.00019%,-1.2708:0.00019%,-2.48275:0.00019%,6.06224:0.00019%,-3.3787199999999995:0.00019%,8.10082:0.00019%,6.45955:0.00019%,-71.14931:0.00019%]
[INFO] ** scada_tag:[3:26.09565%,1:20.83233%,5:18.26541%,4:17.55936%,2:17.24253%,0:0.00473%]
[INFO] ** service:[0.0048200000000000005:99.99811%,-211.09762999999998:0.00057%,-211.73542999999998:0.00057%,-211.35747999999998:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.07524%,9:26.09679%,7:18.26616%,1:17.55992%,14:0.00057%,10:0.00057%,3:0.00038%,21:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1446 (0.27335%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.4074 - tp: 68051.0000 - fp: 11949.0000 - tn: 308051.0000 - fn: 11949.0000 - accuracy: 0.9403 - precision: 0.8506 - recall: 0.8506 - auc: 0.9066 - val_loss: 6.1208 - val_tp: 12405.0000 - val_fp: 7595.0000 - val_tn: 72405.0000 - val_fn: 7595.0000 - val_accuracy: 0.8481 - val_precision: 0.6202 - val_recall: 0.6202 - val_auc: 0.7627
[INFO] saving weights to checkpoints/lstm-epoch-6-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.1134 - tp: 49657.0000 - fp: 30343.0000 - tn: 289657.0000 - fn: 30343.0000 - accuracy: 0.8483 - precision: 0.6207 - recall: 0.6207 - auc: 0.7629 - val_loss: 6.1636 - val_tp: 12352.0000 - val_fp: 7648.0000 - val_tn: 72352.0000 - val_fn: 7648.0000 - val_accuracy: 0.8470 - val_precision: 0.6176 - val_recall: 0.6176 - val_auc: 0.7610
[INFO] saving weights to checkpoints/lstm-epoch-6-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.1364 - tp: 49543.0000 - fp: 30457.0000 - tn: 289543.0000 - fn: 30457.0000 - accuracy: 0.8477 - precision: 0.6193 - recall: 0.6193 - auc: 0.7621 - val_loss: 6.1136 - val_tp: 12414.0000 - val_fp: 7586.0000 - val_tn: 72414.0000 - val_fn: 7586.0000 - val_accuracy: 0.8483 - val_precision: 0.6207 - val_recall: 0.6207 - val_auc: 0.7629
[INFO] saving weights to checkpoints/lstm-epoch-6-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2861 - tp: 78580.0000 - fp: 1420.0000 - tn: 318580.0000 - fn: 1420.0000 - accuracy: 0.9929 - precision: 0.9822 - recall: 0.9822 - auc: 0.9889 - val_loss: 1.2120e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1123e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0456e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/529000
[33m[INFO] loading file 19-19/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529000, 17)

[INFO] analyzing data
[INFO] 529000 rows
[INFO] ** appi_name:[21:99.99792%,26:0.00038%,0:0.00038%,31:0.00019%,27:0.00019%,24:0.00019%,22:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:86.47259%,Single Stage Multi Point:13.52741%]
[INFO] ** dst:[21:43.3811%,10:20.8259%,8:18.21739%,9:17.57278%,22:0.00132%,6:0.00057%,25:0.00038%,24:0.00019%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99792%,-33.760870000000004:0.00189%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99773%,0:0.00189%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.38866%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99868%,2:0.00132%]
[INFO] ** proxy_src_ip:[18:38.11304%,20:26.09414%,13:18.21739%,6:17.57278%,10:0.00113%,11:0.00095%,16:0.00057%]
[INFO] ** s_port:[1.45442:26.09301%,-0.32151:20.8259%,-1.27613:18.21701%,-0.23351:17.57259%,-0.33484:17.28715%,-5.20264:0.00076%,1.45709:0.00057%,-1.02014:0.00057%,-64.19493:0.00038%,-71.14798:0.00038%,1.46509:0.00038%,-1.27347:0.00019%,-0.24151:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-71.14931:0.00019%,-68.79874000000001:0.00019%,0.75578:0.00019%]
[INFO] ** scada_tag:[3:26.09263%,1:20.82571%,5:18.21682%,4:17.5724%,2:17.28696%,0:0.00548%]
[INFO] ** service:[0.0048200000000000005:99.99868%,-211.08346:0.00038%,-186.44547:0.00038%,-202.75898:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.11304%,9:26.09414%,7:18.21739%,1:17.57278%,11:0.00113%,10:0.00095%,15:0.00057%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1447 (0.27353%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.6132e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.6405e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.0579e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.3176e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.9172e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.3408e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.4561 - tp: 62846.0000 - fp: 17154.0000 - tn: 302846.0000 - fn: 17154.0000 - accuracy: 0.9142 - precision: 0.7856 - recall: 0.7856 - auc: 0.8660 - val_loss: 9.8095 - val_tp: 7828.0000 - val_fp: 12172.0000 - val_tn: 67828.0000 - val_fn: 12172.0000 - val_accuracy: 0.7566 - val_precision: 0.3914 - val_recall: 0.3914 - val_auc: 0.6196
[INFO] saving weights to checkpoints/lstm-epoch-6-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.5091 - tp: 37766.0000 - fp: 42234.0000 - tn: 277766.0000 - fn: 42234.0000 - accuracy: 0.7888 - precision: 0.4721 - recall: 0.4721 - auc: 0.6700 - val_loss: 5.0788e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/529000
[33m[INFO] loading file 20-20/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529000, 17)

[INFO] analyzing data
[INFO] 529000 rows
[INFO] ** appi_name:[21:99.99641%,30:0.00302%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:92.2535%,Single Stage Multi Point:7.7465%]
[INFO] ** dst:[21:43.42476%,10:20.83913%,8:18.16616%,9:17.56484%,15:0.00302%,22:0.00113%,24:0.00038%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99735%,0:0.00265%]
[INFO] ** i/f_name:[2:99.99698%,3:0.00302%]
[INFO] ** modbus_function_code:[0.02961:99.99641%,-33.760870000000004:0.00359%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99679%,0:0.00359%]
[INFO] ** modbus_transaction_id:65536 (12.38866%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99641%,1:0.00302%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.11739%,20:26.14707%,13:18.16635%,6:17.56541%,17:0.00302%,14:0.00057%,16:0.00019%]
[INFO] ** s_port:[1.45442:26.14631%,-0.32151:20.83913%,-1.27613:18.16578%,-0.23351:17.56465%,-0.33484:17.27826%,-71.33197:0.00302%,-0.24151:0.00057%,1.45709:0.00038%,-1.27347:0.00038%,13.431270000000001:0.00019%,-1.2708:0.00019%,-1.02014:0.00019%,-71.14798:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,11.862:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:26.14594%,1:20.83894%,5:18.16578%,4:17.56427%,2:17.27807%,0:0.00699%]
[INFO] ** service:[0.0048200000000000005:99.99641%,-211.73542999999998:0.00302%,-211.08346:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.11739%,9:26.14707%,7:18.16635%,1:17.56541%,14:0.00302%,2:0.00057%,15:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1446 (0.27335%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.3359e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9559 - val_tp: 17573.0000 - val_fp: 2427.0000 - val_tn: 77573.0000 - val_fn: 2427.0000 - val_accuracy: 0.9515 - val_precision: 0.8787 - val_recall: 0.8787 - val_auc: 0.9242
[INFO] saving weights to checkpoints/lstm-epoch-6-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9442 - tp: 65387.0000 - fp: 14613.0000 - tn: 305387.0000 - fn: 14613.0000 - accuracy: 0.9269 - precision: 0.8173 - recall: 0.8173 - auc: 0.8858 - val_loss: 2.9327 - val_tp: 16361.0000 - val_fp: 3639.0000 - val_tn: 76361.0000 - val_fn: 3639.0000 - val_accuracy: 0.9272 - val_precision: 0.8181 - val_recall: 0.8181 - val_auc: 0.8863
[INFO] saving weights to checkpoints/lstm-epoch-6-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9494 - tp: 65361.0000 - fp: 14639.0000 - tn: 305361.0000 - fn: 14639.0000 - accuracy: 0.9268 - precision: 0.8170 - recall: 0.8170 - auc: 0.8856 - val_loss: 2.9222 - val_tp: 16374.0000 - val_fp: 3626.0000 - val_tn: 76374.0000 - val_fn: 3626.0000 - val_accuracy: 0.9275 - val_precision: 0.8187 - val_recall: 0.8187 - val_auc: 0.8867
[INFO] saving weights to checkpoints/lstm-epoch-6-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.4100 - tp: 77965.0000 - fp: 2035.0000 - tn: 317965.0000 - fn: 2035.0000 - accuracy: 0.9898 - precision: 0.9746 - recall: 0.9746 - auc: 0.9841 - val_loss: 2.9406e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/529000
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.7262e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5452e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/529000
[33m[INFO] loading file 21-21/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (528998, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (528998, 17)

[INFO] analyzing data
[INFO] 528998 rows
[INFO] ** appi_name:[21:99.99622%,30:0.00076%,7:0.00057%,26:0.00038%,22:0.00038%,0:0.00038%,31:0.00019%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:98.84631%,Multi Stage Single Point:1.15369%]
[INFO] ** dst:[21:43.30489%,10:20.99403%,8:18.16963%,9:17.5271%,22:0.00095%,15:0.00076%,6:0.00076%,25:0.00038%,24:0.00038%,16:0.00038%,2:0.00038%,18:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99924%,0:0.00076%]
[INFO] ** i/f_name:[2:99.99924%,3:0.00076%]
[INFO] ** modbus_function_code:[0.02961:99.99622%,-33.760870000000004:0.00359%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99868%,11:49.99754%,0:0.00359%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.3887%)
[INFO] ** orig:[0:99.99924%,2:0.00076%]
[INFO] ** proto:[0:99.99773%,2:0.00151%,1:0.00076%]
[INFO] ** proxy_src_ip:[18:38.32529%,20:25.97344%,13:18.16982%,6:17.5271%,10:0.00113%,11:0.00095%,17:0.00076%,16:0.00057%,1:0.00038%,21:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.97288%,-0.32151:20.99327%,-1.27613:18.16944%,-0.23351:17.52691%,-0.33484:17.33201%,-71.33197:0.00076%,-6.64392:0.00076%,-1.02014:0.00057%,-1.27347:0.00038%,-64.19493:0.00038%,-71.14931:0.00038%,-71.14798:0.00038%,1.47576:0.00019%,1.46509:0.00019%,6.62488:0.00019%,10.15141:0.00019%,-68.79874000000001:0.00019%,7.060860000000001:0.00019%,-3.3787199999999995:0.00019%,-2.2440900000000004:0.00019%,1.45709:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.9725%,1:20.99309%,5:18.16926%,4:17.52672%,2:17.33201%,0:0.00643%]
[INFO] ** service:[0.0048200000000000005:99.99698%,-211.73542999999998:0.00076%,-211.09762999999998:0.00057%,-211.08346:0.00038%,-186.44547:0.00038%,-211.08818:0.00038%,-211.35747999999998:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.32529%,9:25.97344%,7:18.16982%,1:17.5271%,11:0.00113%,21:0.00095%,10:0.00095%,15:0.00057%,3:0.00038%,4:0.00019%,2:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1440 (0.27221%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/528998
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.2565e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2209e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/528998
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1371e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0386e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/528998
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9539e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8551e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/528998
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8307e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7965e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/528998
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7538e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7038e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/528998
[33m[INFO] loading file 22-22/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (298039, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (298039, 17)

[INFO] analyzing data
[INFO] 298039 rows
[INFO] ** appi_name:[21:99.99228%,30:0.00671%,23:0.00034%,22:0.00034%,18:0.00034%]
[INFO] ** classification:[normal:55.52528%,Multi Stage Single Point:44.47472%]
[INFO] ** dst:[21:43.3044%,10:21.00094%,8:18.11307%,9:17.57253%,15:0.00671%,22:0.00134%,19:0.00067%,26:0.00034%]
[INFO] ** i/f_dir:[1:99.99362%,0:0.00638%]
[INFO] ** i/f_name:[2:99.99329%,3:0.00638%,0:0.00034%]
[INFO] ** modbus_function_code:[0.02961:99.99228%,-33.760870000000004:0.00772%]
[INFO] ** modbus_function_description:[7:49.99715%,11:49.99513%,0:0.00772%]
[INFO] ** modbus_transaction_id:65534 (21.9884%)
[INFO] ** orig:[0:99.99497%,2:0.00436%,1:0.00067%]
[INFO] ** proto:[0:99.99295%,1:0.00671%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.32653%,20:25.97982%,13:18.11239%,6:17.57354%,17:0.00671%,14:0.00067%,10:0.00034%]
[INFO] ** s_port:[1.45442:25.97881%,-0.32151:21.00094%,-1.27613:18.11239%,-0.23351:17.57253%,-0.33484:17.32558%,-71.33197:0.00671%,1.45709:0.00067%,-0.24151:0.00067%,7.228860000000001:0.00067%,-0.24950999999999998:0.00034%,1.46509:0.00034%,-71.14931:0.00034%]
[INFO] ** scada_tag:[3:25.97848%,1:21.00094%,5:18.11239%,4:17.5722%,2:17.32558%,0:0.0104%]
[INFO] ** service:[0.0048200000000000005:99.99228%,-211.73542999999998:0.00671%,-211.07873999999998:0.00067%,-211.08818:0.00034%]
[INFO] ** src:[22:38.32653%,9:25.97982%,7:18.11239%,1:17.57354%,21:0.00436%,14:0.00235%,2:0.00067%,11:0.00034%]
[INFO] ** type:[0:99.99799%,1:0.00201%]
[INFO] ** unixtime:823 (0.27614%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/298039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.0513 - tp: 49965.0000 - fp: 30035.0000 - tn: 289965.0000 - fn: 30035.0000 - accuracy: 0.8498 - precision: 0.6246 - recall: 0.6246 - auc: 0.7654 - val_loss: 7.5473 - val_tp: 10635.0000 - val_fp: 9365.0000 - val_tn: 70635.0000 - val_fn: 9365.0000 - val_accuracy: 0.8127 - val_precision: 0.5318 - val_recall: 0.5318 - val_auc: 0.7073
[INFO] saving weights to checkpoints/lstm-epoch-6-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/298039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5860 - tp: 42348.0000 - fp: 37652.0000 - tn: 282348.0000 - fn: 37652.0000 - accuracy: 0.8117 - precision: 0.5293 - recall: 0.5293 - auc: 0.7058 - val_loss: 7.6061 - val_tp: 10562.0000 - val_fp: 9438.0000 - val_tn: 70562.0000 - val_fn: 9438.0000 - val_accuracy: 0.8112 - val_precision: 0.5281 - val_recall: 0.5281 - val_auc: 0.7051
[INFO] saving weights to checkpoints/lstm-epoch-6-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/298039
[33m[INFO] loading file 23-23/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598039, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598039, 17)

[INFO] analyzing data
[INFO] 598039 rows
[INFO] ** appi_name:[21:99.99816%,30:0.00117%,31:0.00033%,33:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:90.78706%,Multi Stage Single Point:9.21294%]
[INFO] ** dst:[21:43.32443%,10:21.00749%,8:18.1326%,9:17.53247%,15:0.00117%,22:0.001%,24:0.00033%,18:0.00033%,25:0.00017%]
[INFO] ** i/f_dir:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name:[2:99.99883%,3:0.00117%]
[INFO] ** modbus_function_code:[0.02961:99.99816%,-33.760870000000004:0.00184%]
[INFO] ** modbus_function_description:[7:50.00008%,11:49.99808%,0:0.00184%]
[INFO] ** modbus_transaction_id:65536 (10.95848%)
[INFO] ** orig:[0:99.99933%,2:0.00067%]
[INFO] ** proto:[0:99.99833%,1:0.00117%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.34967%,20:25.98275%,13:18.1326%,6:17.53264%,17:0.00117%,16:0.0005%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.98192%,-0.32151:21.00733%,-1.27613:18.1321%,-0.23351:17.5323%,-0.33484:17.34235%,-71.33197:0.00117%,-1.02014:0.0005%,-0.08551:0.00033%,-1.27347:0.00033%,1.45709:0.00033%,1.46509:0.00033%,-0.24151:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:25.98158%,1:21.00733%,5:18.13193%,4:17.53213%,2:17.34218%,0:0.00485%]
[INFO] ** service:[0.0048200000000000005:99.99833%,-211.73542999999998:0.00117%,-186.43601999999998:0.00033%,-186.44547:0.00017%]
[INFO] ** src:[22:38.34967%,9:25.98275%,7:18.1326%,1:17.53264%,21:0.00067%,15:0.0005%,14:0.0005%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99967%,1:0.00033%]
[INFO] ** unixtime:1629 (0.27239%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5803 - tp: 42376.0000 - fp: 37624.0000 - tn: 282376.0000 - fn: 37624.0000 - accuracy: 0.8119 - precision: 0.5297 - recall: 0.5297 - auc: 0.7061 - val_loss: 7.5400 - val_tp: 10644.0000 - val_fp: 9356.0000 - val_tn: 70644.0000 - val_fn: 9356.0000 - val_accuracy: 0.8129 - val_precision: 0.5322 - val_recall: 0.5322 - val_auc: 0.7076
[INFO] saving weights to checkpoints/lstm-epoch-6-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6354 - tp: 71883.0000 - fp: 8117.0000 - tn: 311883.0000 - fn: 8117.0000 - accuracy: 0.9594 - precision: 0.8985 - recall: 0.8985 - auc: 0.9366 - val_loss: 1.6230e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5794e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5443e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5161e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5073e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4919e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4814e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/598039
[33m[INFO] loading file 24-24/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598039, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598039, 17)

[INFO] analyzing data
[INFO] 598039 rows
[INFO] ** appi_name:[21:99.99381%,30:0.00301%,26:0.0005%,31:0.00033%,27:0.00033%,22:0.00033%,0:0.00033%,24:0.00017%,23:0.00017%,19:0.00017%,18:0.00017%,16:0.00017%,15:0.00017%,11:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:95.73941%,Multi Stage Single Point:4.26059%]
[INFO] ** dst:[21:43.3669%,10:21.00749%,8:18.10267%,9:17.51625%,15:0.00301%,22:0.00117%,6:0.00067%,25:0.00033%,24:0.00033%,19:0.00033%,18:0.00033%,7:0.00033%,26:0.00017%]
[INFO] ** i/f_dir:[1:99.99716%,0:0.00284%]
[INFO] ** i/f_name:[2:99.99699%,3:0.00301%]
[INFO] ** modbus_function_code:[0.02961:99.99381%,-33.760870000000004:0.00569%,-0.415:0.00017%,0.9188299999999999:0.00017%,0.47422:0.00017%]
[INFO] ** modbus_function_description:[7:49.99808%,11:49.99574%,0:0.00569%,15:0.00017%,10:0.00017%,2:0.00017%]
[INFO] ** modbus_transaction_id:65536 (10.95848%)
[INFO] ** orig:[0:99.99967%,1:0.00033%]
[INFO] ** proto:[0:99.99515%,1:0.00301%,2:0.00184%]
[INFO] ** proxy_src_ip:[18:38.38111%,20:25.99429%,13:18.1025%,6:17.51558%,17:0.00301%,10:0.00117%,14:0.00084%,11:0.00084%,21:0.00033%,16:0.00033%]
[INFO] ** s_port:[1.45442:25.99329%,-0.32151:21.00749%,-1.27613:18.10216%,-0.23351:17.51491%,-0.33484:17.37362%,-71.33197:0.00301%,-9.58113:0.00067%,-71.14798:0.0005%,1.45709:0.0005%,-0.24950999999999998:0.00033%,-1.27347:0.00033%,-0.24151:0.00033%,-1.02014:0.00033%,-31.55091:0.00033%,7.6315100000000005:0.00033%,-71.14931:0.00033%,-64.19493:0.00033%,1.47576:0.00033%,-68.79874000000001:0.00017%,1.46509:0.00017%,7.4901800000000005:0.00017%,13.431270000000001:0.00017%,11.862:0.00017%]
[INFO] ** scada_tag:[3:25.99295%,1:21.00749%,5:18.102%,4:17.51441%,2:17.37345%,0:0.0097%]
[INFO] ** service:[0.0048200000000000005:99.99482%,-211.73542999999998:0.00301%,-211.08346:0.0005%,-211.07873999999998:0.00033%,-202.75898:0.00033%,-186.44547:0.00033%,-186.43601999999998:0.00033%,-211.08818:0.00033%]
[INFO] ** src:[22:38.38111%,9:25.99429%,7:18.1025%,1:17.51558%,14:0.00301%,11:0.00117%,10:0.00084%,2:0.00084%,15:0.00033%,4:0.00033%]
[INFO] ** type:[0:99.99883%,1:0.00084%,2:0.00033%]
[INFO] ** unixtime:1625 (0.27172%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4467e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4205e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4182e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3963e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3918e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3807e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3724e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3539e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.3380e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3091e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/598039
[33m[INFO] loading file 25-25/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598039, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598039, 17)

[INFO] analyzing data
[INFO] 598039 rows
[INFO] ** appi_name:[21:99.99666%,30:0.001%,17:0.00067%,22:0.0005%,31:0.00033%,28:0.00017%,26:0.00017%,12:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** classification:[normal:65.92045%,Multi Stage Single Point:34.07955%]
[INFO] ** dst:[21:43.32945%,10:21.03224%,8:18.12524%,9:17.50906%,15:0.001%,22:0.00084%,16:0.00067%,6:0.00067%,18:0.00033%,17:0.00033%,24:0.00017%]
[INFO] ** i/f_dir:[1:99.999%,0:0.001%]
[INFO] ** i/f_name:[2:99.999%,3:0.001%]
[INFO] ** modbus_function_code:[0.02961:99.99666%,-33.760870000000004:0.00334%]
[INFO] ** modbus_function_description:[7:49.99908%,11:49.99758%,0:0.00334%]
[INFO] ** modbus_transaction_id:65536 (10.95848%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99799%,2:0.001%,1:0.001%]
[INFO] ** proxy_src_ip:[18:38.39816%,20:25.96352%,13:18.12524%,6:17.50939%,17:0.001%,1:0.00084%,21:0.00067%,16:0.00033%,14:0.00033%,7:0.00033%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.96302%,-0.32151:21.03191%,-1.27613:18.1249%,-0.23351:17.50889%,-0.33484:17.36626%,-71.33197:0.001%,-71.14931:0.0005%,-49.275529999999996:0.00033%,-0.24151:0.00033%,-1.02014:0.00033%,-58.032509999999995:0.00017%,-5.08665:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,2.52505:0.00017%,-71.14798:0.00017%,-58.035180000000004:0.00017%,-1.2708:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.96269%,1:21.03174%,5:18.12474%,4:17.50872%,2:17.36609%,0:0.00602%]
[INFO] ** service:[0.0048200000000000005:99.99699%,-211.73542999999998:0.001%,-205.44247:0.00067%,-211.08818:0.0005%,-186.43601999999998:0.00033%,-211.09762999999998:0.00017%,-211.08346:0.00017%,-185.9872:0.00017%]
[INFO] ** src:[22:38.39816%,9:25.96352%,7:18.12524%,1:17.50939%,14:0.001%,3:0.00084%,4:0.00067%,21:0.00033%,15:0.00033%,2:0.00033%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1625 (0.27172%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.8393 - tp: 60944.0000 - fp: 19056.0000 - tn: 300944.0000 - fn: 19056.0000 - accuracy: 0.9047 - precision: 0.7618 - recall: 0.7618 - auc: 0.8511 - val_loss: 5.7421 - val_tp: 12875.0000 - val_fp: 7125.0000 - val_tn: 72875.0000 - val_fn: 7125.0000 - val_accuracy: 0.8575 - val_precision: 0.6438 - val_recall: 0.6438 - val_auc: 0.7773
[INFO] saving weights to checkpoints/lstm-epoch-6-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7560 - tp: 51431.0000 - fp: 28569.0000 - tn: 291431.0000 - fn: 28569.0000 - accuracy: 0.8572 - precision: 0.6429 - recall: 0.6429 - auc: 0.7768 - val_loss: 5.7614 - val_tp: 12851.0000 - val_fp: 7149.0000 - val_tn: 72851.0000 - val_fn: 7149.0000 - val_accuracy: 0.8570 - val_precision: 0.6425 - val_recall: 0.6425 - val_auc: 0.7766
[INFO] saving weights to checkpoints/lstm-epoch-6-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7407 - tp: 51507.0000 - fp: 28493.0000 - tn: 291507.0000 - fn: 28493.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.7774 - val_loss: 5.7896 - val_tp: 12816.0000 - val_fp: 7184.0000 - val_tn: 72816.0000 - val_fn: 7184.0000 - val_accuracy: 0.8563 - val_precision: 0.6408 - val_recall: 0.6408 - val_auc: 0.7755
[INFO] saving weights to checkpoints/lstm-epoch-6-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7435 - tp: 51493.0000 - fp: 28507.0000 - tn: 291493.0000 - fn: 28507.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.7773 - val_loss: 5.7227 - val_tp: 12899.0000 - val_fp: 7101.0000 - val_tn: 72899.0000 - val_fn: 7101.0000 - val_accuracy: 0.8580 - val_precision: 0.6449 - val_recall: 0.6449 - val_auc: 0.7781
[INFO] saving weights to checkpoints/lstm-epoch-6-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7569 - tp: 51426.0000 - fp: 28574.0000 - tn: 291426.0000 - fn: 28574.0000 - accuracy: 0.8571 - precision: 0.6428 - recall: 0.6428 - auc: 0.7768 - val_loss: 5.7227 - val_tp: 12899.0000 - val_fp: 7101.0000 - val_tn: 72899.0000 - val_fn: 7101.0000 - val_accuracy: 0.8580 - val_precision: 0.6449 - val_recall: 0.6449 - val_auc: 0.7781
[INFO] saving weights to checkpoints/lstm-epoch-6-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/598039
[33m[INFO] loading file 26-26/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (598039, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (598039, 17)

[INFO] analyzing data
[INFO] 598039 rows
[INFO] ** appi_name:[21:99.99833%,30:0.0005%,7:0.0005%,31:0.00017%,22:0.00017%,12:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:64.39329%,Single Stage Single Point:26.70595%,Multi Stage Single Point:8.90076%]
[INFO] ** dst:[21:43.30654%,10:21.08441%,8:18.12691%,9:17.47946%,22:0.00084%,15:0.0005%,24:0.00033%,16:0.00033%,2:0.00033%,18:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.9995%,0:0.0005%]
[INFO] ** i/f_name:[2:99.9995%,3:0.0005%]
[INFO] ** modbus_function_code:[0.02961:99.99833%,-33.760870000000004:0.00167%]
[INFO] ** modbus_function_description:[7:49.99975%,11:49.99858%,0:0.00167%]
[INFO] ** modbus_transaction_id:65536 (10.95848%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99916%,1:0.0005%,2:0.00033%]
[INFO] ** proxy_src_ip:[18:38.46054%,20:25.93058%,13:18.12725%,6:17.47963%,17:0.0005%,1:0.0005%,21:0.00033%,16:0.00033%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.93008%,-0.32151:21.08424%,-1.27613:18.12674%,-0.23351:17.47929%,-0.33484:17.37629%,-71.33197:0.0005%,-1.02014:0.00033%,-1.27347:0.00033%,-0.24151:0.00033%,-49.275529999999996:0.00017%,1.47576:0.00017%,1.45709:0.00017%,1.46509:0.00017%,-1.2708:0.00017%,14.191239999999999:0.00017%,2.52505:0.00017%,-3.3787199999999995:0.00017%,11.57001:0.00017%,-71.14931:0.00017%,7.66617:0.00017%]
[INFO] ** scada_tag:[3:25.92975%,1:21.08424%,5:18.12658%,4:17.47913%,2:17.37629%,0:0.00401%]
[INFO] ** service:[0.0048200000000000005:99.9985%,-211.09762999999998:0.0005%,-211.73542999999998:0.0005%,-211.35747999999998:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.46054%,9:25.93058%,7:18.12725%,1:17.47963%,14:0.0005%,3:0.0005%,15:0.00033%,4:0.00033%,21:0.00017%,2:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1623 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7419 - tp: 51501.0000 - fp: 28499.0000 - tn: 291501.0000 - fn: 28499.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.7774 - val_loss: 5.7638 - val_tp: 12848.0000 - val_fp: 7152.0000 - val_tn: 72848.0000 - val_fn: 7152.0000 - val_accuracy: 0.8570 - val_precision: 0.6424 - val_recall: 0.6424 - val_auc: 0.7765
[INFO] saving weights to checkpoints/lstm-epoch-6-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.6636 - tp: 61422.0000 - fp: 18578.0000 - tn: 301422.0000 - fn: 18578.0000 - accuracy: 0.9071 - precision: 0.7678 - recall: 0.7678 - auc: 0.8559 - val_loss: 5.1610e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4813e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.4069e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.3421e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3650e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/598039
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.5527e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.3441e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/598039
[33m[INFO] loading file 27-27/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (538169, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (538169, 17)

[INFO] analyzing data
[INFO] 538169 rows
[INFO] ** appi_name:[21:99.99944%,30:0.00056%]
[INFO] ** classification:[normal:64.35283%,Single Stage Single Point:35.64717%]
[INFO] ** dst:[21:43.28399%,10:21.06717%,8:18.16994%,9:17.47741%,22:0.00074%,15:0.00056%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99944%,3:0.00056%]
[INFO] ** modbus_function_code:[0.02961:99.99944%,-33.760870000000004:0.00056%]
[INFO] ** modbus_function_description:[7:50.00028%,11:49.99916%,0:0.00056%]
[INFO] ** modbus_transaction_id:65536 (12.17759%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99944%,1:0.00056%]
[INFO] ** proxy_src_ip:[18:38.41953%,20:25.93219%,13:18.16976%,6:17.4776%,17:0.00056%,16:0.00037%]
[INFO] ** s_port:[1.45442:25.93163%,-0.32151:21.06717%,-1.27613:18.16957%,-0.23351:17.47722%,-0.33484:17.35236%,-71.33197:0.00056%,-1.02014:0.00037%,-1.27347:0.00019%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.93126%,1:21.06699%,5:18.16939%,4:17.47704%,2:17.35217%,0:0.00316%]
[INFO] ** service:[0.0048200000000000005:99.99944%,-211.73542999999998:0.00056%]
[INFO] ** src:[22:38.41953%,9:25.93219%,7:18.16976%,1:17.4776%,14:0.00056%,15:0.00037%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1461 (0.27148%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/538169
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7946e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5340e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/538169
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4007e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8035e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/538169
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1338e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2885e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/538169
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1535e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2661e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/538169
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0015e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.3426e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-26-27-batch-400000-500000
[INFO] processing batch 500000-600000/538169
[33m[INFO] loading file 28-28/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (372085, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (372085, 17)

[INFO] analyzing data
[INFO] 372085 rows
[INFO] ** appi_name:[21:99.99221%,30:0.00161%,17:0.00134%,22:0.00108%,7:0.00108%,31:0.00081%,26:0.00081%,28:0.00027%,27:0.00027%,8:0.00027%,0:0.00027%]
[INFO] ** classification:[normal:64.30654%,Single Stage Single Point:35.69346%]
[INFO] ** dst:[21:43.27775%,10:21.02073%,8:18.20821%,9:17.48498%,6:0.00215%,16:0.00188%,18:0.00134%,22:0.00054%,17:0.00054%,15:0.00054%,2:0.00054%,25:0.00027%,7:0.00027%,0:0.00027%]
[INFO] ** i/f_dir:[1:99.99946%,0:0.00054%]
[INFO] ** i/f_name:[2:99.99946%,3:0.00054%]
[INFO] ** modbus_function_code:[0.02961:99.99221%,-33.760870000000004:0.00779%]
[INFO] ** modbus_function_description:[11:49.9961%,7:49.9961%,0:0.00779%]
[INFO] ** modbus_transaction_id:65535 (17.61291%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99543%,2:0.00403%,1:0.00054%]
[INFO] ** proxy_src_ip:[18:38.3356%,20:25.96288%,13:18.20847%,6:17.48525%,1:0.00215%,17:0.00161%,14:0.00161%,7:0.00134%,21:0.00081%,0:0.00027%]
[INFO] ** s_port:[1.45442:25.96262%,-0.32151:21.02073%,-1.27613:18.20821%,-0.23351:17.48471%,-0.33484:17.31486%,-71.14798:0.00108%,-71.14931:0.00108%,-71.33197:0.00054%,-0.08551:0.00054%,-0.24151:0.00054%,7.66617:0.00027%,-58.035180000000004:0.00027%,-1.2708:0.00027%,-64.19493:0.00027%,-5.1466400000000005:0.00027%,13.431270000000001:0.00027%,11.57001:0.00027%,14.4699:0.00027%,1.47576:0.00027%,14.191239999999999:0.00027%,-5.08665:0.00027%,10.192739999999999:0.00027%,-3.3787199999999995:0.00027%,6.1115699999999995:0.00027%,2.05573:0.00027%,-43.76509:0.00027%,2.52505:0.00027%,11.862:0.00027%,-58.032509999999995:0.00027%]
[INFO] ** scada_tag:[3:25.96262%,1:21.02073%,5:18.20821%,4:17.48445%,2:17.31486%,0:0.00914%]
[INFO] ** service:[0.0048200000000000005:99.99221%,-205.44247:0.00134%,-186.43601999999998:0.00134%,-211.09762999999998:0.00108%,-211.08346:0.00108%,-211.08818:0.00108%,-211.73542999999998:0.00054%,-186.44547:0.00027%,-183.8612:0.00027%,-185.9872:0.00027%,-211.35747999999998:0.00027%,-202.75898:0.00027%]
[INFO] ** src:[22:38.3356%,9:25.96288%,7:18.20847%,1:17.48525%,3:0.00242%,2:0.00161%,21:0.00134%,4:0.00108%,14:0.00054%,8:0.00054%,17:0.00027%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1011 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/372085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5557e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0450e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/372085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.6553e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.1411e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/372085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5597e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.9238e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/372085
[33m[INFO] loading file 29-29/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (572085, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (572085, 17)

[INFO] analyzing data
[INFO] 572085 rows
[INFO] ** appi_name:[21:99.99878%,30:0.00052%,31:0.00017%,26:0.00017%,9:0.00017%,3:0.00017%]
[INFO] ** classification:[normal:64.38973%,Single Stage Single Point:35.61027%]
[INFO] ** dst:[21:43.32853%,10:21.05981%,8:18.14346%,9:17.46646%,22:0.00052%,15:0.00052%,24:0.00017%,18:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99965%,0:0.00035%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.99878%,-33.760870000000004:0.00122%]
[INFO] ** modbus_function_description:[7:49.99974%,11:49.99904%,0:0.00122%]
[INFO] ** modbus_transaction_id:65536 (11.45564%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99913%,1:0.00052%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.43502%,20:25.95349%,13:18.14381%,6:17.46629%,17:0.00052%,21:0.00017%,16:0.00017%,7:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95296%,-0.32151:21.05963%,-1.27613:18.14346%,-0.23351:17.46629%,-0.33484:17.37539%,-71.33197:0.00052%,1.45709:0.00035%,-71.14798:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,6.1115699999999995:0.00017%,14.4699:0.00017%]
[INFO] ** scada_tag:[3:25.95261%,1:21.05946%,5:18.14346%,4:17.46594%,2:17.37539%,0:0.00315%]
[INFO] ** service:[0.0048200000000000005:99.99895%,-211.73542999999998:0.00052%,-183.8612:0.00017%,-211.08346:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.43502%,9:25.95349%,7:18.14381%,1:17.46629%,14:0.00052%,21:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1554 (0.27164%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.7474e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.9808e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.7304e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.1018e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.6986e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.3232e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.8111e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.4975e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.4534e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.4351e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/572085
[33m[INFO] loading file 30-30/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (572085, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (572085, 17)

[INFO] analyzing data
[INFO] 572085 rows
[INFO] ** appi_name:[21:99.99755%,30:0.00175%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.36963%,Single Stage Single Point:35.63037%]
[INFO] ** dst:[21:43.33709%,10:21.02957%,8:18.14765%,9:17.48237%,15:0.00175%,22:0.0007%,24:0.00035%,25:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99843%,0:0.00157%]
[INFO] ** i/f_name:[2:99.99825%,3:0.00175%]
[INFO] ** modbus_function_code:[0.02961:99.99755%,-33.760870000000004:0.00245%]
[INFO] ** modbus_function_description:[7:49.99956%,11:49.99799%,0:0.00245%]
[INFO] ** modbus_transaction_id:65536 (11.45564%)
[INFO] ** orig:[0:99.99913%,2:0.00052%,1:0.00035%]
[INFO] ** proto:[0:99.9979%,1:0.00175%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.37192%,20:25.99456%,13:18.148%,6:17.48289%,17:0.00175%,7:0.00035%,16:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.99439%,-0.32151:21.02939%,-1.27613:18.14748%,-0.23351:17.48219%,-0.33484:17.34253%,-71.33197:0.00175%,-0.24151:0.00052%,-1.27347:0.00035%,-71.14798:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:25.99404%,1:21.02939%,5:18.1473%,4:17.48202%,2:17.34235%,0:0.00489%]
[INFO] ** service:[0.0048200000000000005:99.99773%,-211.73542999999998:0.00175%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.37192%,9:25.99456%,7:18.148%,1:17.48289%,14:0.00122%,21:0.00087%,16:0.00017%,15:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99913%,1:0.00087%]
[INFO] ** unixtime:1555 (0.27181%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.3565e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.6609e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.7903e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.2736e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.0556e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.6470e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7369e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.7001e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3986e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9141e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/572085
[33m[INFO] loading file 31-31/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (572085, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (572085, 17)

[INFO] analyzing data
[INFO] 572085 rows
[INFO] ** appi_name:[21:99.99965%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.37575%,Single Stage Single Point:35.62425%]
[INFO] ** dst:[21:43.32468%,10:21.04949%,8:18.12003%,9:17.50404%,22:0.00105%,24:0.00035%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99965%,-33.760870000000004:0.00035%]
[INFO] ** modbus_function_description:[7:49.99991%,11:49.99974%,0:0.00035%]
[INFO] ** modbus_transaction_id:65536 (11.45564%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.39342%,20:25.98145%,13:18.12021%,6:17.50404%,16:0.00052%,7:0.00035%]
[INFO] ** s_port:[1.45442:25.98075%,-0.32151:21.04949%,-1.27613:18.11986%,-0.23351:17.50387%,-0.33484:17.34393%,-1.02014:0.00052%,-1.27347:0.00035%,1.45709:0.00035%,-71.14798:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-0.24151:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.98041%,1:21.04932%,5:18.11969%,4:17.50352%,2:17.34375%,0:0.00332%]
[INFO] ** service:[0.0048200000000000005:99.99965%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.39342%,9:25.98145%,7:18.12021%,1:17.50404%,15:0.00052%,21:0.00035%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1554 (0.27164%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.8650e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.2943e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.0034e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.9183e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2222e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.5028e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.7492e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2412e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.6542e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7513e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/572085
[33m[INFO] loading file 32-32/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (572085, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (572085, 17)

[INFO] analyzing data
[INFO] 572085 rows
[INFO] ** appi_name:[21:99.9965%,30:0.00297%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.38309%,Single Stage Single Point:35.61691%]
[INFO] ** dst:[21:43.32188%,10:21.05666%,8:18.15307%,9:17.46384%,15:0.00297%,22:0.00087%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99738%,0:0.00262%]
[INFO] ** i/f_name:[2:99.99703%,3:0.00297%]
[INFO] ** modbus_function_code:[0.02961:99.9965%,-33.760870000000004:0.0035%]
[INFO] ** modbus_function_description:[7:49.99904%,11:49.99747%,0:0.0035%]
[INFO] ** modbus_transaction_id:65536 (11.45564%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9965%,1:0.00297%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.42471%,20:25.95419%,13:18.15307%,6:17.46436%,17:0.00297%,14:0.00052%,16:0.00017%]
[INFO] ** s_port:[1.45442:25.95366%,-0.32151:21.05666%,-1.27613:18.15272%,-0.23351:17.46366%,-0.33484:17.36805%,-71.33197:0.00297%,-0.24151:0.00052%,-1.2708:0.00017%,-1.02014:0.00017%,13.431270000000001:0.00017%,-71.14798:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.95331%,1:21.05649%,5:18.15272%,4:17.46331%,2:17.36805%,0:0.00612%]
[INFO] ** service:[0.0048200000000000005:99.9965%,-211.73542999999998:0.00297%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.42471%,9:25.95419%,7:18.15307%,1:17.46436%,14:0.00297%,2:0.00052%,15:0.00017%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1552 (0.27129%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4159e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.2398e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0963e-04 - tp: 79997.0000 - fp: 3.0000 - tn: 319997.0000 - fn: 3.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1121e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.8039e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4362e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7893e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4868e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6053e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4005e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/572085
[33m[INFO] loading file 33-33/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (572085, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (572085, 17)

[INFO] analyzing data
[INFO] 572085 rows
[INFO] ** appi_name:[21:99.99703%,30:0.00105%,17:0.0007%,22:0.00052%,31:0.00017%,28:0.00017%,26:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:64.39183%,Single Stage Single Point:35.60817%]
[INFO] ** dst:[21:43.32363%,10:21.06348%,8:18.1251%,9:17.48307%,22:0.0014%,15:0.00105%,16:0.0007%,6:0.0007%,24:0.00035%,17:0.00035%,18:0.00017%]
[INFO] ** i/f_dir:[1:99.99895%,0:0.00105%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.99703%,-33.760870000000004:0.00297%]
[INFO] ** modbus_function_description:[7:49.99956%,11:49.99747%,0:0.00297%]
[INFO] ** modbus_transaction_id:65536 (11.45564%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99808%,1:0.00105%,2:0.00087%]
[INFO] ** proxy_src_ip:[18:38.42104%,20:25.96695%,13:18.1251%,6:17.48324%,17:0.00105%,16:0.0007%,1:0.0007%,21:0.00035%,14:0.00035%,7:0.00035%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.96607%,-0.32151:21.06348%,-1.27613:18.12475%,-0.23351:17.48289%,-0.33484:17.35756%,-71.33197:0.00105%,-1.02014:0.0007%,1.45709:0.00052%,-71.14931:0.00052%,-1.27347:0.00035%,-5.08665:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,-71.14798:0.00017%,-58.032509999999995:0.00017%,-58.035180000000004:0.00017%,-0.24151:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.96572%,1:21.06348%,5:18.12458%,4:17.48272%,2:17.35756%,0:0.00594%]
[INFO] ** service:[0.0048200000000000005:99.99703%,-211.73542999999998:0.00105%,-205.44247:0.0007%,-211.08818:0.00052%,-211.09762999999998:0.00017%,-211.08346:0.00017%,-185.9872:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.42104%,9:25.96695%,7:18.1251%,1:17.48324%,14:0.00105%,15:0.0007%,3:0.0007%,21:0.00035%,4:0.00035%,2:0.00035%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1556 (0.27199%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.6873e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0149e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9108e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7636e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4941e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5374e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4357e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3377e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/572085
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1804e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4116e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/572085
[33m[INFO] loading file 34-34/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (413518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (413518, 17)

[INFO] analyzing data
[INFO] 413518 rows
[INFO] ** appi_name:[21:99.99758%,30:0.00073%,7:0.00073%,31:0.00024%,22:0.00024%,8:0.00024%,6:0.00024%]
[INFO] ** classification:[normal:64.34061%,Single Stage Single Point:35.65939%]
[INFO] ** dst:[21:43.28228%,10:21.05519%,8:18.18929%,9:17.47034%,22:0.00073%,15:0.00073%,16:0.00048%,2:0.00048%,18:0.00024%,6:0.00024%]
[INFO] ** i/f_dir:[1:99.99927%,0:0.00073%]
[INFO] ** i/f_name:[2:99.99927%,3:0.00073%]
[INFO] ** modbus_function_code:[0.02961:99.99758%,-33.760870000000004:0.00242%]
[INFO] ** modbus_function_description:[7:49.99927%,11:49.99831%,0:0.00242%]
[INFO] ** modbus_transaction_id:65536 (15.8484%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99879%,1:0.00073%,2:0.00048%]
[INFO] ** proxy_src_ip:[18:38.38866%,20:25.94905%,13:18.18905%,6:17.47082%,17:0.00073%,1:0.00073%,21:0.00048%,14:0.00024%,7:0.00024%]
[INFO] ** s_port:[1.45442:25.94857%,-0.32151:21.05495%,-1.27613:18.18905%,-0.23351:17.4701%,-0.33484:17.33371%,-0.24151:0.00073%,-71.33197:0.00073%,-3.0613900000000003:0.00024%,-3.3787199999999995:0.00024%,14.191239999999999:0.00024%,1.46509:0.00024%,1.47576:0.00024%,11.57001:0.00024%,-49.275529999999996:0.00024%,-71.14931:0.00024%,7.66617:0.00024%]
[INFO] ** scada_tag:[3:25.94833%,1:21.05471%,5:18.18881%,4:17.46961%,2:17.33371%,0:0.00484%]
[INFO] ** service:[0.0048200000000000005:99.99782%,-211.09762999999998:0.00073%,-211.73542999999998:0.00073%,-186.43601999999998:0.00024%,-211.35747999999998:0.00024%,-211.08818:0.00024%]
[INFO] ** src:[22:38.38866%,9:25.94905%,7:18.18905%,1:17.47082%,14:0.00073%,3:0.00073%,4:0.00048%,21:0.00024%,2:0.00024%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1123 (0.27157%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/413518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.2506e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5048e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/413518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 6.8666e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6739e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/413518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.1260e-04 - tp: 79997.0000 - fp: 3.0000 - tn: 319997.0000 - fn: 3.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3743e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/413518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.7280e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9450e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-33-34-batch-300000-400000
[INFO] processing batch 400000-500000/413518
[33m[INFO] loading file 35-35/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513518, 17)

[INFO] analyzing data
[INFO] 513518 rows
[INFO] ** appi_name:[21:99.99883%,30:0.00117%]
[INFO] ** classification:[normal:64.38002%,Single Stage Single Point:35.61998%]
[INFO] ** dst:[21:43.33422%,10:21.04308%,8:18.14523%,9:17.47514%,22:0.00117%,15:0.00117%]
[INFO] ** i/f_dir:[1:99.99903%,0:0.00097%]
[INFO] ** i/f_name:[2:99.99883%,3:0.00117%]
[INFO] ** modbus_function_code:[0.02961:99.99883%,-33.760870000000004:0.00117%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99864%,0:0.00117%]
[INFO] ** modbus_transaction_id:65536 (12.76216%)
[INFO] ** orig:[0:99.99961%,1:0.00039%]
[INFO] ** proto:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip:[18:38.40897%,20:25.9689%,13:18.14484%,6:17.47534%,17:0.00117%,16:0.00078%]
[INFO] ** s_port:[1.45442:25.96832%,-0.32151:21.04308%,-1.27613:18.14484%,-0.23351:17.47495%,-0.33484:17.3659%,-71.33197:0.00117%,-1.02014:0.00078%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.96793%,1:21.04308%,5:18.14464%,4:17.47456%,2:17.3659%,0:0.00389%]
[INFO] ** service:[0.0048200000000000005:99.99883%,-211.73542999999998:0.00117%]
[INFO] ** src:[22:38.40897%,9:25.9689%,7:18.14484%,1:17.47534%,14:0.00117%,15:0.00078%]
[INFO] ** type:[0:99.99903%,1:0.00097%]
[INFO] ** unixtime:1394 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0011 - tp: 79992.0000 - fp: 8.0000 - tn: 319992.0000 - fn: 8.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 0.9999 - val_loss: 5.4975e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6765e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9429e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.8400e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5739e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.3311e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3937e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3277e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3050e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/513518
[33m[INFO] loading file 36-36/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513518, 17)

[INFO] analyzing data
[INFO] 513518 rows
[INFO] ** appi_name:[21:99.99864%,30:0.00058%,31:0.00039%,33:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.36094%,Single Stage Single Point:35.63906%]
[INFO] ** dst:[21:43.33597%,10:21.02283%,8:18.15672%,9:17.48215%,22:0.00078%,15:0.00058%,24:0.00039%,18:0.00039%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99942%,0:0.00058%]
[INFO] ** i/f_name:[2:99.99942%,3:0.00058%]
[INFO] ** modbus_function_code:[0.02961:99.99864%,-33.760870000000004:0.00136%]
[INFO] ** modbus_function_description:[7:50.00039%,11:49.99825%,0:0.00136%]
[INFO] ** modbus_transaction_id:65536 (12.76216%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99883%,2:0.00058%,1:0.00058%]
[INFO] ** proxy_src_ip:[18:38.37509%,20:25.9839%,13:18.15691%,6:17.48274%,17:0.00058%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.98332%,-0.32151:21.02263%,-1.27613:18.15633%,-0.23351:17.48196%,-0.33484:17.35246%,-0.24151:0.00058%,-71.33197:0.00058%,-1.27347:0.00039%,-0.08551:0.00039%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-49.275529999999996:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.98293%,1:21.02244%,5:18.15613%,4:17.48176%,2:17.35226%,0:0.00448%]
[INFO] ** service:[0.0048200000000000005:99.99883%,-211.73542999999998:0.00058%,-186.43601999999998:0.00039%,-186.44547:0.00019%]
[INFO] ** src:[22:38.37509%,9:25.9839%,7:18.15691%,1:17.48274%,14:0.00058%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1395 (0.27166%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.2022e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6544e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.7176e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8855e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0026e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6030e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.5430e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1131e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7942e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8843e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/513518
[33m[INFO] loading file 37-37/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513518, 17)

[INFO] analyzing data
[INFO] 513518 rows
[INFO] ** appi_name:[21:99.99883%,30:0.00078%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.3884%,Single Stage Single Point:35.6116%]
[INFO] ** dst:[21:43.33811%,10:21.04834%,8:18.13198%,9:17.47943%,22:0.00078%,15:0.00078%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99922%,3:0.00078%]
[INFO] ** modbus_function_code:[0.02961:99.99883%,-33.760870000000004:0.00117%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99864%,0:0.00117%]
[INFO] ** modbus_transaction_id:65536 (12.76216%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99903%,1:0.00078%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.39515%,20:25.99169%,13:18.13218%,6:17.47943%,17:0.00078%,16:0.00039%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.9911%,-0.32151:21.04834%,-1.27613:18.13179%,-0.23351:17.47923%,-0.33484:17.34681%,-71.33197:0.00078%,-1.02014:0.00039%,-71.14798:0.00019%,-1.27347:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.99091%,1:21.04834%,5:18.13159%,4:17.47904%,2:17.34662%,0:0.00351%]
[INFO] ** service:[0.0048200000000000005:99.99883%,-211.73542999999998:0.00078%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.39515%,9:25.99169%,7:18.13218%,1:17.47943%,14:0.00078%,15:0.00039%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1395 (0.27166%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.5183e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5125e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.8910e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4003e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1286e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4624e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.2584e-05 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4638e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.1339e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2434e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/513518
[33m[INFO] loading file 38-38/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513518, 17)

[INFO] analyzing data
[INFO] 513518 rows
[INFO] ** appi_name:[21:99.99903%,30:0.00019%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.40806%,Single Stage Single Point:35.59194%]
[INFO] ** dst:[21:43.31922%,10:21.0867%,8:18.09888%,9:17.49325%,22:0.00097%,25:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99903%,-33.760870000000004:0.00097%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99922%,0:0.00097%]
[INFO] ** modbus_transaction_id:65536 (12.76216%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99942%,2:0.00039%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.45513%,20:25.95138%,13:18.09868%,6:17.49364%,7:0.00039%,17:0.00019%,16:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.9506%,-0.32151:21.08651%,-1.27613:18.09849%,-0.23351:17.49306%,-0.33484:17.36862%,1.45709:0.00039%,-0.24151:0.00039%,-71.14798:0.00019%,-64.19493:0.00019%,-1.02014:0.00019%,-61.95768:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,10.192739999999999:0.00019%,-0.24950999999999998:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.95021%,1:21.08651%,5:18.09849%,4:17.49286%,2:17.36862%,0:0.00331%]
[INFO] ** service:[0.0048200000000000005:99.99922%,-186.44547:0.00019%,-211.08346:0.00019%,-211.73542999999998:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.45513%,9:25.95138%,7:18.09868%,1:17.49364%,21:0.00039%,16:0.00019%,15:0.00019%,14:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1396 (0.27185%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 6.3093e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9172e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.4823e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0396e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.5550e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5607e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.7743e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9897e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.7018e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1510e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/513518
[33m[INFO] loading file 39-39/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513518, 17)

[INFO] analyzing data
[INFO] 513518 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.41546%,Single Stage Single Point:35.58454%]
[INFO] ** dst:[21:43.32467%,10:21.09001%,8:18.13004%,9:17.45411%,22:0.00097%,24:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.00078%,11:49.99922%]
[INFO] ** modbus_transaction_id:65536 (12.76216%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.46311%,20:25.95177%,13:18.13043%,6:17.45411%,16:0.00058%]
[INFO] ** s_port:[1.45442:25.95138%,-0.32151:21.09001%,-1.27613:18.13004%,-0.23351:17.45392%,-0.33484:17.3731%,-1.02014:0.00058%,-1.27347:0.00019%,1.45709:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.95099%,1:21.08982%,5:18.12984%,4:17.45392%,2:17.37291%,0:0.00253%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.46311%,9:25.95177%,7:18.13043%,1:17.45411%,15:0.00058%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1394 (0.27146%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7159e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.6785e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.1483e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7893e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5418e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3340e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.5218e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.0721e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.7876e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.5882e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/513518
[33m[INFO] loading file 40-40/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513518, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513518, 17)

[INFO] analyzing data
[INFO] 513518 rows
[INFO] ** appi_name:[21:99.99611%,30:0.00331%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.34516%,Single Stage Single Point:35.65484%]
[INFO] ** dst:[21:43.30559%,10:21.03451%,8:18.18281%,9:17.47222%,15:0.00331%,22:0.00078%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99688%,0:0.00312%]
[INFO] ** i/f_name:[2:99.99669%,3:0.00331%]
[INFO] ** modbus_function_code:[0.02961:99.99611%,-33.760870000000004:0.00389%]
[INFO] ** modbus_function_description:[7:49.99903%,11:49.99708%,0:0.00389%]
[INFO] ** modbus_transaction_id:65536 (12.76216%)
[INFO] ** orig:[0:99.99961%,1:0.00039%]
[INFO] ** proto:[0:99.99611%,1:0.00331%,2:0.00058%]
[INFO] ** proxy_src_ip:[18:38.35445%,20:25.98643%,13:18.18261%,6:17.47261%,17:0.00331%,14:0.00058%]
[INFO] ** s_port:[1.45442:25.98565%,-0.32151:21.03451%,-1.27613:18.18242%,-0.23351:17.47203%,-0.33484:17.31994%,-71.33197:0.00331%,1.45709:0.00039%,-0.24151:0.00039%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,13.431270000000001:0.00019%]
[INFO] ** scada_tag:[3:25.98526%,1:21.03432%,5:18.18223%,4:17.47164%,2:17.31974%,0:0.00682%]
[INFO] ** service:[0.0048200000000000005:99.99611%,-211.73542999999998:0.00331%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.35445%,9:25.98643%,7:18.18261%,1:17.47261%,14:0.00331%,2:0.00058%]
[INFO] ** type:[0:99.99903%,1:0.00097%]
[INFO] ** unixtime:1397 (0.27204%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9426e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0343e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1121e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.3184e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.9082e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7406e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.5626e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7761e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/513518
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5323e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3606e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/513518
[33m[INFO] loading file 41-41/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (453676, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (453676, 17)

[INFO] analyzing data
[INFO] 453676 rows
[INFO] ** appi_name:[21:99.99625%,30:0.0011%,22:0.00088%,17:0.00088%,32:0.00022%,28:0.00022%,26:0.00022%,7:0.00022%]
[INFO] ** classification:[normal:64.40081%,Single Stage Single Point:35.59919%]
[INFO] ** dst:[21:43.32894%,10:21.06724%,8:18.13387%,9:17.46511%,16:0.0011%,15:0.0011%,6:0.0011%,22:0.00066%,24:0.00044%,17:0.00044%]
[INFO] ** i/f_dir:[1:99.9989%,0:0.0011%]
[INFO] ** i/f_name:[2:99.9989%,3:0.0011%]
[INFO] ** modbus_function_code:[0.02961:99.99625%,-33.760870000000004:0.00375%]
[INFO] ** modbus_function_description:[7:49.9989%,11:49.99735%,0:0.00375%]
[INFO] ** modbus_transaction_id:65536 (14.44555%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99758%,2:0.00132%,1:0.0011%]
[INFO] ** proxy_src_ip:[18:38.4466%,20:25.9498%,13:18.13409%,6:17.46533%,17:0.0011%,1:0.00088%,21:0.00044%,16:0.00044%,14:0.00044%,0:0.00044%,7:0.00022%,2:0.00022%]
[INFO] ** s_port:[1.45442:25.94936%,-0.32151:21.06724%,-1.27613:18.13343%,-0.23351:17.46489%,-0.33484:17.37936%,-71.33197:0.0011%,-71.14931:0.00088%,-1.02014:0.00044%,-1.27347:0.00044%,-71.14798:0.00022%,-0.24151:0.00022%,-58.035180000000004:0.00022%,-1.2708:0.00022%,-5.1466400000000005:0.00022%,1.47576:0.00022%,1.46509:0.00022%,-64.19226:0.00022%,-5.08665:0.00022%,-0.24950999999999998:0.00022%,2.05573:0.00022%,-43.76509:0.00022%,-58.032509999999995:0.00022%]
[INFO] ** scada_tag:[3:25.94914%,1:21.06724%,5:18.13343%,4:17.46467%,2:17.37936%,0:0.00617%]
[INFO] ** service:[0.0048200000000000005:99.99625%,-211.73542999999998:0.0011%,-205.44247:0.00088%,-211.08818:0.00088%,89.64175:0.00022%,-211.09762999999998:0.00022%,-211.08346:0.00022%,-185.9872:0.00022%]
[INFO] ** src:[22:38.4466%,9:25.9498%,7:18.13409%,1:17.46533%,14:0.0011%,3:0.00088%,15:0.00044%,8:0.00044%,4:0.00044%,2:0.00044%,21:0.00022%,17:0.00022%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1231 (0.27134%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/453676
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.7186e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8741e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/453676
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1374e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2600e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/453676
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.7515e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.4094e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/453676
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.4865e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3871e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/453676
[33m[INFO] loading file 42-42/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (397190, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (397190, 17)

[INFO] analyzing data
[INFO] 397190 rows
[INFO] ** appi_name:[21:99.99144%,30:0.00227%,17:0.00126%,31:0.00101%,26:0.00101%,7:0.00101%,22:0.00076%,28:0.00025%,27:0.00025%,9:0.00025%,8:0.00025%,0:0.00025%]
[INFO] ** classification:[normal:64.37801%,Single Stage Single Point:35.62199%]
[INFO] ** dst:[21:43.31378%,10:21.05516%,8:18.17518%,9:17.44631%,16:0.00227%,6:0.00201%,18:0.00126%,2:0.00101%,22:0.00076%,15:0.00076%,17:0.0005%,25:0.00025%,24:0.00025%,7:0.00025%,0:0.00025%]
[INFO] ** i/f_dir:[1:99.99924%,0:0.00076%]
[INFO] ** i/f_name:[2:99.99924%,3:0.00076%]
[INFO] ** modbus_function_code:[0.02961:99.99144%,-33.760870000000004:0.00856%]
[INFO] ** modbus_function_description:[7:49.99648%,11:49.99496%,0:0.00856%]
[INFO] ** modbus_transaction_id:65536 (16.49991%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99547%,2:0.00378%,1:0.00076%]
[INFO] ** proxy_src_ip:[18:38.41763%,20:25.95156%,13:18.17568%,6:17.44631%,17:0.00227%,1:0.00227%,14:0.00151%,21:0.00101%,7:0.00076%,0:0.0005%,16:0.00025%,2:0.00025%]
[INFO] ** s_port:[1.45442:25.95106%,-0.32151:21.05516%,-1.27613:18.17518%,-0.23351:17.44606%,-0.33484:17.36247%,-71.14931:0.00101%,-71.14798:0.00101%,-71.33197:0.00076%,11.57001:0.0005%,-0.08551:0.0005%,-3.3787199999999995:0.0005%,-0.24151:0.00025%,13.431270000000001:0.00025%,-5.1466400000000005:0.00025%,0.31847:0.00025%,-1.02014:0.00025%,-1.2708:0.00025%,-58.035180000000004:0.00025%,7.66617:0.00025%,-64.19493:0.00025%,1.47576:0.00025%,14.4699:0.00025%,15.912510000000001:0.00025%,14.191239999999999:0.00025%,7.9608300000000005:0.00025%,-5.08665:0.00025%,10.192739999999999:0.00025%,-3.0613900000000003:0.00025%,1.45709:0.00025%,2.05573:0.00025%,-43.76509:0.00025%,11.862:0.00025%,-1.27347:0.00025%,-58.032509999999995:0.00025%]
[INFO] ** scada_tag:[3:25.95055%,1:21.05516%,5:18.17493%,4:17.44606%,2:17.36222%,0:0.01108%]
[INFO] ** service:[0.0048200000000000005:99.99144%,-211.09762999999998:0.00176%,-205.44247:0.00126%,-186.43601999999998:0.00126%,-211.08346:0.00101%,-211.08818:0.00101%,-211.73542999999998:0.00076%,-211.35747999999998:0.0005%,-186.44547:0.00025%,-183.8612:0.00025%,-185.9872:0.00025%,-202.75898:0.00025%]
[INFO] ** src:[22:38.41763%,9:25.95156%,7:18.17568%,1:17.44631%,3:0.00302%,2:0.00176%,4:0.00126%,21:0.00101%,14:0.00076%,8:0.0005%,17:0.00025%,15:0.00025%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1078 (0.27141%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/397190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6102e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4166e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/397190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2992e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1679e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/397190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0765e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.9716e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/397190
[33m[INFO] loading file 43-43/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597190, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597190, 17)

[INFO] analyzing data
[INFO] 597190 rows
[INFO] ** appi_name:[21:99.99833%,30:0.0005%,7:0.0005%,26:0.00033%,22:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:64.38705%,Single Stage Single Point:35.61295%]
[INFO] ** dst:[21:43.31503%,10:21.06934%,8:18.14431%,9:17.46848%,22:0.001%,15:0.0005%,6:0.0005%,16:0.00033%,2:0.00033%,24:0.00017%]
[INFO] ** i/f_dir:[1:99.99983%,0:0.00017%]
[INFO] ** i/f_name:[2:99.9995%,3:0.0005%]
[INFO] ** modbus_function_code:[0.02961:99.99833%,-33.760870000000004:0.00167%]
[INFO] ** modbus_function_description:[7:49.99983%,11:49.99849%,0:0.00167%]
[INFO] ** modbus_transaction_id:65536 (10.97406%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.999%,2:0.0005%,1:0.0005%]
[INFO] ** proxy_src_ip:[18:38.41625%,20:25.96862%,13:18.14448%,6:17.46864%,17:0.0005%,1:0.0005%,16:0.00033%,7:0.00033%,21:0.00017%,14:0.00017%]
[INFO] ** s_port:[1.45442:25.96795%,-0.32151:21.06934%,-1.27613:18.14414%,-0.23351:17.46814%,-0.33484:17.34691%,-71.33197:0.0005%,1.47576:0.00033%,1.45709:0.00033%,-71.14798:0.00033%,-0.24151:0.00033%,-1.02014:0.00033%,-0.24950999999999998:0.00017%,-1.2708:0.00017%,-1.27347:0.00017%,-3.3787199999999995:0.00017%,7.9608300000000005:0.00017%,11.57001:0.00017%,-71.14931:0.00017%,0.31847:0.00017%]
[INFO] ** scada_tag:[3:25.96761%,1:21.06934%,5:18.14397%,4:17.46781%,2:17.34674%,0:0.00452%]
[INFO] ** service:[0.0048200000000000005:99.99833%,-211.09762999999998:0.0005%,-211.73542999999998:0.0005%,-211.08346:0.00033%,-211.35747999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.41625%,9:25.96862%,7:18.14448%,1:17.46864%,14:0.0005%,3:0.0005%,21:0.00033%,15:0.00033%,4:0.00017%,2:0.00017%]
[INFO] ** type:[0:99.99967%,1:0.00033%]
[INFO] ** unixtime:1623 (0.27177%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1228e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.7503e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.1094e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.2033e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.2618e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.0754e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1006e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0279e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 9.5632e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9711e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/597190
[33m[INFO] loading file 44-44/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597190, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597190, 17)

[INFO] analyzing data
[INFO] 597190 rows
[INFO] ** appi_name:[21:99.99833%,30:0.00067%,31:0.0005%,0:0.00033%,22:0.00017%]
[INFO] ** classification:[normal:64.39475%,Single Stage Single Point:35.60525%]
[INFO] ** dst:[21:43.33931%,10:21.0526%,8:18.14917%,9:17.45592%,22:0.001%,15:0.00067%,18:0.0005%,25:0.00033%,24:0.00033%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99933%,0:0.00067%]
[INFO] ** i/f_name:[2:99.99933%,3:0.00067%]
[INFO] ** modbus_function_code:[0.02961:99.99833%,-33.760870000000004:0.00167%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.99816%,0:0.00167%]
[INFO] ** modbus_transaction_id:65536 (10.97406%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99833%,2:0.001%,1:0.00067%]
[INFO] ** proxy_src_ip:[18:38.43232%,20:25.96008%,13:18.14933%,6:17.45642%,17:0.00067%,7:0.00033%,16:0.00017%,5:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95941%,-0.32151:21.0526%,-1.27613:18.14883%,-0.23351:17.45575%,-0.33484:17.37973%,-71.33197:0.00067%,-0.24151:0.0005%,-0.08551:0.00033%,-64.19493:0.00033%,-1.27347:0.00033%,1.45709:0.00033%,-1.02014:0.00017%,-1.2708:0.00017%,1.47576:0.00017%,-71.14931:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,4.42897:0.00017%]
[INFO] ** scada_tag:[3:25.95891%,1:21.0526%,5:18.14883%,4:17.45542%,2:17.37956%,0:0.00469%]
[INFO] ** service:[0.0048200000000000005:99.99833%,-211.73542999999998:0.00067%,-186.43601999999998:0.0005%,-186.44547:0.00033%,-211.08818:0.00017%]
[INFO] ** src:[22:38.43232%,9:25.96008%,7:18.14933%,1:17.45642%,14:0.00067%,21:0.00033%,17:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1621 (0.27144%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.6398e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.3394e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.3561e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.8808e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.4997e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.9173e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.7366e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.4505e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0915e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5112e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/597190
[33m[INFO] loading file 45-45/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597190, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597190, 17)

[INFO] analyzing data
[INFO] 597190 rows
[INFO] ** appi_name:[21:99.99883%,30:0.0005%,31:0.00033%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:64.41183%,Single Stage Single Point:35.58817%]
[INFO] ** dst:[21:43.32239%,10:21.08676%,8:18.13393%,9:17.45441%,22:0.00134%,15:0.0005%,18:0.00033%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99967%,0:0.00033%]
[INFO] ** i/f_name:[2:99.9995%,3:0.0005%]
[INFO] ** modbus_function_code:[0.02961:99.99883%,-33.760870000000004:0.00117%]
[INFO] ** modbus_function_description:[7:50.0005%,11:49.99833%,0:0.00117%]
[INFO] ** modbus_transaction_id:65536 (10.97406%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.999%,2:0.0005%,1:0.0005%]
[INFO] ** proxy_src_ip:[18:38.47754%,20:25.93228%,13:18.13376%,6:17.45491%,17:0.0005%,16:0.00033%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.93161%,-0.32151:21.08676%,-1.27613:18.13376%,-0.23351:17.45424%,-0.33484:17.39078%,1.45709:0.0005%,-0.24151:0.0005%,-71.33197:0.0005%,-1.02014:0.00033%,-0.08551:0.00033%,-71.14798:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,14.4699:0.00017%]
[INFO] ** scada_tag:[3:25.93111%,1:21.08659%,5:18.13376%,4:17.45424%,2:17.39061%,0:0.00368%]
[INFO] ** service:[0.0048200000000000005:99.99883%,-211.73542999999998:0.0005%,-186.43601999999998:0.00033%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.47754%,9:25.93228%,7:18.13376%,1:17.45491%,14:0.0005%,15:0.00033%,17:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1620 (0.27127%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1694e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5873e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3560e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7254e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5468e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2588e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1221e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.9536e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1432e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.6016e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/597190
[33m[INFO] loading file 46-46/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597190, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597190, 17)

[INFO] analyzing data
[INFO] 597190 rows
[INFO] ** appi_name:[21:99.99816%,30:0.001%,26:0.00017%,17:0.00017%,12:0.00017%,9:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.41334%,Single Stage Single Point:35.58666%]
[INFO] ** dst:[21:43.34198%,10:21.06867%,8:18.11166%,9:17.47501%,22:0.001%,15:0.001%,25:0.00017%,16:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99916%,0:0.00084%]
[INFO] ** i/f_name:[2:99.999%,3:0.001%]
[INFO] ** modbus_function_code:[0.02961:99.99816%,-33.760870000000004:0.00184%]
[INFO] ** modbus_function_description:[7:49.99916%,11:49.999%,0:0.00184%]
[INFO] ** modbus_transaction_id:65536 (10.97406%)
[INFO] ** orig:[0:99.99967%,1:0.00033%]
[INFO] ** proto:[0:99.99866%,1:0.001%,2:0.00033%]
[INFO] ** proxy_src_ip:[18:38.43701%,20:25.97364%,13:18.11166%,6:17.47551%,17:0.001%,16:0.00033%,7:0.00033%,5:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.97331%,-0.32151:21.0685%,-1.27613:18.11149%,-0.23351:17.47484%,-0.33484:17.36851%,-71.33197:0.001%,-0.24151:0.0005%,-1.02014:0.00033%,-64.19493:0.00017%,14.4699:0.00017%,10.192739999999999:0.00017%,-71.14798:0.00017%,-1.2708:0.00017%,1.45709:0.00017%,1.47576:0.00017%,-0.24950999999999998:0.00017%,-61.95768:0.00017%]
[INFO] ** scada_tag:[3:25.97281%,1:21.06834%,5:18.11132%,4:17.47451%,2:17.36851%,0:0.00452%]
[INFO] ** service:[0.0048200000000000005:99.99833%,-211.73542999999998:0.001%,-183.8612:0.00017%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.43701%,9:25.97364%,7:18.11166%,1:17.47551%,14:0.001%,21:0.00033%,15:0.00033%,16:0.00017%,8:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99916%,1:0.00084%]
[INFO] ** unixtime:1623 (0.27177%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5095e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.2421e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.8458e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.0271e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9121e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.9726e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.2514e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.2315e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4951e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4630e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/597190
[33m[INFO] loading file 47-47/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597190, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597190, 17)

[INFO] analyzing data
[INFO] 597190 rows
[INFO] ** appi_name:[21:99.9995%,33:0.00017%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.40262%,Single Stage Single Point:35.59738%]
[INFO] ** dst:[21:43.31385%,10:21.08692%,8:18.12288%,9:17.47417%,22:0.00151%,24:0.00033%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.9995%,-33.760870000000004:0.0005%]
[INFO] ** modbus_function_description:[7:50.00117%,11:49.99833%,0:0.0005%]
[INFO] ** modbus_transaction_id:65536 (10.97406%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.45811%,20:25.94333%,13:18.12321%,6:17.47451%,16:0.00033%,7:0.00033%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.9425%,-0.32151:21.08692%,-1.27613:18.12271%,-0.23351:17.474%,-0.33484:17.37119%,1.45709:0.0005%,-0.24151:0.0005%,-1.27347:0.00033%,-1.02014:0.00033%,-71.14798:0.00017%,-61.95635:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.942%,1:21.08676%,5:18.12254%,4:17.47384%,2:17.37102%,0:0.00385%]
[INFO] ** service:[0.0048200000000000005:99.99967%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.45811%,9:25.94333%,7:18.12321%,1:17.47451%,21:0.00033%,15:0.00033%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1621 (0.27144%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0865e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1873e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5198e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2628e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1897e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.7264e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.8504e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1365e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0345e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.5425e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/597190
[33m[INFO] loading file 48-48/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597190, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597190, 17)

[INFO] analyzing data
[INFO] 597190 rows
[INFO] ** appi_name:[21:99.99699%,30:0.00234%,33:0.00017%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.41903%,Single Stage Single Point:35.58097%]
[INFO] ** dst:[21:43.3234%,10:21.09195%,8:18.1145%,9:17.4663%,15:0.00234%,22:0.00084%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99799%,0:0.00201%]
[INFO] ** i/f_name:[2:99.99766%,3:0.00234%]
[INFO] ** modbus_function_code:[0.02961:99.99699%,-33.760870000000004:0.00301%]
[INFO] ** modbus_function_description:[7:49.99916%,11:49.99782%,0:0.00301%]
[INFO] ** modbus_transaction_id:65536 (10.97406%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99715%,1:0.00234%,2:0.0005%]
[INFO] ** proxy_src_ip:[18:38.46163%,20:25.95405%,13:18.11467%,6:17.4663%,17:0.00234%,14:0.0005%,16:0.00033%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.95355%,-0.32151:21.09195%,-1.27613:18.11434%,-0.23351:17.46613%,-0.33484:17.36968%,-71.33197:0.00234%,-1.02014:0.00033%,-1.2708:0.00017%,13.431270000000001:0.00017%,-0.24151:0.00017%,-71.14798:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-61.95635:0.00017%,1.45709:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.95321%,1:21.09178%,5:18.11434%,4:17.46613%,2:17.36951%,0:0.00502%]
[INFO] ** service:[0.0048200000000000005:99.99715%,-211.73542999999998:0.00234%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.46163%,9:25.95405%,7:18.11467%,1:17.4663%,14:0.00234%,2:0.0005%,15:0.00033%,8:0.00017%]
[INFO] ** type:[0:99.99967%,1:0.00033%]
[INFO] ** unixtime:1620 (0.27127%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.1868e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.9412e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.0192e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0017e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7060e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4406e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.3682e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6025e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9417e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5212e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/597190
[33m[INFO] loading file 49-49/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (597190, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (597190, 17)

[INFO] analyzing data
[INFO] 597190 rows
[INFO] ** appi_name:[21:99.99749%,30:0.00084%,17:0.00067%,26:0.00033%,22:0.00033%,28:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:64.3837%,Single Stage Single Point:35.6163%]
[INFO] ** dst:[21:43.3172%,10:21.06231%,8:18.12656%,9:17.48958%,22:0.00151%,15:0.00084%,16:0.00067%,6:0.00067%,24:0.00033%,17:0.00033%]
[INFO] ** i/f_dir:[1:99.99916%,0:0.00084%]
[INFO] ** i/f_name:[2:99.99916%,3:0.00084%]
[INFO] ** modbus_function_code:[0.02961:99.99749%,-33.760870000000004:0.00251%]
[INFO] ** modbus_function_description:[7:49.99967%,11:49.99782%,0:0.00251%]
[INFO] ** modbus_transaction_id:65536 (10.97406%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99849%,1:0.00084%,2:0.00067%]
[INFO] ** proxy_src_ip:[18:38.43065%,20:25.94953%,13:18.12673%,6:17.49025%,17:0.00084%,1:0.00067%,14:0.0005%,21:0.00033%,16:0.00033%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.94869%,-0.32151:21.06231%,-1.27613:18.12622%,-0.23351:17.48941%,-0.33484:17.36834%,-71.33197:0.00084%,-0.24151:0.00067%,1.45709:0.0005%,-1.27347:0.00033%,-71.14931:0.00033%,-1.02014:0.00033%,-71.14798:0.00033%,1.47576:0.00017%,-1.2708:0.00017%,-58.035180000000004:0.00017%,-58.032509999999995:0.00017%,1.46509:0.00017%,-43.76509:0.00017%,2.05573:0.00017%,-5.08665:0.00017%,-0.24950999999999998:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.94836%,1:21.06214%,5:18.12606%,4:17.48907%,2:17.36834%,0:0.00603%]
[INFO] ** service:[0.0048200000000000005:99.99749%,-211.73542999999998:0.00084%,-205.44247:0.00067%,-211.08346:0.00033%,-211.08818:0.00033%,-211.09762999999998:0.00017%,-185.9872:0.00017%]
[INFO] ** src:[22:38.43065%,9:25.94953%,7:18.12673%,1:17.49025%,14:0.00084%,3:0.00067%,2:0.0005%,15:0.00033%,4:0.00033%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1621 (0.27144%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.9276e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2251e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7309e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8706e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.9301e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5158e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2620e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1712e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/597190
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.5897e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2211e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/597190
[33m[INFO] loading file 50-50/50 on epoch 6/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (447172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (447172, 17)

[INFO] analyzing data
[INFO] 447172 rows
[INFO] ** appi_name:[21:99.99732%,30:0.00112%,7:0.00067%,22:0.00045%,31:0.00022%,8:0.00022%]
[INFO] ** classification:[normal:64.31284%,Single Stage Single Point:35.68716%]
[INFO] ** dst:[21:43.26523%,10:21.04425%,8:18.20955%,9:17.47739%,15:0.00112%,22:0.00067%,16:0.00045%,6:0.00045%,2:0.00045%,24:0.00022%,18:0.00022%]
[INFO] ** i/f_dir:[1:99.99888%,0:0.00112%]
[INFO] ** i/f_name:[2:99.99888%,3:0.00112%]
[INFO] ** modbus_function_code:[0.02961:99.99732%,-33.760870000000004:0.00268%]
[INFO] ** modbus_function_description:[11:49.99888%,7:49.99843%,0:0.00268%]
[INFO] ** modbus_transaction_id:65536 (14.65566%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99821%,1:0.00112%,2:0.00067%]
[INFO] ** proxy_src_ip:[18:38.36622%,20:25.94348%,13:18.20977%,6:17.47739%,17:0.00112%,1:0.00067%,16:0.00045%,14:0.00045%,21:0.00022%,7:0.00022%]
[INFO] ** s_port:[1.45442:25.94304%,-0.32151:21.04425%,-1.27613:18.20932%,-0.23351:17.47739%,-0.33484:17.32197%,-71.33197:0.00112%,-71.14931:0.00045%,-1.02014:0.00045%,-3.3787199999999995:0.00022%,4.33564:0.00022%,15.912510000000001:0.00022%,7.9608300000000005:0.00022%,1.46509:0.00022%,1.45709:0.00022%,-1.27347:0.00022%,-1.2708:0.00022%,0.31847:0.00022%]
[INFO] ** scada_tag:[3:25.94281%,1:21.04403%,5:18.2091%,4:17.47739%,2:17.32175%,0:0.00492%]
[INFO] ** service:[0.0048200000000000005:99.99732%,-211.73542999999998:0.00112%,-211.09762999999998:0.00067%,-211.08818:0.00045%,-186.43601999999998:0.00022%,-211.35747999999998:0.00022%]
[INFO] ** src:[22:38.36622%,9:25.94348%,7:18.20977%,1:17.47739%,14:0.00112%,3:0.00067%,15:0.00045%,2:0.00045%,21:0.00022%,4:0.00022%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1215 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/447172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5427e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3808e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/447172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4350e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2407e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/447172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6226e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3402e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/447172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.5374e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.8787e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-6-files-49-50-batch-300000-400000
[INFO] processing batch 400000-500000/447172
[33m[INFO] epoch 7/10[0m
[33m[INFO] loading file 1-1/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99342%,30:0.0011%,22:0.00091%,17:0.00073%,31:0.00055%,26:0.00055%,7:0.00055%,23:0.00037%,18:0.00037%,0:0.00037%,28:0.00018%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:78.00399%,Single Stage Single Point:21.99601%]
[INFO] ** dst:[21:43.27177%,10:21.0347%,8:18.16687%,9:17.51954%,6:0.00146%,22:0.0011%,16:0.0011%,15:0.0011%,18:0.00055%,26:0.00037%,25:0.00037%,19:0.00037%,17:0.00037%,24:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.9989%,0:0.0011%]
[INFO] ** i/f_name:[2:99.9989%,3:0.0011%]
[INFO] ** modbus_function_code:[0.02961:99.99342%,-33.760870000000004:0.0064%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99781%,11:49.99561%,0:0.0064%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99634%,2:0.00256%,1:0.0011%]
[INFO] ** proxy_src_ip:[18:38.3967%,20:25.9094%,13:18.16705%,6:17.5199%,11:0.00128%,10:0.00128%,17:0.0011%,14:0.00091%,1:0.00091%,7:0.00055%,21:0.00037%,16:0.00037%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.90885%,-0.32151:21.03397%,-1.27613:18.16668%,-0.23351:17.51935%,-0.33484:17.36273%,-71.33197:0.0011%,-71.14931:0.00091%,-2.1481:0.00073%,-0.24151:0.00055%,-71.14798:0.00055%,-1.02014:0.00037%,-64.19493:0.00037%,-2.42942:0.00037%,4.44364:0.00037%,-43.76509:0.00018%,10.67005:0.00018%,4.29964:0.00018%,-5.08665:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,1.47576:0.00018%,1.46509:0.00018%,4.076980000000001:0.00018%,-58.032509999999995:0.00018%,-58.035180000000004:0.00018%,-1.2708:0.00018%,-1.27347:0.00018%,-5.1466400000000005:0.00018%,-68.79874000000001:0.00018%,14.253910000000001:0.00018%,1.45709:0.00018%]
[INFO] ** scada_tag:[3:25.90867%,1:21.03379%,5:18.16632%,4:17.51917%,2:17.36255%,0:0.0095%]
[INFO] ** service:[0.0048200000000000005:99.99415%,-211.73542999999998:0.0011%,-211.08818:0.00091%,-205.44247:0.00073%,-211.07873999999998:0.00073%,-211.09762999999998:0.00055%,-211.08346:0.00055%,-186.43601999999998:0.00055%,-186.44547:0.00037%,-185.9872:0.00018%,-202.75898:0.00018%]
[INFO] ** src:[22:38.3967%,9:25.9094%,7:18.16705%,1:17.5199%,11:0.00128%,10:0.00128%,14:0.0011%,3:0.00091%,2:0.00091%,21:0.00055%,15:0.00037%,4:0.00037%,8:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1485 (0.2714%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1097 - tp: 78194.0000 - fp: 1806.0000 - tn: 318194.0000 - fn: 1806.0000 - accuracy: 0.9910 - precision: 0.9774 - recall: 0.9774 - auc: 0.9956 - val_loss: 7.0933e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0464e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1115e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3692e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4809e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.5588 - tp: 61741.0000 - fp: 18259.0000 - tn: 301741.0000 - fn: 18259.0000 - accuracy: 0.9087 - precision: 0.7718 - recall: 0.7718 - auc: 0.9595 - val_loss: 0.2158 - val_tp: 19744.0000 - val_fp: 256.0000 - val_tn: 79744.0000 - val_fn: 256.0000 - val_accuracy: 0.9949 - val_precision: 0.9872 - val_recall: 0.9872 - val_auc: 0.9996
[INFO] saving weights to checkpoints/lstm-epoch-7-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0288 - tp: 79980.0000 - fp: 20.0000 - tn: 319980.0000 - fn: 20.0000 - accuracy: 0.9999 - precision: 0.9998 - recall: 0.9998 - auc: 1.0000 - val_loss: 0.0054 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 2-2/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99872%,7:0.00055%,30:0.00037%,31:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:71.0877%,Single Stage Single Point:28.9123%]
[INFO] ** dst:[21:43.31289%,10:21.02922%,8:18.1442%,9:17.51131%,22:0.00091%,16:0.00037%,15:0.00037%,2:0.00037%,24:0.00018%,18:0.00018%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99963%,3:0.00037%]
[INFO] ** modbus_function_code:[0.02961:99.99872%,-33.760870000000004:0.00128%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99872%,0:0.00128%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99945%,1:0.00037%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.38172%,20:25.96094%,13:18.1442%,6:17.51168%,1:0.00055%,17:0.00037%,16:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.96021%,-0.32151:21.02922%,-1.27613:18.14384%,-0.23351:17.51113%,-0.33484:17.3525%,-0.24151:0.00037%,-71.33197:0.00037%,1.45709:0.00037%,1.47576:0.00018%,12.60597:0.00018%,10.67005:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,4.076980000000001:0.00018%,-3.3787199999999995:0.00018%,4.29964:0.00018%,-1.27347:0.00018%]
[INFO] ** scada_tag:[3:25.95984%,1:21.02922%,5:18.14384%,4:17.51076%,2:17.35231%,0:0.00402%]
[INFO] ** service:[0.0048200000000000005:99.99872%,-211.09762999999998:0.00055%,-211.73542999999998:0.00037%,-211.35747999999998:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.38172%,9:25.96094%,7:18.1442%,1:17.51168%,3:0.00055%,14:0.00037%,21:0.00018%,15:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1488 (0.27194%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0118 - tp: 79803.0000 - fp: 197.0000 - tn: 319803.0000 - fn: 197.0000 - accuracy: 0.9990 - precision: 0.9975 - recall: 0.9975 - auc: 1.0000 - val_loss: 0.0032 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1423 - tp: 76966.0000 - fp: 3034.0000 - tn: 316966.0000 - fn: 3034.0000 - accuracy: 0.9848 - precision: 0.9621 - recall: 0.9621 - auc: 0.9950 - val_loss: 1.1896 - val_tp: 10625.0000 - val_fp: 9375.0000 - val_tn: 70625.0000 - val_fn: 9375.0000 - val_accuracy: 0.8125 - val_precision: 0.5312 - val_recall: 0.5312 - val_auc: 0.9451
[INFO] saving weights to checkpoints/lstm-epoch-7-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0187 - tp: 79269.0000 - fp: 731.0000 - tn: 319269.0000 - fn: 731.0000 - accuracy: 0.9963 - precision: 0.9909 - recall: 0.9909 - auc: 1.0000 - val_loss: 1.1194e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.4886 - tp: 71764.0000 - fp: 8236.0000 - tn: 311764.0000 - fn: 8236.0000 - accuracy: 0.9588 - precision: 0.8971 - recall: 0.8971 - auc: 0.9673 - val_loss: 0.0807 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1278 - tp: 77231.0000 - fp: 2769.0000 - tn: 317231.0000 - fn: 2769.0000 - accuracy: 0.9862 - precision: 0.9654 - recall: 0.9654 - auc: 0.9959 - val_loss: 1.2623 - val_tp: 10594.0000 - val_fp: 9406.0000 - val_tn: 70594.0000 - val_fn: 9406.0000 - val_accuracy: 0.8119 - val_precision: 0.5297 - val_recall: 0.5297 - val_auc: 0.9447
[INFO] saving weights to checkpoints/lstm-epoch-7-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 3-3/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99159%,30:0.00219%,22:0.0011%,31:0.00091%,26:0.00091%,17:0.00091%,7:0.00073%,27:0.00037%,0:0.00037%,28:0.00018%,23:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:87.8572%,Single Stage Single Point:12.1428%]
[INFO] ** dst:[21:43.30869%,10:21.08459%,8:18.1559%,9:17.4415%,6:0.00219%,15:0.00146%,18:0.00128%,16:0.00128%,22:0.00091%,2:0.00037%,7:0.00037%,25:0.00037%,17:0.00037%,12:0.00018%,24:0.00018%,19:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99854%,0:0.00146%]
[INFO] ** i/f_name:[2:99.99854%,3:0.00146%]
[INFO] ** modbus_function_code:[0.02961:99.99159%,-33.760870000000004:0.00822%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99634%,11:49.99525%,0:0.00822%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.9989%,2:0.0011%]
[INFO] ** proto:[0:99.99415%,2:0.00439%,1:0.00146%]
[INFO] ** proxy_src_ip:[18:38.40895%,20:25.9847%,13:18.15608%,6:17.44186%,17:0.00219%,1:0.00146%,14:0.00128%,7:0.00091%,11:0.00073%,10:0.00073%,21:0.00055%,16:0.00018%,15:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.98397%,-0.32151:21.08441%,-1.27613:18.15553%,-0.23351:17.44132%,-0.33484:17.32453%,-71.33197:0.00146%,-71.14931:0.0011%,-71.14798:0.0011%,-64.19493:0.00037%,-0.08551:0.00037%,1.45709:0.00037%,-0.24151:0.00037%,14.4699:0.00018%,4.29964:0.00018%,4.90362:0.00018%,10.192739999999999:0.00018%,-3.3787199999999995:0.00018%,13.86459:0.00018%,4.44364:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,-43.76509:0.00018%,-5.08665:0.00018%,-58.035180000000004:0.00018%,4.076980000000001:0.00018%,-58.032509999999995:0.00018%,-1.27347:0.00018%,-1.2708:0.00018%,-1.02014:0.00018%,-5.1466400000000005:0.00018%,13.431270000000001:0.00018%,12.60597:0.00018%,1.47576:0.00018%,1.46509:0.00018%,14.253910000000001:0.00018%,-68.79874000000001:0.00018%,-0.24950999999999998:0.00018%,-2.1481:0.00018%,10.67005:0.00018%,-68.36943000000001:0.00018%]
[INFO] ** scada_tag:[3:25.9836%,1:21.08423%,5:18.15535%,4:17.44113%,2:17.32435%,0:0.01133%]
[INFO] ** service:[0.0048200000000000005:99.99178%,-211.73542999999998:0.00146%,-186.43601999999998:0.00128%,-211.08346:0.0011%,-211.08818:0.0011%,-205.44247:0.00091%,-211.09762999999998:0.00073%,-202.75898:0.00037%,-186.44547:0.00037%,-183.8612:0.00018%,-185.9872:0.00018%,-201.23771000000002:0.00018%,-211.35747999999998:0.00018%,-211.07873999999998:0.00018%]
[INFO] ** src:[22:38.40895%,9:25.9847%,7:18.15608%,1:17.44186%,21:0.00201%,3:0.00164%,2:0.00128%,11:0.00073%,10:0.00073%,4:0.00073%,14:0.00037%,8:0.00037%,17:0.00018%,15:0.00018%,13:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1486 (0.27158%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1101 - tp: 76585.0000 - fp: 3415.0000 - tn: 316585.0000 - fn: 3415.0000 - accuracy: 0.9829 - precision: 0.9573 - recall: 0.9573 - auc: 0.9979 - val_loss: 0.1095 - val_tp: 19989.0000 - val_fp: 11.0000 - val_tn: 79989.0000 - val_fn: 11.0000 - val_accuracy: 0.9998 - val_precision: 0.9995 - val_recall: 0.9995 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-7-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0108 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.6622 - val_tp: 17363.0000 - val_fp: 2637.0000 - val_tn: 77363.0000 - val_fn: 2637.0000 - val_accuracy: 0.9473 - val_precision: 0.8681 - val_recall: 0.8681 - val_auc: 0.9741
[INFO] saving weights to checkpoints/lstm-epoch-7-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0762 - tp: 78399.0000 - fp: 1601.0000 - tn: 318399.0000 - fn: 1601.0000 - accuracy: 0.9920 - precision: 0.9800 - recall: 0.9800 - auc: 0.9995 - val_loss: 6.4036e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.1528e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.8532e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.6436e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.4134e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 4-4/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99762%,30:0.00128%,31:0.00037%,33:0.00018%,26:0.00018%,23:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:91.99886%,Single Stage Single Point:8.00114%]
[INFO] ** dst:[21:43.35364%,10:20.94771%,8:18.17472%,9:17.52045%,15:0.00128%,22:0.0011%,18:0.00037%,24:0.00018%,19:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.9989%,0:0.0011%]
[INFO] ** i/f_name:[2:99.99872%,3:0.00128%]
[INFO] ** modbus_function_code:[0.02961:99.99762%,-33.760870000000004:0.00238%]
[INFO] ** modbus_function_description:[7:49.99982%,11:49.99781%,0:0.00238%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.9989%,2:0.0011%]
[INFO] ** proto:[0:99.99817%,1:0.00128%,2:0.00055%]
[INFO] ** proxy_src_ip:[18:38.26201%,20:26.03971%,13:18.17472%,6:17.52082%,17:0.00128%,21:0.00037%,16:0.00037%,14:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.03898%,-0.32151:20.94753%,-1.27613:18.17436%,-0.23351:17.52027%,-0.33484:17.31448%,-71.33197:0.00128%,1.45709:0.00037%,-0.08551:0.00037%,-0.24151:0.00037%,-1.02014:0.00037%,-1.2708:0.00018%,14.4699:0.00018%,4.44364:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-49.275529999999996:0.00018%]
[INFO] ** scada_tag:[3:26.0388%,1:20.94734%,5:18.17436%,4:17.5199%,2:17.3143%,0:0.0053%]
[INFO] ** service:[0.0048200000000000005:99.99781%,-211.73542999999998:0.00128%,-186.43601999999998:0.00037%,-183.8612:0.00018%,-211.08346:0.00018%,-211.07873999999998:0.00018%]
[INFO] ** src:[22:38.26201%,9:26.03971%,7:18.17472%,1:17.52082%,21:0.0011%,15:0.00037%,4:0.00037%,17:0.00018%,14:0.00018%,8:0.00018%,3:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1496 (0.27341%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.4568e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.9705e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.7927e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.3130e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.4098e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2272e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.0224e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8477e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.7308 - tp: 63198.0000 - fp: 16802.0000 - tn: 303198.0000 - fn: 16802.0000 - accuracy: 0.9160 - precision: 0.7900 - recall: 0.7900 - auc: 0.9403 - val_loss: 0.9270 - val_tp: 10946.0000 - val_fp: 9054.0000 - val_tn: 70946.0000 - val_fn: 9054.0000 - val_accuracy: 0.8189 - val_precision: 0.5473 - val_recall: 0.5473 - val_auc: 0.9309
[INFO] saving weights to checkpoints/lstm-epoch-7-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 5-5/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99634%,30:0.00256%,37:0.00018%,26:0.00018%,12:0.00018%,9:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:89.70251%,Single Stage Single Point:10.29749%]
[INFO] ** dst:[21:43.36534%,10:20.76239%,8:18.2407%,9:17.62718%,15:0.00256%,22:0.00091%,25:0.00018%,24:0.00018%,6:0.00018%,2:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99781%,0:0.00219%]
[INFO] ** i/f_name:[2:99.99744%,3:0.00256%]
[INFO] ** modbus_function_code:[0.02961:99.99634%,-33.760870000000004:0.00366%]
[INFO] ** modbus_function_description:[7:49.99872%,11:49.99762%,0:0.00366%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.99799%,2:0.00201%]
[INFO] ** proto:[0:99.99708%,1:0.00256%,2:0.00037%]
[INFO] ** proxy_src_ip:[18:37.99884%,20:26.12908%,13:18.24088%,6:17.62736%,17:0.00256%,1:0.00037%,21:0.00018%,16:0.00018%,7:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.12853%,-0.32151:20.76203%,-1.27613:18.2407%,-0.23351:17.627%,-0.33484:17.23681%,-71.33197:0.00256%,-0.24151:0.00037%,1.45709:0.00037%,1.47576:0.00018%,-49.275529999999996:0.00018%,-1.27347:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,2.22906:0.00018%,14.4699:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.12816%,1:20.76184%,5:18.24052%,4:17.627%,2:17.23681%,0:0.00567%]
[INFO] ** service:[0.0048200000000000005:99.99671%,-211.73542999999998:0.00256%,-183.8612:0.00018%,-211.08346:0.00018%,-211.35747999999998:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:37.99884%,9:26.12908%,7:18.24088%,1:17.62736%,21:0.00219%,14:0.00055%,3:0.00037%,16:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1497 (0.27359%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0587 - tp: 78721.0000 - fp: 1279.0000 - tn: 318721.0000 - fn: 1279.0000 - accuracy: 0.9936 - precision: 0.9840 - recall: 0.9840 - auc: 0.9971 - val_loss: 1.7958 - val_tp: 12798.0000 - val_fp: 7202.0000 - val_tn: 72798.0000 - val_fn: 7202.0000 - val_accuracy: 0.8560 - val_precision: 0.6399 - val_recall: 0.6399 - val_auc: 0.8690
[INFO] saving weights to checkpoints/lstm-epoch-7-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0948 - tp: 78209.0000 - fp: 1791.0000 - tn: 318209.0000 - fn: 1791.0000 - accuracy: 0.9910 - precision: 0.9776 - recall: 0.9776 - auc: 0.9963 - val_loss: 0.0019 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2958 - tp: 66633.0000 - fp: 13367.0000 - tn: 306633.0000 - fn: 13367.0000 - accuracy: 0.9332 - precision: 0.8329 - recall: 0.8329 - auc: 0.9823 - val_loss: 0.2083 - val_tp: 19766.0000 - val_fp: 234.0000 - val_tn: 79766.0000 - val_fn: 234.0000 - val_accuracy: 0.9953 - val_precision: 0.9883 - val_recall: 0.9883 - val_auc: 0.9996
[INFO] saving weights to checkpoints/lstm-epoch-7-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0150 - tp: 79984.0000 - fp: 16.0000 - tn: 319984.0000 - fn: 16.0000 - accuracy: 0.9999 - precision: 0.9998 - recall: 0.9998 - auc: 1.0000 - val_loss: 9.7189e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.5555e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5637e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 6-6/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.9958%,30:0.00329%,31:0.00018%,27:0.00018%,26:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:92.61567%,Single Stage Single Point:7.38433%]
[INFO] ** dst:[21:43.37082%,10:20.73224%,8:18.28328%,9:17.60872%,15:0.00329%,22:0.00055%,25:0.00018%,24:0.00018%,18:0.00018%,12:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99689%,0:0.00311%]
[INFO] ** i/f_name:[2:99.99671%,3:0.00329%]
[INFO] ** modbus_function_code:[0.02961:99.9958%,-33.760870000000004:0.0042%]
[INFO] ** modbus_function_description:[7:49.99854%,11:49.99726%,0:0.0042%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.99963%,1:0.00037%]
[INFO] ** proto:[0:99.9958%,1:0.00329%,2:0.00091%]
[INFO] ** proxy_src_ip:[18:37.94109%,20:26.16216%,13:18.28346%,6:17.60891%,17:0.00329%,14:0.00055%,16:0.00037%,11:0.00018%]
[INFO] ** s_port:[1.45442:26.16179%,-0.32151:20.73224%,-1.27613:18.28292%,-0.23351:17.60854%,-0.33484:17.20885%,-71.33197:0.00329%,-1.02014:0.00037%,-71.14798:0.00018%,-64.19493:0.00018%,4.90362:0.00018%,-1.2708:0.00018%,-0.24151:0.00018%,13.431270000000001:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-68.36943000000001:0.00018%]
[INFO] ** scada_tag:[3:26.16161%,1:20.73187%,5:18.28273%,4:17.60817%,2:17.20867%,0:0.00694%]
[INFO] ** service:[0.0048200000000000005:99.9958%,-211.73542999999998:0.00329%,-211.08346:0.00018%,-201.23771000000002:0.00018%,-202.75898:0.00018%,-186.44547:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:37.94109%,9:26.16216%,7:18.28346%,1:17.60891%,14:0.00329%,2:0.00055%,15:0.00037%,10:0.00018%]
[INFO] ** type:[0:99.99909%,1:0.00091%]
[INFO] ** unixtime:1498 (0.27377%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.3891e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9464e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5759e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2615e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.0823e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.1796e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.0037e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.9797e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3218 - tp: 66776.0000 - fp: 13224.0000 - tn: 306776.0000 - fn: 13224.0000 - accuracy: 0.9339 - precision: 0.8347 - recall: 0.8347 - auc: 0.9800 - val_loss: 0.2158 - val_tp: 19887.0000 - val_fp: 113.0000 - val_tn: 79887.0000 - val_fn: 113.0000 - val_accuracy: 0.9977 - val_precision: 0.9944 - val_recall: 0.9944 - val_auc: 0.9995
[INFO] saving weights to checkpoints/lstm-epoch-7-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 7-7/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99525%,30:0.00164%,22:0.00091%,17:0.00073%,26:0.00055%,31:0.00037%,28:0.00018%,27:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:81.10229%,Single Stage Single Point:18.89771%]
[INFO] ** dst:[21:43.35986%,10:20.74613%,8:18.25386%,9:17.63358%,15:0.00164%,22:0.00146%,6:0.00146%,16:0.00073%,24:0.00037%,18:0.00037%,17:0.00037%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99836%,0:0.00164%]
[INFO] ** i/f_name:[2:99.99836%,3:0.00164%]
[INFO] ** modbus_function_code:[0.02961:99.99525%,-33.760870000000004:0.00475%]
[INFO] ** modbus_function_description:[7:49.99836%,11:49.99689%,0:0.00475%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99634%,2:0.00201%,1:0.00164%]
[INFO] ** proxy_src_ip:[18:37.96905%,20:26.13767%,13:18.25422%,6:17.63376%,17:0.00164%,11:0.00073%,1:0.00073%,21:0.00055%,16:0.00055%,14:0.00037%,7:0.00037%,10:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13675%,-0.32151:20.74613%,-1.27613:18.25368%,-0.23351:17.63339%,-0.33484:17.22292%,-71.33197:0.00164%,-71.14931:0.00091%,-1.02014:0.00055%,-71.14798:0.00055%,1.45709:0.00055%,-0.24151:0.00037%,-1.27347:0.00037%,1.47576:0.00018%,1.46509:0.00018%,14.253910000000001:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,-68.79874000000001:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,6.1115699999999995:0.00018%,-5.08665:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:26.13639%,1:20.74613%,5:18.25349%,4:17.63321%,2:17.22292%,0:0.00786%]
[INFO] ** service:[0.0048200000000000005:99.99525%,-211.73542999999998:0.00164%,-211.08818:0.00091%,-205.44247:0.00073%,-211.08346:0.00055%,-186.43601999999998:0.00037%,-211.09762999999998:0.00018%,-185.9872:0.00018%,-202.75898:0.00018%]
[INFO] ** src:[22:37.96905%,9:26.13767%,7:18.25422%,1:17.63376%,14:0.00164%,10:0.00073%,3:0.00073%,15:0.00055%,4:0.00055%,21:0.00037%,2:0.00037%,11:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1495 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0186 - tp: 79941.0000 - fp: 59.0000 - tn: 319941.0000 - fn: 59.0000 - accuracy: 0.9997 - precision: 0.9993 - recall: 0.9993 - auc: 1.0000 - val_loss: 0.0017 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.4416e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.2069e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.9954e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6187 - val_tp: 15776.0000 - val_fp: 4224.0000 - val_tn: 75776.0000 - val_fn: 4224.0000 - val_accuracy: 0.9155 - val_precision: 0.7888 - val_recall: 0.7888 - val_auc: 0.8680
[INFO] saving weights to checkpoints/lstm-epoch-7-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.1218 - tp: 77663.0000 - fp: 2337.0000 - tn: 317663.0000 - fn: 2337.0000 - accuracy: 0.9883 - precision: 0.9708 - recall: 0.9708 - auc: 0.9928 - val_loss: 7.2652e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.0466e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4658e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 8-8/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99708%,30:0.0011%,0:0.00055%,24:0.00018%,23:0.00018%,22:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:94.77715%,Single Stage Single Point:5.22285%]
[INFO] ** dst:[21:43.42474%,10:20.80571%,8:18.1835%,9:17.58241%,22:0.00128%,15:0.0011%,25:0.00055%,19:0.00037%,26:0.00018%,24:0.00018%]
[INFO] ** i/f_dir:[1:99.99927%,0:0.00073%]
[INFO] ** i/f_name:[2:99.9989%,3:0.0011%]
[INFO] ** modbus_function_code:[0.02961:99.99708%,-33.760870000000004:0.00274%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99963%,11:49.99744%,0:0.00274%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.99963%,2:0.00037%]
[INFO] ** proto:[0:99.99817%,1:0.0011%,2:0.00073%]
[INFO] ** proxy_src_ip:[18:38.09131%,20:26.13968%,13:18.18277%,6:17.58277%,17:0.0011%,10:0.0011%,16:0.00055%,14:0.00037%,11:0.00018%,5:0.00018%]
[INFO] ** s_port:[1.45442:26.13913%,-0.32151:20.80571%,-1.27613:18.18258%,-0.23351:17.58222%,-0.33484:17.28561%,-71.33197:0.0011%,-15.039579999999999:0.00073%,-1.02014:0.00055%,-64.19493:0.00055%,1.45709:0.00037%,-0.24151:0.00037%,4.66896:0.00037%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.13858%,1:20.80552%,5:18.18258%,4:17.58204%,2:17.28542%,0:0.00585%]
[INFO] ** service:[0.0048200000000000005:99.99781%,-211.73542999999998:0.0011%,-186.44547:0.00055%,-211.07873999999998:0.00037%,-211.08818:0.00018%]
[INFO] ** src:[22:38.09131%,9:26.13968%,7:18.18277%,1:17.58277%,11:0.0011%,14:0.00073%,15:0.00055%,21:0.00037%,2:0.00037%,16:0.00018%,10:0.00018%]
[INFO] ** type:[0:99.99945%,1:0.00037%,2:0.00018%]
[INFO] ** unixtime:1498 (0.27377%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.8182e-04 - tp: 79983.0000 - fp: 17.0000 - tn: 319983.0000 - fn: 17.0000 - accuracy: 0.9999 - precision: 0.9998 - recall: 0.9998 - auc: 1.0000 - val_loss: 1.9302e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.6994e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4903e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3238e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1798e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.0584e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.8736 - val_tp: 18082.0000 - val_fp: 1918.0000 - val_tn: 78082.0000 - val_fn: 1918.0000 - val_accuracy: 0.9616 - val_precision: 0.9041 - val_recall: 0.9041 - val_auc: 0.9401
[INFO] saving weights to checkpoints/lstm-epoch-7-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.1443 - tp: 77222.0000 - fp: 2778.0000 - tn: 317222.0000 - fn: 2778.0000 - accuracy: 0.9861 - precision: 0.9653 - recall: 0.9653 - auc: 0.9931 - val_loss: 0.0094 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 9-9/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99817%,30:0.0011%,31:0.00037%,26:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:94.88113%,Single Stage Single Point:5.11887%]
[INFO] ** dst:[21:43.37174%,10:20.77647%,8:18.27908%,9:17.5698%,15:0.0011%,22:0.00091%,18:0.00037%,25:0.00018%,24:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.9989%,0:0.0011%]
[INFO] ** i/f_name:[2:99.9989%,3:0.0011%]
[INFO] ** modbus_function_code:[0.02961:99.99817%,-33.760870000000004:0.00183%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99799%,0:0.00183%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.99963%,2:0.00037%]
[INFO] ** proto:[0:99.99817%,1:0.0011%,2:0.00073%]
[INFO] ** proxy_src_ip:[18:38.01401%,20:26.13474%,13:18.27908%,6:17.57016%,17:0.0011%,21:0.00018%,16:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13401%,-0.32151:20.77647%,-1.27613:18.27871%,-0.23351:17.56961%,-0.33484:17.23754%,-71.33197:0.0011%,-0.24151:0.00037%,1.45709:0.00037%,-0.08551:0.00037%,1.46509:0.00018%,1.47576:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.13365%,1:20.77628%,5:18.27871%,4:17.56943%,2:17.23736%,0:0.00457%]
[INFO] ** service:[0.0048200000000000005:99.99817%,-211.73542999999998:0.0011%,-186.43601999999998:0.00037%,-211.08346:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.01401%,9:26.13474%,7:18.27908%,1:17.57016%,14:0.00073%,21:0.00037%,17:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1498 (0.27377%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0364 - tp: 79117.0000 - fp: 883.0000 - tn: 319117.0000 - fn: 883.0000 - accuracy: 0.9956 - precision: 0.9890 - recall: 0.9890 - auc: 0.9996 - val_loss: 0.0022 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1339 - tp: 74963.0000 - fp: 5037.0000 - tn: 314963.0000 - fn: 5037.0000 - accuracy: 0.9748 - precision: 0.9370 - recall: 0.9370 - auc: 0.9967 - val_loss: 0.2034 - val_tp: 16348.0000 - val_fp: 3652.0000 - val_tn: 76348.0000 - val_fn: 3652.0000 - val_accuracy: 0.9270 - val_precision: 0.8174 - val_recall: 0.8174 - val_auc: 0.9917
[INFO] saving weights to checkpoints/lstm-epoch-7-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0067 - tp: 79696.0000 - fp: 304.0000 - tn: 319696.0000 - fn: 304.0000 - accuracy: 0.9985 - precision: 0.9962 - recall: 0.9962 - auc: 1.0000 - val_loss: 4.3115e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.2877e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4905e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6488e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.9884e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 10-10/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99616%,30:0.00183%,31:0.00037%,26:0.00018%,24:0.00018%,23:0.00018%,22:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:94.41693%,Single Stage Single Point:5.58307%]
[INFO] ** dst:[21:43.41505%,10:20.80772%,8:18.22425%,9:17.54896%,15:0.00183%,22:0.00055%,24:0.00037%,19:0.00037%,18:0.00037%,26:0.00018%,25:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99836%,0:0.00164%]
[INFO] ** i/f_name:[2:99.99817%,3:0.00183%]
[INFO] ** modbus_function_code:[0.02961:99.99616%,-33.760870000000004:0.00366%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.9989%,11:49.99726%,0:0.00366%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.99927%,1:0.00073%]
[INFO] ** proto:[0:99.99726%,1:0.00183%,2:0.00091%]
[INFO] ** proxy_src_ip:[18:38.0904%,20:26.13292%,13:18.22443%,6:17.54823%,17:0.00183%,10:0.00091%,14:0.00037%,21:0.00018%,16:0.00018%,5:0.00018%,2:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13219%,-0.32151:20.80772%,-1.27613:18.22389%,-0.23351:17.54786%,-0.33484:17.28268%,-71.33197:0.00183%,-10.51843:0.00073%,-0.08551:0.00037%,-1.27347:0.00037%,5.71692:0.00037%,1.47576:0.00037%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-71.14931:0.00018%,-64.19493:0.00018%,1.45709:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.13182%,1:20.80753%,5:18.22389%,4:17.54768%,2:17.2825%,0:0.00658%]
[INFO] ** service:[0.0048200000000000005:99.99689%,-211.73542999999998:0.00183%,-211.07873999999998:0.00037%,-186.43601999999998:0.00037%,-211.08346:0.00018%,-186.44547:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.0904%,9:26.13292%,7:18.22443%,1:17.54823%,14:0.00183%,11:0.00091%,2:0.00037%,17:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%]
[INFO] ** type:[0:99.99854%,1:0.00128%,2:0.00018%]
[INFO] ** unixtime:1495 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.6651e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6624e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.1243e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5803e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.3580 - tp: 69693.0000 - fp: 10307.0000 - tn: 309693.0000 - fn: 10307.0000 - accuracy: 0.9485 - precision: 0.8712 - recall: 0.8712 - auc: 0.9804 - val_loss: 0.1555 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.1610 - tp: 75097.0000 - fp: 4903.0000 - tn: 315097.0000 - fn: 4903.0000 - accuracy: 0.9755 - precision: 0.9387 - recall: 0.9387 - auc: 0.9950 - val_loss: 0.0562 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 0.0072 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0012 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 11-11/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.9989%,31:0.00037%,30:0.00037%,26:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.38928%,10:20.87314%,8:18.1994%,9:17.5358%,22:0.00128%,18:0.00037%,15:0.00037%,25:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99963%,3:0.00037%]
[INFO] ** modbus_function_code:[0.02961:99.9989%,-33.760870000000004:0.0011%]
[INFO] ** modbus_function_description:[7:50.00073%,11:49.99817%,0:0.0011%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9989%,2:0.00073%,1:0.00037%]
[INFO] ** proxy_src_ip:[18:38.14596%,20:26.11683%,13:18.1994%,6:17.53617%,16:0.00055%,17:0.00037%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.11629%,-0.32151:20.87314%,-1.27613:18.19921%,-0.23351:17.53562%,-0.33484:17.27281%,-0.24151:0.00055%,-1.02014:0.00055%,-0.08551:0.00037%,-71.33197:0.00037%,-71.14798:0.00018%,1.45709:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:26.11592%,1:20.87314%,5:18.19903%,4:17.53525%,2:17.27263%,0:0.00402%]
[INFO] ** service:[0.0048200000000000005:99.9989%,-211.73542999999998:0.00037%,-186.43601999999998:0.00037%,-211.08346:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.14596%,9:26.11683%,7:18.1994%,1:17.53617%,15:0.00055%,14:0.00037%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1496 (0.27341%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 8s - loss: 7.4618e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.3662e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 8s - loss: 5.3077e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.4385e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 3.8013e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1971e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.7145e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3377e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1131e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9070e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 12-12/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99781%,30:0.00201%,9:0.00018%]
[INFO] ** classification:[normal:93.38581%,Single Stage Single Point:6.61419%]
[INFO] ** dst:[21:43.39623%,10:20.88228%,8:18.18496%,9:17.53343%,15:0.00201%,22:0.00055%,24:0.00037%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99836%,0:0.00164%]
[INFO] ** i/f_name:[2:99.99799%,3:0.00201%]
[INFO] ** modbus_function_code:[0.02961:99.99781%,-33.760870000000004:0.00219%]
[INFO] ** modbus_function_description:[7:49.99963%,11:49.99817%,0:0.00219%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.99836%,2:0.00164%]
[INFO] ** proto:[0:99.99799%,1:0.00201%]
[INFO] ** proxy_src_ip:[18:38.15235%,20:26.12652%,13:18.18514%,6:17.53361%,17:0.00201%,16:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:26.12597%,-0.32151:20.88228%,-1.27613:18.18459%,-0.23351:17.53324%,-0.33484:17.27007%,-71.33197:0.00201%,-1.27347:0.00037%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:26.12561%,1:20.88228%,5:18.18459%,4:17.53288%,2:17.27007%,0:0.00457%]
[INFO] ** service:[0.0048200000000000005:99.99781%,-211.73542999999998:0.00201%,-183.8612:0.00018%]
[INFO] ** src:[22:38.15235%,9:26.12652%,7:18.18514%,1:17.53361%,21:0.00164%,14:0.00037%,15:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1496 (0.27341%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6004e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6083e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4425e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2758e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3313 - tp: 66011.0000 - fp: 13989.0000 - tn: 306011.0000 - fn: 13989.0000 - accuracy: 0.9301 - precision: 0.8251 - recall: 0.8251 - auc: 0.9787 - val_loss: 0.2388 - val_tp: 19204.0000 - val_fp: 796.0000 - val_tn: 79204.0000 - val_fn: 796.0000 - val_accuracy: 0.9841 - val_precision: 0.9602 - val_recall: 0.9602 - val_auc: 0.9977
[INFO] saving weights to checkpoints/lstm-epoch-7-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2492 - tp: 65701.0000 - fp: 14299.0000 - tn: 305701.0000 - fn: 14299.0000 - accuracy: 0.9285 - precision: 0.8213 - recall: 0.8213 - auc: 0.9840 - val_loss: 0.2365 - val_tp: 18923.0000 - val_fp: 1077.0000 - val_tn: 78923.0000 - val_fn: 1077.0000 - val_accuracy: 0.9785 - val_precision: 0.9462 - val_recall: 0.9462 - val_auc: 0.9987
[INFO] saving weights to checkpoints/lstm-epoch-7-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0157 - tp: 79976.0000 - fp: 24.0000 - tn: 319976.0000 - fn: 24.0000 - accuracy: 0.9999 - precision: 0.9997 - recall: 0.9997 - auc: 1.0000 - val_loss: 0.0014 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 13-13/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99653%,31:0.00073%,26:0.00055%,0:0.00055%,30:0.00037%,22:0.00037%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:86.01665%,Single Stage Single Point:13.98335%]
[INFO] ** dst:[21:43.35401%,10:20.80571%,8:18.2789%,9:17.55737%,22:0.0011%,6:0.00091%,18:0.00073%,25:0.00055%,15:0.00037%,24:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99963%,3:0.00037%]
[INFO] ** modbus_function_code:[0.02961:99.99653%,-33.760870000000004:0.00329%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.9989%,11:49.99762%,0:0.00329%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99726%,2:0.00238%,1:0.00037%]
[INFO] ** proxy_src_ip:[18:38.05239%,20:26.1077%,13:18.27908%,6:17.55682%,10:0.0011%,11:0.00091%,16:0.00055%,17:0.00037%,7:0.00037%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.10715%,-0.32151:20.80571%,-1.27613:18.27871%,-0.23351:17.55645%,-0.33484:17.24668%,-9.78512:0.00073%,-64.19493:0.00055%,-1.02014:0.00055%,-71.14798:0.00055%,-0.24151:0.00037%,-71.14931:0.00037%,-0.08551:0.00037%,-71.33197:0.00037%,1.47576:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-1.2708:0.00018%,-68.79874000000001:0.00018%,6.1115699999999995:0.00018%,14.540560000000001:0.00018%,1.45709:0.00018%]
[INFO] ** scada_tag:[3:26.10678%,1:20.80552%,5:18.27871%,4:17.55645%,2:17.2465%,0:0.00603%]
[INFO] ** service:[0.0048200000000000005:99.99726%,-186.43601999999998:0.00073%,-211.08346:0.00055%,-186.44547:0.00055%,-211.73542999999998:0.00037%,-211.08818:0.00037%,-202.75898:0.00018%]
[INFO] ** src:[22:38.05239%,9:26.1077%,7:18.27908%,1:17.55682%,11:0.0011%,10:0.00091%,15:0.00055%,21:0.00037%,14:0.00037%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1495 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.8022e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8836e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8104e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1592e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.5069e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.2657e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3694 - tp: 67274.0000 - fp: 12726.0000 - tn: 307274.0000 - fn: 12726.0000 - accuracy: 0.9364 - precision: 0.8409 - recall: 0.8409 - auc: 0.9771 - val_loss: 0.1936 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0133 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0257e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 14-14/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99963%,30:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:93.73049%,Single Stage Single Point:6.26951%]
[INFO] ** dst:[21:43.34633%,10:20.81283%,8:18.2661%,9:17.57327%,22:0.00073%,24:0.00037%,15:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:99.99982%,3:0.00018%]
[INFO] ** modbus_function_code:[0.02961:99.99963%,-33.760870000000004:0.00037%]
[INFO] ** modbus_function_description:[7:50.00073%,11:49.9989%,0:0.00037%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,1:0.00018%]
[INFO] ** proxy_src_ip:[18:38.05257%,20:26.10715%,13:18.26629%,6:17.57345%,17:0.00018%,16:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:26.10642%,-0.32151:20.81283%,-1.27613:18.26574%,-0.23351:17.57308%,-0.33484:17.23973%,-1.27347:0.00037%,1.45709:0.00037%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,14.4699:0.00018%,-71.33197:0.00018%]
[INFO] ** scada_tag:[3:26.10605%,1:20.81283%,5:18.26555%,4:17.57272%,2:17.23955%,0:0.00329%]
[INFO] ** service:[0.0048200000000000005:99.99963%,-183.8612:0.00018%,-211.73542999999998:0.00018%]
[INFO] ** src:[22:38.05257%,9:26.10715%,7:18.26629%,1:17.57345%,15:0.00018%,14:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1495 (0.27322%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9593e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.7167 - val_tp: 18481.0000 - val_fp: 1519.0000 - val_tn: 78481.0000 - val_fn: 1519.0000 - val_accuracy: 0.9696 - val_precision: 0.9240 - val_recall: 0.9240 - val_auc: 0.9525
[INFO] saving weights to checkpoints/lstm-epoch-7-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1740 - tp: 76767.0000 - fp: 3233.0000 - tn: 316767.0000 - fn: 3233.0000 - accuracy: 0.9838 - precision: 0.9596 - recall: 0.9596 - auc: 0.9907 - val_loss: 5.0932e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9238e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5349e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1290e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.5056e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.9750e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.8213e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 15-15/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (547172, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (547172, 17)

[INFO] analyzing data
[INFO] 547172 rows
[INFO] ** appi_name:[21:99.99616%,30:0.00311%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:89.90628%,Single Stage Multi Point:10.09299%,Single Stage Single Point:0.00073%]
[INFO] ** dst:[21:43.30174%,10:20.77555%,8:18.31362%,9:17.60379%,15:0.00311%,22:0.00146%,25:0.00018%,24:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99708%,0:0.00292%]
[INFO] ** i/f_name:[2:99.99689%,3:0.00311%]
[INFO] ** modbus_function_code:[0.02961:99.99616%,-33.760870000000004:0.00384%]
[INFO] ** modbus_function_description:[7:49.9989%,11:49.99726%,0:0.00384%]
[INFO] ** modbus_transaction_id:65536 (11.97722%)
[INFO] ** orig:[0:99.99726%,2:0.00274%]
[INFO] ** proto:[0:99.99653%,1:0.00311%,2:0.00037%]
[INFO] ** proxy_src_ip:[18:38.0098%,20:26.06804%,13:18.31344%,6:17.60434%,17:0.00311%,16:0.00055%,7:0.00037%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.06731%,-0.32151:20.77537%,-1.27613:18.31325%,-0.23351:17.60361%,-0.33484:17.23443%,-71.33197:0.00311%,-0.24151:0.00055%,-1.02014:0.00055%,1.45709:0.00037%,1.46509:0.00018%,1.47576:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-61.95768:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.06694%,1:20.77519%,5:18.31325%,4:17.60324%,2:17.23425%,0:0.00713%]
[INFO] ** service:[0.0048200000000000005:99.99634%,-211.73542999999998:0.00311%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.0098%,9:26.06804%,7:18.31344%,1:17.60434%,21:0.00311%,15:0.00055%,14:0.00037%,16:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1504 (0.27487%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9588e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.2899e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.0945e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.3255e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4240e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9643e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6147e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3470e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/547172
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.7897 - tp: 56227.0000 - fp: 23773.0000 - tn: 296227.0000 - fn: 23773.0000 - accuracy: 0.8811 - precision: 0.7028 - recall: 0.7028 - auc: 0.8143 - val_loss: 7.5248 - val_tp: 10663.0000 - val_fp: 9337.0000 - val_tn: 70663.0000 - val_fn: 9337.0000 - val_accuracy: 0.8133 - val_precision: 0.5332 - val_recall: 0.5332 - val_auc: 0.7082
[INFO] saving weights to checkpoints/lstm-epoch-7-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/547172
[33m[INFO] loading file 16-16/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (486862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (486862, 17)

[INFO] analyzing data
[INFO] 486862 rows
[INFO] ** appi_name:[21:99.99836%,30:0.00144%,33:0.00021%]
[INFO] ** classification:[normal:81.3859%,Single Stage Multi Point:18.6141%]
[INFO] ** dst:[21:43.35397%,10:20.79747%,8:18.25445%,9:17.59123%,15:0.00144%,22:0.00123%,24:0.00021%]
[INFO] ** i/f_dir:[1:99.99856%,0:0.00144%]
[INFO] ** i/f_name:[2:99.99856%,3:0.00144%]
[INFO] ** modbus_function_code:[0.02961:99.99836%,-33.760870000000004:0.00164%]
[INFO] ** modbus_function_description:[7:50.00041%,11:49.99795%,0:0.00164%]
[INFO] ** modbus_transaction_id:65536 (13.4609%)
[INFO] ** orig:[0:99.99856%,2:0.00144%]
[INFO] ** proto:[0:99.99856%,1:0.00144%]
[INFO] ** proxy_src_ip:[18:38.0463%,20:26.10534%,13:18.25486%,6:17.59143%,17:0.00144%,16:0.00041%,21:0.00021%]
[INFO] ** s_port:[1.45442:26.10473%,-0.32151:20.79727%,-1.27613:18.25445%,-0.23351:17.59102%,-0.33484:17.24904%,-71.33197:0.00144%,1.45709:0.00041%,-0.24151:0.00041%,-1.02014:0.00041%,-1.27347:0.00021%,1.47576:0.00021%,-49.275529999999996:0.00021%,-1.2708:0.00021%]
[INFO] ** scada_tag:[3:26.10432%,1:20.79727%,5:18.25425%,4:17.59061%,2:17.24883%,0:0.00472%]
[INFO] ** service:[0.0048200000000000005:99.99856%,-211.73542999999998:0.00144%]
[INFO] ** src:[22:38.0463%,9:26.10534%,7:18.25486%,1:17.59143%,21:0.00144%,15:0.00041%,4:0.00021%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1332 (0.27359%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/486862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5667 - tp: 42444.0000 - fp: 37556.0000 - tn: 282444.0000 - fn: 37556.0000 - accuracy: 0.8122 - precision: 0.5306 - recall: 0.5306 - auc: 0.7066 - val_loss: 7.5183 - val_tp: 10671.0000 - val_fp: 9329.0000 - val_tn: 70671.0000 - val_fn: 9329.0000 - val_accuracy: 0.8134 - val_precision: 0.5336 - val_recall: 0.5336 - val_auc: 0.7085
[INFO] saving weights to checkpoints/lstm-epoch-7-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/486862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5554 - tp: 42500.0000 - fp: 37500.0000 - tn: 282500.0000 - fn: 37500.0000 - accuracy: 0.8125 - precision: 0.5312 - recall: 0.5312 - auc: 0.7070 - val_loss: 5.0289 - val_tp: 13760.0000 - val_fp: 6240.0000 - val_tn: 73760.0000 - val_fn: 6240.0000 - val_accuracy: 0.8752 - val_precision: 0.6880 - val_recall: 0.6880 - val_auc: 0.8050
[INFO] saving weights to checkpoints/lstm-epoch-7-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/486862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2904e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2158e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/486862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1228e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0201e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/486862
[33m[INFO] loading file 17-17/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (586862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (586862, 17)

[INFO] analyzing data
[INFO] 586862 rows
[INFO] ** appi_name:[21:99.99727%,7:0.00051%,26:0.00034%,0:0.00034%,33:0.00017%,31:0.00017%,27:0.00017%,24:0.00017%,22:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:94.74323%,Multi Stage Multi Point:5.25677%]
[INFO] ** dst:[21:43.3521%,10:20.83744%,8:18.20922%,9:17.59835%,22:0.00085%,6:0.00051%,25:0.00034%,16:0.00034%,2:0.00034%,24:0.00017%,18:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99727%,-33.760870000000004:0.00256%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99966%,11:49.99761%,0:0.00256%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.16719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99881%,2:0.00119%]
[INFO] ** proxy_src_ip:[18:38.07437%,20:26.11585%,13:18.20871%,6:17.59817%,10:0.00102%,11:0.00085%,1:0.00034%,21:0.00017%,16:0.00017%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:26.11483%,-0.32151:20.83727%,-1.27613:18.20837%,-0.23351:17.598%,-0.33484:17.2371%,6.0369:0.00068%,1.45709:0.00051%,1.47576:0.00034%,-71.14798:0.00034%,-64.19493:0.00034%,1.46509:0.00017%,-49.275529999999996:0.00017%,-1.27347:0.00017%,-0.24151:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,-68.79874000000001:0.00017%,6.15557:0.00017%,6.06224:0.00017%,8.55414:0.00017%,-3.3787199999999995:0.00017%,-4.3880099999999995:0.00017%,-71.14931:0.00017%]
[INFO] ** scada_tag:[3:26.11466%,1:20.8371%,5:18.2082%,4:17.59749%,2:17.2371%,0:0.00545%]
[INFO] ** service:[0.0048200000000000005:99.99813%,-211.09762999999998:0.00051%,-211.08346:0.00034%,-186.44547:0.00034%,-211.35747999999998:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.07437%,9:26.11585%,7:18.20871%,1:17.59817%,11:0.00102%,10:0.00085%,3:0.00034%,21:0.00017%,15:0.00017%,4:0.00017%,2:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1603 (0.27315%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 9.3102e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.2707e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.6578e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.1679e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.6344e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.1565e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.5633 - tp: 77204.0000 - fp: 2796.0000 - tn: 317204.0000 - fn: 2796.0000 - accuracy: 0.9860 - precision: 0.9650 - recall: 0.9650 - auc: 0.9782 - val_loss: 2.9262 - val_tp: 16369.0000 - val_fp: 3631.0000 - val_tn: 76369.0000 - val_fn: 3631.0000 - val_accuracy: 0.9274 - val_precision: 0.8184 - val_recall: 0.8184 - val_auc: 0.8865
[INFO] saving weights to checkpoints/lstm-epoch-7-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9273 - tp: 65471.0000 - fp: 14529.0000 - tn: 305471.0000 - fn: 14529.0000 - accuracy: 0.9274 - precision: 0.8184 - recall: 0.8184 - auc: 0.8865 - val_loss: 2.9061 - val_tp: 16394.0000 - val_fp: 3606.0000 - val_tn: 76394.0000 - val_fn: 3606.0000 - val_accuracy: 0.9279 - val_precision: 0.8197 - val_recall: 0.8197 - val_auc: 0.8873
[INFO] saving weights to checkpoints/lstm-epoch-7-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/586862
[33m[INFO] loading file 18-18/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (586862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (586862, 17)

[INFO] analyzing data
[INFO] 586862 rows
[INFO] ** appi_name:[21:99.9983%,30:0.00051%,7:0.00051%,31:0.00017%,27:0.00017%,22:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:82.40029%,Multi Stage Multi Point:17.59971%]
[INFO] ** dst:[21:43.34154%,10:20.83403%,8:18.25421%,9:17.5675%,22:0.00068%,15:0.00051%,24:0.00034%,16:0.00034%,2:0.00034%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99949%,0:0.00051%]
[INFO] ** i/f_name:[2:99.99949%,3:0.00051%]
[INFO] ** modbus_function_code:[0.02961:99.9983%,-33.760870000000004:0.0017%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.9983%,0:0.0017%]
[INFO] ** modbus_transaction_id:65536 (11.16719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99898%,2:0.00051%,1:0.00051%]
[INFO] ** proxy_src_ip:[18:38.0834%,20:26.09268%,13:18.25455%,6:17.56767%,17:0.00051%,11:0.00051%,1:0.00034%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:26.09199%,-0.32151:20.83403%,-1.27613:18.25404%,-0.23351:17.56733%,-0.33484:17.24937%,-71.33197:0.00051%,-1.27347:0.00034%,1.45709:0.00034%,-0.24151:0.00034%,1.47576:0.00017%,1.46509:0.00017%,3.6236699999999997:0.00017%,-1.2708:0.00017%,-2.48275:0.00017%,6.06224:0.00017%,-3.3787199999999995:0.00017%,8.10082:0.00017%,6.45955:0.00017%,-71.14931:0.00017%]
[INFO] ** scada_tag:[3:26.09165%,1:20.83386%,5:18.25387%,4:17.56716%,2:17.2492%,0:0.00426%]
[INFO] ** service:[0.0048200000000000005:99.9983%,-211.09762999999998:0.00051%,-211.73542999999998:0.00051%,-211.35747999999998:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.0834%,9:26.09268%,7:18.25455%,1:17.56767%,14:0.00051%,10:0.00051%,3:0.00034%,21:0.00017%,2:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1603 (0.27315%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2669 - tp: 73712.0000 - fp: 6288.0000 - tn: 313712.0000 - fn: 6288.0000 - accuracy: 0.9686 - precision: 0.9214 - recall: 0.9214 - auc: 0.9509 - val_loss: 5.4581e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.6317 - tp: 52048.0000 - fp: 27952.0000 - tn: 292048.0000 - fn: 27952.0000 - accuracy: 0.8602 - precision: 0.6506 - recall: 0.6506 - auc: 0.7816 - val_loss: 6.1152 - val_tp: 12412.0000 - val_fp: 7588.0000 - val_tn: 72412.0000 - val_fn: 7588.0000 - val_accuracy: 0.8482 - val_precision: 0.6206 - val_recall: 0.6206 - val_auc: 0.7629
[INFO] saving weights to checkpoints/lstm-epoch-7-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.1388 - tp: 49531.0000 - fp: 30469.0000 - tn: 289531.0000 - fn: 30469.0000 - accuracy: 0.8477 - precision: 0.6191 - recall: 0.6191 - auc: 0.7620 - val_loss: 6.1007 - val_tp: 12430.0000 - val_fp: 7570.0000 - val_tn: 72430.0000 - val_fn: 7570.0000 - val_accuracy: 0.8486 - val_precision: 0.6215 - val_recall: 0.6215 - val_auc: 0.7634
[INFO] saving weights to checkpoints/lstm-epoch-7-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.7184 - tp: 56581.0000 - fp: 23419.0000 - tn: 296581.0000 - fn: 23419.0000 - accuracy: 0.8829 - precision: 0.7073 - recall: 0.7073 - auc: 0.8170 - val_loss: 3.8781e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.8103e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5603e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/586862
[33m[INFO] loading file 19-19/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (586862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (586862, 17)

[INFO] analyzing data
[INFO] 586862 rows
[INFO] ** appi_name:[21:99.99813%,26:0.00034%,0:0.00034%,31:0.00017%,27:0.00017%,24:0.00017%,22:0.00017%,16:0.00017%,15:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:87.80633%,Single Stage Multi Point:12.19367%]
[INFO] ** dst:[21:43.38874%,10:20.82943%,8:18.20769%,9:17.57159%,22:0.00119%,6:0.00051%,25:0.00034%,24:0.00017%,18:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99813%,-33.760870000000004:0.0017%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99813%,0:0.0017%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.16719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99881%,2:0.00119%]
[INFO] ** proxy_src_ip:[18:38.11782%,20:26.10051%,13:18.20769%,6:17.57159%,10:0.00102%,11:0.00085%,16:0.00051%]
[INFO] ** s_port:[1.45442:26.09949%,-0.32151:20.82943%,-1.27613:18.20735%,-0.23351:17.57142%,-0.33484:17.28839%,-5.20264:0.00068%,1.45709:0.00051%,-1.02014:0.00051%,-64.19493:0.00034%,-71.14798:0.00034%,1.46509:0.00034%,-1.27347:0.00017%,-0.24151:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,-71.14931:0.00017%,-68.79874000000001:0.00017%,0.75578:0.00017%]
[INFO] ** scada_tag:[3:26.09915%,1:20.82926%,5:18.20718%,4:17.57125%,2:17.28822%,0:0.00494%]
[INFO] ** service:[0.0048200000000000005:99.99881%,-211.08346:0.00034%,-186.44547:0.00034%,-202.75898:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.11782%,9:26.10051%,7:18.20769%,1:17.57159%,11:0.00102%,10:0.00085%,15:0.00051%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1605 (0.27349%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.2340e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1382e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.0468e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8419e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.7493e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5680e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.4634e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3863e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.6327 - tp: 37153.0000 - fp: 42847.0000 - tn: 277153.0000 - fn: 42847.0000 - accuracy: 0.7858 - precision: 0.4644 - recall: 0.4644 - auc: 0.6653 - val_loss: 9.8474 - val_tp: 7781.0000 - val_fp: 12219.0000 - val_tn: 67781.0000 - val_fn: 12219.0000 - val_accuracy: 0.7556 - val_precision: 0.3891 - val_recall: 0.3891 - val_auc: 0.6182
[INFO] saving weights to checkpoints/lstm-epoch-7-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/586862
[33m[INFO] loading file 20-20/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (586862, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (586862, 17)

[INFO] analyzing data
[INFO] 586862 rows
[INFO] ** appi_name:[21:99.99676%,30:0.00273%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:90.20673%,Single Stage Multi Point:9.79327%]
[INFO] ** dst:[21:43.42827%,10:20.83659%,8:18.15418%,9:17.57619%,15:0.00273%,22:0.00119%,24:0.00034%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99761%,0:0.00239%]
[INFO] ** i/f_name:[2:99.99727%,3:0.00273%]
[INFO] ** modbus_function_code:[0.02961:99.99676%,-33.760870000000004:0.00324%]
[INFO] ** modbus_function_description:[7:49.99966%,11:49.9971%,0:0.00324%]
[INFO] ** modbus_transaction_id:65536 (11.16719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99676%,1:0.00273%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.11595%,20:26.14959%,13:18.15435%,6:17.5767%,17:0.00273%,14:0.00051%,16:0.00017%]
[INFO] ** s_port:[1.45442:26.14874%,-0.32151:20.83659%,-1.27613:18.15384%,-0.23351:17.57602%,-0.33484:17.27936%,-71.33197:0.00273%,1.45709:0.00051%,-0.24151:0.00051%,-1.27347:0.00034%,13.431270000000001:0.00017%,-1.2708:0.00017%,-1.02014:0.00017%,-71.14798:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:26.14823%,1:20.83641%,5:18.15384%,4:17.57568%,2:17.27919%,0:0.00665%]
[INFO] ** service:[0.0048200000000000005:99.99676%,-211.73542999999998:0.00273%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.11595%,9:26.14959%,7:18.15435%,1:17.5767%,14:0.00273%,2:0.00051%,15:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1604 (0.27332%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.3231 - tp: 63506.0000 - fp: 16494.0000 - tn: 303506.0000 - fn: 16494.0000 - accuracy: 0.9175 - precision: 0.7938 - recall: 0.7938 - auc: 0.8711 - val_loss: 1.9039e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3064 - tp: 73516.0000 - fp: 6484.0000 - tn: 313516.0000 - fn: 6484.0000 - accuracy: 0.9676 - precision: 0.9190 - recall: 0.9190 - auc: 0.9493 - val_loss: 2.9561 - val_tp: 16332.0000 - val_fp: 3668.0000 - val_tn: 76332.0000 - val_fn: 3668.0000 - val_accuracy: 0.9266 - val_precision: 0.8166 - val_recall: 0.8166 - val_auc: 0.8854
[INFO] saving weights to checkpoints/lstm-epoch-7-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9452 - tp: 65382.0000 - fp: 14618.0000 - tn: 305382.0000 - fn: 14618.0000 - accuracy: 0.9269 - precision: 0.8173 - recall: 0.8173 - auc: 0.8858 - val_loss: 2.9585 - val_tp: 16329.0000 - val_fp: 3671.0000 - val_tn: 76329.0000 - val_fn: 3671.0000 - val_accuracy: 0.9266 - val_precision: 0.8164 - val_recall: 0.8164 - val_auc: 0.8853
[INFO] saving weights to checkpoints/lstm-epoch-7-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.5261 - tp: 67462.0000 - fp: 12538.0000 - tn: 307462.0000 - fn: 12538.0000 - accuracy: 0.9373 - precision: 0.8433 - recall: 0.8433 - auc: 0.9020 - val_loss: 1.6237e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/586862
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5337e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3941e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/586862
[33m[INFO] loading file 21-21/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (586860, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (586860, 17)

[INFO] analyzing data
[INFO] 586860 rows
[INFO] ** appi_name:[21:99.99625%,30:0.00102%,7:0.00051%,26:0.00034%,22:0.00034%,0:0.00034%,31:0.00017%,27:0.00017%,24:0.00017%,16:0.00017%,15:0.00017%,8:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:98.96006%,Multi Stage Single Point:1.03994%]
[INFO] ** dst:[21:43.32686%,10:20.97638%,8:18.16055%,9:17.53161%,15:0.00102%,22:0.00085%,24:0.00068%,6:0.00068%,25:0.00034%,16:0.00034%,2:0.00034%,18:0.00017%,7:0.00017%]
[INFO] ** i/f_dir:[1:99.99898%,0:0.00102%]
[INFO] ** i/f_name:[2:99.99898%,3:0.00102%]
[INFO] ** modbus_function_code:[0.02961:99.99625%,-33.760870000000004:0.00358%,0.9188299999999999:0.00017%]
[INFO] ** modbus_function_description:[7:49.99915%,11:49.9971%,0:0.00358%,15:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.16723%)
[INFO] ** orig:[0:99.99932%,2:0.00068%]
[INFO] ** proto:[0:99.99761%,2:0.00136%,1:0.00102%]
[INFO] ** proxy_src_ip:[18:38.30624%,20:25.99683%,13:18.16123%,6:17.53144%,17:0.00102%,10:0.00102%,11:0.00085%,16:0.00051%,1:0.00034%,21:0.00017%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.99615%,-0.32151:20.9757%,-1.27613:18.16038%,-0.23351:17.53127%,-0.33484:17.33054%,-71.33197:0.00102%,-1.27347:0.00068%,-6.64392:0.00068%,-1.02014:0.00051%,-64.19493:0.00034%,-71.14931:0.00034%,-71.14798:0.00034%,1.47576:0.00034%,1.46509:0.00017%,-1.2708:0.00017%,6.62488:0.00017%,10.15141:0.00017%,-68.79874000000001:0.00017%,7.060860000000001:0.00017%,-3.3787199999999995:0.00017%,-2.2440900000000004:0.00017%,1.45709:0.00017%,-0.24151:0.00017%]
[INFO] ** scada_tag:[3:25.99564%,1:20.97553%,5:18.16021%,4:17.53093%,2:17.33054%,0:0.00716%]
[INFO] ** service:[0.0048200000000000005:99.99693%,-211.73542999999998:0.00102%,-211.09762999999998:0.00051%,-211.08346:0.00034%,-186.44547:0.00034%,-211.08818:0.00034%,-211.35747999999998:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.30624%,9:25.99683%,7:18.16123%,1:17.53144%,11:0.00102%,21:0.00085%,10:0.00085%,15:0.00051%,14:0.00034%,3:0.00034%,4:0.00017%,2:0.00017%]
[INFO] ** type:[0:99.99983%,2:0.00017%]
[INFO] ** unixtime:1599 (0.27247%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/586860
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3015e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2764e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/586860
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2073e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1364e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/586860
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0669e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0261e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/586860
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.5233e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.9824e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/586860
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.5623e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.9607e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/586860
[33m[INFO] loading file 22-22/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (355901, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (355901, 17)

[INFO] analyzing data
[INFO] 355901 rows
[INFO] ** appi_name:[21:99.99269%,30:0.00646%,23:0.00028%,22:0.00028%,18:0.00028%]
[INFO] ** classification:[normal:62.75593%,Multi Stage Single Point:37.24407%]
[INFO] ** dst:[21:43.31851%,10:21.00612%,8:18.09717%,9:17.56977%,15:0.00646%,22:0.00112%,19:0.00056%,26:0.00028%]
[INFO] ** i/f_dir:[1:99.99382%,0:0.00618%]
[INFO] ** i/f_name:[2:99.99354%,3:0.00618%,0:0.00028%]
[INFO] ** modbus_function_code:[0.02961:99.99269%,-33.760870000000004:0.00731%]
[INFO] ** modbus_function_description:[7:49.99705%,11:49.99564%,0:0.00731%]
[INFO] ** modbus_transaction_id:65534 (18.41355%)
[INFO] ** orig:[0:99.99494%,2:0.0045%,1:0.00056%]
[INFO] ** proto:[0:99.99326%,1:0.00646%,2:0.00028%]
[INFO] ** proxy_src_ip:[18:38.33313%,20:25.99234%,13:18.09661%,6:17.57062%,17:0.00646%,14:0.00056%,10:0.00028%]
[INFO] ** s_port:[1.45442:25.9915%,-0.32151:21.00612%,-1.27613:18.09661%,-0.23351:17.56977%,-0.33484:17.32701%,-71.33197:0.00646%,1.45709:0.00056%,-0.24151:0.00056%,7.228860000000001:0.00056%,-0.24950999999999998:0.00028%,1.46509:0.00028%,-71.14931:0.00028%]
[INFO] ** scada_tag:[3:25.99122%,1:21.00612%,5:18.09661%,4:17.56949%,2:17.32701%,0:0.00955%]
[INFO] ** service:[0.0048200000000000005:99.99269%,-211.73542999999998:0.00646%,-211.07873999999998:0.00056%,-211.08818:0.00028%]
[INFO] ** src:[22:38.33313%,9:25.99234%,7:18.09661%,1:17.57062%,21:0.0045%,14:0.00197%,2:0.00056%,11:0.00028%]
[INFO] ** type:[0:99.99831%,1:0.00169%]
[INFO] ** unixtime:983 (0.2762%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/355901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.5817 - tp: 77113.0000 - fp: 2887.0000 - tn: 317113.0000 - fn: 2887.0000 - accuracy: 0.9856 - precision: 0.9639 - recall: 0.9639 - auc: 0.9774 - val_loss: 7.5513 - val_tp: 10630.0000 - val_fp: 9370.0000 - val_tn: 70630.0000 - val_fn: 9370.0000 - val_accuracy: 0.8126 - val_precision: 0.5315 - val_recall: 0.5315 - val_auc: 0.7072
[INFO] saving weights to checkpoints/lstm-epoch-7-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/355901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5660 - tp: 42447.0000 - fp: 37553.0000 - tn: 282447.0000 - fn: 37553.0000 - accuracy: 0.8122 - precision: 0.5306 - recall: 0.5306 - auc: 0.7066 - val_loss: 7.5666 - val_tp: 10611.0000 - val_fp: 9389.0000 - val_tn: 70611.0000 - val_fn: 9389.0000 - val_accuracy: 0.8122 - val_precision: 0.5306 - val_recall: 0.5306 - val_auc: 0.7066
[INFO] saving weights to checkpoints/lstm-epoch-7-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/355901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5997 - tp: 42280.0000 - fp: 37720.0000 - tn: 282280.0000 - fn: 37720.0000 - accuracy: 0.8114 - precision: 0.5285 - recall: 0.5285 - auc: 0.7053 - val_loss: 7.5634 - val_tp: 10615.0000 - val_fp: 9385.0000 - val_tn: 70615.0000 - val_fn: 9385.0000 - val_accuracy: 0.8123 - val_precision: 0.5307 - val_recall: 0.5307 - val_auc: 0.7067
[INFO] saving weights to checkpoints/lstm-epoch-7-files-21-22-batch-200000-300000
[INFO] processing batch 300000-400000/355901
[33m[INFO] loading file 23-23/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555901, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555901, 17)

[INFO] analyzing data
[INFO] 555901 rows
[INFO] ** appi_name:[21:99.99874%,30:0.00054%,31:0.00036%,33:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:93.65301%,Multi Stage Single Point:6.34699%]
[INFO] ** dst:[21:43.32714%,10:21.00032%,8:18.14028%,9:17.52974%,22:0.00108%,15:0.00054%,24:0.00036%,18:0.00036%,25:0.00018%]
[INFO] ** i/f_dir:[1:99.99946%,0:0.00054%]
[INFO] ** i/f_name:[2:99.99946%,3:0.00054%]
[INFO] ** modbus_function_code:[0.02961:99.99874%,-33.760870000000004:0.00126%]
[INFO] ** modbus_function_description:[7:50.00027%,11:49.99847%,0:0.00126%]
[INFO] ** modbus_transaction_id:65536 (11.78915%)
[INFO] ** orig:[0:99.99964%,2:0.00036%]
[INFO] ** proto:[0:99.99892%,2:0.00054%,1:0.00054%]
[INFO] ** proxy_src_ip:[18:38.34028%,20:25.98754%,13:18.14046%,6:17.52992%,17:0.00054%,16:0.00054%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.98682%,-0.32151:21.00014%,-1.27613:18.13992%,-0.23351:17.52956%,-0.33484:17.34014%,-71.33197:0.00054%,-1.02014:0.00054%,-0.08551:0.00036%,-1.27347:0.00036%,1.45709:0.00036%,-0.24151:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,1.46509:0.00018%,-64.19493:0.00018%,-0.24950999999999998:0.00018%,-49.275529999999996:0.00018%]
[INFO] ** scada_tag:[3:25.98646%,1:21.00014%,5:18.13974%,4:17.52938%,2:17.33996%,0:0.00432%]
[INFO] ** service:[0.0048200000000000005:99.99892%,-211.73542999999998:0.00054%,-186.43601999999998:0.00036%,-186.44547:0.00018%]
[INFO] ** src:[22:38.34028%,9:25.98754%,7:18.14046%,1:17.52992%,15:0.00054%,21:0.00036%,17:0.00018%,14:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1513 (0.27217%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.1087 - tp: 44717.0000 - fp: 35283.0000 - tn: 284717.0000 - fn: 35283.0000 - accuracy: 0.8236 - precision: 0.5590 - recall: 0.5590 - auc: 0.7244 - val_loss: 5.1990e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.9885e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.6182e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.4919e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.4544e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.9992e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7791e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.6968e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6173e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/555901
[33m[INFO] loading file 24-24/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555901, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555901, 17)

[INFO] analyzing data
[INFO] 555901 rows
[INFO] ** appi_name:[21:99.99334%,30:0.00324%,26:0.00054%,31:0.00036%,27:0.00036%,22:0.00036%,0:0.00036%,24:0.00018%,23:0.00018%,19:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,11:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:95.41645%,Multi Stage Single Point:4.58355%]
[INFO] ** dst:[21:43.36617%,10:21.01903%,8:18.10124%,9:17.50653%,15:0.00324%,22:0.00108%,6:0.00072%,25:0.00036%,24:0.00036%,19:0.00036%,18:0.00036%,7:0.00036%,26:0.00018%]
[INFO] ** i/f_dir:[1:99.99694%,0:0.00306%]
[INFO] ** i/f_name:[2:99.99676%,3:0.00324%]
[INFO] ** modbus_function_code:[0.02961:99.99334%,-33.760870000000004:0.00612%,-0.415:0.00018%,0.9188299999999999:0.00018%,0.47422:0.00018%]
[INFO] ** modbus_function_description:[7:49.99775%,11:49.99559%,0:0.00612%,15:0.00018%,10:0.00018%,2:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.78915%)
[INFO] ** orig:[0:99.99964%,1:0.00036%]
[INFO] ** proto:[0:99.99478%,1:0.00324%,2:0.00198%]
[INFO] ** proxy_src_ip:[18:38.39874%,20:25.98718%,13:18.10106%,6:17.50599%,17:0.00324%,10:0.00126%,14:0.0009%,11:0.0009%,21:0.00036%,16:0.00036%]
[INFO] ** s_port:[1.45442:25.98646%,-0.32151:21.01903%,-1.27613:18.1007%,-0.23351:17.50528%,-0.33484:17.37971%,-71.33197:0.00324%,-9.58113:0.00072%,-71.14798:0.00054%,-0.24950999999999998:0.00036%,-1.27347:0.00036%,1.45709:0.00036%,-0.24151:0.00036%,-1.02014:0.00036%,-31.55091:0.00036%,7.6315100000000005:0.00036%,-71.14931:0.00036%,-64.19493:0.00036%,-68.79874000000001:0.00018%,1.46509:0.00018%,7.4901800000000005:0.00018%,13.431270000000001:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:25.98628%,1:21.01903%,5:18.10053%,4:17.50492%,2:17.37953%,0:0.00971%]
[INFO] ** service:[0.0048200000000000005:99.99442%,-211.73542999999998:0.00324%,-211.08346:0.00054%,-211.07873999999998:0.00036%,-202.75898:0.00036%,-186.44547:0.00036%,-186.43601999999998:0.00036%,-211.08818:0.00036%]
[INFO] ** src:[22:38.39874%,9:25.98718%,7:18.10106%,1:17.50599%,14:0.00324%,11:0.00126%,10:0.0009%,2:0.0009%,15:0.00036%,4:0.00036%]
[INFO] ** type:[0:99.99874%,1:0.0009%,2:0.00036%]
[INFO] ** unixtime:1510 (0.27163%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.3548e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2671e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.2458e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1284e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.0402e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8898e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.0009e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8763e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6649e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5558 - val_tp: 14347.0000 - val_fp: 5653.0000 - val_tn: 74347.0000 - val_fn: 5653.0000 - val_accuracy: 0.8869 - val_precision: 0.7174 - val_recall: 0.7174 - val_auc: 0.8233
[INFO] saving weights to checkpoints/lstm-epoch-7-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/555901
[33m[INFO] loading file 25-25/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555901, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555901, 17)

[INFO] analyzing data
[INFO] 555901 rows
[INFO] ** appi_name:[21:99.9964%,30:0.00108%,17:0.00072%,22:0.00054%,31:0.00036%,28:0.00018%,26:0.00018%,12:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** classification:[normal:64.35408%,Multi Stage Single Point:35.64592%]
[INFO] ** dst:[21:43.32444%,10:21.02533%,8:18.13326%,9:17.51265%,15:0.00108%,22:0.0009%,16:0.00072%,6:0.00072%,18:0.00036%,17:0.00036%,24:0.00018%]
[INFO] ** i/f_dir:[1:99.99892%,0:0.00108%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.9964%,-33.760870000000004:0.0036%]
[INFO] ** modbus_function_description:[7:49.99901%,11:49.99739%,0:0.0036%]
[INFO] ** modbus_transaction_id:65536 (11.78915%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99784%,2:0.00108%,1:0.00108%]
[INFO] ** proxy_src_ip:[18:38.39047%,20:25.95912%,13:18.13326%,6:17.51319%,17:0.00108%,1:0.0009%,21:0.00072%,16:0.00036%,14:0.00036%,7:0.00036%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95876%,-0.32151:21.02497%,-1.27613:18.1329%,-0.23351:17.51265%,-0.33484:17.3655%,-71.33197:0.00108%,-71.14931:0.00054%,-0.24151:0.00036%,-1.02014:0.00036%,-49.275529999999996:0.00036%,1.46509:0.00018%,-5.1466400000000005:0.00018%,-1.27347:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,-0.24950999999999998:0.00018%,2.52505:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,6.1115699999999995:0.00018%,-5.08665:0.00018%,1.45709:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:25.9584%,1:21.02479%,5:18.13273%,4:17.51247%,2:17.36532%,0:0.0063%]
[INFO] ** service:[0.0048200000000000005:99.99676%,-211.73542999999998:0.00108%,-205.44247:0.00072%,-211.08818:0.00054%,-186.43601999999998:0.00036%,-211.09762999999998:0.00018%,-211.08346:0.00018%,-185.9872:0.00018%]
[INFO] ** src:[22:38.39047%,9:25.95912%,7:18.13326%,1:17.51319%,14:0.00108%,3:0.0009%,4:0.00072%,21:0.00036%,15:0.00036%,2:0.00036%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1510 (0.27163%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7312 - tp: 51554.0000 - fp: 28446.0000 - tn: 291554.0000 - fn: 28446.0000 - accuracy: 0.8578 - precision: 0.6444 - recall: 0.6444 - auc: 0.7778 - val_loss: 5.7566 - val_tp: 12857.0000 - val_fp: 7143.0000 - val_tn: 72857.0000 - val_fn: 7143.0000 - val_accuracy: 0.8571 - val_precision: 0.6428 - val_recall: 0.6428 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-7-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7525 - tp: 51448.0000 - fp: 28552.0000 - tn: 291448.0000 - fn: 28552.0000 - accuracy: 0.8572 - precision: 0.6431 - recall: 0.6431 - auc: 0.7769 - val_loss: 5.7380 - val_tp: 12880.0000 - val_fp: 7120.0000 - val_tn: 72880.0000 - val_fn: 7120.0000 - val_accuracy: 0.8576 - val_precision: 0.6440 - val_recall: 0.6440 - val_auc: 0.7775
[INFO] saving weights to checkpoints/lstm-epoch-7-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7449 - tp: 51486.0000 - fp: 28514.0000 - tn: 291486.0000 - fn: 28514.0000 - accuracy: 0.8574 - precision: 0.6436 - recall: 0.6436 - auc: 0.7772 - val_loss: 5.7477 - val_tp: 12868.0000 - val_fp: 7132.0000 - val_tn: 72868.0000 - val_fn: 7132.0000 - val_accuracy: 0.8574 - val_precision: 0.6434 - val_recall: 0.6434 - val_auc: 0.7771
[INFO] saving weights to checkpoints/lstm-epoch-7-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7423 - tp: 51499.0000 - fp: 28501.0000 - tn: 291499.0000 - fn: 28501.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.7773 - val_loss: 5.7598 - val_tp: 12853.0000 - val_fp: 7147.0000 - val_tn: 72853.0000 - val_fn: 7147.0000 - val_accuracy: 0.8571 - val_precision: 0.6427 - val_recall: 0.6427 - val_auc: 0.7767
[INFO] saving weights to checkpoints/lstm-epoch-7-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7570 - tp: 51426.0000 - fp: 28574.0000 - tn: 291426.0000 - fn: 28574.0000 - accuracy: 0.8571 - precision: 0.6428 - recall: 0.6428 - auc: 0.7768 - val_loss: 5.7139 - val_tp: 12910.0000 - val_fp: 7090.0000 - val_tn: 72910.0000 - val_fn: 7090.0000 - val_accuracy: 0.8582 - val_precision: 0.6455 - val_recall: 0.6455 - val_auc: 0.7784
[INFO] saving weights to checkpoints/lstm-epoch-7-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/555901
[33m[INFO] loading file 26-26/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555901, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555901, 17)

[INFO] analyzing data
[INFO] 555901 rows
[INFO] ** appi_name:[21:99.99856%,7:0.00054%,31:0.00018%,30:0.00018%,22:0.00018%,12:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:64.3951%,Single Stage Single Point:28.7303%,Multi Stage Single Point:6.87461%]
[INFO] ** dst:[21:43.31023%,10:21.08289%,8:18.12337%,9:17.48117%,22:0.00072%,24:0.00036%,16:0.00036%,2:0.00036%,18:0.00018%,15:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99982%,0:0.00018%]
[INFO] ** i/f_name:[2:99.99982%,3:0.00018%]
[INFO] ** modbus_function_code:[0.02961:99.99856%,-33.760870000000004:0.00144%]
[INFO] ** modbus_function_description:[7:49.99991%,11:49.99865%,0:0.00144%]
[INFO] ** modbus_transaction_id:65536 (11.78915%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99946%,2:0.00036%,1:0.00018%]
[INFO] ** proxy_src_ip:[18:38.46314%,20:25.93016%,13:18.12373%,6:17.48117%,1:0.00054%,21:0.00036%,16:0.00036%,17:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.92962%,-0.32151:21.08271%,-1.27613:18.12319%,-0.23351:17.48099%,-0.33484:17.38043%,-1.27347:0.00036%,-1.02014:0.00036%,7.66617:0.00018%,-71.14931:0.00018%,11.57001:0.00018%,-3.3787199999999995:0.00018%,2.52505:0.00018%,-0.24151:0.00018%,-1.2708:0.00018%,1.45709:0.00018%,-49.275529999999996:0.00018%,1.47576:0.00018%,1.46509:0.00018%,14.191239999999999:0.00018%,-71.33197:0.00018%]
[INFO] ** scada_tag:[3:25.92926%,1:21.08271%,5:18.12319%,4:17.48081%,2:17.38043%,0:0.0036%]
[INFO] ** service:[0.0048200000000000005:99.99874%,-211.09762999999998:0.00054%,-211.35747999999998:0.00018%,-211.73542999999998:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.46314%,9:25.93016%,7:18.12373%,1:17.48117%,3:0.00054%,15:0.00036%,4:0.00036%,21:0.00018%,14:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1509 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.7431 - tp: 51495.0000 - fp: 28505.0000 - tn: 291495.0000 - fn: 28505.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.7773 - val_loss: 5.7380 - val_tp: 12880.0000 - val_fp: 7120.0000 - val_tn: 72880.0000 - val_fn: 7120.0000 - val_accuracy: 0.8576 - val_precision: 0.6440 - val_recall: 0.6440 - val_auc: 0.7775
[INFO] saving weights to checkpoints/lstm-epoch-7-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.7906 - tp: 75022.0000 - fp: 4978.0000 - tn: 315022.0000 - fn: 4978.0000 - accuracy: 0.9751 - precision: 0.9378 - recall: 0.9378 - auc: 0.9657 - val_loss: 4.7287e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.1413e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3858e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9811e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6517e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/555901
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4664e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2500e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/555901
[33m[INFO] loading file 27-27/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (496031, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (496031, 17)

[INFO] analyzing data
[INFO] 496031 rows
[INFO] ** appi_name:[21:99.9994%,30:0.0006%]
[INFO] ** classification:[normal:64.35122%,Single Stage Single Point:35.64878%]
[INFO] ** dst:[21:43.28056%,10:21.06884%,8:18.1789%,9:17.47008%,22:0.00081%,15:0.0006%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.9998%,0:0.0002%]
[INFO] ** i/f_name:[2:99.9994%,3:0.0006%]
[INFO] ** modbus_function_code:[0.02961:99.9994%,-33.760870000000004:0.0006%]
[INFO] ** modbus_function_description:[7:50.0003%,11:49.99909%,0:0.0006%]
[INFO] ** modbus_transaction_id:65536 (13.21208%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9994%,1:0.0006%]
[INFO] ** proxy_src_ip:[18:38.42199%,20:25.92802%,13:18.1787%,6:17.47028%,17:0.0006%,16:0.0004%]
[INFO] ** s_port:[1.45442:25.92741%,-0.32151:21.06884%,-1.27613:18.1785%,-0.23351:17.46988%,-0.33484:17.35315%,-71.33197:0.0006%,-1.02014:0.0004%,-1.27347:0.0002%,1.45709:0.0002%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-0.24151:0.0002%]
[INFO] ** scada_tag:[3:25.92701%,1:21.06864%,5:18.1783%,4:17.46967%,2:17.35295%,0:0.00343%]
[INFO] ** service:[0.0048200000000000005:99.9994%,-211.73542999999998:0.0006%]
[INFO] ** src:[22:38.42199%,9:25.92802%,7:18.1787%,1:17.47028%,14:0.0006%,15:0.0004%]
[INFO] ** type:[0:99.9996%,1:0.0004%]
[INFO] ** unixtime:1347 (0.27156%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/496031
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.0250e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.9234e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/496031
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.3968e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4422e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/496031
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 6.4333e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.4723e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/496031
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.5201e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6931e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/496031
[33m[INFO] loading file 28-28/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (429947, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (429947, 17)

[INFO] analyzing data
[INFO] 429947 rows
[INFO] ** appi_name:[21:99.99302%,30:0.00163%,17:0.00116%,22:0.00093%,7:0.00093%,31:0.0007%,26:0.0007%,28:0.00023%,27:0.00023%,8:0.00023%,0:0.00023%]
[INFO] ** classification:[normal:64.32304%,Single Stage Single Point:35.67696%]
[INFO] ** dst:[21:43.28231%,10:21.03352%,8:18.19922%,9:17.4775%,6:0.00186%,16:0.00163%,18:0.00116%,15:0.0007%,22:0.00047%,17:0.00047%,2:0.00047%,25:0.00023%,7:0.00023%,0:0.00023%]
[INFO] ** i/f_dir:[1:99.9993%,0:0.0007%]
[INFO] ** i/f_name:[2:99.9993%,3:0.0007%]
[INFO] ** modbus_function_code:[0.02961:99.99302%,-33.760870000000004:0.00698%]
[INFO] ** modbus_function_description:[11:49.99663%,7:49.99639%,0:0.00698%]
[INFO] ** modbus_transaction_id:65536 (15.24281%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99581%,2:0.00349%,1:0.0007%]
[INFO] ** proxy_src_ip:[18:38.35333%,20:25.9625%,13:18.19945%,6:17.47774%,1:0.00186%,17:0.00163%,14:0.0014%,7:0.00116%,21:0.0007%,0:0.00023%]
[INFO] ** s_port:[1.45442:25.96227%,-0.32151:21.03352%,-1.27613:18.19922%,-0.23351:17.47727%,-0.33484:17.31981%,-71.14798:0.00093%,-71.14931:0.00093%,-71.33197:0.0007%,-0.08551:0.00047%,-0.24151:0.00047%,7.66617:0.00023%,-58.035180000000004:0.00023%,-1.2708:0.00023%,-64.19493:0.00023%,-5.1466400000000005:0.00023%,13.431270000000001:0.00023%,11.57001:0.00023%,14.4699:0.00023%,1.47576:0.00023%,14.191239999999999:0.00023%,-5.08665:0.00023%,10.192739999999999:0.00023%,-3.3787199999999995:0.00023%,6.1115699999999995:0.00023%,2.05573:0.00023%,-43.76509:0.00023%,2.52505:0.00023%,11.862:0.00023%,-58.032509999999995:0.00023%]
[INFO] ** scada_tag:[3:25.96204%,1:21.03329%,5:18.19922%,4:17.47681%,2:17.31981%,0:0.00884%]
[INFO] ** service:[0.0048200000000000005:99.99302%,-205.44247:0.00116%,-186.43601999999998:0.00116%,-211.09762999999998:0.00093%,-211.08346:0.00093%,-211.08818:0.00093%,-211.73542999999998:0.0007%,-186.44547:0.00023%,-183.8612:0.00023%,-185.9872:0.00023%,-211.35747999999998:0.00023%,-202.75898:0.00023%]
[INFO] ** src:[22:38.35333%,9:25.9625%,7:18.19945%,1:17.47774%,3:0.00209%,2:0.0014%,21:0.00116%,4:0.00093%,14:0.0007%,8:0.00047%,17:0.00023%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1168 (0.27166%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/429947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.8668e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8823e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/429947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.3244e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0475e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/429947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0080e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7369e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/429947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6921e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5119e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-27-28-batch-300000-400000
[INFO] processing batch 400000-500000/429947
[33m[INFO] loading file 29-29/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529947, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529947, 17)

[INFO] analyzing data
[INFO] 529947 rows
[INFO] ** appi_name:[21:99.99887%,30:0.00057%,26:0.00019%,9:0.00019%,3:0.00019%]
[INFO] ** classification:[normal:64.38851%,Single Stage Single Point:35.61149%]
[INFO] ** dst:[21:43.32509%,10:21.06211%,8:18.14748%,9:17.46363%,22:0.00057%,15:0.00057%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99887%,-33.760870000000004:0.00113%]
[INFO] ** modbus_function_description:[7:49.99991%,11:49.99896%,0:0.00113%]
[INFO] ** modbus_transaction_id:65536 (12.36652%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99925%,1:0.00057%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.43988%,20:25.9475%,13:18.14785%,6:17.46344%,17:0.00057%,21:0.00019%,16:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.94693%,-0.32151:21.06192%,-1.27613:18.14748%,-0.23351:17.46344%,-0.33484:17.37796%,-71.33197:0.00057%,1.45709:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,-61.95768:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,14.4699:0.00019%]
[INFO] ** scada_tag:[3:25.94656%,1:21.06173%,5:18.14748%,4:17.46307%,2:17.37796%,0:0.00321%]
[INFO] ** service:[0.0048200000000000005:99.99906%,-211.73542999999998:0.00057%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.43988%,9:25.9475%,7:18.14785%,1:17.46344%,14:0.00057%,15:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1439 (0.27154%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0731e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1377e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0006e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.0855e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5014e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.9671e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.9036e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7825e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1490e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0961e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/529947
[33m[INFO] loading file 30-30/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529947, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529947, 17)

[INFO] analyzing data
[INFO] 529947 rows
[INFO] ** appi_name:[21:99.99755%,30:0.0017%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.36719%,Single Stage Single Point:35.63281%]
[INFO] ** dst:[21:43.33773%,10:21.02644%,8:18.14615%,9:17.48628%,15:0.0017%,22:0.00075%,24:0.00038%,25:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.9983%,0:0.0017%]
[INFO] ** i/f_name:[2:99.9983%,3:0.0017%]
[INFO] ** modbus_function_code:[0.02961:99.99755%,-33.760870000000004:0.00245%]
[INFO] ** modbus_function_description:[7:49.99972%,11:49.99783%,0:0.00245%]
[INFO] ** modbus_transaction_id:65536 (12.36652%)
[INFO] ** orig:[0:99.99906%,2:0.00057%,1:0.00038%]
[INFO] ** proto:[0:99.99792%,1:0.0017%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:38.36874%,20:25.99524%,13:18.14653%,6:17.48684%,17:0.0017%,7:0.00038%,16:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.99505%,-0.32151:21.02625%,-1.27613:18.14597%,-0.23351:17.48609%,-0.33484:17.34249%,-71.33197:0.0017%,-0.24151:0.00057%,-1.27347:0.00038%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-61.95768:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,10.192739999999999:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:25.99467%,1:21.02625%,5:18.14578%,4:17.4859%,2:17.3423%,0:0.00509%]
[INFO] ** service:[0.0048200000000000005:99.99774%,-211.73542999999998:0.0017%,-211.08346:0.00019%,-205.44247:0.00019%,-186.44547:0.00019%]
[INFO] ** src:[22:38.36874%,9:25.99524%,7:18.14653%,1:17.48684%,14:0.00113%,21:0.00094%,16:0.00019%,15:0.00019%,8:0.00019%]
[INFO] ** type:[0:99.99925%,1:0.00075%]
[INFO] ** unixtime:1441 (0.27191%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.2714e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.0765e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7066e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4704e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5079e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6580e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3597e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7126e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.6920e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7443e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/529947
[33m[INFO] loading file 31-31/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529947, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529947, 17)

[INFO] analyzing data
[INFO] 529947 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.37814%,Single Stage Single Point:35.62186%]
[INFO] ** dst:[21:43.32452%,10:21.05248%,8:18.12408%,9:17.4976%,22:0.00094%,24:0.00038%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.00009%,11:49.99991%]
[INFO] ** modbus_transaction_id:65536 (12.36652%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.3995%,20:25.97826%,13:18.12427%,6:17.4976%,16:0.00038%]
[INFO] ** s_port:[1.45442:25.9775%,-0.32151:21.05248%,-1.27613:18.12389%,-0.23351:17.49741%,-0.33484:17.34702%,-1.27347:0.00038%,1.45709:0.00038%,-1.02014:0.00038%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.97713%,1:21.05229%,5:18.1237%,4:17.49722%,2:17.34683%,0:0.00283%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.3995%,9:25.97826%,7:18.12427%,1:17.4976%,15:0.00038%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1440 (0.27173%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.9065e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0610e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.1142e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6309e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1004e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8766e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.2351e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2833e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9035e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6217e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/529947
[33m[INFO] loading file 32-32/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529947, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529947, 17)

[INFO] analyzing data
[INFO] 529947 rows
[INFO] ** appi_name:[21:99.99623%,30:0.00321%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.37172%,Single Stage Single Point:35.62828%]
[INFO] ** dst:[21:43.3198%,10:21.04701%,8:18.16634%,9:17.46193%,15:0.00321%,22:0.00094%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99717%,0:0.00283%]
[INFO] ** i/f_name:[2:99.99679%,3:0.00321%]
[INFO] ** modbus_function_code:[0.02961:99.99623%,-33.760870000000004:0.00377%]
[INFO] ** modbus_function_description:[7:49.99896%,11:49.99726%,0:0.00377%]
[INFO] ** modbus_transaction_id:65536 (12.36652%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99623%,1:0.00321%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.40724%,20:25.95995%,13:18.16634%,6:17.4625%,17:0.00321%,14:0.00057%,16:0.00019%]
[INFO] ** s_port:[1.45442:25.95939%,-0.32151:21.04701%,-1.27613:18.16597%,-0.23351:17.46175%,-0.33484:17.36023%,-71.33197:0.00321%,-0.24151:0.00057%,-1.2708:0.00019%,-1.02014:0.00019%,13.431270000000001:0.00019%,-71.14798:0.00019%,-1.27347:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,1.45709:0.00019%,11.862:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:25.95901%,1:21.04682%,5:18.16597%,4:17.46137%,2:17.36023%,0:0.0066%]
[INFO] ** service:[0.0048200000000000005:99.99623%,-211.73542999999998:0.00321%,-211.08346:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.40724%,9:25.95995%,7:18.16634%,1:17.4625%,14:0.00321%,2:0.00057%,15:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1438 (0.27135%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.5083e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0010 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-7-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.0959e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1950e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.4511e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8341e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.5191e-05 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.0137e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.6415e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8215e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/529947
[33m[INFO] loading file 33-33/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529947, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529947, 17)

[INFO] analyzing data
[INFO] 529947 rows
[INFO] ** appi_name:[21:99.99679%,30:0.00113%,17:0.00075%,22:0.00057%,31:0.00019%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.39852%,Single Stage Single Point:35.60148%]
[INFO] ** dst:[21:43.33698%,10:21.05663%,8:18.11106%,9:17.49043%,22:0.00132%,15:0.00113%,16:0.00075%,6:0.00075%,24:0.00038%,17:0.00038%,18:0.00019%]
[INFO] ** i/f_dir:[1:99.99887%,0:0.00113%]
[INFO] ** i/f_name:[2:99.99887%,3:0.00113%]
[INFO] ** modbus_function_code:[0.02961:99.99679%,-33.760870000000004:0.00321%]
[INFO] ** modbus_function_description:[7:49.99934%,11:49.99745%,0:0.00321%]
[INFO] ** modbus_transaction_id:65536 (12.36652%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99792%,1:0.00113%,2:0.00094%]
[INFO] ** proxy_src_ip:[18:38.42177%,20:25.9726%,13:18.11106%,6:17.49062%,17:0.00113%,16:0.00075%,1:0.00075%,21:0.00038%,14:0.00038%,7:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.97184%,-0.32151:21.05663%,-1.27613:18.11068%,-0.23351:17.49024%,-0.33484:17.36513%,-71.33197:0.00113%,-1.02014:0.00075%,-71.14931:0.00057%,1.45709:0.00038%,-1.27347:0.00038%,-5.08665:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-71.14798:0.00019%,-58.032509999999995:0.00019%,-58.035180000000004:0.00019%,-0.24151:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-5.1466400000000005:0.00019%]
[INFO] ** scada_tag:[3:25.97147%,1:21.05663%,5:18.11049%,4:17.49005%,2:17.36513%,0:0.00623%]
[INFO] ** service:[0.0048200000000000005:99.99679%,-211.73542999999998:0.00113%,-205.44247:0.00075%,-211.08818:0.00057%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.42177%,9:25.9726%,7:18.11106%,1:17.49062%,14:0.00113%,15:0.00075%,3:0.00075%,21:0.00038%,4:0.00038%,2:0.00038%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1441 (0.27191%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.8788e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6572e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.8991e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3529e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.5406e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2220e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1651e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8133e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/529947
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0641e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2091e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/529947
[33m[INFO] loading file 34-34/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (371380, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (371380, 17)

[INFO] analyzing data
[INFO] 371380 rows
[INFO] ** appi_name:[21:99.99731%,30:0.00081%,7:0.00081%,31:0.00027%,22:0.00027%,8:0.00027%,6:0.00027%]
[INFO] ** classification:[normal:64.33464%,Single Stage Single Point:35.66536%]
[INFO] ** dst:[21:43.27212%,10:21.05929%,8:18.20561%,9:17.45974%,22:0.00081%,15:0.00081%,16:0.00054%,2:0.00054%,18:0.00027%,6:0.00027%]
[INFO] ** i/f_dir:[1:99.99919%,0:0.00081%]
[INFO] ** i/f_name:[2:99.99919%,3:0.00081%]
[INFO] ** modbus_function_code:[0.02961:99.99731%,-33.760870000000004:0.00269%]
[INFO] ** modbus_function_description:[7:49.99919%,11:49.99812%,0:0.00269%]
[INFO] ** modbus_transaction_id:65536 (17.64662%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99865%,1:0.00081%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.38683%,20:25.94459%,13:18.20561%,6:17.46028%,17:0.00081%,1:0.00081%,21:0.00054%,14:0.00027%,7:0.00027%]
[INFO] ** s_port:[1.45442:25.94432%,-0.32151:21.05902%,-1.27613:18.20561%,-0.23351:17.45948%,-0.33484:17.3278%,-0.24151:0.00081%,-71.33197:0.00081%,-3.0613900000000003:0.00027%,-3.3787199999999995:0.00027%,14.191239999999999:0.00027%,1.47576:0.00027%,11.57001:0.00027%,-49.275529999999996:0.00027%,-71.14931:0.00027%,7.66617:0.00027%]
[INFO] ** scada_tag:[3:25.94405%,1:21.05875%,5:18.20534%,4:17.45894%,2:17.3278%,0:0.00512%]
[INFO] ** service:[0.0048200000000000005:99.99758%,-211.09762999999998:0.00081%,-211.73542999999998:0.00081%,-186.43601999999998:0.00027%,-211.35747999999998:0.00027%,-211.08818:0.00027%]
[INFO] ** src:[22:38.38683%,9:25.94459%,7:18.20561%,1:17.46028%,14:0.00081%,3:0.00081%,4:0.00054%,21:0.00027%,2:0.00027%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1009 (0.27169%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/371380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 9.3679e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7740e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/371380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2355e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6199e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/371380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.6834e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5767e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/371380
[33m[INFO] loading file 35-35/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571380, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571380, 17)

[INFO] analyzing data
[INFO] 571380 rows
[INFO] ** appi_name:[21:99.99895%,30:0.00105%]
[INFO] ** classification:[normal:64.3661%,Single Stage Single Point:35.6339%]
[INFO] ** dst:[21:43.32616%,10:21.03749%,8:18.15797%,9:17.47629%,22:0.00105%,15:0.00105%]
[INFO] ** i/f_dir:[1:99.99912%,0:0.00088%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.99895%,-33.760870000000004:0.00105%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99895%,0:0.00105%]
[INFO] ** modbus_transaction_id:65536 (11.46977%)
[INFO] ** orig:[0:99.99965%,1:0.00035%]
[INFO] ** proto:[0:99.99895%,1:0.00105%]
[INFO] ** proxy_src_ip:[18:38.39546%,20:25.96871%,13:18.15762%,6:17.47646%,17:0.00105%,16:0.0007%]
[INFO] ** s_port:[1.45442:25.96818%,-0.32151:21.03749%,-1.27613:18.15762%,-0.23351:17.47611%,-0.33484:17.35798%,-71.33197:0.00105%,-1.02014:0.0007%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.96783%,1:21.03749%,5:18.15744%,4:17.47576%,2:17.35798%,0:0.0035%]
[INFO] ** service:[0.0048200000000000005:99.99895%,-211.73542999999998:0.00105%]
[INFO] ** src:[22:38.39546%,9:25.96871%,7:18.15762%,1:17.47646%,14:0.00105%,15:0.0007%]
[INFO] ** type:[0:99.99912%,1:0.00088%]
[INFO] ** unixtime:1551 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2904e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.1676e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.4653e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3866e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5492e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0389e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.5614e-05 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.4178e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.2076e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.1117e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/571380
[33m[INFO] loading file 36-36/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571380, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571380, 17)

[INFO] analyzing data
[INFO] 571380 rows
[INFO] ** appi_name:[21:99.9986%,30:0.0007%,31:0.00035%,33:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.36277%,Single Stage Single Point:35.63723%]
[INFO] ** dst:[21:43.33106%,10:21.02944%,8:18.14939%,9:17.48766%,22:0.00088%,15:0.0007%,24:0.00035%,18:0.00035%,25:0.00018%]
[INFO] ** i/f_dir:[1:99.9993%,0:0.0007%]
[INFO] ** i/f_name:[2:99.9993%,3:0.0007%]
[INFO] ** modbus_function_code:[0.02961:99.9986%,-33.760870000000004:0.0014%]
[INFO] ** modbus_function_description:[7:50.00035%,11:49.99825%,0:0.0014%]
[INFO] ** modbus_transaction_id:65536 (11.46977%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99877%,1:0.0007%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.38024%,20:25.98043%,13:18.14957%,6:17.48819%,17:0.0007%,21:0.00018%,16:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.97991%,-0.32151:21.02926%,-1.27613:18.14904%,-0.23351:17.48749%,-0.33484:17.35097%,-71.33197:0.0007%,-0.24151:0.00053%,-0.08551:0.00035%,-1.27347:0.00035%,1.45709:0.00018%,1.47576:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,1.46509:0.00018%,-64.19493:0.00018%,-0.24950999999999998:0.00018%,-49.275529999999996:0.00018%]
[INFO] ** scada_tag:[3:25.97956%,1:21.02909%,5:18.14887%,4:17.48731%,2:17.3508%,0:0.00438%]
[INFO] ** service:[0.0048200000000000005:99.99877%,-211.73542999999998:0.0007%,-186.43601999999998:0.00035%,-186.44547:0.00018%]
[INFO] ** src:[22:38.38024%,9:25.98043%,7:18.14957%,1:17.48819%,14:0.0007%,17:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1552 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.4998e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.8774e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.8679e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.1619e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3188e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0493e-04 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.8633e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1818e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7326e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.6514e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/571380
[33m[INFO] loading file 37-37/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571380, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571380, 17)

[INFO] analyzing data
[INFO] 571380 rows
[INFO] ** appi_name:[21:99.99877%,30:0.0007%,33:0.00018%,26:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:64.37677%,Single Stage Single Point:35.62323%]
[INFO] ** dst:[21:43.33491%,10:21.03994%,8:18.13732%,9:17.48591%,22:0.0007%,15:0.0007%,24:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99965%,0:0.00035%]
[INFO] ** i/f_name:[2:99.9993%,3:0.0007%]
[INFO] ** modbus_function_code:[0.02961:99.99877%,-33.760870000000004:0.00123%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99877%,0:0.00123%]
[INFO] ** modbus_transaction_id:65536 (11.46977%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99912%,1:0.0007%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.38864%,20:25.98638%,13:18.13732%,6:17.48609%,17:0.0007%,21:0.00035%,16:0.00035%,1:0.00018%]
[INFO] ** s_port:[1.45442:25.98586%,-0.32151:21.03976%,-1.27613:18.13697%,-0.23351:17.48574%,-0.33484:17.34887%,-71.33197:0.0007%,-1.02014:0.00035%,1.46509:0.00018%,1.47576:0.00018%,-1.27347:0.00018%,-49.275529999999996:0.00018%,-0.24950999999999998:0.00018%,-0.24151:0.00018%,-1.2708:0.00018%,1.45709:0.00018%,14.4699:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:25.98568%,1:21.03976%,5:18.13679%,4:17.48556%,2:17.3487%,0:0.0035%]
[INFO] ** service:[0.0048200000000000005:99.99895%,-211.73542999999998:0.0007%,-183.8612:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.38864%,9:25.98638%,7:18.13732%,1:17.48609%,14:0.0007%,15:0.00035%,4:0.00035%,3:0.00018%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1552 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1402e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2499e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9528e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3979e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2697e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1345e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1588e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.5833e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.7810e-05 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.1538e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/571380
[33m[INFO] loading file 38-38/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571380, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571380, 17)

[INFO] analyzing data
[INFO] 571380 rows
[INFO] ** appi_name:[21:99.99895%,30:0.00035%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.40162%,Single Stage Single Point:35.59838%]
[INFO] ** dst:[21:43.31443%,10:21.08509%,8:18.10354%,9:17.49501%,22:0.00088%,15:0.00035%,25:0.00018%,24:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99982%,0:0.00018%]
[INFO] ** i/f_name:[2:99.99965%,3:0.00035%]
[INFO] ** modbus_function_code:[0.02961:99.99895%,-33.760870000000004:0.00105%]
[INFO] ** modbus_function_description:[7:49.99965%,11:49.9993%,0:0.00105%]
[INFO] ** modbus_transaction_id:65536 (11.46977%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9993%,2:0.00035%,1:0.00035%]
[INFO] ** proxy_src_ip:[18:38.44622%,20:25.95383%,13:18.10336%,6:17.49536%,17:0.00035%,7:0.00035%,16:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95313%,-0.32151:21.08492%,-1.27613:18.10319%,-0.23351:17.49484%,-0.33484:17.3613%,-0.24151:0.00035%,-71.33197:0.00035%,1.45709:0.00035%,1.47576:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-61.95768:0.00018%,-0.24950999999999998:0.00018%,-1.02014:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:25.95278%,1:21.08492%,5:18.10319%,4:17.49466%,2:17.3613%,0:0.00315%]
[INFO] ** service:[0.0048200000000000005:99.99912%,-211.73542999999998:0.00035%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.44622%,9:25.95383%,7:18.10336%,1:17.49536%,21:0.00035%,14:0.00035%,16:0.00018%,15:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1553 (0.2718%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8910e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3374e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6920e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4121e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.1839e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1671e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.8582e-05 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2783e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 9.3334e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.7606e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/571380
[33m[INFO] loading file 39-39/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571380, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571380, 17)

[INFO] analyzing data
[INFO] 571380 rows
[INFO] ** appi_name:[21:99.99965%,26:0.00018%,17:0.00018%]
[INFO] ** classification:[normal:64.39707%,Single Stage Single Point:35.60293%]
[INFO] ** dst:[21:43.31758%,10:21.07827%,8:18.13959%,9:17.46316%,22:0.00088%,24:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99965%,-33.760870000000004:0.00035%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99965%,0:0.00035%]
[INFO] ** modbus_transaction_id:65536 (11.46977%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.44237%,20:25.95383%,13:18.13977%,6:17.46316%,16:0.00053%,7:0.00035%]
[INFO] ** s_port:[1.45442:25.95331%,-0.32151:21.07827%,-1.27613:18.13942%,-0.23351:17.46298%,-0.33484:17.3641%,-1.02014:0.00053%,-71.14798:0.00018%,-1.27347:0.00018%,1.45709:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%]
[INFO] ** scada_tag:[3:25.95296%,1:21.07809%,5:18.13924%,4:17.46298%,2:17.36393%,0:0.0028%]
[INFO] ** service:[0.0048200000000000005:99.99965%,-211.08346:0.00018%,-205.44247:0.00018%]
[INFO] ** src:[22:38.44237%,9:25.95383%,7:18.13977%,1:17.46316%,15:0.00053%,21:0.00035%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1551 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3501e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5274e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7776e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.6045e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.0339e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.5141e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.1529e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6974e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.4930e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.1401e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/571380
[33m[INFO] loading file 40-40/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571380, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571380, 17)

[INFO] analyzing data
[INFO] 571380 rows
[INFO] ** appi_name:[21:99.9965%,30:0.00298%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.33267%,Single Stage Single Point:35.66733%]
[INFO] ** dst:[21:43.29115%,10:21.03679%,8:18.20015%,9:17.46736%,15:0.00298%,22:0.00088%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.9972%,0:0.0028%]
[INFO] ** i/f_name:[2:99.99702%,3:0.00298%]
[INFO] ** modbus_function_code:[0.02961:99.9965%,-33.760870000000004:0.0035%]
[INFO] ** modbus_function_description:[7:49.99912%,11:49.99737%,0:0.0035%]
[INFO] ** modbus_transaction_id:65536 (11.46977%)
[INFO] ** orig:[0:99.99965%,1:0.00035%]
[INFO] ** proto:[0:99.9965%,1:0.00298%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.35346%,20:25.97536%,13:18.19997%,6:17.46771%,17:0.00298%,14:0.00053%]
[INFO] ** s_port:[1.45442:25.97448%,-0.32151:21.03679%,-1.27613:18.1998%,-0.23351:17.46718%,-0.33484:17.31667%,-71.33197:0.00298%,1.45709:0.00053%,-0.24151:0.00035%,-71.14798:0.00018%,-1.27347:0.00018%,11.862:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,13.431270000000001:0.00018%]
[INFO] ** scada_tag:[3:25.97413%,1:21.03661%,5:18.19962%,4:17.46683%,2:17.3165%,0:0.0063%]
[INFO] ** service:[0.0048200000000000005:99.9965%,-211.73542999999998:0.00298%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.35346%,9:25.97536%,7:18.19997%,1:17.46771%,14:0.00298%,2:0.00053%]
[INFO] ** type:[0:99.99912%,1:0.00088%]
[INFO] ** unixtime:1554 (0.27197%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 6.1824e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.1239e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 8s - loss: 2.2534e-04 - tp: 79997.0000 - fp: 3.0000 - tn: 319997.0000 - fn: 3.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.6699e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 8s - loss: 3.4310e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.5371e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 2.1248e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.0309e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/571380
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 2.3312e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.6624e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/571380
[33m[INFO] loading file 41-41/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (511538, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (511538, 17)

[INFO] analyzing data
[INFO] 511538 rows
[INFO] ** appi_name:[21:99.99668%,30:0.00098%,22:0.00078%,17:0.00078%,32:0.0002%,28:0.0002%,26:0.0002%,7:0.0002%]
[INFO] ** classification:[normal:64.38994%,Single Stage Single Point:35.61006%]
[INFO] ** dst:[21:43.32503%,10:21.0608%,8:18.14352%,9:17.46635%,16:0.00098%,15:0.00098%,6:0.00098%,22:0.00059%,24:0.00039%,17:0.00039%]
[INFO] ** i/f_dir:[1:99.99902%,0:0.00098%]
[INFO] ** i/f_name:[2:99.99902%,3:0.00098%]
[INFO] ** modbus_function_code:[0.02961:99.99668%,-33.760870000000004:0.00332%]
[INFO] ** modbus_function_description:[7:49.99902%,11:49.99765%,0:0.00332%]
[INFO] ** modbus_transaction_id:65536 (12.81156%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99785%,2:0.00117%,1:0.00098%]
[INFO] ** proxy_src_ip:[18:38.43273%,20:25.9533%,13:18.14372%,6:17.46654%,17:0.00098%,1:0.00078%,21:0.00039%,16:0.00039%,14:0.00039%,0:0.00039%,7:0.0002%,2:0.0002%]
[INFO] ** s_port:[1.45442:25.95291%,-0.32151:21.0608%,-1.27613:18.14313%,-0.23351:17.46615%,-0.33484:17.37193%,-71.33197:0.00098%,-71.14931:0.00078%,-1.02014:0.00039%,-1.27347:0.00039%,-71.14798:0.0002%,-0.24151:0.0002%,-58.035180000000004:0.0002%,-1.2708:0.0002%,-5.1466400000000005:0.0002%,1.47576:0.0002%,1.46509:0.0002%,-64.19226:0.0002%,-5.08665:0.0002%,-0.24950999999999998:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** scada_tag:[3:25.95272%,1:21.0608%,5:18.14313%,4:17.46596%,2:17.37193%,0:0.00547%]
[INFO] ** service:[0.0048200000000000005:99.99668%,-211.73542999999998:0.00098%,-205.44247:0.00078%,-211.08818:0.00078%,89.64175:0.0002%,-211.09762999999998:0.0002%,-211.08346:0.0002%,-185.9872:0.0002%]
[INFO] ** src:[22:38.43273%,9:25.9533%,7:18.14372%,1:17.46654%,14:0.00098%,3:0.00078%,15:0.00039%,8:0.00039%,4:0.00039%,2:0.00039%,21:0.0002%,17:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1388 (0.27134%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/511538
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 6.3954e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2018e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/511538
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5661e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.3560e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/511538
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.4216e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5829e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/511538
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.4773e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2151e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/511538
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8036e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5264e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-40-41-batch-400000-500000
[INFO] processing batch 500000-600000/511538
[33m[INFO] loading file 42-42/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (355052, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (355052, 17)

[INFO] analyzing data
[INFO] 355052 rows
[INFO] ** appi_name:[21:99.99042%,30:0.00253%,17:0.00141%,31:0.00113%,26:0.00113%,7:0.00113%,22:0.00084%,28:0.00028%,27:0.00028%,9:0.00028%,8:0.00028%,0:0.00028%]
[INFO] ** classification:[normal:64.34748%,Single Stage Single Point:35.65252%]
[INFO] ** dst:[21:43.29873%,10:21.03861%,8:18.20043%,9:17.45181%,16:0.00253%,6:0.00225%,18:0.00141%,2:0.00113%,22:0.00084%,15:0.00084%,17:0.00056%,25:0.00028%,7:0.00028%,0:0.00028%]
[INFO] ** i/f_dir:[1:99.99916%,0:0.00084%]
[INFO] ** i/f_name:[2:99.99916%,3:0.00084%]
[INFO] ** modbus_function_code:[0.02961:99.99042%,-33.760870000000004:0.00958%]
[INFO] ** modbus_function_description:[7:49.99606%,11:49.99437%,0:0.00958%]
[INFO] ** modbus_transaction_id:65536 (18.45814%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99493%,2:0.00422%,1:0.00084%]
[INFO] ** proxy_src_ip:[18:38.38733%,20:25.95028%,13:18.20071%,6:17.45181%,17:0.00253%,1:0.00253%,14:0.00169%,21:0.00113%,7:0.00084%,0:0.00056%,16:0.00028%,2:0.00028%]
[INFO] ** s_port:[1.45442:25.94972%,-0.32151:21.03861%,-1.27613:18.20043%,-0.23351:17.45153%,-0.33484:17.34873%,-71.14931:0.00113%,-71.14798:0.00113%,-71.33197:0.00084%,-3.3787199999999995:0.00056%,-0.08551:0.00056%,11.57001:0.00056%,13.431270000000001:0.00028%,-5.1466400000000005:0.00028%,0.31847:0.00028%,-1.02014:0.00028%,-64.19493:0.00028%,-1.2708:0.00028%,-58.035180000000004:0.00028%,7.66617:0.00028%,-0.24151:0.00028%,1.47576:0.00028%,14.4699:0.00028%,15.912510000000001:0.00028%,14.191239999999999:0.00028%,7.9608300000000005:0.00028%,-5.08665:0.00028%,10.192739999999999:0.00028%,-3.0613900000000003:0.00028%,1.45709:0.00028%,2.05573:0.00028%,-43.76509:0.00028%,11.862:0.00028%,-58.032509999999995:0.00028%]
[INFO] ** scada_tag:[3:25.94944%,1:21.03861%,5:18.20015%,4:17.45153%,2:17.34844%,0:0.01183%]
[INFO] ** service:[0.0048200000000000005:99.99042%,-211.09762999999998:0.00197%,-205.44247:0.00141%,-186.43601999999998:0.00141%,-211.08346:0.00113%,-211.08818:0.00113%,-211.73542999999998:0.00084%,-211.35747999999998:0.00056%,-186.44547:0.00028%,-183.8612:0.00028%,-185.9872:0.00028%,-202.75898:0.00028%]
[INFO] ** src:[22:38.38733%,9:25.95028%,7:18.20071%,1:17.45181%,3:0.00338%,2:0.00197%,4:0.00141%,21:0.00113%,14:0.00084%,8:0.00056%,17:0.00028%,15:0.00028%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:964 (0.27151%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/355052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1577e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.6587e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/355052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.6776e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.8867e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/355052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.2375e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7018e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/355052
[33m[INFO] loading file 43-43/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555052, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555052, 17)

[INFO] analyzing data
[INFO] 555052 rows
[INFO] ** appi_name:[21:99.9991%,30:0.00054%,26:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.39649%,Single Stage Single Point:35.60351%]
[INFO] ** dst:[21:43.32639%,10:21.06812%,8:18.13434%,9:17.46899%,22:0.00108%,15:0.00054%,24:0.00018%,6:0.00018%,2:0.00018%]
[INFO] ** i/f_dir:[1:99.99982%,0:0.00018%]
[INFO] ** i/f_name:[2:99.99946%,3:0.00054%]
[INFO] ** modbus_function_code:[0.02961:99.9991%,-33.760870000000004:0.0009%]
[INFO] ** modbus_function_description:[7:50.00036%,11:49.99874%,0:0.0009%]
[INFO] ** modbus_transaction_id:65536 (11.80718%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99928%,1:0.00054%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.41514%,20:25.97991%,13:18.13452%,6:17.46917%,17:0.00054%,16:0.00036%,1:0.00036%]
[INFO] ** s_port:[1.45442:25.97919%,-0.32151:21.06812%,-1.27613:18.13416%,-0.23351:17.46863%,-0.33484:17.34702%,-71.33197:0.00054%,1.45709:0.00036%,1.47576:0.00036%,-0.24151:0.00036%,-1.02014:0.00036%,0.31847:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-1.2708:0.00018%]
[INFO] ** scada_tag:[3:25.97883%,1:21.06812%,5:18.13398%,4:17.46827%,2:17.34684%,0:0.00396%]
[INFO] ** service:[0.0048200000000000005:99.9991%,-211.73542999999998:0.00054%,-211.09762999999998:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.41514%,9:25.97991%,7:18.13452%,1:17.46917%,14:0.00054%,15:0.00036%,3:0.00036%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1509 (0.27187%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.1203e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0956e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.8822e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0955e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.8096e-05 - tp: 79997.0000 - fp: 3.0000 - tn: 319997.0000 - fn: 3.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2565e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.4083e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.8283e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.2225e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1886e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/555052
[33m[INFO] loading file 44-44/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555052, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555052, 17)

[INFO] analyzing data
[INFO] 555052 rows
[INFO] ** appi_name:[21:99.9982%,30:0.00072%,31:0.00054%,0:0.00036%,22:0.00018%]
[INFO] ** classification:[normal:64.3873%,Single Stage Single Point:35.6127%]
[INFO] ** dst:[21:43.3336%,10:21.05064%,8:18.15307%,9:17.45945%,22:0.00108%,15:0.00072%,18:0.00054%,25:0.00036%,24:0.00036%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99928%,0:0.00072%]
[INFO] ** i/f_name:[2:99.99928%,3:0.00072%]
[INFO] ** modbus_function_code:[0.02961:99.9982%,-33.760870000000004:0.0018%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99802%,0:0.0018%]
[INFO] ** modbus_transaction_id:65536 (11.80718%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9982%,2:0.00108%,1:0.00072%]
[INFO] ** proxy_src_ip:[18:38.43189%,20:25.95288%,13:18.15325%,6:17.45999%,17:0.00072%,7:0.00036%,16:0.00018%,5:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95216%,-0.32151:21.05064%,-1.27613:18.15271%,-0.23351:17.45927%,-0.33484:17.38125%,-71.33197:0.00072%,-0.24151:0.00054%,-0.08551:0.00036%,-64.19493:0.00036%,-1.27347:0.00036%,1.45709:0.00036%,-1.02014:0.00018%,-1.2708:0.00018%,1.47576:0.00018%,-71.14931:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,4.42897:0.00018%]
[INFO] ** scada_tag:[3:25.95162%,1:21.05064%,5:18.15271%,4:17.4589%,2:17.38107%,0:0.00504%]
[INFO] ** service:[0.0048200000000000005:99.9982%,-211.73542999999998:0.00072%,-186.43601999999998:0.00054%,-186.44547:0.00036%,-211.08818:0.00018%]
[INFO] ** src:[22:38.43189%,9:25.95288%,7:18.15325%,1:17.45999%,14:0.00072%,21:0.00036%,17:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1506 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.6380e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.7492e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3908e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.3032e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.0135e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.5343e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2238e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1185e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.7341e-05 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.2947e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/555052
[33m[INFO] loading file 45-45/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555052, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555052, 17)

[INFO] analyzing data
[INFO] 555052 rows
[INFO] ** appi_name:[21:99.99874%,30:0.00054%,31:0.00036%,26:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:64.41577%,Single Stage Single Point:35.58423%]
[INFO] ** dst:[21:43.32225%,10:21.09064%,8:18.12677%,9:17.45764%,22:0.00144%,15:0.00054%,18:0.00036%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99946%,3:0.00054%]
[INFO] ** modbus_function_code:[0.02961:99.99874%,-33.760870000000004:0.00126%]
[INFO] ** modbus_function_description:[7:50.00036%,11:49.99838%,0:0.00126%]
[INFO] ** modbus_transaction_id:65536 (11.80718%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99892%,2:0.00054%,1:0.00054%]
[INFO] ** proxy_src_ip:[18:38.48396%,20:25.92964%,13:18.12659%,6:17.45818%,17:0.00054%,16:0.00036%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.92892%,-0.32151:21.09064%,-1.27613:18.12659%,-0.23351:17.45746%,-0.33484:17.39333%,1.45709:0.00054%,-0.24151:0.00054%,-71.33197:0.00054%,-1.02014:0.00036%,-0.08551:0.00036%,-71.14798:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.92838%,1:21.09046%,5:18.12659%,4:17.45746%,2:17.39315%,0:0.00396%]
[INFO] ** service:[0.0048200000000000005:99.99874%,-211.73542999999998:0.00054%,-186.43601999999998:0.00036%,-183.8612:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.48396%,9:25.92964%,7:18.12659%,1:17.45818%,14:0.00054%,15:0.00036%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1506 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.2929e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.5122e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.2061e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.0509e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3018e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5719e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.3655e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.1559e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.0736e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9475e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/555052
[33m[INFO] loading file 46-46/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555052, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555052, 17)

[INFO] analyzing data
[INFO] 555052 rows
[INFO] ** appi_name:[21:99.9982%,30:0.00108%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.4273%,Single Stage Single Point:35.5727%]
[INFO] ** dst:[21:43.34693%,10:21.07766%,8:18.10101%,9:17.4717%,22:0.00108%,15:0.00108%,25:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.9991%,0:0.0009%]
[INFO] ** i/f_name:[2:99.99892%,3:0.00108%]
[INFO] ** modbus_function_code:[0.02961:99.9982%,-33.760870000000004:0.0018%]
[INFO] ** modbus_function_description:[11:49.9991%,7:49.9991%,0:0.0018%]
[INFO] ** modbus_transaction_id:65536 (11.80718%)
[INFO] ** orig:[0:99.99964%,1:0.00036%]
[INFO] ** proto:[0:99.99856%,1:0.00108%,2:0.00036%]
[INFO] ** proxy_src_ip:[18:38.45009%,20:25.9745%,13:18.10101%,6:17.47224%,17:0.00108%,16:0.00036%,7:0.00036%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.97414%,-0.32151:21.07748%,-1.27613:18.10083%,-0.23351:17.47152%,-0.33484:17.37261%,-71.33197:0.00108%,-0.24151:0.00054%,-1.02014:0.00036%,-71.14798:0.00018%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:25.97378%,1:21.0773%,5:18.10065%,4:17.47116%,2:17.37261%,0:0.0045%]
[INFO] ** service:[0.0048200000000000005:99.99838%,-211.73542999999998:0.00108%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.45009%,9:25.9745%,7:18.10101%,1:17.47224%,14:0.00108%,21:0.00036%,15:0.00036%,16:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.9991%,1:0.0009%]
[INFO] ** unixtime:1509 (0.27187%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.5588e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5732e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5986e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8146e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.5859e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4228e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3803e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9803e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1790e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3341e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/555052
[33m[INFO] loading file 47-47/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555052, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555052, 17)

[INFO] analyzing data
[INFO] 555052 rows
[INFO] ** appi_name:[21:99.99946%,33:0.00018%,26:0.00018%,17:0.00018%]
[INFO] ** classification:[normal:64.39775%,Single Stage Single Point:35.60225%]
[INFO] ** dst:[21:43.31054%,10:21.08523%,8:18.12569%,9:17.4762%,22:0.00162%,24:0.00036%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99946%,-33.760870000000004:0.00054%]
[INFO] ** modbus_function_description:[7:50.0009%,11:49.99856%,0:0.00054%]
[INFO] ** modbus_transaction_id:65536 (11.80718%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.4573%,20:25.93919%,13:18.12605%,6:17.47656%,16:0.00036%,7:0.00036%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.93829%,-0.32151:21.08523%,-1.27613:18.12551%,-0.23351:17.47602%,-0.33484:17.37207%,1.45709:0.00054%,-0.24151:0.00054%,-1.27347:0.00036%,-1.02014:0.00036%,-71.14798:0.00018%,-61.95635:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%]
[INFO] ** scada_tag:[3:25.93775%,1:21.08505%,5:18.12533%,4:17.47584%,2:17.37189%,0:0.00414%]
[INFO] ** service:[0.0048200000000000005:99.99964%,-211.08346:0.00018%,-205.44247:0.00018%]
[INFO] ** src:[22:38.4573%,9:25.93919%,7:18.12605%,1:17.47656%,21:0.00036%,15:0.00036%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1507 (0.27151%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3788e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.6057e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.2732e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.9557e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.8634e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.4686e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.2370e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.0164e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.8314e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.7807e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/555052
[33m[INFO] loading file 48-48/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555052, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555052, 17)

[INFO] analyzing data
[INFO] 555052 rows
[INFO] ** appi_name:[21:99.99676%,30:0.00252%,33:0.00018%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.42766%,Single Stage Single Point:35.57234%]
[INFO] ** dst:[21:43.33774%,10:21.08613%,8:18.10389%,9:17.46809%,15:0.00252%,22:0.0009%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99784%,0:0.00216%]
[INFO] ** i/f_name:[2:99.99748%,3:0.00252%]
[INFO] ** modbus_function_code:[0.02961:99.99676%,-33.760870000000004:0.00324%]
[INFO] ** modbus_function_description:[7:49.99892%,11:49.99784%,0:0.00324%]
[INFO] ** modbus_transaction_id:65536 (11.80718%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99694%,1:0.00252%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.46324%,20:25.96081%,13:18.10425%,6:17.46809%,17:0.00252%,14:0.00054%,16:0.00036%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.96045%,-0.32151:21.08613%,-1.27613:18.10389%,-0.23351:17.46791%,-0.33484:17.37711%,-71.33197:0.00252%,-1.02014:0.00036%,-71.14798:0.00018%,-1.27347:0.00018%,11.862:0.00018%,1.45709:0.00018%,-61.95635:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,13.431270000000001:0.00018%,-1.2708:0.00018%]
[INFO] ** scada_tag:[3:25.96009%,1:21.08613%,5:18.10389%,4:17.46791%,2:17.37693%,0:0.00504%]
[INFO] ** service:[0.0048200000000000005:99.99694%,-211.73542999999998:0.00252%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.46324%,9:25.96081%,7:18.10425%,1:17.46809%,14:0.00252%,2:0.00054%,15:0.00036%,8:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1506 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1638e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.4841e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.5875e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.0679e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.8158e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5745e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.5748e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2371e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1157e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.1161e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/555052
[33m[INFO] loading file 49-49/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (555052, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (555052, 17)

[INFO] analyzing data
[INFO] 555052 rows
[INFO] ** appi_name:[21:99.9973%,30:0.0009%,17:0.00072%,26:0.00036%,22:0.00036%,28:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.36802%,Single Stage Single Point:35.63198%]
[INFO] ** dst:[21:43.30892%,10:21.05496%,8:18.14064%,9:17.49115%,22:0.00126%,15:0.0009%,16:0.00072%,6:0.00072%,24:0.00036%,17:0.00036%]
[INFO] ** i/f_dir:[1:99.9991%,0:0.0009%]
[INFO] ** i/f_name:[2:99.9991%,3:0.0009%]
[INFO] ** modbus_function_code:[0.02961:99.9973%,-33.760870000000004:0.0027%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.99766%,0:0.0027%]
[INFO] ** modbus_transaction_id:65536 (11.80718%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99838%,1:0.0009%,2:0.00072%]
[INFO] ** proxy_src_ip:[18:38.4164%,20:25.94802%,13:18.14082%,6:17.49169%,17:0.0009%,1:0.00072%,14:0.00054%,21:0.00036%,16:0.00036%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.9473%,-0.32151:21.05496%,-1.27613:18.14028%,-0.23351:17.49097%,-0.33484:17.36144%,-71.33197:0.0009%,-0.24151:0.00054%,-71.14931:0.00036%,-1.02014:0.00036%,-1.27347:0.00036%,-71.14798:0.00036%,1.45709:0.00036%,1.47576:0.00018%,1.46509:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,-0.24950999999999998:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,-5.08665:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:25.94694%,1:21.05478%,5:18.1401%,4:17.49061%,2:17.36144%,0:0.00613%]
[INFO] ** service:[0.0048200000000000005:99.9973%,-211.73542999999998:0.0009%,-205.44247:0.00072%,-211.08346:0.00036%,-211.08818:0.00036%,-211.09762999999998:0.00018%,-185.9872:0.00018%]
[INFO] ** src:[22:38.4164%,9:25.94802%,7:18.14082%,1:17.49169%,14:0.0009%,3:0.00072%,2:0.00054%,15:0.00036%,4:0.00036%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1507 (0.27151%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.5367e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.3110e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8430e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6899e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0568e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.1214e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.0893e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.4473e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/555052
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.2186e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7541e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/555052
[33m[INFO] loading file 50-50/50 on epoch 7/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (405034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (405034, 17)

[INFO] analyzing data
[INFO] 405034 rows
[INFO] ** appi_name:[21:99.99753%,30:0.00099%,7:0.00074%,31:0.00025%,22:0.00025%,8:0.00025%]
[INFO] ** classification:[normal:64.31263%,Single Stage Single Point:35.68737%]
[INFO] ** dst:[21:43.26452%,10:21.04515%,8:18.21279%,9:17.47434%,15:0.00099%,22:0.00049%,16:0.00049%,2:0.00049%,24:0.00025%,18:0.00025%,6:0.00025%]
[INFO] ** i/f_dir:[1:99.99901%,0:0.00099%]
[INFO] ** i/f_name:[2:99.99901%,3:0.00099%]
[INFO] ** modbus_function_code:[0.02961:99.99753%,-33.760870000000004:0.00247%]
[INFO] ** modbus_function_description:[11:49.99901%,7:49.99852%,0:0.00247%]
[INFO] ** modbus_transaction_id:65536 (16.18037%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99852%,1:0.00099%,2:0.00049%]
[INFO] ** proxy_src_ip:[18:38.37382%,20:25.93609%,13:18.21304%,6:17.47434%,17:0.00099%,1:0.00074%,21:0.00025%,16:0.00025%,14:0.00025%,7:0.00025%]
[INFO] ** s_port:[1.45442:25.9356%,-0.32151:21.04515%,-1.27613:18.21255%,-0.23351:17.47434%,-0.33484:17.32867%,-71.33197:0.00099%,-3.3787199999999995:0.00025%,4.33564:0.00025%,15.912510000000001:0.00025%,7.9608300000000005:0.00025%,1.46509:0.00025%,1.45709:0.00025%,-1.27347:0.00025%,-71.14931:0.00025%,-1.02014:0.00025%,-1.2708:0.00025%,0.31847:0.00025%]
[INFO] ** scada_tag:[3:25.93535%,1:21.0449%,5:18.2123%,4:17.47434%,2:17.32842%,0:0.00469%]
[INFO] ** service:[0.0048200000000000005:99.99753%,-211.73542999999998:0.00099%,-211.09762999999998:0.00074%,-186.43601999999998:0.00025%,-211.35747999999998:0.00025%,-211.08818:0.00025%]
[INFO] ** src:[22:38.37382%,9:25.93609%,7:18.21304%,1:17.47434%,14:0.00099%,3:0.00074%,21:0.00025%,15:0.00025%,4:0.00025%,2:0.00025%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1101 (0.27183%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/405034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.6282e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.1928e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/405034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.9929e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2334e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/405034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.0240e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4076e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/405034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1030e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.9982e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-7-files-49-50-batch-300000-400000
[INFO] processing batch 400000-500000/405034
[33m[INFO] epoch 8/10[0m
[33m[INFO] loading file 1-1/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99287%,30:0.00119%,22:0.00099%,17:0.00079%,31:0.00059%,26:0.00059%,7:0.00059%,23:0.0004%,18:0.0004%,0:0.0004%,28:0.0002%,27:0.0002%,24:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** classification:[normal:79.14932%,Single Stage Single Point:20.85068%]
[INFO] ** dst:[21:43.26818%,10:21.04096%,8:18.16393%,9:17.51941%,6:0.00158%,16:0.00119%,15:0.00119%,22:0.00099%,18:0.00059%,26:0.0004%,25:0.0004%,19:0.0004%,17:0.0004%,24:0.0002%,7:0.0002%]
[INFO] ** i/f_dir:[1:99.99881%,0:0.00119%]
[INFO] ** i/f_name:[2:99.99881%,3:0.00119%]
[INFO] ** modbus_function_code:[0.02961:99.99287%,-33.760870000000004:0.00693%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.99743%,11:49.99545%,0:0.00693%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99604%,2:0.00277%,1:0.00119%]
[INFO] ** proxy_src_ip:[18:38.40652%,20:25.90202%,13:18.16412%,6:17.51981%,11:0.00139%,10:0.00139%,17:0.00119%,14:0.00099%,1:0.00099%,7:0.00059%,21:0.0004%,16:0.0004%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.90162%,-0.32151:21.04017%,-1.27613:18.16373%,-0.23351:17.51922%,-0.33484:17.36636%,-71.33197:0.00119%,-71.14931:0.00099%,-2.1481:0.00079%,-0.24151:0.00059%,-71.14798:0.00059%,-2.42942:0.0004%,4.44364:0.0004%,-1.02014:0.0004%,-64.19493:0.0004%,-5.1466400000000005:0.0002%,-1.2708:0.0002%,-58.035180000000004:0.0002%,4.076980000000001:0.0002%,-5.08665:0.0002%,1.47576:0.0002%,1.46509:0.0002%,4.29964:0.0002%,14.253910000000001:0.0002%,-68.79874000000001:0.0002%,6.1115699999999995:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,10.67005:0.0002%,-1.27347:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** scada_tag:[3:25.90142%,1:21.03997%,5:18.16353%,4:17.51902%,2:17.36616%,0:0.0099%]
[INFO] ** service:[0.0048200000000000005:99.99366%,-211.73542999999998:0.00119%,-211.08818:0.00099%,-205.44247:0.00079%,-211.07873999999998:0.00079%,-211.09762999999998:0.00059%,-211.08346:0.00059%,-186.43601999999998:0.00059%,-186.44547:0.0004%,-185.9872:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:38.40652%,9:25.90202%,7:18.16412%,1:17.51981%,11:0.00139%,10:0.00139%,14:0.00119%,3:0.00099%,2:0.00099%,21:0.00059%,15:0.0004%,4:0.0004%,8:0.0002%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** unixtime:1371 (0.27147%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1408 - tp: 78249.0000 - fp: 1751.0000 - tn: 318249.0000 - fn: 1751.0000 - accuracy: 0.9912 - precision: 0.9781 - recall: 0.9781 - auc: 0.9932 - val_loss: 3.7667e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5739e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.1571e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.1179e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.3361 - val_tp: 12747.0000 - val_fp: 7253.0000 - val_tn: 72747.0000 - val_fn: 7253.0000 - val_accuracy: 0.8549 - val_precision: 0.6374 - val_recall: 0.6374 - val_auc: 0.7733
[INFO] saving weights to checkpoints/lstm-epoch-8-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.4421 - tp: 72581.0000 - fp: 7419.0000 - tn: 312581.0000 - fn: 7419.0000 - accuracy: 0.9629 - precision: 0.9073 - recall: 0.9073 - auc: 0.9737 - val_loss: 0.0330 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0210 - tp: 79997.0000 - fp: 3.0000 - tn: 319997.0000 - fn: 3.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0130 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 2-2/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99881%,30:0.0004%,7:0.0004%,31:0.0002%,8:0.0002%]
[INFO] ** classification:[normal:72.58897%,Single Stage Single Point:27.41103%]
[INFO] ** dst:[21:43.31253%,10:21.03522%,8:18.13125%,9:17.51882%,22:0.00079%,15:0.0004%,2:0.0004%,24:0.0002%,18:0.0002%,16:0.0002%]
[INFO] ** i/f_dir:[1:99.9996%,0:0.0004%]
[INFO] ** i/f_name:[2:99.9996%,3:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.99881%,-33.760870000000004:0.00119%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.99901%,0:0.00119%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99941%,1:0.0004%,2:0.0002%]
[INFO] ** proxy_src_ip:[18:38.38613%,20:25.96201%,13:18.13145%,6:17.51902%,1:0.00059%,17:0.0004%,16:0.0002%,14:0.0002%]
[INFO] ** s_port:[1.45442:25.96142%,-0.32151:21.03522%,-1.27613:18.13106%,-0.23351:17.51862%,-0.33484:17.35091%,-71.33197:0.0004%,1.45709:0.0004%,-1.2708:0.0002%,-1.02014:0.0002%,-0.24151:0.0002%,4.076980000000001:0.0002%,12.60597:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,-3.3787199999999995:0.0002%,-0.24950999999999998:0.0002%,4.29964:0.0002%]
[INFO] ** scada_tag:[3:25.96102%,1:21.03522%,5:18.13106%,4:17.51842%,2:17.35071%,0:0.00356%]
[INFO] ** service:[0.0048200000000000005:99.99881%,-211.09762999999998:0.0004%,-211.73542999999998:0.0004%,-186.43601999999998:0.0002%,-211.35747999999998:0.0002%]
[INFO] ** src:[22:38.38613%,9:25.96201%,7:18.13145%,1:17.51902%,3:0.00059%,14:0.0004%,15:0.0002%,2:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1374 (0.27206%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0178 - tp: 79629.0000 - fp: 371.0000 - tn: 319629.0000 - fn: 371.0000 - accuracy: 0.9981 - precision: 0.9954 - recall: 0.9954 - auc: 0.9999 - val_loss: 0.0019 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3764 - tp: 63816.0000 - fp: 16184.0000 - tn: 303816.0000 - fn: 16184.0000 - accuracy: 0.9191 - precision: 0.7977 - recall: 0.7977 - auc: 0.9740 - val_loss: 0.2176 - val_tp: 19959.0000 - val_fp: 41.0000 - val_tn: 79959.0000 - val_fn: 41.0000 - val_accuracy: 0.9992 - val_precision: 0.9980 - val_recall: 0.9980 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.1935 - tp: 74800.0000 - fp: 5200.0000 - tn: 314800.0000 - fn: 5200.0000 - accuracy: 0.9740 - precision: 0.9350 - recall: 0.9350 - auc: 0.9923 - val_loss: 0.9429 - val_tp: 10576.0000 - val_fp: 9424.0000 - val_tn: 70576.0000 - val_fn: 9424.0000 - val_accuracy: 0.8115 - val_precision: 0.5288 - val_recall: 0.5288 - val_auc: 0.9445
[INFO] saving weights to checkpoints/lstm-epoch-8-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0316 - tp: 79005.0000 - fp: 995.0000 - tn: 319005.0000 - fn: 995.0000 - accuracy: 0.9950 - precision: 0.9876 - recall: 0.9876 - auc: 0.9999 - val_loss: 0.0048 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3803 - tp: 63791.0000 - fp: 16209.0000 - tn: 303791.0000 - fn: 16209.0000 - accuracy: 0.9190 - precision: 0.7974 - recall: 0.7974 - auc: 0.9746 - val_loss: 0.2650 - val_tp: 19922.0000 - val_fp: 78.0000 - val_tn: 79922.0000 - val_fn: 78.0000 - val_accuracy: 0.9984 - val_precision: 0.9961 - val_recall: 0.9961 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-8-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 3-3/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99089%,30:0.00238%,22:0.00119%,31:0.00099%,26:0.00099%,17:0.00099%,7:0.00079%,27:0.0004%,0:0.0004%,28:0.0002%,23:0.0002%,15:0.0002%,8:0.0002%,5:0.0002%]
[INFO] ** classification:[normal:86.84405%,Single Stage Single Point:13.15595%]
[INFO] ** dst:[21:43.30223%,10:21.09026%,8:18.15442%,9:17.44298%,6:0.00238%,15:0.00158%,18:0.00139%,16:0.00139%,22:0.00099%,2:0.0004%,7:0.0004%,25:0.0004%,17:0.0004%,12:0.0002%,24:0.0002%,19:0.0002%,0:0.0002%]
[INFO] ** i/f_dir:[1:99.99842%,0:0.00158%]
[INFO] ** i/f_name:[2:99.99842%,3:0.00158%]
[INFO] ** modbus_function_code:[0.02961:99.99089%,-33.760870000000004:0.00891%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.99604%,11:49.99485%,0:0.00891%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:99.99881%,2:0.00119%]
[INFO] ** proto:[0:99.99366%,2:0.00475%,1:0.00158%]
[INFO] ** proxy_src_ip:[18:38.41979%,20:25.9731%,13:18.15462%,6:17.44338%,17:0.00238%,1:0.00158%,14:0.00139%,7:0.00099%,11:0.00079%,10:0.00079%,21:0.00059%,16:0.0002%,15:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.97231%,-0.32151:21.09007%,-1.27613:18.15403%,-0.23351:17.44279%,-0.33484:17.32972%,-71.33197:0.00158%,-71.14798:0.00119%,-71.14931:0.00119%,-64.19493:0.0004%,-0.08551:0.0004%,1.45709:0.0004%,-0.24151:0.0004%,13.431270000000001:0.0002%,14.4699:0.0002%,4.076980000000001:0.0002%,-5.1466400000000005:0.0002%,-1.02014:0.0002%,1.47576:0.0002%,-1.2708:0.0002%,-58.035180000000004:0.0002%,-58.032509999999995:0.0002%,12.60597:0.0002%,-5.08665:0.0002%,1.46509:0.0002%,-2.1481:0.0002%,-1.27347:0.0002%,10.67005:0.0002%,-43.76509:0.0002%,2.05573:0.0002%,6.1115699999999995:0.0002%,4.44364:0.0002%,13.86459:0.0002%,4.29964:0.0002%,-0.24950999999999998:0.0002%,-3.3787199999999995:0.0002%,10.192739999999999:0.0002%,-68.79874000000001:0.0002%,14.253910000000001:0.0002%,4.90362:0.0002%,-68.36943000000001:0.0002%]
[INFO] ** scada_tag:[3:25.97191%,1:21.08987%,5:18.15383%,4:17.44259%,2:17.32953%,0:0.01228%]
[INFO] ** service:[0.0048200000000000005:99.99109%,-211.73542999999998:0.00158%,-186.43601999999998:0.00139%,-211.08346:0.00119%,-211.08818:0.00119%,-205.44247:0.00099%,-211.09762999999998:0.00079%,-186.44547:0.0004%,-202.75898:0.0004%,-183.8612:0.0002%,-185.9872:0.0002%,-201.23771000000002:0.0002%,-211.35747999999998:0.0002%,-211.07873999999998:0.0002%]
[INFO] ** src:[22:38.41979%,9:25.9731%,7:18.15462%,1:17.44338%,21:0.00218%,3:0.00178%,2:0.00139%,11:0.00079%,10:0.00079%,4:0.00079%,14:0.0004%,8:0.0004%,17:0.0002%,15:0.0002%,13:0.0002%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** unixtime:1371 (0.27147%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1500 - tp: 76045.0000 - fp: 3955.0000 - tn: 316045.0000 - fn: 3955.0000 - accuracy: 0.9802 - precision: 0.9506 - recall: 0.9506 - auc: 0.9955 - val_loss: 0.0477 - val_tp: 19996.0000 - val_fp: 4.0000 - val_tn: 79996.0000 - val_fn: 4.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3115 - tp: 66828.0000 - fp: 13172.0000 - tn: 306828.0000 - fn: 13172.0000 - accuracy: 0.9341 - precision: 0.8353 - recall: 0.8353 - auc: 0.9806 - val_loss: 0.5560 - val_tp: 10624.0000 - val_fp: 9376.0000 - val_tn: 70624.0000 - val_fn: 9376.0000 - val_accuracy: 0.8125 - val_precision: 0.5312 - val_recall: 0.5312 - val_auc: 0.9451
[INFO] saving weights to checkpoints/lstm-epoch-8-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0176 - tp: 78968.0000 - fp: 1032.0000 - tn: 318968.0000 - fn: 1032.0000 - accuracy: 0.9948 - precision: 0.9871 - recall: 0.9871 - auc: 0.9999 - val_loss: 2.0889e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9140e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8736e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6065e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4884e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 4-4/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99762%,30:0.00139%,31:0.0004%,33:0.0002%,26:0.0002%,9:0.0002%]
[INFO] ** classification:[normal:91.33128%,Single Stage Single Point:8.66872%]
[INFO] ** dst:[21:43.35807%,10:20.93522%,8:18.17363%,9:17.52951%,15:0.00139%,22:0.00119%,18:0.0004%,24:0.0002%,6:0.0002%,0:0.0002%]
[INFO] ** i/f_dir:[1:99.99881%,0:0.00119%]
[INFO] ** i/f_name:[2:99.99861%,3:0.00139%]
[INFO] ** modbus_function_code:[0.02961:99.99762%,-33.760870000000004:0.00238%]
[INFO] ** modbus_function_description:[7:49.9996%,11:49.99802%,0:0.00238%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:99.99881%,2:0.00119%]
[INFO] ** proto:[0:99.99802%,1:0.00139%,2:0.00059%]
[INFO] ** proxy_src_ip:[18:38.25208%,20:26.04161%,13:18.17363%,6:17.52991%,17:0.00139%,21:0.0004%,16:0.0004%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:26.04082%,-0.32151:20.93503%,-1.27613:18.17323%,-0.23351:17.52931%,-0.33484:17.31705%,-71.33197:0.00139%,1.45709:0.0004%,-0.24151:0.0004%,-1.02014:0.0004%,-0.08551:0.0004%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,14.4699:0.0002%,-49.275529999999996:0.0002%,-1.2708:0.0002%,-71.14798:0.0002%]
[INFO] ** scada_tag:[3:26.04062%,1:20.93483%,5:18.17323%,4:17.52892%,2:17.31685%,0:0.00554%]
[INFO] ** service:[0.0048200000000000005:99.99782%,-211.73542999999998:0.00139%,-186.43601999999998:0.0004%,-183.8612:0.0002%,-211.08346:0.0002%]
[INFO] ** src:[22:38.25208%,9:26.04161%,7:18.17363%,1:17.52991%,21:0.00119%,15:0.0004%,4:0.0004%,17:0.0002%,14:0.0002%,8:0.0002%,3:0.0002%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** unixtime:1382 (0.27364%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.3722e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2847e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.2228e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1592e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0894e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0207e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2875 - tp: 74603.0000 - fp: 5397.0000 - tn: 314603.0000 - fn: 5397.0000 - accuracy: 0.9730 - precision: 0.9325 - recall: 0.9325 - auc: 0.9812 - val_loss: 1.4093 - val_tp: 7790.0000 - val_fp: 12210.0000 - val_tn: 67790.0000 - val_fn: 12210.0000 - val_accuracy: 0.7558 - val_precision: 0.3895 - val_recall: 0.3895 - val_auc: 0.9035
[INFO] saving weights to checkpoints/lstm-epoch-8-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.4559 - tp: 55984.0000 - fp: 24016.0000 - tn: 295984.0000 - fn: 24016.0000 - accuracy: 0.8799 - precision: 0.6998 - recall: 0.6998 - auc: 0.9542 - val_loss: 0.5189 - val_tp: 8740.0000 - val_fp: 11260.0000 - val_tn: 68740.0000 - val_fn: 11260.0000 - val_accuracy: 0.7748 - val_precision: 0.4370 - val_recall: 0.4370 - val_auc: 0.9087
[INFO] saving weights to checkpoints/lstm-epoch-8-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 5-5/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99683%,30:0.00218%,37:0.0002%,26:0.0002%,12:0.0002%,6:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:88.84333%,Single Stage Single Point:11.15667%]
[INFO] ** dst:[21:43.36599%,10:20.76137%,8:18.24986%,9:17.61901%,15:0.00218%,22:0.00079%,25:0.0002%,24:0.0002%,6:0.0002%,2:0.0002%]
[INFO] ** i/f_dir:[1:99.99802%,0:0.00198%]
[INFO] ** i/f_name:[2:99.99782%,3:0.00218%]
[INFO] ** modbus_function_code:[0.02961:99.99683%,-33.760870000000004:0.00317%]
[INFO] ** modbus_function_description:[7:49.99881%,11:49.99802%,0:0.00317%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:99.99822%,2:0.00178%]
[INFO] ** proto:[0:99.99743%,1:0.00218%,2:0.0004%]
[INFO] ** proxy_src_ip:[18:37.98992%,20:26.13725%,13:18.25006%,6:17.61941%,17:0.00218%,21:0.0002%,16:0.0002%,7:0.0002%,5:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:26.13705%,-0.32151:20.76098%,-1.27613:18.24986%,-0.23351:17.61901%,-0.33484:17.22894%,-71.33197:0.00218%,-0.24151:0.0004%,-71.14798:0.0002%,-1.27347:0.0002%,1.45709:0.0002%,2.22906:0.0002%,-49.275529999999996:0.0002%,-61.95768:0.0002%,-1.02014:0.0002%,-64.19493:0.0002%]
[INFO] ** scada_tag:[3:26.13666%,1:20.76078%,5:18.24966%,4:17.61901%,2:17.22894%,0:0.00495%]
[INFO] ** service:[0.0048200000000000005:99.99723%,-211.73542999999998:0.00218%,-186.44547:0.0002%,-211.08346:0.0002%,-211.35747999999998:0.0002%]
[INFO] ** src:[22:37.98992%,9:26.13725%,7:18.25006%,1:17.61941%,21:0.00198%,14:0.0004%,16:0.0002%,15:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** unixtime:1380 (0.27325%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2684 - tp: 67653.0000 - fp: 12347.0000 - tn: 307653.0000 - fn: 12347.0000 - accuracy: 0.9383 - precision: 0.8457 - recall: 0.8457 - auc: 0.9863 - val_loss: 0.2099 - val_tp: 19788.0000 - val_fp: 212.0000 - val_tn: 79788.0000 - val_fn: 212.0000 - val_accuracy: 0.9958 - val_precision: 0.9894 - val_recall: 0.9894 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-8-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0130 - tp: 79995.0000 - fp: 5.0000 - tn: 319995.0000 - fn: 5.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 0.8308 - val_tp: 17595.0000 - val_fp: 2405.0000 - val_tn: 77595.0000 - val_fn: 2405.0000 - val_accuracy: 0.9519 - val_precision: 0.8798 - val_recall: 0.8798 - val_auc: 0.9207
[INFO] saving weights to checkpoints/lstm-epoch-8-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0916 - tp: 78330.0000 - fp: 1670.0000 - tn: 318330.0000 - fn: 1670.0000 - accuracy: 0.9916 - precision: 0.9791 - recall: 0.9791 - auc: 0.9946 - val_loss: 3.2275e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0963e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5334e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3258e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0889e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 6-6/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99545%,30:0.00356%,31:0.0002%,27:0.0002%,26:0.0002%,5:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:91.99955%,Single Stage Single Point:8.00045%]
[INFO] ** dst:[21:43.37589%,10:20.73187%,8:18.28669%,9:17.6004%,15:0.00356%,22:0.0004%,25:0.0002%,24:0.0002%,18:0.0002%,12:0.0002%,7:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99663%,0:0.00337%]
[INFO] ** i/f_name:[2:99.99644%,3:0.00356%]
[INFO] ** modbus_function_code:[0.02961:99.99545%,-33.760870000000004:0.00455%]
[INFO] ** modbus_function_description:[7:49.99822%,11:49.99723%,0:0.00455%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:99.9996%,1:0.0004%]
[INFO] ** proto:[0:99.99545%,1:0.00356%,2:0.00099%]
[INFO] ** proxy_src_ip:[18:37.94576%,20:26.1622%,13:18.28689%,6:17.6006%,17:0.00356%,14:0.00059%,16:0.0002%,11:0.0002%]
[INFO] ** s_port:[1.45442:26.1618%,-0.32151:20.73187%,-1.27613:18.28629%,-0.23351:17.6002%,-0.33484:17.21389%,-71.33197:0.00356%,-0.24151:0.0002%,-1.2708:0.0002%,-64.19493:0.0002%,-1.02014:0.0002%,13.431270000000001:0.0002%,4.90362:0.0002%,-71.14798:0.0002%,1.47576:0.0002%,1.46509:0.0002%,-0.24950999999999998:0.0002%,-1.27347:0.0002%,-68.36943000000001:0.0002%]
[INFO] ** scada_tag:[3:26.1616%,1:20.73167%,5:18.2861%,4:17.59981%,2:17.21369%,0:0.00713%]
[INFO] ** service:[0.0048200000000000005:99.99545%,-211.73542999999998:0.00356%,-186.44547:0.0002%,-211.08346:0.0002%,-186.43601999999998:0.0002%,-201.23771000000002:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:37.94576%,9:26.1622%,7:18.28689%,1:17.6006%,14:0.00356%,2:0.00059%,15:0.0002%,10:0.0002%]
[INFO] ** type:[0:99.99901%,1:0.00099%]
[INFO] ** unixtime:1383 (0.27384%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.9859e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.3466e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.2884e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.2862e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.6828e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.1265e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.3590e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2646 - val_tp: 17432.0000 - val_fp: 2568.0000 - val_tn: 77432.0000 - val_fn: 2568.0000 - val_accuracy: 0.9486 - val_precision: 0.8716 - val_recall: 0.8716 - val_auc: 0.9197
[INFO] saving weights to checkpoints/lstm-epoch-8-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2169 - tp: 77453.0000 - fp: 2547.0000 - tn: 317453.0000 - fn: 2547.0000 - accuracy: 0.9873 - precision: 0.9682 - recall: 0.9682 - auc: 0.9854 - val_loss: 0.0011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 7-7/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99525%,30:0.00139%,22:0.00099%,17:0.00079%,26:0.00059%,31:0.0004%,28:0.0002%,27:0.0002%,7:0.0002%]
[INFO] ** classification:[normal:82.5285%,Single Stage Single Point:17.4715%]
[INFO] ** dst:[21:43.35886%,10:20.75583%,8:18.24313%,9:17.63564%,6:0.00158%,22:0.00139%,15:0.00139%,16:0.00079%,24:0.0004%,18:0.0004%,17:0.0004%,7:0.0002%]
[INFO] ** i/f_dir:[1:99.99861%,0:0.00139%]
[INFO] ** i/f_name:[2:99.99861%,3:0.00139%]
[INFO] ** modbus_function_code:[0.02961:99.99525%,-33.760870000000004:0.00475%]
[INFO] ** modbus_function_description:[7:49.99842%,11:49.99683%,0:0.00475%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99644%,2:0.00218%,1:0.00139%]
[INFO] ** proxy_src_ip:[18:37.98378%,20:26.13171%,13:18.24352%,6:17.63584%,17:0.00139%,11:0.00079%,1:0.00079%,21:0.00059%,16:0.0004%,14:0.0004%,7:0.0004%,10:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:26.13072%,-0.32151:20.75583%,-1.27613:18.24293%,-0.23351:17.63545%,-0.33484:17.22795%,-71.33197:0.00139%,-71.14931:0.00099%,-71.14798:0.00059%,1.45709:0.00059%,-1.02014:0.0004%,-1.27347:0.0004%,-0.24151:0.0004%,-58.035180000000004:0.0002%,-1.2708:0.0002%,-5.1466400000000005:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-5.08665:0.0002%,14.253910000000001:0.0002%,-68.79874000000001:0.0002%,6.1115699999999995:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** scada_tag:[3:26.13032%,1:20.75583%,5:18.24293%,4:17.63525%,2:17.22795%,0:0.00772%]
[INFO] ** service:[0.0048200000000000005:99.99525%,-211.73542999999998:0.00139%,-211.08818:0.00099%,-205.44247:0.00079%,-211.08346:0.00059%,-186.43601999999998:0.0004%,-211.09762999999998:0.0002%,-185.9872:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:37.98378%,9:26.13171%,7:18.24352%,1:17.63584%,14:0.00139%,10:0.00079%,3:0.00079%,4:0.00059%,21:0.0004%,15:0.0004%,2:0.0004%,11:0.0002%,8:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1380 (0.27325%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0012 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.4640e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.1133e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1171e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.3035 - tp: 67189.0000 - fp: 12811.0000 - tn: 307189.0000 - fn: 12811.0000 - accuracy: 0.9359 - precision: 0.8399 - recall: 0.8399 - auc: 0.9818 - val_loss: 0.2979 - val_tp: 13121.0000 - val_fp: 6879.0000 - val_tn: 73121.0000 - val_fn: 6879.0000 - val_accuracy: 0.8624 - val_precision: 0.6561 - val_recall: 0.6561 - val_auc: 0.9685
[INFO] saving weights to checkpoints/lstm-epoch-8-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0125 - tp: 79579.0000 - fp: 421.0000 - tn: 319579.0000 - fn: 421.0000 - accuracy: 0.9979 - precision: 0.9947 - recall: 0.9947 - auc: 1.0000 - val_loss: 9.3865e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.0104e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.3157e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 8-8/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99703%,30:0.00099%,0:0.00059%,24:0.0002%,23:0.0002%,22:0.0002%,18:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** classification:[normal:94.34137%,Single Stage Single Point:5.65863%]
[INFO] ** dst:[21:43.4343%,10:20.81365%,8:18.16927%,9:17.57901%,22:0.00139%,15:0.00099%,25:0.00059%,19:0.0004%,26:0.0002%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.99941%,0:0.00059%]
[INFO] ** i/f_name:[2:99.99901%,3:0.00099%]
[INFO] ** modbus_function_code:[0.02961:99.99703%,-33.760870000000004:0.00277%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9996%,11:49.99743%,0:0.00277%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:99.9996%,2:0.0004%]
[INFO] ** proto:[0:99.99822%,1:0.00099%,2:0.00079%]
[INFO] ** proxy_src_ip:[18:38.1008%,20:26.14774%,13:18.16848%,6:17.57941%,10:0.00119%,17:0.00099%,16:0.00059%,14:0.0004%,11:0.0002%,5:0.0002%]
[INFO] ** s_port:[1.45442:26.14715%,-0.32151:20.81365%,-1.27613:18.16828%,-0.23351:17.57882%,-0.33484:17.28715%,-71.33197:0.00099%,-15.039579999999999:0.00079%,-1.02014:0.00059%,-64.19493:0.00059%,1.45709:0.0004%,-0.24151:0.0004%,4.66896:0.0004%,-1.27347:0.0002%,-0.24950999999999998:0.0002%,1.47576:0.0002%,-71.14931:0.0002%]
[INFO] ** scada_tag:[3:26.14675%,1:20.81345%,5:18.16828%,4:17.57862%,2:17.28695%,0:0.00594%]
[INFO] ** service:[0.0048200000000000005:99.99782%,-211.73542999999998:0.00099%,-186.44547:0.00059%,-211.07873999999998:0.0004%,-211.08818:0.0002%]
[INFO] ** src:[22:38.1008%,9:26.14774%,7:18.16848%,1:17.57941%,11:0.00119%,15:0.00059%,14:0.00059%,21:0.0004%,2:0.0004%,16:0.0002%,10:0.0002%]
[INFO] ** type:[0:99.99941%,1:0.0004%,2:0.0002%]
[INFO] ** unixtime:1384 (0.27404%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.1982e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5733e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9929e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4934e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1580e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8375e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1805 - tp: 73953.0000 - fp: 6047.0000 - tn: 313953.0000 - fn: 6047.0000 - accuracy: 0.9698 - precision: 0.9244 - recall: 0.9244 - auc: 0.9932 - val_loss: 0.1637 - val_tp: 16484.0000 - val_fp: 3516.0000 - val_tn: 76484.0000 - val_fn: 3516.0000 - val_accuracy: 0.9297 - val_precision: 0.8242 - val_recall: 0.8242 - val_auc: 0.9917
[INFO] saving weights to checkpoints/lstm-epoch-8-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0155 - tp: 79808.0000 - fp: 192.0000 - tn: 319808.0000 - fn: 192.0000 - accuracy: 0.9990 - precision: 0.9976 - recall: 0.9976 - auc: 1.0000 - val_loss: 0.0038 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 9-9/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99842%,30:0.00079%,31:0.0004%,26:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:95.96007%,Single Stage Single Point:4.03993%]
[INFO] ** dst:[21:43.36362%,10:20.76811%,8:18.29837%,9:17.56733%,22:0.00079%,15:0.00079%,18:0.0004%,25:0.0002%,24:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99921%,0:0.00079%]
[INFO] ** i/f_name:[2:99.99921%,3:0.00079%]
[INFO] ** modbus_function_code:[0.02961:99.99842%,-33.760870000000004:0.00158%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99842%,0:0.00158%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99842%,2:0.00079%,1:0.00079%]
[INFO] ** proxy_src_ip:[18:37.99863%,20:26.13369%,13:18.29857%,6:17.56753%,17:0.00079%,21:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:26.13289%,-0.32151:20.76811%,-1.27613:18.29817%,-0.23351:17.56713%,-0.33484:17.23052%,-71.33197:0.00079%,1.45709:0.0004%,-0.24151:0.0004%,-0.08551:0.0004%,-71.14798:0.0002%,-1.27347:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-64.19493:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:26.1325%,1:20.76811%,5:18.29817%,4:17.56694%,2:17.23052%,0:0.00376%]
[INFO] ** service:[0.0048200000000000005:99.99842%,-211.73542999999998:0.00079%,-186.43601999999998:0.0004%,-186.44547:0.0002%,-211.08346:0.0002%]
[INFO] ** src:[22:37.99863%,9:26.13369%,7:18.29857%,1:17.56753%,14:0.00079%,17:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1381 (0.27345%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0146 - tp: 79743.0000 - fp: 257.0000 - tn: 319743.0000 - fn: 257.0000 - accuracy: 0.9987 - precision: 0.9968 - recall: 0.9968 - auc: 0.9999 - val_loss: 0.0016 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0997 - tp: 77628.0000 - fp: 2372.0000 - tn: 317628.0000 - fn: 2372.0000 - accuracy: 0.9881 - precision: 0.9704 - recall: 0.9704 - auc: 0.9977 - val_loss: 0.0286 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0022 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2311e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4252e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.5799e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.8123e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.2574e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 10-10/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99644%,30:0.00198%,24:0.0002%,23:0.0002%,22:0.0002%,18:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:93.9511%,Single Stage Single Point:6.0489%]
[INFO] ** dst:[21:43.4147%,10:20.81206%,8:18.21917%,9:17.5503%,15:0.00198%,22:0.00059%,24:0.0004%,19:0.0004%,26:0.0002%,25:0.0002%]
[INFO] ** i/f_dir:[1:99.99822%,0:0.00178%]
[INFO] ** i/f_name:[2:99.99802%,3:0.00198%]
[INFO] ** modbus_function_code:[0.02961:99.99644%,-33.760870000000004:0.00337%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.99901%,11:49.99743%,0:0.00337%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:99.99921%,1:0.00079%]
[INFO] ** proto:[0:99.99762%,1:0.00198%,2:0.0004%]
[INFO] ** proxy_src_ip:[18:38.09843%,20:26.12874%,13:18.21937%,6:17.54971%,17:0.00198%,10:0.00099%,14:0.0004%,16:0.0002%,5:0.0002%]
[INFO] ** s_port:[1.45442:26.12814%,-0.32151:20.81206%,-1.27613:18.21877%,-0.23351:17.54931%,-0.33484:17.28636%,-71.33197:0.00198%,-10.51843:0.00079%,5.71692:0.0004%,-1.27347:0.0004%,1.46509:0.0002%,1.47576:0.0002%,-0.24950999999999998:0.0002%,1.45709:0.0002%,-0.24151:0.0002%,-71.14931:0.0002%,-1.02014:0.0002%,-64.19493:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:26.12775%,1:20.81187%,5:18.21877%,4:17.54912%,2:17.28616%,0:0.00634%]
[INFO] ** service:[0.0048200000000000005:99.99723%,-211.73542999999998:0.00198%,-211.07873999999998:0.0004%,-186.44547:0.0002%,-211.08818:0.0002%]
[INFO] ** src:[22:38.09843%,9:26.12874%,7:18.21937%,1:17.54971%,14:0.00198%,11:0.00099%,2:0.0004%,16:0.0002%,15:0.0002%]
[INFO] ** type:[0:99.99842%,1:0.00139%,2:0.0002%]
[INFO] ** unixtime:1380 (0.27325%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.2177e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8119e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.0570e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8112 - val_tp: 14586.0000 - val_fp: 5414.0000 - val_tn: 74586.0000 - val_fn: 5414.0000 - val_accuracy: 0.8917 - val_precision: 0.7293 - val_recall: 0.7293 - val_auc: 0.8308
[INFO] saving weights to checkpoints/lstm-epoch-8-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2577 - tp: 74827.0000 - fp: 5173.0000 - tn: 314827.0000 - fn: 5173.0000 - accuracy: 0.9741 - precision: 0.9353 - recall: 0.9353 - auc: 0.9872 - val_loss: 0.7531 - val_tp: 12820.0000 - val_fp: 7180.0000 - val_tn: 72820.0000 - val_fn: 7180.0000 - val_accuracy: 0.8564 - val_precision: 0.6410 - val_recall: 0.6410 - val_auc: 0.9678
[INFO] saving weights to checkpoints/lstm-epoch-8-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0371 - tp: 78555.0000 - fp: 1445.0000 - tn: 318555.0000 - fn: 1445.0000 - accuracy: 0.9928 - precision: 0.9819 - recall: 0.9819 - auc: 0.9998 - val_loss: 3.7161e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.5853e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7651e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 11-11/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99881%,31:0.0004%,30:0.0004%,26:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.38005%,10:20.87998%,8:18.20056%,9:17.53684%,22:0.00139%,18:0.0004%,15:0.0004%,25:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.9996%,0:0.0004%]
[INFO] ** i/f_name:[2:99.9996%,3:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.99881%,-33.760870000000004:0.00119%]
[INFO] ** modbus_function_description:[7:50.0004%,11:49.99842%,0:0.00119%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99881%,2:0.00079%,1:0.0004%]
[INFO] ** proxy_src_ip:[18:38.14733%,20:26.11329%,13:18.20036%,6:17.53724%,16:0.00059%,17:0.0004%,21:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:26.1127%,-0.32151:20.87998%,-1.27613:18.20036%,-0.23351:17.53664%,-0.33484:17.26735%,-0.24151:0.00059%,-1.02014:0.00059%,-0.08551:0.0004%,-71.33197:0.0004%,-71.14798:0.0002%,1.45709:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-64.19493:0.0002%]
[INFO] ** scada_tag:[3:26.1123%,1:20.87998%,5:18.20016%,4:17.53644%,2:17.26715%,0:0.00396%]
[INFO] ** service:[0.0048200000000000005:99.99881%,-211.73542999999998:0.0004%,-186.43601999999998:0.0004%,-186.44547:0.0002%,-211.08346:0.0002%]
[INFO] ** src:[22:38.14733%,9:26.11329%,7:18.20036%,1:17.53724%,15:0.00059%,14:0.0004%,17:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1381 (0.27345%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.5237e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1515e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 8s - loss: 9.4825e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.6703e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 6.8073e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.4416e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 4.7320e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7434e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 3.3049e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8373e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 12-12/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99762%,30:0.00218%,9:0.0002%]
[INFO] ** classification:[normal:92.83395%,Single Stage Single Point:7.16605%]
[INFO] ** dst:[21:43.38876%,10:20.87305%,8:18.19541%,9:17.53941%,15:0.00218%,22:0.00059%,24:0.0004%,0:0.0002%]
[INFO] ** i/f_dir:[1:99.99822%,0:0.00178%]
[INFO] ** i/f_name:[2:99.99782%,3:0.00218%]
[INFO] ** modbus_function_code:[0.02961:99.99762%,-33.760870000000004:0.00238%]
[INFO] ** modbus_function_description:[7:49.9996%,11:49.99802%,0:0.00238%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:99.99822%,2:0.00178%]
[INFO] ** proto:[0:99.99782%,1:0.00218%]
[INFO] ** proxy_src_ip:[18:38.13822%,20:26.12398%,13:18.19561%,6:17.53961%,17:0.00218%,16:0.0002%,1:0.0002%]
[INFO] ** s_port:[1.45442:26.12339%,-0.32151:20.87305%,-1.27613:18.19501%,-0.23351:17.53922%,-0.33484:17.26517%,-71.33197:0.00218%,-1.27347:0.0004%,1.45709:0.0002%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,14.4699:0.0002%,-0.24151:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:26.12299%,1:20.87305%,5:18.19501%,4:17.53882%,2:17.26517%,0:0.00495%]
[INFO] ** service:[0.0048200000000000005:99.99762%,-211.73542999999998:0.00218%,-183.8612:0.0002%]
[INFO] ** src:[22:38.13822%,9:26.12398%,7:18.19561%,1:17.53961%,21:0.00178%,14:0.0004%,15:0.0002%,3:0.0002%]
[INFO] ** type:[0:99.9996%,1:0.0004%]
[INFO] ** unixtime:1381 (0.27345%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3340e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0821e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7433e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.9158 - val_tp: 18489.0000 - val_fp: 1511.0000 - val_tn: 78489.0000 - val_fn: 1511.0000 - val_accuracy: 0.9698 - val_precision: 0.9244 - val_recall: 0.9244 - val_auc: 0.9528
[INFO] saving weights to checkpoints/lstm-epoch-8-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2036 - tp: 77579.0000 - fp: 2421.0000 - tn: 317579.0000 - fn: 2421.0000 - accuracy: 0.9879 - precision: 0.9697 - recall: 0.9697 - auc: 0.9871 - val_loss: 0.3206 - val_tp: 18924.0000 - val_fp: 1076.0000 - val_tn: 78924.0000 - val_fn: 1076.0000 - val_accuracy: 0.9785 - val_precision: 0.9462 - val_recall: 0.9462 - val_auc: 0.9665
[INFO] saving weights to checkpoints/lstm-epoch-8-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1061 - tp: 78005.0000 - fp: 1995.0000 - tn: 318005.0000 - fn: 1995.0000 - accuracy: 0.9900 - precision: 0.9751 - recall: 0.9751 - auc: 0.9959 - val_loss: 3.3493e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6475e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0216e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 13-13/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99624%,31:0.00079%,26:0.00059%,0:0.00059%,30:0.0004%,22:0.0004%,27:0.0002%,24:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** classification:[normal:84.84993%,Single Stage Single Point:15.15007%]
[INFO] ** dst:[21:43.36124%,10:20.80018%,8:18.27877%,9:17.55545%,22:0.00119%,6:0.00099%,18:0.00079%,25:0.00059%,15:0.0004%,24:0.0002%,7:0.0002%]
[INFO] ** i/f_dir:[1:99.9996%,0:0.0004%]
[INFO] ** i/f_name:[2:99.9996%,3:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.99624%,-33.760870000000004:0.00356%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.99881%,11:49.99743%,0:0.00356%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99703%,2:0.00257%,1:0.0004%]
[INFO] ** proxy_src_ip:[18:38.0515%,20:26.11032%,13:18.27897%,6:17.55486%,10:0.00119%,11:0.00099%,16:0.00059%,17:0.0004%,7:0.0004%,21:0.0002%,2:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:26.10973%,-0.32151:20.80018%,-1.27613:18.27857%,-0.23351:17.55446%,-0.33484:17.25131%,-9.78512:0.00079%,-71.14798:0.00059%,-64.19493:0.00059%,-1.02014:0.00059%,-0.08551:0.0004%,-71.14931:0.0004%,-0.24151:0.0004%,-71.33197:0.0004%,-1.27347:0.0002%,1.46509:0.0002%,-68.79874000000001:0.0002%,14.540560000000001:0.0002%,1.45709:0.0002%,-1.2708:0.0002%,6.1115699999999995:0.0002%,1.47576:0.0002%]
[INFO] ** scada_tag:[3:26.10933%,1:20.79999%,5:18.27857%,4:17.55446%,2:17.25112%,0:0.00653%]
[INFO] ** service:[0.0048200000000000005:99.99703%,-186.43601999999998:0.00079%,-186.44547:0.00059%,-211.08346:0.00059%,-211.73542999999998:0.0004%,-211.08818:0.0004%,-202.75898:0.0002%]
[INFO] ** src:[22:38.0515%,9:26.11032%,7:18.27897%,1:17.55486%,11:0.00119%,10:0.00099%,15:0.00059%,21:0.0004%,14:0.0004%,17:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** unixtime:1380 (0.27325%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5590e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3733e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1457e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0029e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.6458e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5871 - val_tp: 16864.0000 - val_fp: 3136.0000 - val_tn: 76864.0000 - val_fn: 3136.0000 - val_accuracy: 0.9373 - val_precision: 0.8432 - val_recall: 0.8432 - val_auc: 0.9020
[INFO] saving weights to checkpoints/lstm-epoch-8-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2319 - tp: 77214.0000 - fp: 2786.0000 - tn: 317214.0000 - fn: 2786.0000 - accuracy: 0.9861 - precision: 0.9652 - recall: 0.9652 - auc: 0.9837 - val_loss: 0.0048 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0031 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0022 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 14-14/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.9996%,30:0.0002%,9:0.0002%]
[INFO] ** classification:[normal:96.19234%,Single Stage Single Point:3.80766%]
[INFO] ** dst:[21:43.34441%,10:20.80929%,8:18.27204%,9:17.57268%,22:0.00079%,24:0.0004%,15:0.0002%,0:0.0002%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:99.9998%,3:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9996%,-33.760870000000004:0.0004%]
[INFO] ** modbus_function_description:[7:50.00059%,11:49.99901%,0:0.0004%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9998%,1:0.0002%]
[INFO] ** proxy_src_ip:[18:38.04635%,20:26.10795%,13:18.27224%,6:17.57288%,17:0.0002%,16:0.0002%,1:0.0002%]
[INFO] ** s_port:[1.45442:26.10715%,-0.32151:20.80929%,-1.27613:18.27164%,-0.23351:17.57248%,-0.33484:17.23706%,-1.27347:0.0004%,1.45709:0.0004%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,14.4699:0.0002%,-0.24151:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%,-71.33197:0.0002%]
[INFO] ** scada_tag:[3:26.10676%,1:20.80929%,5:18.27144%,4:17.57208%,2:17.23686%,0:0.00356%]
[INFO] ** service:[0.0048200000000000005:99.9996%,-183.8612:0.0002%,-211.73542999999998:0.0002%]
[INFO] ** src:[22:38.04635%,9:26.10795%,7:18.27224%,1:17.57288%,15:0.0002%,14:0.0002%,3:0.0002%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** unixtime:1380 (0.27325%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2594 - tp: 70188.0000 - fp: 9812.0000 - tn: 310188.0000 - fn: 9812.0000 - accuracy: 0.9509 - precision: 0.8773 - recall: 0.8773 - auc: 0.9879 - val_loss: 0.4126 - val_tp: 12794.0000 - val_fp: 7206.0000 - val_tn: 72794.0000 - val_fn: 7206.0000 - val_accuracy: 0.8559 - val_precision: 0.6397 - val_recall: 0.6397 - val_auc: 0.9675
[INFO] saving weights to checkpoints/lstm-epoch-8-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0278 - tp: 78799.0000 - fp: 1201.0000 - tn: 318799.0000 - fn: 1201.0000 - accuracy: 0.9940 - precision: 0.9850 - recall: 0.9850 - auc: 0.9999 - val_loss: 0.0020 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0014 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.4195e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.1582e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.4420e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.6243e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9257e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 15-15/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (505034, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (505034, 17)

[INFO] analyzing data
[INFO] 505034 rows
[INFO] ** appi_name:[21:99.99604%,30:0.00317%,26:0.0002%,17:0.0002%,12:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:89.0641%,Single Stage Multi Point:10.93511%,Single Stage Single Point:0.00079%]
[INFO] ** dst:[21:43.2953%,10:20.76949%,8:18.31797%,9:17.61169%,15:0.00317%,22:0.00158%,25:0.0002%,24:0.0002%,16:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99683%,0:0.00317%]
[INFO] ** i/f_name:[2:99.99683%,3:0.00317%]
[INFO] ** modbus_function_code:[0.02961:99.99604%,-33.760870000000004:0.00396%]
[INFO] ** modbus_function_description:[7:49.99901%,11:49.99703%,0:0.00396%]
[INFO] ** modbus_transaction_id:65536 (12.97655%)
[INFO] ** orig:[0:99.99703%,2:0.00297%]
[INFO] ** proto:[0:99.99644%,1:0.00317%,2:0.0004%]
[INFO] ** proxy_src_ip:[18:38.00259%,20:26.0628%,13:18.31778%,6:17.61228%,17:0.00317%,16:0.00059%,7:0.0004%,5:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:26.06201%,-0.32151:20.76929%,-1.27613:18.31758%,-0.23351:17.61149%,-0.33484:17.2333%,-71.33197:0.00317%,-1.02014:0.00059%,-0.24151:0.00059%,1.45709:0.0004%,-64.19493:0.0002%,-61.95768:0.0002%,-71.14798:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,10.192739999999999:0.0002%,-0.24950999999999998:0.0002%,1.46509:0.0002%]
[INFO] ** scada_tag:[3:26.06161%,1:20.7691%,5:18.31758%,4:17.61109%,2:17.2331%,0:0.00752%]
[INFO] ** service:[0.0048200000000000005:99.99624%,-211.73542999999998:0.00317%,-186.44547:0.0002%,-211.08346:0.0002%,-205.44247:0.0002%]
[INFO] ** src:[22:38.00259%,9:26.0628%,7:18.31778%,1:17.61228%,21:0.00337%,15:0.00059%,16:0.0002%,14:0.0002%,8:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1388 (0.27483%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.1308e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0409e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.2867e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4812e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.2752e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0323e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 1.8437e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8864 - val_tp: 13937.0000 - val_fp: 6063.0000 - val_tn: 73937.0000 - val_fn: 6063.0000 - val_accuracy: 0.8787 - val_precision: 0.6969 - val_recall: 0.6969 - val_auc: 0.8105
[INFO] saving weights to checkpoints/lstm-epoch-8-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/505034
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 8s - loss: 7.5376 - tp: 42589.0000 - fp: 37411.0000 - tn: 282589.0000 - fn: 37411.0000 - accuracy: 0.8129 - precision: 0.5324 - recall: 0.5324 - auc: 0.7077 - val_loss: 7.5668 - val_tp: 10611.0000 - val_fp: 9389.0000 - val_tn: 70611.0000 - val_fn: 9389.0000 - val_accuracy: 0.8122 - val_precision: 0.5306 - val_recall: 0.5306 - val_auc: 0.7066
[INFO] saving weights to checkpoints/lstm-epoch-8-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/505034
[33m[INFO] loading file 16-16/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (444724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (444724, 17)

[INFO] analyzing data
[INFO] 444724 rows
[INFO] ** appi_name:[21:99.99865%,30:0.00112%,33:0.00022%]
[INFO] ** classification:[normal:84.06382%,Single Stage Multi Point:15.93618%]
[INFO] ** dst:[21:43.35993%,10:20.79739%,8:18.24997%,9:17.59024%,22:0.00112%,15:0.00112%,24:0.00022%]
[INFO] ** i/f_dir:[1:99.99888%,0:0.00112%]
[INFO] ** i/f_name:[2:99.99888%,3:0.00112%]
[INFO] ** modbus_function_code:[0.02961:99.99865%,-33.760870000000004:0.00135%]
[INFO] ** modbus_function_description:[7:50.00045%,11:49.9982%,0:0.00135%]
[INFO] ** modbus_transaction_id:65536 (14.73633%)
[INFO] ** orig:[0:99.99888%,2:0.00112%]
[INFO] ** proto:[0:99.99888%,1:0.00112%]
[INFO] ** proxy_src_ip:[18:38.04967%,20:26.10788%,13:18.25042%,6:17.59024%,17:0.00112%,16:0.00045%,21:0.00022%]
[INFO] ** s_port:[1.45442:26.1072%,-0.32151:20.79717%,-1.27613:18.24997%,-0.23351:17.59001%,-0.33484:17.2525%,-71.33197:0.00112%,1.45709:0.00045%,-1.02014:0.00045%,-1.27347:0.00022%,1.47576:0.00022%,-49.275529999999996:0.00022%,-0.24151:0.00022%,-1.2708:0.00022%]
[INFO] ** scada_tag:[3:26.10675%,1:20.79717%,5:18.24975%,4:17.58956%,2:17.2525%,0:0.00427%]
[INFO] ** service:[0.0048200000000000005:99.99888%,-211.73542999999998:0.00112%]
[INFO] ** src:[22:38.04967%,9:26.10788%,7:18.25042%,1:17.59024%,21:0.00112%,15:0.00045%,4:0.00022%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1215 (0.2732%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/444724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 8s - loss: 7.5585 - tp: 42485.0000 - fp: 37515.0000 - tn: 282485.0000 - fn: 37515.0000 - accuracy: 0.8124 - precision: 0.5311 - recall: 0.5311 - auc: 0.7069 - val_loss: 7.5506 - val_tp: 10631.0000 - val_fp: 9369.0000 - val_tn: 70631.0000 - val_fn: 9369.0000 - val_accuracy: 0.8126 - val_precision: 0.5315 - val_recall: 0.5315 - val_auc: 0.7072
[INFO] saving weights to checkpoints/lstm-epoch-8-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/444724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 8s - loss: 4.8331 - tp: 56012.0000 - fp: 23988.0000 - tn: 296012.0000 - fn: 23988.0000 - accuracy: 0.8801 - precision: 0.7002 - recall: 0.7002 - auc: 0.8126 - val_loss: 9.5556e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/444724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 8.1071e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.6862e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/444724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.3898e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.4728e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/444724
[33m[INFO] loading file 17-17/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544724, 17)

[INFO] analyzing data
[INFO] 544724 rows
[INFO] ** appi_name:[21:99.99706%,7:0.00055%,26:0.00037%,0:0.00037%,33:0.00018%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:94.33658%,Multi Stage Multi Point:5.66342%]
[INFO] ** dst:[21:43.34654%,10:20.85038%,8:18.20059%,9:17.59956%,22:0.00073%,6:0.00055%,25:0.00037%,16:0.00037%,2:0.00037%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99706%,-33.760870000000004:0.00275%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99945%,11:49.99761%,0:0.00275%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (12.03105%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99871%,2:0.00129%]
[INFO] ** proxy_src_ip:[18:38.08387%,20:26.11359%,13:18.20004%,6:17.59937%,10:0.0011%,11:0.00092%,1:0.00037%,21:0.00018%,16:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.11267%,-0.32151:20.85019%,-1.27613:18.19968%,-0.23351:17.59919%,-0.33484:17.23368%,6.0369:0.00073%,1.47576:0.00037%,-71.14798:0.00037%,1.45709:0.00037%,-64.19493:0.00037%,1.46509:0.00018%,-68.79874000000001:0.00018%,-49.275529999999996:0.00018%,-1.27347:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,6.15557:0.00018%,6.06224:0.00018%,8.55414:0.00018%,-3.3787199999999995:0.00018%,-4.3880099999999995:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.11249%,1:20.85001%,5:18.19949%,4:17.59882%,2:17.23368%,0:0.00551%]
[INFO] ** service:[0.0048200000000000005:99.99798%,-211.09762999999998:0.00055%,-211.08346:0.00037%,-186.44547:0.00037%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.08387%,9:26.11359%,7:18.20004%,1:17.59937%,11:0.0011%,10:0.00092%,3:0.00037%,21:0.00018%,15:0.00018%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1488 (0.27317%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.7029e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0347e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 2.5630e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0859e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8164e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5809e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1099 - tp: 69528.0000 - fp: 10472.0000 - tn: 309528.0000 - fn: 10472.0000 - accuracy: 0.9476 - precision: 0.8691 - recall: 0.8691 - auc: 0.9182 - val_loss: 2.9456 - val_tp: 16345.0000 - val_fp: 3655.0000 - val_tn: 76345.0000 - val_fn: 3655.0000 - val_accuracy: 0.9269 - val_precision: 0.8173 - val_recall: 0.8173 - val_auc: 0.8858
[INFO] saving weights to checkpoints/lstm-epoch-8-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9129 - tp: 65542.0000 - fp: 14458.0000 - tn: 305542.0000 - fn: 14458.0000 - accuracy: 0.9277 - precision: 0.8193 - recall: 0.8193 - auc: 0.8870 - val_loss: 1.8254 - val_tp: 17735.0000 - val_fp: 2265.0000 - val_tn: 77735.0000 - val_fn: 2265.0000 - val_accuracy: 0.9547 - val_precision: 0.8867 - val_recall: 0.8867 - val_auc: 0.9292
[INFO] saving weights to checkpoints/lstm-epoch-8-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/544724
[33m[INFO] loading file 18-18/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544724, 17)

[INFO] analyzing data
[INFO] 544724 rows
[INFO] ** appi_name:[21:99.99816%,30:0.00055%,7:0.00055%,31:0.00018%,27:0.00018%,22:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:82.19318%,Multi Stage Multi Point:17.80682%]
[INFO] ** dst:[21:43.33791%,10:20.83349%,8:18.26448%,9:17.56119%,22:0.00073%,15:0.00055%,24:0.00037%,16:0.00037%,2:0.00037%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99945%,0:0.00055%]
[INFO] ** i/f_name:[2:99.99945%,3:0.00055%]
[INFO] ** modbus_function_code:[0.02961:99.99816%,-33.760870000000004:0.00184%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99798%,0:0.00184%]
[INFO] ** modbus_transaction_id:65536 (12.03105%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9989%,2:0.00055%,1:0.00055%]
[INFO] ** proxy_src_ip:[18:38.07469%,20:26.09725%,13:18.26485%,6:17.56137%,17:0.00055%,11:0.00055%,1:0.00037%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.09652%,-0.32151:20.83349%,-1.27613:18.2643%,-0.23351:17.561%,-0.33484:17.24121%,-71.33197:0.00055%,-1.27347:0.00037%,1.45709:0.00037%,-0.24151:0.00037%,1.47576:0.00018%,1.46509:0.00018%,3.6236699999999997:0.00018%,-1.2708:0.00018%,-2.48275:0.00018%,6.06224:0.00018%,-3.3787199999999995:0.00018%,8.10082:0.00018%,6.45955:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.09615%,1:20.8333%,5:18.26411%,4:17.56082%,2:17.24102%,0:0.00459%]
[INFO] ** service:[0.0048200000000000005:99.99816%,-211.09762999999998:0.00055%,-211.73542999999998:0.00055%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.07469%,9:26.09725%,7:18.26485%,1:17.56137%,14:0.00055%,10:0.00055%,3:0.00037%,21:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1489 (0.27335%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 1.1986 - tp: 74051.0000 - fp: 5949.0000 - tn: 314051.0000 - fn: 5949.0000 - accuracy: 0.9703 - precision: 0.9256 - recall: 0.9256 - auc: 0.9535 - val_loss: 6.1499 - val_tp: 12369.0000 - val_fp: 7631.0000 - val_tn: 72369.0000 - val_fn: 7631.0000 - val_accuracy: 0.8474 - val_precision: 0.6184 - val_recall: 0.6184 - val_auc: 0.7615
[INFO] saving weights to checkpoints/lstm-epoch-8-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 4s - loss: 6.1092 - tp: 49678.0000 - fp: 30322.0000 - tn: 289678.0000 - fn: 30322.0000 - accuracy: 0.8484 - precision: 0.6210 - recall: 0.6210 - auc: 0.7631 - val_loss: 6.1450 - val_tp: 12375.0000 - val_fp: 7625.0000 - val_tn: 72375.0000 - val_fn: 7625.0000 - val_accuracy: 0.8475 - val_precision: 0.6187 - val_recall: 0.6187 - val_auc: 0.7617
[INFO] saving weights to checkpoints/lstm-epoch-8-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.1382 - tp: 49534.0000 - fp: 30466.0000 - tn: 289534.0000 - fn: 30466.0000 - accuracy: 0.8477 - precision: 0.6192 - recall: 0.6192 - auc: 0.7620 - val_loss: 6.1378 - val_tp: 12384.0000 - val_fp: 7616.0000 - val_tn: 72384.0000 - val_fn: 7616.0000 - val_accuracy: 0.8477 - val_precision: 0.6192 - val_recall: 0.6192 - val_auc: 0.7620
[INFO] saving weights to checkpoints/lstm-epoch-8-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4887 - tp: 72611.0000 - fp: 7389.0000 - tn: 312611.0000 - fn: 7389.0000 - accuracy: 0.9631 - precision: 0.9076 - recall: 0.9076 - auc: 0.9423 - val_loss: 5.0890e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.7089e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3963e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/544724
[33m[INFO] loading file 19-19/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544724, 17)

[INFO] analyzing data
[INFO] 544724 rows
[INFO] ** appi_name:[21:99.99798%,26:0.00037%,0:0.00037%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:86.86307%,Single Stage Multi Point:13.13693%]
[INFO] ** dst:[21:43.38234%,10:20.82486%,8:18.21877%,9:17.57128%,22:0.00129%,6:0.00055%,25:0.00037%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99798%,-33.760870000000004:0.00184%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99798%,0:0.00184%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (12.03105%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99871%,2:0.00129%]
[INFO] ** proxy_src_ip:[18:38.11141%,20:26.09597%,13:18.21877%,6:17.57128%,10:0.0011%,11:0.00092%,16:0.00055%]
[INFO] ** s_port:[1.45442:26.09487%,-0.32151:20.82486%,-1.27613:18.2184%,-0.23351:17.5711%,-0.33484:17.28655%,-5.20264:0.00073%,1.45709:0.00055%,-1.02014:0.00055%,-64.19493:0.00037%,-71.14798:0.00037%,1.46509:0.00037%,-1.27347:0.00018%,-0.24151:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-71.14931:0.00018%,-68.79874000000001:0.00018%,0.75578:0.00018%]
[INFO] ** scada_tag:[3:26.0945%,1:20.82467%,5:18.21822%,4:17.57092%,2:17.28637%,0:0.00532%]
[INFO] ** service:[0.0048200000000000005:99.99871%,-211.08346:0.00037%,-186.44547:0.00037%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.11141%,9:26.09597%,7:18.21877%,1:17.57128%,11:0.0011%,10:0.00092%,15:0.00055%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1490 (0.27353%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.0553e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8404e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.4935e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3220e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.0754e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8680e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5338 - tp: 72387.0000 - fp: 7613.0000 - tn: 312387.0000 - fn: 7613.0000 - accuracy: 0.9619 - precision: 0.9048 - recall: 0.9048 - auc: 0.9405 - val_loss: 9.7821 - val_tp: 7862.0000 - val_fp: 12138.0000 - val_tn: 67862.0000 - val_fn: 12138.0000 - val_accuracy: 0.7572 - val_precision: 0.3931 - val_recall: 0.3931 - val_auc: 0.6207
[INFO] saving weights to checkpoints/lstm-epoch-8-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.8425 - tp: 31148.0000 - fp: 48852.0000 - tn: 271148.0000 - fn: 48852.0000 - accuracy: 0.7557 - precision: 0.3893 - recall: 0.3893 - auc: 0.6183 - val_loss: 2.3831 - val_tp: 17043.0000 - val_fp: 2957.0000 - val_tn: 77043.0000 - val_fn: 2957.0000 - val_accuracy: 0.9409 - val_precision: 0.8522 - val_recall: 0.8522 - val_auc: 0.9076
[INFO] saving weights to checkpoints/lstm-epoch-8-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/544724
[33m[INFO] loading file 20-20/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544724, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544724, 17)

[INFO] analyzing data
[INFO] 544724 rows
[INFO] ** appi_name:[21:99.99651%,30:0.00294%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:92.47711%,Single Stage Multi Point:7.52289%]
[INFO] ** dst:[21:43.42621%,10:20.83569%,8:18.16424%,9:17.5689%,15:0.00294%,22:0.0011%,24:0.00037%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99743%,0:0.00257%]
[INFO] ** i/f_name:[2:99.99706%,3:0.00294%]
[INFO] ** modbus_function_code:[0.02961:99.99651%,-33.760870000000004:0.00349%]
[INFO] ** modbus_function_description:[7:49.99982%,11:49.9967%,0:0.00349%]
[INFO] ** modbus_transaction_id:65536 (12.03105%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99651%,1:0.00294%,2:0.00055%]
[INFO] ** proxy_src_ip:[18:38.11471%,20:26.14774%,13:18.16443%,6:17.56945%,17:0.00294%,14:0.00055%,16:0.00018%]
[INFO] ** s_port:[1.45442:26.147%,-0.32151:20.83569%,-1.27613:18.16388%,-0.23351:17.56871%,-0.33484:17.27903%,-71.33197:0.00294%,-0.24151:0.00055%,1.45709:0.00037%,-1.27347:0.00037%,13.431270000000001:0.00018%,-1.2708:0.00018%,-1.02014:0.00018%,-71.14798:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:26.14664%,1:20.83551%,5:18.16388%,4:17.56835%,2:17.27884%,0:0.00679%]
[INFO] ** service:[0.0048200000000000005:99.99651%,-211.73542999999998:0.00294%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.11471%,9:26.14774%,7:18.16443%,1:17.56945%,14:0.00294%,2:0.00055%,15:0.00018%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1489 (0.27335%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.2782e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1394e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.8539 - tp: 65835.0000 - fp: 14165.0000 - tn: 305835.0000 - fn: 14165.0000 - accuracy: 0.9292 - precision: 0.8229 - recall: 0.8229 - auc: 0.8893 - val_loss: 2.9343 - val_tp: 16359.0000 - val_fp: 3641.0000 - val_tn: 76359.0000 - val_fn: 3641.0000 - val_accuracy: 0.9272 - val_precision: 0.8180 - val_recall: 0.8180 - val_auc: 0.8862
[INFO] saving weights to checkpoints/lstm-epoch-8-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9551 - tp: 65333.0000 - fp: 14667.0000 - tn: 305333.0000 - fn: 14667.0000 - accuracy: 0.9267 - precision: 0.8167 - recall: 0.8167 - auc: 0.8854 - val_loss: 2.9166 - val_tp: 16381.0000 - val_fp: 3619.0000 - val_tn: 76381.0000 - val_fn: 3619.0000 - val_accuracy: 0.9276 - val_precision: 0.8191 - val_recall: 0.8191 - val_auc: 0.8869
[INFO] saving weights to checkpoints/lstm-epoch-8-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.9846 - tp: 75113.0000 - fp: 4887.0000 - tn: 315113.0000 - fn: 4887.0000 - accuracy: 0.9756 - precision: 0.9389 - recall: 0.9389 - auc: 0.9618 - val_loss: 1.6545e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/544724
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5799e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4805e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/544724
[33m[INFO] loading file 21-21/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544722, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544722, 17)

[INFO] analyzing data
[INFO] 544722 rows
[INFO] ** appi_name:[21:99.99614%,30:0.00092%,7:0.00055%,26:0.00037%,22:0.00037%,0:0.00037%,31:0.00018%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:98.87961%,Multi Stage Single Point:1.12039%]
[INFO] ** dst:[21:43.30503%,10:20.98538%,8:18.17019%,9:17.53463%,22:0.00092%,15:0.00092%,24:0.00073%,6:0.00073%,25:0.00037%,16:0.00037%,2:0.00037%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99908%,0:0.00092%]
[INFO] ** i/f_name:[2:99.99908%,3:0.00092%]
[INFO] ** modbus_function_code:[0.02961:99.99614%,-33.760870000000004:0.00367%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.9989%,11:49.99725%,0:0.00367%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (12.03109%)
[INFO] ** orig:[0:99.99927%,2:0.00073%]
[INFO] ** proto:[0:99.99761%,2:0.00147%,1:0.00092%]
[INFO] ** proxy_src_ip:[18:38.31165%,20:25.97857%,13:18.17074%,6:17.53463%,10:0.0011%,17:0.00092%,11:0.00092%,16:0.00055%,1:0.00037%,21:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.97802%,-0.32151:20.98465%,-1.27613:18.17%,-0.23351:17.53445%,-0.33484:17.327%,-71.33197:0.00092%,-1.27347:0.00073%,-6.64392:0.00073%,-1.02014:0.00055%,-64.19493:0.00037%,-71.14931:0.00037%,-71.14798:0.00037%,1.47576:0.00018%,1.46509:0.00018%,6.62488:0.00018%,10.15141:0.00018%,-68.79874000000001:0.00018%,7.060860000000001:0.00018%,-3.3787199999999995:0.00018%,-2.2440900000000004:0.00018%,1.45709:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.97765%,1:20.98447%,5:18.16982%,4:17.53408%,2:17.327%,0:0.00698%]
[INFO] ** service:[0.0048200000000000005:99.99688%,-211.73542999999998:0.00092%,-211.09762999999998:0.00055%,-211.08346:0.00037%,-186.44547:0.00037%,-211.08818:0.00037%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.31165%,9:25.97857%,7:18.17074%,1:17.53463%,11:0.0011%,21:0.00092%,10:0.00092%,15:0.00055%,3:0.00037%,14:0.00018%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1483 (0.27225%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544722
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3914e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3102e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/544722
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2273e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1481e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/544722
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0763e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0140e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/544722
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.5742e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.9370e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/544722
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.5442e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.8815e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/544722
[33m[INFO] loading file 22-22/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (313763, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (313763, 17)

[INFO] analyzing data
[INFO] 313763 rows
[INFO] ** appi_name:[21:99.99235%,30:0.00669%,23:0.00032%,22:0.00032%,18:0.00032%]
[INFO] ** classification:[normal:57.7541%,Multi Stage Single Point:42.2459%]
[INFO] ** dst:[21:43.29892%,10:21.00726%,8:18.11208%,9:17.57282%,15:0.00669%,22:0.00127%,19:0.00064%,26:0.00032%]
[INFO] ** i/f_dir:[1:99.99363%,0:0.00637%]
[INFO] ** i/f_name:[2:99.99331%,3:0.00637%,0:0.00032%]
[INFO] ** modbus_function_code:[0.02961:99.99235%,-33.760870000000004:0.00765%]
[INFO] ** modbus_function_description:[7:49.99697%,11:49.99538%,0:0.00765%]
[INFO] ** modbus_transaction_id:65534 (20.88647%)
[INFO] ** orig:[0:99.9949%,2:0.00446%,1:0.00064%]
[INFO] ** proto:[0:99.99299%,1:0.00669%,2:0.00032%]
[INFO] ** proxy_src_ip:[18:38.33371%,20:25.97343%,13:18.11144%,6:17.57377%,17:0.00669%,14:0.00064%,10:0.00032%]
[INFO] ** s_port:[1.45442:25.97247%,-0.32151:21.00726%,-1.27613:18.11144%,-0.23351:17.57282%,-0.33484:17.32645%,-71.33197:0.00669%,1.45709:0.00064%,-0.24151:0.00064%,7.228860000000001:0.00064%,-0.24950999999999998:0.00032%,1.46509:0.00032%,-71.14931:0.00032%]
[INFO] ** scada_tag:[3:25.97215%,1:21.00726%,5:18.11144%,4:17.5725%,2:17.32645%,0:0.0102%]
[INFO] ** service:[0.0048200000000000005:99.99235%,-211.73542999999998:0.00669%,-211.07873999999998:0.00064%,-211.08818:0.00032%]
[INFO] ** src:[22:38.33371%,9:25.97343%,7:18.11144%,1:17.57377%,21:0.00446%,14:0.00223%,2:0.00064%,11:0.00032%]
[INFO] ** type:[0:99.99809%,1:0.00191%]
[INFO] ** unixtime:866 (0.276%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/313763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.5566 - tp: 57384.0000 - fp: 22616.0000 - tn: 297384.0000 - fn: 22616.0000 - accuracy: 0.8869 - precision: 0.7173 - recall: 0.7173 - auc: 0.8233 - val_loss: 7.5836 - val_tp: 10590.0000 - val_fp: 9410.0000 - val_tn: 70590.0000 - val_fn: 9410.0000 - val_accuracy: 0.8118 - val_precision: 0.5295 - val_recall: 0.5295 - val_auc: 0.7059
[INFO] saving weights to checkpoints/lstm-epoch-8-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/313763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5743 - tp: 42406.0000 - fp: 37594.0000 - tn: 282406.0000 - fn: 37594.0000 - accuracy: 0.8120 - precision: 0.5301 - recall: 0.5301 - auc: 0.7063 - val_loss: 7.6190 - val_tp: 10546.0000 - val_fp: 9454.0000 - val_tn: 70546.0000 - val_fn: 9454.0000 - val_accuracy: 0.8109 - val_precision: 0.5273 - val_recall: 0.5273 - val_auc: 0.7046
[INFO] saving weights to checkpoints/lstm-epoch-8-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/313763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5807 - tp: 42374.0000 - fp: 37626.0000 - tn: 282374.0000 - fn: 37626.0000 - accuracy: 0.8119 - precision: 0.5297 - recall: 0.5297 - auc: 0.7060 - val_loss: 7.5811 - val_tp: 10593.0000 - val_fp: 9407.0000 - val_tn: 70593.0000 - val_fn: 9407.0000 - val_accuracy: 0.8119 - val_precision: 0.5296 - val_recall: 0.5296 - val_auc: 0.7060
[INFO] saving weights to checkpoints/lstm-epoch-8-files-21-22-batch-200000-300000
[INFO] processing batch 300000-400000/313763
[33m[INFO] loading file 23-23/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513763, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513763, 17)

[INFO] analyzing data
[INFO] 513763 rows
[INFO] ** appi_name:[21:99.99903%,31:0.00039%,33:0.00019%,30:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:96.98694%,Multi Stage Single Point:3.01306%]
[INFO] ** dst:[21:43.33652%,10:20.99645%,8:18.13832%,9:17.52656%,22:0.00097%,24:0.00039%,18:0.00039%,25:0.00019%,15:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99903%,-33.760870000000004:0.00097%]
[INFO] ** modbus_function_description:[7:50.00049%,11:49.99854%,0:0.00097%]
[INFO] ** modbus_transaction_id:65536 (12.75608%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99922%,2:0.00058%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.34239%,20:25.99078%,13:18.13852%,6:17.52676%,16:0.00058%,21:0.00019%,17:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.99019%,-0.32151:20.99626%,-1.27613:18.13794%,-0.23351:17.52637%,-0.33484:17.34613%,-1.02014:0.00058%,-0.08551:0.00039%,-1.27347:0.00039%,1.47576:0.00019%,-49.275529999999996:0.00019%,1.46509:0.00019%,-0.24151:0.00019%,-0.24950999999999998:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%,1.45709:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.9898%,1:20.99626%,5:18.13774%,4:17.52617%,2:17.34594%,0:0.00409%]
[INFO] ** service:[0.0048200000000000005:99.99922%,-186.43601999999998:0.00039%,-186.44547:0.00019%,-211.73542999999998:0.00019%]
[INFO] ** src:[22:38.34239%,9:25.99078%,7:18.13852%,1:17.52676%,15:0.00058%,17:0.00019%,14:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1397 (0.27192%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.1189 - tp: 64520.0000 - fp: 15480.0000 - tn: 304520.0000 - fn: 15480.0000 - accuracy: 0.9226 - precision: 0.8065 - recall: 0.8065 - auc: 0.8791 - val_loss: 5.5286e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.2918e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.0234e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.7040e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5670e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.2850e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9541e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.8476e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7432e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/513763
[33m[INFO] loading file 24-24/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513763, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513763, 17)

[INFO] analyzing data
[INFO] 513763 rows
[INFO] ** appi_name:[21:99.9928%,30:0.0035%,26:0.00058%,31:0.00039%,27:0.00039%,22:0.00039%,0:0.00039%,24:0.00019%,23:0.00019%,19:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,11:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:95.04051%,Multi Stage Single Point:4.95949%]
[INFO] ** dst:[21:43.3661%,10:21.03188%,8:18.09083%,9:17.50379%,15:0.0035%,22:0.00117%,6:0.00078%,25:0.00039%,19:0.00039%,18:0.00039%,7:0.00039%,26:0.00019%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99669%,0:0.00331%]
[INFO] ** i/f_name:[2:99.9965%,3:0.0035%]
[INFO] ** modbus_function_code:[0.02961:99.9928%,-33.760870000000004:0.00662%,0.47422:0.00019%,-0.415:0.00019%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99737%,11:49.99543%,0:0.00662%,15:0.00019%,10:0.00019%,2:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.75608%)
[INFO] ** orig:[0:99.99961%,1:0.00039%]
[INFO] ** proto:[0:99.99436%,1:0.0035%,2:0.00214%]
[INFO] ** proxy_src_ip:[18:38.41947%,20:25.97929%,13:18.09064%,6:17.50301%,17:0.0035%,10:0.00136%,14:0.00097%,11:0.00097%,21:0.00039%,16:0.00039%]
[INFO] ** s_port:[1.45442:25.97852%,-0.32151:21.03188%,-1.27613:18.09044%,-0.23351:17.50243%,-0.33484:17.38759%,-71.33197:0.0035%,-9.58113:0.00078%,-71.14798:0.00058%,7.6315100000000005:0.00039%,-64.19493:0.00039%,-1.02014:0.00039%,-71.14931:0.00039%,-0.24151:0.00039%,1.45709:0.00039%,-31.55091:0.00039%,7.4901800000000005:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,1.46509:0.00019%,13.431270000000001:0.00019%,-68.79874000000001:0.00019%,-0.24950999999999998:0.00019%,11.862:0.00019%]
[INFO] ** scada_tag:[3:25.97832%,1:21.03188%,5:18.09025%,4:17.50204%,2:17.38739%,0:0.01012%]
[INFO] ** service:[0.0048200000000000005:99.99397%,-211.73542999999998:0.0035%,-211.08346:0.00058%,-186.44547:0.00039%,-186.43601999999998:0.00039%,-211.07873999999998:0.00039%,-211.08818:0.00039%,-202.75898:0.00039%]
[INFO] ** src:[22:38.41947%,9:25.97929%,7:18.09064%,1:17.50301%,14:0.0035%,11:0.00136%,10:0.00097%,2:0.00097%,15:0.00039%,4:0.00039%]
[INFO] ** type:[0:99.99864%,1:0.00097%,2:0.00039%]
[INFO] ** unixtime:1396 (0.27172%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.5669e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4198e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.3214e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2835e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.1380e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0027e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9481e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8457e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.7159 - tp: 66520.0000 - fp: 13480.0000 - tn: 306520.0000 - fn: 13480.0000 - accuracy: 0.9326 - precision: 0.8315 - recall: 0.8315 - auc: 0.8947 - val_loss: 5.7243 - val_tp: 12897.0000 - val_fp: 7103.0000 - val_tn: 72897.0000 - val_fn: 7103.0000 - val_accuracy: 0.8579 - val_precision: 0.6449 - val_recall: 0.6449 - val_auc: 0.7780
[INFO] saving weights to checkpoints/lstm-epoch-8-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/513763
[33m[INFO] loading file 25-25/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513763, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513763, 17)

[INFO] analyzing data
[INFO] 513763 rows
[INFO] ** appi_name:[21:99.99611%,30:0.00117%,17:0.00078%,22:0.00058%,31:0.00039%,28:0.00019%,26:0.00019%,12:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** classification:[normal:64.33647%,Multi Stage Single Point:35.66353%]
[INFO] ** dst:[21:43.30927%,10:21.02273%,8:18.1539%,9:17.50944%,15:0.00117%,22:0.00097%,16:0.00078%,6:0.00078%,18:0.00039%,17:0.00039%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_name:[2:99.99883%,3:0.00117%]
[INFO] ** modbus_function_code:[0.02961:99.99611%,-33.760870000000004:0.00389%]
[INFO] ** modbus_function_description:[7:49.99873%,11:49.99737%,0:0.00389%]
[INFO] ** modbus_transaction_id:65536 (12.75608%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99766%,2:0.00117%,1:0.00117%]
[INFO] ** proxy_src_ip:[18:38.3819%,20:25.94971%,13:18.15409%,6:17.51002%,17:0.00117%,1:0.00097%,21:0.00078%,16:0.00039%,14:0.00039%,7:0.00039%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.94951%,-0.32151:21.02234%,-1.27613:18.1537%,-0.23351:17.50944%,-0.33484:17.35956%,-71.33197:0.00117%,-71.14931:0.00058%,-1.02014:0.00039%,-0.24151:0.00039%,-49.275529999999996:0.00039%,-71.14798:0.00019%,-58.035180000000004:0.00019%,-1.2708:0.00019%,-5.1466400000000005:0.00019%,-5.08665:0.00019%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,1.45709:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,2.52505:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:25.94912%,1:21.02214%,5:18.15351%,4:17.50924%,2:17.35937%,0:0.00662%]
[INFO] ** service:[0.0048200000000000005:99.9965%,-211.73542999999998:0.00117%,-205.44247:0.00078%,-211.08818:0.00058%,-186.43601999999998:0.00039%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.3819%,9:25.94971%,7:18.15409%,1:17.51002%,14:0.00117%,3:0.00097%,4:0.00078%,21:0.00039%,15:0.00039%,2:0.00039%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1396 (0.27172%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7570 - tp: 51426.0000 - fp: 28574.0000 - tn: 291426.0000 - fn: 28574.0000 - accuracy: 0.8571 - precision: 0.6428 - recall: 0.6428 - auc: 0.7768 - val_loss: 5.7493 - val_tp: 12866.0000 - val_fp: 7134.0000 - val_tn: 72866.0000 - val_fn: 7134.0000 - val_accuracy: 0.8573 - val_precision: 0.6433 - val_recall: 0.6433 - val_auc: 0.7771
[INFO] saving weights to checkpoints/lstm-epoch-8-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7435 - tp: 51493.0000 - fp: 28507.0000 - tn: 291493.0000 - fn: 28507.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.7773 - val_loss: 5.7453 - val_tp: 12871.0000 - val_fp: 7129.0000 - val_tn: 72871.0000 - val_fn: 7129.0000 - val_accuracy: 0.8574 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.7772
[INFO] saving weights to checkpoints/lstm-epoch-8-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7517 - tp: 51452.0000 - fp: 28548.0000 - tn: 291452.0000 - fn: 28548.0000 - accuracy: 0.8573 - precision: 0.6431 - recall: 0.6431 - auc: 0.7770 - val_loss: 5.7413 - val_tp: 12876.0000 - val_fp: 7124.0000 - val_tn: 72876.0000 - val_fn: 7124.0000 - val_accuracy: 0.8575 - val_precision: 0.6438 - val_recall: 0.6438 - val_auc: 0.7774
[INFO] saving weights to checkpoints/lstm-epoch-8-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7471 - tp: 51475.0000 - fp: 28525.0000 - tn: 291475.0000 - fn: 28525.0000 - accuracy: 0.8574 - precision: 0.6434 - recall: 0.6434 - auc: 0.7771 - val_loss: 5.7630 - val_tp: 12849.0000 - val_fp: 7151.0000 - val_tn: 72849.0000 - val_fn: 7151.0000 - val_accuracy: 0.8570 - val_precision: 0.6424 - val_recall: 0.6424 - val_auc: 0.7765
[INFO] saving weights to checkpoints/lstm-epoch-8-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7417 - tp: 51502.0000 - fp: 28498.0000 - tn: 291502.0000 - fn: 28498.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.7774 - val_loss: 5.7227 - val_tp: 12899.0000 - val_fp: 7101.0000 - val_tn: 72899.0000 - val_fn: 7101.0000 - val_accuracy: 0.8580 - val_precision: 0.6449 - val_recall: 0.6449 - val_auc: 0.7781
[INFO] saving weights to checkpoints/lstm-epoch-8-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/513763
[33m[INFO] loading file 26-26/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (513763, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (513763, 17)

[INFO] analyzing data
[INFO] 513763 rows
[INFO] ** appi_name:[21:99.99883%,7:0.00058%,30:0.00019%,22:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:64.39487%,Single Stage Single Point:31.08671%,Multi Stage Single Point:4.51843%]
[INFO] ** dst:[21:43.30888%,10:21.08404%,8:18.1212%,9:17.48355%,22:0.00078%,24:0.00039%,16:0.00039%,2:0.00039%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99883%,-33.760870000000004:0.00117%]
[INFO] ** modbus_function_description:[7:49.9999%,11:49.99893%,0:0.00117%]
[INFO] ** modbus_transaction_id:65536 (12.75608%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99961%,2:0.00019%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.46599%,20:25.92732%,13:18.12159%,6:17.48355%,16:0.00039%,1:0.00039%,21:0.00019%,17:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.92674%,-0.32151:21.08404%,-1.27613:18.121%,-0.23351:17.48335%,-0.33484:17.38194%,-1.27347:0.00039%,-1.02014:0.00039%,7.66617:0.00019%,-1.2708:0.00019%,-71.14931:0.00019%,-0.24151:0.00019%,11.57001:0.00019%,1.47576:0.00019%,1.46509:0.00019%,14.191239999999999:0.00019%,-3.3787199999999995:0.00019%,1.45709:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.92635%,1:21.08404%,5:18.121%,4:17.48316%,2:17.38194%,0:0.0035%]
[INFO] ** service:[0.0048200000000000005:99.99883%,-211.09762999999998:0.00058%,-211.73542999999998:0.00019%,-211.35747999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.46599%,9:25.92732%,7:18.12159%,1:17.48355%,15:0.00039%,3:0.00039%,21:0.00019%,14:0.00019%,4:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1394 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5779 - tp: 67123.0000 - fp: 12699.0000 - tn: 307301.0000 - fn: 12877.0000 - accuracy: 0.9361 - precision: 0.8409 - recall: 0.8390 - auc: 0.9298 - val_loss: 0.5965 - val_tp: 12892.0000 - val_fp: 7108.0000 - val_tn: 72892.0000 - val_fn: 7108.0000 - val_accuracy: 0.8578 - val_precision: 0.6446 - val_recall: 0.6446 - val_auc: 0.9684
[INFO] saving weights to checkpoints/lstm-epoch-8-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0394 - tp: 78828.0000 - fp: 1084.0000 - tn: 318916.0000 - fn: 1172.0000 - accuracy: 0.9944 - precision: 0.9864 - recall: 0.9854 - auc: 0.9998 - val_loss: 0.0022 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0016 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0011 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.7390e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.8689e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/513763
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.7336e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9295e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/513763
[33m[INFO] loading file 27-27/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (453893, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (453893, 17)

[INFO] analyzing data
[INFO] 453893 rows
[INFO] ** appi_name:[21:99.99934%,30:0.00066%]
[INFO] ** classification:[normal:64.33917%,Single Stage Single Point:35.66083%]
[INFO] ** dst:[21:43.27121%,10:21.06598%,8:18.19041%,9:17.47064%,22:0.00088%,15:0.00066%,24:0.00022%]
[INFO] ** i/f_dir:[1:99.99978%,0:0.00022%]
[INFO] ** i/f_name:[2:99.99934%,3:0.00066%]
[INFO] ** modbus_function_code:[0.02961:99.99934%,-33.760870000000004:0.00066%]
[INFO] ** modbus_function_description:[7:50.00033%,11:49.99901%,0:0.00066%]
[INFO] ** modbus_transaction_id:65536 (14.43865%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99934%,1:0.00066%]
[INFO] ** proxy_src_ip:[18:38.40729%,20:25.93056%,13:18.19019%,6:17.47086%,17:0.00066%,16:0.00044%]
[INFO] ** s_port:[1.45442:25.9299%,-0.32151:21.06598%,-1.27613:18.18997%,-0.23351:17.47042%,-0.33484:17.34131%,-71.33197:0.00066%,-1.02014:0.00044%,-1.27347:0.00022%,1.45709:0.00022%,-0.24950999999999998:0.00022%,1.46509:0.00022%,1.47576:0.00022%,-0.24151:0.00022%]
[INFO] ** scada_tag:[3:25.92946%,1:21.06576%,5:18.18975%,4:17.4702%,2:17.34109%,0:0.00375%]
[INFO] ** service:[0.0048200000000000005:99.99934%,-211.73542999999998:0.00066%]
[INFO] ** src:[22:38.40729%,9:25.93056%,7:18.19019%,1:17.47086%,14:0.00066%,15:0.00044%]
[INFO] ** type:[0:99.99956%,1:0.00044%]
[INFO] ** unixtime:1233 (0.27165%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/453893
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.6736e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0041e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/453893
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.1042e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5209e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/453893
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.6463e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0508e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/453893
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8688e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6883e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/453893
[33m[INFO] loading file 28-28/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (387809, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (387809, 17)

[INFO] analyzing data
[INFO] 387809 rows
[INFO] ** appi_name:[21:99.99226%,30:0.00181%,17:0.00129%,22:0.00103%,7:0.00103%,31:0.00077%,26:0.00077%,28:0.00026%,27:0.00026%,8:0.00026%,0:0.00026%]
[INFO] ** classification:[normal:64.30743%,Single Stage Single Point:35.69257%]
[INFO] ** dst:[21:43.28084%,10:21.01859%,8:18.20613%,9:17.48619%,6:0.00206%,16:0.00181%,18:0.00129%,15:0.00077%,22:0.00052%,17:0.00052%,2:0.00052%,25:0.00026%,7:0.00026%,0:0.00026%]
[INFO] ** i/f_dir:[1:99.99923%,0:0.00077%]
[INFO] ** i/f_name:[2:99.99923%,3:0.00077%]
[INFO] ** modbus_function_code:[0.02961:99.99226%,-33.760870000000004:0.00774%]
[INFO] ** modbus_function_description:[7:49.99626%,11:49.996%,0:0.00774%]
[INFO] ** modbus_transaction_id:65536 (16.89904%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99536%,2:0.00387%,1:0.00077%]
[INFO] ** proxy_src_ip:[18:38.33614%,20:25.9633%,13:18.20639%,6:17.48644%,1:0.00206%,17:0.00181%,14:0.00155%,7:0.00129%,21:0.00077%,0:0.00026%]
[INFO] ** s_port:[1.45442:25.96304%,-0.32151:21.01859%,-1.27613:18.20613%,-0.23351:17.48593%,-0.33484:17.31755%,-71.14798:0.00103%,-71.14931:0.00103%,-71.33197:0.00077%,-0.08551:0.00052%,-0.24151:0.00052%,7.66617:0.00026%,-58.035180000000004:0.00026%,-1.2708:0.00026%,-64.19493:0.00026%,-5.1466400000000005:0.00026%,13.431270000000001:0.00026%,11.57001:0.00026%,14.4699:0.00026%,1.47576:0.00026%,14.191239999999999:0.00026%,-5.08665:0.00026%,10.192739999999999:0.00026%,-3.3787199999999995:0.00026%,6.1115699999999995:0.00026%,2.05573:0.00026%,-43.76509:0.00026%,2.52505:0.00026%,11.862:0.00026%,-58.032509999999995:0.00026%]
[INFO] ** scada_tag:[3:25.96278%,1:21.01859%,5:18.20613%,4:17.48567%,2:17.31755%,0:0.00928%]
[INFO] ** service:[0.0048200000000000005:99.99226%,-205.44247:0.00129%,-186.43601999999998:0.00129%,-211.09762999999998:0.00103%,-211.08346:0.00103%,-211.08818:0.00103%,-211.73542999999998:0.00077%,-186.44547:0.00026%,-183.8612:0.00026%,-185.9872:0.00026%,-211.35747999999998:0.00026%,-202.75898:0.00026%]
[INFO] ** src:[22:38.33614%,9:25.9633%,7:18.20639%,1:17.48644%,3:0.00232%,2:0.00155%,21:0.00129%,4:0.00103%,14:0.00077%,8:0.00052%,17:0.00026%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1054 (0.27178%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/387809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9220e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4502e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/387809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3551e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2044e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/387809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3899e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0963e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/387809
[33m[INFO] loading file 29-29/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587809, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587809, 17)

[INFO] analyzing data
[INFO] 587809 rows
[INFO] ** appi_name:[21:99.99881%,30:0.00051%,31:0.00017%,26:0.00017%,9:0.00017%,3:0.00017%]
[INFO] ** classification:[normal:64.38401%,Single Stage Single Point:35.61599%]
[INFO] ** dst:[21:43.32087%,10:21.06177%,8:18.14586%,9:17.46979%,22:0.00051%,15:0.00051%,24:0.00017%,18:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99966%,0:0.00034%]
[INFO] ** i/f_name:[2:99.99949%,3:0.00051%]
[INFO] ** modbus_function_code:[0.02961:99.99881%,-33.760870000000004:0.00119%]
[INFO] ** modbus_function_description:[7:49.99974%,11:49.99906%,0:0.00119%]
[INFO] ** modbus_transaction_id:65536 (11.1492%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99915%,1:0.00051%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.43561%,20:25.9472%,13:18.1462%,6:17.46962%,17:0.00051%,21:0.00017%,16:0.00017%,7:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.94669%,-0.32151:21.0616%,-1.27613:18.14586%,-0.23351:17.46962%,-0.33484:17.37401%,-71.33197:0.00051%,1.45709:0.00034%,-71.14798:0.00017%,-1.27347:0.00017%,1.47576:0.00017%,-61.95768:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,6.1115699999999995:0.00017%,14.4699:0.00017%]
[INFO] ** scada_tag:[3:25.94635%,1:21.06143%,5:18.14586%,4:17.46928%,2:17.37401%,0:0.00306%]
[INFO] ** service:[0.0048200000000000005:99.99898%,-211.73542999999998:0.00051%,-183.8612:0.00017%,-211.08346:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.43561%,9:25.9472%,7:18.1462%,1:17.46962%,14:0.00051%,21:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1596 (0.27152%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0339e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.4041e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.6532e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.2856e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5877e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.2250e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.5339e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.0712e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.7230e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.3701e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/587809
[33m[INFO] loading file 30-30/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587809, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587809, 17)

[INFO] analyzing data
[INFO] 587809 rows
[INFO] ** appi_name:[21:99.99745%,30:0.0017%,26:0.00017%,17:0.00017%,12:0.00017%,3:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.37601%,Single Stage Single Point:35.62399%]
[INFO] ** dst:[21:43.3435%,10:21.02962%,8:18.1428%,9:17.48085%,15:0.0017%,22:0.00068%,24:0.00034%,25:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99847%,0:0.00153%]
[INFO] ** i/f_name:[2:99.9983%,3:0.0017%]
[INFO] ** modbus_function_code:[0.02961:99.99745%,-33.760870000000004:0.00255%]
[INFO] ** modbus_function_description:[7:49.99957%,11:49.99787%,0:0.00255%]
[INFO] ** modbus_transaction_id:65536 (11.1492%)
[INFO] ** orig:[0:99.99915%,2:0.00051%,1:0.00034%]
[INFO] ** proto:[0:99.99796%,1:0.0017%,2:0.00034%]
[INFO] ** proxy_src_ip:[18:38.37624%,20:25.99654%,13:18.14314%,6:17.48136%,17:0.0017%,7:0.00034%,0:0.00034%,16:0.00017%,5:0.00017%]
[INFO] ** s_port:[1.45442:25.99637%,-0.32151:21.02928%,-1.27613:18.14263%,-0.23351:17.48068%,-0.33484:17.34696%,-71.33197:0.0017%,-0.24151:0.00051%,-1.27347:0.00034%,-61.95768:0.00034%,-71.14798:0.00017%,-0.24950999999999998:0.00017%,1.47576:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%]
[INFO] ** scada_tag:[3:25.99603%,1:21.02928%,5:18.14246%,4:17.48051%,2:17.34679%,0:0.00493%]
[INFO] ** service:[0.0048200000000000005:99.99779%,-211.73542999999998:0.0017%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.37624%,9:25.99654%,7:18.14314%,1:17.48136%,14:0.00119%,21:0.00085%,8:0.00034%,16:0.00017%,15:0.00017%]
[INFO] ** type:[0:99.99915%,1:0.00085%]
[INFO] ** unixtime:1598 (0.27186%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.8077e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.9165e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.9502e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.9213e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.7840e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.8486e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8371e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2607e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2325e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6129e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/587809
[33m[INFO] loading file 31-31/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587809, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587809, 17)

[INFO] analyzing data
[INFO] 587809 rows
[INFO] ** appi_name:[21:99.99966%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.3784%,Single Stage Single Point:35.6216%]
[INFO] ** dst:[21:43.32581%,10:21.05123%,8:18.12051%,9:17.50075%,22:0.00102%,24:0.00034%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99966%,-33.760870000000004:0.00034%]
[INFO] ** modbus_function_description:[7:50.00009%,11:49.99957%,0:0.00034%]
[INFO] ** modbus_transaction_id:65536 (11.1492%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.39938%,20:25.97817%,13:18.12085%,6:17.50075%,16:0.00051%,7:0.00034%]
[INFO] ** s_port:[1.45442:25.97749%,-0.32151:21.05123%,-1.27613:18.12034%,-0.23351:17.50058%,-0.33484:17.34815%,-1.02014:0.00051%,-1.27347:0.00034%,1.45709:0.00034%,-71.14798:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-0.24151:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.97715%,1:21.05106%,5:18.12017%,4:17.50024%,2:17.34798%,0:0.0034%]
[INFO] ** service:[0.0048200000000000005:99.99966%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.39938%,9:25.97817%,7:18.12085%,1:17.50075%,15:0.00051%,21:0.00034%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1597 (0.27169%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8293e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9083e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6642e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4097e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5481e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8607e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3176e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9538e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8734e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7144e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/587809
[33m[INFO] loading file 32-32/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587809, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587809, 17)

[INFO] analyzing data
[INFO] 587809 rows
[INFO] ** appi_name:[21:99.9966%,30:0.00289%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.38197%,Single Stage Single Point:35.61803%]
[INFO] ** dst:[21:43.32104%,10:21.0565%,8:18.15301%,9:17.46503%,15:0.00289%,22:0.00085%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99745%,0:0.00255%]
[INFO] ** i/f_name:[2:99.99711%,3:0.00289%]
[INFO] ** modbus_function_code:[0.02961:99.9966%,-33.760870000000004:0.0034%]
[INFO] ** modbus_function_description:[7:49.99906%,11:49.99753%,0:0.0034%]
[INFO] ** modbus_transaction_id:65536 (11.1492%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9966%,1:0.00289%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.42473%,20:25.95316%,13:18.15301%,6:17.46554%,17:0.00289%,14:0.00051%,16:0.00017%]
[INFO] ** s_port:[1.45442:25.95265%,-0.32151:21.0565%,-1.27613:18.15267%,-0.23351:17.46486%,-0.33484:17.36823%,-71.33197:0.00289%,-0.24151:0.00051%,-1.2708:0.00017%,-1.02014:0.00017%,13.431270000000001:0.00017%,-71.14798:0.00017%,-1.27347:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,1.45709:0.00017%,11.862:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.95231%,1:21.05633%,5:18.15267%,4:17.46452%,2:17.36823%,0:0.00595%]
[INFO] ** service:[0.0048200000000000005:99.9966%,-211.73542999999998:0.00289%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.42473%,9:25.95316%,7:18.15301%,1:17.46554%,14:0.00289%,2:0.00051%,15:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1595 (0.27135%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.8458e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9808e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.5677e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.9415e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9232e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7022e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5359e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3637e-04 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.4070e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6914e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/587809
[33m[INFO] loading file 33-33/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587809, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587809, 17)

[INFO] analyzing data
[INFO] 587809 rows
[INFO] ** appi_name:[21:99.99711%,30:0.00102%,17:0.00068%,22:0.00051%,31:0.00017%,28:0.00017%,26:0.00017%,7:0.00017%]
[INFO] ** classification:[normal:64.39371%,Single Stage Single Point:35.60629%]
[INFO] ** dst:[21:43.32632%,10:21.06279%,8:18.12374%,9:17.48255%,22:0.00136%,15:0.00102%,16:0.00068%,6:0.00068%,24:0.00034%,17:0.00034%,18:0.00017%]
[INFO] ** i/f_dir:[1:99.99898%,0:0.00102%]
[INFO] ** i/f_name:[2:99.99898%,3:0.00102%]
[INFO] ** modbus_function_code:[0.02961:99.99711%,-33.760870000000004:0.00289%]
[INFO] ** modbus_function_description:[7:49.99957%,11:49.99753%,0:0.00289%]
[INFO] ** modbus_transaction_id:65536 (11.1492%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99813%,1:0.00102%,2:0.00085%]
[INFO] ** proxy_src_ip:[18:38.42286%,20:25.96711%,13:18.12374%,6:17.48272%,17:0.00102%,16:0.00068%,1:0.00068%,21:0.00034%,14:0.00034%,7:0.00034%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.96626%,-0.32151:21.06279%,-1.27613:18.1234%,-0.23351:17.48238%,-0.33484:17.36006%,-71.33197:0.00102%,-1.02014:0.00068%,1.45709:0.00051%,-71.14931:0.00051%,-1.27347:0.00034%,-5.08665:0.00017%,6.1115699999999995:0.00017%,2.05573:0.00017%,-43.76509:0.00017%,-71.14798:0.00017%,-58.032509999999995:0.00017%,-58.035180000000004:0.00017%,-0.24151:0.00017%,1.47576:0.00017%,1.46509:0.00017%,-0.24950999999999998:0.00017%,-5.1466400000000005:0.00017%]
[INFO] ** scada_tag:[3:25.96592%,1:21.06262%,5:18.12323%,4:17.48221%,2:17.36006%,0:0.00595%]
[INFO] ** service:[0.0048200000000000005:99.99711%,-211.73542999999998:0.00102%,-205.44247:0.00068%,-211.08818:0.00051%,-211.09762999999998:0.00017%,-211.08346:0.00017%,-185.9872:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.42286%,9:25.96711%,7:18.12374%,1:17.48272%,14:0.00102%,15:0.00068%,3:0.00068%,21:0.00034%,4:0.00034%,2:0.00034%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1598 (0.27186%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5165e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.3508e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.1497e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0530e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0117e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.4652e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.9469e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.2421e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/587809
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7999e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3175e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/587809
[33m[INFO] loading file 34-34/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (429242, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (429242, 17)

[INFO] analyzing data
[INFO] 429242 rows
[INFO] ** appi_name:[21:99.99767%,30:0.0007%,7:0.0007%,31:0.00023%,22:0.00023%,8:0.00023%,6:0.00023%]
[INFO] ** classification:[normal:64.35134%,Single Stage Single Point:35.64866%]
[INFO] ** dst:[21:43.2905%,10:21.05782%,8:18.18461%,9:17.46427%,22:0.0007%,15:0.0007%,16:0.00047%,2:0.00047%,18:0.00023%,6:0.00023%]
[INFO] ** i/f_dir:[1:99.9993%,0:0.0007%]
[INFO] ** i/f_name:[2:99.9993%,3:0.0007%]
[INFO] ** modbus_function_code:[0.02961:99.99767%,-33.760870000000004:0.00233%]
[INFO] ** modbus_function_description:[7:49.9993%,11:49.99837%,0:0.00233%]
[INFO] ** modbus_transaction_id:65536 (15.26784%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99884%,1:0.0007%,2:0.00047%]
[INFO] ** proxy_src_ip:[18:38.39629%,20:25.95226%,13:18.18438%,6:17.46474%,17:0.0007%,1:0.0007%,21:0.00047%,14:0.00023%,7:0.00023%]
[INFO] ** s_port:[1.45442:25.95179%,-0.32151:21.05759%,-1.27613:18.18438%,-0.23351:17.46404%,-0.33484:17.3387%,-0.24151:0.0007%,-71.33197:0.0007%,-3.0613900000000003:0.00023%,-3.3787199999999995:0.00023%,14.191239999999999:0.00023%,1.46509:0.00023%,1.47576:0.00023%,11.57001:0.00023%,-49.275529999999996:0.00023%,-71.14931:0.00023%,7.66617:0.00023%]
[INFO] ** scada_tag:[3:25.95156%,1:21.05735%,5:18.18415%,4:17.46358%,2:17.3387%,0:0.00466%]
[INFO] ** service:[0.0048200000000000005:99.9979%,-211.09762999999998:0.0007%,-211.73542999999998:0.0007%,-186.43601999999998:0.00023%,-211.35747999999998:0.00023%,-211.08818:0.00023%]
[INFO] ** src:[22:38.39629%,9:25.95226%,7:18.18438%,1:17.46474%,14:0.0007%,3:0.0007%,4:0.00047%,21:0.00023%,2:0.00023%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1166 (0.27164%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/429242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2614e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3926e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/429242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2452e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.0038e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/429242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5224e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.5562e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/429242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9337e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4564e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-33-34-batch-300000-400000
[INFO] processing batch 400000-500000/429242
[33m[INFO] loading file 35-35/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529242, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529242, 17)

[INFO] analyzing data
[INFO] 529242 rows
[INFO] ** appi_name:[21:99.99887%,30:0.00113%]
[INFO] ** classification:[normal:64.37452%,Single Stage Single Point:35.62548%]
[INFO] ** dst:[21:43.33462%,10:21.03726%,8:18.1469%,9:17.47896%,22:0.00113%,15:0.00113%]
[INFO] ** i/f_dir:[1:99.99906%,0:0.00094%]
[INFO] ** i/f_name:[2:99.99887%,3:0.00113%]
[INFO] ** modbus_function_code:[0.02961:99.99887%,-33.760870000000004:0.00113%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99887%,0:0.00113%]
[INFO] ** modbus_transaction_id:65536 (12.38299%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99887%,1:0.00113%]
[INFO] ** proxy_src_ip:[18:38.40096%,20:25.97148%,13:18.14652%,6:17.47915%,17:0.00113%,16:0.00076%]
[INFO] ** s_port:[1.45442:25.97092%,-0.32151:21.03726%,-1.27613:18.14652%,-0.23351:17.47877%,-0.33484:17.3637%,-71.33197:0.00113%,-1.02014:0.00076%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.97054%,1:21.03726%,5:18.14633%,4:17.47839%,2:17.3637%,0:0.00378%]
[INFO] ** service:[0.0048200000000000005:99.99887%,-211.73542999999998:0.00113%]
[INFO] ** src:[22:38.40096%,9:25.97148%,7:18.14652%,1:17.47915%,14:0.00113%,15:0.00076%]
[INFO] ** type:[0:99.99906%,1:0.00094%]
[INFO] ** unixtime:1437 (0.27152%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2703e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1423e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6809e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.6227e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.3669e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.1935e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.4617e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.9214e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.5066e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.9905e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/529242
[33m[INFO] loading file 36-36/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529242, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529242, 17)

[INFO] analyzing data
[INFO] 529242 rows
[INFO] ** appi_name:[21:99.99868%,30:0.00057%,31:0.00038%,33:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.35222%,Single Stage Single Point:35.64778%]
[INFO] ** dst:[21:43.32952%,10:21.02063%,8:18.16107%,9:17.48652%,22:0.00076%,15:0.00057%,24:0.00038%,18:0.00038%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99943%,0:0.00057%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99868%,-33.760870000000004:0.00132%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99849%,0:0.00132%]
[INFO] ** modbus_transaction_id:65536 (12.38299%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99887%,2:0.00057%,1:0.00057%]
[INFO] ** proxy_src_ip:[18:38.36808%,20:25.98225%,13:18.16126%,6:17.48709%,17:0.00057%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.98169%,-0.32151:21.02044%,-1.27613:18.16069%,-0.23351:17.48633%,-0.33484:17.34764%,-0.24151:0.00057%,-71.33197:0.00057%,-1.27347:0.00038%,-0.08551:0.00038%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-49.275529999999996:0.00019%,-1.2708:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:25.98131%,1:21.02025%,5:18.1605%,4:17.48614%,2:17.34745%,0:0.00435%]
[INFO] ** service:[0.0048200000000000005:99.99887%,-211.73542999999998:0.00057%,-186.43601999999998:0.00038%,-186.44547:0.00019%]
[INFO] ** src:[22:38.36808%,9:25.98225%,7:18.16126%,1:17.48709%,14:0.00057%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1438 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.8860e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5253e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.5547e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.5955e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.4704e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0749e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5153e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.9698e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.7094e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.4041e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/529242
[33m[INFO] loading file 37-37/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529242, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529242, 17)

[INFO] analyzing data
[INFO] 529242 rows
[INFO] ** appi_name:[21:99.99887%,30:0.00076%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.38472%,Single Stage Single Point:35.61528%]
[INFO] ** dst:[21:43.33783%,10:21.045%,8:18.1348%,9:17.48028%,22:0.00076%,15:0.00076%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99924%,3:0.00076%]
[INFO] ** modbus_function_code:[0.02961:99.99887%,-33.760870000000004:0.00113%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99887%,0:0.00113%]
[INFO] ** modbus_transaction_id:65536 (12.38299%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99906%,1:0.00076%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.39794%,20:25.98528%,13:18.13499%,6:17.48028%,17:0.00076%,16:0.00038%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.98471%,-0.32151:21.045%,-1.27613:18.13462%,-0.23351:17.48009%,-0.33484:17.35293%,-71.33197:0.00076%,-1.02014:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%,14.4699:0.00019%]
[INFO] ** scada_tag:[3:25.98452%,1:21.045%,5:18.13443%,4:17.47991%,2:17.35274%,0:0.0034%]
[INFO] ** service:[0.0048200000000000005:99.99887%,-211.73542999999998:0.00076%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.39794%,9:25.98528%,7:18.13499%,1:17.48028%,14:0.00076%,15:0.00038%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1438 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5134e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.6644e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.3241e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8710e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.2345e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7657e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.6084e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2126e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.2171e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5354e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/529242
[33m[INFO] loading file 38-38/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529242, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529242, 17)

[INFO] analyzing data
[INFO] 529242 rows
[INFO] ** appi_name:[21:99.99906%,30:0.00019%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.41061%,Single Stage Single Point:35.58939%]
[INFO] ** dst:[21:43.32139%,10:21.08714%,8:18.09664%,9:17.49294%,22:0.00094%,25:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99906%,-33.760870000000004:0.00094%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99943%,0:0.00094%]
[INFO] ** modbus_transaction_id:65536 (12.38299%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99943%,2:0.00038%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.45519%,20:25.95391%,13:18.09645%,6:17.49332%,7:0.00038%,17:0.00019%,16:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95316%,-0.32151:21.08695%,-1.27613:18.09626%,-0.23351:17.49275%,-0.33484:17.36824%,-0.24151:0.00038%,1.45709:0.00038%,-64.19493:0.00019%,10.192739999999999:0.00019%,-1.02014:0.00019%,-71.14798:0.00019%,-61.95768:0.00019%,-1.27347:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.95278%,1:21.08695%,5:18.09626%,4:17.49256%,2:17.36824%,0:0.00321%]
[INFO] ** service:[0.0048200000000000005:99.99924%,-211.08346:0.00019%,-205.44247:0.00019%,-186.44547:0.00019%,-211.73542999999998:0.00019%]
[INFO] ** src:[22:38.45519%,9:25.95391%,7:18.09645%,1:17.49332%,21:0.00038%,16:0.00019%,15:0.00019%,14:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1438 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1331e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0757e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6397e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.3683e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7324e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3127e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.8863e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.9210e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.0708e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.1067e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/529242
[33m[INFO] loading file 39-39/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529242, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529242, 17)

[INFO] analyzing data
[INFO] 529242 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.41288%,Single Stage Single Point:35.58712%]
[INFO] ** dst:[21:43.32517%,10:21.08695%,8:18.12762%,9:17.45912%,22:0.00094%,24:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.00057%,11:49.99943%]
[INFO] ** modbus_transaction_id:65536 (12.38299%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.45972%,20:25.95259%,13:18.128%,6:17.45912%,16:0.00057%]
[INFO] ** s_port:[1.45442:25.95221%,-0.32151:21.08695%,-1.27613:18.12762%,-0.23351:17.45893%,-0.33484:17.37277%,-1.02014:0.00057%,-1.27347:0.00019%,1.45709:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.95183%,1:21.08676%,5:18.12744%,4:17.45893%,2:17.37258%,0:0.00246%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.45972%,9:25.95259%,7:18.128%,1:17.45912%,15:0.00057%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1437 (0.27152%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 2.2171e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.0773e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 8s - loss: 1.7237e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5580e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 8s - loss: 1.4661e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3954e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 8s - loss: 1.2801e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1682e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 8s - loss: 1.1284e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0042e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/529242
[33m[INFO] loading file 40-40/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529242, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529242, 17)

[INFO] analyzing data
[INFO] 529242 rows
[INFO] ** appi_name:[21:99.99622%,30:0.00321%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.33371%,Single Stage Single Point:35.66629%]
[INFO] ** dst:[21:43.29097%,10:21.03763%,8:18.19451%,9:17.47197%,15:0.00321%,22:0.00094%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99698%,0:0.00302%]
[INFO] ** i/f_name:[2:99.99679%,3:0.00321%]
[INFO] ** modbus_function_code:[0.02961:99.99622%,-33.760870000000004:0.00378%]
[INFO] ** modbus_function_description:[7:49.99924%,11:49.99698%,0:0.00378%]
[INFO] ** modbus_transaction_id:65536 (12.38299%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99622%,1:0.00321%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.3524%,20:25.97715%,13:18.19432%,6:17.47235%,17:0.00321%,14:0.00057%]
[INFO] ** s_port:[1.45442:25.97621%,-0.32151:21.03763%,-1.27613:18.19413%,-0.23351:17.47178%,-0.33484:17.31476%,-71.33197:0.00321%,1.45709:0.00057%,-0.24151:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,13.431270000000001:0.00019%]
[INFO] ** scada_tag:[3:25.97583%,1:21.03745%,5:18.19395%,4:17.4714%,2:17.31457%,0:0.0068%]
[INFO] ** service:[0.0048200000000000005:99.99622%,-211.73542999999998:0.00321%,-211.08346:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.3524%,9:25.97715%,7:18.19432%,1:17.47235%,14:0.00321%,2:0.00057%]
[INFO] ** type:[0:99.99906%,1:0.00094%]
[INFO] ** unixtime:1439 (0.2719%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.8134e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1212e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.9720e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.4089e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2406e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1466e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8953e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2074e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/529242
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.5988e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2275e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/529242
[33m[INFO] loading file 41-41/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (469400, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (469400, 17)

[INFO] analyzing data
[INFO] 469400 rows
[INFO] ** appi_name:[21:99.99638%,30:0.00107%,22:0.00085%,17:0.00085%,32:0.00021%,28:0.00021%,26:0.00021%,7:0.00021%]
[INFO] ** classification:[normal:64.3905%,Single Stage Single Point:35.6095%]
[INFO] ** dst:[21:43.32318%,10:21.06285%,8:18.13975%,9:17.46954%,16:0.00107%,15:0.00107%,6:0.00107%,22:0.00064%,24:0.00043%,17:0.00043%]
[INFO] ** i/f_dir:[1:99.99893%,0:0.00107%]
[INFO] ** i/f_name:[2:99.99893%,3:0.00107%]
[INFO] ** modbus_function_code:[0.02961:99.99638%,-33.760870000000004:0.00362%]
[INFO] ** modbus_function_description:[7:49.99915%,11:49.99723%,0:0.00362%]
[INFO] ** modbus_transaction_id:65536 (13.96165%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99766%,2:0.00128%,1:0.00107%]
[INFO] ** proxy_src_ip:[18:38.43822%,20:25.94802%,13:18.13997%,6:17.46975%,17:0.00107%,1:0.00085%,21:0.00043%,16:0.00043%,14:0.00043%,0:0.00043%,7:0.00021%,2:0.00021%]
[INFO] ** s_port:[1.45442:25.94759%,-0.32151:21.06285%,-1.27613:18.13933%,-0.23351:17.46932%,-0.33484:17.37537%,-71.33197:0.00107%,-71.14931:0.00085%,-1.02014:0.00043%,-1.27347:0.00043%,-71.14798:0.00021%,-0.24151:0.00021%,-58.035180000000004:0.00021%,-1.2708:0.00021%,-5.1466400000000005:0.00021%,1.47576:0.00021%,1.46509:0.00021%,-64.19226:0.00021%,-5.08665:0.00021%,-0.24950999999999998:0.00021%,2.05573:0.00021%,-43.76509:0.00021%,-58.032509999999995:0.00021%]
[INFO] ** scada_tag:[3:25.94738%,1:21.06285%,5:18.13933%,4:17.46911%,2:17.37537%,0:0.00597%]
[INFO] ** service:[0.0048200000000000005:99.99638%,-211.73542999999998:0.00107%,-205.44247:0.00085%,-211.08818:0.00085%,89.64175:0.00021%,-211.09762999999998:0.00021%,-211.08346:0.00021%,-185.9872:0.00021%]
[INFO] ** src:[22:38.43822%,9:25.94802%,7:18.13997%,1:17.46975%,14:0.00107%,3:0.00085%,15:0.00043%,8:0.00043%,4:0.00043%,2:0.00043%,21:0.00021%,17:0.00021%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1273 (0.2712%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/469400
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9500e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5520e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/469400
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.6900e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4630e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/469400
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6922e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3903e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/469400
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5420e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.3275e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/469400
[33m[INFO] loading file 42-42/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (412914, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (412914, 17)

[INFO] analyzing data
[INFO] 412914 rows
[INFO] ** appi_name:[21:99.99177%,30:0.00218%,17:0.00121%,31:0.00097%,26:0.00097%,7:0.00097%,22:0.00073%,28:0.00024%,27:0.00024%,9:0.00024%,8:0.00024%,0:0.00024%]
[INFO] ** classification:[normal:64.37927%,Single Stage Single Point:35.62073%]
[INFO] ** dst:[21:43.31653%,10:21.05402%,8:18.17618%,9:17.44407%,16:0.00218%,6:0.00194%,18:0.00121%,2:0.00097%,22:0.00073%,15:0.00073%,17:0.00048%,25:0.00024%,24:0.00024%,7:0.00024%,0:0.00024%]
[INFO] ** i/f_dir:[1:99.99927%,0:0.00073%]
[INFO] ** i/f_name:[2:99.99927%,3:0.00073%]
[INFO] ** modbus_function_code:[0.02961:99.99177%,-33.760870000000004:0.00823%]
[INFO] ** modbus_function_description:[7:49.99661%,11:49.99516%,0:0.00823%]
[INFO] ** modbus_transaction_id:65536 (15.87159%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99564%,2:0.00363%,1:0.00073%]
[INFO] ** proxy_src_ip:[18:38.41357%,20:25.95722%,13:18.17667%,6:17.44407%,17:0.00218%,1:0.00218%,14:0.00145%,21:0.00097%,7:0.00073%,0:0.00048%,16:0.00024%,2:0.00024%]
[INFO] ** s_port:[1.45442:25.95674%,-0.32151:21.05402%,-1.27613:18.17618%,-0.23351:17.44383%,-0.33484:17.35955%,-71.14931:0.00097%,-71.14798:0.00097%,-71.33197:0.00073%,11.57001:0.00048%,-0.08551:0.00048%,-3.3787199999999995:0.00048%,-0.24151:0.00024%,13.431270000000001:0.00024%,-5.1466400000000005:0.00024%,0.31847:0.00024%,-1.02014:0.00024%,-1.2708:0.00024%,-58.035180000000004:0.00024%,7.66617:0.00024%,-64.19493:0.00024%,1.47576:0.00024%,14.4699:0.00024%,15.912510000000001:0.00024%,14.191239999999999:0.00024%,7.9608300000000005:0.00024%,-5.08665:0.00024%,10.192739999999999:0.00024%,-3.0613900000000003:0.00024%,1.45709:0.00024%,2.05573:0.00024%,-43.76509:0.00024%,11.862:0.00024%,-1.27347:0.00024%,-58.032509999999995:0.00024%]
[INFO] ** scada_tag:[3:25.95625%,1:21.05402%,5:18.17594%,4:17.44383%,2:17.3593%,0:0.01066%]
[INFO] ** service:[0.0048200000000000005:99.99177%,-211.09762999999998:0.0017%,-205.44247:0.00121%,-186.43601999999998:0.00121%,-211.08346:0.00097%,-211.08818:0.00097%,-211.73542999999998:0.00073%,-211.35747999999998:0.00048%,-186.44547:0.00024%,-183.8612:0.00024%,-185.9872:0.00024%,-202.75898:0.00024%]
[INFO] ** src:[22:38.41357%,9:25.95722%,7:18.17667%,1:17.44407%,3:0.00291%,2:0.0017%,4:0.00121%,21:0.00097%,14:0.00073%,8:0.00048%,17:0.00024%,15:0.00024%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1121 (0.27149%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/412914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.3376e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9910e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/412914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.1655e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4775e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/412914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1572e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8301e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/412914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1135e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.9410e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-41-42-batch-300000-400000
[INFO] processing batch 400000-500000/412914
[33m[INFO] loading file 43-43/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (512914, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (512914, 17)

[INFO] analyzing data
[INFO] 512914 rows
[INFO] ** appi_name:[21:99.99922%,30:0.00058%,26:0.00019%]
[INFO] ** classification:[normal:64.39949%,Single Stage Single Point:35.60051%]
[INFO] ** dst:[21:43.33085%,10:21.06688%,8:18.12936%,9:17.47096%,22:0.00097%,15:0.00058%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99942%,3:0.00058%]
[INFO] ** modbus_function_code:[0.02961:99.99922%,-33.760870000000004:0.00078%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99903%,0:0.00078%]
[INFO] ** modbus_transaction_id:65536 (12.77719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99922%,1:0.00058%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.42087%,20:25.97726%,13:18.12955%,6:17.47116%,17:0.00058%,16:0.00039%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.97667%,-0.32151:21.06688%,-1.27613:18.12916%,-0.23351:17.47077%,-0.33484:17.35398%,-71.33197:0.00058%,1.45709:0.00039%,-1.02014:0.00039%,-71.14798:0.00019%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.97628%,1:21.06688%,5:18.12897%,4:17.47038%,2:17.35379%,0:0.0037%]
[INFO] ** service:[0.0048200000000000005:99.99922%,-211.73542999999998:0.00058%,-211.08346:0.00019%]
[INFO] ** src:[22:38.42087%,9:25.97726%,7:18.12955%,1:17.47116%,14:0.00058%,15:0.00039%,3:0.00019%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1395 (0.27198%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.8394e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3619e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5295e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8907e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2887e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7759e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.2034e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1297e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.5763e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1638e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/512914
[33m[INFO] loading file 44-44/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (512914, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (512914, 17)

[INFO] analyzing data
[INFO] 512914 rows
[INFO] ** appi_name:[21:99.99805%,30:0.00078%,31:0.00058%,0:0.00039%,22:0.00019%]
[INFO] ** classification:[normal:64.36498%,Single Stage Single Point:35.63502%]
[INFO] ** dst:[21:43.32052%,10:21.04134%,8:18.1703%,9:17.46453%,22:0.00097%,15:0.00078%,18:0.00058%,25:0.00039%,24:0.00039%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99922%,0:0.00078%]
[INFO] ** i/f_name:[2:99.99922%,3:0.00078%]
[INFO] ** modbus_function_code:[0.02961:99.99805%,-33.760870000000004:0.00195%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99786%,0:0.00195%]
[INFO] ** modbus_transaction_id:65536 (12.77719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99805%,2:0.00117%,1:0.00078%]
[INFO] ** proxy_src_ip:[18:38.41034%,20:25.95191%,13:18.17049%,6:17.46511%,17:0.00078%,7:0.00039%,16:0.00019%,5:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95133%,-0.32151:21.04134%,-1.27613:18.16991%,-0.23351:17.46433%,-0.33484:17.36899%,-71.33197:0.00078%,-0.24151:0.00058%,-64.19493:0.00039%,-0.08551:0.00039%,-1.27347:0.00039%,1.46509:0.00019%,1.47576:0.00019%,-0.24950999999999998:0.00019%,1.45709:0.00019%,4.42897:0.00019%,-71.14931:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.95094%,1:21.04134%,5:18.16991%,4:17.46394%,2:17.3688%,0:0.00507%]
[INFO] ** service:[0.0048200000000000005:99.99805%,-211.73542999999998:0.00078%,-186.43601999999998:0.00058%,-186.44547:0.00039%,-211.08818:0.00019%]
[INFO] ** src:[22:38.41034%,9:25.95191%,7:18.17049%,1:17.46511%,14:0.00078%,21:0.00039%,17:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1391 (0.2712%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.5922e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8435e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.8326e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2099e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8841e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6312e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3962e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7753e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.6355e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.1059e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/512914
[33m[INFO] loading file 45-45/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (512914, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (512914, 17)

[INFO] analyzing data
[INFO] 512914 rows
[INFO] ** appi_name:[21:99.99903%,30:0.00058%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.42074%,Single Stage Single Point:35.57926%]
[INFO] ** dst:[21:43.32481%,10:21.09359%,8:18.11746%,9:17.46199%,22:0.00117%,15:0.00058%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name:[2:99.99942%,3:0.00058%]
[INFO] ** modbus_function_code:[0.02961:99.99903%,-33.760870000000004:0.00097%]
[INFO] ** modbus_function_description:[7:50.00039%,11:49.99864%,0:0.00097%]
[INFO] ** modbus_transaction_id:65536 (12.77719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99922%,1:0.00058%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.48715%,20:25.93183%,13:18.11727%,6:17.46238%,17:0.00058%,16:0.00039%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.93125%,-0.32151:21.09359%,-1.27613:18.11727%,-0.23351:17.46199%,-0.33484:17.39356%,1.45709:0.00058%,-71.33197:0.00058%,-1.02014:0.00039%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,14.4699:0.00019%,-0.24151:0.00019%]
[INFO] ** scada_tag:[3:25.93086%,1:21.0934%,5:18.11727%,4:17.46199%,2:17.39336%,0:0.00312%]
[INFO] ** service:[0.0048200000000000005:99.99903%,-211.73542999999998:0.00058%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.48715%,9:25.93183%,7:18.11727%,1:17.46238%,14:0.00058%,15:0.00039%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1392 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4938e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2726e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7651e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2535e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6242e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1462e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8843e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6330e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4498e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2886e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/512914
[33m[INFO] loading file 46-46/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (512914, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (512914, 17)

[INFO] analyzing data
[INFO] 512914 rows
[INFO] ** appi_name:[21:99.99825%,30:0.00097%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.42756%,Single Stage Single Point:35.57244%]
[INFO] ** dst:[21:43.3521%,10:21.07293%,8:18.10342%,9:17.46901%,22:0.00097%,15:0.00097%,25:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99903%,0:0.00097%]
[INFO] ** i/f_name:[2:99.99903%,3:0.00097%]
[INFO] ** modbus_function_code:[0.02961:99.99825%,-33.760870000000004:0.00175%]
[INFO] ** modbus_function_description:[11:49.99922%,7:49.99903%,0:0.00175%]
[INFO] ** modbus_transaction_id:65536 (12.77719%)
[INFO] ** orig:[0:99.99961%,1:0.00039%]
[INFO] ** proto:[0:99.99864%,1:0.00097%,2:0.00039%]
[INFO] ** proxy_src_ip:[18:38.44933%,20:25.9755%,13:18.10342%,6:17.4696%,17:0.00097%,16:0.00039%,7:0.00039%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.97531%,-0.32151:21.07273%,-1.27613:18.10323%,-0.23351:17.46882%,-0.33484:17.3766%,-71.33197:0.00097%,-0.24151:0.00058%,-1.02014:0.00039%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,10.192739999999999:0.00019%,1.47576:0.00019%,-61.95768:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.97492%,1:21.07254%,5:18.10303%,4:17.46843%,2:17.3766%,0:0.00448%]
[INFO] ** service:[0.0048200000000000005:99.99844%,-211.73542999999998:0.00097%,-186.44547:0.00019%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.44933%,9:25.9755%,7:18.10342%,1:17.4696%,14:0.00097%,21:0.00039%,15:0.00039%,16:0.00019%,8:0.00019%]
[INFO] ** type:[0:99.99922%,1:0.00078%]
[INFO] ** unixtime:1395 (0.27198%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.8078e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1195e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3717e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0329e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 9.8292e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.0468e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.8437e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0010 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-8-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 7.9523e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.6682e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/512914
[33m[INFO] loading file 47-47/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (512914, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (512914, 17)

[INFO] analyzing data
[INFO] 512914 rows
[INFO] ** appi_name:[21:99.99981%,33:0.00019%]
[INFO] ** classification:[normal:64.3913%,Single Stage Single Point:35.6087%]
[INFO] ** dst:[21:43.30219%,10:21.08736%,8:18.12643%,9:17.48188%,22:0.00175%,24:0.00039%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99981%,-33.760870000000004:0.00019%]
[INFO] ** modbus_function_description:[7:50.00136%,11:49.99844%,0:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.77719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.45771%,20:25.93261%,13:18.12682%,6:17.48227%,16:0.00039%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.93164%,-0.32151:21.08736%,-1.27613:18.12624%,-0.23351:17.48168%,-0.33484:17.37036%,1.45709:0.00058%,-0.24151:0.00058%,-1.27347:0.00039%,-1.02014:0.00039%,-61.95635:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.93105%,1:21.08716%,5:18.12604%,4:17.48149%,2:17.37016%,0:0.00409%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.45771%,9:25.93261%,7:18.12682%,1:17.48227%,15:0.00039%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1392 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6610e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.8089e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.1810e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.7265e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.7632e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2938e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9430e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7018e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6493e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.1536e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/512914
[33m[INFO] loading file 48-48/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (512914, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (512914, 17)

[INFO] analyzing data
[INFO] 512914 rows
[INFO] ** appi_name:[21:99.99669%,30:0.00273%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.41801%,Single Stage Single Point:35.58199%]
[INFO] ** dst:[21:43.33222%,10:21.0819%,8:18.11103%,9:17.47057%,15:0.00273%,22:0.00078%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99766%,0:0.00234%]
[INFO] ** i/f_name:[2:99.99727%,3:0.00273%]
[INFO] ** modbus_function_code:[0.02961:99.99669%,-33.760870000000004:0.00331%]
[INFO] ** modbus_function_description:[7:49.99903%,11:49.99766%,0:0.00331%]
[INFO] ** modbus_transaction_id:65536 (12.77719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99669%,1:0.00273%,2:0.00058%]
[INFO] ** proxy_src_ip:[18:38.45381%,20:25.96049%,13:18.11142%,6:17.47057%,17:0.00273%,14:0.00058%,16:0.00039%]
[INFO] ** s_port:[1.45442:25.9601%,-0.32151:21.0819%,-1.27613:18.11103%,-0.23351:17.47038%,-0.33484:17.37192%,-71.33197:0.00273%,-1.02014:0.00039%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,1.45709:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,13.431270000000001:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.95971%,1:21.0819%,5:18.11103%,4:17.47038%,2:17.37172%,0:0.00526%]
[INFO] ** service:[0.0048200000000000005:99.99669%,-211.73542999999998:0.00273%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.45381%,9:25.96049%,7:18.11142%,1:17.47057%,14:0.00273%,2:0.00058%,15:0.00039%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1392 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.0058e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.0944e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.4438e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9364e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.5625e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2340e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.3947e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2372e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.1352e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2970e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/512914
[33m[INFO] loading file 49-49/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (512914, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (512914, 17)

[INFO] analyzing data
[INFO] 512914 rows
[INFO] ** appi_name:[21:99.99727%,30:0.00097%,17:0.00078%,22:0.00039%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.36401%,Single Stage Single Point:35.63599%]
[INFO] ** dst:[21:43.2979%,10:21.06162%,8:18.14534%,9:17.49085%,22:0.00136%,15:0.00097%,16:0.00078%,6:0.00058%,17:0.00039%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99903%,0:0.00097%]
[INFO] ** i/f_name:[2:99.99903%,3:0.00097%]
[INFO] ** modbus_function_code:[0.02961:99.99727%,-33.760870000000004:0.00273%]
[INFO] ** modbus_function_description:[7:49.99942%,11:49.99786%,0:0.00273%]
[INFO] ** modbus_transaction_id:65536 (12.77719%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99844%,1:0.00097%,2:0.00058%]
[INFO] ** proxy_src_ip:[18:38.41814%,20:25.94217%,13:18.14515%,6:17.49143%,17:0.00097%,1:0.00078%,21:0.00039%,16:0.00039%,14:0.00039%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.94139%,-0.32151:21.06162%,-1.27613:18.14495%,-0.23351:17.49065%,-0.33484:17.35652%,-71.33197:0.00097%,-0.24151:0.00058%,1.45709:0.00039%,-1.02014:0.00039%,-71.14931:0.00039%,-71.14798:0.00019%,-58.035180000000004:0.00019%,-5.1466400000000005:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,-5.08665:0.00019%,-0.24950999999999998:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:25.941%,1:21.06143%,5:18.14476%,4:17.49026%,2:17.35652%,0:0.00604%]
[INFO] ** service:[0.0048200000000000005:99.99727%,-211.73542999999998:0.00097%,-205.44247:0.00078%,-211.08818:0.00039%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.41814%,9:25.94217%,7:18.14515%,1:17.49143%,14:0.00097%,3:0.00078%,15:0.00039%,4:0.00039%,2:0.00039%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1393 (0.27159%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.8350e-05 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2190e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.9212e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8279e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.4763e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.7406e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.3093e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4815e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/512914
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6912e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2252e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/512914
[33m[INFO] loading file 50-50/50 on epoch 8/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (362896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (362896, 17)

[INFO] analyzing data
[INFO] 362896 rows
[INFO] ** appi_name:[21:99.99752%,30:0.00083%,7:0.00083%,31:0.00028%,22:0.00028%,8:0.00028%]
[INFO] ** classification:[normal:64.2917%,Single Stage Single Point:35.7083%]
[INFO] ** dst:[21:43.24793%,10:21.04074%,8:18.22836%,9:17.47966%,15:0.00083%,22:0.00055%,16:0.00055%,2:0.00055%,24:0.00028%,18:0.00028%,6:0.00028%]
[INFO] ** i/f_dir:[1:99.99917%,0:0.00083%]
[INFO] ** i/f_name:[2:99.99917%,3:0.00083%]
[INFO] ** modbus_function_code:[0.02961:99.99752%,-33.760870000000004:0.00248%]
[INFO] ** modbus_function_description:[7:49.9989%,11:49.99862%,0:0.00248%]
[INFO] ** modbus_transaction_id:65535 (18.05889%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99862%,1:0.00083%,2:0.00055%]
[INFO] ** proxy_src_ip:[18:38.36113%,20:25.92781%,13:18.22864%,6:17.47966%,17:0.00083%,1:0.00083%,21:0.00028%,16:0.00028%,14:0.00028%,7:0.00028%]
[INFO] ** s_port:[1.45442:25.92726%,-0.32151:21.04074%,-1.27613:18.22809%,-0.23351:17.47966%,-0.33484:17.32039%,-71.33197:0.00083%,-3.3787199999999995:0.00028%,4.33564:0.00028%,15.912510000000001:0.00028%,7.9608300000000005:0.00028%,1.46509:0.00028%,1.45709:0.00028%,-1.27347:0.00028%,-71.14931:0.00028%,-1.02014:0.00028%,-1.2708:0.00028%,0.31847:0.00028%]
[INFO] ** scada_tag:[3:25.92699%,1:21.04046%,5:18.22781%,4:17.47966%,2:17.32011%,0:0.00496%]
[INFO] ** service:[0.0048200000000000005:99.99752%,-211.09762999999998:0.00083%,-211.73542999999998:0.00083%,-186.43601999999998:0.00028%,-211.35747999999998:0.00028%,-211.08818:0.00028%]
[INFO] ** src:[22:38.36113%,9:25.92781%,7:18.22864%,1:17.47966%,14:0.00083%,3:0.00083%,21:0.00028%,15:0.00028%,4:0.00028%,2:0.00028%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:986 (0.2717%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/362896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.1606e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7422e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/362896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.5294e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3718e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/362896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.8899e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6085e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-8-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/362896
[33m[INFO] epoch 9/10[0m
[33m[INFO] loading file 1-1/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.9936%,30:0.00107%,22:0.00089%,17:0.00071%,31:0.00053%,26:0.00053%,7:0.00053%,23:0.00036%,18:0.00036%,0:0.00036%,28:0.00018%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:77.62002%,Single Stage Single Point:22.37998%]
[INFO] ** dst:[21:43.26785%,10:21.03728%,8:18.16854%,9:17.5194%,6:0.00142%,22:0.00107%,16:0.00107%,15:0.00107%,18:0.00053%,26:0.00036%,25:0.00036%,19:0.00036%,17:0.00036%,24:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99893%,0:0.00107%]
[INFO] ** i/f_name:[2:99.99893%,3:0.00107%]
[INFO] ** modbus_function_code:[0.02961:99.9936%,-33.760870000000004:0.00622%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99769%,11:49.99591%,0:0.00622%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99645%,2:0.00249%,1:0.00107%]
[INFO] ** proxy_src_ip:[18:38.39875%,20:25.90603%,13:18.16872%,6:17.51975%,11:0.00124%,10:0.00124%,17:0.00107%,14:0.00089%,1:0.00089%,7:0.00053%,21:0.00036%,16:0.00036%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.9055%,-0.32151:21.03657%,-1.27613:18.16837%,-0.23351:17.51922%,-0.33484:17.36218%,-71.33197:0.00107%,-71.14931:0.00089%,-2.1481:0.00071%,-0.24151:0.00053%,-71.14798:0.00053%,-1.02014:0.00036%,-64.19493:0.00036%,-2.42942:0.00036%,4.44364:0.00036%,-43.76509:0.00018%,10.67005:0.00018%,4.29964:0.00018%,-5.08665:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,1.47576:0.00018%,1.46509:0.00018%,4.076980000000001:0.00018%,-58.032509999999995:0.00018%,-58.035180000000004:0.00018%,-1.2708:0.00018%,-1.27347:0.00018%,-5.1466400000000005:0.00018%,-68.79874000000001:0.00018%,14.253910000000001:0.00018%,1.45709:0.00018%]
[INFO] ** scada_tag:[3:25.90532%,1:21.03639%,5:18.16801%,4:17.51904%,2:17.362%,0:0.00924%]
[INFO] ** service:[0.0048200000000000005:99.99432%,-211.73542999999998:0.00107%,-211.08818:0.00089%,-205.44247:0.00071%,-211.07873999999998:0.00071%,-211.09762999999998:0.00053%,-211.08346:0.00053%,-186.43601999999998:0.00053%,-186.44547:0.00036%,-185.9872:0.00018%,-202.75898:0.00018%]
[INFO] ** src:[22:38.39875%,9:25.90603%,7:18.16872%,1:17.51975%,11:0.00124%,10:0.00124%,14:0.00107%,3:0.00089%,2:0.00089%,21:0.00053%,15:0.00036%,4:0.00036%,8:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1528 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0382 - tp: 79241.0000 - fp: 759.0000 - tn: 319241.0000 - fn: 759.0000 - accuracy: 0.9962 - precision: 0.9905 - recall: 0.9905 - auc: 0.9987 - val_loss: 6.2966e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.0461e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3013e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.6210e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.3494e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.5653 - tp: 62304.0000 - fp: 17696.0000 - tn: 302304.0000 - fn: 17696.0000 - accuracy: 0.9115 - precision: 0.7788 - recall: 0.7788 - auc: 0.8618 - val_loss: 7.5594 - val_tp: 10620.0000 - val_fp: 9380.0000 - val_tn: 70620.0000 - val_fn: 9380.0000 - val_accuracy: 0.8124 - val_precision: 0.5310 - val_recall: 0.5310 - val_auc: 0.7069
[INFO] saving weights to checkpoints/lstm-epoch-9-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 7.5586 - tp: 42484.0000 - fp: 37516.0000 - tn: 282484.0000 - fn: 37516.0000 - accuracy: 0.8124 - precision: 0.5311 - recall: 0.5311 - auc: 0.7069 - val_loss: 7.5546 - val_tp: 10626.0000 - val_fp: 9374.0000 - val_tn: 70626.0000 - val_fn: 9374.0000 - val_accuracy: 0.8125 - val_precision: 0.5313 - val_recall: 0.5313 - val_auc: 0.7071
[INFO] saving weights to checkpoints/lstm-epoch-9-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 2-2/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99858%,30:0.00053%,7:0.00053%,31:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:70.58124%,Single Stage Single Point:29.41876%]
[INFO] ** dst:[21:43.3112%,10:21.02982%,8:18.14154%,9:17.51496%,22:0.00089%,15:0.00053%,16:0.00036%,2:0.00036%,24:0.00018%,18:0.00018%]
[INFO] ** i/f_dir:[1:99.99947%,0:0.00053%]
[INFO] ** i/f_name:[2:99.99947%,3:0.00053%]
[INFO] ** modbus_function_code:[0.02961:99.99858%,-33.760870000000004:0.00142%]
[INFO] ** modbus_function_description:[7:49.99982%,11:49.99876%,0:0.00142%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99929%,1:0.00053%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.37974%,20:25.96181%,13:18.14154%,6:17.51531%,17:0.00053%,1:0.00053%,16:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.9611%,-0.32151:21.02982%,-1.27613:18.14118%,-0.23351:17.51478%,-0.33484:17.34992%,-71.33197:0.00053%,-0.24151:0.00036%,1.45709:0.00036%,1.46509:0.00018%,1.47576:0.00018%,12.60597:0.00018%,10.67005:0.00018%,-0.24950999999999998:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,4.076980000000001:0.00018%,-3.3787199999999995:0.00018%,4.29964:0.00018%,-1.27347:0.00018%]
[INFO] ** scada_tag:[3:25.96075%,1:21.02982%,5:18.14118%,4:17.51443%,2:17.34974%,0:0.00409%]
[INFO] ** service:[0.0048200000000000005:99.99858%,-211.09762999999998:0.00053%,-211.73542999999998:0.00053%,-211.35747999999998:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.37974%,9:25.96181%,7:18.14154%,1:17.51531%,14:0.00053%,3:0.00053%,21:0.00018%,15:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1531 (0.27199%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5823 - tp: 42205.0000 - fp: 37795.0000 - tn: 282205.0000 - fn: 37795.0000 - accuracy: 0.8110 - precision: 0.5276 - recall: 0.5276 - auc: 0.7056 - val_loss: 7.5828 - val_tp: 10591.0000 - val_fp: 9409.0000 - val_tn: 70591.0000 - val_fn: 9409.0000 - val_accuracy: 0.8118 - val_precision: 0.5296 - val_recall: 0.5296 - val_auc: 0.7060
[INFO] saving weights to checkpoints/lstm-epoch-9-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 7.5668 - tp: 42443.0000 - fp: 37557.0000 - tn: 282443.0000 - fn: 37557.0000 - accuracy: 0.8122 - precision: 0.5305 - recall: 0.5305 - auc: 0.7066 - val_loss: 3.5065 - val_tp: 15649.0000 - val_fp: 4351.0000 - val_tn: 75649.0000 - val_fn: 4351.0000 - val_accuracy: 0.9130 - val_precision: 0.7825 - val_recall: 0.7825 - val_auc: 0.8640
[INFO] saving weights to checkpoints/lstm-epoch-9-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.4118e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9022e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.0371 - tp: 54999.0000 - fp: 25001.0000 - tn: 294999.0000 - fn: 25001.0000 - accuracy: 0.8750 - precision: 0.6875 - recall: 0.6875 - auc: 0.8047 - val_loss: 7.5812 - val_tp: 10593.0000 - val_fp: 9407.0000 - val_tn: 70593.0000 - val_fn: 9407.0000 - val_accuracy: 0.8119 - val_precision: 0.5296 - val_recall: 0.5296 - val_auc: 0.7060
[INFO] saving weights to checkpoints/lstm-epoch-9-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 7.5959 - tp: 42299.0000 - fp: 37701.0000 - tn: 282299.0000 - fn: 37701.0000 - accuracy: 0.8115 - precision: 0.5287 - recall: 0.5287 - auc: 0.7055 - val_loss: 3.6935 - val_tp: 15417.0000 - val_fp: 4583.0000 - val_tn: 75417.0000 - val_fn: 4583.0000 - val_accuracy: 0.9083 - val_precision: 0.7709 - val_recall: 0.7709 - val_auc: 0.8568
[INFO] saving weights to checkpoints/lstm-epoch-9-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 3-3/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99183%,30:0.00213%,22:0.00107%,31:0.00089%,26:0.00089%,17:0.00089%,7:0.00071%,27:0.00036%,0:0.00036%,28:0.00018%,23:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:88.1964%,Single Stage Single Point:11.8036%]
[INFO] ** dst:[21:43.31102%,10:21.0808%,8:18.15451%,9:17.44461%,6:0.00213%,15:0.00142%,18:0.00124%,16:0.00124%,22:0.00089%,2:0.00036%,7:0.00036%,25:0.00036%,17:0.00036%,12:0.00018%,24:0.00018%,19:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99858%,0:0.00142%]
[INFO] ** i/f_name:[2:99.99858%,3:0.00142%]
[INFO] ** modbus_function_code:[0.02961:99.99183%,-33.760870000000004:0.00799%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99662%,11:49.9952%,0:0.00799%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.99893%,2:0.00107%]
[INFO] ** proto:[0:99.99432%,2:0.00426%,1:0.00142%]
[INFO] ** proxy_src_ip:[18:38.40514%,20:25.98704%,13:18.15469%,6:17.44496%,17:0.00213%,1:0.00142%,14:0.00124%,7:0.00089%,11:0.00071%,10:0.00071%,21:0.00053%,16:0.00018%,15:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.98633%,-0.32151:21.08063%,-1.27613:18.15415%,-0.23351:17.44443%,-0.33484:17.32451%,-71.33197:0.00142%,-71.14931:0.00107%,-71.14798:0.00107%,-64.19493:0.00036%,-0.08551:0.00036%,1.45709:0.00036%,-0.24151:0.00036%,14.4699:0.00018%,4.29964:0.00018%,4.90362:0.00018%,10.192739999999999:0.00018%,-3.3787199999999995:0.00018%,13.86459:0.00018%,4.44364:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,-43.76509:0.00018%,-5.08665:0.00018%,-58.035180000000004:0.00018%,4.076980000000001:0.00018%,-58.032509999999995:0.00018%,-1.27347:0.00018%,-1.2708:0.00018%,-1.02014:0.00018%,-5.1466400000000005:0.00018%,13.431270000000001:0.00018%,12.60597:0.00018%,1.47576:0.00018%,1.46509:0.00018%,14.253910000000001:0.00018%,-68.79874000000001:0.00018%,-0.24950999999999998:0.00018%,-2.1481:0.00018%,10.67005:0.00018%,-68.36943000000001:0.00018%]
[INFO] ** scada_tag:[3:25.98597%,1:21.08045%,5:18.15398%,4:17.44425%,2:17.32434%,0:0.01101%]
[INFO] ** service:[0.0048200000000000005:99.99201%,-211.73542999999998:0.00142%,-186.43601999999998:0.00124%,-211.08346:0.00107%,-211.08818:0.00107%,-205.44247:0.00089%,-211.09762999999998:0.00071%,-202.75898:0.00036%,-186.44547:0.00036%,-183.8612:0.00018%,-185.9872:0.00018%,-201.23771000000002:0.00018%,-211.35747999999998:0.00018%,-211.07873999999998:0.00018%]
[INFO] ** src:[22:38.40514%,9:25.98704%,7:18.15469%,1:17.44496%,21:0.00195%,3:0.0016%,2:0.00124%,11:0.00071%,10:0.00071%,4:0.00071%,14:0.00036%,8:0.00036%,17:0.00018%,15:0.00018%,13:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1529 (0.27163%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0370 - tp: 74853.0000 - fp: 5147.0000 - tn: 314853.0000 - fn: 5147.0000 - accuracy: 0.9743 - precision: 0.9357 - recall: 0.9357 - auc: 0.9598 - val_loss: 7.5957 - val_tp: 10575.0000 - val_fp: 9425.0000 - val_tn: 70575.0000 - val_fn: 9425.0000 - val_accuracy: 0.8115 - val_precision: 0.5288 - val_recall: 0.5288 - val_auc: 0.7055
[INFO] saving weights to checkpoints/lstm-epoch-9-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5924 - tp: 42316.0000 - fp: 37684.0000 - tn: 282316.0000 - fn: 37684.0000 - accuracy: 0.8116 - precision: 0.5289 - recall: 0.5289 - auc: 0.7056 - val_loss: 7.5739 - val_tp: 10602.0000 - val_fp: 9398.0000 - val_tn: 70602.0000 - val_fn: 9398.0000 - val_accuracy: 0.8120 - val_precision: 0.5301 - val_recall: 0.5301 - val_auc: 0.7063
[INFO] saving weights to checkpoints/lstm-epoch-9-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.9647 - tp: 75212.0000 - fp: 4788.0000 - tn: 315212.0000 - fn: 4788.0000 - accuracy: 0.9761 - precision: 0.9402 - recall: 0.9402 - auc: 0.9626 - val_loss: 3.4658e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.2249e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1981e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.1278e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9294e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 4-4/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99769%,30:0.00124%,31:0.00036%,33:0.00018%,26:0.00018%,23:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:92.22236%,Single Stage Single Point:7.77764%]
[INFO] ** dst:[21:43.35206%,10:20.94703%,8:18.17725%,9:17.52011%,22:0.00124%,15:0.00124%,18:0.00036%,24:0.00018%,19:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99893%,0:0.00107%]
[INFO] ** i/f_name:[2:99.99876%,3:0.00124%]
[INFO] ** modbus_function_code:[0.02961:99.99769%,-33.760870000000004:0.00231%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.99805%,0:0.00231%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.99893%,2:0.00107%]
[INFO] ** proto:[0:99.99822%,1:0.00124%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.26071%,20:26.03874%,13:18.17725%,6:17.52047%,17:0.00124%,16:0.00053%,21:0.00036%,14:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.03802%,-0.32151:20.94685%,-1.27613:18.17689%,-0.23351:17.51993%,-0.33484:17.31386%,-71.33197:0.00124%,-1.02014:0.00053%,1.45709:0.00036%,-0.08551:0.00036%,-0.24151:0.00036%,-1.2708:0.00018%,14.4699:0.00018%,4.44364:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-49.275529999999996:0.00018%]
[INFO] ** scada_tag:[3:26.03785%,1:20.94668%,5:18.17689%,4:17.51958%,2:17.31368%,0:0.00533%]
[INFO] ** service:[0.0048200000000000005:99.99787%,-211.73542999999998:0.00124%,-186.43601999999998:0.00036%,-183.8612:0.00018%,-211.08346:0.00018%,-211.07873999999998:0.00018%]
[INFO] ** src:[22:38.26071%,9:26.03874%,7:18.17725%,1:17.52047%,21:0.00107%,15:0.00053%,4:0.00036%,17:0.00018%,14:0.00018%,8:0.00018%,3:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1539 (0.27341%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1812e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6775e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6665e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5250e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0396e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1918e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1394e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1921e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.9185 - tp: 51769.0000 - fp: 28231.0000 - tn: 291769.0000 - fn: 28231.0000 - accuracy: 0.8588 - precision: 0.6471 - recall: 0.6471 - auc: 0.9130 - val_loss: 0.5351 - val_tp: 13699.0000 - val_fp: 6301.0000 - val_tn: 73699.0000 - val_fn: 6301.0000 - val_accuracy: 0.8740 - val_precision: 0.6849 - val_recall: 0.6849 - val_auc: 0.9471
[INFO] saving weights to checkpoints/lstm-epoch-9-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 5-5/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99645%,30:0.00249%,37:0.00018%,26:0.00018%,12:0.00018%,9:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:89.89796%,Single Stage Single Point:10.10204%]
[INFO] ** dst:[21:43.36343%,10:20.76689%,8:18.23996%,9:17.62546%,15:0.00249%,22:0.00089%,25:0.00018%,24:0.00018%,6:0.00018%,2:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99787%,0:0.00213%]
[INFO] ** i/f_name:[2:99.99751%,3:0.00249%]
[INFO] ** modbus_function_code:[0.02961:99.99645%,-33.760870000000004:0.00355%]
[INFO] ** modbus_function_description:[7:49.99893%,11:49.99751%,0:0.00355%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.99805%,2:0.00195%]
[INFO] ** proto:[0:99.99716%,1:0.00249%,2:0.00036%]
[INFO] ** proxy_src_ip:[18:38.00382%,20:26.12685%,13:18.23996%,6:17.62564%,17:0.00249%,1:0.00036%,21:0.00018%,16:0.00018%,7:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.12614%,-0.32151:20.76654%,-1.27613:18.23978%,-0.23351:17.62528%,-0.33484:17.23729%,-71.33197:0.00249%,-0.24151:0.00036%,1.45709:0.00036%,1.47576:0.00018%,1.46509:0.00018%,-49.275529999999996:0.00018%,-1.27347:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,2.22906:0.00018%,14.4699:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.12579%,1:20.76636%,5:18.2396%,4:17.62528%,2:17.23729%,0:0.00568%]
[INFO] ** service:[0.0048200000000000005:99.9968%,-211.73542999999998:0.00249%,-183.8612:0.00018%,-211.08346:0.00018%,-211.35747999999998:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.00382%,9:26.12685%,7:18.23996%,1:17.62564%,21:0.00213%,14:0.00053%,3:0.00036%,16:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1540 (0.27359%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0545 - tp: 79140.0000 - fp: 860.0000 - tn: 319140.0000 - fn: 860.0000 - accuracy: 0.9957 - precision: 0.9893 - recall: 0.9893 - auc: 0.9981 - val_loss: 0.5462 - val_tp: 17868.0000 - val_fp: 2132.0000 - val_tn: 77868.0000 - val_fn: 2132.0000 - val_accuracy: 0.9574 - val_precision: 0.8934 - val_recall: 0.8934 - val_auc: 0.9692
[INFO] saving weights to checkpoints/lstm-epoch-9-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1985 - tp: 76212.0000 - fp: 3788.0000 - tn: 316212.0000 - fn: 3788.0000 - accuracy: 0.9811 - precision: 0.9527 - recall: 0.9527 - auc: 0.9912 - val_loss: 0.0064 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2672 - tp: 69527.0000 - fp: 10473.0000 - tn: 309527.0000 - fn: 10473.0000 - accuracy: 0.9476 - precision: 0.8691 - recall: 0.8691 - auc: 0.9860 - val_loss: 0.3398 - val_tp: 12867.0000 - val_fp: 7133.0000 - val_tn: 72867.0000 - val_fn: 7133.0000 - val_accuracy: 0.8573 - val_precision: 0.6434 - val_recall: 0.6434 - val_auc: 0.9680
[INFO] saving weights to checkpoints/lstm-epoch-9-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0272 - tp: 79095.0000 - fp: 905.0000 - tn: 319095.0000 - fn: 905.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 2.1439e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5955e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4308e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 6-6/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99591%,30:0.0032%,31:0.00018%,27:0.00018%,26:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:92.82194%,Single Stage Single Point:7.17806%]
[INFO] ** dst:[21:43.37764%,10:20.73154%,8:18.27602%,9:17.61%,15:0.0032%,22:0.00053%,25:0.00018%,24:0.00018%,18:0.00018%,12:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99698%,0:0.00302%]
[INFO] ** i/f_name:[2:99.9968%,3:0.0032%]
[INFO] ** modbus_function_code:[0.02961:99.99591%,-33.760870000000004:0.00409%]
[INFO] ** modbus_function_description:[7:49.99858%,11:49.99734%,0:0.00409%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.99964%,1:0.00036%]
[INFO] ** proto:[0:99.99591%,1:0.0032%,2:0.00089%]
[INFO] ** proxy_src_ip:[18:37.94253%,20:26.16682%,13:18.2762%,6:17.61018%,17:0.0032%,14:0.00053%,16:0.00036%,11:0.00018%]
[INFO] ** s_port:[1.45442:26.16647%,-0.32151:20.73154%,-1.27613:18.27567%,-0.23351:17.60982%,-0.33484:17.21099%,-71.33197:0.0032%,-1.02014:0.00036%,-71.14798:0.00018%,-64.19493:0.00018%,4.90362:0.00018%,-1.2708:0.00018%,-0.24151:0.00018%,13.431270000000001:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-68.36943000000001:0.00018%]
[INFO] ** scada_tag:[3:26.16629%,1:20.73118%,5:18.27549%,4:17.60947%,2:17.21082%,0:0.00675%]
[INFO] ** service:[0.0048200000000000005:99.99591%,-211.73542999999998:0.0032%,-211.08346:0.00018%,-201.23771000000002:0.00018%,-202.75898:0.00018%,-186.44547:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:37.94253%,9:26.16682%,7:18.2762%,1:17.61018%,14:0.0032%,2:0.00053%,15:0.00036%,10:0.00018%]
[INFO] ** type:[0:99.99911%,1:0.00089%]
[INFO] ** unixtime:1541 (0.27376%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0879e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0137e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.8840e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.9452e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.9921e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.1865e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.6570e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.0974e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3092 - tp: 69156.0000 - fp: 10844.0000 - tn: 309156.0000 - fn: 10844.0000 - accuracy: 0.9458 - precision: 0.8644 - recall: 0.8644 - auc: 0.9839 - val_loss: 0.3682 - val_tp: 12752.0000 - val_fp: 7248.0000 - val_tn: 72752.0000 - val_fn: 7248.0000 - val_accuracy: 0.8550 - val_precision: 0.6376 - val_recall: 0.6376 - val_auc: 0.9672
[INFO] saving weights to checkpoints/lstm-epoch-9-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 7-7/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99538%,30:0.0016%,22:0.00089%,17:0.00071%,26:0.00053%,31:0.00036%,28:0.00018%,27:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:80.62484%,Single Stage Single Point:19.37516%]
[INFO] ** dst:[21:43.35934%,10:20.74397%,8:18.25168%,9:17.6386%,15:0.0016%,22:0.00142%,6:0.00142%,16:0.00071%,24:0.00036%,18:0.00036%,17:0.00036%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.9984%,0:0.0016%]
[INFO] ** i/f_name:[2:99.9984%,3:0.0016%]
[INFO] ** modbus_function_code:[0.02961:99.99538%,-33.760870000000004:0.00462%]
[INFO] ** modbus_function_description:[7:49.9984%,11:49.99698%,0:0.00462%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99645%,2:0.00195%,1:0.0016%]
[INFO] ** proxy_src_ip:[18:37.96758%,20:26.13644%,13:18.25204%,6:17.63878%,17:0.0016%,11:0.00071%,1:0.00071%,21:0.00053%,16:0.00053%,14:0.00036%,7:0.00036%,10:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13556%,-0.32151:20.74397%,-1.27613:18.25151%,-0.23351:17.63843%,-0.33484:17.22361%,-71.33197:0.0016%,-71.14931:0.00089%,-1.02014:0.00053%,-71.14798:0.00053%,1.45709:0.00053%,-0.24151:0.00036%,-1.27347:0.00036%,1.47576:0.00018%,1.46509:0.00018%,14.253910000000001:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,-68.79874000000001:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,6.1115699999999995:0.00018%,-5.08665:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:26.1352%,1:20.74397%,5:18.25133%,4:17.63825%,2:17.22361%,0:0.00764%]
[INFO] ** service:[0.0048200000000000005:99.99538%,-211.73542999999998:0.0016%,-211.08818:0.00089%,-205.44247:0.00071%,-211.08346:0.00053%,-186.43601999999998:0.00036%,-211.09762999999998:0.00018%,-185.9872:0.00018%,-202.75898:0.00018%]
[INFO] ** src:[22:37.96758%,9:26.13644%,7:18.25204%,1:17.63878%,14:0.0016%,10:0.00071%,3:0.00071%,15:0.00053%,4:0.00053%,21:0.00036%,2:0.00036%,11:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1538 (0.27323%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0284 - tp: 78594.0000 - fp: 1406.0000 - tn: 318594.0000 - fn: 1406.0000 - accuracy: 0.9930 - precision: 0.9824 - recall: 0.9824 - auc: 0.9999 - val_loss: 3.2569e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.5247e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2157e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9464e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7224e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.1873 - tp: 76804.0000 - fp: 3196.0000 - tn: 316804.0000 - fn: 3196.0000 - accuracy: 0.9840 - precision: 0.9600 - recall: 0.9600 - auc: 0.9895 - val_loss: 0.0130 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0017 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4963e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 8-8/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99716%,30:0.00107%,0:0.00053%,24:0.00018%,23:0.00018%,22:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:94.92304%,Single Stage Single Point:5.07696%]
[INFO] ** dst:[21:43.42081%,10:20.79905%,8:18.19537%,9:17.58122%,22:0.00124%,15:0.00107%,25:0.00053%,19:0.00036%,26:0.00018%,24:0.00018%]
[INFO] ** i/f_dir:[1:99.99929%,0:0.00071%]
[INFO] ** i/f_name:[2:99.99893%,3:0.00107%]
[INFO] ** modbus_function_code:[0.02961:99.99716%,-33.760870000000004:0.00266%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.99751%,0:0.00266%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.99964%,2:0.00036%]
[INFO] ** proto:[0:99.99822%,1:0.00107%,2:0.00071%]
[INFO] ** proxy_src_ip:[18:38.08075%,20:26.13964%,13:18.19466%,6:17.58158%,17:0.00107%,10:0.00107%,16:0.00053%,14:0.00036%,11:0.00018%,5:0.00018%]
[INFO] ** s_port:[1.45442:26.13911%,-0.32151:20.79905%,-1.27613:18.19448%,-0.23351:17.58105%,-0.33484:17.2817%,-71.33197:0.00107%,-15.039579999999999:0.00071%,-1.02014:0.00053%,-64.19493:0.00053%,1.45709:0.00036%,-0.24151:0.00036%,4.66896:0.00036%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.13858%,1:20.79887%,5:18.19448%,4:17.58087%,2:17.28152%,0:0.00568%]
[INFO] ** service:[0.0048200000000000005:99.99787%,-211.73542999999998:0.00107%,-186.44547:0.00053%,-211.07873999999998:0.00036%,-211.08818:0.00018%]
[INFO] ** src:[22:38.08075%,9:26.13964%,7:18.19466%,1:17.58158%,11:0.00107%,14:0.00071%,15:0.00053%,21:0.00036%,2:0.00036%,16:0.00018%,10:0.00018%]
[INFO] ** type:[0:99.99947%,1:0.00036%,2:0.00018%]
[INFO] ** unixtime:1541 (0.27376%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.9650e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4435e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.1014e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.2987e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 6.9125e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.9188e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.1544e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5491e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1602 - tp: 76878.0000 - fp: 3122.0000 - tn: 316878.0000 - fn: 3122.0000 - accuracy: 0.9844 - precision: 0.9610 - recall: 0.9610 - auc: 0.9944 - val_loss: 0.0186 - val_tp: 19995.0000 - val_fp: 5.0000 - val_tn: 79995.0000 - val_fn: 5.0000 - val_accuracy: 0.9999 - val_precision: 0.9998 - val_recall: 0.9998 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 9-9/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99822%,30:0.00107%,31:0.00036%,26:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:94.51106%,Single Stage Single Point:5.48894%]
[INFO] ** dst:[21:43.3732%,10:20.77133%,8:18.28153%,9:17.5711%,15:0.00107%,22:0.00089%,18:0.00036%,25:0.00018%,24:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99893%,0:0.00107%]
[INFO] ** i/f_name:[2:99.99893%,3:0.00107%]
[INFO] ** modbus_function_code:[0.02961:99.99822%,-33.760870000000004:0.00178%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99822%,0:0.00178%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.99964%,2:0.00036%]
[INFO] ** proto:[0:99.99822%,1:0.00107%,2:0.00071%]
[INFO] ** proxy_src_ip:[18:38.00755%,20:26.13751%,13:18.28153%,6:17.57145%,17:0.00107%,21:0.00018%,16:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.1368%,-0.32151:20.77133%,-1.27613:18.28117%,-0.23351:17.57092%,-0.33484:17.23622%,-71.33197:0.00107%,-0.24151:0.00036%,1.45709:0.00036%,-0.08551:0.00036%,1.46509:0.00018%,1.47576:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.13644%,1:20.77115%,5:18.28117%,4:17.57074%,2:17.23604%,0:0.00444%]
[INFO] ** service:[0.0048200000000000005:99.99822%,-211.73542999999998:0.00107%,-186.43601999999998:0.00036%,-211.08346:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.00755%,9:26.13751%,7:18.28153%,1:17.57145%,14:0.00071%,21:0.00036%,17:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1541 (0.27376%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0115 - tp: 79926.0000 - fp: 74.0000 - tn: 319926.0000 - fn: 74.0000 - accuracy: 0.9996 - precision: 0.9991 - recall: 0.9991 - auc: 1.0000 - val_loss: 0.0064 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0783 - tp: 77943.0000 - fp: 2057.0000 - tn: 317943.0000 - fn: 2057.0000 - accuracy: 0.9897 - precision: 0.9743 - recall: 0.9743 - auc: 0.9988 - val_loss: 0.3386 - val_tp: 16361.0000 - val_fp: 3639.0000 - val_tn: 76361.0000 - val_fn: 3639.0000 - val_accuracy: 0.9272 - val_precision: 0.8181 - val_recall: 0.8181 - val_auc: 0.9917
[INFO] saving weights to checkpoints/lstm-epoch-9-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0052 - tp: 79774.0000 - fp: 226.0000 - tn: 319774.0000 - fn: 226.0000 - accuracy: 0.9989 - precision: 0.9972 - recall: 0.9972 - auc: 1.0000 - val_loss: 1.7405e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5574e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3543e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2247e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0814e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 10-10/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99627%,30:0.00178%,31:0.00036%,26:0.00018%,24:0.00018%,23:0.00018%,22:0.00018%,18:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:94.57289%,Single Stage Single Point:5.42711%]
[INFO] ** dst:[21:43.41353%,10:20.80526%,8:18.22433%,9:17.55298%,15:0.00178%,22:0.00053%,24:0.00036%,19:0.00036%,18:0.00036%,26:0.00018%,25:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.9984%,0:0.0016%]
[INFO] ** i/f_name:[2:99.99822%,3:0.00178%]
[INFO] ** modbus_function_code:[0.02961:99.99627%,-33.760870000000004:0.00355%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99876%,11:49.99751%,0:0.00355%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.99929%,1:0.00071%]
[INFO] ** proto:[0:99.99734%,1:0.00178%,2:0.00089%]
[INFO] ** proxy_src_ip:[18:38.08217%,20:26.13715%,13:18.2245%,6:17.55227%,17:0.00178%,10:0.00089%,14:0.00036%,21:0.00018%,16:0.00018%,5:0.00018%,2:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.13644%,-0.32151:20.80526%,-1.27613:18.22397%,-0.23351:17.55191%,-0.33484:17.2769%,-71.33197:0.00178%,-10.51843:0.00071%,-0.08551:0.00036%,-1.27347:0.00036%,5.71692:0.00036%,1.47576:0.00036%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-71.14931:0.00018%,-64.19493:0.00018%,1.45709:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.13609%,1:20.80509%,5:18.22397%,4:17.55173%,2:17.27673%,0:0.0064%]
[INFO] ** service:[0.0048200000000000005:99.99698%,-211.73542999999998:0.00178%,-211.07873999999998:0.00036%,-186.43601999999998:0.00036%,-211.08346:0.00018%,-186.44547:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.08217%,9:26.13715%,7:18.2245%,1:17.55227%,14:0.00178%,11:0.00089%,2:0.00036%,17:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%]
[INFO] ** type:[0:99.99858%,1:0.00124%,2:0.00018%]
[INFO] ** unixtime:1538 (0.27323%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0923e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.3202e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.4674e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.7930e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3476 - tp: 66290.0000 - fp: 13710.0000 - tn: 306290.0000 - fn: 13710.0000 - accuracy: 0.9315 - precision: 0.8286 - recall: 0.8286 - auc: 0.9814 - val_loss: 0.3198 - val_tp: 12924.0000 - val_fp: 7076.0000 - val_tn: 72924.0000 - val_fn: 7076.0000 - val_accuracy: 0.8585 - val_precision: 0.6462 - val_recall: 0.6462 - val_auc: 0.9680
[INFO] saving weights to checkpoints/lstm-epoch-9-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2337 - tp: 69997.0000 - fp: 10003.0000 - tn: 309997.0000 - fn: 10003.0000 - accuracy: 0.9500 - precision: 0.8750 - recall: 0.8750 - auc: 0.9888 - val_loss: 0.1622 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0190 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0010 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 11-11/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99893%,31:0.00036%,30:0.00036%,26:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.39221%,10:20.87455%,8:18.19484%,9:17.5361%,22:0.00124%,18:0.00036%,15:0.00036%,25:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99964%,3:0.00036%]
[INFO] ** modbus_function_code:[0.02961:99.99893%,-33.760870000000004:0.00107%]
[INFO] ** modbus_function_description:[7:50.00071%,11:49.99822%,0:0.00107%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99893%,2:0.00071%,1:0.00036%]
[INFO] ** proxy_src_ip:[18:38.14843%,20:26.11868%,13:18.19484%,6:17.53645%,16:0.00053%,17:0.00036%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.11815%,-0.32151:20.87455%,-1.27613:18.19466%,-0.23351:17.53592%,-0.33484:17.27388%,-0.24151:0.00053%,-1.02014:0.00053%,-0.08551:0.00036%,-71.33197:0.00036%,-71.14798:0.00018%,1.45709:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:26.11779%,1:20.87437%,5:18.19448%,4:17.53557%,2:17.27371%,0:0.00409%]
[INFO] ** service:[0.0048200000000000005:99.99893%,-211.73542999999998:0.00036%,-186.43601999999998:0.00036%,-211.08346:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.14843%,9:26.11868%,7:18.19484%,1:17.53645%,15:0.00053%,14:0.00036%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1538 (0.27323%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.0909e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9589e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.2324e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7311e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4532e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2231e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0536e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.9780e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.1542e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.3160e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 12-12/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99787%,30:0.00195%,9:0.00018%]
[INFO] ** classification:[normal:93.57057%,Single Stage Single Point:6.42943%]
[INFO] ** dst:[21:43.40447%,10:20.88254%,8:18.17654%,9:17.53343%,15:0.00195%,22:0.00053%,24:0.00036%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.9984%,0:0.0016%]
[INFO] ** i/f_name:[2:99.99805%,3:0.00195%]
[INFO] ** modbus_function_code:[0.02961:99.99787%,-33.760870000000004:0.00213%]
[INFO] ** modbus_function_description:[7:49.99982%,11:49.99805%,0:0.00213%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.9984%,2:0.0016%]
[INFO] ** proto:[0:99.99805%,1:0.00195%]
[INFO] ** proxy_src_ip:[18:38.15536%,20:26.132%,13:18.17671%,6:17.53361%,17:0.00195%,16:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:26.13147%,-0.32151:20.88254%,-1.27613:18.17618%,-0.23351:17.53326%,-0.33484:17.27282%,-71.33197:0.00195%,-1.27347:0.00036%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:26.13111%,1:20.88254%,5:18.17618%,4:17.5329%,2:17.27282%,0:0.00444%]
[INFO] ** service:[0.0048200000000000005:99.99787%,-211.73542999999998:0.00195%,-183.8612:0.00018%]
[INFO] ** src:[22:38.15536%,9:26.132%,7:18.17671%,1:17.53361%,21:0.0016%,14:0.00036%,15:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1539 (0.27341%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.5962e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.0315e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.4155e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8788e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.2675 - tp: 70451.0000 - fp: 9549.0000 - tn: 310451.0000 - fn: 9549.0000 - accuracy: 0.9523 - precision: 0.8806 - recall: 0.8806 - auc: 0.9869 - val_loss: 0.4016 - val_tp: 12828.0000 - val_fp: 7172.0000 - val_tn: 72828.0000 - val_fn: 7172.0000 - val_accuracy: 0.8566 - val_precision: 0.6414 - val_recall: 0.6414 - val_auc: 0.9679
[INFO] saving weights to checkpoints/lstm-epoch-9-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.2287 - tp: 70517.0000 - fp: 9483.0000 - tn: 310517.0000 - fn: 9483.0000 - accuracy: 0.9526 - precision: 0.8815 - recall: 0.8815 - auc: 0.9897 - val_loss: 0.4052 - val_tp: 12849.0000 - val_fp: 7151.0000 - val_tn: 72849.0000 - val_fn: 7151.0000 - val_accuracy: 0.8570 - val_precision: 0.6424 - val_recall: 0.6424 - val_auc: 0.9680
[INFO] saving weights to checkpoints/lstm-epoch-9-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0219 - tp: 79272.0000 - fp: 728.0000 - tn: 319272.0000 - fn: 728.0000 - accuracy: 0.9964 - precision: 0.9909 - recall: 0.9909 - auc: 1.0000 - val_loss: 5.4075e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 13-13/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99662%,31:0.00071%,26:0.00053%,0:0.00053%,30:0.00036%,22:0.00036%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:86.40726%,Single Stage Single Point:13.59274%]
[INFO] ** dst:[21:43.35881%,10:20.8058%,8:18.27442%,9:17.55706%,22:0.00107%,6:0.00089%,18:0.00071%,25:0.00053%,15:0.00036%,24:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99964%,0:0.00036%]
[INFO] ** i/f_name:[2:99.99964%,3:0.00036%]
[INFO] ** modbus_function_code:[0.02961:99.99662%,-33.760870000000004:0.0032%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99876%,11:49.99787%,0:0.0032%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99734%,2:0.00231%,1:0.00036%]
[INFO] ** proxy_src_ip:[18:38.05392%,20:26.11104%,13:18.2746%,6:17.55653%,10:0.00107%,11:0.00089%,16:0.00053%,17:0.00036%,7:0.00036%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.11051%,-0.32151:20.8058%,-1.27613:18.27425%,-0.23351:17.55617%,-0.33484:17.24812%,-9.78512:0.00071%,-64.19493:0.00053%,-1.02014:0.00053%,-71.14798:0.00053%,-0.24151:0.00036%,-71.14931:0.00036%,-0.08551:0.00036%,-71.33197:0.00036%,1.47576:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-1.2708:0.00018%,-68.79874000000001:0.00018%,6.1115699999999995:0.00018%,14.540560000000001:0.00018%,1.45709:0.00018%]
[INFO] ** scada_tag:[3:26.11015%,1:20.80562%,5:18.27425%,4:17.55617%,2:17.24795%,0:0.00586%]
[INFO] ** service:[0.0048200000000000005:99.99734%,-186.43601999999998:0.00071%,-211.08346:0.00053%,-186.44547:0.00053%,-211.73542999999998:0.00036%,-211.08818:0.00036%,-202.75898:0.00018%]
[INFO] ** src:[22:38.05392%,9:26.11104%,7:18.2746%,1:17.55653%,11:0.00107%,10:0.00089%,15:0.00053%,21:0.00036%,14:0.00036%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1538 (0.27323%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.1393e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1697e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7470e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4223e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2090e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0487e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2930 - tp: 68766.0000 - fp: 11234.0000 - tn: 308766.0000 - fn: 11234.0000 - accuracy: 0.9438 - precision: 0.8596 - recall: 0.8596 - auc: 0.9843 - val_loss: 0.3418 - val_tp: 12851.0000 - val_fp: 7149.0000 - val_tn: 72851.0000 - val_fn: 7149.0000 - val_accuracy: 0.8570 - val_precision: 0.6425 - val_recall: 0.6425 - val_auc: 0.9678
[INFO] saving weights to checkpoints/lstm-epoch-9-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0112 - tp: 79463.0000 - fp: 537.0000 - tn: 319463.0000 - fn: 537.0000 - accuracy: 0.9973 - precision: 0.9933 - recall: 0.9933 - auc: 1.0000 - val_loss: 2.0897e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 14-14/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99947%,30:0.00018%,26:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:92.90757%,Single Stage Single Point:7.09243%]
[INFO] ** dst:[21:43.35188%,10:20.81024%,8:18.26323%,9:17.57305%,22:0.00071%,24:0.00036%,15:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:99.99982%,3:0.00018%]
[INFO] ** modbus_function_code:[0.02961:99.99947%,-33.760870000000004:0.00053%]
[INFO] ** modbus_function_description:[7:50.00053%,11:49.99893%,0:0.00053%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99964%,2:0.00018%,1:0.00018%]
[INFO] ** proxy_src_ip:[18:38.05126%,20:26.1114%,13:18.26341%,6:17.57323%,21:0.00018%,17:0.00018%,16:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:26.11068%,-0.32151:20.81024%,-1.27613:18.26288%,-0.23351:17.57287%,-0.33484:17.24102%,-1.27347:0.00036%,1.45709:0.00036%,-71.14798:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,14.4699:0.00018%,-71.33197:0.00018%]
[INFO] ** scada_tag:[3:26.11033%,1:20.81024%,5:18.2627%,4:17.57252%,2:17.24084%,0:0.00338%]
[INFO] ** service:[0.0048200000000000005:99.99947%,-183.8612:0.00018%,-211.08346:0.00018%,-211.73542999999998:0.00018%]
[INFO] ** src:[22:38.05126%,9:26.1114%,7:18.26341%,1:17.57323%,15:0.00018%,14:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1538 (0.27323%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5732e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2264e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2590 - tp: 74275.0000 - fp: 5725.0000 - tn: 314275.0000 - fn: 5725.0000 - accuracy: 0.9714 - precision: 0.9284 - recall: 0.9284 - auc: 0.9877 - val_loss: 0.0540 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0099 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3699e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6664e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1293e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.8707e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.7312e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 15-15/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (562896, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (562896, 17)

[INFO] analyzing data
[INFO] 562896 rows
[INFO] ** appi_name:[21:99.99627%,30:0.00302%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:90.18824%,Single Stage Multi Point:9.81105%,Single Stage Single Point:0.00071%]
[INFO] ** dst:[21:43.30462%,10:20.77684%,8:18.31209%,9:17.60112%,15:0.00302%,22:0.0016%,25:0.00018%,24:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99716%,0:0.00284%]
[INFO] ** i/f_name:[2:99.99698%,3:0.00302%]
[INFO] ** modbus_function_code:[0.02961:99.99627%,-33.760870000000004:0.00373%]
[INFO] ** modbus_function_description:[7:49.99911%,11:49.99716%,0:0.00373%]
[INFO] ** modbus_transaction_id:65536 (11.64265%)
[INFO] ** orig:[0:99.99734%,2:0.00266%]
[INFO] ** proto:[0:99.99662%,1:0.00302%,2:0.00036%]
[INFO] ** proxy_src_ip:[18:38.01093%,20:26.07125%,13:18.31173%,6:17.60165%,17:0.00302%,16:0.00071%,7:0.00036%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:26.07036%,-0.32151:20.77666%,-1.27613:18.31155%,-0.23351:17.60094%,-0.33484:17.23427%,-71.33197:0.00302%,-1.02014:0.00071%,-0.24151:0.00053%,1.46509:0.00036%,1.45709:0.00036%,1.47576:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-61.95768:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%,-71.14798:0.00018%]
[INFO] ** scada_tag:[3:26.07%,1:20.77648%,5:18.31155%,4:17.60059%,2:17.23409%,0:0.00728%]
[INFO] ** service:[0.0048200000000000005:99.99645%,-211.73542999999998:0.00302%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.01093%,9:26.07125%,7:18.31173%,1:17.60165%,21:0.00302%,15:0.00071%,14:0.00036%,16:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1547 (0.27483%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.4144e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.9105e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.4038e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1397e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.8197e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1496e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3510e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.5077e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/562896
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.3117 - tp: 63563.0000 - fp: 16437.0000 - tn: 303563.0000 - fn: 16437.0000 - accuracy: 0.9178 - precision: 0.7945 - recall: 0.7945 - auc: 0.8716 - val_loss: 7.5231 - val_tp: 10665.0000 - val_fp: 9335.0000 - val_tn: 70665.0000 - val_fn: 9335.0000 - val_accuracy: 0.8133 - val_precision: 0.5332 - val_recall: 0.5332 - val_auc: 0.7083
[INFO] saving weights to checkpoints/lstm-epoch-9-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/562896
[33m[INFO] loading file 16-16/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (502586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (502586, 17)

[INFO] analyzing data
[INFO] 502586 rows
[INFO] ** appi_name:[21:99.99821%,30:0.00159%,33:0.0002%]
[INFO] ** classification:[normal:80.50821%,Single Stage Multi Point:19.49179%]
[INFO] ** dst:[21:43.34661%,10:20.79465%,8:18.26155%,9:17.5942%,15:0.00159%,22:0.00119%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.99841%,0:0.00159%]
[INFO] ** i/f_name:[2:99.99841%,3:0.00159%]
[INFO] ** modbus_function_code:[0.02961:99.99821%,-33.760870000000004:0.00179%]
[INFO] ** modbus_function_description:[7:50.0004%,11:49.99781%,0:0.00179%]
[INFO] ** modbus_transaction_id:65536 (13.03976%)
[INFO] ** orig:[0:99.99841%,2:0.00159%]
[INFO] ** proto:[0:99.99841%,1:0.00159%]
[INFO] ** proxy_src_ip:[18:38.04065%,20:26.10081%,13:18.26195%,6:17.5944%,17:0.00159%,16:0.0004%,21:0.0002%]
[INFO] ** s_port:[1.45442:26.10021%,-0.32151:20.79445%,-1.27613:18.26155%,-0.23351:17.594%,-0.33484:17.2462%,-71.33197:0.00159%,1.45709:0.0004%,-0.24151:0.0004%,-1.02014:0.0004%,-1.27347:0.0002%,1.47576:0.0002%,-49.275529999999996:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:26.09981%,1:20.79425%,5:18.26135%,4:17.59361%,2:17.246%,0:0.00497%]
[INFO] ** service:[0.0048200000000000005:99.99841%,-211.73542999999998:0.00159%]
[INFO] ** src:[22:38.04065%,9:26.10081%,7:18.26195%,1:17.5944%,21:0.00159%,15:0.0004%,4:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1376 (0.27378%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5584 - tp: 42486.0000 - fp: 37514.0000 - tn: 282486.0000 - fn: 37514.0000 - accuracy: 0.8124 - precision: 0.5311 - recall: 0.5311 - auc: 0.7068 - val_loss: 7.5489 - val_tp: 10633.0000 - val_fp: 9367.0000 - val_tn: 70633.0000 - val_fn: 9367.0000 - val_accuracy: 0.8127 - val_precision: 0.5317 - val_recall: 0.5317 - val_auc: 0.7073
[INFO] saving weights to checkpoints/lstm-epoch-9-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5469 - tp: 42542.0000 - fp: 37458.0000 - tn: 282542.0000 - fn: 37458.0000 - accuracy: 0.8127 - precision: 0.5318 - recall: 0.5318 - auc: 0.7074 - val_loss: 7.5731 - val_tp: 10603.0000 - val_fp: 9397.0000 - val_tn: 70603.0000 - val_fn: 9397.0000 - val_accuracy: 0.8121 - val_precision: 0.5301 - val_recall: 0.5301 - val_auc: 0.7063
[INFO] saving weights to checkpoints/lstm-epoch-9-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.8516 - tp: 75773.0000 - fp: 4227.0000 - tn: 315773.0000 - fn: 4227.0000 - accuracy: 0.9789 - precision: 0.9472 - recall: 0.9472 - auc: 0.9670 - val_loss: 5.5117e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.9897e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5076e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.1190e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6954e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-15-16-batch-400000-500000
[INFO] processing batch 500000-600000/502586
[33m[INFO] loading file 17-17/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (502586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (502586, 17)

[INFO] analyzing data
[INFO] 502586 rows
[INFO] ** appi_name:[21:99.99702%,7:0.0006%,26:0.0004%,0:0.0004%,31:0.0002%,27:0.0002%,24:0.0002%,22:0.0002%,16:0.0002%,15:0.0002%,8:0.0002%,5:0.0002%]
[INFO] ** classification:[normal:93.86175%,Multi Stage Multi Point:6.13825%]
[INFO] ** dst:[21:43.35298%,10:20.85195%,8:18.19171%,9:17.60017%,22:0.0008%,6:0.0006%,25:0.0004%,16:0.0004%,2:0.0004%,24:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99702%,-33.760870000000004:0.00279%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9994%,11:49.99761%,0:0.00279%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.03976%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99861%,2:0.00139%]
[INFO] ** proxy_src_ip:[18:38.08841%,20:26.11712%,13:18.19112%,6:17.60017%,10:0.00119%,11:0.00099%,1:0.0004%,16:0.0002%,14:0.0002%,7:0.0002%]
[INFO] ** s_port:[1.45442:26.11633%,-0.32151:20.85195%,-1.27613:18.19072%,-0.23351:17.59997%,-0.33484:17.23645%,6.0369:0.0008%,-64.19493:0.0004%,-71.14798:0.0004%,1.45709:0.0004%,-3.3787199999999995:0.0002%,-68.79874000000001:0.0002%,-1.27347:0.0002%,1.46509:0.0002%,1.47576:0.0002%,8.55414:0.0002%,6.06224:0.0002%,-4.3880099999999995:0.0002%,-0.24151:0.0002%,-71.14931:0.0002%,-1.02014:0.0002%,6.15557:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:26.11613%,1:20.85175%,5:18.19052%,4:17.59957%,2:17.23645%,0:0.00557%]
[INFO] ** service:[0.0048200000000000005:99.99781%,-211.09762999999998:0.0006%,-186.44547:0.0004%,-211.08346:0.0004%,-186.43601999999998:0.0002%,-211.35747999999998:0.0002%,-211.08818:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:38.08841%,9:26.11712%,7:18.19112%,1:17.60017%,11:0.00119%,10:0.00099%,3:0.0004%,21:0.0002%,15:0.0002%,2:0.0002%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** unixtime:1374 (0.27339%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.9672e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1048e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.8594e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6265e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.4938e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8940 - val_tp: 16409.0000 - val_fp: 3591.0000 - val_tn: 76409.0000 - val_fn: 3591.0000 - val_accuracy: 0.9282 - val_precision: 0.8205 - val_recall: 0.8205 - val_auc: 0.8878
[INFO] saving weights to checkpoints/lstm-epoch-9-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9248 - tp: 65483.0000 - fp: 14517.0000 - tn: 305483.0000 - fn: 14517.0000 - accuracy: 0.9274 - precision: 0.8185 - recall: 0.8185 - auc: 0.8866 - val_loss: 2.9045 - val_tp: 16396.0000 - val_fp: 3604.0000 - val_tn: 76396.0000 - val_fn: 3604.0000 - val_accuracy: 0.9279 - val_precision: 0.8198 - val_recall: 0.8198 - val_auc: 0.8874
[INFO] saving weights to checkpoints/lstm-epoch-9-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8411 - tp: 70862.0000 - fp: 9138.0000 - tn: 310862.0000 - fn: 9138.0000 - accuracy: 0.9543 - precision: 0.8858 - recall: 0.8858 - auc: 0.9286 - val_loss: 1.9253e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/502586
[33m[INFO] loading file 18-18/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (502586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (502586, 17)

[INFO] analyzing data
[INFO] 502586 rows
[INFO] ** appi_name:[21:99.99801%,30:0.0006%,7:0.0006%,31:0.0002%,27:0.0002%,22:0.0002%,8:0.0002%]
[INFO] ** classification:[normal:80.70022%,Multi Stage Multi Point:19.29978%]
[INFO] ** dst:[21:43.34243%,10:20.8235%,8:18.27488%,9:17.5562%,22:0.0006%,15:0.0006%,24:0.0004%,16:0.0004%,2:0.0004%,18:0.0002%,7:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.9994%,0:0.0006%]
[INFO] ** i/f_name:[2:99.9994%,3:0.0006%]
[INFO] ** modbus_function_code:[0.02961:99.99801%,-33.760870000000004:0.00199%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.99821%,0:0.00199%]
[INFO] ** modbus_transaction_id:65536 (13.03976%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99881%,2:0.0006%,1:0.0006%]
[INFO] ** proxy_src_ip:[18:38.06274%,20:26.10379%,13:18.27528%,6:17.5562%,17:0.0006%,11:0.0006%,1:0.0004%,14:0.0002%,7:0.0002%]
[INFO] ** s_port:[1.45442:26.103%,-0.32151:20.8235%,-1.27613:18.27468%,-0.23351:17.556%,-0.33484:17.23924%,-71.33197:0.0006%,1.45709:0.0004%,-1.27347:0.0004%,-1.2708:0.0002%,-71.14931:0.0002%,-0.24151:0.0002%,6.45955:0.0002%,-2.48275:0.0002%,1.47576:0.0002%,1.46509:0.0002%,-3.3787199999999995:0.0002%,3.6236699999999997:0.0002%,6.06224:0.0002%,8.10082:0.0002%]
[INFO] ** scada_tag:[3:26.1026%,1:20.8233%,5:18.27448%,4:17.5558%,2:17.23904%,0:0.00478%]
[INFO] ** service:[0.0048200000000000005:99.99801%,-211.09762999999998:0.0006%,-211.73542999999998:0.0006%,-186.43601999999998:0.0002%,-211.35747999999998:0.0002%,-211.08818:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:38.06274%,9:26.10379%,7:18.27528%,1:17.5562%,14:0.0006%,10:0.0006%,3:0.0004%,21:0.0002%,2:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1374 (0.27339%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.4289 - tp: 58018.0000 - fp: 21982.0000 - tn: 298018.0000 - fn: 21982.0000 - accuracy: 0.8901 - precision: 0.7252 - recall: 0.7252 - auc: 0.8283 - val_loss: 6.1039 - val_tp: 12426.0000 - val_fp: 7574.0000 - val_tn: 72426.0000 - val_fn: 7574.0000 - val_accuracy: 0.8485 - val_precision: 0.6213 - val_recall: 0.6213 - val_auc: 0.7633
[INFO] saving weights to checkpoints/lstm-epoch-9-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 6.1331 - tp: 49559.0000 - fp: 30441.0000 - tn: 289559.0000 - fn: 30441.0000 - accuracy: 0.8478 - precision: 0.6195 - recall: 0.6195 - auc: 0.7622 - val_loss: 6.1426 - val_tp: 12378.0000 - val_fp: 7622.0000 - val_tn: 72378.0000 - val_fn: 7622.0000 - val_accuracy: 0.8476 - val_precision: 0.6189 - val_recall: 0.6189 - val_auc: 0.7618
[INFO] saving weights to checkpoints/lstm-epoch-9-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.9192 - tp: 50621.0000 - fp: 29379.0000 - tn: 290621.0000 - fn: 29379.0000 - accuracy: 0.8531 - precision: 0.6328 - recall: 0.6328 - auc: 0.7705 - val_loss: 1.3388e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2544e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1928e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1131e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0627e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/502586
[33m[INFO] loading file 19-19/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (502586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (502586, 17)

[INFO] analyzing data
[INFO] 502586 rows
[INFO] ** appi_name:[21:99.99781%,26:0.0004%,0:0.0004%,31:0.0002%,27:0.0002%,24:0.0002%,22:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** classification:[normal:85.76164%,Single Stage Multi Point:14.23836%]
[INFO] ** dst:[21:43.38302%,10:20.82947%,8:18.21101%,9:17.57351%,22:0.00139%,6:0.0006%,25:0.0004%,24:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99781%,-33.760870000000004:0.00199%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.99801%,0:0.00199%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.03976%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99861%,2:0.00139%]
[INFO] ** proxy_src_ip:[18:38.11825%,20:26.09424%,13:18.21121%,6:17.57351%,10:0.00119%,11:0.00099%,16:0.0006%]
[INFO] ** s_port:[1.45442:26.09325%,-0.32151:20.82947%,-1.27613:18.21081%,-0.23351:17.57331%,-0.33484:17.28878%,-5.20264:0.0008%,1.45709:0.0006%,-1.02014:0.0006%,-64.19493:0.0004%,-71.14798:0.0004%,-1.27347:0.0002%,1.47576:0.0002%,-0.24151:0.0002%,-71.14931:0.0002%,1.46509:0.0002%,-68.79874000000001:0.0002%,-1.2708:0.0002%,0.75578:0.0002%]
[INFO] ** scada_tag:[3:26.09285%,1:20.82927%,5:18.21061%,4:17.57311%,2:17.28878%,0:0.00537%]
[INFO] ** service:[0.0048200000000000005:99.99861%,-186.44547:0.0004%,-211.08346:0.0004%,-186.43601999999998:0.0002%,-211.08818:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:38.11825%,9:26.09424%,7:18.21121%,1:17.57351%,11:0.00119%,10:0.00099%,15:0.0006%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** unixtime:1375 (0.27359%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7111e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.1001e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.6011e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.2495e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.6414e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.1193e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.6993 - tp: 46749.0000 - fp: 33251.0000 - tn: 286749.0000 - fn: 33251.0000 - accuracy: 0.8337 - precision: 0.5844 - recall: 0.5844 - auc: 0.7402 - val_loss: 9.8425 - val_tp: 7787.0000 - val_fp: 12213.0000 - val_tn: 67787.0000 - val_fn: 12213.0000 - val_accuracy: 0.7557 - val_precision: 0.3893 - val_recall: 0.3893 - val_auc: 0.6183
[INFO] saving weights to checkpoints/lstm-epoch-9-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.2577 - tp: 53904.0000 - fp: 26096.0000 - tn: 293904.0000 - fn: 26096.0000 - accuracy: 0.8695 - precision: 0.6738 - recall: 0.6738 - auc: 0.7961 - val_loss: 6.1750e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/502586
[33m[INFO] loading file 20-20/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (502586, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (502586, 17)

[INFO] analyzing data
[INFO] 502586 rows
[INFO] ** appi_name:[21:99.99622%,30:0.00318%,31:0.0002%,27:0.0002%,26:0.0002%]
[INFO] ** classification:[normal:91.84637%,Single Stage Multi Point:8.15363%]
[INFO] ** dst:[21:43.42401%,10:20.83663%,8:18.16684%,9:17.56714%,15:0.00318%,22:0.00119%,24:0.0004%,18:0.0002%,7:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99721%,0:0.00279%]
[INFO] ** i/f_name:[2:99.99682%,3:0.00318%]
[INFO] ** modbus_function_code:[0.02961:99.99622%,-33.760870000000004:0.00378%]
[INFO] ** modbus_function_description:[7:49.9996%,11:49.99662%,0:0.00378%]
[INFO] ** modbus_transaction_id:65536 (13.03976%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99622%,1:0.00318%,2:0.0006%]
[INFO] ** proxy_src_ip:[18:38.11746%,20:26.14378%,13:18.16704%,6:17.56774%,17:0.00318%,14:0.0006%,16:0.0002%]
[INFO] ** s_port:[1.45442:26.14299%,-0.32151:20.83663%,-1.27613:18.16644%,-0.23351:17.56694%,-0.33484:17.28082%,-71.33197:0.00318%,-0.24151:0.0006%,1.45709:0.0004%,-1.27347:0.0004%,-1.2708:0.0002%,-1.02014:0.0002%,13.431270000000001:0.0002%,-71.14798:0.0002%,1.47576:0.0002%,-0.24950999999999998:0.0002%,11.862:0.0002%,1.46509:0.0002%]
[INFO] ** scada_tag:[3:26.14259%,1:20.83643%,5:18.16644%,4:17.56655%,2:17.28062%,0:0.00736%]
[INFO] ** service:[0.0048200000000000005:99.99622%,-211.73542999999998:0.00318%,-211.08346:0.0002%,-186.43601999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:38.11746%,9:26.14378%,7:18.16704%,1:17.56774%,14:0.00318%,2:0.0006%,15:0.0002%]
[INFO] ** type:[0:99.9996%,1:0.0004%]
[INFO] ** unixtime:1374 (0.27339%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.7209 - tp: 76422.0000 - fp: 3578.0000 - tn: 316422.0000 - fn: 3578.0000 - accuracy: 0.9821 - precision: 0.9553 - recall: 0.9553 - auc: 0.9720 - val_loss: 2.9665 - val_tp: 16319.0000 - val_fp: 3681.0000 - val_tn: 76319.0000 - val_fn: 3681.0000 - val_accuracy: 0.9264 - val_precision: 0.8159 - val_recall: 0.8159 - val_auc: 0.8850
[INFO] saving weights to checkpoints/lstm-epoch-9-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9407 - tp: 65404.0000 - fp: 14596.0000 - tn: 305404.0000 - fn: 14596.0000 - accuracy: 0.9270 - precision: 0.8176 - recall: 0.8176 - auc: 0.8860 - val_loss: 2.9754 - val_tp: 16308.0000 - val_fp: 3692.0000 - val_tn: 76308.0000 - val_fn: 3692.0000 - val_accuracy: 0.9262 - val_precision: 0.8154 - val_recall: 0.8154 - val_auc: 0.8846
[INFO] saving weights to checkpoints/lstm-epoch-9-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9351 - tp: 65432.0000 - fp: 14568.0000 - tn: 305432.0000 - fn: 14568.0000 - accuracy: 0.9272 - precision: 0.8179 - recall: 0.8179 - auc: 0.8862 - val_loss: 0.6963 - val_tp: 19136.0000 - val_fp: 864.0000 - val_tn: 79136.0000 - val_fn: 864.0000 - val_accuracy: 0.9827 - val_precision: 0.9568 - val_recall: 0.9568 - val_auc: 0.9730
[INFO] saving weights to checkpoints/lstm-epoch-9-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.2032e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/502586
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.8402e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6506e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/502586
[33m[INFO] loading file 21-21/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (502584, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (502584, 17)

[INFO] analyzing data
[INFO] 502584 rows
[INFO] ** appi_name:[21:99.99602%,30:0.0008%,7:0.0006%,26:0.0004%,22:0.0004%,0:0.0004%,31:0.0002%,27:0.0002%,24:0.0002%,16:0.0002%,15:0.0002%,8:0.0002%,5:0.0002%]
[INFO] ** classification:[normal:98.78568%,Multi Stage Single Point:1.21432%]
[INFO] ** dst:[21:43.30281%,10:21.00544%,8:18.16234%,9:17.52483%,22:0.00099%,15:0.0008%,6:0.0008%,25:0.0004%,24:0.0004%,16:0.0004%,2:0.0004%,18:0.0002%,7:0.0002%]
[INFO] ** i/f_dir:[1:99.9992%,0:0.0008%]
[INFO] ** i/f_name:[2:99.9992%,3:0.0008%]
[INFO] ** modbus_function_code:[0.02961:99.99602%,-33.760870000000004:0.00378%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.99861%,11:49.99741%,0:0.00378%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.03981%)
[INFO] ** orig:[0:99.9992%,2:0.0008%]
[INFO] ** proto:[0:99.99761%,2:0.00159%,1:0.0008%]
[INFO] ** proxy_src_ip:[18:38.33906%,20:25.96899%,13:18.16254%,6:17.52483%,10:0.00119%,11:0.00099%,17:0.0008%,16:0.0006%,1:0.0004%,21:0.0002%,14:0.0002%,7:0.0002%]
[INFO] ** s_port:[1.45442:25.9684%,-0.32151:21.00465%,-1.27613:18.16214%,-0.23351:17.52463%,-0.33484:17.33442%,-6.64392:0.0008%,-71.33197:0.0008%,-1.02014:0.0006%,-1.27347:0.0004%,-71.14931:0.0004%,-71.14798:0.0004%,-64.19493:0.0004%,1.45709:0.0002%,-2.2440900000000004:0.0002%,-3.3787199999999995:0.0002%,-68.79874000000001:0.0002%,10.15141:0.0002%,1.46509:0.0002%,1.47576:0.0002%,7.060860000000001:0.0002%,-0.24151:0.0002%,6.62488:0.0002%]
[INFO] ** scada_tag:[3:25.968%,1:21.00445%,5:18.16194%,4:17.52443%,2:17.33442%,0:0.00677%]
[INFO] ** service:[0.0048200000000000005:99.99682%,-211.73542999999998:0.0008%,-211.09762999999998:0.0006%,-186.44547:0.0004%,-211.08346:0.0004%,-211.08818:0.0004%,-186.43601999999998:0.0002%,-211.35747999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:38.33906%,9:25.96899%,7:18.16254%,1:17.52483%,11:0.00119%,21:0.00099%,10:0.00099%,15:0.0006%,3:0.0004%,4:0.0002%,2:0.0002%]
[INFO] ** type:[0:99.9998%,2:0.0002%]
[INFO] ** unixtime:1368 (0.27219%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/502584
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.9744e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3894e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/502584
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.2174e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0665e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/502584
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9776e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8890e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/502584
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.7725e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7078e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/502584
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 6.2342e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9449 - val_tp: 15105.0000 - val_fp: 4895.0000 - val_tn: 75105.0000 - val_fn: 4895.0000 - val_accuracy: 0.9021 - val_precision: 0.7552 - val_recall: 0.7552 - val_auc: 0.8470
[INFO] saving weights to checkpoints/lstm-epoch-9-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/502584
[33m[INFO] loading file 22-22/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (271625, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (271625, 17)

[INFO] analyzing data
[INFO] 271625 rows
[INFO] ** appi_name:[21:99.9919%,30:0.00699%,23:0.00037%,22:0.00037%,18:0.00037%]
[INFO] ** classification:[normal:53.00249%,Multi Stage Single Point:46.99751%]
[INFO] ** dst:[21:43.30897%,10:21.00948%,8:18.10179%,9:17.57018%,15:0.00699%,22:0.00147%,19:0.00074%,26:0.00037%]
[INFO] ** i/f_dir:[1:99.99337%,0:0.00663%]
[INFO] ** i/f_name:[2:99.99301%,3:0.00663%,0:0.00037%]
[INFO] ** modbus_function_code:[0.02961:99.9919%,-33.760870000000004:0.0081%]
[INFO] ** modbus_function_description:[7:49.99724%,11:49.99466%,0:0.0081%]
[INFO] ** modbus_transaction_id:64487 (23.74119%)
[INFO] ** orig:[0:99.99485%,2:0.00442%,1:0.00074%]
[INFO] ** proto:[0:99.99264%,1:0.00699%,2:0.00037%]
[INFO] ** proxy_src_ip:[18:38.33152%,20:25.98803%,13:18.10106%,6:17.57128%,17:0.00699%,14:0.00074%,10:0.00037%]
[INFO] ** s_port:[1.45442:25.98693%,-0.32151:21.00948%,-1.27613:18.10106%,-0.23351:17.57018%,-0.33484:17.32204%,-71.33197:0.00699%,1.45709:0.00074%,-0.24151:0.00074%,7.228860000000001:0.00074%,-0.24950999999999998:0.00037%,1.46509:0.00037%,-71.14931:0.00037%]
[INFO] ** scada_tag:[3:25.98656%,1:21.00948%,5:18.10106%,4:17.56981%,2:17.32204%,0:0.01104%]
[INFO] ** service:[0.0048200000000000005:99.9919%,-211.73542999999998:0.00699%,-211.07873999999998:0.00074%,-211.08818:0.00037%]
[INFO] ** src:[22:38.33152%,9:25.98803%,7:18.10106%,1:17.57128%,21:0.00442%,14:0.00258%,2:0.00074%,11:0.00037%]
[INFO] ** type:[0:99.99779%,1:0.00221%]
[INFO] ** unixtime:750 (0.27612%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/271625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5614 - tp: 42470.0000 - fp: 37530.0000 - tn: 282470.0000 - fn: 37530.0000 - accuracy: 0.8123 - precision: 0.5309 - recall: 0.5309 - auc: 0.7068 - val_loss: 7.5771 - val_tp: 10598.0000 - val_fp: 9402.0000 - val_tn: 70598.0000 - val_fn: 9402.0000 - val_accuracy: 0.8120 - val_precision: 0.5299 - val_recall: 0.5299 - val_auc: 0.7062
[INFO] saving weights to checkpoints/lstm-epoch-9-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/271625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5940 - tp: 42308.0000 - fp: 37692.0000 - tn: 282308.0000 - fn: 37692.0000 - accuracy: 0.8115 - precision: 0.5289 - recall: 0.5289 - auc: 0.7055 - val_loss: 7.5828 - val_tp: 10591.0000 - val_fp: 9409.0000 - val_tn: 70591.0000 - val_fn: 9409.0000 - val_accuracy: 0.8118 - val_precision: 0.5296 - val_recall: 0.5296 - val_auc: 0.7060
[INFO] saving weights to checkpoints/lstm-epoch-9-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/271625
[33m[INFO] loading file 23-23/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571625, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571625, 17)

[INFO] analyzing data
[INFO] 571625 rows
[INFO] ** appi_name:[21:99.9986%,30:0.0007%,31:0.00035%,33:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:92.53724%,Multi Stage Single Point:7.46276%]
[INFO] ** dst:[21:43.32368%,10:20.99856%,8:18.14091%,9:17.53422%,22:0.00105%,15:0.0007%,24:0.00035%,18:0.00035%,25:0.00017%]
[INFO] ** i/f_dir:[1:99.9993%,0:0.0007%]
[INFO] ** i/f_name:[2:99.9993%,3:0.0007%]
[INFO] ** modbus_function_code:[0.02961:99.9986%,-33.760870000000004:0.0014%]
[INFO] ** modbus_function_description:[7:50.00044%,11:49.99816%,0:0.0014%]
[INFO] ** modbus_transaction_id:65536 (11.46486%)
[INFO] ** orig:[0:99.99948%,2:0.00052%]
[INFO] ** proto:[0:99.99878%,1:0.0007%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.33562%,20:25.98714%,13:18.14091%,6:17.5344%,17:0.0007%,16:0.00052%,21:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.98627%,-0.32151:20.99838%,-1.27613:18.14039%,-0.23351:17.53405%,-0.33484:17.33724%,-71.33197:0.0007%,-1.02014:0.00052%,-0.08551:0.00035%,-1.27347:0.00035%,1.45709:0.00035%,1.46509:0.00035%,-0.24151:0.00017%,1.47576:0.00017%,-1.2708:0.00017%,-64.19493:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:25.98592%,1:20.99838%,5:18.14021%,4:17.53387%,2:17.33707%,0:0.00455%]
[INFO] ** service:[0.0048200000000000005:99.99878%,-211.73542999999998:0.0007%,-186.43601999999998:0.00035%,-186.44547:0.00017%]
[INFO] ** src:[22:38.33562%,9:25.98714%,7:18.14091%,1:17.5344%,21:0.00052%,15:0.00052%,17:0.00017%,14:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1557 (0.27238%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5630 - tp: 42462.0000 - fp: 37538.0000 - tn: 282462.0000 - fn: 37538.0000 - accuracy: 0.8123 - precision: 0.5308 - recall: 0.5308 - auc: 0.7067 - val_loss: 4.1270 - val_tp: 14879.0000 - val_fp: 5121.0000 - val_tn: 74879.0000 - val_fn: 5121.0000 - val_accuracy: 0.8976 - val_precision: 0.7440 - val_recall: 0.7440 - val_auc: 0.8400
[INFO] saving weights to checkpoints/lstm-epoch-9-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0480e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9977e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9225e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8982e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8444e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8075e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7468e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6958e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/571625
[33m[INFO] loading file 24-24/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571625, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571625, 17)

[INFO] analyzing data
[INFO] 571625 rows
[INFO] ** appi_name:[21:99.99353%,30:0.00315%,26:0.00052%,31:0.00035%,27:0.00035%,22:0.00035%,0:0.00035%,24:0.00017%,23:0.00017%,19:0.00017%,18:0.00017%,16:0.00017%,15:0.00017%,11:0.00017%,5:0.00017%]
[INFO] ** classification:[normal:95.54253%,Multi Stage Single Point:4.45747%]
[INFO] ** dst:[21:43.37022%,10:21.01465%,8:18.0977%,9:17.51061%,15:0.00315%,22:0.00105%,6:0.0007%,25:0.00035%,24:0.00035%,19:0.00035%,18:0.00035%,7:0.00035%,26:0.00017%]
[INFO] ** i/f_dir:[1:99.99703%,0:0.00297%]
[INFO] ** i/f_name:[2:99.99685%,3:0.00315%]
[INFO] ** modbus_function_code:[0.02961:99.99353%,-33.760870000000004:0.00595%,-0.415:0.00017%,0.9188299999999999:0.00017%,0.47422:0.00017%]
[INFO] ** modbus_function_description:[7:49.99781%,11:49.99571%,0:0.00595%,15:0.00017%,10:0.00017%,2:0.00017%]
[INFO] ** modbus_transaction_id:65536 (11.46486%)
[INFO] ** orig:[0:99.99965%,1:0.00035%]
[INFO] ** proto:[0:99.99493%,1:0.00315%,2:0.00192%]
[INFO] ** proxy_src_ip:[18:38.39545%,20:25.99029%,13:18.09753%,6:17.50991%,17:0.00315%,10:0.00122%,14:0.00087%,11:0.00087%,21:0.00035%,16:0.00035%]
[INFO] ** s_port:[1.45442:25.98942%,-0.32151:21.01465%,-1.27613:18.09718%,-0.23351:17.50921%,-0.33484:17.3808%,-71.33197:0.00315%,-9.58113:0.0007%,-71.14798:0.00052%,-0.24950999999999998:0.00035%,-1.27347:0.00035%,1.45709:0.00035%,-0.24151:0.00035%,-1.02014:0.00035%,-31.55091:0.00035%,7.6315100000000005:0.00035%,-71.14931:0.00035%,-64.19493:0.00035%,1.47576:0.00035%,-68.79874000000001:0.00017%,1.46509:0.00017%,7.4901800000000005:0.00017%,13.431270000000001:0.00017%,11.862:0.00017%]
[INFO] ** scada_tag:[3:25.98924%,1:21.01465%,5:18.097%,4:17.50886%,2:17.38063%,0:0.00962%]
[INFO] ** service:[0.0048200000000000005:99.99458%,-211.73542999999998:0.00315%,-211.08346:0.00052%,-211.07873999999998:0.00035%,-202.75898:0.00035%,-186.44547:0.00035%,-186.43601999999998:0.00035%,-211.08818:0.00035%]
[INFO] ** src:[22:38.39545%,9:25.99029%,7:18.09753%,1:17.50991%,14:0.00315%,11:0.00122%,10:0.00087%,2:0.00087%,15:0.00035%,4:0.00035%]
[INFO] ** type:[0:99.99878%,1:0.00087%,2:0.00035%]
[INFO] ** unixtime:1553 (0.27168%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5881e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6743e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6756e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6018e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5673e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5323e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.4621e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3620e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3612e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0314 - val_tp: 19961.0000 - val_fp: 39.0000 - val_tn: 79961.0000 - val_fn: 39.0000 - val_accuracy: 0.9992 - val_precision: 0.9980 - val_recall: 0.9980 - val_auc: 0.9988
[INFO] saving weights to checkpoints/lstm-epoch-9-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/571625
[33m[INFO] loading file 25-25/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571625, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571625, 17)

[INFO] analyzing data
[INFO] 571625 rows
[INFO] ** appi_name:[21:99.9965%,30:0.00105%,17:0.0007%,22:0.00052%,31:0.00035%,28:0.00017%,26:0.00017%,12:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** classification:[normal:64.3525%,Multi Stage Single Point:35.6475%]
[INFO] ** dst:[21:43.32141%,10:21.0269%,8:18.13147%,9:17.51603%,15:0.00105%,22:0.00087%,16:0.0007%,6:0.0007%,18:0.00035%,17:0.00035%,24:0.00017%]
[INFO] ** i/f_dir:[1:99.99895%,0:0.00105%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.9965%,-33.760870000000004:0.0035%]
[INFO] ** modbus_function_description:[7:49.99904%,11:49.99746%,0:0.0035%]
[INFO] ** modbus_transaction_id:65536 (11.46486%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9979%,2:0.00105%,1:0.00105%]
[INFO] ** proxy_src_ip:[18:38.39178%,20:25.95635%,13:18.13147%,6:17.51655%,17:0.00105%,1:0.00087%,21:0.0007%,16:0.00035%,14:0.00035%,7:0.00035%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.956%,-0.32151:21.02655%,-1.27613:18.13112%,-0.23351:17.51603%,-0.33484:17.36523%,-71.33197:0.00105%,-71.14931:0.00052%,-0.24151:0.00035%,-1.02014:0.00035%,-49.275529999999996:0.00035%,1.46509:0.00017%,-5.1466400000000005:0.00017%,-1.27347:0.00017%,-1.2708:0.00017%,-58.035180000000004:0.00017%,-58.032509999999995:0.00017%,-0.24950999999999998:0.00017%,2.52505:0.00017%,-43.76509:0.00017%,2.05573:0.00017%,6.1115699999999995:0.00017%,-5.08665:0.00017%,1.45709:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:25.95565%,1:21.02637%,5:18.13094%,4:17.51585%,2:17.36506%,0:0.00612%]
[INFO] ** service:[0.0048200000000000005:99.99685%,-211.73542999999998:0.00105%,-205.44247:0.0007%,-211.08818:0.00052%,-186.43601999999998:0.00035%,-211.09762999999998:0.00017%,-211.08346:0.00017%,-185.9872:0.00017%]
[INFO] ** src:[22:38.39178%,9:25.95635%,7:18.13147%,1:17.51655%,14:0.00105%,3:0.00087%,4:0.0007%,21:0.00035%,15:0.00035%,2:0.00035%,8:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1553 (0.27168%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.7284 - tp: 51568.0000 - fp: 28432.0000 - tn: 291568.0000 - fn: 28432.0000 - accuracy: 0.8578 - precision: 0.6446 - recall: 0.6446 - auc: 0.7779 - val_loss: 5.7550 - val_tp: 12859.0000 - val_fp: 7141.0000 - val_tn: 72859.0000 - val_fn: 7141.0000 - val_accuracy: 0.8572 - val_precision: 0.6429 - val_recall: 0.6429 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-9-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7548 - tp: 51437.0000 - fp: 28563.0000 - tn: 291437.0000 - fn: 28563.0000 - accuracy: 0.8572 - precision: 0.6430 - recall: 0.6430 - auc: 0.7769 - val_loss: 5.7566 - val_tp: 12857.0000 - val_fp: 7143.0000 - val_tn: 72857.0000 - val_fn: 7143.0000 - val_accuracy: 0.8571 - val_precision: 0.6428 - val_recall: 0.6428 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-9-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.7503 - tp: 51459.0000 - fp: 28541.0000 - tn: 291459.0000 - fn: 28541.0000 - accuracy: 0.8573 - precision: 0.6432 - recall: 0.6432 - auc: 0.7770 - val_loss: 5.7163 - val_tp: 12907.0000 - val_fp: 7093.0000 - val_tn: 72907.0000 - val_fn: 7093.0000 - val_accuracy: 0.8581 - val_precision: 0.6453 - val_recall: 0.6453 - val_auc: 0.7783
[INFO] saving weights to checkpoints/lstm-epoch-9-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.7519 - tp: 51451.0000 - fp: 28549.0000 - tn: 291451.0000 - fn: 28549.0000 - accuracy: 0.8573 - precision: 0.6431 - recall: 0.6431 - auc: 0.7770 - val_loss: 5.7066 - val_tp: 12919.0000 - val_fp: 7081.0000 - val_tn: 72919.0000 - val_fn: 7081.0000 - val_accuracy: 0.8584 - val_precision: 0.6460 - val_recall: 0.6460 - val_auc: 0.7787
[INFO] saving weights to checkpoints/lstm-epoch-9-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.7552 - tp: 51435.0000 - fp: 28565.0000 - tn: 291435.0000 - fn: 28565.0000 - accuracy: 0.8572 - precision: 0.6429 - recall: 0.6429 - auc: 0.7768 - val_loss: 5.7566 - val_tp: 12857.0000 - val_fp: 7143.0000 - val_tn: 72857.0000 - val_fn: 7143.0000 - val_accuracy: 0.8571 - val_precision: 0.6428 - val_recall: 0.6428 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-9-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/571625
[33m[INFO] loading file 26-26/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (571625, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (571625, 17)

[INFO] analyzing data
[INFO] 571625 rows
[INFO] ** appi_name:[21:99.99825%,30:0.00052%,7:0.00052%,31:0.00017%,22:0.00017%,12:0.00017%,8:0.00017%]
[INFO] ** classification:[normal:64.39799%,Single Stage Single Point:27.94%,Multi Stage Single Point:7.66202%]
[INFO] ** dst:[21:43.30654%,10:21.08918%,8:18.12167%,9:17.47999%,22:0.0007%,15:0.00052%,24:0.00035%,16:0.00035%,2:0.00035%,18:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99948%,0:0.00052%]
[INFO] ** i/f_name:[2:99.99948%,3:0.00052%]
[INFO] ** modbus_function_code:[0.02961:99.99825%,-33.760870000000004:0.00175%]
[INFO] ** modbus_function_description:[7:49.99956%,11:49.99869%,0:0.00175%]
[INFO] ** modbus_transaction_id:65536 (11.46486%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99913%,1:0.00052%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.46753%,20:25.92836%,13:18.12202%,6:17.47999%,17:0.00052%,1:0.00052%,21:0.00035%,16:0.00035%,14:0.00017%,7:0.00017%]
[INFO] ** s_port:[1.45442:25.92784%,-0.32151:21.089%,-1.27613:18.1215%,-0.23351:17.47982%,-0.33484:17.37853%,-71.33197:0.00052%,-1.02014:0.00035%,-1.27347:0.00035%,-49.275529999999996:0.00017%,1.47576:0.00017%,1.45709:0.00017%,1.46509:0.00017%,-1.2708:0.00017%,14.191239999999999:0.00017%,2.52505:0.00017%,-3.3787199999999995:0.00017%,11.57001:0.00017%,-71.14931:0.00017%,7.66617:0.00017%,-0.24151:0.00017%]
[INFO] ** scada_tag:[3:25.92749%,1:21.089%,5:18.12132%,4:17.47964%,2:17.37853%,0:0.00402%]
[INFO] ** service:[0.0048200000000000005:99.99843%,-211.09762999999998:0.00052%,-211.73542999999998:0.00052%,-211.35747999999998:0.00017%,-186.43601999999998:0.00017%,-211.08818:0.00017%]
[INFO] ** src:[22:38.46753%,9:25.92836%,7:18.12202%,1:17.47999%,14:0.00052%,3:0.00052%,15:0.00035%,4:0.00035%,21:0.00017%,2:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1551 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7433 - tp: 51494.0000 - fp: 28506.0000 - tn: 291494.0000 - fn: 28506.0000 - accuracy: 0.8575 - precision: 0.6437 - recall: 0.6437 - auc: 0.7773 - val_loss: 5.7445 - val_tp: 12872.0000 - val_fp: 7128.0000 - val_tn: 72872.0000 - val_fn: 7128.0000 - val_accuracy: 0.8574 - val_precision: 0.6436 - val_recall: 0.6436 - val_auc: 0.7772
[INFO] saving weights to checkpoints/lstm-epoch-9-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6340 - tp: 69830.0000 - fp: 10078.0000 - tn: 309922.0000 - fn: 10170.0000 - accuracy: 0.9494 - precision: 0.8739 - recall: 0.8729 - auc: 0.9320 - val_loss: 0.1122 - val_tp: 19709.0000 - val_fp: 267.0000 - val_tn: 79733.0000 - val_fn: 291.0000 - val_accuracy: 0.9944 - val_precision: 0.9866 - val_recall: 0.9855 - val_auc: 0.9992
[INFO] saving weights to checkpoints/lstm-epoch-9-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0050 - tp: 79982.0000 - fp: 16.0000 - tn: 319984.0000 - fn: 18.0000 - accuracy: 0.9999 - precision: 0.9998 - recall: 0.9998 - auc: 1.0000 - val_loss: 9.6304e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.1133e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.3413e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/571625
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.4047e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7844e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/571625
[33m[INFO] loading file 27-27/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (511755, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (511755, 17)

[INFO] analyzing data
[INFO] 511755 rows
[INFO] ** appi_name:[21:99.99941%,30:0.00059%]
[INFO] ** classification:[normal:64.35814%,Single Stage Single Point:35.64186%]
[INFO] ** dst:[21:43.2879%,10:21.06848%,8:18.17413%,9:17.46793%,22:0.00078%,15:0.00059%,24:0.0002%]
[INFO] ** i/f_dir:[1:99.9998%,0:0.0002%]
[INFO] ** i/f_name:[2:99.99941%,3:0.00059%]
[INFO] ** modbus_function_code:[0.02961:99.99941%,-33.760870000000004:0.00059%]
[INFO] ** modbus_function_description:[7:50.00029%,11:49.99912%,0:0.00059%]
[INFO] ** modbus_transaction_id:65536 (12.80613%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99941%,1:0.00059%]
[INFO] ** proxy_src_ip:[18:38.42346%,20:25.9335%,13:18.17393%,6:17.46812%,17:0.00059%,16:0.00039%]
[INFO] ** s_port:[1.45442:25.93292%,-0.32151:21.06848%,-1.27613:18.17374%,-0.23351:17.46773%,-0.33484:17.35498%,-71.33197:0.00059%,-1.02014:0.00039%,-1.27347:0.0002%,1.45709:0.0002%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-0.24151:0.0002%]
[INFO] ** scada_tag:[3:25.93253%,1:21.06828%,5:18.17354%,4:17.46754%,2:17.35479%,0:0.00332%]
[INFO] ** service:[0.0048200000000000005:99.99941%,-211.73542999999998:0.00059%]
[INFO] ** src:[22:38.42346%,9:25.9335%,7:18.17393%,1:17.46812%,14:0.00059%,15:0.00039%]
[INFO] ** type:[0:99.99961%,1:0.00039%]
[INFO] ** unixtime:1390 (0.27161%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/511755
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.7157e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6375e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/511755
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3255e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.4615e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/511755
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8498e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6122e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/511755
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9437e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.8591e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/511755
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.7182e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.5455e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-26-27-batch-400000-500000
[INFO] processing batch 500000-600000/511755
[33m[INFO] loading file 28-28/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (345671, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (345671, 17)

[INFO] analyzing data
[INFO] 345671 rows
[INFO] ** appi_name:[21:99.99161%,30:0.00174%,17:0.00145%,22:0.00116%,7:0.00116%,31:0.00087%,26:0.00087%,28:0.00029%,27:0.00029%,8:0.00029%,0:0.00029%]
[INFO] ** classification:[normal:64.3071%,Single Stage Single Point:35.6929%]
[INFO] ** dst:[21:43.2822%,10:21.01652%,8:18.20401%,9:17.48859%,6:0.00231%,16:0.00203%,18:0.00145%,17:0.00058%,15:0.00058%,2:0.00058%,25:0.00029%,22:0.00029%,7:0.00029%,0:0.00029%]
[INFO] ** i/f_dir:[1:99.99942%,0:0.00058%]
[INFO] ** i/f_name:[2:99.99942%,3:0.00058%]
[INFO] ** modbus_function_code:[0.02961:99.99161%,-33.760870000000004:0.00839%]
[INFO] ** modbus_function_description:[11:49.99581%,7:49.99581%,0:0.00839%]
[INFO] ** modbus_transaction_id:65535 (18.95878%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99508%,2:0.00434%,1:0.00058%]
[INFO] ** proxy_src_ip:[18:38.33501%,20:25.96371%,13:18.2043%,6:17.48859%,1:0.00231%,17:0.00174%,14:0.00174%,7:0.00145%,21:0.00087%,0:0.00029%]
[INFO] ** s_port:[1.45442:25.96342%,-0.32151:21.01652%,-1.27613:18.20401%,-0.23351:17.48831%,-0.33484:17.31849%,-71.14798:0.00116%,-71.14931:0.00116%,-71.33197:0.00058%,-0.08551:0.00058%,7.66617:0.00029%,-58.035180000000004:0.00029%,-1.2708:0.00029%,-64.19493:0.00029%,-5.1466400000000005:0.00029%,13.431270000000001:0.00029%,-0.24151:0.00029%,11.57001:0.00029%,14.4699:0.00029%,1.47576:0.00029%,14.191239999999999:0.00029%,-5.08665:0.00029%,10.192739999999999:0.00029%,-3.3787199999999995:0.00029%,6.1115699999999995:0.00029%,2.05573:0.00029%,-43.76509:0.00029%,2.52505:0.00029%,11.862:0.00029%,-58.032509999999995:0.00029%]
[INFO] ** scada_tag:[3:25.96342%,1:21.01652%,5:18.20401%,4:17.48802%,2:17.31849%,0:0.00955%]
[INFO] ** service:[0.0048200000000000005:99.99161%,-205.44247:0.00145%,-186.43601999999998:0.00145%,-211.09762999999998:0.00116%,-211.08346:0.00116%,-211.08818:0.00116%,-211.73542999999998:0.00058%,-186.44547:0.00029%,-183.8612:0.00029%,-185.9872:0.00029%,-211.35747999999998:0.00029%,-202.75898:0.00029%]
[INFO] ** src:[22:38.33501%,9:25.96371%,7:18.2043%,1:17.48859%,3:0.0026%,2:0.00174%,21:0.00145%,4:0.00116%,14:0.00058%,8:0.00058%,17:0.00029%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:940 (0.27193%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/345671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.3378e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6544e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/345671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7884e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.3769e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/345671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.6575e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.8450e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/345671
[33m[INFO] loading file 29-29/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (545671, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (545671, 17)

[INFO] analyzing data
[INFO] 545671 rows
[INFO] ** appi_name:[21:99.99872%,30:0.00055%,31:0.00018%,26:0.00018%,9:0.00018%,3:0.00018%]
[INFO] ** classification:[normal:64.39228%,Single Stage Single Point:35.60772%]
[INFO] ** dst:[21:43.32922%,10:21.06159%,8:18.14427%,9:17.46309%,22:0.00055%,15:0.00055%,24:0.00018%,18:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99945%,3:0.00055%]
[INFO] ** modbus_function_code:[0.02961:99.99872%,-33.760870000000004:0.00128%]
[INFO] ** modbus_function_description:[7:49.99973%,11:49.99899%,0:0.00128%]
[INFO] ** modbus_transaction_id:65536 (12.01017%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99908%,1:0.00055%,2:0.00037%]
[INFO] ** proxy_src_ip:[18:38.438%,20:25.953%,13:18.14463%,6:17.4629%,17:0.00055%,21:0.00018%,16:0.00018%,7:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95245%,-0.32151:21.06141%,-1.27613:18.14427%,-0.23351:17.4629%,-0.33484:17.37659%,-71.33197:0.00055%,1.45709:0.00037%,-71.14798:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,6.1115699999999995:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.95208%,1:21.06123%,5:18.14427%,4:17.46254%,2:17.37659%,0:0.0033%]
[INFO] ** service:[0.0048200000000000005:99.9989%,-211.73542999999998:0.00055%,-183.8612:0.00018%,-211.08346:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.438%,9:25.953%,7:18.14463%,1:17.4629%,14:0.00055%,21:0.00018%,15:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1482 (0.27159%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 9.9972e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.1184e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.8463e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.2151e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.8505e-05 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.1805e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 9.1921e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7943e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.8467e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.8995e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/545671
[33m[INFO] loading file 30-30/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (545671, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (545671, 17)

[INFO] analyzing data
[INFO] 545671 rows
[INFO] ** appi_name:[21:99.99743%,30:0.00183%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.36809%,Single Stage Single Point:35.63191%]
[INFO] ** dst:[21:43.33564%,10:21.02934%,8:18.14738%,9:17.48416%,15:0.00183%,22:0.00073%,24:0.00037%,25:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99835%,0:0.00165%]
[INFO] ** i/f_name:[2:99.99817%,3:0.00183%]
[INFO] ** modbus_function_code:[0.02961:99.99743%,-33.760870000000004:0.00257%]
[INFO] ** modbus_function_description:[7:49.99973%,11:49.99771%,0:0.00257%]
[INFO] ** modbus_transaction_id:65536 (12.01017%)
[INFO] ** orig:[0:99.99908%,2:0.00055%,1:0.00037%]
[INFO] ** proto:[0:99.9978%,1:0.00183%,2:0.00037%]
[INFO] ** proxy_src_ip:[18:38.36799%,20:25.9968%,13:18.14775%,6:17.48471%,17:0.00183%,7:0.00037%,16:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.99662%,-0.32151:21.02915%,-1.27613:18.1472%,-0.23351:17.48398%,-0.33484:17.33884%,-71.33197:0.00183%,-0.24151:0.00055%,-1.27347:0.00037%,-71.14798:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:25.99625%,1:21.02915%,5:18.14702%,4:17.4838%,2:17.33865%,0:0.00513%]
[INFO] ** service:[0.0048200000000000005:99.99762%,-211.73542999999998:0.00183%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.36799%,9:25.9968%,7:18.14775%,1:17.48471%,14:0.00128%,21:0.00092%,16:0.00018%,15:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99908%,1:0.00092%]
[INFO] ** unixtime:1483 (0.27178%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.9442e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.1418e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8723e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.4305e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0948e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.7248e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.1749e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.2292e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.2040e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.3159e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/545671
[33m[INFO] loading file 31-31/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (545671, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (545671, 17)

[INFO] analyzing data
[INFO] 545671 rows
[INFO] ** appi_name:[21:99.99963%,26:0.00018%,17:0.00018%]
[INFO] ** classification:[normal:64.37304%,Single Stage Single Point:35.62696%]
[INFO] ** dst:[21:43.31749%,10:21.05408%,8:18.12631%,9:17.50047%,22:0.00092%,24:0.00037%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99963%,-33.760870000000004:0.00037%]
[INFO] ** modbus_function_description:[7:49.99991%,11:49.99973%,0:0.00037%]
[INFO] ** modbus_transaction_id:65536 (12.01017%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.39511%,20:25.97719%,13:18.12649%,6:17.50047%,16:0.00037%,7:0.00037%]
[INFO] ** s_port:[1.45442:25.97646%,-0.32151:21.05408%,-1.27613:18.12612%,-0.23351:17.50029%,-0.33484:17.34104%,-1.27347:0.00037%,1.45709:0.00037%,-1.02014:0.00037%,-71.14798:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,10.192739999999999:0.00018%]
[INFO] ** scada_tag:[3:25.97609%,1:21.0539%,5:18.12594%,4:17.50011%,2:17.34085%,0:0.00312%]
[INFO] ** service:[0.0048200000000000005:99.99963%,-211.08346:0.00018%,-205.44247:0.00018%]
[INFO] ** src:[22:38.39511%,9:25.97719%,7:18.12649%,1:17.50047%,21:0.00037%,15:0.00037%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1483 (0.27178%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6796e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.2532e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 7.7529e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.5927e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1292e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.4884e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.5902e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8022e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.3125e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7753e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/545671
[33m[INFO] loading file 32-32/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (545671, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (545671, 17)

[INFO] analyzing data
[INFO] 545671 rows
[INFO] ** appi_name:[21:99.99633%,30:0.00312%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.3767%,Single Stage Single Point:35.6233%]
[INFO] ** dst:[21:43.32134%,10:21.0506%,8:18.16094%,9:17.46235%,15:0.00312%,22:0.00092%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99725%,0:0.00275%]
[INFO] ** i/f_name:[2:99.99688%,3:0.00312%]
[INFO] ** modbus_function_code:[0.02961:99.99633%,-33.760870000000004:0.00367%]
[INFO] ** modbus_function_description:[7:49.99918%,11:49.99716%,0:0.00367%]
[INFO] ** modbus_transaction_id:65536 (12.01017%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99633%,1:0.00312%,2:0.00055%]
[INFO] ** proxy_src_ip:[18:38.41509%,20:25.95722%,13:18.16094%,6:17.4629%,17:0.00312%,14:0.00055%,16:0.00018%]
[INFO] ** s_port:[1.45442:25.95667%,-0.32151:21.0506%,-1.27613:18.16058%,-0.23351:17.46217%,-0.33484:17.36449%,-71.33197:0.00312%,-0.24151:0.00055%,-1.2708:0.00018%,-1.02014:0.00018%,13.431270000000001:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,1.45709:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:25.9563%,1:21.05041%,5:18.16058%,4:17.4618%,2:17.36449%,0:0.00641%]
[INFO] ** service:[0.0048200000000000005:99.99633%,-211.73542999999998:0.00312%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.41509%,9:25.95722%,7:18.16094%,1:17.4629%,14:0.00312%,2:0.00055%,15:0.00018%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1481 (0.27141%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2487e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.4224e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.2079e-04 - tp: 79997.0000 - fp: 3.0000 - tn: 319997.0000 - fn: 3.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1072e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.7905e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.9628e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.4441e-05 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.0583e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.9097e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.7850e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/545671
[33m[INFO] loading file 33-33/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (545671, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (545671, 17)

[INFO] analyzing data
[INFO] 545671 rows
[INFO] ** appi_name:[21:99.99688%,30:0.0011%,17:0.00073%,22:0.00055%,31:0.00018%,28:0.00018%,26:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.39448%,Single Stage Single Point:35.60552%]
[INFO] ** dst:[21:43.32831%,10:21.06123%,8:18.12044%,9:17.48508%,22:0.00147%,15:0.0011%,16:0.00073%,6:0.00073%,24:0.00037%,17:0.00037%,18:0.00018%]
[INFO] ** i/f_dir:[1:99.9989%,0:0.0011%]
[INFO] ** i/f_name:[2:99.9989%,3:0.0011%]
[INFO] ** modbus_function_code:[0.02961:99.99688%,-33.760870000000004:0.00312%]
[INFO] ** modbus_function_description:[7:49.99954%,11:49.99734%,0:0.00312%]
[INFO] ** modbus_transaction_id:65536 (12.01017%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99798%,1:0.0011%,2:0.00092%]
[INFO] ** proxy_src_ip:[18:38.4226%,20:25.96785%,13:18.12044%,6:17.48526%,17:0.0011%,16:0.00073%,1:0.00073%,21:0.00037%,14:0.00037%,7:0.00037%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.96693%,-0.32151:21.06123%,-1.27613:18.12008%,-0.23351:17.48489%,-0.33484:17.36138%,-71.33197:0.0011%,-1.02014:0.00073%,1.45709:0.00055%,-71.14931:0.00055%,-1.27347:0.00037%,-5.08665:0.00018%,6.1115699999999995:0.00018%,2.05573:0.00018%,-43.76509:0.00018%,-71.14798:0.00018%,-58.032509999999995:0.00018%,-58.035180000000004:0.00018%,-0.24151:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:25.96656%,1:21.06123%,5:18.11989%,4:17.48471%,2:17.36138%,0:0.00623%]
[INFO] ** service:[0.0048200000000000005:99.99688%,-211.73542999999998:0.0011%,-205.44247:0.00073%,-211.08818:0.00055%,-211.09762999999998:0.00018%,-211.08346:0.00018%,-185.9872:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.4226%,9:25.96785%,7:18.12044%,1:17.48526%,14:0.0011%,15:0.00073%,3:0.00073%,21:0.00037%,4:0.00037%,2:0.00037%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1484 (0.27196%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.4848e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.4726e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2722e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3758e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.9513e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4300e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.1542e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8946e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/545671
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7894e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8903e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/545671
[33m[INFO] loading file 34-34/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (387104, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (387104, 17)

[INFO] analyzing data
[INFO] 387104 rows
[INFO] ** appi_name:[21:99.99742%,30:0.00077%,7:0.00077%,31:0.00026%,22:0.00026%,8:0.00026%,6:0.00026%]
[INFO] ** classification:[normal:64.34369%,Single Stage Single Point:35.65631%]
[INFO] ** dst:[21:43.28553%,10:21.05507%,8:18.19718%,9:17.45913%,22:0.00077%,15:0.00077%,16:0.00052%,2:0.00052%,18:0.00026%,6:0.00026%]
[INFO] ** i/f_dir:[1:99.99923%,0:0.00077%]
[INFO] ** i/f_name:[2:99.99923%,3:0.00077%]
[INFO] ** modbus_function_code:[0.02961:99.99742%,-33.760870000000004:0.00258%]
[INFO] ** modbus_function_description:[7:49.99923%,11:49.99819%,0:0.00258%]
[INFO] ** modbus_transaction_id:65536 (16.92982%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99871%,1:0.00077%,2:0.00052%]
[INFO] ** proxy_src_ip:[18:38.38968%,20:25.95091%,13:18.19718%,6:17.45965%,17:0.00077%,1:0.00077%,21:0.00052%,14:0.00026%,7:0.00026%]
[INFO] ** s_port:[1.45442:25.95065%,-0.32151:21.05481%,-1.27613:18.19718%,-0.23351:17.45887%,-0.33484:17.33488%,-0.24151:0.00077%,-71.33197:0.00077%,-3.0613900000000003:0.00026%,-3.3787199999999995:0.00026%,14.191239999999999:0.00026%,1.47576:0.00026%,11.57001:0.00026%,-49.275529999999996:0.00026%,-71.14931:0.00026%,7.66617:0.00026%]
[INFO] ** scada_tag:[3:25.95039%,1:21.05455%,5:18.19692%,4:17.45836%,2:17.33488%,0:0.00491%]
[INFO] ** service:[0.0048200000000000005:99.99768%,-211.09762999999998:0.00077%,-211.73542999999998:0.00077%,-186.43601999999998:0.00026%,-211.35747999999998:0.00026%,-211.08818:0.00026%]
[INFO] ** src:[22:38.38968%,9:25.95091%,7:18.19718%,1:17.45965%,14:0.00077%,3:0.00077%,4:0.00052%,21:0.00026%,2:0.00026%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1051 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/387104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.1177e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9323e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/387104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4605e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.4952e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/387104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0419e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4184e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/387104
[33m[INFO] loading file 35-35/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587104, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587104, 17)

[INFO] analyzing data
[INFO] 587104 rows
[INFO] ** appi_name:[21:99.99898%,30:0.00102%]
[INFO] ** classification:[normal:64.3627%,Single Stage Single Point:35.6373%]
[INFO] ** dst:[21:43.32231%,10:21.03784%,8:18.16424%,9:17.47339%,22:0.00119%,15:0.00102%]
[INFO] ** i/f_dir:[1:99.99915%,0:0.00085%]
[INFO] ** i/f_name:[2:99.99898%,3:0.00102%]
[INFO] ** modbus_function_code:[0.02961:99.99898%,-33.760870000000004:0.00102%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.99881%,0:0.00102%]
[INFO] ** modbus_transaction_id:65536 (11.16259%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.99898%,1:0.00102%]
[INFO] ** proxy_src_ip:[18:38.39354%,20:25.96712%,13:18.1639%,6:17.47374%,17:0.00102%,16:0.00068%]
[INFO] ** s_port:[1.45442:25.96661%,-0.32151:21.03784%,-1.27613:18.1639%,-0.23351:17.47322%,-0.33484:17.3557%,-71.33197:0.00102%,-1.02014:0.00068%,-0.24151:0.00034%,1.45709:0.00017%,-0.24950999999999998:0.00017%,1.46509:0.00017%,1.47576:0.00017%]
[INFO] ** scada_tag:[3:25.96627%,1:21.03784%,5:18.16373%,4:17.47288%,2:17.3557%,0:0.00358%]
[INFO] ** service:[0.0048200000000000005:99.99898%,-211.73542999999998:0.00102%]
[INFO] ** src:[22:38.39354%,9:25.96712%,7:18.1639%,1:17.47374%,14:0.00102%,15:0.00068%]
[INFO] ** type:[0:99.99915%,1:0.00085%]
[INFO] ** unixtime:1594 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8501e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.4881e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2752e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2011e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0607e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.5050e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0863e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7035e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.8354e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4210e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/587104
[33m[INFO] loading file 36-36/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587104, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587104, 17)

[INFO] analyzing data
[INFO] 587104 rows
[INFO] ** appi_name:[21:99.99864%,30:0.00068%,31:0.00034%,33:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.36185%,Single Stage Single Point:35.63815%]
[INFO] ** dst:[21:43.32895%,10:21.03069%,8:18.15113%,9:17.48685%,22:0.00085%,15:0.00068%,24:0.00034%,18:0.00034%,25:0.00017%]
[INFO] ** i/f_dir:[1:99.99932%,0:0.00068%]
[INFO] ** i/f_name:[2:99.99932%,3:0.00068%]
[INFO] ** modbus_function_code:[0.02961:99.99864%,-33.760870000000004:0.00136%]
[INFO] ** modbus_function_description:[7:50.00017%,11:49.99847%,0:0.00136%]
[INFO] ** modbus_transaction_id:65536 (11.16259%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99881%,1:0.00068%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.38162%,20:25.97819%,13:18.1513%,6:17.48736%,17:0.00068%,21:0.00017%,16:0.00017%,2:0.00017%,1:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.97768%,-0.32151:21.03052%,-1.27613:18.15079%,-0.23351:17.48668%,-0.33484:17.3511%,-71.33197:0.00068%,-0.24151:0.00051%,-0.08551:0.00034%,-1.27347:0.00034%,1.45709:0.00017%,1.47576:0.00017%,-1.02014:0.00017%,-1.2708:0.00017%,1.46509:0.00017%,-64.19493:0.00017%,-0.24950999999999998:0.00017%,-49.275529999999996:0.00017%]
[INFO] ** scada_tag:[3:25.97734%,1:21.03035%,5:18.15062%,4:17.48651%,2:17.35093%,0:0.00426%]
[INFO] ** service:[0.0048200000000000005:99.99881%,-211.73542999999998:0.00068%,-186.43601999999998:0.00034%,-186.44547:0.00017%]
[INFO] ** src:[22:38.38162%,9:25.97819%,7:18.1513%,1:17.48736%,14:0.00068%,17:0.00017%,15:0.00017%,8:0.00017%,4:0.00017%,3:0.00017%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1594 (0.2715%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.2803e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9655e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.7864e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6078e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.7979e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.0023e-04 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.4877e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.6853e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 2.5273e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.4425e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/587104
[33m[INFO] loading file 37-37/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587104, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587104, 17)

[INFO] analyzing data
[INFO] 587104 rows
[INFO] ** appi_name:[21:99.99881%,30:0.00068%,33:0.00017%,26:0.00017%,9:0.00017%]
[INFO] ** classification:[normal:64.37974%,Single Stage Single Point:35.62026%]
[INFO] ** dst:[21:43.33968%,10:21.03818%,8:18.13733%,9:17.48293%,22:0.00068%,15:0.00068%,24:0.00017%,6:0.00017%,0:0.00017%]
[INFO] ** i/f_dir:[1:99.99966%,0:0.00034%]
[INFO] ** i/f_name:[2:99.99932%,3:0.00068%]
[INFO] ** modbus_function_code:[0.02961:99.99881%,-33.760870000000004:0.00119%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99881%,0:0.00119%]
[INFO] ** modbus_transaction_id:65536 (11.16259%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99915%,1:0.00068%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.3869%,20:25.99114%,13:18.13733%,6:17.4831%,17:0.00068%,21:0.00034%,16:0.00034%,1:0.00017%]
[INFO] ** s_port:[1.45442:25.99063%,-0.32151:21.03801%,-1.27613:18.13699%,-0.23351:17.48276%,-0.33484:17.34889%,-71.33197:0.00068%,-1.02014:0.00034%,1.46509:0.00017%,1.47576:0.00017%,-1.27347:0.00017%,-49.275529999999996:0.00017%,-0.24950999999999998:0.00017%,-0.24151:0.00017%,-1.2708:0.00017%,1.45709:0.00017%,14.4699:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:25.99045%,1:21.03801%,5:18.13682%,4:17.48259%,2:17.34872%,0:0.00341%]
[INFO] ** service:[0.0048200000000000005:99.99898%,-211.73542999999998:0.00068%,-183.8612:0.00017%,-211.08346:0.00017%]
[INFO] ** src:[22:38.3869%,9:25.99114%,7:18.13733%,1:17.4831%,14:0.00068%,15:0.00034%,4:0.00034%,3:0.00017%]
[INFO] ** type:[0:99.99966%,1:0.00034%]
[INFO] ** unixtime:1595 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 8s - loss: 3.0441e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.8839e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 1.0908e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.4425e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 3.6830e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7759e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.2809e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9045e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.5869e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2167e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/587104
[33m[INFO] loading file 38-38/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587104, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587104, 17)

[INFO] analyzing data
[INFO] 587104 rows
[INFO] ** appi_name:[21:99.99898%,30:0.00034%,26:0.00017%,17:0.00017%,12:0.00017%,0:0.00017%]
[INFO] ** classification:[normal:64.4075%,Single Stage Single Point:35.5925%]
[INFO] ** dst:[21:43.3206%,10:21.08485%,8:18.09782%,9:17.49486%,22:0.00085%,15:0.00034%,25:0.00017%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99983%,0:0.00017%]
[INFO] ** i/f_name:[2:99.99966%,3:0.00034%]
[INFO] ** modbus_function_code:[0.02961:99.99898%,-33.760870000000004:0.00102%]
[INFO] ** modbus_function_description:[7:49.99966%,11:49.99932%,0:0.00102%]
[INFO] ** modbus_transaction_id:65536 (11.16259%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99932%,2:0.00034%,1:0.00034%]
[INFO] ** proxy_src_ip:[18:38.44549%,20:25.96065%,13:18.09765%,6:17.49503%,17:0.00034%,7:0.00034%,16:0.00017%,5:0.00017%,0:0.00017%]
[INFO] ** s_port:[1.45442:25.9598%,-0.32151:21.08468%,-1.27613:18.09748%,-0.23351:17.49452%,-0.33484:17.36081%,1.47576:0.00034%,-0.24151:0.00034%,-71.33197:0.00034%,1.45709:0.00034%,-1.27347:0.00017%,1.46509:0.00017%,-61.95768:0.00017%,-0.24950999999999998:0.00017%,-1.02014:0.00017%,10.192739999999999:0.00017%,-64.19493:0.00017%,-71.14798:0.00017%]
[INFO] ** scada_tag:[3:25.95946%,1:21.08468%,5:18.09748%,4:17.49435%,2:17.36064%,0:0.00341%]
[INFO] ** service:[0.0048200000000000005:99.99915%,-211.73542999999998:0.00034%,-211.08346:0.00017%,-205.44247:0.00017%,-186.44547:0.00017%]
[INFO] ** src:[22:38.44549%,9:25.96065%,7:18.09765%,1:17.49503%,21:0.00034%,14:0.00034%,16:0.00017%,15:0.00017%,8:0.00017%]
[INFO] ** type:[0:99.99983%,1:0.00017%]
[INFO] ** unixtime:1595 (0.27167%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 6.3484e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4480e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.3971e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1342e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.0054e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5068e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3188e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.4198e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6269e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.3781e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/587104
[33m[INFO] loading file 39-39/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587104, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587104, 17)

[INFO] analyzing data
[INFO] 587104 rows
[INFO] ** appi_name:[21:99.99966%,26:0.00017%,17:0.00017%]
[INFO] ** classification:[normal:64.39643%,Single Stage Single Point:35.60357%]
[INFO] ** dst:[21:43.31379%,10:21.08144%,8:18.13818%,9:17.46522%,22:0.00085%,24:0.00017%,16:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99966%,-33.760870000000004:0.00034%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99966%,0:0.00034%]
[INFO] ** modbus_transaction_id:65536 (11.16259%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99983%,2:0.00017%]
[INFO] ** proxy_src_ip:[18:38.4431%,20:25.95247%,13:18.13835%,6:17.46522%,16:0.00051%,7:0.00034%]
[INFO] ** s_port:[1.45442:25.95196%,-0.32151:21.08144%,-1.27613:18.13801%,-0.23351:17.46505%,-0.33484:17.36166%,-1.02014:0.00051%,-71.14798:0.00017%,-1.27347:0.00017%,1.45709:0.00017%,1.46509:0.00017%,1.47576:0.00017%,-0.24151:0.00017%,-1.2708:0.00017%,10.192739999999999:0.00017%]
[INFO] ** scada_tag:[3:25.95162%,1:21.08127%,5:18.13784%,4:17.46505%,2:17.36149%,0:0.00273%]
[INFO] ** service:[0.0048200000000000005:99.99966%,-211.08346:0.00017%,-205.44247:0.00017%]
[INFO] ** src:[22:38.4431%,9:25.95247%,7:18.13835%,1:17.46522%,15:0.00051%,21:0.00034%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1593 (0.27133%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.5897e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.5515e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.0569e-05 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1086e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.2549e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8637e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5539e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2739e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2233e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.6172e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/587104
[33m[INFO] loading file 40-40/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (587104, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (587104, 17)

[INFO] analyzing data
[INFO] 587104 rows
[INFO] ** appi_name:[21:99.99659%,30:0.0029%,31:0.00017%,27:0.00017%,26:0.00017%]
[INFO] ** classification:[normal:64.33937%,Single Stage Single Point:35.66063%]
[INFO] ** dst:[21:43.29488%,10:21.03988%,8:18.19558%,9:17.46522%,15:0.0029%,22:0.00085%,24:0.00017%,18:0.00017%,7:0.00017%,6:0.00017%]
[INFO] ** i/f_dir:[1:99.99727%,0:0.00273%]
[INFO] ** i/f_name:[2:99.9971%,3:0.0029%]
[INFO] ** modbus_function_code:[0.02961:99.99659%,-33.760870000000004:0.00341%]
[INFO] ** modbus_function_description:[7:49.99932%,11:49.99727%,0:0.00341%]
[INFO] ** modbus_transaction_id:65536 (11.16259%)
[INFO] ** orig:[0:99.99966%,1:0.00034%]
[INFO] ** proto:[0:99.99659%,1:0.0029%,2:0.00051%]
[INFO] ** proxy_src_ip:[18:38.35947%,20:25.97615%,13:18.19541%,6:17.46556%,17:0.0029%,14:0.00051%]
[INFO] ** s_port:[1.45442:25.9753%,-0.32151:21.03988%,-1.27613:18.19524%,-0.23351:17.46505%,-0.33484:17.31959%,-71.33197:0.0029%,1.45709:0.00051%,-0.24151:0.00034%,-71.14798:0.00017%,-1.27347:0.00017%,11.862:0.00017%,-0.24950999999999998:0.00017%,1.46509:0.00017%,1.47576:0.00017%,13.431270000000001:0.00017%]
[INFO] ** scada_tag:[3:25.97496%,1:21.03971%,5:18.19507%,4:17.46471%,2:17.31942%,0:0.00613%]
[INFO] ** service:[0.0048200000000000005:99.99659%,-211.73542999999998:0.0029%,-211.08346:0.00017%,-202.75898:0.00017%,-186.43601999999998:0.00017%]
[INFO] ** src:[22:38.35947%,9:25.97615%,7:18.19541%,1:17.46556%,14:0.0029%,2:0.00051%]
[INFO] ** type:[0:99.99915%,1:0.00085%]
[INFO] ** unixtime:1596 (0.27184%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.0345e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2609e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0250e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.5698e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5600e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7599e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0155e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.6647e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/587104
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.2585e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.2443e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/587104
[33m[INFO] loading file 41-41/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (527262, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (527262, 17)

[INFO] analyzing data
[INFO] 527262 rows
[INFO] ** appi_name:[21:99.99678%,30:0.00095%,22:0.00076%,17:0.00076%,32:0.00019%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.38526%,Single Stage Single Point:35.61474%]
[INFO] ** dst:[21:43.32343%,10:21.05784%,8:18.14639%,9:17.46817%,16:0.00095%,15:0.00095%,6:0.00095%,22:0.00057%,24:0.00038%,17:0.00038%]
[INFO] ** i/f_dir:[1:99.99905%,0:0.00095%]
[INFO] ** i/f_name:[2:99.99905%,3:0.00095%]
[INFO] ** modbus_function_code:[0.02961:99.99678%,-33.760870000000004:0.00322%]
[INFO] ** modbus_function_description:[7:49.99905%,11:49.99772%,0:0.00322%]
[INFO] ** modbus_transaction_id:65536 (12.42949%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99791%,2:0.00114%,1:0.00095%]
[INFO] ** proxy_src_ip:[18:38.42701%,20:25.95446%,13:18.14658%,6:17.46836%,17:0.00095%,1:0.00076%,21:0.00038%,16:0.00038%,14:0.00038%,0:0.00038%,7:0.00019%,2:0.00019%]
[INFO] ** s_port:[1.45442:25.95408%,-0.32151:21.05784%,-1.27613:18.14601%,-0.23351:17.46798%,-0.33484:17.36916%,-71.33197:0.00095%,-71.14931:0.00076%,-1.27347:0.00038%,-1.02014:0.00038%,-0.24151:0.00019%,-5.1466400000000005:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,1.46509:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,-5.08665:0.00019%,-64.19226:0.00019%,-0.24950999999999998:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:25.95389%,1:21.05784%,5:18.14601%,4:17.46779%,2:17.36897%,0:0.0055%]
[INFO] ** service:[0.0048200000000000005:99.99678%,-211.73542999999998:0.00095%,-205.44247:0.00076%,-211.08818:0.00076%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%,89.64175:0.00019%]
[INFO] ** src:[22:38.42701%,9:25.95446%,7:18.14658%,1:17.46836%,14:0.00095%,3:0.00076%,15:0.00038%,8:0.00038%,4:0.00038%,2:0.00038%,21:0.00019%,17:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1430 (0.27121%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/527262
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.9377e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.1820e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/527262
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8332e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0676e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/527262
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.9094e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0093e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/527262
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.0679e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1344e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/527262
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.4952e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0646e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-40-41-batch-400000-500000
[INFO] processing batch 500000-600000/527262
[33m[INFO] loading file 42-42/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (370776, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (370776, 17)

[INFO] analyzing data
[INFO] 370776 rows
[INFO] ** appi_name:[21:99.99083%,30:0.00243%,17:0.00135%,31:0.00108%,26:0.00108%,7:0.00108%,22:0.00081%,28:0.00027%,27:0.00027%,9:0.00027%,8:0.00027%,0:0.00027%]
[INFO] ** classification:[normal:64.3553%,Single Stage Single Point:35.6447%]
[INFO] ** dst:[21:43.30485%,10:21.04074%,8:18.19589%,9:17.44854%,16:0.00243%,6:0.00216%,18:0.00135%,2:0.00108%,22:0.00081%,15:0.00081%,17:0.00054%,25:0.00027%,7:0.00027%,0:0.00027%]
[INFO] ** i/f_dir:[1:99.99919%,0:0.00081%]
[INFO] ** i/f_name:[2:99.99919%,3:0.00081%]
[INFO] ** modbus_function_code:[0.02961:99.99083%,-33.760870000000004:0.00917%]
[INFO] ** modbus_function_description:[7:49.99595%,11:49.99488%,0:0.00917%]
[INFO] ** modbus_transaction_id:65536 (17.67536%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99515%,2:0.00405%,1:0.00081%]
[INFO] ** proxy_src_ip:[18:38.39461%,20:25.95125%,13:18.19616%,6:17.44854%,17:0.00243%,1:0.00243%,14:0.00162%,21:0.00108%,7:0.00081%,0:0.00054%,16:0.00027%,2:0.00027%]
[INFO] ** s_port:[1.45442:25.95071%,-0.32151:21.04074%,-1.27613:18.19589%,-0.23351:17.44827%,-0.33484:17.35387%,-71.14931:0.00108%,-71.14798:0.00108%,-71.33197:0.00081%,-3.3787199999999995:0.00054%,-0.08551:0.00054%,11.57001:0.00054%,13.431270000000001:0.00027%,-5.1466400000000005:0.00027%,0.31847:0.00027%,-1.02014:0.00027%,-64.19493:0.00027%,-1.2708:0.00027%,-58.035180000000004:0.00027%,7.66617:0.00027%,-0.24151:0.00027%,1.47576:0.00027%,14.4699:0.00027%,15.912510000000001:0.00027%,14.191239999999999:0.00027%,7.9608300000000005:0.00027%,-5.08665:0.00027%,10.192739999999999:0.00027%,-3.0613900000000003:0.00027%,1.45709:0.00027%,2.05573:0.00027%,-43.76509:0.00027%,11.862:0.00027%,-58.032509999999995:0.00027%]
[INFO] ** scada_tag:[3:25.95044%,1:21.04074%,5:18.19562%,4:17.44827%,2:17.3536%,0:0.01133%]
[INFO] ** service:[0.0048200000000000005:99.99083%,-211.09762999999998:0.00189%,-205.44247:0.00135%,-186.43601999999998:0.00135%,-211.08346:0.00108%,-211.08818:0.00108%,-211.73542999999998:0.00081%,-211.35747999999998:0.00054%,-186.44547:0.00027%,-183.8612:0.00027%,-185.9872:0.00027%,-202.75898:0.00027%]
[INFO] ** src:[22:38.39461%,9:25.95125%,7:18.19616%,1:17.44854%,3:0.00324%,2:0.00189%,4:0.00135%,21:0.00108%,14:0.00081%,8:0.00054%,17:0.00027%,15:0.00027%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1007 (0.27159%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/370776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.2026e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3829e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/370776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1849e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0265e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/370776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.2218e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.4411e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/370776
[33m[INFO] loading file 43-43/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (570776, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (570776, 17)

[INFO] analyzing data
[INFO] 570776 rows
[INFO] ** appi_name:[21:99.99877%,30:0.00053%,26:0.00035%,8:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.39847%,Single Stage Single Point:35.60153%]
[INFO] ** dst:[21:43.32523%,10:21.07096%,8:18.13005%,9:17.4713%,22:0.00105%,15:0.00053%,6:0.00035%,2:0.00035%,24:0.00018%]
[INFO] ** i/f_dir:[1:99.99982%,0:0.00018%]
[INFO] ** i/f_name:[2:99.99947%,3:0.00053%]
[INFO] ** modbus_function_code:[0.02961:99.99877%,-33.760870000000004:0.00123%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99877%,0:0.00123%]
[INFO] ** modbus_transaction_id:65536 (11.48191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99912%,1:0.00053%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.42068%,20:25.97604%,13:18.13023%,6:17.47148%,17:0.00053%,1:0.00053%,16:0.00035%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.97534%,-0.32151:21.07096%,-1.27613:18.12988%,-0.23351:17.47095%,-0.33484:17.34971%,-71.33197:0.00053%,-71.14798:0.00035%,1.45709:0.00035%,1.47576:0.00035%,-0.24151:0.00035%,-1.02014:0.00035%,0.31847:0.00018%,-1.27347:0.00018%,-0.24950999999999998:0.00018%,-1.2708:0.00018%,-3.3787199999999995:0.00018%]
[INFO] ** scada_tag:[3:25.97499%,1:21.07096%,5:18.1297%,4:17.4706%,2:17.34954%,0:0.0042%]
[INFO] ** service:[0.0048200000000000005:99.99877%,-211.73542999999998:0.00053%,-211.08346:0.00035%,-211.09762999999998:0.00018%,-211.35747999999998:0.00018%]
[INFO] ** src:[22:38.42068%,9:25.97604%,7:18.13023%,1:17.47148%,14:0.00053%,3:0.00053%,15:0.00035%,21:0.00018%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1552 (0.27191%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.8114e-05 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8319e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.1350e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3898e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6236e-04 - tp: 79997.0000 - fp: 3.0000 - tn: 319997.0000 - fn: 3.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5168e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.8898e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5302e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7479e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1266e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/570776
[33m[INFO] loading file 44-44/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (570776, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (570776, 17)

[INFO] analyzing data
[INFO] 570776 rows
[INFO] ** appi_name:[21:99.99825%,30:0.0007%,31:0.00053%,0:0.00035%,22:0.00018%]
[INFO] ** classification:[normal:64.39461%,Single Stage Single Point:35.60539%]
[INFO] ** dst:[21:43.33679%,10:21.05484%,8:18.14915%,9:17.45606%,22:0.00105%,15:0.0007%,18:0.00053%,25:0.00035%,24:0.00035%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.9993%,0:0.0007%]
[INFO] ** i/f_name:[2:99.9993%,3:0.0007%]
[INFO] ** modbus_function_code:[0.02961:99.99825%,-33.760870000000004:0.00175%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99825%,0:0.00175%]
[INFO] ** modbus_transaction_id:65536 (11.48191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99825%,2:0.00105%,1:0.0007%]
[INFO] ** proxy_src_ip:[18:38.43627%,20:25.95589%,13:18.14933%,6:17.45659%,17:0.0007%,7:0.00035%,16:0.00018%,5:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95519%,-0.32151:21.05484%,-1.27613:18.1488%,-0.23351:17.45588%,-0.33484:17.38142%,-71.33197:0.0007%,-0.24151:0.00053%,-0.08551:0.00035%,-64.19493:0.00035%,-1.27347:0.00035%,1.45709:0.00035%,-1.02014:0.00018%,-1.2708:0.00018%,1.47576:0.00018%,-71.14931:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,4.42897:0.00018%]
[INFO] ** scada_tag:[3:25.95467%,1:21.05484%,5:18.1488%,4:17.45553%,2:17.38125%,0:0.00491%]
[INFO] ** service:[0.0048200000000000005:99.99825%,-211.73542999999998:0.0007%,-186.43601999999998:0.00053%,-186.44547:0.00035%,-211.08818:0.00018%]
[INFO] ** src:[22:38.43627%,9:25.95589%,7:18.14933%,1:17.45659%,14:0.0007%,21:0.00035%,17:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1549 (0.27138%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3426e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.6652e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.1722e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1100e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1617e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0100e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9909e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5758e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.5002e-05 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9698e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/570776
[33m[INFO] loading file 45-45/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (570776, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (570776, 17)

[INFO] analyzing data
[INFO] 570776 rows
[INFO] ** appi_name:[21:99.99877%,30:0.00053%,31:0.00035%,26:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:64.41389%,Single Stage Single Point:35.58611%]
[INFO] ** dst:[21:43.32295%,10:21.08813%,8:18.13023%,9:17.45606%,22:0.0014%,15:0.00053%,18:0.00035%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99965%,0:0.00035%]
[INFO] ** i/f_name:[2:99.99947%,3:0.00053%]
[INFO] ** modbus_function_code:[0.02961:99.99877%,-33.760870000000004:0.00123%]
[INFO] ** modbus_function_description:[7:50.00035%,11:49.99842%,0:0.00123%]
[INFO] ** modbus_transaction_id:65536 (11.48191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99895%,2:0.00053%,1:0.00053%]
[INFO] ** proxy_src_ip:[18:38.48235%,20:25.92944%,13:18.13005%,6:17.45659%,17:0.00053%,16:0.00035%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.92874%,-0.32151:21.08813%,-1.27613:18.13005%,-0.23351:17.45588%,-0.33484:17.39421%,1.45709:0.00053%,-0.24151:0.00053%,-71.33197:0.00053%,-1.02014:0.00035%,-0.08551:0.00035%,-71.14798:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.92821%,1:21.08796%,5:18.13005%,4:17.45588%,2:17.39404%,0:0.00385%]
[INFO] ** service:[0.0048200000000000005:99.99877%,-211.73542999999998:0.00053%,-186.43601999999998:0.00035%,-183.8612:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.48235%,9:25.92944%,7:18.13005%,1:17.45659%,14:0.00053%,15:0.00035%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99982%,1:0.00018%]
[INFO] ** unixtime:1549 (0.27138%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3648e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.2923e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6221e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2625e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.7944e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0526e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.3780e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.2926e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 7.5401e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.9703e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/570776
[33m[INFO] loading file 46-46/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (570776, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (570776, 17)

[INFO] analyzing data
[INFO] 570776 rows
[INFO] ** appi_name:[21:99.99825%,30:0.00105%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.42405%,Single Stage Single Point:35.57595%]
[INFO] ** dst:[21:43.348%,10:21.07342%,8:18.1036%,9:17.47235%,22:0.00105%,15:0.00105%,25:0.00018%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99912%,0:0.00088%]
[INFO] ** i/f_name:[2:99.99895%,3:0.00105%]
[INFO] ** modbus_function_code:[0.02961:99.99825%,-33.760870000000004:0.00175%]
[INFO] ** modbus_function_description:[11:49.99912%,7:49.99912%,0:0.00175%]
[INFO] ** modbus_transaction_id:65536 (11.48191%)
[INFO] ** orig:[0:99.99965%,1:0.00035%]
[INFO] ** proto:[0:99.9986%,1:0.00105%,2:0.00035%]
[INFO] ** proxy_src_ip:[18:38.44626%,20:25.97516%,13:18.1036%,6:17.47288%,17:0.00105%,16:0.00035%,7:0.00035%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.97481%,-0.32151:21.07324%,-1.27613:18.10342%,-0.23351:17.47218%,-0.33484:17.37301%,-71.33197:0.00105%,-0.24151:0.00053%,-1.02014:0.00035%,-71.14798:0.00018%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.47576:0.00018%,-61.95768:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:25.97446%,1:21.07307%,5:18.10325%,4:17.47183%,2:17.37301%,0:0.00438%]
[INFO] ** service:[0.0048200000000000005:99.99842%,-211.73542999999998:0.00105%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%]
[INFO] ** src:[22:38.44626%,9:25.97516%,7:18.1036%,1:17.47288%,14:0.00105%,21:0.00035%,15:0.00035%,16:0.00018%,8:0.00018%]
[INFO] ** type:[0:99.99912%,1:0.00088%]
[INFO] ** unixtime:1552 (0.27191%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.6370e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.5063e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1111e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.9619e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.8081e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.9551e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.9250e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6315e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0091e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9633e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/570776
[33m[INFO] loading file 47-47/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (570776, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (570776, 17)

[INFO] analyzing data
[INFO] 570776 rows
[INFO] ** appi_name:[21:99.99947%,33:0.00018%,26:0.00018%,17:0.00018%]
[INFO] ** classification:[normal:64.39321%,Single Stage Single Point:35.60679%]
[INFO] ** dst:[21:43.30911%,10:21.08218%,8:18.13023%,9:17.47621%,22:0.00158%,24:0.00035%,16:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99947%,-33.760870000000004:0.00053%]
[INFO] ** modbus_function_description:[7:50.00088%,11:49.9986%,0:0.00053%]
[INFO] ** modbus_transaction_id:65536 (11.48191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99982%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.45081%,20:25.94117%,13:18.13058%,6:17.47656%,16:0.00035%,7:0.00035%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.9403%,-0.32151:21.08218%,-1.27613:18.13005%,-0.23351:17.47603%,-0.33484:17.36863%,1.45709:0.00053%,-0.24151:0.00053%,-1.27347:0.00035%,-1.02014:0.00035%,-71.14798:0.00018%,-61.95635:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,10.192739999999999:0.00018%]
[INFO] ** scada_tag:[3:25.93977%,1:21.082%,5:18.12988%,4:17.47586%,2:17.36846%,0:0.00403%]
[INFO] ** service:[0.0048200000000000005:99.99965%,-211.08346:0.00018%,-205.44247:0.00018%]
[INFO] ** src:[22:38.45081%,9:25.94117%,7:18.13058%,1:17.47656%,21:0.00035%,15:0.00035%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1549 (0.27138%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3103e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4039e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4881e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.8882e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0788e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.8315e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7699e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2211e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3800e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9009e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/570776
[33m[INFO] loading file 48-48/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (570776, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (570776, 17)

[INFO] analyzing data
[INFO] 570776 rows
[INFO] ** appi_name:[21:99.99685%,30:0.00245%,33:0.00018%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.43246%,Single Stage Single Point:35.56754%]
[INFO] ** dst:[21:43.33364%,10:21.09497%,8:18.09974%,9:17.46762%,15:0.00245%,22:0.00088%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.9979%,0:0.0021%]
[INFO] ** i/f_name:[2:99.99755%,3:0.00245%]
[INFO] ** modbus_function_code:[0.02961:99.99685%,-33.760870000000004:0.00315%]
[INFO] ** modbus_function_description:[7:49.99912%,11:49.99772%,0:0.00315%]
[INFO] ** modbus_transaction_id:65536 (11.48191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99702%,1:0.00245%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.47254%,20:25.95642%,13:18.09992%,6:17.46762%,17:0.00245%,14:0.00053%,16:0.00035%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95589%,-0.32151:21.09497%,-1.27613:18.09957%,-0.23351:17.46745%,-0.33484:17.37757%,-71.33197:0.00245%,-1.02014:0.00035%,-1.2708:0.00018%,13.431270000000001:0.00018%,-0.24151:0.00018%,-71.14798:0.00018%,-1.27347:0.00018%,1.46509:0.00018%,-61.95635:0.00018%,1.45709:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:25.95554%,1:21.09479%,5:18.09957%,4:17.46745%,2:17.37739%,0:0.00526%]
[INFO] ** service:[0.0048200000000000005:99.99702%,-211.73542999999998:0.00245%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.47254%,9:25.95642%,7:18.09992%,1:17.46762%,14:0.00245%,2:0.00053%,15:0.00035%,8:0.00018%]
[INFO] ** type:[0:99.99965%,1:0.00035%]
[INFO] ** unixtime:1548 (0.27121%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.8379e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.1572e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.3900e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.1449e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.4954e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.9200e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.9096e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.8037e-04 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.3393e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4310e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/570776
[33m[INFO] loading file 49-49/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (570776, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (570776, 17)

[INFO] analyzing data
[INFO] 570776 rows
[INFO] ** appi_name:[21:99.99737%,30:0.00088%,17:0.0007%,26:0.00035%,22:0.00035%,28:0.00018%,7:0.00018%]
[INFO] ** classification:[normal:64.37674%,Single Stage Single Point:35.62326%]
[INFO] ** dst:[21:43.31419%,10:21.05835%,8:18.13408%,9:17.489%,22:0.0014%,15:0.00088%,16:0.0007%,6:0.0007%,24:0.00035%,17:0.00035%]
[INFO] ** i/f_dir:[1:99.99912%,0:0.00088%]
[INFO] ** i/f_name:[2:99.99912%,3:0.00088%]
[INFO] ** modbus_function_code:[0.02961:99.99737%,-33.760870000000004:0.00263%]
[INFO] ** modbus_function_description:[7:49.99982%,11:49.99755%,0:0.00263%]
[INFO] ** modbus_transaction_id:65536 (11.48191%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99842%,1:0.00088%,2:0.0007%]
[INFO] ** proxy_src_ip:[18:38.42208%,20:25.95116%,13:18.13426%,6:17.48952%,17:0.00088%,1:0.0007%,14:0.00053%,21:0.00035%,16:0.00035%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95029%,-0.32151:21.05835%,-1.27613:18.13373%,-0.23351:17.48882%,-0.33484:17.36373%,-71.33197:0.00088%,1.45709:0.00053%,-0.24151:0.00053%,-1.27347:0.00035%,-71.14931:0.00035%,-1.02014:0.00035%,-71.14798:0.00035%,1.47576:0.00018%,-1.2708:0.00018%,-58.035180000000004:0.00018%,-58.032509999999995:0.00018%,1.46509:0.00018%,-43.76509:0.00018%,2.05573:0.00018%,-5.08665:0.00018%,-0.24950999999999998:0.00018%,-5.1466400000000005:0.00018%]
[INFO] ** scada_tag:[3:25.94993%,1:21.05817%,5:18.13356%,4:17.48847%,2:17.36373%,0:0.00613%]
[INFO] ** service:[0.0048200000000000005:99.99737%,-211.73542999999998:0.00088%,-205.44247:0.0007%,-211.08346:0.00035%,-211.08818:0.00035%,-211.09762999999998:0.00018%,-185.9872:0.00018%]
[INFO] ** src:[22:38.42208%,9:25.95116%,7:18.13426%,1:17.48952%,14:0.00088%,3:0.0007%,2:0.00053%,15:0.00035%,4:0.00035%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1550 (0.27156%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.8740e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.5433e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.5494e-05 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.4270e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.4751e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3199e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.1134e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.0388e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/570776
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6750e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.3161e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/570776
[33m[INFO] loading file 50-50/50 on epoch 9/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (420758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (420758, 17)

[INFO] analyzing data
[INFO] 420758 rows
[INFO] ** appi_name:[21:99.99739%,30:0.00119%,7:0.00071%,31:0.00024%,22:0.00024%,8:0.00024%]
[INFO] ** classification:[normal:64.30727%,Single Stage Single Point:35.69273%]
[INFO] ** dst:[21:43.25931%,10:21.04464%,8:18.21997%,9:17.47251%,15:0.00119%,22:0.00071%,16:0.00048%,2:0.00048%,24:0.00024%,18:0.00024%,6:0.00024%]
[INFO] ** i/f_dir:[1:99.99881%,0:0.00119%]
[INFO] ** i/f_name:[2:99.99881%,3:0.00119%]
[INFO] ** modbus_function_code:[0.02961:99.99739%,-33.760870000000004:0.00261%]
[INFO] ** modbus_function_description:[7:49.99881%,11:49.99857%,0:0.00261%]
[INFO] ** modbus_transaction_id:65536 (15.5757%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99834%,1:0.00119%,2:0.00048%]
[INFO] ** proxy_src_ip:[18:38.36885%,20:25.93534%,13:18.22021%,6:17.47251%,17:0.00119%,1:0.00071%,16:0.00048%,21:0.00024%,14:0.00024%,7:0.00024%]
[INFO] ** s_port:[1.45442:25.93486%,-0.32151:21.04464%,-1.27613:18.21974%,-0.23351:17.47251%,-0.33484:17.32421%,-71.33197:0.00119%,-1.02014:0.00048%,-3.3787199999999995:0.00024%,4.33564:0.00024%,15.912510000000001:0.00024%,7.9608300000000005:0.00024%,1.46509:0.00024%,1.45709:0.00024%,-1.27347:0.00024%,-71.14931:0.00024%,-1.2708:0.00024%,0.31847:0.00024%]
[INFO] ** scada_tag:[3:25.93462%,1:21.0444%,5:18.2195%,4:17.47251%,2:17.32397%,0:0.00499%]
[INFO] ** service:[0.0048200000000000005:99.99739%,-211.73542999999998:0.00119%,-211.09762999999998:0.00071%,-186.43601999999998:0.00024%,-211.35747999999998:0.00024%,-211.08818:0.00024%]
[INFO] ** src:[22:38.36885%,9:25.93534%,7:18.22021%,1:17.47251%,14:0.00119%,3:0.00071%,15:0.00048%,21:0.00024%,4:0.00024%,2:0.00024%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1143 (0.27165%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/420758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0154e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.3635e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/420758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.4262e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.6605e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/420758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.3885e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8293e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/420758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.5663e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3491e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-9-files-49-50-batch-300000-400000
[INFO] processing batch 400000-500000/420758
[33m[INFO] epoch 10/10[0m
[33m[INFO] loading file 1-1/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99309%,30:0.00115%,22:0.00096%,17:0.00077%,31:0.00058%,26:0.00058%,7:0.00058%,23:0.00038%,18:0.00038%,0:0.00038%,28:0.00019%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:78.70162%,Single Stage Single Point:21.29838%]
[INFO] ** dst:[21:43.26482%,10:21.04471%,8:18.16852%,9:17.51466%,6:0.00154%,16:0.00115%,15:0.00115%,22:0.00096%,18:0.00058%,26:0.00038%,25:0.00038%,19:0.00038%,17:0.00038%,24:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99885%,0:0.00115%]
[INFO] ** i/f_name:[2:99.99885%,3:0.00115%]
[INFO] ** modbus_function_code:[0.02961:99.99309%,-33.760870000000004:0.00672%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.9975%,11:49.99558%,0:0.00672%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99616%,2:0.00269%,1:0.00115%]
[INFO] ** proxy_src_ip:[18:38.4044%,20:25.90455%,13:18.16871%,6:17.51505%,11:0.00134%,10:0.00134%,17:0.00115%,14:0.00096%,1:0.00096%,7:0.00058%,21:0.00038%,16:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.90416%,-0.32151:21.04394%,-1.27613:18.16832%,-0.23351:17.51447%,-0.33484:17.36046%,-71.33197:0.00115%,-71.14931:0.00096%,-2.1481:0.00077%,-0.24151:0.00058%,-71.14798:0.00058%,-2.42942:0.00038%,4.44364:0.00038%,-1.02014:0.00038%,-64.19493:0.00038%,-5.1466400000000005:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,4.076980000000001:0.00019%,-5.08665:0.00019%,1.47576:0.00019%,1.46509:0.00019%,4.29964:0.00019%,14.253910000000001:0.00019%,-68.79874000000001:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,10.67005:0.00019%,-1.27347:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:25.90397%,1:21.04375%,5:18.16794%,4:17.51428%,2:17.36027%,0:0.00979%]
[INFO] ** service:[0.0048200000000000005:99.99386%,-211.73542999999998:0.00115%,-211.08818:0.00096%,-205.44247:0.00077%,-211.07873999999998:0.00077%,-211.09762999999998:0.00058%,-211.08346:0.00058%,-186.43601999999998:0.00058%,-186.44547:0.00038%,-185.9872:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:38.4044%,9:25.90455%,7:18.16871%,1:17.51505%,11:0.00134%,10:0.00134%,14:0.00115%,3:0.00096%,2:0.00096%,21:0.00058%,15:0.00038%,4:0.00038%,8:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1413 (0.27134%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1330 - tp: 78120.0000 - fp: 1880.0000 - tn: 318120.0000 - fn: 1880.0000 - accuracy: 0.9906 - precision: 0.9765 - recall: 0.9765 - auc: 0.9944 - val_loss: 4.3826e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-0-1-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1917e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7332e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-0-1-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9782e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4396e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-0-1-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.7834 - tp: 73241.0000 - fp: 6759.0000 - tn: 313241.0000 - fn: 6759.0000 - accuracy: 0.9662 - precision: 0.9155 - recall: 0.9155 - auc: 0.9594 - val_loss: 0.0059 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-0-1-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0027 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0014 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-0-1-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 2-2/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99866%,7:0.00058%,30:0.00038%,31:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:72.00254%,Single Stage Single Point:27.99746%]
[INFO] ** dst:[21:43.31378%,10:21.02954%,8:18.13971%,9:17.51466%,22:0.00077%,16:0.00038%,15:0.00038%,2:0.00038%,24:0.00019%,18:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99866%,-33.760870000000004:0.00134%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99885%,0:0.00134%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99942%,1:0.00038%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.38117%,20:25.96273%,13:18.13971%,6:17.51485%,1:0.00058%,17:0.00038%,16:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.96196%,-0.32151:21.02954%,-1.27613:18.13933%,-0.23351:17.51447%,-0.33484:17.35163%,-71.33197:0.00038%,1.45709:0.00038%,12.60597:0.00019%,-1.2708:0.00019%,-1.02014:0.00019%,-0.24151:0.00019%,4.076980000000001:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-1.27347:0.00019%,-3.3787199999999995:0.00019%,-0.24950999999999998:0.00019%,10.67005:0.00019%,4.29964:0.00019%]
[INFO] ** scada_tag:[3:25.96158%,1:21.02954%,5:18.13933%,4:17.51428%,2:17.35144%,0:0.00384%]
[INFO] ** service:[0.0048200000000000005:99.99866%,-211.09762999999998:0.00058%,-211.73542999999998:0.00038%,-186.43601999999998:0.00019%,-211.35747999999998:0.00019%]
[INFO] ** src:[22:38.38117%,9:25.96273%,7:18.13971%,1:17.51485%,3:0.00058%,14:0.00038%,21:0.00019%,15:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1416 (0.27191%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0059 - tp: 79868.0000 - fp: 132.0000 - tn: 319868.0000 - fn: 132.0000 - accuracy: 0.9993 - precision: 0.9984 - recall: 0.9984 - auc: 1.0000 - val_loss: 9.3495e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-1-2-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3659 - tp: 63590.0000 - fp: 16410.0000 - tn: 303590.0000 - fn: 16410.0000 - accuracy: 0.9180 - precision: 0.7949 - recall: 0.7949 - auc: 0.9742 - val_loss: 0.4044 - val_tp: 11642.0000 - val_fp: 8358.0000 - val_tn: 71642.0000 - val_fn: 8358.0000 - val_accuracy: 0.8328 - val_precision: 0.5821 - val_recall: 0.5821 - val_auc: 0.9476
[INFO] saving weights to checkpoints/lstm-epoch-10-files-1-2-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0092 - tp: 79632.0000 - fp: 368.0000 - tn: 319632.0000 - fn: 368.0000 - accuracy: 0.9982 - precision: 0.9954 - recall: 0.9954 - auc: 1.0000 - val_loss: 3.0601 - val_tp: 12788.0000 - val_fp: 7212.0000 - val_tn: 72788.0000 - val_fn: 7212.0000 - val_accuracy: 0.8558 - val_precision: 0.6394 - val_recall: 0.6394 - val_auc: 0.7746
[INFO] saving weights to checkpoints/lstm-epoch-10-files-1-2-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1167 - tp: 78092.0000 - fp: 1908.0000 - tn: 318092.0000 - fn: 1908.0000 - accuracy: 0.9905 - precision: 0.9761 - recall: 0.9761 - auc: 0.9931 - val_loss: 0.0029 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-1-2-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.3527 - tp: 64493.0000 - fp: 15507.0000 - tn: 304493.0000 - fn: 15507.0000 - accuracy: 0.9225 - precision: 0.8062 - recall: 0.8062 - auc: 0.9759 - val_loss: 0.4237 - val_tp: 10659.0000 - val_fp: 9341.0000 - val_tn: 70659.0000 - val_fn: 9341.0000 - val_accuracy: 0.8132 - val_precision: 0.5329 - val_recall: 0.5329 - val_auc: 0.9445
[INFO] saving weights to checkpoints/lstm-epoch-10-files-1-2-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 3-3/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99117%,30:0.0023%,22:0.00115%,31:0.00096%,26:0.00096%,17:0.00096%,7:0.00077%,27:0.00038%,0:0.00038%,28:0.00019%,23:0.00019%,15:0.00019%,8:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:87.24129%,Single Stage Single Point:12.75871%]
[INFO] ** dst:[21:43.30438%,10:21.08753%,8:18.15507%,9:17.44323%,6:0.0023%,15:0.00154%,18:0.00134%,16:0.00134%,22:0.00096%,2:0.00038%,7:0.00038%,25:0.00038%,17:0.00038%,12:0.00019%,24:0.00019%,19:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99846%,0:0.00154%]
[INFO] ** i/f_name:[2:99.99846%,3:0.00154%]
[INFO] ** modbus_function_code:[0.02961:99.99117%,-33.760870000000004:0.00864%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99616%,11:49.99501%,0:0.00864%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99885%,2:0.00115%]
[INFO] ** proto:[0:99.99386%,2:0.00461%,1:0.00154%]
[INFO] ** proxy_src_ip:[18:38.41804%,20:25.97425%,13:18.15527%,6:17.44361%,17:0.0023%,1:0.00154%,14:0.00134%,7:0.00096%,11:0.00077%,10:0.00077%,21:0.00058%,16:0.00019%,15:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.97348%,-0.32151:21.08734%,-1.27613:18.15469%,-0.23351:17.44303%,-0.33484:17.3307%,-71.33197:0.00154%,-71.14798:0.00115%,-71.14931:0.00115%,-64.19493:0.00038%,-0.08551:0.00038%,1.45709:0.00038%,-0.24151:0.00038%,13.431270000000001:0.00019%,14.4699:0.00019%,4.076980000000001:0.00019%,-5.1466400000000005:0.00019%,-1.02014:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,12.60597:0.00019%,-5.08665:0.00019%,1.46509:0.00019%,-2.1481:0.00019%,-1.27347:0.00019%,10.67005:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,6.1115699999999995:0.00019%,4.44364:0.00019%,13.86459:0.00019%,4.29964:0.00019%,-0.24950999999999998:0.00019%,-3.3787199999999995:0.00019%,10.192739999999999:0.00019%,-68.79874000000001:0.00019%,14.253910000000001:0.00019%,4.90362:0.00019%,-68.36943000000001:0.00019%]
[INFO] ** scada_tag:[3:25.9731%,1:21.08715%,5:18.1545%,4:17.44284%,2:17.33051%,0:0.01191%]
[INFO] ** service:[0.0048200000000000005:99.99136%,-211.73542999999998:0.00154%,-186.43601999999998:0.00134%,-211.08346:0.00115%,-211.08818:0.00115%,-205.44247:0.00096%,-211.09762999999998:0.00077%,-186.44547:0.00038%,-202.75898:0.00038%,-183.8612:0.00019%,-185.9872:0.00019%,-201.23771000000002:0.00019%,-211.35747999999998:0.00019%,-211.07873999999998:0.00019%]
[INFO] ** src:[22:38.41804%,9:25.97425%,7:18.15527%,1:17.44361%,21:0.00211%,3:0.00173%,2:0.00134%,11:0.00077%,10:0.00077%,4:0.00077%,14:0.00038%,8:0.00038%,17:0.00019%,15:0.00019%,13:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1414 (0.27153%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1412 - tp: 76730.0000 - fp: 3270.0000 - tn: 316730.0000 - fn: 3270.0000 - accuracy: 0.9836 - precision: 0.9591 - recall: 0.9591 - auc: 0.9965 - val_loss: 0.0551 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-2-3-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2015 - tp: 74357.0000 - fp: 5643.0000 - tn: 314357.0000 - fn: 5643.0000 - accuracy: 0.9718 - precision: 0.9295 - recall: 0.9295 - auc: 0.9916 - val_loss: 0.8823 - val_tp: 10567.0000 - val_fp: 9433.0000 - val_tn: 70567.0000 - val_fn: 9433.0000 - val_accuracy: 0.8113 - val_precision: 0.5283 - val_recall: 0.5283 - val_auc: 0.9444
[INFO] saving weights to checkpoints/lstm-epoch-10-files-2-3-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0251 - tp: 78759.0000 - fp: 1241.0000 - tn: 318759.0000 - fn: 1241.0000 - accuracy: 0.9938 - precision: 0.9845 - recall: 0.9845 - auc: 0.9999 - val_loss: 1.0678e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-2-3-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0520e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.7191e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-2-3-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.1444e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.4905e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-2-3-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 4-4/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.9977%,30:0.00134%,31:0.00038%,33:0.00019%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:91.59302%,Single Stage Single Point:8.40698%]
[INFO] ** dst:[21:43.35545%,10:20.94024%,8:18.1714%,9:17.52945%,15:0.00134%,22:0.00115%,18:0.00038%,24:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99885%,0:0.00115%]
[INFO] ** i/f_name:[2:99.99866%,3:0.00134%]
[INFO] ** modbus_function_code:[0.02961:99.9977%,-33.760870000000004:0.0023%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99808%,0:0.0023%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99885%,2:0.00115%]
[INFO] ** proto:[0:99.99808%,1:0.00134%,2:0.00058%]
[INFO] ** proxy_src_ip:[18:38.25846%,20:26.03762%,13:18.1714%,6:17.52983%,17:0.00134%,21:0.00038%,16:0.00038%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.03685%,-0.32151:20.94005%,-1.27613:18.17101%,-0.23351:17.52926%,-0.33484:17.31841%,-71.33197:0.00134%,1.45709:0.00038%,-0.24151:0.00038%,-1.02014:0.00038%,-0.08551:0.00038%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,14.4699:0.00019%,-49.275529999999996:0.00019%,-1.2708:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:26.03666%,1:20.93986%,5:18.17101%,4:17.52887%,2:17.31822%,0:0.00538%]
[INFO] ** service:[0.0048200000000000005:99.99789%,-211.73542999999998:0.00134%,-186.43601999999998:0.00038%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.25846%,9:26.03762%,7:18.1714%,1:17.52983%,21:0.00115%,15:0.00038%,4:0.00038%,17:0.00019%,14:0.00019%,8:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1424 (0.27345%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.4959e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.7471e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-3-4-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5246e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.0277e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-3-4-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7504e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.4835e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-3-4-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.2132e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.0718 - val_tp: 11993.0000 - val_fp: 8007.0000 - val_tn: 71993.0000 - val_fn: 8007.0000 - val_accuracy: 0.8399 - val_precision: 0.5997 - val_recall: 0.5997 - val_auc: 0.7498
[INFO] saving weights to checkpoints/lstm-epoch-10-files-3-4-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.6076 - tp: 63898.0000 - fp: 16102.0000 - tn: 303898.0000 - fn: 16102.0000 - accuracy: 0.9195 - precision: 0.7987 - recall: 0.7987 - auc: 0.9551 - val_loss: 0.7871 - val_tp: 7807.0000 - val_fp: 12193.0000 - val_tn: 67807.0000 - val_fn: 12193.0000 - val_accuracy: 0.7561 - val_precision: 0.3904 - val_recall: 0.3904 - val_auc: 0.9069
[INFO] saving weights to checkpoints/lstm-epoch-10-files-3-4-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 5-5/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99674%,30:0.0023%,37:0.00019%,26:0.00019%,12:0.00019%,6:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:89.1802%,Single Stage Single Point:10.8198%]
[INFO] ** dst:[21:43.36563%,10:20.76358%,8:18.24667%,9:17.62028%,15:0.0023%,22:0.00077%,25:0.00019%,24:0.00019%,6:0.00019%,2:0.00019%]
[INFO] ** i/f_dir:[1:99.99808%,0:0.00192%]
[INFO] ** i/f_name:[2:99.9977%,3:0.0023%]
[INFO] ** modbus_function_code:[0.02961:99.99674%,-33.760870000000004:0.00326%]
[INFO] ** modbus_function_description:[7:49.99904%,11:49.9977%,0:0.00326%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99827%,2:0.00173%]
[INFO] ** proto:[0:99.99731%,1:0.0023%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:37.99442%,20:26.13479%,13:18.24686%,6:17.62047%,17:0.0023%,21:0.00019%,16:0.00019%,7:0.00019%,5:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.1344%,-0.32151:20.7632%,-1.27613:18.24667%,-0.23351:17.62008%,-0.33484:17.23123%,-71.33197:0.0023%,-0.24151:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,1.45709:0.00019%,1.47576:0.00019%,2.22906:0.00019%,-49.275529999999996:0.00019%,-61.95768:0.00019%,-1.02014:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:26.13402%,1:20.763%,5:18.24648%,4:17.62008%,2:17.23123%,0:0.00518%]
[INFO] ** service:[0.0048200000000000005:99.99712%,-211.73542999999998:0.0023%,-186.44547:0.00019%,-211.08346:0.00019%,-211.35747999999998:0.00019%]
[INFO] ** src:[22:37.99442%,9:26.13479%,7:18.24686%,1:17.62047%,21:0.00192%,14:0.00058%,16:0.00019%,15:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1423 (0.27326%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.2461 - tp: 68301.0000 - fp: 11699.0000 - tn: 308301.0000 - fn: 11699.0000 - accuracy: 0.9415 - precision: 0.8538 - recall: 0.8538 - auc: 0.9873 - val_loss: 0.2814 - val_tp: 14758.0000 - val_fp: 5242.0000 - val_tn: 74758.0000 - val_fn: 5242.0000 - val_accuracy: 0.8952 - val_precision: 0.7379 - val_recall: 0.7379 - val_auc: 0.9743
[INFO] saving weights to checkpoints/lstm-epoch-10-files-4-5-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0187 - tp: 79724.0000 - fp: 276.0000 - tn: 319724.0000 - fn: 276.0000 - accuracy: 0.9986 - precision: 0.9966 - recall: 0.9966 - auc: 1.0000 - val_loss: 0.0020 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-4-5-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2007 - tp: 75600.0000 - fp: 4400.0000 - tn: 315600.0000 - fn: 4400.0000 - accuracy: 0.9780 - precision: 0.9450 - recall: 0.9450 - auc: 0.9916 - val_loss: 0.0395 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-4-5-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0063 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0027 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-4-5-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0022 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0018 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-4-5-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 6-6/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99558%,30:0.00346%,31:0.00019%,27:0.00019%,26:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:92.24112%,Single Stage Single Point:7.75888%]
[INFO] ** dst:[21:43.37735%,10:20.73036%,8:18.28335%,9:17.60395%,15:0.00346%,22:0.00038%,25:0.00019%,24:0.00019%,18:0.00019%,12:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99674%,0:0.00326%]
[INFO] ** i/f_name:[2:99.99654%,3:0.00346%]
[INFO] ** modbus_function_code:[0.02961:99.99558%,-33.760870000000004:0.00442%]
[INFO] ** modbus_function_description:[7:49.99846%,11:49.99712%,0:0.00442%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99558%,1:0.00346%,2:0.00096%]
[INFO] ** proxy_src_ip:[18:37.94622%,20:26.16167%,13:18.28354%,6:17.60415%,17:0.00346%,14:0.00058%,16:0.00019%,11:0.00019%]
[INFO] ** s_port:[1.45442:26.16129%,-0.32151:20.73036%,-1.27613:18.28296%,-0.23351:17.60376%,-0.33484:17.21587%,-71.33197:0.00346%,-0.24151:0.00019%,-1.2708:0.00019%,-64.19493:0.00019%,-1.02014:0.00019%,13.431270000000001:0.00019%,4.90362:0.00019%,-71.14798:0.00019%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-1.27347:0.00019%,-68.36943000000001:0.00019%]
[INFO] ** scada_tag:[3:26.1611%,1:20.73017%,5:18.28277%,4:17.60338%,2:17.21567%,0:0.00691%]
[INFO] ** service:[0.0048200000000000005:99.99558%,-211.73542999999998:0.00346%,-186.44547:0.00019%,-211.08346:0.00019%,-186.43601999999998:0.00019%,-201.23771000000002:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:37.94622%,9:26.16167%,7:18.28354%,1:17.60415%,14:0.00346%,2:0.00058%,15:0.00019%,10:0.00019%]
[INFO] ** type:[0:99.99904%,1:0.00096%]
[INFO] ** unixtime:1426 (0.27383%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0014 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0012 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-5-6-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0010 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.3818e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-5-6-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.8363e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.6293e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-5-6-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.8238e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.0852e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-5-6-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2854 - tp: 74314.0000 - fp: 5686.0000 - tn: 314314.0000 - fn: 5686.0000 - accuracy: 0.9716 - precision: 0.9289 - recall: 0.9289 - auc: 0.9819 - val_loss: 0.0538 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-5-6-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 7-7/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99539%,30:0.00134%,22:0.00096%,17:0.00077%,26:0.00058%,31:0.00038%,28:0.00019%,27:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:81.9636%,Single Stage Single Point:18.0364%]
[INFO] ** dst:[21:43.36083%,10:20.74495%,8:18.25186%,9:17.63602%,6:0.00154%,22:0.00134%,15:0.00134%,16:0.00077%,24:0.00038%,18:0.00038%,17:0.00038%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99866%,0:0.00134%]
[INFO] ** i/f_name:[2:99.99866%,3:0.00134%]
[INFO] ** modbus_function_code:[0.02961:99.99539%,-33.760870000000004:0.00461%]
[INFO] ** modbus_function_description:[7:49.99827%,11:49.99712%,0:0.00461%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99654%,2:0.00211%,1:0.00134%]
[INFO] ** proxy_src_ip:[18:37.9685%,20:26.13805%,13:18.25224%,6:17.63621%,17:0.00134%,11:0.00077%,1:0.00077%,21:0.00058%,16:0.00038%,14:0.00038%,7:0.00038%,10:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.13709%,-0.32151:20.74495%,-1.27613:18.25166%,-0.23351:17.63583%,-0.33484:17.22355%,-71.33197:0.00134%,-71.14931:0.00096%,-71.14798:0.00058%,1.45709:0.00058%,-1.02014:0.00038%,-1.27347:0.00038%,-0.24151:0.00038%,-58.035180000000004:0.00019%,-1.2708:0.00019%,-5.1466400000000005:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-5.08665:0.00019%,14.253910000000001:0.00019%,-68.79874000000001:0.00019%,6.1115699999999995:0.00019%,2.05573:0.00019%,-43.76509:0.00019%,-58.032509999999995:0.00019%]
[INFO] ** scada_tag:[3:26.13671%,1:20.74495%,5:18.25166%,4:17.63564%,2:17.22355%,0:0.00749%]
[INFO] ** service:[0.0048200000000000005:99.99539%,-211.73542999999998:0.00134%,-211.08818:0.00096%,-205.44247:0.00077%,-211.08346:0.00058%,-186.43601999999998:0.00038%,-211.09762999999998:0.00019%,-185.9872:0.00019%,-202.75898:0.00019%]
[INFO] ** src:[22:37.9685%,9:26.13805%,7:18.25224%,1:17.63621%,14:0.00134%,10:0.00077%,3:0.00077%,4:0.00058%,21:0.00038%,15:0.00038%,2:0.00038%,11:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1423 (0.27326%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0128 - tp: 79954.0000 - fp: 46.0000 - tn: 319954.0000 - fn: 46.0000 - accuracy: 0.9998 - precision: 0.9994 - recall: 0.9994 - auc: 1.0000 - val_loss: 0.0031 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-6-7-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0016 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.5179e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-6-7-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2125 - tp: 73388.0000 - fp: 6612.0000 - tn: 313388.0000 - fn: 6612.0000 - accuracy: 0.9669 - precision: 0.9173 - recall: 0.9173 - auc: 0.9911 - val_loss: 0.4846 - val_tp: 12827.0000 - val_fp: 7173.0000 - val_tn: 72827.0000 - val_fn: 7173.0000 - val_accuracy: 0.8565 - val_precision: 0.6413 - val_recall: 0.6413 - val_auc: 0.9678
[INFO] saving weights to checkpoints/lstm-epoch-10-files-6-7-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0184 - tp: 79093.0000 - fp: 907.0000 - tn: 319093.0000 - fn: 907.0000 - accuracy: 0.9955 - precision: 0.9887 - recall: 0.9887 - auc: 0.9999 - val_loss: 6.6645e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-6-7-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.0024e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7850e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-6-7-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 8-8/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99693%,30:0.00115%,0:0.00058%,24:0.00019%,23:0.00019%,22:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:94.51223%,Single Stage Single Point:5.48777%]
[INFO] ** dst:[21:43.43361%,10:20.81139%,8:18.17255%,9:17.57861%,22:0.00134%,15:0.00115%,25:0.00058%,19:0.00038%,26:0.00019%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99923%,0:0.00077%]
[INFO] ** i/f_name:[2:99.99885%,3:0.00115%]
[INFO] ** modbus_function_code:[0.02961:99.99693%,-33.760870000000004:0.00288%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99942%,11:49.9975%,0:0.00288%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99962%,2:0.00038%]
[INFO] ** proto:[0:99.99808%,1:0.00115%,2:0.00077%]
[INFO] ** proxy_src_ip:[18:38.10081%,20:26.14477%,13:18.17178%,6:17.57899%,17:0.00115%,10:0.00115%,16:0.00058%,14:0.00038%,11:0.00019%,5:0.00019%]
[INFO] ** s_port:[1.45442:26.1442%,-0.32151:20.81139%,-1.27613:18.17159%,-0.23351:17.57841%,-0.33484:17.28941%,-71.33197:0.00115%,-15.039579999999999:0.00077%,-1.02014:0.00058%,-64.19493:0.00058%,1.45709:0.00038%,-0.24151:0.00038%,4.66896:0.00038%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-71.14931:0.00019%]
[INFO] ** scada_tag:[3:26.14381%,1:20.8112%,5:18.17159%,4:17.57822%,2:17.28922%,0:0.00595%]
[INFO] ** service:[0.0048200000000000005:99.9977%,-211.73542999999998:0.00115%,-186.44547:0.00058%,-211.07873999999998:0.00038%,-211.08818:0.00019%]
[INFO] ** src:[22:38.10081%,9:26.14477%,7:18.17178%,1:17.57899%,11:0.00115%,14:0.00077%,15:0.00058%,21:0.00038%,2:0.00038%,16:0.00019%,10:0.00019%]
[INFO] ** type:[0:99.99942%,1:0.00038%,2:0.00019%]
[INFO] ** unixtime:1427 (0.27402%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.8244e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6247e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-7-8-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.2364e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9840e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-7-8-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.6534e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4763e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-7-8-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1193 - tp: 76928.0000 - fp: 3072.0000 - tn: 316928.0000 - fn: 3072.0000 - accuracy: 0.9846 - precision: 0.9616 - recall: 0.9616 - auc: 0.9962 - val_loss: 0.2773 - val_tp: 16374.0000 - val_fp: 3626.0000 - val_tn: 76374.0000 - val_fn: 3626.0000 - val_accuracy: 0.9275 - val_precision: 0.8187 - val_recall: 0.8187 - val_auc: 0.9918
[INFO] saving weights to checkpoints/lstm-epoch-10-files-7-8-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.0185 - tp: 79529.0000 - fp: 471.0000 - tn: 319529.0000 - fn: 471.0000 - accuracy: 0.9976 - precision: 0.9941 - recall: 0.9941 - auc: 1.0000 - val_loss: 0.0023 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-7-8-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 9-9/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99827%,30:0.00096%,31:0.00038%,26:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:95.53708%,Single Stage Single Point:4.46292%]
[INFO] ** dst:[21:43.36064%,10:20.77491%,8:18.29084%,9:17.57093%,15:0.00096%,22:0.00077%,18:0.00038%,25:0.00019%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99904%,0:0.00096%]
[INFO] ** i/f_name:[2:99.99904%,3:0.00096%]
[INFO] ** modbus_function_code:[0.02961:99.99827%,-33.760870000000004:0.00173%]
[INFO] ** modbus_function_description:[7:49.99981%,11:49.99846%,0:0.00173%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99981%,2:0.00019%]
[INFO] ** proto:[0:99.99827%,1:0.00096%,2:0.00077%]
[INFO] ** proxy_src_ip:[18:38.00825%,20:26.12788%,13:18.29103%,6:17.57112%,17:0.00096%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.12711%,-0.32151:20.77491%,-1.27613:18.29065%,-0.23351:17.57073%,-0.33484:17.23334%,-71.33197:0.00096%,1.45709:0.00038%,-0.24151:0.00038%,-0.08551:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.12672%,1:20.77472%,5:18.29065%,4:17.57054%,2:17.23334%,0:0.00403%]
[INFO] ** service:[0.0048200000000000005:99.99827%,-211.73542999999998:0.00096%,-186.43601999999998:0.00038%,-186.44547:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.00825%,9:26.12788%,7:18.29103%,1:17.57112%,14:0.00077%,21:0.00019%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1425 (0.27364%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 0.0012 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.5210e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-8-9-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 0.1402 - tp: 74871.0000 - fp: 5129.0000 - tn: 314871.0000 - fn: 5129.0000 - accuracy: 0.9744 - precision: 0.9359 - recall: 0.9359 - auc: 0.9954 - val_loss: 0.0829 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-8-9-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 0.0035 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2576e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-8-9-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.3363e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5838e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-8-9-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.3118e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1285e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-8-9-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 10-10/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99654%,30:0.00192%,24:0.00019%,23:0.00019%,22:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:94.13374%,Single Stage Single Point:5.86626%]
[INFO] ** dst:[21:43.41153%,10:20.81178%,8:18.22478%,9:17.54827%,15:0.00192%,22:0.00058%,24:0.00038%,19:0.00038%,26:0.00019%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99827%,0:0.00173%]
[INFO] ** i/f_name:[2:99.99808%,3:0.00192%]
[INFO] ** modbus_function_code:[0.02961:99.99654%,-33.760870000000004:0.00326%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99904%,11:49.9975%,0:0.00326%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99923%,1:0.00077%]
[INFO] ** proto:[0:99.9977%,1:0.00192%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:38.09389%,20:26.1298%,13:18.22497%,6:17.54769%,17:0.00192%,10:0.00096%,14:0.00038%,16:0.00019%,5:0.00019%]
[INFO] ** s_port:[1.45442:26.12922%,-0.32151:20.81178%,-1.27613:18.2244%,-0.23351:17.54731%,-0.33484:17.28212%,-71.33197:0.00192%,-10.51843:0.00077%,5.71692:0.00038%,-1.27347:0.00038%,1.46509:0.00019%,1.47576:0.00019%,-0.24950999999999998:0.00019%,1.45709:0.00019%,-0.24151:0.00019%,-71.14931:0.00019%,-1.02014:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.12884%,1:20.81159%,5:18.2244%,4:17.54711%,2:17.28192%,0:0.00614%]
[INFO] ** service:[0.0048200000000000005:99.99731%,-211.73542999999998:0.00192%,-211.07873999999998:0.00038%,-186.44547:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.09389%,9:26.1298%,7:18.22497%,1:17.54769%,14:0.00192%,11:0.00096%,2:0.00038%,16:0.00019%,15:0.00019%]
[INFO] ** type:[0:99.99846%,1:0.00134%,2:0.00019%]
[INFO] ** unixtime:1423 (0.27326%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 8.2501e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.8869e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-9-10-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.5747e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.6518e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-9-10-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1510 - tp: 78019.0000 - fp: 1981.0000 - tn: 318019.0000 - fn: 1981.0000 - accuracy: 0.9901 - precision: 0.9752 - recall: 0.9752 - auc: 0.9901 - val_loss: 1.3097 - val_tp: 14927.0000 - val_fp: 5073.0000 - val_tn: 74927.0000 - val_fn: 5073.0000 - val_accuracy: 0.8985 - val_precision: 0.7463 - val_recall: 0.7463 - val_auc: 0.9270
[INFO] saving weights to checkpoints/lstm-epoch-10-files-9-10-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0742 - tp: 78016.0000 - fp: 1984.0000 - tn: 318016.0000 - fn: 1984.0000 - accuracy: 0.9901 - precision: 0.9752 - recall: 0.9752 - auc: 0.9992 - val_loss: 2.2345e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-9-10-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6802e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3183e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-9-10-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 11-11/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99885%,31:0.00038%,30:0.00038%,26:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** dst:[21:43.38407%,10:20.87822%,8:18.19982%,9:17.5354%,22:0.00134%,18:0.00038%,15:0.00038%,25:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99885%,-33.760870000000004:0.00115%]
[INFO] ** modbus_function_description:[7:50.00058%,11:49.99827%,0:0.00115%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99885%,2:0.00077%,1:0.00038%]
[INFO] ** proxy_src_ip:[18:38.14689%,20:26.11578%,13:18.19982%,6:17.53578%,16:0.00058%,17:0.00038%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.1152%,-0.32151:20.87822%,-1.27613:18.19962%,-0.23351:17.53521%,-0.33484:17.26867%,-0.24151:0.00058%,-1.02014:0.00058%,-0.08551:0.00038%,-71.33197:0.00038%,-71.14798:0.00019%,1.45709:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-64.19493:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.11482%,1:20.87822%,5:18.19943%,4:17.53482%,2:17.26848%,0:0.00422%]
[INFO] ** service:[0.0048200000000000005:99.99885%,-211.73542999999998:0.00038%,-186.43601999999998:0.00038%,-186.44547:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.14689%,9:26.11578%,7:18.19982%,1:17.53578%,15:0.00058%,14:0.00038%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1423 (0.27326%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.5407e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.7914e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-10-11-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.1884e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.1865e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-10-11-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.1147e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7164e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-10-11-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.7711e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.3162e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-10-11-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.7530e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4773e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-10-11-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 12-12/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.9977%,30:0.00211%,9:0.00019%]
[INFO] ** classification:[normal:93.05032%,Single Stage Single Point:6.94968%]
[INFO] ** dst:[21:43.39367%,10:20.87284%,8:18.19156%,9:17.53866%,15:0.00211%,22:0.00058%,24:0.00038%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99827%,0:0.00173%]
[INFO] ** i/f_name:[2:99.99789%,3:0.00211%]
[INFO] ** modbus_function_code:[0.02961:99.9977%,-33.760870000000004:0.0023%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99808%,0:0.0023%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99827%,2:0.00173%]
[INFO] ** proto:[0:99.99789%,1:0.00211%]
[INFO] ** proxy_src_ip:[18:38.14094%,20:26.12595%,13:18.19175%,6:17.53886%,17:0.00211%,16:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:26.12538%,-0.32151:20.87284%,-1.27613:18.19118%,-0.23351:17.53847%,-0.33484:17.2681%,-71.33197:0.00211%,-1.27347:0.00038%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:26.12499%,1:20.87284%,5:18.19118%,4:17.53809%,2:17.2681%,0:0.0048%]
[INFO] ** service:[0.0048200000000000005:99.9977%,-211.73542999999998:0.00211%,-183.8612:0.00019%]
[INFO] ** src:[22:38.14094%,9:26.12595%,7:18.19175%,1:17.53886%,21:0.00173%,14:0.00038%,15:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1423 (0.27326%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.4185e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6729e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-11-12-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.5018e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3447e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-11-12-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2874 - tp: 74309.0000 - fp: 5691.0000 - tn: 314309.0000 - fn: 5691.0000 - accuracy: 0.9715 - precision: 0.9289 - recall: 0.9289 - auc: 0.9870 - val_loss: 0.0618 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-11-12-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.1702 - tp: 74889.0000 - fp: 5111.0000 - tn: 314889.0000 - fn: 5111.0000 - accuracy: 0.9744 - precision: 0.9361 - recall: 0.9361 - auc: 0.9948 - val_loss: 0.0615 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-11-12-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0087 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.0020 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-11-12-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 13-13/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99635%,31:0.00077%,26:0.00058%,0:0.00058%,30:0.00038%,22:0.00038%,27:0.00019%,24:0.00019%,16:0.00019%,15:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:85.30738%,Single Stage Single Point:14.69262%]
[INFO] ** dst:[21:43.35392%,10:20.79968%,8:18.2797%,9:17.56248%,22:0.00115%,6:0.00096%,18:0.00077%,25:0.00058%,15:0.00038%,24:0.00019%,7:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99635%,-33.760870000000004:0.00346%,0.9188299999999999:0.00019%]
[INFO] ** modbus_function_description:[7:49.99904%,11:49.99731%,0:0.00346%,15:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99712%,2:0.0025%,1:0.00038%]
[INFO] ** proxy_src_ip:[18:38.05184%,20:26.10214%,13:18.27989%,6:17.5619%,10:0.00115%,11:0.00096%,16:0.00058%,17:0.00038%,7:0.00038%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.10157%,-0.32151:20.79968%,-1.27613:18.27951%,-0.23351:17.56152%,-0.33484:17.25216%,-9.78512:0.00077%,-71.14798:0.00058%,-64.19493:0.00058%,-1.02014:0.00058%,-0.08551:0.00038%,-71.14931:0.00038%,-0.24151:0.00038%,-71.33197:0.00038%,-1.27347:0.00019%,1.46509:0.00019%,-68.79874000000001:0.00019%,14.540560000000001:0.00019%,1.45709:0.00019%,-1.2708:0.00019%,6.1115699999999995:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:26.10118%,1:20.79949%,5:18.27951%,4:17.56152%,2:17.25197%,0:0.00634%]
[INFO] ** service:[0.0048200000000000005:99.99712%,-186.43601999999998:0.00077%,-186.44547:0.00058%,-211.08346:0.00058%,-211.73542999999998:0.00038%,-211.08818:0.00038%,-202.75898:0.00019%]
[INFO] ** src:[22:38.05184%,9:26.10214%,7:18.27989%,1:17.5619%,11:0.00115%,10:0.00096%,15:0.00058%,21:0.00038%,14:0.00038%,17:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,2:0.00019%]
[INFO] ** unixtime:1423 (0.27326%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0012 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.4135e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-12-13-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.4903e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.4741e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-12-13-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.9492e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5212e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-12-13-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 0.2278 - tp: 75439.0000 - fp: 4561.0000 - tn: 315439.0000 - fn: 4561.0000 - accuracy: 0.9772 - precision: 0.9430 - recall: 0.9430 - auc: 0.9866 - val_loss: 0.0348 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-12-13-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 0.0039 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.4341e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-12-13-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 14-14/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99962%,30:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:95.22542%,Single Stage Single Point:4.77458%]
[INFO] ** dst:[21:43.34566%,10:20.80851%,8:18.26875%,9:17.57553%,22:0.00077%,24:0.00038%,15:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99962%,-33.760870000000004:0.00038%]
[INFO] ** modbus_function_description:[7:50.00058%,11:49.99904%,0:0.00038%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99981%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.04627%,20:26.10848%,13:18.26895%,6:17.57573%,17:0.00019%,16:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:26.10771%,-0.32151:20.80851%,-1.27613:18.26837%,-0.23351:17.57534%,-0.33484:17.23776%,-1.27347:0.00038%,1.45709:0.00038%,-0.24950999999999998:0.00019%,1.46509:0.00019%,1.47576:0.00019%,14.4699:0.00019%,-0.24151:0.00019%,-1.02014:0.00019%,-1.2708:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:26.10733%,1:20.80851%,5:18.26818%,4:17.57496%,2:17.23757%,0:0.00346%]
[INFO] ** service:[0.0048200000000000005:99.99962%,-183.8612:0.00019%,-211.73542999999998:0.00019%]
[INFO] ** src:[22:38.04627%,9:26.10848%,7:18.26895%,1:17.57573%,15:0.00019%,14:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1423 (0.27326%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 8s - loss: 0.1441 - tp: 76169.0000 - fp: 3831.0000 - tn: 316169.0000 - fn: 3831.0000 - accuracy: 0.9808 - precision: 0.9521 - recall: 0.9521 - auc: 0.9954 - val_loss: 0.5475 - val_tp: 12817.0000 - val_fp: 7183.0000 - val_tn: 72817.0000 - val_fn: 7183.0000 - val_accuracy: 0.8563 - val_precision: 0.6409 - val_recall: 0.6409 - val_auc: 0.9677
[INFO] saving weights to checkpoints/lstm-epoch-10-files-13-14-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 7s - loss: 0.0104 - tp: 79487.0000 - fp: 513.0000 - tn: 319487.0000 - fn: 513.0000 - accuracy: 0.9974 - precision: 0.9936 - recall: 0.9936 - auc: 1.0000 - val_loss: 4.3887e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-13-14-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.3030e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5913e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-13-14-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.1441e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8273e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-13-14-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.5474e-04 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3406e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-13-14-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 15-15/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (520758, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (520758, 17)

[INFO] analyzing data
[INFO] 520758 rows
[INFO] ** appi_name:[21:99.99616%,30:0.00307%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:89.39431%,Single Stage Multi Point:10.60493%,Single Stage Single Point:0.00077%]
[INFO] ** dst:[21:43.29746%,10:20.77395%,8:18.31407%,9:17.60914%,15:0.00307%,22:0.00154%,25:0.00019%,24:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99693%,0:0.00307%]
[INFO] ** i/f_name:[2:99.99693%,3:0.00307%]
[INFO] ** modbus_function_code:[0.02961:99.99616%,-33.760870000000004:0.00384%]
[INFO] ** modbus_function_description:[7:49.99904%,11:49.99712%,0:0.00384%]
[INFO] ** modbus_transaction_id:65536 (12.58473%)
[INFO] ** orig:[0:99.99712%,2:0.00288%]
[INFO] ** proto:[0:99.99654%,1:0.00307%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:38.00249%,20:26.0695%,13:18.31388%,6:17.60972%,17:0.00307%,16:0.00058%,7:0.00038%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:26.06873%,-0.32151:20.77376%,-1.27613:18.31369%,-0.23351:17.60895%,-0.33484:17.22873%,-71.33197:0.00307%,-1.02014:0.00058%,-0.24151:0.00058%,1.45709:0.00038%,-64.19493:0.00019%,-61.95768:0.00019%,-71.14798:0.00019%,1.47576:0.00019%,-1.27347:0.00019%,10.192739999999999:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%]
[INFO] ** scada_tag:[3:26.06835%,1:20.77356%,5:18.31369%,4:17.60856%,2:17.22854%,0:0.0073%]
[INFO] ** service:[0.0048200000000000005:99.99635%,-211.73542999999998:0.00307%,-186.44547:0.00019%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.00249%,9:26.0695%,7:18.31388%,1:17.60972%,21:0.00326%,15:0.00058%,16:0.00019%,14:0.00019%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1431 (0.27479%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.0538e-04 - tp: 79987.0000 - fp: 13.0000 - tn: 319987.0000 - fn: 13.0000 - accuracy: 0.9999 - precision: 0.9998 - recall: 0.9998 - auc: 1.0000 - val_loss: 9.0286e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-14-15-batch-0-100000
[INFO] processing batch 100000-200000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.2362e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.4347e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-14-15-batch-100000-200000
[INFO] processing batch 200000-300000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.3508e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.8474e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-14-15-batch-200000-300000
[INFO] processing batch 300000-400000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6369e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.1563e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-14-15-batch-300000-400000
[INFO] processing batch 400000-500000/520758
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.2774 - tp: 43880.0000 - fp: 36120.0000 - tn: 283880.0000 - fn: 36120.0000 - accuracy: 0.8194 - precision: 0.5485 - recall: 0.5485 - auc: 0.7178 - val_loss: 7.5570 - val_tp: 10623.0000 - val_fp: 9377.0000 - val_tn: 70623.0000 - val_fn: 9377.0000 - val_accuracy: 0.8125 - val_precision: 0.5311 - val_recall: 0.5311 - val_auc: 0.7070
[INFO] saving weights to checkpoints/lstm-epoch-10-files-14-15-batch-400000-500000
[INFO] processing batch 500000-600000/520758
[33m[INFO] loading file 16-16/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (460448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (460448, 17)

[INFO] analyzing data
[INFO] 460448 rows
[INFO] ** appi_name:[21:99.99848%,30:0.0013%,33:0.00022%]
[INFO] ** classification:[normal:83.00829%,Single Stage Multi Point:16.99171%]
[INFO] ** dst:[21:43.3569%,10:20.7967%,8:18.25266%,9:17.59091%,22:0.0013%,15:0.0013%,24:0.00022%]
[INFO] ** i/f_dir:[1:99.9987%,0:0.0013%]
[INFO] ** i/f_name:[2:99.9987%,3:0.0013%]
[INFO] ** modbus_function_code:[0.02961:99.99848%,-33.760870000000004:0.00152%]
[INFO] ** modbus_function_description:[7:50.00065%,11:49.99783%,0:0.00152%]
[INFO] ** modbus_transaction_id:65536 (14.23309%)
[INFO] ** orig:[0:99.9987%,2:0.0013%]
[INFO] ** proto:[0:99.9987%,1:0.0013%]
[INFO] ** proxy_src_ip:[18:38.04729%,20:26.10653%,13:18.25309%,6:17.59113%,17:0.0013%,16:0.00043%,21:0.00022%]
[INFO] ** s_port:[1.45442:26.10588%,-0.32151:20.79649%,-1.27613:18.25266%,-0.23351:17.59069%,-0.33484:17.25081%,-71.33197:0.0013%,1.45709:0.00043%,-0.24151:0.00043%,-1.02014:0.00043%,-1.27347:0.00022%,1.47576:0.00022%,-49.275529999999996:0.00022%,-1.2708:0.00022%]
[INFO] ** scada_tag:[3:26.10545%,1:20.79649%,5:18.25244%,4:17.59026%,2:17.25059%,0:0.00478%]
[INFO] ** service:[0.0048200000000000005:99.9987%,-211.73542999999998:0.0013%]
[INFO] ** src:[22:38.04729%,9:26.10653%,7:18.25309%,1:17.59113%,21:0.0013%,15:0.00043%,4:0.00022%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1259 (0.27343%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/460448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5562 - tp: 42496.0000 - fp: 37504.0000 - tn: 282496.0000 - fn: 37504.0000 - accuracy: 0.8125 - precision: 0.5312 - recall: 0.5312 - auc: 0.7070 - val_loss: 7.5554 - val_tp: 10625.0000 - val_fp: 9375.0000 - val_tn: 70625.0000 - val_fn: 9375.0000 - val_accuracy: 0.8125 - val_precision: 0.5312 - val_recall: 0.5312 - val_auc: 0.7070
[INFO] saving weights to checkpoints/lstm-epoch-10-files-15-16-batch-0-100000
[INFO] processing batch 100000-200000/460448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.3181 - tp: 48641.0000 - fp: 31359.0000 - tn: 288641.0000 - fn: 31359.0000 - accuracy: 0.8432 - precision: 0.6080 - recall: 0.6080 - auc: 0.7550 - val_loss: 4.2112e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-15-16-batch-100000-200000
[INFO] processing batch 200000-300000/460448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.0184e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8306e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-15-16-batch-200000-300000
[INFO] processing batch 300000-400000/460448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.5961e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3615e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-15-16-batch-300000-400000
[INFO] processing batch 400000-500000/460448
[33m[INFO] loading file 17-17/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (560448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (560448, 17)

[INFO] analyzing data
[INFO] 560448 rows
[INFO] ** appi_name:[21:99.99715%,7:0.00054%,26:0.00036%,0:0.00036%,33:0.00018%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:94.49548%,Multi Stage Multi Point:5.50452%]
[INFO] ** dst:[21:43.34943%,10:20.84422%,8:18.20544%,9:17.59806%,22:0.00071%,6:0.00054%,25:0.00036%,16:0.00036%,2:0.00036%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99715%,-33.760870000000004:0.00268%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99964%,11:49.9975%,0:0.00268%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.6935%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99875%,2:0.00125%]
[INFO] ** proxy_src_ip:[18:38.07811%,20:26.11607%,13:18.2049%,6:17.59789%,10:0.00107%,11:0.00089%,1:0.00036%,21:0.00018%,16:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.11518%,-0.32151:20.84404%,-1.27613:18.20454%,-0.23351:17.59771%,-0.33484:17.23407%,6.0369:0.00071%,1.47576:0.00036%,-71.14798:0.00036%,1.45709:0.00036%,-64.19493:0.00036%,1.46509:0.00018%,-68.79874000000001:0.00018%,-49.275529999999996:0.00018%,-1.27347:0.00018%,-0.24151:0.00018%,-1.02014:0.00018%,-1.2708:0.00018%,6.15557:0.00018%,6.06224:0.00018%,8.55414:0.00018%,-3.3787199999999995:0.00018%,-4.3880099999999995:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.115%,1:20.84386%,5:18.20437%,4:17.59717%,2:17.23407%,0:0.00553%]
[INFO] ** service:[0.0048200000000000005:99.99804%,-211.09762999999998:0.00054%,-211.08346:0.00036%,-186.44547:0.00036%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.07811%,9:26.11607%,7:18.2049%,1:17.59789%,11:0.00107%,10:0.00089%,3:0.00036%,21:0.00018%,15:0.00018%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1531 (0.27317%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7005e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9815e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-16-17-batch-0-100000
[INFO] processing batch 100000-200000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.8672e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.7459e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-16-17-batch-100000-200000
[INFO] processing batch 200000-300000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6074e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4666e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-16-17-batch-200000-300000
[INFO] processing batch 300000-400000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5324 - tp: 72394.0000 - fp: 7606.0000 - tn: 312394.0000 - fn: 7606.0000 - accuracy: 0.9620 - precision: 0.9049 - recall: 0.9049 - auc: 0.9406 - val_loss: 2.9335 - val_tp: 16360.0000 - val_fp: 3640.0000 - val_tn: 76360.0000 - val_fn: 3640.0000 - val_accuracy: 0.9272 - val_precision: 0.8180 - val_recall: 0.8180 - val_auc: 0.8863
[INFO] saving weights to checkpoints/lstm-epoch-10-files-16-17-batch-300000-400000
[INFO] processing batch 400000-500000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9212 - tp: 65501.0000 - fp: 14499.0000 - tn: 305501.0000 - fn: 14499.0000 - accuracy: 0.9275 - precision: 0.8188 - recall: 0.8188 - auc: 0.8867 - val_loss: 2.9166 - val_tp: 16381.0000 - val_fp: 3619.0000 - val_tn: 76381.0000 - val_fn: 3619.0000 - val_accuracy: 0.9276 - val_precision: 0.8191 - val_recall: 0.8191 - val_auc: 0.8869
[INFO] saving weights to checkpoints/lstm-epoch-10-files-16-17-batch-400000-500000
[INFO] processing batch 500000-600000/560448
[33m[INFO] loading file 18-18/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (560448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (560448, 17)

[INFO] analyzing data
[INFO] 560448 rows
[INFO] ** appi_name:[21:99.99822%,30:0.00054%,7:0.00054%,31:0.00018%,27:0.00018%,22:0.00018%,8:0.00018%]
[INFO] ** classification:[normal:82.42763%,Multi Stage Multi Point:17.57237%]
[INFO] ** dst:[21:43.34354%,10:20.83387%,8:18.25772%,9:17.56202%,22:0.00071%,15:0.00054%,24:0.00036%,16:0.00036%,2:0.00036%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99946%,0:0.00054%]
[INFO] ** i/f_name:[2:99.99946%,3:0.00054%]
[INFO] ** modbus_function_code:[0.02961:99.99822%,-33.760870000000004:0.00178%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99804%,0:0.00178%]
[INFO] ** modbus_transaction_id:65536 (11.6935%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99893%,2:0.00054%,1:0.00054%]
[INFO] ** proxy_src_ip:[18:38.07954%,20:26.09841%,13:18.25807%,6:17.5622%,17:0.00054%,11:0.00054%,1:0.00036%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:26.09769%,-0.32151:20.83387%,-1.27613:18.25754%,-0.23351:17.56184%,-0.33484:17.24567%,-71.33197:0.00054%,-1.27347:0.00036%,1.45709:0.00036%,-0.24151:0.00036%,1.47576:0.00018%,1.46509:0.00018%,3.6236699999999997:0.00018%,-1.2708:0.00018%,-2.48275:0.00018%,6.06224:0.00018%,-3.3787199999999995:0.00018%,8.10082:0.00018%,6.45955:0.00018%,-71.14931:0.00018%]
[INFO] ** scada_tag:[3:26.09734%,1:20.83369%,5:18.25736%,4:17.56166%,2:17.24549%,0:0.00446%]
[INFO] ** service:[0.0048200000000000005:99.99822%,-211.09762999999998:0.00054%,-211.73542999999998:0.00054%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.07954%,9:26.09841%,7:18.25807%,1:17.5622%,14:0.00054%,10:0.00054%,3:0.00036%,21:0.00018%,2:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1532 (0.27335%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2994 - tp: 78514.0000 - fp: 1486.0000 - tn: 318514.0000 - fn: 1486.0000 - accuracy: 0.9926 - precision: 0.9814 - recall: 0.9814 - auc: 0.9884 - val_loss: 6.1088 - val_tp: 12420.0000 - val_fp: 7580.0000 - val_tn: 72420.0000 - val_fn: 7580.0000 - val_accuracy: 0.8484 - val_precision: 0.6210 - val_recall: 0.6210 - val_auc: 0.7631
[INFO] saving weights to checkpoints/lstm-epoch-10-files-17-18-batch-0-100000
[INFO] processing batch 100000-200000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.1239 - tp: 49605.0000 - fp: 30395.0000 - tn: 289605.0000 - fn: 30395.0000 - accuracy: 0.8480 - precision: 0.6201 - recall: 0.6201 - auc: 0.7625 - val_loss: 6.0782 - val_tp: 12458.0000 - val_fp: 7542.0000 - val_tn: 72458.0000 - val_fn: 7542.0000 - val_accuracy: 0.8492 - val_precision: 0.6229 - val_recall: 0.6229 - val_auc: 0.7643
[INFO] saving weights to checkpoints/lstm-epoch-10-files-17-18-batch-100000-200000
[INFO] processing batch 200000-300000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.1444 - tp: 49503.0000 - fp: 30497.0000 - tn: 289503.0000 - fn: 30497.0000 - accuracy: 0.8475 - precision: 0.6188 - recall: 0.6188 - auc: 0.7617 - val_loss: 6.1281 - val_tp: 12396.0000 - val_fp: 7604.0000 - val_tn: 72396.0000 - val_fn: 7604.0000 - val_accuracy: 0.8479 - val_precision: 0.6198 - val_recall: 0.6198 - val_auc: 0.7624
[INFO] saving weights to checkpoints/lstm-epoch-10-files-17-18-batch-200000-300000
[INFO] processing batch 300000-400000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6958 - tp: 66620.0000 - fp: 13380.0000 - tn: 306620.0000 - fn: 13380.0000 - accuracy: 0.9331 - precision: 0.8328 - recall: 0.8328 - auc: 0.8955 - val_loss: 1.4553e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-17-18-batch-300000-400000
[INFO] processing batch 400000-500000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3827e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3253e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-17-18-batch-400000-500000
[INFO] processing batch 500000-600000/560448
[33m[INFO] loading file 19-19/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (560448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (560448, 17)

[INFO] analyzing data
[INFO] 560448 rows
[INFO] ** appi_name:[21:99.99804%,26:0.00036%,0:0.00036%,31:0.00018%,27:0.00018%,24:0.00018%,22:0.00018%,16:0.00018%,15:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:87.23164%,Single Stage Multi Point:12.76836%]
[INFO] ** dst:[21:43.38815%,10:20.82566%,8:18.20883%,9:17.57469%,22:0.00125%,6:0.00054%,25:0.00036%,24:0.00018%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99804%,-33.760870000000004:0.00178%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:50.0%,11:49.99804%,0:0.00178%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.6935%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99875%,2:0.00125%]
[INFO] ** proxy_src_ip:[18:38.11415%,20:26.09983%,13:18.20883%,6:17.57469%,10:0.00107%,11:0.00089%,16:0.00054%]
[INFO] ** s_port:[1.45442:26.09876%,-0.32151:20.82566%,-1.27613:18.20847%,-0.23351:17.57451%,-0.33484:17.28849%,-5.20264:0.00071%,1.45709:0.00054%,-1.02014:0.00054%,-64.19493:0.00036%,-71.14798:0.00036%,1.46509:0.00036%,-1.27347:0.00018%,-0.24151:0.00018%,1.47576:0.00018%,-1.2708:0.00018%,-71.14931:0.00018%,-68.79874000000001:0.00018%,0.75578:0.00018%]
[INFO] ** scada_tag:[3:26.09841%,1:20.82548%,5:18.20829%,4:17.57433%,2:17.28831%,0:0.00517%]
[INFO] ** service:[0.0048200000000000005:99.99875%,-211.08346:0.00036%,-186.44547:0.00036%,-202.75898:0.00018%,-186.43601999999998:0.00018%,-211.08818:0.00018%]
[INFO] ** src:[22:38.11415%,9:26.09983%,7:18.20883%,1:17.57469%,11:0.00107%,10:0.00089%,15:0.00054%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1533 (0.27353%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.2835e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1901e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-18-19-batch-0-100000
[INFO] processing batch 100000-200000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.1286e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0568e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-18-19-batch-100000-200000
[INFO] processing batch 200000-300000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0096e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.7732e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-18-19-batch-200000-300000
[INFO] processing batch 300000-400000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.1018e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.2404 - val_tp: 9775.0000 - val_fp: 10225.0000 - val_tn: 69775.0000 - val_fn: 10225.0000 - val_accuracy: 0.7955 - val_precision: 0.4888 - val_recall: 0.4888 - val_auc: 0.6805
[INFO] saving weights to checkpoints/lstm-epoch-10-files-18-19-batch-300000-400000
[INFO] processing batch 400000-500000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.8268 - tp: 31226.0000 - fp: 48774.0000 - tn: 271226.0000 - fn: 48774.0000 - accuracy: 0.7561 - precision: 0.3903 - recall: 0.3903 - auc: 0.6190 - val_loss: 9.8385 - val_tp: 7792.0000 - val_fp: 12208.0000 - val_tn: 67792.0000 - val_fn: 12208.0000 - val_accuracy: 0.7558 - val_precision: 0.3896 - val_recall: 0.3896 - val_auc: 0.6185
[INFO] saving weights to checkpoints/lstm-epoch-10-files-18-19-batch-400000-500000
[INFO] processing batch 500000-600000/560448
[33m[INFO] loading file 20-20/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (560448, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (560448, 17)

[INFO] analyzing data
[INFO] 560448 rows
[INFO] ** appi_name:[21:99.99661%,30:0.00285%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:92.62519%,Single Stage Multi Point:7.37481%]
[INFO] ** dst:[21:43.42544%,10:20.83762%,8:18.15797%,9:17.57415%,15:0.00285%,22:0.00107%,24:0.00036%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.9975%,0:0.0025%]
[INFO] ** i/f_name:[2:99.99715%,3:0.00285%]
[INFO] ** modbus_function_code:[0.02961:99.99661%,-33.760870000000004:0.00339%]
[INFO] ** modbus_function_description:[7:49.99946%,11:49.99715%,0:0.00339%]
[INFO] ** modbus_transaction_id:65536 (11.6935%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99661%,1:0.00285%,2:0.00054%]
[INFO] ** proxy_src_ip:[18:38.11594%,20:26.14765%,13:18.15815%,6:17.57469%,17:0.00285%,14:0.00054%,16:0.00018%]
[INFO] ** s_port:[1.45442:26.14694%,-0.32151:20.83762%,-1.27613:18.15762%,-0.23351:17.57398%,-0.33484:17.27832%,-71.33197:0.00285%,-0.24151:0.00054%,1.45709:0.00036%,-1.27347:0.00036%,13.431270000000001:0.00018%,-1.2708:0.00018%,-1.02014:0.00018%,-71.14798:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,11.862:0.00018%,1.47576:0.00018%]
[INFO] ** scada_tag:[3:26.1464%,1:20.83744%,5:18.15762%,4:17.57362%,2:17.27814%,0:0.00678%]
[INFO] ** service:[0.0048200000000000005:99.99661%,-211.73542999999998:0.00285%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.11594%,9:26.14765%,7:18.15815%,1:17.57469%,14:0.00285%,2:0.00054%,15:0.00018%]
[INFO] ** type:[0:99.99964%,1:0.00036%]
[INFO] ** unixtime:1532 (0.27335%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.0711 - tp: 79647.0000 - fp: 353.0000 - tn: 319647.0000 - fn: 353.0000 - accuracy: 0.9982 - precision: 0.9956 - recall: 0.9956 - auc: 0.9972 - val_loss: 7.3436e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-19-20-batch-0-100000
[INFO] processing batch 100000-200000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.2749 - tp: 68709.0000 - fp: 11291.0000 - tn: 308709.0000 - fn: 11291.0000 - accuracy: 0.9435 - precision: 0.8589 - recall: 0.8589 - auc: 0.9118 - val_loss: 2.9407 - val_tp: 16351.0000 - val_fp: 3649.0000 - val_tn: 76351.0000 - val_fn: 3649.0000 - val_accuracy: 0.9270 - val_precision: 0.8176 - val_recall: 0.8176 - val_auc: 0.8860
[INFO] saving weights to checkpoints/lstm-epoch-10-files-19-20-batch-100000-200000
[INFO] processing batch 200000-300000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9490 - tp: 65363.0000 - fp: 14637.0000 - tn: 305363.0000 - fn: 14637.0000 - accuracy: 0.9268 - precision: 0.8170 - recall: 0.8170 - auc: 0.8856 - val_loss: 2.9480 - val_tp: 16342.0000 - val_fp: 3658.0000 - val_tn: 76342.0000 - val_fn: 3658.0000 - val_accuracy: 0.9268 - val_precision: 0.8171 - val_recall: 0.8171 - val_auc: 0.8857
[INFO] saving weights to checkpoints/lstm-epoch-10-files-19-20-batch-200000-300000
[INFO] processing batch 300000-400000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5602 - tp: 72256.0000 - fp: 7744.0000 - tn: 312256.0000 - fn: 7744.0000 - accuracy: 0.9613 - precision: 0.9032 - recall: 0.9032 - auc: 0.9395 - val_loss: 5.8223e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-19-20-batch-300000-400000
[INFO] processing batch 400000-500000/560448
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.4072e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.0924e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-19-20-batch-400000-500000
[INFO] processing batch 500000-600000/560448
[33m[INFO] loading file 21-21/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (560446, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (560446, 17)

[INFO] analyzing data
[INFO] 560446 rows
[INFO] ** appi_name:[21:99.99607%,30:0.00107%,7:0.00054%,26:0.00036%,22:0.00036%,0:0.00036%,31:0.00018%,27:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,8:0.00018%,5:0.00018%]
[INFO] ** classification:[normal:98.91105%,Multi Stage Single Point:1.08895%]
[INFO] ** dst:[21:43.31283%,10:20.98293%,8:18.16535%,9:17.53407%,15:0.00107%,22:0.00089%,24:0.00071%,6:0.00071%,25:0.00036%,16:0.00036%,2:0.00036%,18:0.00018%,7:0.00018%]
[INFO] ** i/f_dir:[1:99.99893%,0:0.00107%]
[INFO] ** i/f_name:[2:99.99893%,3:0.00107%]
[INFO] ** modbus_function_code:[0.02961:99.99607%,-33.760870000000004:0.00375%,0.9188299999999999:0.00018%]
[INFO] ** modbus_function_description:[7:49.99893%,11:49.99715%,0:0.00375%,15:0.00018%]
[INFO] ** modbus_transaction_id:65536 (11.69354%)
[INFO] ** orig:[0:99.99929%,2:0.00071%]
[INFO] ** proto:[0:99.9975%,2:0.00143%,1:0.00107%]
[INFO] ** proxy_src_ip:[18:38.30985%,20:25.98555%,13:18.16607%,6:17.53407%,17:0.00107%,10:0.00107%,11:0.00089%,16:0.00054%,1:0.00036%,21:0.00018%,14:0.00018%,7:0.00018%]
[INFO] ** s_port:[1.45442:25.98502%,-0.32151:20.98222%,-1.27613:18.16518%,-0.23351:17.53389%,-0.33484:17.32763%,-71.33197:0.00107%,-1.27347:0.00071%,-6.64392:0.00071%,-1.02014:0.00054%,-64.19493:0.00036%,-71.14931:0.00036%,-71.14798:0.00036%,1.47576:0.00018%,1.46509:0.00018%,-1.2708:0.00018%,6.62488:0.00018%,10.15141:0.00018%,-68.79874000000001:0.00018%,7.060860000000001:0.00018%,-3.3787199999999995:0.00018%,-2.2440900000000004:0.00018%,1.45709:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.98448%,1:20.98204%,5:18.165%,4:17.53354%,2:17.32763%,0:0.00732%]
[INFO] ** service:[0.0048200000000000005:99.99679%,-211.73542999999998:0.00107%,-211.09762999999998:0.00054%,-211.08346:0.00036%,-186.44547:0.00036%,-211.08818:0.00036%,-211.35747999999998:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.30985%,9:25.98555%,7:18.16607%,1:17.53407%,11:0.00107%,21:0.00089%,10:0.00089%,15:0.00054%,14:0.00036%,3:0.00036%,4:0.00018%,2:0.00018%]
[INFO] ** type:[0:99.99982%,2:0.00018%]
[INFO] ** unixtime:1527 (0.27246%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/560446
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.8914e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.4536e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-20-21-batch-0-100000
[INFO] processing batch 100000-200000/560446
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.1679e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9164e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-20-21-batch-100000-200000
[INFO] processing batch 200000-300000/560446
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.6494e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4229e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-20-21-batch-200000-300000
[INFO] processing batch 300000-400000/560446
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.2203e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.0283e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-20-21-batch-300000-400000
[INFO] processing batch 400000-500000/560446
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.8527e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6927e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-20-21-batch-400000-500000
[INFO] processing batch 500000-600000/560446
[33m[INFO] loading file 22-22/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (329487, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (329487, 17)

[INFO] analyzing data
[INFO] 329487 rows
[INFO] ** appi_name:[21:99.99241%,30:0.00668%,23:0.0003%,22:0.0003%,18:0.0003%]
[INFO] ** classification:[normal:59.77019%,Multi Stage Single Point:40.22981%]
[INFO] ** dst:[21:43.3137%,10:21.00356%,8:18.09965%,9:17.57429%,15:0.00668%,22:0.00121%,19:0.00061%,26:0.0003%]
[INFO] ** i/f_dir:[1:99.99363%,0:0.00637%]
[INFO] ** i/f_name:[2:99.99332%,3:0.00637%,0:0.0003%]
[INFO] ** modbus_function_code:[0.02961:99.99241%,-33.760870000000004:0.00759%]
[INFO] ** modbus_function_description:[7:49.99712%,11:49.9953%,0:0.00759%]
[INFO] ** modbus_transaction_id:65534 (19.88971%)
[INFO] ** orig:[0:99.99484%,2:0.00455%,1:0.00061%]
[INFO] ** proto:[0:99.99302%,1:0.00668%,2:0.0003%]
[INFO] ** proxy_src_ip:[18:38.32959%,20:25.98858%,13:18.09904%,6:17.5752%,17:0.00668%,14:0.00061%,10:0.0003%]
[INFO] ** s_port:[1.45442:25.98767%,-0.32151:21.00356%,-1.27613:18.09904%,-0.23351:17.57429%,-0.33484:17.32603%,-71.33197:0.00668%,1.45709:0.00061%,-0.24151:0.00061%,7.228860000000001:0.00061%,-0.24950999999999998:0.0003%,1.46509:0.0003%,-71.14931:0.0003%]
[INFO] ** scada_tag:[3:25.98737%,1:21.00356%,5:18.09904%,4:17.57399%,2:17.32603%,0:0.01002%]
[INFO] ** service:[0.0048200000000000005:99.99241%,-211.73542999999998:0.00668%,-211.07873999999998:0.00061%,-211.08818:0.0003%]
[INFO] ** src:[22:38.32959%,9:25.98858%,7:18.09904%,1:17.5752%,21:0.00455%,14:0.00212%,2:0.00061%,11:0.0003%]
[INFO] ** type:[0:99.99818%,1:0.00182%]
[INFO] ** unixtime:910 (0.27619%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/329487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.0759 - tp: 64733.0000 - fp: 15267.0000 - tn: 304733.0000 - fn: 15267.0000 - accuracy: 0.9237 - precision: 0.8092 - recall: 0.8092 - auc: 0.8807 - val_loss: 7.5546 - val_tp: 10626.0000 - val_fp: 9374.0000 - val_tn: 70626.0000 - val_fn: 9374.0000 - val_accuracy: 0.8125 - val_precision: 0.5313 - val_recall: 0.5313 - val_auc: 0.7071
[INFO] saving weights to checkpoints/lstm-epoch-10-files-21-22-batch-0-100000
[INFO] processing batch 100000-200000/329487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5715 - tp: 42420.0000 - fp: 37580.0000 - tn: 282420.0000 - fn: 37580.0000 - accuracy: 0.8121 - precision: 0.5303 - recall: 0.5303 - auc: 0.7064 - val_loss: 7.5779 - val_tp: 10597.0000 - val_fp: 9403.0000 - val_tn: 70597.0000 - val_fn: 9403.0000 - val_accuracy: 0.8119 - val_precision: 0.5299 - val_recall: 0.5299 - val_auc: 0.7062
[INFO] saving weights to checkpoints/lstm-epoch-10-files-21-22-batch-100000-200000
[INFO] processing batch 200000-300000/329487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.5942 - tp: 42307.0000 - fp: 37693.0000 - tn: 282307.0000 - fn: 37693.0000 - accuracy: 0.8115 - precision: 0.5288 - recall: 0.5288 - auc: 0.7055 - val_loss: 7.5836 - val_tp: 10590.0000 - val_fp: 9410.0000 - val_tn: 70590.0000 - val_fn: 9410.0000 - val_accuracy: 0.8118 - val_precision: 0.5295 - val_recall: 0.5295 - val_auc: 0.7059
[INFO] saving weights to checkpoints/lstm-epoch-10-files-21-22-batch-200000-300000
[INFO] processing batch 300000-400000/329487
[33m[INFO] loading file 23-23/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529487, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529487, 17)

[INFO] analyzing data
[INFO] 529487 rows
[INFO] ** appi_name:[21:99.99887%,31:0.00038%,30:0.00038%,33:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:95.68261%,Multi Stage Single Point:4.31739%]
[INFO] ** dst:[21:43.3293%,10:21.00373%,8:18.1385%,9:17.52621%,22:0.00094%,24:0.00038%,18:0.00038%,15:0.00038%,25:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99962%,3:0.00038%]
[INFO] ** modbus_function_code:[0.02961:99.99887%,-33.760870000000004:0.00113%]
[INFO] ** modbus_function_description:[7:50.00047%,11:49.99839%,0:0.00113%]
[INFO] ** modbus_transaction_id:65536 (12.37726%)
[INFO] ** orig:[0:99.99981%,2:0.00019%]
[INFO] ** proto:[0:99.99906%,2:0.00057%,1:0.00038%]
[INFO] ** proxy_src_ip:[18:38.35127%,20:25.98194%,13:18.13869%,6:17.5264%,16:0.00057%,17:0.00038%,21:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.98137%,-0.32151:21.00354%,-1.27613:18.13812%,-0.23351:17.52602%,-0.33484:17.34773%,-1.02014:0.00057%,-1.27347:0.00038%,-0.08551:0.00038%,-71.33197:0.00038%,1.45709:0.00019%,-0.24151:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,1.46509:0.00019%,-64.19493:0.00019%,-0.24950999999999998:0.00019%,-49.275529999999996:0.00019%]
[INFO] ** scada_tag:[3:25.981%,1:21.00354%,5:18.13793%,4:17.52583%,2:17.34755%,0:0.00415%]
[INFO] ** service:[0.0048200000000000005:99.99906%,-211.73542999999998:0.00038%,-186.43601999999998:0.00038%,-186.44547:0.00019%]
[INFO] ** src:[22:38.35127%,9:25.98194%,7:18.13869%,1:17.5264%,15:0.00057%,21:0.00019%,17:0.00019%,14:0.00019%,8:0.00019%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1440 (0.27196%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.6057 - tp: 57140.0000 - fp: 22860.0000 - tn: 297140.0000 - fn: 22860.0000 - accuracy: 0.8857 - precision: 0.7143 - recall: 0.7143 - auc: 0.8214 - val_loss: 1.5941e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-22-23-batch-0-100000
[INFO] processing batch 100000-200000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4504e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3114e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-22-23-batch-100000-200000
[INFO] processing batch 200000-300000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1575e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0047e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-22-23-batch-200000-300000
[INFO] processing batch 300000-400000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 8.6861e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.5357e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-22-23-batch-300000-400000
[INFO] processing batch 400000-500000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.7589e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.0027e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-22-23-batch-400000-500000
[INFO] processing batch 500000-600000/529487
[33m[INFO] loading file 24-24/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529487, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529487, 17)

[INFO] analyzing data
[INFO] 529487 rows
[INFO] ** appi_name:[21:99.99301%,30:0.0034%,26:0.00057%,31:0.00038%,27:0.00038%,22:0.00038%,0:0.00038%,24:0.00019%,23:0.00019%,19:0.00019%,18:0.00019%,16:0.00019%,15:0.00019%,11:0.00019%,5:0.00019%]
[INFO] ** classification:[normal:95.18779%,Multi Stage Single Point:4.81221%]
[INFO] ** dst:[21:43.3597%,10:21.02393%,8:18.09959%,9:17.5094%,15:0.0034%,22:0.00113%,6:0.00076%,25:0.00038%,24:0.00038%,19:0.00038%,18:0.00038%,7:0.00038%,26:0.00019%]
[INFO] ** i/f_dir:[1:99.99679%,0:0.00321%]
[INFO] ** i/f_name:[2:99.9966%,3:0.0034%]
[INFO] ** modbus_function_code:[0.02961:99.99301%,-33.760870000000004:0.00642%,-0.415:0.00019%,0.9188299999999999:0.00019%,0.47422:0.00019%]
[INFO] ** modbus_function_description:[7:49.99745%,11:49.99556%,0:0.00642%,15:0.00019%,10:0.00019%,2:0.00019%]
[INFO] ** modbus_transaction_id:65536 (12.37726%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99452%,1:0.0034%,2:0.00208%]
[INFO] ** proxy_src_ip:[18:38.40283%,20:25.98156%,13:18.09959%,6:17.50865%,17:0.0034%,10:0.00132%,14:0.00094%,11:0.00094%,21:0.00038%,16:0.00038%]
[INFO] ** s_port:[1.45442:25.98081%,-0.32151:21.02393%,-1.27613:18.09922%,-0.23351:17.50808%,-0.33484:17.3789%,-71.33197:0.0034%,-9.58113:0.00076%,-71.14798:0.00057%,-1.27347:0.00038%,1.45709:0.00038%,-0.24151:0.00038%,-1.02014:0.00038%,-31.55091:0.00038%,7.6315100000000005:0.00038%,-71.14931:0.00038%,-64.19493:0.00038%,-68.79874000000001:0.00019%,-0.24950999999999998:0.00019%,1.46509:0.00019%,7.4901800000000005:0.00019%,13.431270000000001:0.00019%,11.862:0.00019%,1.47576:0.00019%]
[INFO] ** scada_tag:[3:25.98062%,1:21.02393%,5:18.09903%,4:17.5077%,2:17.37871%,0:0.01001%]
[INFO] ** service:[0.0048200000000000005:99.99415%,-211.73542999999998:0.0034%,-211.08346:0.00057%,-211.07873999999998:0.00038%,-202.75898:0.00038%,-186.44547:0.00038%,-186.43601999999998:0.00038%,-211.08818:0.00038%]
[INFO] ** src:[22:38.40283%,9:25.98156%,7:18.09959%,1:17.50865%,14:0.0034%,11:0.00132%,10:0.00094%,2:0.00094%,15:0.00038%,4:0.00038%]
[INFO] ** type:[0:99.99868%,1:0.00094%,2:0.00038%]
[INFO] ** unixtime:1438 (0.27158%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.6825e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.6921e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-23-24-batch-0-100000
[INFO] processing batch 100000-200000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.2703e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8734e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-23-24-batch-100000-200000
[INFO] processing batch 200000-300000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.5534e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5141e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-23-24-batch-200000-300000
[INFO] processing batch 300000-400000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 3.1468e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9594e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-23-24-batch-300000-400000
[INFO] processing batch 400000-500000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.5931 - tp: 72093.0000 - fp: 7907.0000 - tn: 312093.0000 - fn: 7907.0000 - accuracy: 0.9605 - precision: 0.9012 - recall: 0.9012 - auc: 0.9382 - val_loss: 5.7171 - val_tp: 12906.0000 - val_fp: 7094.0000 - val_tn: 72906.0000 - val_fn: 7094.0000 - val_accuracy: 0.8581 - val_precision: 0.6453 - val_recall: 0.6453 - val_auc: 0.7783
[INFO] saving weights to checkpoints/lstm-epoch-10-files-23-24-batch-400000-500000
[INFO] processing batch 500000-600000/529487
[33m[INFO] loading file 25-25/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529487, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529487, 17)

[INFO] analyzing data
[INFO] 529487 rows
[INFO] ** appi_name:[21:99.99622%,30:0.00113%,17:0.00076%,22:0.00057%,31:0.00038%,28:0.00019%,26:0.00019%,12:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** classification:[normal:64.34133%,Multi Stage Single Point:35.65867%]
[INFO] ** dst:[21:43.31627%,10:21.02053%,8:18.14775%,9:17.51091%,15:0.00113%,22:0.00094%,16:0.00076%,6:0.00076%,18:0.00038%,17:0.00038%,24:0.00019%]
[INFO] ** i/f_dir:[1:99.99887%,0:0.00113%]
[INFO] ** i/f_name:[2:99.99887%,3:0.00113%]
[INFO] ** modbus_function_code:[0.02961:99.99622%,-33.760870000000004:0.00378%]
[INFO] ** modbus_function_description:[7:49.99896%,11:49.99726%,0:0.00378%]
[INFO] ** modbus_transaction_id:65536 (12.37726%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99773%,2:0.00113%,1:0.00113%]
[INFO] ** proxy_src_ip:[18:38.38111%,20:25.9555%,13:18.14775%,6:17.51148%,17:0.00113%,1:0.00094%,21:0.00076%,16:0.00038%,14:0.00038%,7:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95512%,-0.32151:21.02016%,-1.27613:18.14738%,-0.23351:17.51091%,-0.33484:17.36096%,-71.33197:0.00113%,-71.14931:0.00057%,-0.24151:0.00038%,-1.02014:0.00038%,-49.275529999999996:0.00038%,1.46509:0.00019%,-5.1466400000000005:0.00019%,-1.27347:0.00019%,-1.2708:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,-0.24950999999999998:0.00019%,2.52505:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,6.1115699999999995:0.00019%,-5.08665:0.00019%,1.45709:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:25.95474%,1:21.01997%,5:18.14719%,4:17.51072%,2:17.36077%,0:0.00661%]
[INFO] ** service:[0.0048200000000000005:99.9966%,-211.73542999999998:0.00113%,-205.44247:0.00076%,-211.08818:0.00057%,-186.43601999999998:0.00038%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.38111%,9:25.9555%,7:18.14775%,1:17.51148%,14:0.00113%,3:0.00094%,4:0.00076%,21:0.00038%,15:0.00038%,2:0.00038%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1439 (0.27177%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7479 - tp: 51471.0000 - fp: 28529.0000 - tn: 291471.0000 - fn: 28529.0000 - accuracy: 0.8574 - precision: 0.6434 - recall: 0.6434 - auc: 0.7771 - val_loss: 5.7646 - val_tp: 12847.0000 - val_fp: 7153.0000 - val_tn: 72847.0000 - val_fn: 7153.0000 - val_accuracy: 0.8569 - val_precision: 0.6424 - val_recall: 0.6424 - val_auc: 0.7765
[INFO] saving weights to checkpoints/lstm-epoch-10-files-24-25-batch-0-100000
[INFO] processing batch 100000-200000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7455 - tp: 51483.0000 - fp: 28517.0000 - tn: 291483.0000 - fn: 28517.0000 - accuracy: 0.8574 - precision: 0.6435 - recall: 0.6435 - auc: 0.7772 - val_loss: 5.7308 - val_tp: 12889.0000 - val_fp: 7111.0000 - val_tn: 72889.0000 - val_fn: 7111.0000 - val_accuracy: 0.8578 - val_precision: 0.6445 - val_recall: 0.6445 - val_auc: 0.7778
[INFO] saving weights to checkpoints/lstm-epoch-10-files-24-25-batch-100000-200000
[INFO] processing batch 200000-300000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7515 - tp: 51453.0000 - fp: 28547.0000 - tn: 291453.0000 - fn: 28547.0000 - accuracy: 0.8573 - precision: 0.6432 - recall: 0.6432 - auc: 0.7770 - val_loss: 5.7550 - val_tp: 12859.0000 - val_fp: 7141.0000 - val_tn: 72859.0000 - val_fn: 7141.0000 - val_accuracy: 0.8572 - val_precision: 0.6429 - val_recall: 0.6429 - val_auc: 0.7768
[INFO] saving weights to checkpoints/lstm-epoch-10-files-24-25-batch-200000-300000
[INFO] processing batch 300000-400000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7388 - tp: 51516.0000 - fp: 28484.0000 - tn: 291516.0000 - fn: 28484.0000 - accuracy: 0.8576 - precision: 0.6439 - recall: 0.6439 - auc: 0.7775 - val_loss: 5.7872 - val_tp: 12819.0000 - val_fp: 7181.0000 - val_tn: 72819.0000 - val_fn: 7181.0000 - val_accuracy: 0.8564 - val_precision: 0.6410 - val_recall: 0.6410 - val_auc: 0.7756
[INFO] saving weights to checkpoints/lstm-epoch-10-files-24-25-batch-300000-400000
[INFO] processing batch 400000-500000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.7411 - tp: 51505.0000 - fp: 28495.0000 - tn: 291505.0000 - fn: 28495.0000 - accuracy: 0.8575 - precision: 0.6438 - recall: 0.6438 - auc: 0.7774 - val_loss: 5.7501 - val_tp: 12865.0000 - val_fp: 7135.0000 - val_tn: 72865.0000 - val_fn: 7135.0000 - val_accuracy: 0.8573 - val_precision: 0.6432 - val_recall: 0.6432 - val_auc: 0.7770
[INFO] saving weights to checkpoints/lstm-epoch-10-files-24-25-batch-400000-500000
[INFO] processing batch 500000-600000/529487
[33m[INFO] loading file 26-26/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (529487, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (529487, 17)

[INFO] analyzing data
[INFO] 529487 rows
[INFO] ** appi_name:[21:99.99849%,7:0.00057%,31:0.00019%,30:0.00019%,22:0.00019%,12:0.00019%,8:0.00019%]
[INFO] ** classification:[normal:64.39837%,Single Stage Single Point:30.16354%,Multi Stage Single Point:5.43809%]
[INFO] ** dst:[21:43.31079%,10:21.0855%,8:18.11867%,9:17.48258%,22:0.00076%,24:0.00038%,16:0.00038%,2:0.00038%,18:0.00019%,15:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99981%,3:0.00019%]
[INFO] ** modbus_function_code:[0.02961:99.99849%,-33.760870000000004:0.00151%]
[INFO] ** modbus_function_description:[7:49.99972%,11:49.99877%,0:0.00151%]
[INFO] ** modbus_transaction_id:65536 (12.37726%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99943%,2:0.00038%,1:0.00019%]
[INFO] ** proxy_src_ip:[18:38.4678%,20:25.92868%,13:18.11905%,6:17.48258%,1:0.00057%,21:0.00038%,16:0.00038%,17:0.00019%,14:0.00019%,7:0.00019%]
[INFO] ** s_port:[1.45442:25.92812%,-0.32151:21.08531%,-1.27613:18.11848%,-0.23351:17.48239%,-0.33484:17.38249%,-1.27347:0.00038%,-1.02014:0.00038%,7.66617:0.00019%,-71.14931:0.00019%,11.57001:0.00019%,-3.3787199999999995:0.00019%,2.52505:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%,1.45709:0.00019%,-49.275529999999996:0.00019%,1.47576:0.00019%,1.46509:0.00019%,14.191239999999999:0.00019%,-71.33197:0.00019%]
[INFO] ** scada_tag:[3:25.92774%,1:21.08531%,5:18.11848%,4:17.4822%,2:17.38249%,0:0.00378%]
[INFO] ** service:[0.0048200000000000005:99.99868%,-211.09762999999998:0.00057%,-211.35747999999998:0.00019%,-211.73542999999998:0.00019%,-186.43601999999998:0.00019%,-211.08818:0.00019%]
[INFO] ** src:[22:38.4678%,9:25.92868%,7:18.11905%,1:17.48258%,3:0.00057%,15:0.00038%,4:0.00038%,21:0.00019%,14:0.00019%,2:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1437 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7397 - tp: 51512.0000 - fp: 28488.0000 - tn: 291512.0000 - fn: 28488.0000 - accuracy: 0.8576 - precision: 0.6439 - recall: 0.6439 - auc: 0.7774 - val_loss: 5.4957 - val_tp: 12889.0000 - val_fp: 7111.0000 - val_tn: 72889.0000 - val_fn: 7111.0000 - val_accuracy: 0.8578 - val_precision: 0.6445 - val_recall: 0.6445 - val_auc: 0.7778
[INFO] saving weights to checkpoints/lstm-epoch-10-files-25-26-batch-0-100000
[INFO] processing batch 100000-200000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 0.2236 - tp: 78140.0000 - fp: 1860.0000 - tn: 318140.0000 - fn: 1860.0000 - accuracy: 0.9907 - precision: 0.9768 - recall: 0.9768 - auc: 0.9884 - val_loss: 1.2797e-04 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-25-26-batch-100000-200000
[INFO] processing batch 200000-300000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.7344e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.4841e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-25-26-batch-200000-300000
[INFO] processing batch 300000-400000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.0660e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.2017e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-25-26-batch-300000-400000
[INFO] processing batch 400000-500000/529487
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.7689e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5726e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-25-26-batch-400000-500000
[INFO] processing batch 500000-600000/529487
[33m[INFO] loading file 27-27/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (469617, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (469617, 17)

[INFO] analyzing data
[INFO] 469617 rows
[INFO] ** appi_name:[21:99.99936%,30:0.00064%]
[INFO] ** classification:[normal:64.33796%,Single Stage Single Point:35.66204%]
[INFO] ** dst:[21:43.27314%,10:21.06291%,8:18.1878%,9:17.47445%,22:0.00085%,15:0.00064%,24:0.00021%]
[INFO] ** i/f_dir:[1:99.99979%,0:0.00021%]
[INFO] ** i/f_name:[2:99.99936%,3:0.00064%]
[INFO] ** modbus_function_code:[0.02961:99.99936%,-33.760870000000004:0.00064%]
[INFO] ** modbus_function_description:[7:50.00032%,11:49.99904%,0:0.00064%]
[INFO] ** modbus_transaction_id:65536 (13.9552%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99936%,1:0.00064%]
[INFO] ** proxy_src_ip:[18:38.40257%,20:25.93411%,13:18.18759%,6:17.47467%,17:0.00064%,16:0.00043%]
[INFO] ** s_port:[1.45442:25.93347%,-0.32151:21.06291%,-1.27613:18.18737%,-0.23351:17.47424%,-0.33484:17.33966%,-71.33197:0.00064%,-1.02014:0.00043%,-1.27347:0.00021%,1.45709:0.00021%,-0.24950999999999998:0.00021%,1.46509:0.00021%,1.47576:0.00021%,-0.24151:0.00021%]
[INFO] ** scada_tag:[3:25.93305%,1:21.0627%,5:18.18716%,4:17.47403%,2:17.33945%,0:0.00362%]
[INFO] ** service:[0.0048200000000000005:99.99936%,-211.73542999999998:0.00064%]
[INFO] ** src:[22:38.40257%,9:25.93411%,7:18.18759%,1:17.47467%,14:0.00064%,15:0.00043%]
[INFO] ** type:[0:99.99957%,1:0.00043%]
[INFO] ** unixtime:1276 (0.27171%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/469617
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.8462e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9059e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-26-27-batch-0-100000
[INFO] processing batch 100000-200000/469617
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.9530e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8777e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-26-27-batch-100000-200000
[INFO] processing batch 200000-300000/469617
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3289e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7525e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-26-27-batch-200000-300000
[INFO] processing batch 300000-400000/469617
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.9489e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4824e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-26-27-batch-300000-400000
[INFO] processing batch 400000-500000/469617
[33m[INFO] loading file 28-28/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (403533, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (403533, 17)

[INFO] analyzing data
[INFO] 403533 rows
[INFO] ** appi_name:[21:99.99257%,30:0.00173%,17:0.00124%,22:0.00099%,7:0.00099%,31:0.00074%,26:0.00074%,28:0.00025%,27:0.00025%,8:0.00025%,0:0.00025%]
[INFO] ** classification:[normal:64.31172%,Single Stage Single Point:35.68828%]
[INFO] ** dst:[21:43.28345%,10:21.02059%,8:18.20495%,9:17.48308%,6:0.00198%,16:0.00173%,18:0.00124%,15:0.00074%,22:0.0005%,17:0.0005%,2:0.0005%,25:0.00025%,7:0.00025%,0:0.00025%]
[INFO] ** i/f_dir:[1:99.99926%,0:0.00074%]
[INFO] ** i/f_name:[2:99.99926%,3:0.00074%]
[INFO] ** modbus_function_code:[0.02961:99.99257%,-33.760870000000004:0.00743%]
[INFO] ** modbus_function_description:[11:49.99641%,7:49.99616%,0:0.00743%]
[INFO] ** modbus_transaction_id:65536 (16.24056%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99554%,2:0.00372%,1:0.00074%]
[INFO] ** proxy_src_ip:[18:38.34259%,20:25.96145%,13:18.2052%,6:17.48333%,1:0.00198%,17:0.00173%,14:0.00149%,7:0.00124%,21:0.00074%,0:0.00025%]
[INFO] ** s_port:[1.45442:25.9612%,-0.32151:21.02059%,-1.27613:18.20495%,-0.23351:17.48283%,-0.33484:17.322%,-71.14798:0.00099%,-71.14931:0.00099%,-71.33197:0.00074%,-0.08551:0.0005%,-0.24151:0.0005%,7.66617:0.00025%,-58.035180000000004:0.00025%,-1.2708:0.00025%,-64.19493:0.00025%,-5.1466400000000005:0.00025%,13.431270000000001:0.00025%,11.57001:0.00025%,14.4699:0.00025%,1.47576:0.00025%,14.191239999999999:0.00025%,-5.08665:0.00025%,10.192739999999999:0.00025%,-3.3787199999999995:0.00025%,6.1115699999999995:0.00025%,2.05573:0.00025%,-43.76509:0.00025%,2.52505:0.00025%,11.862:0.00025%,-58.032509999999995:0.00025%]
[INFO] ** scada_tag:[3:25.96095%,1:21.02059%,5:18.20495%,4:17.48259%,2:17.322%,0:0.00892%]
[INFO] ** service:[0.0048200000000000005:99.99257%,-205.44247:0.00124%,-186.43601999999998:0.00124%,-211.09762999999998:0.00099%,-211.08346:0.00099%,-211.08818:0.00099%,-211.73542999999998:0.00074%,-186.44547:0.00025%,-183.8612:0.00025%,-185.9872:0.00025%,-211.35747999999998:0.00025%,-202.75898:0.00025%]
[INFO] ** src:[22:38.34259%,9:25.96145%,7:18.2052%,1:17.48333%,3:0.00223%,2:0.00149%,21:0.00124%,4:0.00099%,14:0.00074%,8:0.0005%,17:0.00025%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1097 (0.27185%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/403533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1807e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3437e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-27-28-batch-0-100000
[INFO] processing batch 100000-200000/403533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2327e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1279e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-27-28-batch-100000-200000
[INFO] processing batch 200000-300000/403533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.1179e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.8107e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-27-28-batch-200000-300000
[INFO] processing batch 300000-400000/403533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.7051e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.5464e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-27-28-batch-300000-400000
[INFO] processing batch 400000-500000/403533
[33m[INFO] loading file 29-29/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (503533, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (503533, 17)

[INFO] analyzing data
[INFO] 503533 rows
[INFO] ** appi_name:[21:99.99881%,30:0.0006%,26:0.0002%,9:0.0002%,3:0.0002%]
[INFO] ** classification:[normal:64.38863%,Single Stage Single Point:35.61137%]
[INFO] ** dst:[21:43.32626%,10:21.06098%,8:18.14538%,9:17.46559%,22:0.0006%,15:0.0006%,24:0.0002%,6:0.0002%,0:0.0002%]
[INFO] ** i/f_dir:[1:99.9996%,0:0.0004%]
[INFO] ** i/f_name:[2:99.9994%,3:0.0006%]
[INFO] ** modbus_function_code:[0.02961:99.99881%,-33.760870000000004:0.00119%]
[INFO] ** modbus_function_description:[7:49.9997%,11:49.99911%,0:0.00119%]
[INFO] ** modbus_transaction_id:65536 (13.01523%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99921%,1:0.0006%,2:0.0002%]
[INFO] ** proxy_src_ip:[18:38.44237%,20:25.94507%,13:18.14578%,6:17.46539%,17:0.0006%,21:0.0002%,16:0.0002%,1:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.94448%,-0.32151:21.06078%,-1.27613:18.14538%,-0.23351:17.46539%,-0.33484:17.38158%,-71.33197:0.0006%,1.45709:0.0004%,-71.14798:0.0002%,-1.27347:0.0002%,1.47576:0.0002%,14.4699:0.0002%,-61.95768:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.94408%,1:21.06059%,5:18.14538%,4:17.46499%,2:17.38158%,0:0.00338%]
[INFO] ** service:[0.0048200000000000005:99.99901%,-211.73542999999998:0.0006%,-183.8612:0.0002%,-211.08346:0.0002%]
[INFO] ** src:[22:38.44237%,9:25.94507%,7:18.14578%,1:17.46539%,14:0.0006%,15:0.0002%,8:0.0002%,4:0.0002%,3:0.0002%]
[INFO] ** type:[0:99.9998%,1:0.0002%]
[INFO] ** unixtime:1368 (0.27168%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.9453e-04 - tp: 79993.0000 - fp: 7.0000 - tn: 319993.0000 - fn: 7.0000 - accuracy: 1.0000 - precision: 0.9999 - recall: 0.9999 - auc: 1.0000 - val_loss: 4.1617e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-28-29-batch-0-100000
[INFO] processing batch 100000-200000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.4525e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0607e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-28-29-batch-100000-200000
[INFO] processing batch 200000-300000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.9465e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.8208e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-28-29-batch-200000-300000
[INFO] processing batch 300000-400000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.6141e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.0902e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-28-29-batch-300000-400000
[INFO] processing batch 400000-500000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0761e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.5714e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-28-29-batch-400000-500000
[INFO] processing batch 500000-600000/503533
[33m[INFO] loading file 30-30/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (503533, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (503533, 17)

[INFO] analyzing data
[INFO] 503533 rows
[INFO] ** appi_name:[21:99.99742%,30:0.00179%,26:0.0002%,17:0.0002%,12:0.0002%,0:0.0002%]
[INFO] ** classification:[normal:64.36559%,Single Stage Single Point:35.63441%]
[INFO] ** dst:[21:43.33956%,10:21.02285%,8:18.14658%,9:17.48743%,15:0.00179%,22:0.00079%,24:0.0004%,25:0.0002%,16:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99821%,0:0.00179%]
[INFO] ** i/f_name:[2:99.99821%,3:0.00179%]
[INFO] ** modbus_function_code:[0.02961:99.99742%,-33.760870000000004:0.00258%]
[INFO] ** modbus_function_description:[7:49.9997%,11:49.99772%,0:0.00258%]
[INFO] ** modbus_transaction_id:65536 (13.01523%)
[INFO] ** orig:[0:99.99901%,2:0.0006%,1:0.0004%]
[INFO] ** proto:[0:99.99782%,1:0.00179%,2:0.0004%]
[INFO] ** proxy_src_ip:[18:38.36253%,20:25.99969%,13:18.14697%,6:17.48803%,17:0.00179%,7:0.0004%,16:0.0002%,5:0.0002%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.99949%,-0.32151:21.02265%,-1.27613:18.14638%,-0.23351:17.48724%,-0.33484:17.33988%,-71.33197:0.00179%,-0.24151:0.0006%,-1.27347:0.0004%,-71.14798:0.0002%,-0.24950999999999998:0.0002%,10.192739999999999:0.0002%,1.47576:0.0002%,-61.95768:0.0002%,-1.02014:0.0002%,-64.19493:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.99909%,1:21.02265%,5:18.14618%,4:17.48704%,2:17.33968%,0:0.00536%]
[INFO] ** service:[0.0048200000000000005:99.99762%,-211.73542999999998:0.00179%,-186.44547:0.0002%,-211.08346:0.0002%,-205.44247:0.0002%]
[INFO] ** src:[22:38.36253%,9:25.99969%,7:18.14697%,1:17.48803%,14:0.00119%,21:0.00099%,16:0.0002%,15:0.0002%,8:0.0002%]
[INFO] ** type:[0:99.99921%,1:0.00079%]
[INFO] ** unixtime:1369 (0.27188%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0355e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.4204e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-29-30-batch-0-100000
[INFO] processing batch 100000-200000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.1847e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.9743e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-29-30-batch-100000-200000
[INFO] processing batch 200000-300000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.3270e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.4979e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-29-30-batch-200000-300000
[INFO] processing batch 300000-400000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.7710e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.4136e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-29-30-batch-300000-400000
[INFO] processing batch 400000-500000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4532e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8062e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-29-30-batch-400000-500000
[INFO] processing batch 500000-600000/503533
[33m[INFO] loading file 31-31/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (503533, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (503533, 17)

[INFO] analyzing data
[INFO] 503533 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.37592%,Single Stage Single Point:35.62408%]
[INFO] ** dst:[21:43.31871%,10:21.05622%,8:18.12612%,9:17.49776%,22:0.00079%,24:0.0004%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[11:50.0001%,7:49.9999%]
[INFO] ** modbus_transaction_id:65536 (13.01523%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.40602%,20:25.9697%,13:18.12632%,6:17.49756%,16:0.0004%]
[INFO] ** s_port:[1.45442:25.9689%,-0.32151:21.05622%,-1.27613:18.12592%,-0.23351:17.49756%,-0.33484:17.34981%,-1.27347:0.0004%,1.45709:0.0004%,-1.02014:0.0004%,1.46509:0.0002%,1.47576:0.0002%]
[INFO] ** scada_tag:[3:25.96851%,1:21.05602%,5:18.12572%,4:17.49736%,2:17.34961%,0:0.00278%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.40602%,9:25.9697%,7:18.12632%,1:17.49756%,15:0.0004%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1368 (0.27168%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.9837e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.6821e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-30-31-batch-0-100000
[INFO] processing batch 100000-200000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.2931e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.4967e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-30-31-batch-100000-200000
[INFO] processing batch 200000-300000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.6786e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4668e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-30-31-batch-200000-300000
[INFO] processing batch 300000-400000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.6001e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9910e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-30-31-batch-300000-400000
[INFO] processing batch 400000-500000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.8439e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7148e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-30-31-batch-400000-500000
[INFO] processing batch 500000-600000/503533
[33m[INFO] loading file 32-32/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (503533, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (503533, 17)

[INFO] analyzing data
[INFO] 503533 rows
[INFO] ** appi_name:[21:99.99603%,30:0.00338%,31:0.0002%,27:0.0002%,26:0.0002%]
[INFO] ** classification:[normal:64.38744%,Single Stage Single Point:35.61256%]
[INFO] ** dst:[21:43.32943%,10:21.05284%,8:18.15134%,9:17.46142%,15:0.00338%,22:0.00099%,18:0.0002%,7:0.0002%,6:0.0002%]
[INFO] ** i/f_dir:[1:99.99702%,0:0.00298%]
[INFO] ** i/f_name:[2:99.99662%,3:0.00338%]
[INFO] ** modbus_function_code:[0.02961:99.99603%,-33.760870000000004:0.00397%]
[INFO] ** modbus_function_description:[7:49.99871%,11:49.99732%,0:0.00397%]
[INFO] ** modbus_transaction_id:65536 (13.01523%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99603%,1:0.00338%,2:0.0006%]
[INFO] ** proxy_src_ip:[18:38.41695%,20:25.96553%,13:18.15114%,6:17.46221%,17:0.00338%,14:0.0006%,16:0.0002%]
[INFO] ** s_port:[1.45442:25.96513%,-0.32151:21.05284%,-1.27613:18.15095%,-0.23351:17.46142%,-0.33484:17.36411%,-71.33197:0.00338%,-0.24151:0.0006%,-71.14798:0.0002%,11.862:0.0002%,1.45709:0.0002%,-0.24950999999999998:0.0002%,1.46509:0.0002%,13.431270000000001:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** scada_tag:[3:25.96473%,1:21.05264%,5:18.15095%,4:17.46102%,2:17.36411%,0:0.00655%]
[INFO] ** service:[0.0048200000000000005:99.99603%,-211.73542999999998:0.00338%,-211.08346:0.0002%,-186.43601999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** src:[22:38.41695%,9:25.96553%,7:18.15114%,1:17.46221%,14:0.00338%,2:0.0006%,15:0.0002%]
[INFO] ** type:[0:99.9996%,1:0.0004%]
[INFO] ** unixtime:1367 (0.27148%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.7990e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.3199e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-31-32-batch-0-100000
[INFO] processing batch 100000-200000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6128e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.2791e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-31-32-batch-100000-200000
[INFO] processing batch 200000-300000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.1499e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.0777e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-31-32-batch-200000-300000
[INFO] processing batch 300000-400000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5350e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.6076e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-31-32-batch-300000-400000
[INFO] processing batch 400000-500000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.1509e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8918e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-31-32-batch-400000-500000
[INFO] processing batch 500000-600000/503533
[33m[INFO] loading file 33-33/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (503533, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (503533, 17)

[INFO] analyzing data
[INFO] 503533 rows
[INFO] ** appi_name:[21:99.99662%,30:0.00119%,17:0.00079%,22:0.0006%,31:0.0002%,28:0.0002%,26:0.0002%,7:0.0002%]
[INFO] ** classification:[normal:64.39379%,Single Stage Single Point:35.60621%]
[INFO] ** dst:[21:43.33499%,10:21.05383%,8:18.11401%,9:17.4922%,22:0.00119%,15:0.00119%,16:0.00079%,6:0.00079%,24:0.0004%,17:0.0004%,18:0.0002%]
[INFO] ** i/f_dir:[1:99.99881%,0:0.00119%]
[INFO] ** i/f_name:[2:99.99881%,3:0.00119%]
[INFO] ** modbus_function_code:[0.02961:99.99662%,-33.760870000000004:0.00338%]
[INFO] ** modbus_function_description:[7:49.9995%,11:49.99712%,0:0.00338%]
[INFO] ** modbus_transaction_id:65536 (13.01523%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99782%,1:0.00119%,2:0.00099%]
[INFO] ** proxy_src_ip:[18:38.41536%,20:25.97427%,13:18.11401%,6:17.4924%,17:0.00119%,1:0.00079%,16:0.0006%,21:0.0004%,14:0.0004%,7:0.0004%,0:0.0002%]
[INFO] ** s_port:[1.45442:25.97347%,-0.32151:21.05383%,-1.27613:18.11361%,-0.23351:17.492%,-0.33484:17.36152%,-71.33197:0.00119%,-1.02014:0.0006%,-71.14931:0.0006%,1.45709:0.0004%,-1.27347:0.0004%,-71.14798:0.0002%,-58.035180000000004:0.0002%,-5.1466400000000005:0.0002%,-0.24151:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-5.08665:0.0002%,-0.24950999999999998:0.0002%,6.1115699999999995:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** scada_tag:[3:25.97307%,1:21.05383%,5:18.11341%,4:17.4918%,2:17.36152%,0:0.00636%]
[INFO] ** service:[0.0048200000000000005:99.99662%,-211.73542999999998:0.00119%,-205.44247:0.00079%,-211.08818:0.0006%,-211.09762999999998:0.0002%,-211.08346:0.0002%,-185.9872:0.0002%,-186.43601999999998:0.0002%]
[INFO] ** src:[22:38.41536%,9:25.97427%,7:18.11401%,1:17.4924%,14:0.00119%,3:0.00079%,15:0.0006%,21:0.0004%,4:0.0004%,2:0.0004%,8:0.0002%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1370 (0.27208%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.3839e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.5683e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-32-33-batch-0-100000
[INFO] processing batch 100000-200000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.3582e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.4326e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-32-33-batch-100000-200000
[INFO] processing batch 200000-300000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1229e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.8849e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-32-33-batch-200000-300000
[INFO] processing batch 300000-400000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3499e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.7593e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-32-33-batch-300000-400000
[INFO] processing batch 400000-500000/503533
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 9.6219e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.9055e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-32-33-batch-400000-500000
[INFO] processing batch 500000-600000/503533
[33m[INFO] loading file 34-34/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (344966, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (344966, 17)

[INFO] analyzing data
[INFO] 344966 rows
[INFO] ** appi_name:[21:99.99768%,7:0.00087%,31:0.00029%,30:0.00029%,22:0.00029%,8:0.00029%,6:0.00029%]
[INFO] ** classification:[normal:64.33504%,Single Stage Single Point:35.66496%]
[INFO] ** dst:[21:43.27006%,10:21.06208%,8:18.21368%,9:17.45129%,22:0.00087%,16:0.00058%,2:0.00058%,18:0.00029%,15:0.00029%,6:0.00029%]
[INFO] ** i/f_dir:[1:99.99971%,0:0.00029%]
[INFO] ** i/f_name:[2:99.99971%,3:0.00029%]
[INFO] ** modbus_function_code:[0.02961:99.99768%,-33.760870000000004:0.00232%]
[INFO] ** modbus_function_description:[7:49.99913%,11:49.99855%,0:0.00232%]
[INFO] ** modbus_transaction_id:65536 (18.99781%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99913%,2:0.00058%,1:0.00029%]
[INFO] ** proxy_src_ip:[18:38.38465%,20:25.94748%,13:18.21368%,6:17.45186%,1:0.00087%,21:0.00058%,17:0.00029%,14:0.00029%,7:0.00029%]
[INFO] ** s_port:[1.45442:25.94719%,-0.32151:21.06179%,-1.27613:18.21368%,-0.23351:17.451%,-0.33484:17.32287%,-0.24151:0.00087%,-3.0613900000000003:0.00029%,-3.3787199999999995:0.00029%,14.191239999999999:0.00029%,1.47576:0.00029%,11.57001:0.00029%,-49.275529999999996:0.00029%,-71.14931:0.00029%,7.66617:0.00029%,-71.33197:0.00029%]
[INFO] ** scada_tag:[3:25.9469%,1:21.0615%,5:18.21339%,4:17.45071%,2:17.32287%,0:0.00464%]
[INFO] ** service:[0.0048200000000000005:99.99797%,-211.09762999999998:0.00087%,-211.73542999999998:0.00029%,-186.43601999999998:0.00029%,-211.35747999999998:0.00029%,-211.08818:0.00029%]
[INFO] ** src:[22:38.38465%,9:25.94748%,7:18.21368%,1:17.45186%,3:0.00087%,4:0.00058%,21:0.00029%,14:0.00029%,2:0.00029%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:937 (0.27162%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/344966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.3054e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9070e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-33-34-batch-0-100000
[INFO] processing batch 100000-200000/344966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7498e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1464e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-33-34-batch-100000-200000
[INFO] processing batch 200000-300000/344966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.5159e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.5320e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-33-34-batch-200000-300000
[INFO] processing batch 300000-400000/344966
[33m[INFO] loading file 35-35/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544966, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544966, 17)

[INFO] analyzing data
[INFO] 544966 rows
[INFO] ** appi_name:[21:99.9989%,30:0.0011%]
[INFO] ** classification:[normal:64.3697%,Single Stage Single Point:35.6303%]
[INFO] ** dst:[21:43.33371%,10:21.03342%,8:18.15508%,9:17.47559%,22:0.0011%,15:0.0011%]
[INFO] ** i/f_dir:[1:99.99908%,0:0.00092%]
[INFO] ** i/f_name:[2:99.9989%,3:0.0011%]
[INFO] ** modbus_function_code:[0.02961:99.9989%,-33.760870000000004:0.0011%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99872%,0:0.0011%]
[INFO] ** modbus_transaction_id:65536 (12.0257%)
[INFO] ** orig:[0:99.99963%,1:0.00037%]
[INFO] ** proto:[0:99.9989%,1:0.0011%]
[INFO] ** proxy_src_ip:[18:38.39873%,20:25.96896%,13:18.15471%,6:17.47577%,17:0.0011%,16:0.00073%]
[INFO] ** s_port:[1.45442:25.96841%,-0.32151:21.03342%,-1.27613:18.15471%,-0.23351:17.4754%,-0.33484:17.3653%,-71.33197:0.0011%,-1.02014:0.00073%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%]
[INFO] ** scada_tag:[3:25.96804%,1:21.03342%,5:18.15453%,4:17.47504%,2:17.3653%,0:0.00367%]
[INFO] ** service:[0.0048200000000000005:99.9989%,-211.73542999999998:0.0011%]
[INFO] ** src:[22:38.39873%,9:25.96896%,7:18.15471%,1:17.47577%,14:0.0011%,15:0.00073%]
[INFO] ** type:[0:99.99908%,1:0.00092%]
[INFO] ** unixtime:1479 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.3114e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1070e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-34-35-batch-0-100000
[INFO] processing batch 100000-200000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.6832e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5193e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-34-35-batch-100000-200000
[INFO] processing batch 200000-300000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.0770e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.3159e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-34-35-batch-200000-300000
[INFO] processing batch 300000-400000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.6966e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5546e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-34-35-batch-300000-400000
[INFO] processing batch 400000-500000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2201e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0608e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-34-35-batch-400000-500000
[INFO] processing batch 500000-600000/544966
[33m[INFO] loading file 36-36/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544966, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544966, 17)

[INFO] analyzing data
[INFO] 544966 rows
[INFO] ** appi_name:[21:99.99872%,30:0.00055%,31:0.00037%,33:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.35612%,Single Stage Single Point:35.64388%]
[INFO] ** dst:[21:43.33041%,10:21.0237%,8:18.15636%,9:17.48733%,22:0.00073%,15:0.00055%,24:0.00037%,18:0.00037%,25:0.00018%]
[INFO] ** i/f_dir:[1:99.99945%,0:0.00055%]
[INFO] ** i/f_name:[2:99.99945%,3:0.00055%]
[INFO] ** modbus_function_code:[0.02961:99.99872%,-33.760870000000004:0.00128%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99853%,0:0.00128%]
[INFO] ** modbus_transaction_id:65536 (12.0257%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9989%,2:0.00055%,1:0.00055%]
[INFO] ** proxy_src_ip:[18:38.37267%,20:25.98162%,13:18.15655%,6:17.48788%,17:0.00055%,21:0.00018%,2:0.00018%,1:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.98107%,-0.32151:21.02351%,-1.27613:18.156%,-0.23351:17.48715%,-0.33484:17.34916%,-0.24151:0.00055%,-71.33197:0.00055%,-1.27347:0.00037%,-0.08551:0.00037%,1.45709:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-49.275529999999996:0.00018%,-1.2708:0.00018%,-64.19493:0.00018%]
[INFO] ** scada_tag:[3:25.9807%,1:21.02333%,5:18.15581%,4:17.48696%,2:17.34897%,0:0.00422%]
[INFO] ** service:[0.0048200000000000005:99.9989%,-211.73542999999998:0.00055%,-186.43601999999998:0.00037%,-186.44547:0.00018%]
[INFO] ** src:[22:38.37267%,9:25.98162%,7:18.15655%,1:17.48788%,14:0.00055%,17:0.00018%,8:0.00018%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1480 (0.27158%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3287e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.1809e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-35-36-batch-0-100000
[INFO] processing batch 100000-200000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.4906e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1492e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-35-36-batch-100000-200000
[INFO] processing batch 200000-300000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.6126e-05 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.8249e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-35-36-batch-200000-300000
[INFO] processing batch 300000-400000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1161e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.8740e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-35-36-batch-300000-400000
[INFO] processing batch 400000-500000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7206e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.8940e-04 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 0.9999
[INFO] saving weights to checkpoints/lstm-epoch-10-files-35-36-batch-400000-500000
[INFO] processing batch 500000-600000/544966
[33m[INFO] loading file 37-37/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544966, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544966, 17)

[INFO] analyzing data
[INFO] 544966 rows
[INFO] ** appi_name:[21:99.9989%,30:0.00073%,26:0.00018%,9:0.00018%]
[INFO] ** classification:[normal:64.37943%,Single Stage Single Point:35.62057%]
[INFO] ** dst:[21:43.33518%,10:21.04241%,8:18.13581%,9:17.48458%,22:0.00073%,15:0.00073%,24:0.00018%,6:0.00018%,0:0.00018%]
[INFO] ** i/f_dir:[1:99.99963%,0:0.00037%]
[INFO] ** i/f_name:[2:99.99927%,3:0.00073%]
[INFO] ** modbus_function_code:[0.02961:99.9989%,-33.760870000000004:0.0011%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99872%,0:0.0011%]
[INFO] ** modbus_transaction_id:65536 (12.0257%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99908%,1:0.00073%,2:0.00018%]
[INFO] ** proxy_src_ip:[18:38.39139%,20:25.98658%,13:18.13599%,6:17.48458%,17:0.00073%,16:0.00037%,21:0.00018%,1:0.00018%]
[INFO] ** s_port:[1.45442:25.98602%,-0.32151:21.04241%,-1.27613:18.13563%,-0.23351:17.48439%,-0.33484:17.34897%,-71.33197:0.00073%,-1.02014:0.00037%,-71.14798:0.00018%,-1.27347:0.00018%,1.45709:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.2708:0.00018%,14.4699:0.00018%]
[INFO] ** scada_tag:[3:25.98584%,1:21.04241%,5:18.13544%,4:17.48421%,2:17.34879%,0:0.0033%]
[INFO] ** service:[0.0048200000000000005:99.9989%,-211.73542999999998:0.00073%,-183.8612:0.00018%,-211.08346:0.00018%]
[INFO] ** src:[22:38.39139%,9:25.98658%,7:18.13599%,1:17.48458%,14:0.00073%,15:0.00037%,4:0.00018%,3:0.00018%]
[INFO] ** type:[0:99.99963%,1:0.00037%]
[INFO] ** unixtime:1480 (0.27158%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7269e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0348e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-36-37-batch-0-100000
[INFO] processing batch 100000-200000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.1751e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0877e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-36-37-batch-100000-200000
[INFO] processing batch 200000-300000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.0188e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.5246e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-36-37-batch-200000-300000
[INFO] processing batch 300000-400000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.6636e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9309e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-36-37-batch-300000-400000
[INFO] processing batch 400000-500000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.6756e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.1830e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-36-37-batch-400000-500000
[INFO] processing batch 500000-600000/544966
[33m[INFO] loading file 38-38/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544966, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544966, 17)

[INFO] analyzing data
[INFO] 544966 rows
[INFO] ** appi_name:[21:99.99908%,30:0.00018%,26:0.00018%,17:0.00018%,12:0.00018%,0:0.00018%]
[INFO] ** classification:[normal:64.41264%,Single Stage Single Point:35.58736%]
[INFO] ** dst:[21:43.32197%,10:21.08866%,8:18.09507%,9:17.49247%,22:0.00092%,25:0.00018%,24:0.00018%,16:0.00018%,15:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99982%,0:0.00018%]
[INFO] ** i/f_name:[2:99.99982%,3:0.00018%]
[INFO] ** modbus_function_code:[0.02961:99.99908%,-33.760870000000004:0.00092%]
[INFO] ** modbus_function_description:[7:49.99963%,11:49.99945%,0:0.00092%]
[INFO] ** modbus_transaction_id:65536 (12.0257%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99945%,2:0.00037%,1:0.00018%]
[INFO] ** proxy_src_ip:[18:38.45946%,20:25.95171%,13:18.09489%,6:17.49283%,7:0.00037%,17:0.00018%,16:0.00018%,5:0.00018%,0:0.00018%]
[INFO] ** s_port:[1.45442:25.95098%,-0.32151:21.08847%,-1.27613:18.09471%,-0.23351:17.49228%,-0.33484:17.37099%,-0.24151:0.00037%,1.45709:0.00037%,-64.19493:0.00018%,10.192739999999999:0.00018%,-1.02014:0.00018%,-71.14798:0.00018%,-61.95768:0.00018%,-1.27347:0.00018%,1.47576:0.00018%,1.46509:0.00018%,-0.24950999999999998:0.00018%,-71.33197:0.00018%]
[INFO] ** scada_tag:[3:25.95061%,1:21.08847%,5:18.09471%,4:17.4921%,2:17.37099%,0:0.00312%]
[INFO] ** service:[0.0048200000000000005:99.99927%,-211.08346:0.00018%,-205.44247:0.00018%,-186.44547:0.00018%,-211.73542999999998:0.00018%]
[INFO] ** src:[22:38.45946%,9:25.95171%,7:18.09489%,1:17.49283%,21:0.00037%,16:0.00018%,15:0.00018%,14:0.00018%,8:0.00018%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1481 (0.27176%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.9185e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.7204e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-37-38-batch-0-100000
[INFO] processing batch 100000-200000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.3724e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.1532e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-37-38-batch-100000-200000
[INFO] processing batch 200000-300000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.9952e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3006e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-37-38-batch-200000-300000
[INFO] processing batch 300000-400000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.7253e-04 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2138e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-37-38-batch-300000-400000
[INFO] processing batch 400000-500000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0612e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.4244e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-37-38-batch-400000-500000
[INFO] processing batch 500000-600000/544966
[33m[INFO] loading file 39-39/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544966, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544966, 17)

[INFO] analyzing data
[INFO] 544966 rows
[INFO] ** appi_name:[21:100.0%]
[INFO] ** classification:[normal:64.41007%,Single Stage Single Point:35.58993%]
[INFO] ** dst:[21:43.32472%,10:21.08443%,8:18.1292%,9:17.46054%,22:0.00092%,24:0.00018%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:100.0%]
[INFO] ** modbus_function_description:[7:50.00018%,11:49.99982%]
[INFO] ** modbus_transaction_id:65536 (12.0257%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:100.0%]
[INFO] ** proxy_src_ip:[18:38.45561%,20:25.95391%,13:18.12939%,6:17.46054%,16:0.00055%]
[INFO] ** s_port:[1.45442:25.95336%,-0.32151:21.08443%,-1.27613:18.12902%,-0.23351:17.46036%,-0.33484:17.37118%,-1.02014:0.00055%,-1.27347:0.00018%,1.45709:0.00018%,1.46509:0.00018%,1.47576:0.00018%,-0.24151:0.00018%,-1.2708:0.00018%]
[INFO] ** scada_tag:[3:25.953%,1:21.08425%,5:18.12884%,4:17.46036%,2:17.37099%,0:0.00257%]
[INFO] ** service:[0.0048200000000000005:100.0%]
[INFO] ** src:[22:38.45561%,9:25.95391%,7:18.12939%,1:17.46054%,15:0.00055%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1479 (0.27139%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.7274e-05 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.6041e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-38-39-batch-0-100000
[INFO] processing batch 100000-200000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4359e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.8304e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-38-39-batch-100000-200000
[INFO] processing batch 200000-300000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.5256e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.3574e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-38-39-batch-200000-300000
[INFO] processing batch 300000-400000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7632e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.8980e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-38-39-batch-300000-400000
[INFO] processing batch 400000-500000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.6501e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.5174e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-38-39-batch-400000-500000
[INFO] processing batch 500000-600000/544966
[33m[INFO] loading file 40-40/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (544966, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (544966, 17)

[INFO] analyzing data
[INFO] 544966 rows
[INFO] ** appi_name:[21:99.99633%,30:0.00312%,31:0.00018%,27:0.00018%,26:0.00018%]
[INFO] ** classification:[normal:64.33851%,Single Stage Single Point:35.66149%]
[INFO] ** dst:[21:43.29408%,10:21.03948%,8:18.19325%,9:17.46843%,15:0.00312%,22:0.00092%,24:0.00018%,18:0.00018%,7:0.00018%,6:0.00018%]
[INFO] ** i/f_dir:[1:99.99706%,0:0.00294%]
[INFO] ** i/f_name:[2:99.99688%,3:0.00312%]
[INFO] ** modbus_function_code:[0.02961:99.99633%,-33.760870000000004:0.00367%]
[INFO] ** modbus_function_description:[7:49.99927%,11:49.99706%,0:0.00367%]
[INFO] ** modbus_transaction_id:65536 (12.0257%)
[INFO] ** orig:[0:99.99963%,1:0.00037%]
[INFO] ** proto:[0:99.99633%,1:0.00312%,2:0.00055%]
[INFO] ** proxy_src_ip:[18:38.35652%,20:25.97795%,13:18.19306%,6:17.4688%,17:0.00312%,14:0.00055%]
[INFO] ** s_port:[1.45442:25.97703%,-0.32151:21.03948%,-1.27613:18.19288%,-0.23351:17.46825%,-0.33484:17.31704%,-71.33197:0.00312%,1.45709:0.00055%,-0.24151:0.00037%,-71.14798:0.00018%,-1.27347:0.00018%,11.862:0.00018%,-0.24950999999999998:0.00018%,1.46509:0.00018%,1.47576:0.00018%,13.431270000000001:0.00018%]
[INFO] ** scada_tag:[3:25.97667%,1:21.03929%,5:18.19269%,4:17.46788%,2:17.31686%,0:0.00661%]
[INFO] ** service:[0.0048200000000000005:99.99633%,-211.73542999999998:0.00312%,-211.08346:0.00018%,-202.75898:0.00018%,-186.43601999999998:0.00018%]
[INFO] ** src:[22:38.35652%,9:25.97795%,7:18.19306%,1:17.4688%,14:0.00312%,2:0.00055%]
[INFO] ** type:[0:99.99908%,1:0.00092%]
[INFO] ** unixtime:1482 (0.27194%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.9528e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.6558e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-39-40-batch-0-100000
[INFO] processing batch 100000-200000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.9153e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.2282e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-39-40-batch-100000-200000
[INFO] processing batch 200000-300000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.4776e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.1408e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-39-40-batch-200000-300000
[INFO] processing batch 300000-400000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.4649e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6280e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-39-40-batch-300000-400000
[INFO] processing batch 400000-500000/544966
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.1848e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.8270e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-39-40-batch-400000-500000
[INFO] processing batch 500000-600000/544966
[33m[INFO] loading file 41-41/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (485124, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (485124, 17)

[INFO] analyzing data
[INFO] 485124 rows
[INFO] ** appi_name:[21:99.9965%,30:0.00103%,22:0.00082%,17:0.00082%,32:0.00021%,28:0.00021%,26:0.00021%,7:0.00021%]
[INFO] ** classification:[normal:64.38581%,Single Stage Single Point:35.61419%]
[INFO] ** dst:[21:43.32047%,10:21.06101%,8:18.14031%,9:17.47368%,16:0.00103%,15:0.00103%,6:0.00103%,22:0.00062%,24:0.00041%,17:0.00041%]
[INFO] ** i/f_dir:[1:99.99897%,0:0.00103%]
[INFO] ** i/f_name:[2:99.99897%,3:0.00103%]
[INFO] ** modbus_function_code:[0.02961:99.9965%,-33.760870000000004:0.0035%]
[INFO] ** modbus_function_description:[7:49.99897%,11:49.99753%,0:0.0035%]
[INFO] ** modbus_transaction_id:65536 (13.50912%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99773%,2:0.00124%,1:0.00103%]
[INFO] ** proxy_src_ip:[18:38.42997%,20:25.95172%,13:18.14052%,6:17.47388%,17:0.00103%,1:0.00082%,21:0.00041%,16:0.00041%,14:0.00041%,0:0.00041%,7:0.00021%,2:0.00021%]
[INFO] ** s_port:[1.45442:25.9513%,-0.32151:21.06101%,-1.27613:18.1399%,-0.23351:17.47347%,-0.33484:17.36896%,-71.33197:0.00103%,-71.14931:0.00082%,-1.02014:0.00041%,-1.27347:0.00041%,-71.14798:0.00021%,-0.24151:0.00021%,-58.035180000000004:0.00021%,-1.2708:0.00021%,-5.1466400000000005:0.00021%,1.47576:0.00021%,1.46509:0.00021%,-64.19226:0.00021%,-5.08665:0.00021%,-0.24950999999999998:0.00021%,2.05573:0.00021%,-43.76509:0.00021%,-58.032509999999995:0.00021%]
[INFO] ** scada_tag:[3:25.9511%,1:21.06101%,5:18.1399%,4:17.47326%,2:17.36896%,0:0.00577%]
[INFO] ** service:[0.0048200000000000005:99.9965%,-211.73542999999998:0.00103%,-205.44247:0.00082%,-211.08818:0.00082%,89.64175:0.00021%,-211.09762999999998:0.00021%,-211.08346:0.00021%,-185.9872:0.00021%]
[INFO] ** src:[22:38.42997%,9:25.95172%,7:18.14052%,1:17.47388%,14:0.00103%,3:0.00082%,15:0.00041%,8:0.00041%,4:0.00041%,2:0.00041%,21:0.00021%,17:0.00021%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1316 (0.27127%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/485124
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2717e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7551e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-40-41-batch-0-100000
[INFO] processing batch 100000-200000/485124
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.5338e-05 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.9588e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-40-41-batch-100000-200000
[INFO] processing batch 200000-300000/485124
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.7578e-05 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.6397e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-40-41-batch-200000-300000
[INFO] processing batch 300000-400000/485124
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.1940e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.6388e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-40-41-batch-300000-400000
[INFO] processing batch 400000-500000/485124
[33m[INFO] loading file 42-42/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (428638, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (428638, 17)

[INFO] analyzing data
[INFO] 428638 rows
[INFO] ** appi_name:[21:99.99207%,30:0.0021%,17:0.00117%,31:0.00093%,26:0.00093%,7:0.00093%,22:0.0007%,28:0.00023%,27:0.00023%,9:0.00023%,8:0.00023%,0:0.00023%]
[INFO] ** classification:[normal:64.38417%,Single Stage Single Point:35.61583%]
[INFO] ** dst:[21:43.32187%,10:21.05366%,8:18.16848%,9:17.44689%,16:0.0021%,6:0.00187%,18:0.00117%,22:0.00093%,2:0.00093%,15:0.0007%,17:0.00047%,25:0.00023%,24:0.00023%,7:0.00023%,0:0.00023%]
[INFO] ** i/f_dir:[1:99.9993%,0:0.0007%]
[INFO] ** i/f_name:[2:99.9993%,3:0.0007%]
[INFO] ** modbus_function_code:[0.02961:99.99207%,-33.760870000000004:0.00793%]
[INFO] ** modbus_function_description:[7:49.99697%,11:49.9951%,0:0.00793%]
[INFO] ** modbus_transaction_id:65536 (15.28936%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.9958%,2:0.0035%,1:0.0007%]
[INFO] ** proxy_src_ip:[18:38.4133%,20:25.96247%,13:18.16894%,6:17.44689%,17:0.0021%,1:0.0021%,14:0.0014%,21:0.00093%,7:0.0007%,16:0.00047%,0:0.00047%,2:0.00023%]
[INFO] ** s_port:[1.45442:25.962%,-0.32151:21.05366%,-1.27613:18.16848%,-0.23351:17.44666%,-0.33484:17.35964%,-71.14798:0.00093%,-71.14931:0.00093%,-71.33197:0.0007%,11.57001:0.00047%,-0.08551:0.00047%,-3.3787199999999995:0.00047%,-1.02014:0.00047%,-5.1466400000000005:0.00023%,-0.24151:0.00023%,13.431270000000001:0.00023%,0.31847:0.00023%,-1.2708:0.00023%,-58.035180000000004:0.00023%,7.66617:0.00023%,-64.19493:0.00023%,1.47576:0.00023%,14.4699:0.00023%,15.912510000000001:0.00023%,14.191239999999999:0.00023%,7.9608300000000005:0.00023%,-5.08665:0.00023%,10.192739999999999:0.00023%,-3.0613900000000003:0.00023%,1.45709:0.00023%,2.05573:0.00023%,-43.76509:0.00023%,11.862:0.00023%,-1.27347:0.00023%,-58.032509999999995:0.00023%]
[INFO] ** scada_tag:[3:25.96153%,1:21.05366%,5:18.16824%,4:17.44666%,2:17.3594%,0:0.0105%]
[INFO] ** service:[0.0048200000000000005:99.99207%,-211.09762999999998:0.00163%,-205.44247:0.00117%,-186.43601999999998:0.00117%,-211.08346:0.00093%,-211.08818:0.00093%,-211.73542999999998:0.0007%,-211.35747999999998:0.00047%,-186.44547:0.00023%,-183.8612:0.00023%,-185.9872:0.00023%,-202.75898:0.00023%]
[INFO] ** src:[22:38.4133%,9:25.96247%,7:18.16894%,1:17.44689%,3:0.0028%,2:0.00163%,4:0.00117%,21:0.00093%,14:0.0007%,15:0.00047%,8:0.00047%,17:0.00023%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1163 (0.27132%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/428638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.7264e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6033e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-41-42-batch-0-100000
[INFO] processing batch 100000-200000/428638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.7572e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.0582e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-41-42-batch-100000-200000
[INFO] processing batch 200000-300000/428638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.6778e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.2474e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-41-42-batch-200000-300000
[INFO] processing batch 300000-400000/428638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.9510e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.1631e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-41-42-batch-300000-400000
[INFO] processing batch 400000-500000/428638
[33m[INFO] loading file 43-43/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (528638, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (528638, 17)

[INFO] analyzing data
[INFO] 528638 rows
[INFO] ** appi_name:[21:99.99924%,30:0.00057%,26:0.00019%]
[INFO] ** classification:[normal:64.39984%,Single Stage Single Point:35.60016%]
[INFO] ** dst:[21:43.33154%,10:21.06659%,8:18.13074%,9:17.46923%,22:0.00095%,15:0.00057%,24:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99981%,0:0.00019%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99924%,-33.760870000000004:0.00076%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99905%,0:0.00076%]
[INFO] ** modbus_transaction_id:65536 (12.39714%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99924%,1:0.00057%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.41892%,20:25.97959%,13:18.13093%,6:17.46942%,17:0.00057%,16:0.00038%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.97903%,-0.32151:21.06659%,-1.27613:18.13055%,-0.23351:17.46904%,-0.33484:17.35233%,-71.33197:0.00057%,1.45709:0.00038%,-1.02014:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.97865%,1:21.06659%,5:18.13037%,4:17.46866%,2:17.35214%,0:0.00359%]
[INFO] ** service:[0.0048200000000000005:99.99924%,-211.73542999999998:0.00057%,-211.08346:0.00019%]
[INFO] ** src:[22:38.41892%,9:25.97959%,7:18.13093%,1:17.46942%,14:0.00057%,15:0.00038%,3:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1437 (0.27183%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.7198e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.2643e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-42-43-batch-0-100000
[INFO] processing batch 100000-200000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.0971e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3317e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-42-43-batch-100000-200000
[INFO] processing batch 200000-300000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.2453e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.9321e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-42-43-batch-200000-300000
[INFO] processing batch 300000-400000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.0760e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.0799e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-42-43-batch-300000-400000
[INFO] processing batch 400000-500000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.3798e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0353e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-42-43-batch-400000-500000
[INFO] processing batch 500000-600000/528638
[33m[INFO] loading file 44-44/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (528638, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (528638, 17)

[INFO] analyzing data
[INFO] 528638 rows
[INFO] ** appi_name:[21:99.99811%,30:0.00076%,31:0.00057%,0:0.00038%,22:0.00019%]
[INFO] ** classification:[normal:64.37089%,Single Stage Single Point:35.62911%]
[INFO] ** dst:[21:43.32303%,10:21.04465%,8:18.16479%,9:17.46412%,22:0.00113%,15:0.00076%,18:0.00057%,25:0.00038%,24:0.00038%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99924%,0:0.00076%]
[INFO] ** i/f_name:[2:99.99924%,3:0.00076%]
[INFO] ** modbus_function_code:[0.02961:99.99811%,-33.760870000000004:0.00189%]
[INFO] ** modbus_function_description:[7:50.00019%,11:49.99792%,0:0.00189%]
[INFO] ** modbus_transaction_id:65536 (12.39714%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99811%,2:0.00113%,1:0.00076%]
[INFO] ** proxy_src_ip:[18:38.41627%,20:25.95197%,13:18.16498%,6:17.46469%,17:0.00076%,7:0.00038%,16:0.00019%,5:0.00019%,2:0.00019%,1:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.95122%,-0.32151:21.04465%,-1.27613:18.16441%,-0.23351:17.46394%,-0.33484:17.37162%,-71.33197:0.00076%,-0.24151:0.00057%,-0.08551:0.00038%,-64.19493:0.00038%,-1.27347:0.00038%,1.45709:0.00038%,-1.02014:0.00019%,-1.2708:0.00019%,1.47576:0.00019%,-71.14931:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,4.42897:0.00019%]
[INFO] ** scada_tag:[3:25.95065%,1:21.04465%,5:18.16441%,4:17.46356%,2:17.37143%,0:0.0053%]
[INFO] ** service:[0.0048200000000000005:99.99811%,-211.73542999999998:0.00076%,-186.43601999999998:0.00057%,-186.44547:0.00038%,-211.08818:0.00019%]
[INFO] ** src:[22:38.41627%,9:25.95197%,7:18.16498%,1:17.46469%,14:0.00076%,21:0.00038%,17:0.00019%,16:0.00019%,15:0.00019%,8:0.00019%,3:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1434 (0.27126%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 7.9690e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2336e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-43-44-batch-0-100000
[INFO] processing batch 100000-200000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0407e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.0623e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-43-44-batch-100000-200000
[INFO] processing batch 200000-300000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 8.4147e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.6745e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-43-44-batch-200000-300000
[INFO] processing batch 300000-400000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 2.4465e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.2524e-04 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-43-44-batch-300000-400000
[INFO] processing batch 400000-500000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.3676e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4524e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-43-44-batch-400000-500000
[INFO] processing batch 500000-600000/528638
[33m[INFO] loading file 45-45/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (528638, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (528638, 17)

[INFO] analyzing data
[INFO] 528638 rows
[INFO] ** appi_name:[21:99.99905%,30:0.00057%,26:0.00019%,9:0.00019%]
[INFO] ** classification:[normal:64.41024%,Single Stage Single Point:35.58976%]
[INFO] ** dst:[21:43.32095%,10:21.08702%,8:18.12564%,9:17.46431%,22:0.00113%,15:0.00057%,6:0.00019%,0:0.00019%]
[INFO] ** i/f_dir:[1:99.99962%,0:0.00038%]
[INFO] ** i/f_name:[2:99.99943%,3:0.00057%]
[INFO] ** modbus_function_code:[0.02961:99.99905%,-33.760870000000004:0.00095%]
[INFO] ** modbus_function_description:[7:50.00038%,11:49.99868%,0:0.00095%]
[INFO] ** modbus_transaction_id:65536 (12.39714%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99924%,1:0.00057%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.4804%,20:25.92833%,13:18.12545%,6:17.4645%,17:0.00057%,16:0.00038%,21:0.00019%,1:0.00019%]
[INFO] ** s_port:[1.45442:25.92757%,-0.32151:21.08702%,-1.27613:18.12545%,-0.23351:17.46412%,-0.33484:17.39338%,1.45709:0.00057%,-71.33197:0.00057%,-1.02014:0.00038%,-71.14798:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,14.4699:0.00019%]
[INFO] ** scada_tag:[3:25.927%,1:21.08683%,5:18.12545%,4:17.46412%,2:17.39319%,0:0.0034%]
[INFO] ** service:[0.0048200000000000005:99.99905%,-211.73542999999998:0.00057%,-183.8612:0.00019%,-211.08346:0.00019%]
[INFO] ** src:[22:38.4804%,9:25.92833%,7:18.12545%,1:17.4645%,14:0.00057%,15:0.00038%,4:0.00019%,3:0.00019%]
[INFO] ** type:[0:99.99981%,1:0.00019%]
[INFO] ** unixtime:1435 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 8.0051e-05 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.4848e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-44-45-batch-0-100000
[INFO] processing batch 100000-200000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 8.8617e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 2.3487e-05 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-44-45-batch-100000-200000
[INFO] processing batch 200000-300000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 5.2641e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.7724e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-44-45-batch-200000-300000
[INFO] processing batch 300000-400000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.3714e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8729e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-44-45-batch-300000-400000
[INFO] processing batch 400000-500000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 4.4592e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3187e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-44-45-batch-400000-500000
[INFO] processing batch 500000-600000/528638
[33m[INFO] loading file 46-46/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (528638, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (528638, 17)

[INFO] analyzing data
[INFO] 528638 rows
[INFO] ** appi_name:[21:99.99811%,30:0.00113%,26:0.00019%,17:0.00019%,12:0.00019%,0:0.00019%]
[INFO] ** classification:[normal:64.42291%,Single Stage Single Point:35.57709%]
[INFO] ** dst:[21:43.34705%,10:21.07302%,8:18.10445%,9:17.47264%,22:0.00113%,15:0.00113%,25:0.00019%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99905%,0:0.00095%]
[INFO] ** i/f_name:[2:99.99887%,3:0.00113%]
[INFO] ** modbus_function_code:[0.02961:99.99811%,-33.760870000000004:0.00189%]
[INFO] ** modbus_function_description:[11:49.99905%,7:49.99905%,0:0.00189%]
[INFO] ** modbus_transaction_id:65536 (12.39714%)
[INFO] ** orig:[0:99.99962%,1:0.00038%]
[INFO] ** proto:[0:99.99849%,1:0.00113%,2:0.00038%]
[INFO] ** proxy_src_ip:[18:38.44635%,20:25.97373%,13:18.10445%,6:17.4732%,17:0.00113%,16:0.00038%,7:0.00038%,5:0.00019%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.97335%,-0.32151:21.07283%,-1.27613:18.10426%,-0.23351:17.47245%,-0.33484:17.37351%,-71.33197:0.00113%,-0.24151:0.00057%,-1.02014:0.00038%,-71.14798:0.00019%,1.45709:0.00019%,-0.24950999999999998:0.00019%,1.47576:0.00019%,-61.95768:0.00019%,-1.2708:0.00019%,10.192739999999999:0.00019%,-64.19493:0.00019%]
[INFO] ** scada_tag:[3:25.97297%,1:21.07264%,5:18.10407%,4:17.47207%,2:17.37351%,0:0.00473%]
[INFO] ** service:[0.0048200000000000005:99.9983%,-211.73542999999998:0.00113%,-211.08346:0.00019%,-205.44247:0.00019%,-186.44547:0.00019%]
[INFO] ** src:[22:38.44635%,9:25.97373%,7:18.10445%,1:17.4732%,14:0.00113%,21:0.00038%,15:0.00038%,16:0.00019%,8:0.00019%]
[INFO] ** type:[0:99.99905%,1:0.00095%]
[INFO] ** unixtime:1437 (0.27183%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.0991e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.4410e-04 - val_tp: 19998.0000 - val_fp: 2.0000 - val_tn: 79998.0000 - val_fn: 2.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-45-46-batch-0-100000
[INFO] processing batch 100000-200000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.0378e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.3231e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-45-46-batch-100000-200000
[INFO] processing batch 200000-300000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 4.9027e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 4.6036e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-45-46-batch-200000-300000
[INFO] processing batch 300000-400000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.5811e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.7856e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-45-46-batch-300000-400000
[INFO] processing batch 400000-500000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 9.9377e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1831e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-45-46-batch-400000-500000
[INFO] processing batch 500000-600000/528638
[33m[INFO] loading file 47-47/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (528638, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (528638, 17)

[INFO] analyzing data
[INFO] 528638 rows
[INFO] ** appi_name:[21:99.99943%,33:0.00019%,26:0.00019%,17:0.00019%]
[INFO] ** classification:[normal:64.39435%,Single Stage Single Point:35.60565%]
[INFO] ** dst:[21:43.30619%,10:21.08607%,8:18.1281%,9:17.47718%,22:0.0017%,24:0.00038%,16:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:100.0%]
[INFO] ** i/f_name:[2:100.0%]
[INFO] ** modbus_function_code:[0.02961:99.99943%,-33.760870000000004:0.00057%]
[INFO] ** modbus_function_description:[7:50.00132%,11:49.99811%,0:0.00057%]
[INFO] ** modbus_transaction_id:65536 (12.39714%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99981%,2:0.00019%]
[INFO] ** proxy_src_ip:[18:38.45656%,20:25.93646%,13:18.12847%,6:17.47756%,16:0.00038%,7:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.93552%,-0.32151:21.08607%,-1.27613:18.12791%,-0.23351:17.47699%,-0.33484:17.37049%,1.45709:0.00057%,-0.24151:0.00057%,-1.27347:0.00038%,-1.02014:0.00038%,-71.14798:0.00019%,-61.95635:0.00019%,1.46509:0.00019%,1.47576:0.00019%,-1.2708:0.00019%,10.192739999999999:0.00019%]
[INFO] ** scada_tag:[3:25.93495%,1:21.08588%,5:18.12772%,4:17.4768%,2:17.3703%,0:0.00435%]
[INFO] ** service:[0.0048200000000000005:99.99962%,-211.08346:0.00019%,-205.44247:0.00019%]
[INFO] ** src:[22:38.45656%,9:25.93646%,7:18.12847%,1:17.47756%,21:0.00038%,15:0.00038%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1435 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.2443e-05 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.3728e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-46-47-batch-0-100000
[INFO] processing batch 100000-200000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 5.8807e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.7256e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-46-47-batch-100000-200000
[INFO] processing batch 200000-300000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.8711e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.6235e-05 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-46-47-batch-200000-300000
[INFO] processing batch 300000-400000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1759e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.9295e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-46-47-batch-300000-400000
[INFO] processing batch 400000-500000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 6.8206e-07 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 6.3107e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-46-47-batch-400000-500000
[INFO] processing batch 500000-600000/528638
[33m[INFO] loading file 48-48/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (528638, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (528638, 17)

[INFO] analyzing data
[INFO] 528638 rows
[INFO] ** appi_name:[21:99.9966%,30:0.00265%,33:0.00019%,31:0.00019%,27:0.00019%,26:0.00019%]
[INFO] ** classification:[normal:64.41762%,Single Stage Single Point:35.58238%]
[INFO] ** dst:[21:43.33079%,10:21.08286%,8:18.11391%,9:17.4681%,15:0.00265%,22:0.00095%,24:0.00019%,18:0.00019%,7:0.00019%,6:0.00019%]
[INFO] ** i/f_dir:[1:99.99773%,0:0.00227%]
[INFO] ** i/f_name:[2:99.99735%,3:0.00265%]
[INFO] ** modbus_function_code:[0.02961:99.9966%,-33.760870000000004:0.0034%]
[INFO] ** modbus_function_description:[7:49.99887%,11:49.99773%,0:0.0034%]
[INFO] ** modbus_transaction_id:65536 (12.39714%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99678%,1:0.00265%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.45278%,20:25.96105%,13:18.11429%,6:17.4681%,17:0.00265%,14:0.00057%,16:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.96068%,-0.32151:21.08286%,-1.27613:18.11391%,-0.23351:17.46791%,-0.33484:17.36992%,-71.33197:0.00265%,-1.02014:0.00038%,-71.14798:0.00019%,-1.27347:0.00019%,11.862:0.00019%,1.45709:0.00019%,-61.95635:0.00019%,1.47576:0.00019%,-0.24151:0.00019%,13.431270000000001:0.00019%,-1.2708:0.00019%]
[INFO] ** scada_tag:[3:25.9603%,1:21.08286%,5:18.11391%,4:17.46791%,2:17.36973%,0:0.0053%]
[INFO] ** service:[0.0048200000000000005:99.99678%,-211.73542999999998:0.00265%,-211.08346:0.00019%,-202.75898:0.00019%,-186.43601999999998:0.00019%]
[INFO] ** src:[22:38.45278%,9:25.96105%,7:18.11429%,1:17.4681%,14:0.00265%,2:0.00057%,15:0.00038%,8:0.00019%]
[INFO] ** type:[0:99.99962%,1:0.00038%]
[INFO] ** unixtime:1434 (0.27126%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 1.1201e-04 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.7348e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-47-48-batch-0-100000
[INFO] processing batch 100000-200000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3014e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 9.8706e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-47-48-batch-100000-200000
[INFO] processing batch 200000-300000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.9209e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.6726e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-47-48-batch-200000-300000
[INFO] processing batch 300000-400000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0734e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.2799e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-47-48-batch-300000-400000
[INFO] processing batch 400000-500000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 9.9378e-05 - tp: 79998.0000 - fp: 2.0000 - tn: 319998.0000 - fn: 2.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.1425e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-47-48-batch-400000-500000
[INFO] processing batch 500000-600000/528638
[33m[INFO] loading file 49-49/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (528638, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (528638, 17)

[INFO] analyzing data
[INFO] 528638 rows
[INFO] ** appi_name:[21:99.99735%,30:0.00095%,17:0.00076%,22:0.00038%,28:0.00019%,26:0.00019%,7:0.00019%]
[INFO] ** classification:[normal:64.36862%,Single Stage Single Point:35.63138%]
[INFO] ** dst:[21:43.30336%,10:21.06092%,8:18.14153%,9:17.48985%,22:0.00132%,15:0.00095%,16:0.00076%,6:0.00057%,24:0.00038%,17:0.00038%]
[INFO] ** i/f_dir:[1:99.99905%,0:0.00095%]
[INFO] ** i/f_name:[2:99.99905%,3:0.00095%]
[INFO] ** modbus_function_code:[0.02961:99.99735%,-33.760870000000004:0.00265%]
[INFO] ** modbus_function_description:[7:49.99962%,11:49.99773%,0:0.00265%]
[INFO] ** modbus_transaction_id:65536 (12.39714%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99849%,1:0.00095%,2:0.00057%]
[INFO] ** proxy_src_ip:[18:38.42138%,20:25.94365%,13:18.14153%,6:17.49042%,17:0.00095%,1:0.00076%,21:0.00038%,16:0.00038%,14:0.00038%,0:0.00019%]
[INFO] ** s_port:[1.45442:25.94289%,-0.32151:21.06092%,-1.27613:18.14115%,-0.23351:17.48966%,-0.33484:17.36046%,-71.33197:0.00095%,-0.24151:0.00057%,-1.27347:0.00038%,-1.02014:0.00038%,1.45709:0.00038%,-71.14931:0.00038%,1.47576:0.00019%,1.46509:0.00019%,-0.24950999999999998:0.00019%,-5.1466400000000005:0.00019%,-58.035180000000004:0.00019%,-58.032509999999995:0.00019%,-43.76509:0.00019%,2.05573:0.00019%,-5.08665:0.00019%,-71.14798:0.00019%]
[INFO] ** scada_tag:[3:25.94252%,1:21.06073%,5:18.14096%,4:17.48928%,2:17.36046%,0:0.00605%]
[INFO] ** service:[0.0048200000000000005:99.99735%,-211.73542999999998:0.00095%,-205.44247:0.00076%,-211.08818:0.00038%,-211.09762999999998:0.00019%,-211.08346:0.00019%,-185.9872:0.00019%]
[INFO] ** src:[22:38.42138%,9:25.94365%,7:18.14153%,1:17.49042%,14:0.00095%,3:0.00076%,15:0.00038%,4:0.00038%,2:0.00038%,8:0.00019%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1435 (0.27145%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.1158e-05 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.5916e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-48-49-batch-0-100000
[INFO] processing batch 100000-200000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 6.3473e-05 - tp: 79997.0000 - fp: 3.0000 - tn: 319997.0000 - fn: 3.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 7.2608e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-48-49-batch-100000-200000
[INFO] processing batch 200000-300000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.6188e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.3041e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-48-49-batch-200000-300000
[INFO] processing batch 300000-400000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 2.1654e-05 - tp: 79999.0000 - fp: 1.0000 - tn: 319999.0000 - fn: 1.0000 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 3.8250e-04 - val_tp: 19999.0000 - val_fp: 1.0000 - val_tn: 79999.0000 - val_fn: 1.0000 - val_accuracy: 1.0000 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-48-49-batch-300000-400000
[INFO] processing batch 400000-500000/528638
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.3500e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0738e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-48-49-batch-400000-500000
[INFO] processing batch 500000-600000/528638
[33m[INFO] loading file 50-50/50 on epoch 10/10[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (378620, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] analyze dataset: (378620, 17)

[INFO] analyzing data
[INFO] 378620 rows
[INFO] ** appi_name:[21:99.99736%,30:0.00106%,7:0.00079%,31:0.00026%,22:0.00026%,8:0.00026%]
[INFO] ** classification:[normal:64.2956%,Single Stage Single Point:35.7044%]
[INFO] ** dst:[21:43.25181%,10:21.04062%,8:18.22725%,9:17.47689%,15:0.00106%,22:0.00053%,16:0.00053%,2:0.00053%,24:0.00026%,18:0.00026%,6:0.00026%]
[INFO] ** i/f_dir:[1:99.99894%,0:0.00106%]
[INFO] ** i/f_name:[2:99.99894%,3:0.00106%]
[INFO] ** modbus_function_code:[0.02961:99.99736%,-33.760870000000004:0.00264%]
[INFO] ** modbus_function_description:[11:49.99894%,7:49.99842%,0:0.00264%]
[INFO] ** modbus_transaction_id:65535 (17.30891%)
[INFO] ** orig:[0:100.0%]
[INFO] ** proto:[0:99.99842%,1:0.00106%,2:0.00053%]
[INFO] ** proxy_src_ip:[18:38.36115%,20:25.93154%,13:18.22751%,6:17.47689%,17:0.00106%,1:0.00079%,21:0.00026%,16:0.00026%,14:0.00026%,7:0.00026%]
[INFO] ** s_port:[1.45442:25.93101%,-0.32151:21.04062%,-1.27613:18.22698%,-0.23351:17.47689%,-0.33484:17.32053%,-71.33197:0.00106%,-3.3787199999999995:0.00026%,4.33564:0.00026%,15.912510000000001:0.00026%,7.9608300000000005:0.00026%,1.46509:0.00026%,1.45709:0.00026%,-1.27347:0.00026%,-71.14931:0.00026%,-1.02014:0.00026%,-1.2708:0.00026%,0.31847:0.00026%]
[INFO] ** scada_tag:[3:25.93075%,1:21.04036%,5:18.22672%,4:17.47689%,2:17.32027%,0:0.00502%]
[INFO] ** service:[0.0048200000000000005:99.99736%,-211.73542999999998:0.00106%,-211.09762999999998:0.00079%,-186.43601999999998:0.00026%,-211.35747999999998:0.00026%,-211.08818:0.00026%]
[INFO] ** src:[22:38.36115%,9:25.93154%,7:18.22751%,1:17.47689%,14:0.00106%,3:0.00079%,21:0.00026%,15:0.00026%,4:0.00026%,2:0.00026%]
[INFO] ** type:[0:100.0%]
[INFO] ** unixtime:1029 (0.27178%)
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/378620
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 1.0566e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 8.0175e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-49-50-batch-0-100000
[INFO] processing batch 100000-200000/378620
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 5s - loss: 3.7345e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 5.6607e-07 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-10-files-49-50-batch-100000-200000
[INFO] processing batch 200000-300000/378620
[INFO] breaking into predictors and prediction...
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 6s - loss: 9.9199e-06 - tp: 80000.0000 - fp: 0.0000e+00 - tn: 320000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 1.0177e-06 - val_tp: 20000.0000 - val_fp: 0.0000e+00 - val_tn: 80000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
Using TensorFlow backend.
train.py:159: FutureWarning: Sorting because non-concatenation axis is not aligned. A future version
of pandas will change to not sort by default.

To accept the future behavior, pass 'sort=False'.

To retain the current behavior and silence the warning, pass 'sort=True'.

  df = pd.concat(df_from_each_file, ignore_index=True)
[INFO] saving weights to checkpoints/lstm-epoch-10-files-49-50-batch-200000-300000
[INFO] processing batch 300000-400000/378620
2020-02-02 08:55:49.785328: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-02-02 08:55:49.801441: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fb4f0998cc0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-02-02 08:55:49.801475: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-02-02 08:55:52.887114: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-02 08:55:52.893171: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 08:55:52.895967: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 08:55:52.921275: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-02 08:55:52.923216: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_1_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-02 08:55:52.925295: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 08:55:52.927428: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-02 08:55:52.935855: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
Date: 2020-02-02 08:55:49.780691
[INFO] input_shape (10, 16)
[INFO] LSTM first and last layer neurons: 15
adding core layer 0
[INFO] created DNN
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2015-12-31_130240_112.log.part10_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1364 (0.2728%)
[INFO] ** orig:[0:99.9992%,1:0.0008%]
[INFO] ** type:[0:99.9984%,1:0.0014%,2:0.0002%]
[INFO] ** i/f_name:[2:99.9984%,3:0.0016%]
[INFO] ** i/f_dir:[1:99.9986%,0:0.0014%]
[INFO] ** src:[22:38.114%,9:26.0964%,7:18.2424%,1:17.543%,14:0.0016%,11:0.0012%,10:0.001%,15:0.0004%]
[INFO] ** dst:[21:43.3686%,10:20.8412%,8:18.2422%,9:17.5434%,15:0.0016%,22:0.0014%,6:0.0006%,25:0.0004%,24:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** proto:[0:99.997%,1:0.0016%,2:0.0014%]
[INFO] ** appi_name:[21:99.9962%,30:0.0016%,26:0.0004%,0:0.0004%,31:0.0002%,27:0.0002%,24:0.0002%,22:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.114%,20:26.0964%,13:18.2424%,6:17.543%,17:0.0016%,10:0.0012%,11:0.001%,16:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.9962%,-33.760870000000004:0.0036%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9988%,11:49.9974%,0:0.0036%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.0954%,1:20.841%,5:18.242%,4:17.5424%,2:17.2726%,0:0.0066%]
[INFO] ** service:[0.0048200000000000005:99.997%,-211.73542999999998:0.0016%,-186.44547:0.0004%,-211.08346:0.0004%,-186.43601999999998:0.0002%,-211.08818:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:26.0956%,-0.32151:20.8412%,-1.27613:18.242%,-0.23351:17.5424%,-0.33484:17.2728%,-71.33197:0.0016%,-9.54647:0.0008%,-0.24151:0.0006%,-64.19493:0.0004%,-1.02014:0.0004%,-71.14798:0.0004%,1.45709:0.0004%,-1.27347:0.0002%,1.46509:0.0002%,-68.79874000000001:0.0002%,-71.14931:0.0002%,-3.22139:0.0002%,-1.2708:0.0002%,1.47576:0.0002%]
[INFO] ** classification:[normal:79.7796%,Single Stage Single Point:20.2204%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7327352e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.7327352e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.7327352e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [-1.0388781e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.0388781e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0388781e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 1 1 ... 1 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.93463695e-01 6.53623557e-03 2.49519794e-10 2.94568885e-08
   3.18997662e-10]
  [1.00000000e+00 5.75989123e-09 6.54861704e-14 4.62807180e-12
   9.13102601e-14]
  [9.99973178e-01 2.68236618e-05 9.10008180e-13 8.21503542e-12
   1.09952542e-12]
  ...
  [9.99991059e-01 8.95373159e-06 8.37813488e-13 9.37897329e-12
   1.32266431e-12]
  [9.99998212e-01 1.82466158e-06 1.66701586e-13 1.31408881e-12
   4.23799830e-13]
  [9.99998331e-01 1.65409335e-06 6.95083097e-13 7.80314702e-12
   1.17890821e-12]]

 [[9.99996662e-01 3.36697713e-06 1.05961464e-12 2.93704124e-11
   1.55123993e-12]
  [1.00000000e+00 3.32090409e-08 4.57411344e-14 6.29534792e-12
   4.95081711e-14]
  [9.99997020e-01 2.95281939e-06 7.04849428e-13 1.50725300e-11
   1.13866284e-12]
  ...
  [9.98917580e-01 1.08249881e-03 3.16222395e-12 1.04386794e-11
   7.96672450e-12]
  [9.99998927e-01 1.11590259e-06 3.47110307e-13 3.97733452e-12
   6.46634710e-13]
  [1.00000000e+00 3.44466820e-08 3.28904757e-14 1.19192666e-12
   6.38570346e-14]]

 [[9.99981761e-01 1.82171152e-05 2.19513578e-12 7.75256803e-11
   2.97040929e-12]
  [9.99999881e-01 1.43380902e-07 2.08715640e-13 1.24986532e-11
   2.32571937e-13]
  [9.99934912e-01 6.50301445e-05 1.23513125e-12 7.79838260e-12
   1.84869568e-12]
  ...
  [9.99996066e-01 3.90115065e-06 6.77228727e-13 7.80057009e-12
   8.90489017e-13]
  [9.99999762e-01 2.01322237e-07 6.53489036e-14 1.08064480e-12
   1.45543096e-13]
  [1.00000000e+00 3.43861579e-08 5.24386714e-14 3.19244544e-12
   7.78961991e-14]]

 ...

 [[9.99999404e-01 6.23735048e-07 2.60374187e-13 5.15125919e-12
   4.26946672e-13]
  [9.99999523e-01 4.29654051e-07 9.48647411e-13 5.41721841e-11
   9.18440562e-13]
  [9.99970555e-01 2.94919428e-05 1.39855879e-12 2.07294980e-11
   1.52496440e-12]
  ...
  [9.99999881e-01 7.03875216e-08 6.25338336e-14 1.60058447e-12
   1.36218050e-13]
  [9.99992609e-01 7.34447985e-06 1.50323775e-12 2.40061096e-11
   2.30442466e-12]
  [9.99999523e-01 4.53203938e-07 9.20407685e-14 1.00181473e-12
   2.10623145e-13]]

 [[9.92937624e-01 7.06235366e-03 1.68193043e-10 1.60820814e-08
   2.09730053e-10]
  [1.00000000e+00 5.75508423e-08 1.93951233e-13 9.16165147e-12
   2.14364876e-13]
  [9.99972939e-01 2.70512119e-05 3.55859575e-13 3.24809732e-12
   5.42901607e-13]
  ...
  [9.99999881e-01 1.77720850e-07 1.05240273e-13 3.16277148e-12
   2.10241912e-13]
  [9.99999762e-01 2.63042381e-07 1.75501581e-13 3.20175613e-12
   2.98768361e-13]
  [9.99991775e-01 8.25282677e-06 9.80150531e-13 1.12420741e-11
   1.85426761e-12]]

 [[9.99999404e-01 6.25645669e-07 2.60711618e-13 5.16022771e-12
   4.27562770e-13]
  [9.99999523e-01 4.29890974e-07 9.50708804e-13 5.42359734e-11
   9.20274707e-13]
  [9.99963164e-01 3.68269866e-05 1.37386749e-12 1.44596071e-11
   1.77564278e-12]
  ...
  [9.99999046e-01 9.36708489e-07 4.12331112e-13 8.47693356e-12
   5.77912067e-13]
  [9.99999762e-01 2.09478600e-07 1.04732636e-13 1.85705726e-12
   2.04781396e-13]
  [9.99991655e-01 8.38814685e-06 1.39321280e-12 1.87415517e-11
   2.37797195e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.93463695e-01 6.53623557e-03 2.49519794e-10 2.94568885e-08
  3.18997662e-10]
 [1.00000000e+00 5.75989123e-09 6.54861704e-14 4.62807180e-12
  9.13102601e-14]
 [9.99973178e-01 2.68236618e-05 9.10008180e-13 8.21503542e-12
  1.09952542e-12]
 ...
 [9.99999046e-01 9.36708489e-07 4.12331112e-13 8.47693356e-12
  5.77912067e-13]
 [9.99999762e-01 2.09478600e-07 1.04732636e-13 1.85705726e-12
  2.04781396e-13]
 [9.99991655e-01 8.38814685e-06 1.39321280e-12 1.87415517e-11
  2.37797195e-12]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  4.063577561187744
tp :  64254.0
fp :  35746.0
tn :  364254.0
fn :  35746.0
accuracy :  0.8570170402526855
precision :  0.6425399780273438
recall :  0.6425399780273438
auc :  0.7795974612236023

y_eval {0: 64261, 1: 35739}
pred {0: 99993, 1: 7}
[INFO] confusion matrix for file 
[[64254     7     0     0     0]
 [35739     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[64254     7     0     0     0]
 [35739     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0388781e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.0388781e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0388781e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-3.4502095e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-3.4502095e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-3.4502095e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 1 1] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99911785e-01 8.81812375e-05 1.16005972e-11 9.40177269e-10
   1.19509558e-11]
  [9.99999881e-01 1.07785425e-07 1.04781608e-13 1.06501639e-11
   1.04334882e-13]
  [9.99966860e-01 3.31776646e-05 9.37485983e-13 1.09264308e-11
   1.70137992e-12]
  ...
  [9.99997735e-01 2.22295239e-06 2.18089286e-13 1.57868434e-12
   3.63494797e-13]
  [9.98662710e-01 1.33730739e-03 1.26789620e-11 1.15974320e-10
   2.19311964e-11]
  [9.99991059e-01 8.98720737e-06 4.81678662e-13 2.14097468e-12
   1.05550985e-12]]

 [[9.99983072e-01 1.69151554e-05 2.61910675e-12 7.59676003e-11
   3.77939130e-12]
  [9.99998331e-01 1.68632971e-06 1.10142743e-12 2.27372426e-11
   1.24721468e-12]
  [9.99566734e-01 4.33208363e-04 4.07701130e-12 3.40757700e-11
   7.56274817e-12]
  ...
  [9.99997616e-01 2.35960920e-06 4.62684090e-13 3.88599526e-12
   8.01840853e-13]
  [9.99975920e-01 2.40968420e-05 1.03228905e-12 7.63644790e-12
   1.20018351e-12]
  [9.99992013e-01 7.95712276e-06 1.20130834e-13 8.90891473e-13
   2.88708158e-13]]

 [[9.99997139e-01 2.83199415e-06 1.34434727e-12 4.53035595e-11
   1.91323346e-12]
  [1.00000000e+00 6.72180400e-09 2.27264937e-14 5.61215701e-12
   2.43428426e-14]
  [9.99932408e-01 6.75369665e-05 3.97752491e-12 7.41251158e-11
   7.29433181e-12]
  ...
  [9.99896884e-01 1.03098871e-04 1.56493904e-12 7.31088367e-12
   1.98670052e-12]
  [9.99990225e-01 9.75062085e-06 2.48675592e-13 8.20014250e-13
   5.75980127e-13]
  [9.99957085e-01 4.29395805e-05 2.26137685e-12 1.92557567e-11
   2.54329587e-12]]

 ...

 [[9.97840524e-01 2.15945742e-03 9.41667924e-11 1.15501626e-08
   1.17517024e-10]
  [9.99999762e-01 2.11420158e-07 4.32531913e-13 1.73106772e-11
   4.23280226e-13]
  [9.99853849e-01 1.46084436e-04 1.33916196e-12 4.65670254e-12
   1.65247763e-12]
  ...
  [9.99996424e-01 3.57068211e-06 7.86432876e-13 6.70596781e-12
   1.41484632e-12]
  [9.99986529e-01 1.35263772e-05 4.14478564e-13 2.41721834e-12
   6.18603964e-13]
  [9.92985308e-01 7.01464806e-03 1.49521801e-11 3.40551441e-11
   1.78489879e-11]]

 [[9.99930382e-01 6.95821218e-05 4.18010591e-12 1.86402394e-10
   5.18569172e-12]
  [1.00000000e+00 5.22365831e-08 7.60483527e-14 9.33801994e-12
   9.22462586e-14]
  [9.99039173e-01 9.60881473e-04 3.58098794e-11 4.51946203e-10
   6.59633875e-11]
  ...
  [9.99695301e-01 3.04702175e-04 2.38682641e-12 1.27877136e-11
   4.78754232e-12]
  [9.99995232e-01 4.78239826e-06 4.92452054e-13 3.14866037e-12
   9.52338035e-13]
  [9.99999881e-01 6.65988722e-08 5.51507692e-14 1.49262590e-12
   1.06083084e-13]]

 [[9.99999166e-01 8.28073780e-07 3.25498417e-13 7.67040598e-12
   5.38126022e-13]
  [1.00000000e+00 4.18646948e-08 1.66575385e-13 2.66965929e-11
   1.65042825e-13]
  [9.94193733e-01 5.80624677e-03 3.66688034e-11 6.74148348e-10
   6.09052461e-11]
  ...
  [9.99998808e-01 1.15029559e-06 1.46217429e-13 1.95116904e-12
   2.41770769e-13]
  [9.99998569e-01 1.44693854e-06 2.38615144e-13 2.33386726e-12
   3.67913165e-13]
  [9.99968529e-01 3.15096040e-05 8.20844586e-13 5.38105715e-12
   1.07348668e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.99911785e-01 8.81812375e-05 1.16005972e-11 9.40177269e-10
  1.19509558e-11]
 [9.99999881e-01 1.07785425e-07 1.04781608e-13 1.06501639e-11
  1.04334882e-13]
 [9.99966860e-01 3.31776646e-05 9.37485983e-13 1.09264308e-11
  1.70137992e-12]
 ...
 [9.99998808e-01 1.15029559e-06 1.46217429e-13 1.95116904e-12
  2.41770769e-13]
 [9.99998569e-01 1.44693854e-06 2.38615144e-13 2.33386726e-12
  3.67913165e-13]
 [9.99968529e-01 3.15096040e-05 8.20844586e-13 5.38105715e-12
  1.07348668e-12]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  4.218117054748535
tp :  64221.0
fp :  35779.0
tn :  364221.0
fn :  35779.0
accuracy :  0.8568848967552185
precision :  0.6422100067138672
recall :  0.6422100067138672
auc :  0.7784992456436157

y_eval {0: 64231, 1: 35769}
pred {0: 99984, 1: 16}
[INFO] confusion matrix for file 
[[64218    13     0     0     0]
 [35766     3     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[128472     20      0      0      0]
 [ 71505      3      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4502095e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-3.4502095e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-3.4502095e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 ...
 [ 3.4629455e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 3.4629455e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 3.4629455e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 1 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99930978e-01 6.90289526e-05 4.16929512e-12 1.85874940e-10
   5.17375075e-12]
  [9.99995947e-01 4.09336417e-06 3.95769268e-12 9.98032074e-11
   3.44531760e-12]
  [9.96958852e-01 3.04116146e-03 5.16526362e-12 2.26174739e-11
   1.07754005e-11]
  ...
  [9.99999762e-01 2.66035698e-07 1.38715130e-13 2.33389675e-12
   2.37970044e-13]
  [9.99933362e-01 6.65976549e-05 4.89379717e-12 6.00744454e-11
   5.33846405e-12]
  [9.99999523e-01 4.27212768e-07 2.63480000e-14 4.10936937e-13
   6.97102966e-14]]

 [[9.99997735e-01 2.23148459e-06 8.04429765e-13 2.22062854e-11
   1.23979017e-12]
  [1.00000000e+00 1.45303307e-08 6.34297438e-14 1.26416924e-11
   6.46453851e-14]
  [9.99998689e-01 1.28478166e-06 5.42232546e-13 9.04332165e-12
   6.77313186e-13]
  ...
  [1.00000000e+00 1.09919647e-08 3.24553752e-14 1.75230783e-12
   6.35920624e-14]
  [9.99999642e-01 3.54927579e-07 4.12770458e-13 7.93659843e-12
   6.19042903e-13]
  [9.99999762e-01 2.76682186e-07 1.38397472e-13 2.37967892e-12
   2.53498584e-13]]

 [[9.99997735e-01 2.22889616e-06 8.01391451e-13 2.21014925e-11
   1.23580963e-12]
  [9.99999642e-01 3.02830927e-07 8.17149137e-13 8.69413777e-11
   8.11839257e-13]
  [9.99983191e-01 1.67909511e-05 1.64547819e-13 1.52471904e-12
   3.01923308e-13]
  ...
  [1.00000000e+00 1.26856232e-08 5.28628587e-14 2.29756448e-12
   9.67992708e-14]
  [9.99998450e-01 1.52205337e-06 1.07419477e-12 1.64935114e-11
   1.69972760e-12]
  [9.99999881e-01 7.97342636e-08 6.86943924e-14 1.65952625e-12
   1.24949706e-13]]

 ...

 [[9.99997377e-01 2.62054118e-06 1.34655449e-12 4.54485373e-11
   1.97358254e-12]
  [9.99999881e-01 7.52710463e-08 2.91699417e-13 2.10645546e-11
   3.02215853e-13]
  [9.99969721e-01 3.03366178e-05 2.73678459e-13 3.32162639e-12
   5.69096311e-13]
  ...
  [9.99999285e-01 7.17211151e-07 6.63177629e-13 1.09863021e-11
   1.09135118e-12]
  [9.99999523e-01 4.71471964e-07 1.00396803e-13 2.08771000e-12
   1.56270667e-13]
  [9.99997616e-01 2.32502839e-06 5.40361159e-13 4.68329368e-12
   1.01400474e-12]]

 [[9.99997377e-01 2.61408150e-06 1.34418854e-12 4.53437704e-11
   1.97067102e-12]
  [9.99999881e-01 7.52576952e-08 2.92017306e-13 2.10829635e-11
   3.02507666e-13]
  [9.99953389e-01 4.66152378e-05 1.11196783e-12 6.70958124e-12
   1.69647369e-12]
  ...
  [9.99995470e-01 4.47246657e-06 6.32488745e-13 4.06244005e-12
   1.24074069e-12]
  [9.99999881e-01 7.62048202e-08 7.33936431e-14 1.75208708e-12
   1.35926331e-13]
  [9.99971509e-01 2.84666930e-05 2.54658469e-12 3.40685744e-11
   2.93963378e-12]]

 [[9.99997973e-01 2.07114476e-06 1.06254654e-12 3.38277566e-11
   1.56141788e-12]
  [9.99999881e-01 7.67355814e-08 3.33573745e-13 2.76397065e-11
   3.41673114e-13]
  [9.93565857e-01 6.43415097e-03 7.71807444e-12 9.21134419e-11
   1.69287431e-11]
  ...
  [9.99697328e-01 3.02691624e-04 2.47708798e-12 1.74154389e-11
   4.44541366e-12]
  [9.99986649e-01 1.33732929e-05 7.26083852e-13 3.63391110e-12
   1.47822499e-12]
  [9.99999881e-01 9.02613593e-08 5.82321599e-14 1.47310506e-12
   1.10324103e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.99930978e-01 6.90289526e-05 4.16929512e-12 1.85874940e-10
  5.17375075e-12]
 [9.99995947e-01 4.09336417e-06 3.95769268e-12 9.98032074e-11
  3.44531760e-12]
 [9.96958852e-01 3.04116146e-03 5.16526362e-12 2.26174739e-11
  1.07754005e-11]
 ...
 [9.99697328e-01 3.02691624e-04 2.47708798e-12 1.74154389e-11
  4.44541366e-12]
 [9.99986649e-01 1.33732929e-05 7.26083852e-13 3.63391110e-12
  1.47822499e-12]
 [9.99999881e-01 9.02613593e-08 5.82321599e-14 1.47310506e-12
  1.10324103e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  3.580427173781395
tp :  70388.0
fp :  29612.0
tn :  370388.0
fn :  29612.0
accuracy :  0.8815527558326721
precision :  0.7038800120353699
recall :  0.7038800120353699
auc :  0.8155654072761536

y_eval {0: 70406, 1: 29594}
pred {0: 99982, 1: 18}
[INFO] confusion matrix for file 
[[70388    18     0     0     0]
 [29594     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[198860     38      0      0      0]
 [101099      3      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 0.34629455  0.          0.         ...  4.          0.00482
  -0.23351   ]
 [ 0.34629455  0.          0.         ...  3.          0.00482
   1.45442   ]
 [ 0.34629455  0.          0.         ...  2.          0.00482
  -0.33484   ]
 ...
 [ 1.03761     0.          0.         ...  1.          0.00482
  -0.32151   ]
 [ 1.03761     0.          0.         ...  2.          0.00482
  -0.33484   ]
 [ 1.03761     0.          0.         ...  3.          0.00482
   1.45442   ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99997377e-01 2.60100364e-06 1.33937718e-12 4.51311662e-11
   1.96473371e-12]
  [1.00000000e+00 5.65387381e-09 2.35942518e-14 5.79909298e-12
   2.52928595e-14]
  [9.97106493e-01 2.89348816e-03 3.92841593e-11 7.81482712e-10
   7.22613774e-11]
  ...
  [9.99989390e-01 1.05636082e-05 1.05745881e-12 1.59881101e-11
   1.78152089e-12]
  [9.99953270e-01 4.66859674e-05 4.71612679e-12 5.87164692e-11
   6.71955720e-12]
  [9.99999762e-01 2.46189728e-07 9.22897080e-14 1.13855301e-12
   1.63799651e-13]]

 [[9.99954462e-01 4.55643749e-05 1.11869619e-11 1.12173992e-09
   1.07325321e-11]
  [9.99999642e-01 3.68715519e-07 4.58386096e-13 2.70100383e-11
   3.75924986e-13]
  [9.99953985e-01 4.60515803e-05 2.53915216e-13 1.67624335e-12
   4.59690771e-13]
  ...
  [9.99999285e-01 6.99576788e-07 2.28113481e-13 2.56213930e-12
   4.24091372e-13]
  [9.99915838e-01 8.41791043e-05 1.67977351e-12 1.47155552e-11
   3.15965396e-12]
  [9.94769275e-01 5.23071177e-03 4.16489898e-11 2.65108102e-10
   5.62359742e-11]]

 [[9.99905467e-01 9.45731226e-05 5.03461639e-12 2.38279951e-10
   6.08935341e-12]
  [9.99999285e-01 7.59721672e-07 1.03515037e-12 2.79832130e-11
   1.16314293e-12]
  [9.99984264e-01 1.57250506e-05 1.51858810e-12 1.41877265e-11
   2.56878980e-12]
  ...
  [9.99999404e-01 6.13968950e-07 2.17392741e-13 6.51475835e-12
   2.97510416e-13]
  [9.99999404e-01 5.60801084e-07 2.03841379e-13 2.63933927e-12
   4.02711257e-13]
  [9.99995470e-01 4.56998669e-06 8.62107206e-13 1.24082420e-11
   1.41422453e-12]]

 ...

 [[9.99792397e-01 2.07576086e-04 7.44538892e-12 3.83963722e-10
   8.94201900e-12]
  [9.99999881e-01 1.35751080e-07 2.09659655e-13 1.30340782e-11
   2.39180041e-13]
  [9.99982953e-01 1.70877156e-05 8.21755641e-13 1.32111362e-11
   1.51571550e-12]
  ...
  [9.99989986e-01 1.00411098e-05 5.83828558e-13 3.88996951e-12
   8.00141962e-13]
  [9.99996066e-01 3.95533971e-06 1.85646867e-13 1.51192676e-12
   3.99628600e-13]
  [9.99999762e-01 1.87768606e-07 1.12251401e-13 1.69928242e-12
   2.27855278e-13]]

 [[9.99997973e-01 1.98947282e-06 1.04851826e-12 3.28644993e-11
   1.58622442e-12]
  [1.00000000e+00 8.31264657e-09 3.46412081e-14 7.96016031e-12
   3.63537020e-14]
  [9.99997139e-01 2.89646141e-06 4.95064493e-13 4.67143511e-12
   7.14890386e-13]
  ...
  [9.99997854e-01 2.19913386e-06 1.84561906e-13 2.28063662e-12
   3.08326986e-13]
  [9.99996543e-01 3.40583370e-06 6.43747479e-13 5.20171710e-12
   1.22950023e-12]
  [9.99999881e-01 1.47793401e-07 1.17099866e-13 2.36222825e-12
   2.12391790e-13]]

 [[9.99999166e-01 7.96289953e-07 4.41125679e-13 1.09978103e-11
   6.61058448e-13]
  [9.99999881e-01 6.96043827e-08 1.10515336e-13 4.47553002e-11
   1.27632049e-13]
  [9.99996662e-01 3.35863547e-06 3.41368481e-13 6.74465692e-12
   6.01272558e-13]
  ...
  [9.99998808e-01 1.17885622e-06 5.45310867e-13 6.07714616e-12
   8.94891203e-13]
  [9.99996662e-01 3.37906226e-06 4.19850352e-13 2.65727392e-12
   7.63237997e-13]
  [9.99999762e-01 2.65561937e-07 1.70114289e-13 3.01695886e-12
   2.93014826e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999738e-01 2.6010036e-06 1.3393772e-12 4.5131166e-11 1.9647337e-12]
 [1.0000000e+00 5.6538738e-09 2.3594252e-14 5.7990930e-12 2.5292860e-14]
 [9.9710649e-01 2.8934882e-03 3.9284159e-11 7.8148271e-10 7.2261377e-11]
 ...
 [9.9999881e-01 1.1788562e-06 5.4531087e-13 6.0771462e-12 8.9489120e-13]
 [9.9999666e-01 3.3790623e-06 4.1985035e-13 2.6572739e-12 7.6323800e-13]
 [9.9999976e-01 2.6556194e-07 1.7011429e-13 3.0169589e-12 2.9301483e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0014426992580294608
tp :  99976.0
fp :  24.0
tn :  399976.0
fn :  24.0
accuracy :  0.9999039769172668
precision :  0.9997599720954895
recall :  0.9997599720954895
auc :  0.9999998807907104

y_eval {0: 100000}
pred {0: 99976, 1: 24}
[INFO] confusion matrix for file 
[[99976    24     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[298836     62      0      0      0]
 [101099      3      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0376101e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.0376101e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0376101e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [ 1.7314672e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.7314672e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.7314672e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99999166e-01 7.96952463e-07 4.40078556e-13 1.09524065e-11
   6.59915807e-13]
  [1.00000000e+00 1.79130204e-08 5.93468349e-14 2.25999601e-11
   6.44090765e-14]
  [9.99981403e-01 1.86322286e-05 8.39712360e-13 7.34717669e-12
   1.07947754e-12]
  ...
  [9.99999881e-01 5.96505814e-08 3.57556968e-14 7.43668256e-13
   8.14432140e-14]
  [9.99999285e-01 6.85173461e-07 5.00113622e-13 6.98622236e-12
   8.10619638e-13]
  [9.99998212e-01 1.80151972e-06 3.80714259e-13 3.18585804e-12
   6.83503167e-13]]

 [[9.99794185e-01 2.05890770e-04 7.42403274e-12 3.82798071e-10
   8.92150676e-12]
  [9.99995708e-01 4.24571317e-06 3.24077614e-12 9.05127223e-11
   2.68513011e-12]
  [9.99989152e-01 1.08571649e-05 5.25986047e-13 3.33625033e-12
   9.75503966e-13]
  ...
  [9.99999881e-01 1.30145665e-07 9.11774589e-14 2.35044861e-12
   1.79128685e-13]
  [9.99999166e-01 8.82452241e-07 6.58842989e-13 9.71175657e-12
   1.08501446e-12]
  [9.99999881e-01 1.28047816e-07 8.03186253e-14 1.63681698e-12
   1.49148692e-13]]

 [[9.97117281e-01 2.88268970e-03 7.37415337e-11 6.90740709e-09
   8.81954718e-11]
  [9.99997020e-01 2.92089362e-06 1.20065991e-12 2.66725930e-11
   1.11186147e-12]
  [9.99375761e-01 6.24240551e-04 6.26152515e-12 2.77658695e-11
   6.71661121e-12]
  ...
  [1.00000000e+00 6.49506982e-09 3.24551888e-14 1.88770223e-12
   6.52921049e-14]
  [9.99999642e-01 3.37466190e-07 4.39863098e-13 8.74527447e-12
   6.61670588e-13]
  [9.99999046e-01 9.89309456e-07 1.58448965e-13 1.44573600e-12
   3.21330907e-13]]

 ...

 [[9.99998808e-01 1.15855494e-06 4.57790706e-13 1.03330209e-11
   6.88698827e-13]
  [9.99999762e-01 2.95740875e-07 6.78244678e-13 5.22307128e-11
   7.23127450e-13]
  [9.99999285e-01 6.82812754e-07 1.25934650e-13 3.06705811e-12
   2.03318319e-13]
  ...
  [9.99999881e-01 1.47641686e-07 2.21406308e-13 5.51334672e-12
   3.60990263e-13]
  [9.99999642e-01 3.57140721e-07 1.74500198e-13 2.99981329e-12
   2.97441271e-13]
  [9.99999523e-01 5.01392776e-07 3.08238136e-13 4.89839853e-12
   5.42966767e-13]]

 [[9.99832630e-01 1.67328690e-04 7.19978114e-12 4.33554637e-10
   8.19419619e-12]
  [9.99999881e-01 1.07375243e-07 3.77731971e-13 3.17222221e-11
   4.24295500e-13]
  [9.99996424e-01 3.53778296e-06 2.30389628e-13 3.65638292e-12
   3.41106754e-13]
  ...
  [9.99999285e-01 7.13569989e-07 3.02623459e-13 4.52807410e-12
   5.60731420e-13]
  [9.99953389e-01 4.66317324e-05 1.93420301e-12 1.35889824e-11
   2.20284945e-12]
  [9.99970794e-01 2.91537781e-05 5.07780124e-13 3.43373073e-12
   1.09478919e-12]]

 [[9.99999762e-01 2.08331855e-07 3.83364347e-13 1.01890848e-11
   6.88752061e-13]
  [9.99999642e-01 3.67070044e-07 6.19393696e-13 3.91292901e-11
   6.38154026e-13]
  [9.99998450e-01 1.49151288e-06 1.50639429e-13 3.96281662e-12
   2.62863434e-13]
  ...
  [9.84731793e-01 1.52681805e-02 1.57599697e-11 3.85838653e-11
   3.24488179e-11]
  [9.99999166e-01 8.36969150e-07 1.39794467e-13 1.23352489e-12
   2.81429014e-13]
  [9.99999642e-01 3.22752840e-07 4.82393531e-13 1.02054606e-11
   7.75286194e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.99999166e-01 7.96952463e-07 4.40078556e-13 1.09524065e-11
  6.59915807e-13]
 [1.00000000e+00 1.79130204e-08 5.93468349e-14 2.25999601e-11
  6.44090765e-14]
 [9.99981403e-01 1.86322286e-05 8.39712360e-13 7.34717669e-12
  1.07947754e-12]
 ...
 [9.84731793e-01 1.52681805e-02 1.57599697e-11 3.85838653e-11
  3.24488179e-11]
 [9.99999166e-01 8.36969150e-07 1.39794467e-13 1.23352489e-12
  2.81429014e-13]
 [9.99999642e-01 3.22752840e-07 4.82393531e-13 1.02054606e-11
  7.75286194e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0021212724920362234
tp :  99962.0
fp :  38.0
tn :  399962.0
fn :  38.0
accuracy :  0.9998480677604675
precision :  0.9996200203895569
recall :  0.9996200203895569
auc :  0.9999933838844299

y_eval {0: 100000}
pred {0: 99962, 1: 38}
[INFO] confusion matrix for file 
[[99962    38     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[398798    100      0      0      0]
 [101099      3      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2015-12-31_181648_113.log.part08_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1370 (0.274%)
[INFO] ** orig:[0:99.9948%,2:0.0052%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9948%,3:0.0052%]
[INFO] ** i/f_dir:[1:99.9948%,0:0.0052%]
[INFO] ** src:[22:38.4402%,9:25.9738%,7:18.1202%,1:17.4598%,21:0.0052%,2:0.0004%,15:0.0002%,11:0.0002%]
[INFO] ** dst:[21:43.345%,10:21.0682%,8:18.1202%,9:17.4594%,15:0.0052%,22:0.0012%,19:0.0004%,26:0.0002%,24:0.0002%]
[INFO] ** proto:[0:99.9946%,1:0.0052%,2:0.0002%]
[INFO] ** appi_name:[21:99.9942%,30:0.0052%,23:0.0002%,22:0.0002%,18:0.0002%]
[INFO] ** proxy_src_ip:[18:38.4402%,20:25.9738%,13:18.1202%,6:17.4598%,17:0.0052%,14:0.0004%,16:0.0002%,10:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9942%,-33.760870000000004:0.0058%]
[INFO] ** modbus_function_description:[7:49.998%,11:49.9962%,0:0.0058%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:25.9726%,1:21.0682%,5:18.1198%,4:17.459%,2:17.3718%,0:0.0086%]
[INFO] ** service:[0.0048200000000000005:99.9942%,-211.73542999999998:0.0052%,-211.07873999999998:0.0004%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:25.973%,-0.32151:21.0682%,-1.27613:18.12%,-0.23351:17.4592%,-0.33484:17.372%,-71.33197:0.0052%,-0.24151:0.0006%,1.45709:0.0004%,8.38348:0.0004%,-1.27347:0.0002%,1.46509:0.0002%,1.47576:0.0002%,-71.14931:0.0002%,-1.02014:0.0002%]
[INFO] ** classification:[normal:80.1196%,Multi Stage Multi Point:14.47%,Single Stage Multi Point:5.4104%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7318661  0.         0.        ...  1.         0.00482   -0.32151  ]
 [-1.7318661  0.         0.        ...  2.         0.00482   -0.33484  ]
 [-1.7318661  0.         0.        ...  3.         0.00482    1.45442  ]
 ...
 [-1.0381526  0.         0.        ...  1.         0.00482   -0.32151  ]
 [-1.0381526  0.         0.        ...  3.         0.00482    1.45442  ]
 [-1.0381526  0.         0.        ...  3.         0.00482    1.45442  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99930263e-01 6.97798823e-05 1.08547008e-11 8.59492755e-10
   1.13428052e-11]
  [9.99999881e-01 9.32657400e-08 4.99917219e-14 6.88518687e-12
   5.37344556e-14]
  [9.99984860e-01 1.51452159e-05 6.37542373e-13 7.03237902e-12
   1.13465346e-12]
  ...
  [9.99999881e-01 1.18729403e-07 6.38810226e-14 1.32470077e-12
   1.18739911e-13]
  [9.99965429e-01 3.46167872e-05 2.54385055e-12 3.28939688e-11
   3.12342643e-12]
  [9.99997616e-01 2.36302299e-06 9.31404544e-14 8.74733771e-13
   2.25933313e-13]]

 [[9.99983668e-01 1.63209352e-05 5.46593109e-12 1.91058679e-11
   7.63149873e-12]
  [9.99898195e-01 1.01735423e-04 1.22715206e-11 6.30439451e-11
   1.64987485e-11]
  [9.34825718e-01 6.51742592e-02 2.94029939e-11 4.33241325e-11
   5.08711094e-11]
  ...
  [9.99857426e-01 1.42520032e-04 2.88224934e-12 1.46843874e-11
   3.25943222e-12]
  [9.99835491e-01 1.64508907e-04 8.58808630e-13 1.53368084e-12
   1.48365619e-12]
  [9.99999046e-01 9.95824848e-07 1.13400907e-13 1.06548234e-12
   2.90871385e-13]]

 [[9.99984264e-01 1.57867762e-05 5.37092853e-12 1.88916122e-11
   7.49735517e-12]
  [9.99997377e-01 2.59446824e-06 1.94847003e-12 1.54212632e-11
   2.12104748e-12]
  [9.99987483e-01 1.25202259e-05 2.56286160e-12 1.77139067e-11
   3.62078271e-12]
  ...
  [9.99999881e-01 6.74170835e-08 5.05509195e-14 1.25432824e-12
   9.58367974e-14]
  [9.99978900e-01 2.11039878e-05 2.59624635e-12 2.21821624e-11
   4.41825136e-12]
  [9.98628974e-01 1.37106108e-03 7.93244984e-12 2.26565728e-11
   8.52148300e-12]]

 ...

 [[9.99970078e-01 2.99322855e-05 3.17981904e-12 1.03466527e-10
   4.39846163e-12]
  [9.99998212e-01 1.77179777e-06 1.09127291e-12 1.96838986e-11
   1.22264807e-12]
  [9.99966502e-01 3.35252298e-05 1.77876377e-12 1.53903452e-11
   2.27767436e-12]
  ...
  [9.99999523e-01 4.40686961e-07 1.16167045e-13 1.38867119e-12
   2.15316670e-13]
  [1.00000000e+00 2.91776985e-08 4.20885860e-14 1.32612161e-12
   9.35847943e-14]
  [9.99999046e-01 8.95607911e-07 6.84103707e-13 1.01604914e-11
   1.07143103e-12]]

 [[9.99943614e-01 5.64165857e-05 3.62861564e-12 1.54007473e-10
   4.59153418e-12]
  [9.99999642e-01 3.45561574e-07 3.46019844e-13 1.41056732e-11
   4.03748893e-13]
  [9.99960303e-01 3.97305121e-05 2.05328398e-12 1.80908916e-11
   2.62058084e-12]
  ...
  [9.99999762e-01 2.72983470e-07 3.66430112e-14 4.27590634e-13
   9.20843331e-14]
  [9.99997973e-01 1.98260318e-06 1.56653672e-12 4.45505577e-11
   2.57551185e-12]
  [9.99998569e-01 1.44506294e-06 5.27719415e-13 5.58549474e-12
   9.42784262e-13]]

 [[9.99970675e-01 2.93602752e-05 3.15703193e-12 1.02293354e-10
   4.37305053e-12]
  [9.99999166e-01 8.32612784e-07 1.82923490e-12 6.88643309e-11
   1.58831227e-12]
  [9.93854940e-01 6.14499860e-03 4.68955604e-12 1.66232236e-11
   8.38802031e-12]
  ...
  [9.99998808e-01 1.18383025e-06 3.91213076e-13 3.93144631e-12
   7.22703473e-13]
  [9.99999881e-01 1.38134055e-07 6.63731968e-14 1.63174845e-12
   1.20521946e-13]
  [9.99999762e-01 2.19677034e-07 1.80084802e-13 3.55099717e-12
   3.03109995e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9993026e-01 6.9779882e-05 1.0854701e-11 8.5949275e-10 1.1342805e-11]
 [9.9999988e-01 9.3265740e-08 4.9991722e-14 6.8851869e-12 5.3734456e-14]
 [9.9998486e-01 1.5145216e-05 6.3754237e-13 7.0323790e-12 1.1346535e-12]
 ...
 [9.9999881e-01 1.1838302e-06 3.9121308e-13 3.9314463e-12 7.2270347e-13]
 [9.9999988e-01 1.3813406e-07 6.6373197e-14 1.6317484e-12 1.2052195e-13]
 [9.9999976e-01 2.1967703e-07 1.8008480e-13 3.5509972e-12 3.0310999e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  4.360769070044532
tp :  72947.0
fp :  27053.0
tn :  372947.0
fn :  27053.0
accuracy :  0.8917891383171082
precision :  0.7294700145721436
recall :  0.7294700145721436
auc :  0.8301957845687866

y_eval {0: 72948, 2: 27052}
pred {0: 99997, 1: 3}
[INFO] confusion matrix for file 
[[72947     1     0     0     0]
 [    0     0     0     0     0]
 [27050     2     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[471745    101      0      0      0]
 [101099      3      0      0      0]
 [ 27050      2      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0381526e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0381526e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.0381526e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 ...
 [-3.4698951e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4698951e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-3.4698951e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99999166e-01 8.45995601e-07 3.45500023e-13 8.64092912e-12
   5.74615822e-13]
  [9.99999404e-01 5.46446699e-07 1.48429565e-12 1.57252489e-10
   1.43181517e-12]
  [9.99980450e-01 1.95168541e-05 1.30448292e-13 1.48001012e-12
   2.49420385e-13]
  ...
  [9.99986172e-01 1.38774412e-05 1.57464243e-12 2.17634886e-11
   3.01772366e-12]
  [9.99998093e-01 1.93979668e-06 5.84575411e-13 5.64168200e-12
   1.03032708e-12]
  [9.99977708e-01 2.22323124e-05 7.33048930e-13 4.95004168e-12
   9.71728665e-13]]

 [[9.99995828e-01 4.14294209e-06 1.55530927e-12 5.49670622e-11
   2.24231267e-12]
  [9.99999881e-01 1.03314562e-07 3.12383664e-13 2.47339562e-11
   3.09972778e-13]
  [9.99960780e-01 3.92596448e-05 4.03649255e-13 3.64137279e-12
   8.16394532e-13]
  ...
  [9.99998331e-01 1.66283348e-06 1.36650850e-13 1.02968686e-12
   3.03772822e-13]
  [9.99996901e-01 3.12387078e-06 8.30273187e-13 7.64275795e-12
   1.49366381e-12]
  [9.99999881e-01 1.70577849e-07 6.44005926e-14 1.07698637e-12
   1.25469852e-13]]

 [[9.95373309e-01 4.62669134e-03 1.66936215e-10 1.98949071e-08
   2.11681422e-10]
  [9.99999762e-01 2.02165324e-07 3.72786898e-13 1.29960704e-11
   3.77016479e-13]
  [9.99962926e-01 3.70141533e-05 2.93328350e-13 2.20211002e-12
   4.65254679e-13]
  ...
  [9.99998808e-01 1.16408592e-06 1.21770961e-13 9.64254935e-13
   2.76805895e-13]
  [9.99996662e-01 3.36199400e-06 6.59480012e-13 1.02138818e-11
   1.21713642e-12]
  [9.99999881e-01 1.17554833e-07 7.95934702e-14 1.57396134e-12
   1.67040847e-13]]

 ...

 [[9.99997258e-01 2.71766726e-06 1.19613434e-12 3.84930282e-11
   1.76856793e-12]
  [1.00000000e+00 1.02021716e-08 2.53582640e-14 4.73447236e-12
   2.81595578e-14]
  [9.99976873e-01 2.30773749e-05 1.92250426e-12 1.78875526e-11
   2.53175432e-12]
  ...
  [9.99999642e-01 3.77982388e-07 1.10523109e-13 1.26354862e-12
   2.23756479e-13]
  [9.99999642e-01 3.36954884e-07 2.14614757e-13 4.86650390e-12
   3.43829755e-13]
  [9.99992728e-01 7.22686445e-06 1.82909070e-12 2.61680625e-11
   2.91924557e-12]]

 [[9.99997973e-01 2.03585569e-06 7.51239836e-13 2.65210388e-11
   1.00775800e-12]
  [9.99999523e-01 4.34854684e-07 6.87035715e-13 6.79589371e-11
   7.26539326e-13]
  [9.99976873e-01 2.31257982e-05 2.36281670e-13 9.50012855e-13
   4.93566668e-13]
  ...
  [9.99999762e-01 2.26549417e-07 1.26702088e-13 2.90120402e-12
   2.07486751e-13]
  [9.92904961e-01 7.09501002e-03 2.21408621e-11 1.32856823e-10
   3.84489524e-11]
  [9.99998927e-01 1.02492629e-06 1.39614299e-13 1.06991347e-12
   3.05504564e-13]]

 [[9.99997973e-01 2.04088474e-06 7.52207649e-13 2.65762343e-11
   1.00887148e-12]
  [9.99999881e-01 1.46605373e-07 3.67578364e-13 3.45189745e-11
   3.85951308e-13]
  [9.99974489e-01 2.54998176e-05 8.54737722e-13 1.00209589e-11
   1.02691846e-12]
  ...
  [9.99993324e-01 6.66670667e-06 3.79058953e-13 1.74487876e-12
   8.22200001e-13]
  [9.99999881e-01 6.65904878e-08 5.72637844e-14 1.36552911e-12
   9.90945946e-14]
  [9.99977469e-01 2.25874537e-05 1.34698752e-12 1.33192771e-11
   1.50944947e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999917e-01 8.4599560e-07 3.4550002e-13 8.6409291e-12 5.7461582e-13]
 [9.9999940e-01 5.4644670e-07 1.4842957e-12 1.5725249e-10 1.4318152e-12]
 [9.9998045e-01 1.9516854e-05 1.3044829e-13 1.4800101e-12 2.4942038e-13]
 ...
 [9.9999332e-01 6.6667067e-06 3.7905895e-13 1.7448788e-12 8.2220000e-13]
 [9.9999988e-01 6.6590488e-08 5.7263784e-14 1.3655291e-12 9.9094595e-14]
 [9.9997747e-01 2.2587454e-05 1.3469875e-12 1.3319277e-11 1.5094495e-12]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0007122520470060408
tp :  99993.0
fp :  7.0
tn :  399993.0
fn :  7.0
accuracy :  0.9999720454216003
precision :  0.9999300241470337
recall :  0.9999300241470337
auc :  1.0

y_eval {0: 100000}
pred {0: 99993, 1: 7}
[INFO] confusion matrix for file 
[[99993     7     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[571738    108      0      0      0]
 [101099      3      0      0      0]
 [ 27050      2      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4698951e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-3.4698951e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4698951e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 3.4672397e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 3.4672397e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4672397e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99959230e-01 4.07753396e-05 3.83989325e-12 1.39924877e-10
   5.24195834e-12]
  [9.99998808e-01 1.22545532e-06 9.36445474e-13 1.98992680e-11
   1.04012350e-12]
  [9.99999166e-01 8.15279179e-07 2.47647849e-13 4.24509126e-12
   4.22974915e-13]
  ...
  [9.99999642e-01 4.09098078e-07 2.12296963e-13 3.76159000e-12
   3.10837077e-13]
  [9.99999285e-01 7.07450624e-07 3.21894096e-13 3.88914552e-12
   5.89034030e-13]
  [9.99999881e-01 1.23860360e-07 9.96581154e-14 1.95334222e-12
   1.88679028e-13]]

 [[9.99999404e-01 6.14787496e-07 2.69838459e-13 5.14576012e-12
   4.35181459e-13]
  [9.99999881e-01 7.40479820e-08 1.76124320e-13 2.52140461e-11
   1.77939572e-13]
  [9.99985337e-01 1.46671491e-05 9.39157064e-13 6.65292084e-12
   1.64676356e-12]
  ...
  [9.99981880e-01 1.81671512e-05 6.71852819e-13 4.98329416e-12
   8.64948141e-13]
  [9.99979377e-01 2.06316654e-05 3.17829476e-13 1.26755171e-12
   6.38260332e-13]
  [9.99999404e-01 6.27383770e-07 9.04249142e-14 1.16461940e-12
   2.24500689e-13]]

 [[9.99999166e-01 8.10410256e-07 3.78527938e-13 9.16676544e-12
   6.06362237e-13]
  [1.00000000e+00 2.65068216e-08 1.23255396e-13 2.67828884e-11
   1.22716331e-13]
  [9.99980450e-01 1.95981193e-05 8.04993008e-13 9.89201776e-12
   1.15532280e-12]
  ...
  [9.99999523e-01 5.18271122e-07 3.14570662e-13 5.56255693e-12
   5.23349539e-13]
  [9.99971509e-01 2.85094829e-05 1.49867987e-12 1.61798925e-11
   1.83695312e-12]
  [9.99999881e-01 6.19844513e-08 2.52903963e-14 5.32864280e-13
   6.51852094e-14]]

 ...

 [[9.99870658e-01 1.29296401e-04 6.06069535e-12 2.82567914e-10
   7.58223692e-12]
  [9.99995828e-01 4.17433694e-06 3.81932506e-12 1.08124364e-10
   3.11763506e-12]
  [9.99946952e-01 5.30563048e-05 9.92439312e-13 2.57999199e-12
   1.89430698e-12]
  ...
  [1.00000000e+00 1.08786473e-08 2.61507006e-14 1.47738787e-12
   5.87031034e-14]
  [9.99998569e-01 1.47952062e-06 8.36628510e-13 1.11828264e-11
   1.34319064e-12]
  [9.99975085e-01 2.49122913e-05 7.84486517e-13 4.29519137e-12
   1.01652042e-12]]

 [[9.99999285e-01 7.12209555e-07 3.29205928e-13 6.73205372e-12
   5.04805778e-13]
  [9.99999881e-01 6.79746179e-08 1.49451686e-13 1.78668573e-11
   1.52573863e-13]
  [9.99994516e-01 5.53086056e-06 2.12295879e-13 3.59810315e-12
   3.76425291e-13]
  ...
  [9.99880314e-01 1.19638607e-04 3.24902930e-12 1.96568543e-11
   3.69783284e-12]
  [9.99999762e-01 2.65506998e-07 5.56883709e-14 7.47131523e-13
   1.33185197e-13]
  [9.99999762e-01 1.85052087e-07 2.29185540e-13 5.62248425e-12
   3.95873276e-13]]

 [[9.99999881e-01 1.10070118e-07 5.26003720e-13 1.26565529e-11
   8.53941375e-13]
  [9.99997735e-01 2.31213517e-06 1.31239922e-13 5.64986382e-12
   2.08386626e-13]
  [9.99958038e-01 4.19330863e-05 1.00574427e-11 1.15974230e-10
   1.58191984e-11]
  ...
  [9.99940276e-01 5.97381440e-05 1.62275618e-12 9.38850213e-12
   1.82763461e-12]
  [9.99998569e-01 1.37577706e-06 5.16262990e-14 4.43939536e-13
   1.44126058e-13]
  [1.00000000e+00 4.01709848e-08 8.30406775e-14 2.41650406e-12
   1.59338010e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9995923e-01 4.0775340e-05 3.8398932e-12 1.3992488e-10 5.2419583e-12]
 [9.9999881e-01 1.2254553e-06 9.3644547e-13 1.9899268e-11 1.0401235e-12]
 [9.9999917e-01 8.1527918e-07 2.4764785e-13 4.2450913e-12 4.2297491e-13]
 ...
 [9.9994028e-01 5.9738144e-05 1.6227562e-12 9.3885021e-12 1.8276346e-12]
 [9.9999857e-01 1.3757771e-06 5.1626299e-14 4.4393954e-13 1.4412606e-13]
 [1.0000000e+00 4.0170985e-08 8.3040677e-14 2.4165041e-12 1.5933801e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.002182912823557854
tp :  99977.0
fp :  23.0
tn :  399977.0
fn :  23.0
accuracy :  0.9999079704284668
precision :  0.9997699856758118
recall :  0.9997699856758118
auc :  0.9999306797981262

y_eval {0: 100000}
pred {0: 99977, 1: 23}
[INFO] confusion matrix for file 
[[99977    23     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[671715    131      0      0      0]
 [101099      3      0      0      0]
 [ 27050      2      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4672397e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4672397e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 3.4672397e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [ 1.0378871e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.0378871e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.0378871e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99904990e-01 9.49751920e-05 5.02495311e-12 2.37364906e-10
   6.07699351e-12]
  [9.99999762e-01 2.23269907e-07 1.84135395e-13 9.13556210e-12
   2.27868316e-13]
  [9.99994993e-01 4.96814710e-06 7.23039846e-13 8.33284743e-12
   9.33056258e-13]
  ...
  [9.99999046e-01 9.51631932e-07 1.26288530e-12 3.25336078e-11
   1.86783380e-12]
  [9.99988079e-01 1.18777152e-05 4.99177956e-13 3.98871691e-12
   6.82993267e-13]
  [9.99996424e-01 3.58166744e-06 1.62203570e-13 9.46089452e-13
   3.72486411e-13]]

 [[9.99872684e-01 1.27245861e-04 6.02648357e-12 2.80466872e-10
   7.54880360e-12]
  [9.99999762e-01 2.31383268e-07 1.89002460e-13 9.19292940e-12
   2.28847459e-13]
  [9.99994278e-01 5.75801641e-06 1.35144944e-12 1.53608567e-11
   2.35130513e-12]
  ...
  [9.99999642e-01 3.19975555e-07 1.47625415e-13 2.67044655e-12
   2.26449339e-13]
  [9.99999762e-01 2.13572719e-07 1.35693702e-13 2.31066013e-12
   2.50625529e-13]
  [9.99999166e-01 8.20091373e-07 2.25016783e-13 2.74659353e-12
   3.62639389e-13]]

 [[9.99873042e-01 1.26907180e-04 6.02082143e-12 2.80120011e-10
   7.54327937e-12]
  [9.99999762e-01 2.28179985e-07 1.87342153e-13 9.17618152e-12
   2.26810297e-13]
  [9.99994278e-01 5.72804629e-06 1.35149585e-12 1.53930913e-11
   2.35087015e-12]
  ...
  [9.99999762e-01 2.08308023e-07 5.96913957e-13 2.03311656e-11
   8.55927417e-13]
  [9.99999166e-01 8.83322002e-07 1.46159492e-13 2.22644928e-12
   2.40049598e-13]
  [9.99996901e-01 3.08344556e-06 6.84300598e-13 5.67632269e-12
   1.32060487e-12]]

 ...

 [[9.99999881e-01 1.13529786e-07 5.04055619e-13 1.44378702e-11
   8.55653276e-13]
  [9.99999881e-01 9.74594485e-08 7.16735156e-14 6.60086569e-12
   9.82478869e-14]
  [9.99990821e-01 9.15519377e-06 1.52078057e-12 1.66443491e-11
   2.59486139e-12]
  ...
  [9.99998450e-01 1.55619648e-06 4.94462164e-13 5.87273763e-12
   8.16110851e-13]
  [9.99996424e-01 3.56556757e-06 3.15205707e-13 2.84201026e-12
   5.13447737e-13]
  [9.99748051e-01 2.51968973e-04 2.84563779e-12 9.54798306e-12
   3.42456207e-12]]

 [[9.99889255e-01 1.10689456e-04 5.46754222e-12 2.66268341e-10
   6.48678940e-12]
  [9.99999881e-01 1.17076880e-07 4.01996199e-13 1.94732425e-11
   4.21310908e-13]
  [9.99163508e-01 8.36496707e-04 1.22576331e-12 3.15148862e-12
   2.02329473e-12]
  ...
  [1.00000000e+00 5.57389228e-08 6.30798582e-14 1.62955912e-12
   1.19131010e-13]
  [9.99984741e-01 1.53150777e-05 1.49452922e-12 1.77716938e-11
   1.76838719e-12]
  [9.99998689e-01 1.34320135e-06 2.40745520e-13 1.96791281e-12
   5.14521422e-13]]

 [[9.99998331e-01 1.64426513e-06 1.13300569e-12 4.04826797e-11
   1.61667771e-12]
  [1.00000000e+00 5.42391874e-08 2.78202510e-13 3.08427971e-11
   2.80002367e-13]
  [9.99981284e-01 1.86853777e-05 1.38573479e-13 1.59543114e-12
   2.90792970e-13]
  ...
  [9.94913578e-01 5.08637680e-03 6.56906196e-11 9.05273911e-10
   9.88645277e-11]
  [9.99999881e-01 7.91065204e-08 3.96129154e-14 5.59962233e-13
   9.65208680e-14]
  [9.99998689e-01 1.36572964e-06 6.48484792e-13 1.70191517e-11
   7.95865815e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9990499e-01 9.4975192e-05 5.0249531e-12 2.3736491e-10 6.0769935e-12]
 [9.9999976e-01 2.2326991e-07 1.8413539e-13 9.1355621e-12 2.2786832e-13]
 [9.9999499e-01 4.9681471e-06 7.2303985e-13 8.3328474e-12 9.3305626e-13]
 ...
 [9.9491358e-01 5.0863768e-03 6.5690620e-11 9.0527391e-10 9.8864528e-11]
 [9.9999988e-01 7.9106520e-08 3.9612915e-14 5.5996223e-13 9.6520868e-14]
 [9.9999869e-01 1.3657296e-06 6.4848479e-13 1.7019152e-11 7.9586581e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  4.068851454210281
tp :  74747.0
fp :  25253.0
tn :  374747.0
fn :  25253.0
accuracy :  0.8989889621734619
precision :  0.7474700212478638
recall :  0.7474700212478638
auc :  0.8408083915710449

y_eval {0: 74770, 4: 25230}
pred {0: 99977, 1: 23}
[INFO] confusion matrix for file 
[[74747    23     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [25230     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[746462    154      0      0      0]
 [101099      3      0      0      0]
 [ 27050      2      0      0      0]
 [     0      0      0      0      0]
 [ 25230      0      0      0      0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0378871  0.         0.        ...  2.         0.00482   -0.33484  ]
 [ 1.0378871  0.         0.        ...  3.         0.00482    1.45442  ]
 [ 1.0378871  0.         0.        ...  4.         0.00482   -0.23351  ]
 ...
 [ 1.7316006  0.         0.        ...  3.         0.00482    1.45442  ]
 [ 1.7316006  0.         0.        ...  2.         0.00482   -0.33484  ]
 [ 1.7316006  0.         0.        ...  4.         0.00482   -0.23351  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 1.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 4 0 ... 4 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.9762005e-01 2.3799527e-03 6.8564480e-11 6.6325501e-09 8.1807616e-11]
  [9.9999976e-01 2.3566557e-07 1.5733240e-13 8.6403081e-12 1.7709208e-13]
  [9.9999690e-01 3.1211609e-06 5.2871797e-13 6.3371686e-12 7.3475958e-13]
  ...
  [9.9987769e-01 1.2223495e-04 2.1580981e-12 6.4741311e-12 4.3944579e-12]
  [9.9999952e-01 5.2228467e-07 9.7196617e-14 1.1023388e-12 2.0038051e-13]
  [9.9999988e-01 1.4591841e-07 1.6906307e-13 4.0467742e-12 2.9336662e-13]]

 [[9.9999797e-01 2.0298826e-06 1.0788347e-12 3.4139663e-11 1.6263514e-12]
  [9.9999988e-01 7.2693645e-08 2.4816203e-13 1.7789090e-11 2.7420663e-13]
  [9.9999654e-01 3.4888892e-06 5.2992723e-13 5.9453306e-12 7.3127382e-13]
  ...
  [9.9997270e-01 2.7265867e-05 8.9637282e-13 3.1111296e-12 1.8652426e-12]
  [9.9999964e-01 4.0205410e-07 1.0418413e-13 1.1992486e-12 1.9309886e-13]
  [9.9999881e-01 1.2496098e-06 7.3479043e-13 1.0876626e-11 1.2468774e-12]]

 [[9.9988973e-01 1.1023032e-04 5.4685462e-12 2.6651947e-10 6.4876333e-12]
  [9.9999928e-01 7.6891308e-07 1.4143594e-12 4.6977075e-11 1.1932291e-12]
  [9.9922287e-01 7.7715161e-04 1.9905447e-12 3.6049469e-12 2.8827173e-12]
  ...
  [9.9996328e-01 3.6678764e-05 1.1360928e-12 7.1115796e-12 2.0455894e-12]
  [9.9998677e-01 1.3251568e-05 8.5302186e-13 4.1337832e-12 1.7608280e-12]
  [9.9999976e-01 2.2543323e-07 8.5783919e-14 1.5319036e-12 1.5840737e-13]]

 ...

 [[9.9999905e-01 8.9625297e-07 4.1462054e-13 9.6236135e-12 6.2935139e-13]
  [1.0000000e+00 5.5219783e-08 1.0567435e-13 4.1617747e-11 1.2177551e-13]
  [9.9998403e-01 1.5921079e-05 1.5921796e-12 1.2355718e-11 2.7731350e-12]
  ...
  [9.9999905e-01 9.1487794e-07 7.0032679e-13 1.1046836e-11 1.1450093e-12]
  [9.9999952e-01 4.2792431e-07 1.1740195e-13 1.5725805e-12 1.8234904e-13]
  [9.9998987e-01 1.0184838e-05 3.1725561e-13 3.2561477e-12 4.9797303e-13]]

 [[9.9991000e-01 8.9936504e-05 5.0789867e-12 2.5555197e-10 5.9576883e-12]
  [1.0000000e+00 4.2278437e-08 6.5680182e-14 7.6588484e-12 8.1598872e-14]
  [9.9999690e-01 3.0684350e-06 1.2348285e-12 1.7336665e-11 2.0444412e-12]
  ...
  [9.9988902e-01 1.1098265e-04 1.2331232e-12 3.4115748e-12 1.6732022e-12]
  [9.9999964e-01 3.4980337e-07 8.9852076e-14 1.1224545e-12 2.0412818e-13]
  [9.9999285e-01 7.1152440e-06 3.5060030e-12 7.2804034e-11 4.8746645e-12]]

 [[9.9999976e-01 2.6694326e-07 4.3100015e-13 1.2298215e-11 7.7432570e-13]
  [9.9999988e-01 9.6200623e-08 4.4460505e-14 9.6020058e-12 5.6059243e-14]
  [9.9994171e-01 5.8339538e-05 5.9959641e-12 5.1355236e-11 1.0206816e-11]
  ...
  [9.9999988e-01 8.8342333e-08 1.0583571e-13 2.4410936e-12 2.1152582e-13]
  [9.9999928e-01 7.4137580e-07 7.7730108e-13 1.6055865e-11 1.1474954e-12]
  [9.9994528e-01 5.4755699e-05 1.1991492e-12 5.3713032e-12 1.5226270e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9762005e-01 2.3799527e-03 6.8564480e-11 6.6325501e-09 8.1807616e-11]
 [9.9999976e-01 2.3566557e-07 1.5733240e-13 8.6403081e-12 1.7709208e-13]
 [9.9999690e-01 3.1211609e-06 5.2871797e-13 6.3371686e-12 7.3475958e-13]
 ...
 [9.9999988e-01 8.8342333e-08 1.0583571e-13 2.4410936e-12 2.1152582e-13]
 [9.9999928e-01 7.4137580e-07 7.7730108e-13 1.6055865e-11 1.1474954e-12]
 [9.9994528e-01 5.4755699e-05 1.1991492e-12 5.3713032e-12 1.5226270e-12]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  7.598144514465332
tp :  52830.0
fp :  47170.0
tn :  352830.0
fn :  47170.0
accuracy :  0.8113217949867249
precision :  0.5282999873161316
recall :  0.5282999873161316
auc :  0.7024829983711243

y_eval {0: 52880, 4: 47120}
pred {0: 99950, 1: 50}
[INFO] confusion matrix for file 
[[52830    50     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [47120     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[799292    204      0      0      0]
 [101099      3      0      0      0]
 [ 27050      2      0      0      0]
 [     0      0      0      0      0]
 [ 72350      0      0      0      0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2015-12-31_181648_113.log.part09_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1359 (0.2718%)
[INFO] ** orig:[0:99.9966%,2:0.0034%]
[INFO] ** type:[0:99.9996%,1:0.0004%]
[INFO] ** i/f_name:[2:99.9938%,3:0.0062%]
[INFO] ** i/f_dir:[1:99.9942%,0:0.0058%]
[INFO] ** src:[22:38.4204%,9:25.9634%,7:18.123%,1:17.486%,21:0.0034%,14:0.0028%,15:0.0006%,2:0.0004%]
[INFO] ** dst:[21:43.3316%,10:21.0518%,8:18.123%,9:17.486%,15:0.0062%,22:0.0008%,24:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** proto:[0:99.9934%,1:0.0062%,2:0.0004%]
[INFO] ** appi_name:[21:99.9934%,30:0.0062%,31:0.0002%,27:0.0002%]
[INFO] ** proxy_src_ip:[18:38.4204%,20:25.9634%,13:18.123%,6:17.486%,17:0.0062%,16:0.0006%,14:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.9934%,-33.760870000000004:0.0066%]
[INFO] ** modbus_function_description:[7:49.9972%,11:49.9962%,0:0.0066%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:25.9624%,1:21.0518%,5:18.1226%,4:17.4856%,2:17.3686%,0:0.009%]
[INFO] ** service:[0.0048200000000000005:99.9934%,-211.73542999999998:0.0062%,-186.43601999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:25.9628%,-0.32151:21.0518%,-1.27613:18.1226%,-0.23351:17.4858%,-0.33484:17.3686%,-71.33197:0.0062%,-1.02014:0.0006%,-1.27347:0.0002%,11.862:0.0002%,1.45709:0.0002%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,13.431270000000001:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:73.9096%,Multi Stage Multi Point:26.0904%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7313178e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.7313178e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.7313178e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [-1.0397894e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.0397894e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0397894e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 4 0 ... 4 4 4] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99992013e-01 7.96502627e-06 3.23513156e-12 1.09748287e-11
   4.49203218e-12]
  [9.99918342e-01 8.16287720e-05 2.51235682e-11 1.16920210e-10
   2.36996117e-11]
  [9.99891758e-01 1.08272237e-04 1.03586514e-11 5.11300342e-11
   1.11115995e-11]
  ...
  [9.99901175e-01 9.87954045e-05 3.97875689e-13 7.52894112e-13
   1.06944369e-12]
  [9.99999762e-01 2.58953662e-07 1.29880536e-13 2.12937046e-12
   2.77105162e-13]
  [9.99998927e-01 1.06086600e-06 4.71467592e-13 5.77670941e-12
   7.54104570e-13]]

 [[9.99991655e-01 8.35402625e-06 3.32241526e-12 1.11773108e-11
   4.61407171e-12]
  [9.99916077e-01 8.39519198e-05 2.59619357e-11 1.18880836e-10
   2.43587182e-11]
  [9.98584270e-01 1.41576550e-03 4.33372262e-12 6.21049479e-12
   8.91025188e-12]
  ...
  [1.00000000e+00 5.75423904e-08 8.35968935e-14 2.51899543e-12
   1.61072693e-13]
  [9.99996662e-01 3.33076673e-06 7.67506555e-13 6.94864912e-12
   1.25947365e-12]
  [9.99985456e-01 1.45993281e-05 7.11689009e-13 7.84879713e-12
   7.61735889e-13]]

 [[9.99991298e-01 8.76028662e-06 3.41180014e-12 1.13842893e-11
   4.73905680e-12]
  [9.99995828e-01 4.11539668e-06 1.96292136e-12 1.61341843e-11
   2.24413522e-12]
  [9.99634624e-01 3.65382672e-04 3.47696871e-12 7.11114110e-12
   6.70359254e-12]
  ...
  [9.99989867e-01 1.00845336e-05 2.83493037e-13 1.36593482e-12
   7.02954079e-13]
  [9.99999881e-01 1.29830795e-07 9.84367752e-14 1.86302493e-12
   1.87057238e-13]
  [9.99997020e-01 3.01167915e-06 6.25806969e-13 1.61541874e-11
   7.11329487e-13]]

 ...

 [[9.99986291e-01 1.37024554e-05 2.47839011e-12 6.95409633e-11
   3.63634340e-12]
  [9.99998569e-01 1.48978722e-06 9.58720082e-13 2.00301425e-11
   1.09028520e-12]
  [9.99997497e-01 2.45135493e-06 3.83347407e-13 4.88399338e-12
   6.51655704e-13]
  ...
  [9.99971509e-01 2.84319940e-05 2.72469178e-12 6.27990507e-11
   4.38350961e-12]
  [9.99998093e-01 1.95684447e-06 4.42837363e-13 3.94267778e-12
   8.07384487e-13]
  [9.99999881e-01 6.92381334e-08 4.91883315e-14 1.26050396e-12
   9.52329307e-14]]

 [[9.99997377e-01 2.65701260e-06 9.58803132e-13 2.67495331e-11
   1.43798374e-12]
  [1.00000000e+00 2.27775949e-08 4.14016965e-14 8.24696908e-12
   4.56393481e-14]
  [9.99989867e-01 1.01812839e-05 1.23338167e-12 1.41667945e-11
   1.83467217e-12]
  ...
  [9.99993443e-01 6.59365833e-06 1.11171977e-12 5.80077236e-11
   1.64171845e-12]
  [9.99995232e-01 4.77830918e-06 5.10610055e-13 3.21999805e-12
   9.88787719e-13]
  [1.00000000e+00 2.65071254e-08 3.40126791e-14 1.16319476e-12
   6.96647397e-14]]

 [[9.99997377e-01 2.65161589e-06 9.54946625e-13 2.66065989e-11
   1.43302254e-12]
  [1.00000000e+00 1.09946274e-08 4.38822291e-14 9.05320523e-12
   4.55122593e-14]
  [9.99999285e-01 6.84950066e-07 2.74867829e-13 9.45459423e-12
   3.19257560e-13]
  ...
  [9.99999881e-01 7.27943785e-08 2.09172360e-13 1.27060888e-11
   3.71751675e-13]
  [1.00000000e+00 2.39626345e-08 1.07887745e-13 5.27442673e-12
   1.97890153e-13]
  [9.99999285e-01 7.04465435e-07 5.86561941e-13 8.68272815e-12
   9.23802376e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.99992013e-01 7.96502627e-06 3.23513156e-12 1.09748287e-11
  4.49203218e-12]
 [9.99918342e-01 8.16287720e-05 2.51235682e-11 1.16920210e-10
  2.36996117e-11]
 [9.99891758e-01 1.08272237e-04 1.03586514e-11 5.11300342e-11
  1.11115995e-11]
 ...
 [9.99999881e-01 7.27943785e-08 2.09172360e-13 1.27060888e-11
  3.71751675e-13]
 [1.00000000e+00 2.39626345e-08 1.07887745e-13 5.27442673e-12
  1.97890153e-13]
 [9.99999285e-01 7.04465435e-07 5.86561941e-13 8.68272815e-12
  9.23802376e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  7.5809854225158695
tp :  52963.0
fp :  47037.0
tn :  352963.0
fn :  47037.0
accuracy :  0.81185382604599
precision :  0.5296300053596497
recall :  0.5296300053596497
auc :  0.7036396265029907

y_eval {0: 52975, 4: 47025}
pred {0: 99988, 1: 12}
[INFO] confusion matrix for file 
[[52963    12     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [47025     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[852255    216      0      0      0]
 [101099      3      0      0      0]
 [ 27050      2      0      0      0]
 [     0      0      0      0      0]
 [119375      0      0      0      0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0397894e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0397894e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0397894e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-3.4570932e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-3.4570932e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-3.4570932e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]] shape (100000, 16)
y_test [[0. 0. 0. 0. 1.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [4 0 4 ... 0 4 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99966621e-01 3.33452335e-05 2.96556399e-12 1.18742252e-10
   3.84884529e-12]
  [9.99997020e-01 2.96626558e-06 3.00297135e-12 7.12007467e-11
   2.73665725e-12]
  [9.99610960e-01 3.89054010e-04 1.52865817e-12 5.77986747e-12
   2.70252353e-12]
  ...
  [9.99998093e-01 1.92758694e-06 2.04548387e-13 2.02654581e-12
   3.51481078e-13]
  [9.99996901e-01 3.08192853e-06 4.07890383e-13 2.97298818e-12
   7.80966817e-13]
  [9.99999642e-01 3.32751426e-07 9.97364355e-14 1.56908720e-12
   1.99053000e-13]]

 [[9.99904752e-01 9.52231276e-05 5.48681803e-12 2.52749266e-10
   7.01555177e-12]
  [9.99999642e-01 3.52200800e-07 5.56646038e-13 2.23419373e-11
   6.05943952e-13]
  [9.99999642e-01 3.22902139e-07 1.10035746e-13 2.80618866e-12
   1.83506368e-13]
  ...
  [9.99999881e-01 1.24967130e-07 1.29702808e-13 3.43513412e-12
   2.29186001e-13]
  [9.99999881e-01 1.01894564e-07 1.09801592e-13 2.92040263e-12
   1.98933860e-13]
  [9.99985218e-01 1.48269110e-05 6.02000112e-13 4.54183219e-12
   9.87213675e-13]]

 [[9.99986768e-01 1.32670839e-05 2.46109383e-12 6.87639876e-11
   3.62057975e-12]
  [9.99999523e-01 4.74138147e-07 2.84604263e-13 1.05000938e-11
   3.35530052e-13]
  [9.97271955e-01 2.72809062e-03 4.41846282e-11 4.70282147e-10
   8.86111601e-11]
  ...
  [9.99882698e-01 1.17320400e-04 8.37537396e-13 2.24433948e-12
   1.47299989e-12]
  [9.99999285e-01 7.38706603e-07 1.60943904e-13 1.78887623e-12
   3.42839499e-13]
  [9.99967933e-01 3.20583604e-05 1.78067402e-12 1.47847169e-11
   2.14048419e-12]]

 ...

 [[9.99939084e-01 6.08848823e-05 4.37291262e-12 1.70273365e-10
   5.77983538e-12]
  [9.99999166e-01 8.20461366e-07 7.01914167e-13 1.76531671e-11
   7.89668190e-13]
  [9.99999285e-01 6.62254422e-07 2.16351988e-13 4.08715509e-12
   3.69324498e-13]
  ...
  [9.99999762e-01 2.64987676e-07 2.04992409e-13 3.95394308e-12
   3.23836525e-13]
  [9.99897480e-01 1.02562903e-04 2.13320529e-12 2.75724860e-11
   3.73962406e-12]
  [9.99989033e-01 1.09915773e-05 7.33307566e-13 3.96293024e-12
   1.42593814e-12]]

 [[9.99929667e-01 7.03420883e-05 4.19466285e-12 1.87108634e-10
   5.20183506e-12]
  [9.99996781e-01 3.22579126e-06 2.71398268e-12 6.38060299e-11
   2.43715464e-12]
  [9.99117911e-01 8.82085471e-04 2.49085626e-12 9.48710468e-12
   4.48694207e-12]
  ...
  [9.99986768e-01 1.32152600e-05 6.36495034e-13 5.79971271e-12
   1.08420662e-12]
  [9.99995947e-01 4.10646635e-06 6.22800802e-13 4.60171701e-12
   1.19377609e-12]
  [1.00000000e+00 5.37788196e-08 5.57627844e-14 1.39531464e-12
   1.06829910e-13]]

 [[9.99999881e-01 1.64717505e-07 5.03771124e-13 5.38549717e-12
   7.43747674e-13]
  [9.99999523e-01 4.29466837e-07 1.54710107e-13 7.42738423e-12
   2.33148353e-13]
  [9.99986410e-01 1.36156250e-05 4.03161228e-12 3.51003046e-11
   5.66491732e-12]
  ...
  [9.99996662e-01 3.28873648e-06 1.21535418e-13 5.47903628e-13
   3.17539262e-13]
  [9.99999881e-01 6.09547257e-08 8.28900276e-14 2.65736370e-12
   1.72567283e-13]
  [9.99999642e-01 3.37655166e-07 2.11812826e-13 3.44532345e-12
   3.50947055e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9996662e-01 3.3345234e-05 2.9655640e-12 1.1874225e-10 3.8488453e-12]
 [9.9999702e-01 2.9662656e-06 3.0029714e-12 7.1200747e-11 2.7366573e-12]
 [9.9961096e-01 3.8905401e-04 1.5286582e-12 5.7798675e-12 2.7025235e-12]
 ...
 [9.9999666e-01 3.2887365e-06 1.2153542e-13 5.4790363e-13 3.1753926e-13]
 [9.9999988e-01 6.0954726e-08 8.2890028e-14 2.6573637e-12 1.7256728e-13]
 [9.9999964e-01 3.3765517e-07 2.1181283e-13 3.4453235e-12 3.5094705e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  7.572315013122559
tp :  53009.0
fp :  46991.0
tn :  353009.0
fn :  46991.0
accuracy :  0.8120378255844116
precision :  0.5300899744033813
recall :  0.5300899744033813
auc :  0.7041547894477844

y_eval {0: 53029, 4: 46971}
pred {0: 99980, 1: 20}
[INFO] confusion matrix for file 
[[53009    20     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [46971     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[905264    236      0      0      0]
 [101099      3      0      0      0]
 [ 27050      2      0      0      0]
 [     0      0      0      0      0]
 [166346      0      0      0      0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4570932e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4570932e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4570932e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 ...
 [ 3.4581903e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 3.4581903e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4581903e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [4 4 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99693751e-01 3.06284550e-04 9.84882315e-12 5.23522725e-10
   1.20722564e-11]
  [9.99999762e-01 2.63853138e-07 5.41962254e-13 2.48645982e-11
   6.05417246e-13]
  [9.99998212e-01 1.83766485e-06 1.69878638e-13 3.04285590e-12
   2.64905854e-13]
  ...
  [9.99991894e-01 8.16498414e-06 6.06200474e-13 4.12087812e-12
   1.26367146e-12]
  [9.99949813e-01 5.01930044e-05 2.25832590e-12 1.90094052e-11
   2.55860372e-12]
  [9.99999881e-01 1.58995121e-07 2.34094750e-14 3.69452244e-13
   6.34386884e-14]]

 [[9.99999166e-01 7.96310474e-07 4.05165051e-13 1.00512211e-11
   6.39801471e-13]
  [9.99999881e-01 1.47907897e-07 6.54443676e-13 5.83925200e-11
   6.50894540e-13]
  [9.99997616e-01 2.40704117e-06 1.05915039e-13 1.72173116e-12
   1.89237243e-13]
  ...
  [9.99881864e-01 1.18160751e-04 1.97631516e-12 8.00584078e-12
   2.36025153e-12]
  [9.99982834e-01 1.71279789e-05 3.99653807e-13 1.30478527e-12
   9.52624156e-13]
  [9.99999881e-01 7.96208894e-08 1.04355584e-13 2.48982844e-12
   1.96298463e-13]]

 [[9.99996901e-01 3.13740770e-06 1.24542997e-12 4.10389535e-11
   1.81358368e-12]
  [9.99999881e-01 1.37708810e-07 3.72904263e-13 2.11243818e-11
   3.87728017e-13]
  [9.99978662e-01 2.13808689e-05 4.46038117e-13 3.09287188e-12
   7.72559751e-13]
  ...
  [9.99997377e-01 2.57688885e-06 1.33273045e-13 6.26851327e-13
   3.51599500e-13]
  [9.99940872e-01 5.91284770e-05 5.19999885e-12 7.54133492e-11
   5.72348028e-12]
  [9.99998808e-01 1.21899200e-06 1.53328115e-13 1.10181460e-12
   3.43929827e-13]]

 ...

 [[9.99997258e-01 2.71196359e-06 1.37890242e-12 4.69143925e-11
   2.01288400e-12]
  [9.99999881e-01 8.70922321e-08 2.48036617e-13 1.57041775e-11
   2.51470204e-13]
  [9.99998808e-01 1.23336588e-06 3.37127760e-13 6.56146882e-12
   4.83988392e-13]
  ...
  [9.99999881e-01 1.00862394e-07 1.52800149e-13 4.05282275e-12
   2.74699236e-13]
  [9.99999166e-01 8.01446959e-07 2.19310125e-13 2.89904494e-12
   3.74846503e-13]
  [9.99302030e-01 6.97935582e-04 6.72319058e-12 2.78721143e-11
   7.55251504e-12]]

 [[9.93104756e-01 6.89523900e-03 1.09812541e-10 8.83806184e-09
   1.32716393e-10]
  [1.00000000e+00 8.58538463e-10 2.83960088e-14 2.88876952e-12
   4.68893113e-14]
  [9.99999762e-01 2.86890753e-07 5.49378455e-14 2.17943458e-12
   8.39519155e-14]
  ...
  [9.99844313e-01 1.55678790e-04 2.05102233e-12 8.23137045e-12
   2.74389062e-12]
  [9.89667058e-01 1.03329252e-02 9.34034274e-12 1.22412644e-11
   1.29840669e-11]
  [9.99986529e-01 1.34958391e-05 1.65691611e-13 5.67788546e-13
   4.37294271e-13]]

 [[9.99891400e-01 1.08539345e-04 5.17877798e-12 2.42791842e-10
   6.24746609e-12]
  [9.99999881e-01 1.20922621e-07 4.60734478e-13 2.06908813e-11
   4.76749011e-13]
  [9.99593079e-01 4.06950217e-04 1.29740879e-12 1.92235312e-12
   2.42687207e-12]
  ...
  [9.99976039e-01 2.40049831e-05 8.09940873e-13 5.00015524e-12
   1.00661211e-12]
  [9.99690533e-01 3.09495226e-04 9.20429098e-13 1.98553674e-12
   1.55395694e-12]
  [9.99995589e-01 4.46335343e-06 2.21206544e-13 1.26083031e-12
   5.29476148e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9969375e-01 3.0628455e-04 9.8488231e-12 5.2352273e-10 1.2072256e-11]
 [9.9999976e-01 2.6385314e-07 5.4196225e-13 2.4864598e-11 6.0541725e-13]
 [9.9999821e-01 1.8376649e-06 1.6987864e-13 3.0428559e-12 2.6490585e-13]
 ...
 [9.9997604e-01 2.4004983e-05 8.0994087e-13 5.0001552e-12 1.0066121e-12]
 [9.9969053e-01 3.0949523e-04 9.2042910e-13 1.9855367e-12 1.5539569e-12]
 [9.9999559e-01 4.4633534e-06 2.2120654e-13 1.2608303e-12 5.2947615e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  5.877194587639533
tp :  63529.0
fp :  36471.0
tn :  363529.0
fn :  36471.0
accuracy :  0.8541173338890076
precision :  0.6352900266647339
recall :  0.6352900266647339
auc :  0.7703031301498413

y_eval {0: 63544, 4: 36456}
pred {0: 99985, 1: 15}
[INFO] confusion matrix for file 
[[63529    15     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [36456     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[968793    251      0      0      0]
 [101099      3      0      0      0]
 [ 27050      2      0      0      0]
 [     0      0      0      0      0]
 [202802      0      0      0      0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4581903e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 3.4581903e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4581903e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [ 1.0398991e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.0398991e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0398991e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99999046e-01 9.69735083e-07 3.57945796e-13 7.49735170e-12
   5.69266097e-13]
  [9.99999762e-01 2.34647644e-07 6.78537142e-13 4.90914913e-11
   7.14870491e-13]
  [9.99981880e-01 1.81383784e-05 5.74014360e-13 3.81398732e-12
   8.15583766e-13]
  ...
  [9.99941707e-01 5.82755893e-05 1.09125708e-12 4.42881062e-12
   1.62047285e-12]
  [9.99987006e-01 1.30448561e-05 5.53895959e-13 2.16642611e-12
   1.25687210e-12]
  [9.99998569e-01 1.44052649e-06 2.41909113e-13 2.53813355e-12
   3.62489091e-13]]

 [[9.99997258e-01 2.68981739e-06 1.37120220e-12 4.65582677e-11
   2.00362968e-12]
  [9.99999881e-01 7.55816458e-08 2.88468251e-13 2.08600446e-11
   2.99289727e-13]
  [9.99977350e-01 2.26477168e-05 2.44910022e-13 3.11934983e-12
   5.07670186e-13]
  ...
  [9.99999762e-01 2.96596966e-07 8.16472676e-14 9.05143744e-13
   1.65546599e-13]
  [9.99999642e-01 3.86104062e-07 4.23120333e-13 1.27802673e-11
   7.80836442e-13]
  [9.99999523e-01 5.16390912e-07 1.65915445e-13 3.01638272e-12
   2.72562436e-13]]

 [[9.99997258e-01 2.68408508e-06 1.36919241e-12 4.64662718e-11
   2.00120064e-12]
  [1.00000000e+00 5.14394571e-09 2.14630695e-14 5.30951238e-12
   2.31488446e-14]
  [9.99984026e-01 1.59583833e-05 2.85913415e-12 2.96689548e-11
   4.55323279e-12]
  ...
  [9.99991775e-01 8.23360642e-06 1.10488355e-12 2.35609952e-11
   1.76509393e-12]
  [9.99933243e-01 6.67882632e-05 1.32770596e-12 5.85966692e-12
   1.90567809e-12]
  [9.99990702e-01 9.26002758e-06 8.21276261e-13 5.83193823e-12
   1.71655160e-12]]

 ...

 [[9.99999881e-01 1.26886420e-07 4.83623504e-13 1.43091016e-11
   8.40631709e-13]
  [9.99999285e-01 6.93158199e-07 6.74644327e-14 4.97442582e-12
   1.01823084e-13]
  [9.99926686e-01 7.32725166e-05 4.40908898e-12 2.28703983e-11
   6.28636769e-12]
  ...
  [9.99983072e-01 1.69637478e-05 8.54041013e-13 3.72172041e-12
   1.70689428e-12]
  [9.99999881e-01 1.04817502e-07 8.80026778e-14 1.69762392e-12
   1.70799667e-13]
  [9.99982834e-01 1.71785596e-05 1.88837205e-12 2.59540636e-11
   2.26064588e-12]]

 [[9.99998927e-01 1.10057158e-06 4.08722969e-13 8.64960013e-12
   6.35461952e-13]
  [9.99999762e-01 1.98284027e-07 4.59657431e-13 4.98442190e-11
   4.90916281e-13]
  [9.99998450e-01 1.58843409e-06 3.09155127e-13 3.82707971e-12
   4.03654459e-13]
  ...
  [9.99992728e-01 7.23804533e-06 4.30597777e-13 2.62071094e-12
   6.33084459e-13]
  [9.99998569e-01 1.42679255e-06 3.69674506e-13 4.10180266e-12
   7.14310772e-13]
  [9.99943495e-01 5.64499460e-05 1.90156940e-12 1.21285473e-11
   2.17118402e-12]]

 [[9.99998927e-01 1.09908638e-06 4.08409688e-13 8.64509766e-12
   6.34991842e-13]
  [1.00000000e+00 2.94248341e-08 1.02408248e-13 3.29397482e-11
   1.13619685e-13]
  [9.99992490e-01 7.47415243e-06 1.00241170e-12 1.03971476e-11
   1.71158519e-12]
  ...
  [9.99993563e-01 6.44590682e-06 1.20423365e-12 9.76163941e-12
   2.10888100e-12]
  [9.99999762e-01 2.29730247e-07 7.05015067e-14 1.21149109e-12
   1.31167877e-13]
  [9.99999762e-01 1.99761629e-07 1.46931580e-13 3.09558130e-12
   2.74801910e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999905e-01 9.6973508e-07 3.5794580e-13 7.4973517e-12 5.6926610e-13]
 [9.9999976e-01 2.3464764e-07 6.7853714e-13 4.9091491e-11 7.1487049e-13]
 [9.9998188e-01 1.8138378e-05 5.7401436e-13 3.8139873e-12 8.1558377e-13]
 ...
 [9.9999356e-01 6.4459068e-06 1.2042337e-12 9.7616394e-12 2.1088810e-12]
 [9.9999976e-01 2.2973025e-07 7.0501507e-14 1.2114911e-12 1.3116788e-13]
 [9.9999976e-01 1.9976163e-07 1.4693158e-13 3.0955813e-12 2.7480191e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.002914017506316304
tp :  99960.0
fp :  40.0
tn :  399960.0
fn :  40.0
accuracy :  0.9998400807380676
precision :  0.9995999932289124
recall :  0.9995999932289124
auc :  0.9999116063117981

y_eval {0: 100000}
pred {0: 99960, 1: 40}
[INFO] confusion matrix for file 
[[99960    40     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1068753     291       0       0       0]
 [ 101099       3       0       0       0]
 [  27050       2       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0398991e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.0398991e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0398991e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 1.7339792e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.7339792e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.7339792e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99999166e-01 8.04065223e-07 4.29019992e-13 1.04823615e-11
   6.47753281e-13]
  [9.99999762e-01 2.30435916e-07 6.95012461e-13 7.24864058e-11
   7.18555966e-13]
  [9.99998808e-01 1.24229030e-06 1.08137722e-13 1.86379059e-12
   1.83552433e-13]
  ...
  [9.99999881e-01 1.54095417e-07 2.06431240e-13 4.79807079e-12
   3.53274891e-13]
  [9.99959469e-01 4.05849023e-05 1.99730423e-12 1.64470677e-11
   2.34839080e-12]
  [9.99966502e-01 3.34493816e-05 3.90204091e-13 2.72220029e-12
   8.77281321e-13]]

 [[9.99998927e-01 1.09601638e-06 4.07771419e-13 8.63601638e-12
   6.34028474e-13]
  [9.99999762e-01 1.99966152e-07 4.63368601e-13 4.99182397e-11
   4.94479783e-13]
  [9.99991417e-01 8.55501366e-06 8.13542267e-13 6.44540584e-12
   1.38988148e-12]
  ...
  [9.99999881e-01 8.30762517e-08 6.43631402e-14 1.13363214e-12
   1.34234651e-13]
  [9.99999642e-01 3.34445247e-07 5.16792880e-13 1.07924867e-11
   7.88769928e-13]
  [9.99999762e-01 2.23058578e-07 1.28478093e-13 2.35188756e-12
   2.21987698e-13]]

 [[9.94691908e-01 5.30802412e-03 9.15087450e-11 7.52811591e-09
   1.09644106e-10]
  [9.99997139e-01 2.84905218e-06 1.29994019e-12 2.78008380e-11
   1.25025706e-12]
  [9.99987483e-01 1.25298529e-05 4.55386325e-13 2.75312802e-12
   7.84071430e-13]
  ...
  [9.99999762e-01 2.23674405e-07 9.03408208e-14 1.30736340e-12
   1.88758202e-13]
  [9.99999166e-01 8.45896352e-07 6.71074253e-13 9.98651682e-12
   1.09018805e-12]
  [9.99998331e-01 1.70701662e-06 4.85333182e-13 5.61097002e-12
   8.14683011e-13]]

 ...

 [[9.99967456e-01 3.25536930e-05 3.57764729e-12 2.35315573e-10
   4.06240363e-12]
  [9.99999881e-01 7.80391929e-08 2.81656399e-13 3.15530761e-11
   3.03674268e-13]
  [9.99996424e-01 3.60733929e-06 2.23492598e-13 3.47686094e-12
   3.27231786e-13]
  ...
  [9.99999881e-01 1.35075297e-07 1.23120982e-13 2.80542928e-12
   2.21732978e-13]
  [9.99998093e-01 1.85138708e-06 7.37809282e-13 8.07689853e-12
   1.27516064e-12]
  [9.99938726e-01 6.12758959e-05 1.38345021e-12 7.36923456e-12
   1.66226321e-12]]

 [[9.99999881e-01 1.36106152e-07 3.77150297e-13 9.80922028e-12
   6.64294628e-13]
  [1.00000000e+00 4.91284808e-08 6.36668249e-14 8.41809955e-12
   7.80598053e-14]
  [9.99980927e-01 1.90785613e-05 3.83214727e-12 4.17461413e-11
   6.17801383e-12]
  ...
  [9.99999166e-01 8.33250624e-07 1.70347325e-13 2.42263089e-12
   2.62207655e-13]
  [9.99998689e-01 1.26365842e-06 2.24627310e-13 2.38732775e-12
   4.18851423e-13]
  [9.99960184e-01 3.98406191e-05 1.44462415e-12 1.59785882e-11
   2.50792160e-12]]

 [[9.99769986e-01 2.29982485e-04 7.89814481e-12 4.30707053e-10
   9.28526093e-12]
  [9.99998450e-01 1.56918145e-06 1.96470206e-12 6.36679182e-11
   1.53746319e-12]
  [9.99839187e-01 1.60812866e-04 1.18229623e-12 2.24064474e-12
   2.36084871e-12]
  ...
  [9.99999881e-01 1.49785748e-07 9.80629152e-14 1.68283941e-12
   1.81096105e-13]
  [9.99966025e-01 3.39204307e-05 3.81747108e-12 9.65125896e-11
   6.80140666e-12]
  [9.99999404e-01 5.99809312e-07 1.53020839e-13 1.55038038e-12
   3.01511528e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.99999166e-01 8.04065223e-07 4.29019992e-13 1.04823615e-11
  6.47753281e-13]
 [9.99999762e-01 2.30435916e-07 6.95012461e-13 7.24864058e-11
  7.18555966e-13]
 [9.99998808e-01 1.24229030e-06 1.08137722e-13 1.86379059e-12
  1.83552433e-13]
 ...
 [9.99999881e-01 1.49785748e-07 9.80629152e-14 1.68283941e-12
  1.81096105e-13]
 [9.99966025e-01 3.39204307e-05 3.81747108e-12 9.65125896e-11
  6.80140666e-12]
 [9.99999404e-01 5.99809312e-07 1.53020839e-13 1.55038038e-12
  3.01511528e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.002006859493814409
tp :  99957.0
fp :  43.0
tn :  399957.0
fn :  43.0
accuracy :  0.999828040599823
precision :  0.9995700120925903
recall :  0.9995700120925903
auc :  0.9999998807907104

y_eval {0: 100000}
pred {0: 99957, 1: 43}
[INFO] confusion matrix for file 
[[99957    43     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1168710     334       0       0       0]
 [ 101099       3       0       0       0]
 [  27050       2       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2015-12-31_233049_114.log.part11_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1361 (0.2722%)
[INFO] ** orig:[0:99.9996%,2:0.0004%]
[INFO] ** type:[0:99.9994%,1:0.0004%,2:0.0002%]
[INFO] ** i/f_name:[2:99.9968%,3:0.0032%]
[INFO] ** i/f_dir:[1:99.9972%,0:0.0028%]
[INFO] ** src:[22:38.4512%,9:25.9642%,7:18.089%,1:17.4908%,14:0.0028%,11:0.0008%,21:0.0004%,15:0.0004%,2:0.0004%]
[INFO] ** dst:[21:43.3436%,10:21.0714%,8:18.0896%,9:17.4906%,15:0.0032%,22:0.001%,24:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** proto:[0:99.9964%,1:0.0032%,2:0.0004%]
[INFO] ** appi_name:[21:99.9956%,30:0.0032%,31:0.0002%,27:0.0002%,24:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.4512%,20:25.9642%,13:18.089%,6:17.4908%,17:0.0032%,10:0.0008%,16:0.0004%,14:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.9956%,-33.760870000000004:0.0042%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.999%,11:49.9966%,0:0.0042%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:25.9632%,1:21.0714%,5:18.0886%,4:17.4902%,2:17.3796%,0:0.007%]
[INFO] ** service:[0.0048200000000000005:99.9964%,-211.73542999999998:0.0032%,-186.43601999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:25.9636%,-0.32151:21.0714%,-1.27613:18.0886%,-0.23351:17.4904%,-0.33484:17.3798%,-71.33197:0.0032%,6.286230000000001:0.0008%,1.45709:0.0004%,-1.02014:0.0004%,-1.27347:0.0002%,11.862:0.0002%,-0.24950999999999998:0.0002%,1.47576:0.0002%,-0.24151:0.0002%,13.431270000000001:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:95.0874%,Single Stage Single Point:4.9126%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7336235  0.         0.        ...  1.         0.00482   -0.32151  ]
 [-1.7336235  0.         0.        ...  2.         0.00482   -0.33484  ]
 [-1.7336235  0.         0.        ...  3.         0.00482    1.45442  ]
 ...
 [-1.0400795  0.         0.        ...  3.         0.00482    1.45442  ]
 [-1.0400795  0.         0.        ...  1.         0.00482   -0.32151  ]
 [-1.0400795  0.         0.        ...  1.         0.00482   -0.32151  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.9985349e-01 1.4649316e-04 1.1936728e-11 8.3679724e-10 1.2887688e-11]
  [1.0000000e+00 4.5511527e-08 9.7720124e-14 1.3715100e-11 1.1246960e-13]
  [9.9999964e-01 3.9509746e-07 1.3073501e-13 3.1777669e-12 2.1564426e-13]
  ...
  [1.0000000e+00 3.1628627e-08 8.3445227e-14 3.2887185e-12 1.5155324e-13]
  [9.9999511e-01 4.8436514e-06 6.3982326e-13 5.8125518e-12 9.5015348e-13]
  [9.9885070e-01 1.1493209e-03 3.8257509e-12 1.4996586e-11 7.0157664e-12]]

 [[9.9999928e-01 6.8329808e-07 2.7382756e-13 4.7831101e-12 4.4875155e-13]
  [9.9999952e-01 5.0946539e-07 7.4488316e-13 2.9847586e-11 7.2747532e-13]
  [9.9999809e-01 1.9080207e-06 1.5678694e-13 3.7890984e-12 2.5864741e-13]
  ...
  [9.9998665e-01 1.3357385e-05 2.6417418e-13 8.5325280e-13 5.8667762e-13]
  [9.9999487e-01 5.1464590e-06 4.8103324e-13 4.2711602e-12 7.1785926e-13]
  [9.9981624e-01 1.8377756e-04 1.8027724e-12 6.2878916e-12 2.5479675e-12]]

 [[9.9997807e-01 2.1956568e-05 2.3661494e-12 8.6195169e-11 3.1686014e-12]
  [9.9999702e-01 2.9526984e-06 2.9104406e-12 6.4816784e-11 2.7748641e-12]
  [9.9510264e-01 4.8973053e-03 2.6663265e-11 1.0820096e-10 2.9562394e-11]
  ...
  [9.9996865e-01 3.1402600e-05 2.8335621e-13 8.1304597e-13 7.3488736e-13]
  [9.9999821e-01 1.8080758e-06 2.2361452e-13 2.8318697e-12 4.4260182e-13]
  [9.9999845e-01 1.5079477e-06 4.9333356e-13 5.1342064e-12 8.8396591e-13]]

 ...

 [[9.9497449e-01 5.0255018e-03 1.7082065e-10 1.9794522e-08 2.1610194e-10]
  [9.9999845e-01 1.5896146e-06 6.1952998e-13 1.5014191e-11 6.9462459e-13]
  [9.9997413e-01 2.5903844e-05 2.3928034e-12 1.7149629e-11 4.3575126e-12]
  ...
  [9.9999833e-01 1.6226186e-06 2.7932287e-13 2.9539663e-12 4.0187523e-13]
  [9.9999988e-01 6.4978110e-08 5.3415026e-14 1.7223099e-12 1.1918645e-13]
  [9.9999988e-01 9.1854830e-08 1.4521786e-13 3.9464239e-12 2.3599617e-13]]

 [[9.9994111e-01 5.8917802e-05 3.6915323e-12 1.5742788e-10 4.6614544e-12]
  [9.9999928e-01 6.8381047e-07 4.4321475e-13 1.3002585e-11 5.4060950e-13]
  [9.9998832e-01 1.1688331e-05 8.4487517e-13 8.4185792e-12 1.2444647e-12]
  ...
  [9.9999774e-01 2.2059287e-06 1.0796428e-13 6.9054880e-13 2.4819036e-13]
  [9.9999857e-01 1.4273085e-06 7.2865639e-13 1.0131845e-11 1.2257002e-12]
  [9.9988115e-01 1.1881731e-04 2.7185281e-12 1.8520912e-11 3.2164759e-12]]

 [[9.9999869e-01 1.3062928e-06 5.3056962e-13 1.4886105e-11 7.5164170e-13]
  [9.9999976e-01 2.3181728e-07 4.8942789e-13 3.5885492e-11 4.9561570e-13]
  [9.9999130e-01 8.6666359e-06 2.5505712e-13 5.9758812e-12 4.3318794e-13]
  ...
  [9.9999976e-01 2.3283360e-07 1.3547182e-13 2.1862210e-12 2.6927869e-13]
  [9.9999940e-01 6.5067962e-07 2.9135567e-13 5.8348708e-12 5.4203441e-13]
  [9.9999797e-01 2.0603645e-06 6.9352412e-13 7.2182156e-12 1.1766411e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9985349e-01 1.4649316e-04 1.1936728e-11 8.3679724e-10 1.2887688e-11]
 [1.0000000e+00 4.5511527e-08 9.7720124e-14 1.3715100e-11 1.1246960e-13]
 [9.9999964e-01 3.9509746e-07 1.3073501e-13 3.1777669e-12 2.1564426e-13]
 ...
 [9.9999976e-01 2.3283360e-07 1.3547182e-13 2.1862210e-12 2.6927869e-13]
 [9.9999940e-01 6.5067962e-07 2.9135567e-13 5.8348708e-12 5.4203441e-13]
 [9.9999797e-01 2.0603645e-06 6.9352412e-13 7.2182156e-12 1.1766411e-12]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0012207500100135803
tp :  99992.0
fp :  8.0
tn :  399992.0
fn :  8.0
accuracy :  0.9999679923057556
precision :  0.9999200105667114
recall :  0.9999200105667114
auc :  0.9999811053276062

y_eval {0: 100000}
pred {0: 99992, 1: 8}
[INFO] confusion matrix for file 
[[99992     8     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1268702     342       0       0       0]
 [ 101099       3       0       0       0]
 [  27050       2       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0400795e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0400795e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0400795e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [-3.4653556e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4653556e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-3.4653556e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99968290e-01 3.16673904e-05 3.24745027e-12 1.06979203e-10
   4.47365409e-12]
  [9.99996781e-01 3.21869265e-06 2.37060697e-12 5.15962620e-11
   2.19536542e-12]
  [9.96233046e-01 3.76697769e-03 1.87889287e-11 7.14153597e-11
   2.07281466e-11]
  ...
  [9.99999762e-01 2.07827426e-07 7.44299235e-14 9.59301106e-13
   1.71584603e-13]
  [9.99999762e-01 2.80588580e-07 2.24577857e-13 4.14321442e-12
   3.58309465e-13]
  [9.99996781e-01 3.25136125e-06 5.74881939e-13 4.09332377e-12
   1.09989741e-12]]

 [[9.99968529e-01 3.14639037e-05 3.23954470e-12 1.06567241e-10
   4.46484082e-12]
  [9.99996781e-01 3.22921687e-06 2.38151556e-12 5.17999810e-11
   2.20466852e-12]
  [9.99989152e-01 1.07907590e-05 4.06432673e-13 2.97356605e-12
   6.93454517e-13]
  ...
  [9.99998927e-01 1.04740013e-06 2.27063756e-13 2.66078457e-12
   3.93208984e-13]
  [9.99999762e-01 2.15589836e-07 1.14268607e-13 2.17676333e-12
   2.31201261e-13]
  [9.99994040e-01 5.98238239e-06 1.43563590e-12 1.50298541e-11
   2.37231046e-12]]

 [[9.99892235e-01 1.07700936e-04 1.18856617e-11 9.25366006e-10
   1.23784550e-11]
  [9.99999642e-01 3.05075389e-07 5.86535269e-13 2.54645870e-11
   4.80618258e-13]
  [9.99699354e-01 3.00630956e-04 7.54518843e-13 3.32245169e-12
   1.33848520e-12]
  ...
  [9.99997497e-01 2.48004039e-06 2.57223957e-13 2.09740862e-12
   5.74558955e-13]
  [9.99939442e-01 6.05869500e-05 3.24055648e-12 3.17842558e-11
   3.67545144e-12]
  [9.99998569e-01 1.43796797e-06 1.66503990e-13 1.20071899e-12
   3.65581697e-13]]

 ...

 [[9.99999404e-01 6.26089729e-07 2.71126681e-13 5.23655294e-12
   4.38089642e-13]
  [9.99999642e-01 3.46258275e-07 6.97833718e-13 3.42249978e-11
   7.20367234e-13]
  [9.99285638e-01 7.14373426e-04 8.78751932e-12 5.29376369e-11
   1.11516881e-11]
  ...
  [9.99999762e-01 1.90730432e-07 2.25748578e-13 4.93665829e-12
   3.68274476e-13]
  [9.99983907e-01 1.60564487e-05 1.30559821e-12 1.36477114e-11
   1.62996493e-12]
  [9.99862790e-01 1.37133073e-04 1.41360805e-12 4.88894602e-12
   1.82125387e-12]]

 [[9.99894142e-01 1.05818748e-04 5.41838059e-12 2.34752329e-10
   6.87206151e-12]
  [9.99999762e-01 2.52312930e-07 2.06289901e-13 9.74854485e-12
   2.49924755e-13]
  [9.99986887e-01 1.31045936e-05 1.07580015e-12 2.21619546e-11
   1.74024770e-12]
  ...
  [9.99991894e-01 8.07137531e-06 3.88041595e-13 2.18607034e-12
   6.39633312e-13]
  [9.99962687e-01 3.73256589e-05 1.29702260e-12 1.24874425e-11
   2.65091681e-12]
  [9.99998689e-01 1.28137629e-06 4.24691722e-13 4.49178802e-12
   7.37688719e-13]]

 [[9.99894619e-01 1.05401123e-04 5.40970871e-12 2.34196079e-10
   6.86306567e-12]
  [9.99999404e-01 6.29637441e-07 3.77893246e-13 1.25754780e-11
   4.48902254e-13]
  [9.99918818e-01 8.11790815e-05 2.00838890e-12 2.28370465e-11
   3.53701530e-12]
  ...
  [9.99995828e-01 4.18684385e-06 5.34217635e-13 9.36591429e-12
   9.26604930e-13]
  [9.99981523e-01 1.84759338e-05 5.42580141e-13 3.37300912e-12
   8.43988399e-13]
  [9.99990702e-01 9.32231069e-06 6.44981301e-13 3.47694703e-12
   1.35915812e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9996829e-01 3.1667390e-05 3.2474503e-12 1.0697920e-10 4.4736541e-12]
 [9.9999678e-01 3.2186927e-06 2.3706070e-12 5.1596262e-11 2.1953654e-12]
 [9.9623305e-01 3.7669777e-03 1.8788929e-11 7.1415360e-11 2.0728147e-11]
 ...
 [9.9999583e-01 4.1868439e-06 5.3421764e-13 9.3659143e-12 9.2660493e-13]
 [9.9998152e-01 1.8475934e-05 5.4258014e-13 3.3730091e-12 8.4398840e-13]
 [9.9999070e-01 9.3223107e-06 6.4498130e-13 3.4769470e-12 1.3591581e-12]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0009276425858959556
tp :  99991.0
fp :  9.0
tn :  399991.0
fn :  9.0
accuracy :  0.9999639987945557
precision :  0.9999099969863892
recall :  0.9999099969863892
auc :  0.9999938011169434

y_eval {0: 100000}
pred {0: 99991, 1: 9}
[INFO] confusion matrix for file 
[[99991     9     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1368693     351       0       0       0]
 [ 101099       3       0       0       0]
 [  27050       2       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-0.34653556  0.          0.         ...  3.          0.00482
   1.45442   ]
 [-0.34653556  0.          0.         ...  2.          0.00482
  -0.33484   ]
 [-0.34653556  0.          0.         ...  1.          0.00482
  -0.32151   ]
 ...
 [ 0.34700835  0.          0.         ...  4.          0.00482
  -0.23351   ]
 [ 0.34700835  0.          0.         ...  2.          0.00482
  -0.33484   ]
 [ 0.34700835  0.          0.         ...  3.          0.00482
   1.45442   ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99894977e-01 1.04984138e-04 5.40105070e-12 2.33640246e-10
   6.85409412e-12]
  [9.99999881e-01 1.20408927e-07 1.42627921e-13 9.77880884e-12
   1.70159758e-13]
  [9.99991059e-01 8.99791030e-06 8.62998421e-13 1.41201955e-11
   1.50750788e-12]
  ...
  [9.99978781e-01 2.11892711e-05 7.94150173e-13 5.71234379e-12
   1.03346617e-12]
  [9.99976516e-01 2.35098687e-05 3.70127757e-13 1.44275043e-12
   7.20115699e-13]
  [9.99999642e-01 4.09154666e-07 8.61275366e-14 1.19265394e-12
   2.11402754e-13]]

 [[9.99902368e-01 9.76111914e-05 4.71998959e-12 2.14039911e-10
   5.78463015e-12]
  [9.99995112e-01 4.89739659e-06 4.17452010e-12 9.89960405e-11
   3.64833858e-12]
  [9.97746170e-01 2.25382159e-03 4.41602744e-12 2.00714376e-11
   9.07138947e-12]
  ...
  [9.99999046e-01 9.34724767e-07 3.23907974e-13 4.45914703e-12
   5.47744033e-13]
  [9.99999762e-01 2.63113634e-07 1.24080461e-13 1.95283156e-12
   2.15906869e-13]
  [9.99999881e-01 1.51334163e-07 1.53804243e-13 3.25977201e-12
   2.58027486e-13]]

 [[9.99997497e-01 2.55398936e-06 1.18803567e-12 3.76303329e-11
   1.73146567e-12]
  [1.00000000e+00 9.53162349e-09 2.60469594e-14 6.29636881e-12
   2.83020338e-14]
  [9.99998093e-01 1.85042688e-06 6.85866836e-13 1.12128501e-11
   1.00255871e-12]
  ...
  [9.99999523e-01 4.74874867e-07 5.82556085e-13 1.10585412e-11
   9.15970316e-13]
  [9.99998569e-01 1.37140694e-06 4.46978690e-13 6.22616281e-12
   7.20928688e-13]
  [9.99998450e-01 1.55853422e-06 2.28375370e-13 2.30058680e-12
   3.88535151e-13]]

 ...

 [[9.99944091e-01 5.59202163e-05 1.13215635e-11 1.07531462e-09
   1.10367947e-11]
  [9.99999881e-01 1.58536054e-07 1.55435994e-13 1.59854109e-11
   1.40977006e-13]
  [9.99995589e-01 4.38282586e-06 5.47266930e-13 6.59503572e-12
   9.91409212e-13]
  ...
  [9.99999642e-01 3.41688775e-07 2.41219181e-13 4.74751922e-12
   3.50098639e-13]
  [9.99998569e-01 1.40192742e-06 4.28664726e-13 3.93668301e-12
   7.53151285e-13]
  [9.99996066e-01 3.99310375e-06 4.19552332e-13 3.51668976e-12
   5.39983260e-13]]

 [[9.99902010e-01 9.80061886e-05 5.24503921e-12 2.52665666e-10
   6.34223793e-12]
  [9.99997616e-01 2.39599285e-06 2.16618477e-12 5.77044974e-11
   2.05700604e-12]
  [9.99644160e-01 3.55891796e-04 4.32168927e-12 1.74550843e-11
   5.12022412e-12]
  ...
  [9.99998331e-01 1.67289704e-06 6.74791982e-13 7.35870392e-12
   1.16544914e-12]
  [9.99991179e-01 8.79719028e-06 4.74258924e-13 3.60478162e-12
   6.19856434e-13]
  [9.99999046e-01 9.00999908e-07 1.95929102e-13 2.01006768e-12
   3.72706992e-13]]

 [[9.96889532e-01 3.11050890e-03 8.70329364e-11 8.75550032e-09
   1.06047587e-10]
  [9.99999762e-01 2.81560261e-07 1.83158813e-13 8.98905863e-12
   2.09376705e-13]
  [9.99998689e-01 1.35545554e-06 4.92834289e-13 8.59560513e-12
   8.57601479e-13]
  ...
  [9.99999285e-01 7.14701912e-07 5.48764457e-14 4.56412523e-13
   1.49008708e-13]
  [9.99501109e-01 4.98935755e-04 1.37206574e-11 2.45851284e-10
   2.03652199e-11]
  [9.99999762e-01 2.00865429e-07 8.41837789e-14 1.09294941e-12
   1.78226574e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.99894977e-01 1.04984138e-04 5.40105070e-12 2.33640246e-10
  6.85409412e-12]
 [9.99999881e-01 1.20408927e-07 1.42627921e-13 9.77880884e-12
  1.70159758e-13]
 [9.99991059e-01 8.99791030e-06 8.62998421e-13 1.41201955e-11
  1.50750788e-12]
 ...
 [9.99999285e-01 7.14701912e-07 5.48764457e-14 4.56412523e-13
  1.49008708e-13]
 [9.99501109e-01 4.98935755e-04 1.37206574e-11 2.45851284e-10
  2.03652199e-11]
 [9.99999762e-01 2.00865429e-07 8.41837789e-14 1.09294941e-12
  1.78226574e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.9004139637708664
tp :  92622.0
fp :  7378.0
tn :  392622.0
fn :  7378.0
accuracy :  0.9704881310462952
precision :  0.9262199997901917
recall :  0.9262199997901917
auc :  0.9536489844322205

y_eval {0: 92639, 1: 7361}
pred {0: 99983, 1: 17}
[INFO] confusion matrix for file 
[[92622    17     0     0     0]
 [ 7361     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1461315     368       0       0       0]
 [ 108460       3       0       0       0]
 [  27050       2       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4700835e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 3.4700835e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4700835e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [ 1.0380025e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0380025e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.0380025e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 1 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.9690992e-01 3.0901565e-03 8.6819836e-11 8.7454817e-09 1.0578692e-10]
  [9.9999964e-01 3.3683568e-07 2.2049806e-13 1.0885685e-11 2.4306425e-13]
  [9.9995410e-01 4.5848778e-05 1.8229563e-12 1.7200521e-11 2.4738614e-12]
  ...
  [9.9999976e-01 2.1775369e-07 1.4705325e-13 2.5750545e-12 2.6463860e-13]
  [9.9998522e-01 1.4784002e-05 1.5468966e-12 1.9157131e-11 1.8719486e-12]
  [1.0000000e+00 3.9044149e-08 3.0495050e-14 6.3814817e-13 7.7974092e-14]]

 [[9.9999797e-01 1.9878551e-06 8.8871255e-13 2.6266812e-11 1.3407838e-12]
  [1.0000000e+00 1.2205440e-08 3.9276247e-14 1.0296774e-11 4.1503296e-14]
  [9.9999893e-01 1.1098871e-06 3.6282750e-13 8.0444037e-12 5.9524673e-13]
  ...
  [9.9999785e-01 2.1838791e-06 1.6787156e-13 2.2493509e-12 2.7122559e-13]
  [9.9999607e-01 3.9894726e-06 5.7115678e-13 4.1127917e-12 1.1206920e-12]
  [9.9994993e-01 5.0088478e-05 1.3700969e-12 8.8225260e-12 1.5928118e-12]]

 [[9.9990082e-01 9.9148565e-05 5.2932021e-12 2.5584421e-10 6.3997440e-12]
  [9.9999988e-01 1.1723967e-07 1.2453238e-13 8.7932639e-12 1.5274682e-13]
  [9.9999547e-01 4.5100687e-06 1.4650009e-12 1.8472682e-11 2.4988043e-12]
  ...
  [9.9982029e-01 1.7968637e-04 5.7618246e-12 7.0539664e-11 8.2027102e-12]
  [9.9999976e-01 2.1739473e-07 1.0310930e-13 1.4454944e-12 1.9660345e-13]
  [9.9997723e-01 2.2712538e-05 8.5963389e-12 2.2067438e-10 1.1815515e-11]]

 ...

 [[9.9677318e-01 3.2267633e-03 7.6989609e-11 7.0696617e-09 9.2183171e-11]
  [9.9999976e-01 2.7675819e-07 1.8501128e-13 9.1891252e-12 2.1045252e-13]
  [9.9999845e-01 1.5802327e-06 5.2742148e-13 9.0821786e-12 9.2147167e-13]
  ...
  [9.9999952e-01 5.0147742e-07 1.1469131e-13 1.5266354e-12 1.8451083e-13]
  [9.9999714e-01 2.8804952e-06 3.8783644e-13 6.0374847e-12 6.8784702e-13]
  [9.9994433e-01 5.5643923e-05 1.3596578e-12 9.6889111e-12 2.1807608e-12]]

 [[9.9999762e-01 2.3308339e-06 1.5204371e-12 5.9984073e-11 2.1745635e-12]
  [1.0000000e+00 6.0019185e-09 1.9868389e-14 5.2311653e-12 2.1448992e-14]
  [9.9989653e-01 1.0346525e-04 1.8844180e-11 3.5531883e-10 2.9175416e-11]
  ...
  [9.9999988e-01 1.1224919e-07 1.0384391e-13 2.4232151e-12 1.8308408e-13]
  [9.9999762e-01 2.3423340e-06 8.9411047e-13 9.1425331e-12 1.5904773e-12]
  [9.9999785e-01 2.1932192e-06 2.0799314e-13 2.2950238e-12 3.3686904e-13]]

 [[9.9999917e-01 8.0387122e-07 4.2898562e-13 1.0481802e-11 6.4772612e-13]
  [9.9999917e-01 8.0980533e-07 2.6505114e-13 7.4588169e-11 3.4664462e-13]
  [9.9986959e-01 1.3043928e-04 1.7432891e-12 6.5626111e-12 1.9904393e-12]
  ...
  [9.9961406e-01 3.8594549e-04 1.6920240e-12 5.0998164e-12 2.9110854e-12]
  [9.9997926e-01 2.0752688e-05 1.0727123e-12 7.6025531e-12 2.2323920e-12]
  [9.9999988e-01 1.3928226e-07 8.5732236e-14 1.4629130e-12 1.8526695e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9690992e-01 3.0901565e-03 8.6819836e-11 8.7454817e-09 1.0578692e-10]
 [9.9999964e-01 3.3683568e-07 2.2049806e-13 1.0885685e-11 2.4306425e-13]
 [9.9995410e-01 4.5848778e-05 1.8229563e-12 1.7200521e-11 2.4738614e-12]
 ...
 [9.9961406e-01 3.8594549e-04 1.6920240e-12 5.0998164e-12 2.9110854e-12]
 [9.9997926e-01 2.0752688e-05 1.0727123e-12 7.6025531e-12 2.2323920e-12]
 [9.9999988e-01 1.3928226e-07 8.5732236e-14 1.4629130e-12 1.8526695e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  2.1511702129364014
tp :  82745.0
fp :  17255.0
tn :  382745.0
fn :  17255.0
accuracy :  0.9309801459312439
precision :  0.8274499773979187
recall :  0.8274499773979187
auc :  0.8915676474571228

y_eval {0: 82798, 1: 17202}
pred {0: 99947, 1: 53}
[INFO] confusion matrix for file 
[[82745    53     0     0     0]
 [17202     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1544060     421       0       0       0]
 [ 125662       3       0       0       0]
 [  27050       2       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0380025e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.0380025e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0380025e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 ...
 [ 1.7315464e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.7315464e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.7315464e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99956012e-01 4.39314572e-05 1.12079096e-11 1.15465959e-09
   1.06385100e-11]
  [1.00000000e+00 8.34285796e-09 2.16171346e-14 6.40366362e-12
   2.37834756e-14]
  [9.99569476e-01 4.30468004e-04 8.96584543e-12 1.47646617e-10
   1.66830005e-11]
  ...
  [9.99991179e-01 8.76790000e-06 3.24665560e-13 6.18677982e-12
   5.19871039e-13]
  [9.99901295e-01 9.87143358e-05 5.68188617e-13 1.06213790e-12
   1.20894364e-12]
  [9.99997735e-01 2.22154722e-06 6.62574759e-13 6.66452267e-12
   1.21276025e-12]]

 [[9.99999166e-01 8.40802841e-07 3.71144982e-13 8.35344294e-12
   5.64697106e-13]
  [1.00000000e+00 3.73581557e-08 1.16326070e-13 2.17251338e-11
   1.23081084e-13]
  [9.99995947e-01 4.07531434e-06 1.73092064e-13 2.52282223e-12
   3.13589486e-13]
  ...
  [1.00000000e+00 4.62199452e-08 3.18829198e-14 6.89930318e-13
   6.03910842e-14]
  [9.99999762e-01 2.45530629e-07 8.87829239e-14 4.20616580e-12
   1.37028464e-13]
  [9.99986053e-01 1.40046068e-05 2.03818435e-13 6.59420218e-13
   3.81341199e-13]]

 [[9.99890208e-01 1.09742323e-04 5.50457856e-12 2.69263445e-10
   6.52808927e-12]
  [9.99995828e-01 4.17832780e-06 2.98801565e-12 7.31932709e-11
   2.65758596e-12]
  [9.99481261e-01 5.18789864e-04 1.95358443e-12 1.08036314e-11
   3.87376372e-12]
  ...
  [9.99954462e-01 4.55385707e-05 1.61706629e-12 1.09030831e-11
   1.87415946e-12]
  [9.99999762e-01 1.96051715e-07 7.47316366e-14 1.15012752e-12
   1.54950515e-13]
  [1.00000000e+00 5.87288156e-08 7.33916915e-14 2.75825044e-12
   1.25499546e-13]]

 ...

 [[9.99961734e-01 3.82138387e-05 1.12481075e-11 1.22467780e-09
   1.04856280e-11]
  [1.00000000e+00 2.48882230e-08 7.25448144e-14 1.54321885e-11
   8.13342449e-14]
  [9.99999166e-01 8.11345956e-07 1.02961456e-13 2.95183431e-12
   1.75806025e-13]
  ...
  [9.99994397e-01 5.60592707e-06 4.24330411e-13 3.89656623e-12
   7.36912105e-13]
  [9.99999523e-01 5.10535415e-07 1.72043369e-13 2.19419947e-12
   3.61049379e-13]
  [9.99999285e-01 7.70229008e-07 6.39311195e-13 9.76821402e-12
   1.03738979e-12]]

 [[9.99719203e-01 2.80823966e-04 8.49660533e-12 4.59263683e-10
   9.88620904e-12]
  [9.99999881e-01 1.71840952e-07 4.61481168e-13 2.61187339e-11
   5.22681399e-13]
  [9.99992728e-01 7.31500995e-06 4.13175624e-13 4.54789158e-12
   6.02865251e-13]
  ...
  [9.99993563e-01 6.47168463e-06 3.67192035e-13 2.65803612e-12
   6.80837873e-13]
  [9.99995828e-01 4.18441277e-06 7.51395853e-13 5.89489742e-12
   1.45093594e-12]
  [9.99999881e-01 1.02063396e-07 5.56910339e-14 1.01567355e-12
   9.70606787e-14]]

 [[9.99719441e-01 2.80534674e-04 8.49312374e-12 4.59079885e-10
   9.88277949e-12]
  [9.99999881e-01 1.72799531e-07 4.62979969e-13 2.61313401e-11
   5.24306889e-13]
  [9.99999404e-01 5.72364399e-07 1.31416986e-13 2.81429242e-12
   2.16394922e-13]
  ...
  [9.99999881e-01 1.36663218e-07 9.35567609e-14 2.16932375e-12
   1.61777452e-13]
  [9.99991417e-01 8.64108551e-06 7.78177598e-13 8.16980771e-12
   1.05756571e-12]
  [9.99999285e-01 6.80674418e-07 1.12790467e-13 1.10565929e-12
   2.33793995e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9995601e-01 4.3931457e-05 1.1207910e-11 1.1546596e-09 1.0638510e-11]
 [1.0000000e+00 8.3428580e-09 2.1617135e-14 6.4036636e-12 2.3783476e-14]
 [9.9956948e-01 4.3046800e-04 8.9658454e-12 1.4764662e-10 1.6683000e-11]
 ...
 [9.9999988e-01 1.3666322e-07 9.3556761e-14 2.1693237e-12 1.6177745e-13]
 [9.9999142e-01 8.6410855e-06 7.7817760e-13 8.1698077e-12 1.0575657e-12]
 [9.9999928e-01 6.8067442e-07 1.1279047e-13 1.1056593e-12 2.3379400e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0019083723209798336
tp :  99965.0
fp :  35.0
tn :  399965.0
fn :  35.0
accuracy :  0.9998599886894226
precision :  0.9996500015258789
recall :  0.9996500015258789
auc :  0.9999997615814209

y_eval {0: 100000}
pred {0: 99965, 1: 35}
[INFO] confusion matrix for file 
[[99965    35     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1644025     456       0       0       0]
 [ 125662       3       0       0       0]
 [  27050       2       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-01_151435_117.log.part03_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1365 (0.273%)
[INFO] ** orig:[0:99.9976%,2:0.0024%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9966%,3:0.0034%]
[INFO] ** i/f_dir:[1:99.9966%,0:0.0034%]
[INFO] ** src:[22:38.1462%,9:26.099%,7:18.1904%,1:17.5592%,21:0.0028%,14:0.001%,3:0.0006%,15:0.0004%,2:0.0004%]
[INFO] ** dst:[21:43.376%,10:20.8688%,8:18.1902%,9:17.5592%,15:0.0034%,22:0.0008%,18:0.0004%,16:0.0004%,6:0.0004%,24:0.0002%,2:0.0002%]
[INFO] ** proto:[0:99.9958%,1:0.0034%,2:0.0008%]
[INFO] ** appi_name:[21:99.9952%,30:0.0034%,7:0.0006%,31:0.0004%,26:0.0002%,22:0.0002%]
[INFO] ** proxy_src_ip:[18:38.1462%,20:26.099%,13:18.1904%,6:17.5592%,17:0.0034%,1:0.0006%,16:0.0004%,14:0.0004%,7:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.9952%,-33.760870000000004:0.0048%]
[INFO] ** modbus_function_description:[7:49.9978%,11:49.9974%,0:0.0048%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.0982%,1:20.8688%,5:18.19%,4:17.5588%,2:17.2772%,0:0.007%]
[INFO] ** service:[0.0048200000000000005:99.9952%,-211.73542999999998:0.0034%,-211.09762999999998:0.0006%,-186.43601999999998:0.0004%,-211.08346:0.0002%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:26.0986%,-0.32151:20.8688%,-1.27613:18.1902%,-0.23351:17.559%,-0.33484:17.2774%,-71.33197:0.0034%,-1.02014:0.0004%,-71.14931:0.0002%,-0.24151:0.0002%,4.42897:0.0002%,-71.14798:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,-0.78282:0.0002%,-2.92807:0.0002%,-4.88132:0.0002%,1.45709:0.0002%,9.18344:0.0002%]
[INFO] ** classification:[normal:84.2104%,Single Stage Single Point:15.7896%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7315832e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.7315832e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.7315832e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [-1.0377140e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0377140e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0377140e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 1 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.9895120e-01 1.0487520e-03 3.2127016e-11 1.8846178e-09 4.1714771e-11]
  [9.9999976e-01 2.3448233e-07 5.6781777e-13 2.2477093e-11 5.2524375e-13]
  [9.9948442e-01 5.1551231e-04 2.1955469e-12 6.5873917e-12 3.0698790e-12]
  ...
  [1.0000000e+00 3.9898836e-08 4.2647628e-14 2.9503114e-12 6.3646184e-14]
  [9.9999559e-01 4.3632167e-06 3.7807344e-13 2.9212594e-12 5.2922375e-13]
  [9.9999881e-01 1.1672842e-06 1.2326465e-13 1.1161769e-12 2.5786781e-13]]

 [[9.9999142e-01 8.6172049e-06 1.9626694e-12 4.8954656e-11 2.9409541e-12]
  [9.9999619e-01 3.8506414e-06 7.9746539e-13 1.0936509e-11 1.0572562e-12]
  [9.9979705e-01 2.0301522e-04 3.3643238e-12 2.5302770e-11 5.5902409e-12]
  ...
  [9.9999666e-01 3.3750430e-06 2.0952226e-13 1.8169071e-12 4.6450777e-13]
  [1.0000000e+00 4.3457565e-08 7.6907082e-14 2.0822829e-12 1.5209156e-13]
  [9.9999940e-01 5.6196285e-07 4.4956633e-13 1.1828517e-11 5.9850524e-13]]

 [[9.9880695e-01 1.1930469e-03 3.5398427e-11 2.1133437e-09 4.5908947e-11]
  [9.9999988e-01 1.3022414e-07 1.2672942e-13 7.5388853e-12 1.5559707e-13]
  [9.9995434e-01 4.5629899e-05 4.0957506e-12 3.6836558e-11 7.5066030e-12]
  ...
  [9.9998832e-01 1.1702084e-05 2.2952457e-13 9.7877782e-13 5.2472301e-13]
  [9.9999690e-01 3.1255993e-06 4.7384481e-13 7.6796399e-12 5.5243489e-13]
  [9.9999571e-01 4.3370187e-06 2.5860138e-13 1.9354401e-12 5.2296242e-13]]

 ...

 [[9.9992216e-01 7.7796067e-05 1.1429429e-11 9.4981023e-10 1.1693376e-11]
  [9.9999928e-01 6.5752511e-07 4.1346212e-13 2.3234678e-11 3.6245545e-13]
  [9.9988639e-01 1.1354978e-04 1.0839695e-12 7.7068022e-12 2.0658241e-12]
  ...
  [9.9999344e-01 6.5836111e-06 1.2314303e-12 1.9953549e-11 2.2364042e-12]
  [9.9999905e-01 9.9191698e-07 4.4877798e-13 5.2961056e-12 7.8346607e-13]
  [9.9999976e-01 2.0379251e-07 7.8657011e-14 1.5283314e-12 1.4195268e-13]]

 [[9.9994600e-01 5.4023501e-05 3.5661047e-12 1.5061108e-10 4.5219813e-12]
  [9.9999964e-01 3.3118084e-07 9.8523024e-13 3.7835457e-11 9.4128308e-13]
  [9.9858618e-01 1.4138158e-03 3.6399338e-12 6.4283982e-12 4.8832904e-12]
  ...
  [9.9999821e-01 1.8201204e-06 6.0191717e-13 5.9531811e-12 1.0724646e-12]
  [9.9999988e-01 9.8580244e-08 5.8434879e-14 1.2682888e-12 1.0939668e-13]
  [9.9998569e-01 1.4356838e-05 2.0640755e-12 3.7015061e-11 2.3264374e-12]]

 [[9.9475348e-01 5.2465033e-03 1.7236990e-10 1.9649756e-08 2.1775554e-10]
  [1.0000000e+00 6.0422236e-09 7.3377129e-14 4.7371005e-12 1.0189738e-13]
  [9.9997413e-01 2.5916395e-05 1.0142323e-12 9.5843203e-12 1.1837466e-12]
  ...
  [9.9999404e-01 5.9920317e-06 3.9672212e-13 2.4893295e-12 7.3716207e-13]
  [9.9999762e-01 2.3647929e-06 3.5337789e-13 2.6604259e-12 6.6164522e-13]
  [9.9999988e-01 1.5015173e-07 1.0630021e-13 2.0457423e-12 2.0090449e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9895120e-01 1.0487520e-03 3.2127016e-11 1.8846178e-09 4.1714771e-11]
 [9.9999976e-01 2.3448233e-07 5.6781777e-13 2.2477093e-11 5.2524375e-13]
 [9.9948442e-01 5.1551231e-04 2.1955469e-12 6.5873917e-12 3.0698790e-12]
 ...
 [9.9999404e-01 5.9920317e-06 3.9672212e-13 2.4893295e-12 7.3716207e-13]
 [9.9999762e-01 2.3647929e-06 3.5337789e-13 2.6604259e-12 6.6164522e-13]
 [9.9999988e-01 1.5015173e-07 1.0630021e-13 2.0457423e-12 2.0090449e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  3.3388169998168946
tp :  70698.0
fp :  29302.0
tn :  370698.0
fn :  29302.0
accuracy :  0.8827928304672241
precision :  0.7069799900054932
recall :  0.7069799900054932
auc :  0.8195775747299194

y_eval {0: 70708, 1: 29292}
pred {0: 99988, 1: 12}
[INFO] confusion matrix for file 
[[70697    11     0     0     0]
 [29291     1     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1714722     467       0       0       0]
 [ 154953       4       0       0       0]
 [  27050       2       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.037714e+00  0.000000e+00  0.000000e+00 ...  5.000000e+00
   4.820000e-03 -1.276130e+00]
 [-1.037714e+00  0.000000e+00  0.000000e+00 ...  3.000000e+00
   4.820000e-03  1.454420e+00]
 [-1.037714e+00  0.000000e+00  0.000000e+00 ...  4.000000e+00
   4.820000e-03 -2.335100e-01]
 ...
 [-3.463864e-01  0.000000e+00  0.000000e+00 ...  5.000000e+00
   4.820000e-03 -1.276130e+00]
 [-3.463864e-01  0.000000e+00  0.000000e+00 ...  2.000000e+00
   4.820000e-03 -3.348400e-01]
 [-3.463864e-01  0.000000e+00  0.000000e+00 ...  3.000000e+00
   4.820000e-03  1.454420e+00]] shape (100000, 16)
y_test [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [1 0 1 ... 1 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.9999702e-01 3.0257768e-06 1.3114156e-12 4.2121934e-11 1.8800896e-12]
  [1.0000000e+00 9.6530695e-09 2.4365604e-14 5.4498532e-12 2.6740991e-14]
  [9.9995172e-01 4.8320249e-05 2.9598745e-12 2.8093597e-11 3.4735704e-12]
  ...
  [9.9999893e-01 1.0210268e-06 1.8069674e-13 2.0281021e-12 2.8392474e-13]
  [9.9683893e-01 3.1610229e-03 1.3417979e-11 8.8887127e-11 2.2659917e-11]
  [9.9999928e-01 7.0621167e-07 1.1708103e-13 1.0698813e-12 2.5474509e-13]]

 [[9.9480528e-01 5.1946584e-03 1.7197821e-10 1.9678009e-08 2.1732828e-10]
  [9.9999952e-01 5.3533154e-07 2.4090926e-13 9.4567071e-12 2.6904911e-13]
  [9.9995410e-01 4.5936176e-05 2.7025439e-12 3.3574560e-11 2.7959742e-12]
  ...
  [9.9999833e-01 1.6647217e-06 9.5724657e-14 8.2656912e-13 2.4348571e-13]
  [9.9999988e-01 9.1916519e-08 1.3342218e-13 3.3382784e-12 2.3517925e-13]
  [9.9999905e-01 9.8581916e-07 2.1877284e-13 4.1195558e-12 3.8812725e-13]]

 [[9.9999917e-01 8.4041966e-07 4.1166007e-13 1.0559539e-11 6.6146708e-13]
  [9.9999988e-01 8.2938037e-08 1.7425379e-13 2.7167320e-11 1.7701105e-13]
  [9.9999785e-01 2.1057795e-06 1.9478904e-13 4.2775319e-12 3.4290900e-13]
  ...
  [9.9999547e-01 4.5457496e-06 4.1875103e-13 2.5136037e-12 8.2341333e-13]
  [1.0000000e+00 3.1933290e-08 3.9880988e-14 1.2329849e-12 8.2428557e-14]
  [9.9999762e-01 2.4397755e-06 4.4789313e-13 9.6053911e-12 6.9446765e-13]]

 ...

 [[9.9999726e-01 2.6998607e-06 1.1930357e-12 3.8372958e-11 1.7650228e-12]
  [1.0000000e+00 3.6986219e-08 4.9372947e-14 5.5530190e-12 5.3516602e-14]
  [9.9999845e-01 1.5256545e-06 3.6716092e-13 4.4967159e-12 5.1290553e-13]
  ...
  [9.9999654e-01 3.4398179e-06 6.6693179e-13 1.0483994e-11 1.1368525e-12]
  [9.9999976e-01 2.5934440e-07 9.5597812e-14 1.2440423e-12 2.0898252e-13]
  [9.9994469e-01 5.5321754e-05 3.7895251e-12 5.0197235e-11 4.3516367e-12]]

 [[9.9390161e-01 6.0983826e-03 1.3301200e-10 1.2506302e-08 1.6395839e-10]
  [9.9999678e-01 3.2753437e-06 8.1254019e-13 1.0986044e-11 1.0134470e-12]
  [9.9999893e-01 1.0671329e-06 2.9519334e-13 6.1606983e-12 5.1404773e-13]
  ...
  [9.9999940e-01 5.8193200e-07 4.3351873e-13 6.3608953e-12 7.0272211e-13]
  [9.9999952e-01 4.9201583e-07 1.0071327e-13 1.6751851e-12 1.8709856e-13]
  [9.9999869e-01 1.2788663e-06 5.3213646e-13 6.5774062e-12 9.2251814e-13]]

 [[9.9990845e-01 9.1577182e-05 4.6077521e-12 2.0819196e-10 5.6603290e-12]
  [9.9999630e-01 3.7023740e-06 3.6484613e-12 9.2816650e-11 3.0641195e-12]
  [9.9277872e-01 7.2212825e-03 1.9748663e-11 4.4164110e-11 2.3799589e-11]
  ...
  [9.9998832e-01 1.1722456e-05 4.8956228e-13 2.6480888e-12 7.1856280e-13]
  [9.7083288e-01 2.9167090e-02 2.7068046e-11 7.4751108e-11 4.9459888e-11]
  [9.9999750e-01 2.4899512e-06 1.6179958e-13 8.9941780e-13 3.3582260e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999702e-01 3.0257768e-06 1.3114156e-12 4.2121934e-11 1.8800896e-12]
 [1.0000000e+00 9.6530695e-09 2.4365604e-14 5.4498532e-12 2.6740991e-14]
 [9.9995172e-01 4.8320249e-05 2.9598745e-12 2.8093597e-11 3.4735704e-12]
 ...
 [9.9998832e-01 1.1722456e-05 4.8956228e-13 2.6480888e-12 7.1856280e-13]
 [9.7083288e-01 2.9167090e-02 2.7068046e-11 7.4751108e-11 4.9459888e-11]
 [9.9999750e-01 2.4899512e-06 1.6179958e-13 8.9941780e-13 3.3582260e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  4.217747708129883
tp :  64205.0
fp :  35795.0
tn :  364205.0
fn :  35795.0
accuracy :  0.8568209409713745
precision :  0.64205002784729
recall :  0.64205002784729
auc :  0.7783635258674622

y_eval {0: 64215, 1: 35785}
pred {0: 99990, 1: 10}
[INFO] confusion matrix for file 
[[64205    10     0     0     0]
 [35785     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1778927     477       0       0       0]
 [ 190738       4       0       0       0]
 [  27050       2       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4638640e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4638640e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4638640e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [ 3.4494117e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4494117e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4494117e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 1 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99992967e-01 7.08872858e-06 1.45573289e-12 6.48942011e-11
   1.84750566e-12]
  [9.99999881e-01 7.24746343e-08 2.13064511e-13 3.19695589e-11
   2.25083054e-13]
  [9.99991655e-01 8.33047761e-06 4.67549881e-13 6.29255849e-12
   5.68242176e-13]
  ...
  [9.95610178e-01 4.38979501e-03 7.00671682e-12 1.75153139e-11
   1.56403692e-11]
  [9.99999642e-01 3.25475980e-07 9.49472502e-14 1.08658677e-12
   1.94970776e-13]
  [9.99999881e-01 9.95634224e-08 1.20168686e-13 2.83001140e-12
   2.07263297e-13]]

 [[9.99992609e-01 7.34541845e-06 1.48229953e-12 6.63563579e-11
   1.87932135e-12]
  [9.99999881e-01 7.25105807e-08 2.13908223e-13 3.19746798e-11
   2.26053659e-13]
  [9.99991775e-01 8.22187576e-06 4.63110453e-13 6.26358080e-12
   5.63228988e-13]
  ...
  [9.99999285e-01 6.67066104e-07 1.95615117e-13 2.38151686e-12
   3.75820902e-13]
  [9.99510527e-01 4.89459431e-04 4.08764385e-12 4.42732517e-11
   7.30056293e-12]
  [9.99999404e-01 5.70851114e-07 1.25505197e-13 1.28689041e-12
   2.40790704e-13]]

 [[9.99997854e-01 2.16133026e-06 7.19133195e-13 1.93786463e-11
   1.12745631e-12]
  [1.00000000e+00 1.60420655e-08 6.08555700e-14 1.25361145e-11
   6.32893125e-14]
  [9.99988914e-01 1.10542396e-05 6.58689249e-13 1.61720932e-11
   1.25831604e-12]
  ...
  [9.99999881e-01 9.78821433e-08 4.28970146e-14 7.40055749e-13
   9.51931540e-14]
  [1.00000000e+00 2.75205512e-08 7.42137607e-14 2.53616767e-12
   1.34003418e-13]
  [9.99974489e-01 2.54911374e-05 1.31962095e-12 5.09048984e-11
   2.03919629e-12]]

 ...

 [[9.93075728e-01 6.92427484e-03 1.09755718e-10 8.81122642e-09
   1.32629005e-10]
  [9.99999046e-01 9.48441823e-07 5.19351868e-13 1.51931818e-11
   5.76733865e-13]
  [9.99998927e-01 1.08189181e-06 3.28430642e-13 5.70418409e-12
   5.83377422e-13]
  ...
  [9.99999881e-01 9.44998533e-08 7.89142921e-14 1.57398237e-12
   1.56976930e-13]
  [9.99999881e-01 1.43635319e-07 1.77330725e-13 5.77116436e-12
   2.60294390e-13]
  [9.99981642e-01 1.83029988e-05 5.16794398e-13 6.25229772e-12
   8.64458082e-13]]

 [[9.99888062e-01 1.11981499e-04 5.23012102e-12 2.45168497e-10
   6.30557802e-12]
  [9.99999642e-01 3.57176475e-07 5.85373004e-13 2.11985637e-11
   6.66927559e-13]
  [9.99997973e-01 1.98106454e-06 2.32301944e-13 3.97872664e-12
   3.86073524e-13]
  ...
  [9.99942064e-01 5.78747931e-05 8.09033342e-13 4.31521702e-12
   1.54849777e-12]
  [9.99711215e-01 2.88733572e-04 3.13512324e-12 1.13825546e-11
   3.34361640e-12]
  [9.99997377e-01 2.62078856e-06 5.33092450e-14 3.01648978e-13
   1.55102724e-13]]

 [[9.99888420e-01 1.11509224e-04 5.22297526e-12 2.44832599e-10
   6.29749204e-12]
  [9.99999642e-01 3.57431702e-07 5.85987368e-13 2.12163620e-11
   6.67563877e-13]
  [9.99981999e-01 1.80362313e-05 6.23997815e-13 4.03861319e-12
   8.94613322e-13]
  ...
  [9.99998927e-01 1.06247080e-06 2.58800576e-13 3.16967719e-12
   4.44536172e-13]
  [9.99999762e-01 1.82900692e-07 1.47073177e-13 3.25297059e-12
   2.76913908e-13]
  [9.99989629e-01 1.04157380e-05 1.17265681e-12 1.70085491e-11
   1.27775731e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999297e-01 7.0887286e-06 1.4557329e-12 6.4894201e-11 1.8475057e-12]
 [9.9999988e-01 7.2474634e-08 2.1306451e-13 3.1969559e-11 2.2508305e-13]
 [9.9999166e-01 8.3304776e-06 4.6754988e-13 6.2925585e-12 5.6824218e-13]
 ...
 [9.9999893e-01 1.0624708e-06 2.5880058e-13 3.1696772e-12 4.4453617e-13]
 [9.9999976e-01 1.8290069e-07 1.4707318e-13 3.2529706e-12 2.7691391e-13]
 [9.9998963e-01 1.0415738e-05 1.1726568e-12 1.7008549e-11 1.2777573e-12]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  1.6737807163387537
tp :  86103.0
fp :  13897.0
tn :  386103.0
fn :  13897.0
accuracy :  0.944412350654602
precision :  0.8610299825668335
recall :  0.8610299825668335
auc :  0.9137288331985474

y_eval {0: 86129, 1: 13871}
pred {0: 99974, 1: 26}
[INFO] confusion matrix for file 
[[86103    26     0     0     0]
 [13871     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1865030     503       0       0       0]
 [ 204609       4       0       0       0]
 [  27050       2       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 0.34494117  0.          0.         ...  4.          0.00482
  -0.23351   ]
 [ 0.34494117  0.          0.         ...  3.          0.00482
   1.45442   ]
 [ 0.34494117  0.          0.         ...  1.          0.00482
  -0.32151   ]
 ...
 [ 1.0388104   0.          0.         ...  3.          0.00482
   1.45442   ]
 [ 1.0388104   0.          0.         ...  2.          0.00482
  -0.33484   ]
 [ 1.0388104   0.          0.         ...  4.          0.00482
  -0.23351   ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99999642e-01 3.18596790e-07 7.18007847e-13 1.56074841e-11
   1.22007786e-12]
  [1.00000000e+00 4.58669049e-08 4.07114189e-14 4.92095947e-12
   5.47195007e-14]
  [9.99936938e-01 6.30223003e-05 5.46062197e-12 5.60664917e-11
   9.40153337e-12]
  ...
  [9.99999523e-01 5.32313663e-07 1.69782320e-13 2.30288076e-12
   3.66465186e-13]
  [9.99997258e-01 2.76605920e-06 1.56819176e-12 3.15282696e-11
   2.33365931e-12]
  [9.99999762e-01 1.97555067e-07 8.34687747e-14 1.23715177e-12
   1.63257862e-13]]

 [[9.99997854e-01 2.14033844e-06 1.20616971e-12 4.43961708e-11
   1.75880339e-12]
  [9.99999881e-01 9.03140531e-08 2.63987291e-13 1.95083377e-11
   2.79699685e-13]
  [9.99998808e-01 1.20559025e-06 1.70358966e-13 4.01580635e-12
   2.98332485e-13]
  ...
  [9.99984980e-01 1.50708565e-05 5.75058339e-13 3.45586927e-12
   8.24401040e-13]
  [9.99880910e-01 1.19112032e-04 1.52876203e-12 4.89324206e-12
   2.01058549e-12]
  [9.99993801e-01 6.24290715e-06 1.07984659e-13 7.71375856e-13
   2.81039162e-13]]

 [[9.99889374e-01 1.10572153e-04 5.20884334e-12 2.44172016e-10
   6.28153085e-12]
  [9.99999642e-01 3.80406021e-07 2.58609811e-13 9.82344761e-12
   3.22840496e-13]
  [9.99998212e-01 1.73625097e-06 3.50334616e-13 5.57427498e-12
   5.66583510e-13]
  ...
  [9.99988556e-01 1.13920914e-05 8.29837230e-13 1.06883009e-11
   9.41969484e-13]
  [9.99999881e-01 1.09296067e-07 5.39285142e-14 9.93120625e-13
   1.08726030e-13]
  [9.99999642e-01 3.43508987e-07 4.34277749e-13 1.05191194e-11
   7.30477256e-13]]

 ...

 [[9.97817993e-01 2.18195003e-03 4.00755505e-11 2.42823761e-09
   5.05245672e-11]
  [9.99999642e-01 3.55238456e-07 2.49652214e-13 9.02582262e-12
   3.03396875e-13]
  [9.99999046e-01 9.09807113e-07 2.94945763e-13 5.33526175e-12
   4.51794255e-13]
  ...
  [9.99993920e-01 6.04717070e-06 4.02501735e-13 3.63378511e-12
   5.23735081e-13]
  [9.97168601e-01 2.83136615e-03 6.93435240e-12 1.44580823e-11
   8.63145493e-12]
  [9.99991894e-01 8.16204829e-06 1.43241267e-13 6.31145255e-13
   3.61771810e-13]]

 [[9.99882102e-01 1.17871416e-04 5.53849761e-12 2.68541661e-10
   6.57082201e-12]
  [9.99999762e-01 1.82424770e-07 5.28548071e-13 2.23299278e-11
   5.31380387e-13]
  [9.98888195e-01 1.11178146e-03 1.37457797e-12 3.16377198e-12
   2.24667051e-12]
  ...
  [9.99997377e-01 2.67311884e-06 6.01890282e-13 5.82136379e-12
   1.03988194e-12]
  [9.99999762e-01 2.01411538e-07 1.04311789e-13 1.62101203e-12
   1.94645312e-13]
  [9.99964476e-01 3.55416742e-05 2.17035591e-12 1.86224213e-11
   2.55396550e-12]]

 [[9.99999762e-01 2.03454434e-07 5.46786195e-13 1.69238720e-11
   9.76337067e-13]
  [9.99999881e-01 8.40479899e-08 4.15371269e-13 3.10908035e-11
   4.30007484e-13]
  [9.99987006e-01 1.29893897e-05 2.20371667e-13 3.05765157e-12
   4.63126770e-13]
  ...
  [1.00000000e+00 1.72700112e-08 5.03738286e-14 1.91386663e-12
   9.50556433e-14]
  [9.99999642e-01 3.84247585e-07 6.06863464e-13 1.40284277e-11
   8.69525589e-13]
  [9.99889493e-01 1.10436114e-04 2.06525118e-12 9.83950421e-12
   2.53646778e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.99999642e-01 3.18596790e-07 7.18007847e-13 1.56074841e-11
  1.22007786e-12]
 [1.00000000e+00 4.58669049e-08 4.07114189e-14 4.92095947e-12
  5.47195007e-14]
 [9.99936938e-01 6.30223003e-05 5.46062197e-12 5.60664917e-11
  9.40153337e-12]
 ...
 [1.00000000e+00 1.72700112e-08 5.03738286e-14 1.91386663e-12
  9.50556433e-14]
 [9.99999642e-01 3.84247585e-07 6.06863464e-13 1.40284277e-11
  8.69525589e-13]
 [9.99889493e-01 1.10436114e-04 2.06525118e-12 9.83950421e-12
  2.53646778e-12]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.001843653535656631
tp :  99975.0
fp :  25.0
tn :  399975.0
fn :  25.0
accuracy :  0.9998999834060669
precision :  0.999750018119812
recall :  0.999750018119812
auc :  0.9999808669090271

y_eval {0: 100000}
pred {0: 99975, 1: 25}
[INFO] confusion matrix for file 
[[99975    25     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[1965005     528       0       0       0]
 [ 204609       4       0       0       0]
 [  27050       2       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0388104e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0388104e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.0388104e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [ 1.7326796e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.7326796e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.7326796e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99765575e-01 2.34474515e-04 7.78606433e-12 4.03288680e-10
   9.27046113e-12]
  [9.99995947e-01 4.03036347e-06 3.54058211e-12 1.04154886e-10
   2.72984066e-12]
  [9.99797642e-01 2.02426469e-04 1.63248299e-12 4.23850018e-12
   2.33151649e-12]
  ...
  [9.97940719e-01 2.05927948e-03 4.68852908e-11 5.14950194e-10
   6.73963177e-11]
  [9.99998331e-01 1.62494757e-06 4.27901692e-13 3.87908108e-12
   7.52987408e-13]
  [1.00000000e+00 2.22179786e-08 4.81676263e-14 1.66881396e-12
   9.06575840e-14]]

 [[9.99997258e-01 2.79548999e-06 1.63303637e-12 6.12309856e-11
   2.33401536e-12]
  [1.00000000e+00 4.02964559e-08 9.62210793e-14 1.09961840e-11
   9.92340026e-14]
  [9.99998569e-01 1.45914942e-06 3.58426586e-13 1.02836090e-11
   5.97330074e-13]
  ...
  [9.99992847e-01 7.19361924e-06 6.65079753e-13 3.62671850e-12
   1.35185222e-12]
  [9.99999642e-01 3.43361251e-07 1.17057853e-13 2.00373377e-12
   2.01847016e-13]
  [9.99999523e-01 4.72683922e-07 1.77424725e-13 2.44144180e-12
   3.26469103e-13]]

 [[9.96822715e-01 3.17730382e-03 5.38578314e-11 3.40072881e-09
   6.78175086e-11]
  [9.99999642e-01 3.64763736e-07 2.84828042e-13 1.02361843e-11
   3.42290080e-13]
  [9.99956846e-01 4.31780281e-05 2.15800143e-12 2.01256563e-11
   2.46526714e-12]
  ...
  [9.99999523e-01 5.14817884e-07 1.88816478e-13 2.45812767e-12
   3.84524959e-13]
  [9.99999166e-01 7.94550544e-07 5.53676625e-13 7.79087038e-12
   9.05954999e-13]
  [9.99999881e-01 1.34339317e-07 8.95530259e-14 2.04254517e-12
   1.59319457e-13]]

 ...

 [[9.99958992e-01 4.09758904e-05 1.12120695e-11 1.19222299e-09
   1.05240894e-11]
  [1.00000000e+00 5.58404381e-08 4.52480054e-14 1.21955319e-11
   5.36678856e-14]
  [9.99998927e-01 1.09661346e-06 2.56224431e-13 4.18359921e-12
   4.43821981e-13]
  ...
  [9.99999285e-01 7.17954322e-07 2.95924038e-13 3.20646656e-12
   5.51256306e-13]
  [9.99999762e-01 2.54204565e-07 1.15088847e-13 2.14449183e-12
   1.85505975e-13]
  [9.99880195e-01 1.19780620e-04 2.92950321e-12 1.97000905e-11
   3.28811132e-12]]

 [[9.99908090e-01 9.19431186e-05 5.10569712e-12 2.56599630e-10
   5.98992210e-12]
  [1.00000000e+00 1.50822608e-08 4.00168451e-14 1.03127723e-11
   4.98858123e-14]
  [9.99998808e-01 1.14548652e-06 3.52545521e-13 1.02003146e-11
   5.95298875e-13]
  ...
  [9.99995470e-01 4.49808886e-06 6.99124461e-13 5.07396946e-12
   1.24848439e-12]
  [9.99999642e-01 3.78111480e-07 1.39836669e-13 1.97674407e-12
   2.58242104e-13]
  [9.99999166e-01 7.88586874e-07 2.52686923e-13 3.49943121e-12
   4.36997958e-13]]

 [[9.99723017e-01 2.76957900e-04 8.45060827e-12 4.56870652e-10
   9.84039933e-12]
  [9.99998689e-01 1.31783713e-06 1.75713177e-12 5.64624215e-11
   1.38128137e-12]
  [9.99430120e-01 5.69855503e-04 1.48925967e-12 2.81782930e-12
   2.24611519e-12]
  ...
  [9.99999046e-01 9.07280537e-07 3.95998338e-13 5.34702838e-12
   6.46839624e-13]
  [9.99983311e-01 1.66821283e-05 6.96960393e-13 5.27592857e-12
   9.36657869e-13]
  [9.99994874e-01 5.13049827e-06 2.22150965e-13 1.73273646e-12
   4.96649434e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.99765575e-01 2.34474515e-04 7.78606433e-12 4.03288680e-10
  9.27046113e-12]
 [9.99995947e-01 4.03036347e-06 3.54058211e-12 1.04154886e-10
  2.72984066e-12]
 [9.99797642e-01 2.02426469e-04 1.63248299e-12 4.23850018e-12
  2.33151649e-12]
 ...
 [9.99999046e-01 9.07280537e-07 3.95998338e-13 5.34702838e-12
  6.46839624e-13]
 [9.99983311e-01 1.66821283e-05 6.96960393e-13 5.27592857e-12
  9.36657869e-13]
 [9.99994874e-01 5.13049827e-06 2.22150965e-13 1.73273646e-12
  4.96649434e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.00269936207793653
tp :  99942.0
fp :  58.0
tn :  399942.0
fn :  58.0
accuracy :  0.9997679591178894
precision :  0.9994199872016907
recall :  0.9994199872016907
auc :  0.9999803304672241

y_eval {0: 100000}
pred {0: 99942, 1: 58}
[INFO] confusion matrix for file 
[[99942    58     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[2064947     586       0       0       0]
 [ 204609       4       0       0       0]
 [  27050       2       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-01_151435_117.log.part12_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1377 (0.2754%)
[INFO] ** orig:[0:99.9964%,2:0.0036%]
[INFO] ** type:[0:99.9994%,1:0.0004%,2:0.0002%]
[INFO] ** i/f_name:[2:99.996%,3:0.004%]
[INFO] ** i/f_dir:[1:99.9964%,0:0.0036%]
[INFO] ** src:[22:38.049%,9:26.1306%,7:18.2264%,1:17.587%,21:0.0036%,11:0.0014%,10:0.001%,14:0.0004%,15:0.0002%,8:0.0002%,4:0.0002%]
[INFO] ** dst:[21:43.355%,10:20.8256%,8:18.226%,9:17.5868%,15:0.004%,6:0.001%,22:0.0006%,25:0.0004%,24:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** proto:[0:99.9942%,1:0.004%,2:0.0018%]
[INFO] ** appi_name:[21:99.9932%,30:0.004%,22:0.0006%,26:0.0004%,0:0.0004%,31:0.0002%,27:0.0002%,24:0.0002%,16:0.0002%,15:0.0002%,5:0.0002%,3:0.0002%]
[INFO] ** proxy_src_ip:[18:38.049%,20:26.1306%,13:18.2264%,6:17.587%,17:0.004%,10:0.0014%,11:0.001%,21:0.0002%,16:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9932%,-33.760870000000004:0.0066%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9974%,11:49.9958%,0:0.0066%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.13%,1:20.8244%,5:18.2258%,4:17.5864%,2:17.2242%,0:0.0092%]
[INFO] ** service:[0.0048200000000000005:99.9942%,-211.73542999999998:0.004%,-211.08818:0.0006%,-186.44547:0.0004%,-211.08346:0.0004%,-186.43601999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:26.1304%,-0.32151:20.8246%,-1.27613:18.226%,-0.23351:17.5866%,-0.33484:17.2244%,-71.33197:0.004%,-6.49859:0.0008%,-71.14931:0.0006%,-0.24151:0.0004%,-64.19493:0.0004%,-71.14798:0.0004%,-68.79874000000001:0.0002%,-1.81611:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,-61.95768:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:97.1716%,Single Stage Single Point:2.8284%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7293270e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.7293270e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.7293270e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 ...
 [-1.0398644e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.0398644e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0398644e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99996662e-01 3.28856390e-06 1.16481607e-12 3.57454101e-11
   1.66913954e-12]
  [9.99999881e-01 1.61220086e-07 3.55966206e-13 2.26721454e-11
   3.70958364e-13]
  [9.99980092e-01 1.98685411e-05 9.29464947e-13 5.28746621e-12
   1.68288322e-12]
  ...
  [9.99998689e-01 1.33759352e-06 5.58444838e-13 1.29450435e-11
   7.08411465e-13]
  [9.99994397e-01 5.55539918e-06 4.90998843e-13 3.43072164e-12
   9.24994998e-13]
  [9.99901175e-01 9.87689345e-05 3.38755998e-12 2.37649293e-11
   3.54733018e-12]]

 [[9.99995947e-01 4.06802565e-06 1.72346317e-12 3.96287655e-11
   2.73066357e-12]
  [9.99998808e-01 1.19150616e-06 5.19550928e-13 1.11896352e-11
   6.11348591e-13]
  [9.99966383e-01 3.36247431e-05 2.19432350e-12 1.70733219e-11
   2.47187318e-12]
  ...
  [9.99978423e-01 2.15723885e-05 5.17344327e-12 8.53989032e-11
   8.50276360e-12]
  [9.99987960e-01 1.20792211e-05 6.98672619e-13 6.64135023e-12
   8.46094028e-13]
  [9.99998927e-01 1.06293191e-06 9.43539544e-14 8.84119763e-13
   2.11538943e-13]]

 [[9.99985576e-01 1.44786309e-05 2.00635971e-12 6.82614520e-11
   2.74982706e-12]
  [9.99997616e-01 2.40990312e-06 1.85361015e-12 3.87496875e-11
   1.89267287e-12]
  [9.99795616e-01 2.04358759e-04 3.31751532e-12 1.38575635e-11
   3.90015581e-12]
  ...
  [9.99952674e-01 4.73705586e-05 2.07688120e-12 3.28506007e-11
   3.09859560e-12]
  [9.99800742e-01 1.99328482e-04 2.33895303e-12 7.98291468e-12
   2.97408907e-12]
  [9.99999285e-01 6.84750205e-07 7.20050647e-14 6.36415616e-13
   1.72494126e-13]]

 ...

 [[9.99986649e-01 1.33244203e-05 2.46327720e-12 6.88620203e-11
   3.62247905e-12]
  [9.99998331e-01 1.64700532e-06 6.38416132e-13 1.20001648e-11
   7.73409440e-13]
  [9.99979258e-01 2.07627036e-05 2.00830346e-12 1.57066391e-11
   3.63198577e-12]
  ...
  [9.99991417e-01 8.60445925e-06 9.91528040e-13 1.06820750e-11
   1.22473798e-12]
  [9.99978662e-01 2.13952499e-05 6.34406373e-13 5.79086735e-12
   1.31817007e-12]
  [1.00000000e+00 3.34666908e-08 4.49253502e-14 1.09544155e-12
   9.02953588e-14]]

 [[9.99892831e-01 1.07138279e-04 1.18781226e-11 9.25756694e-10
   1.23670874e-11]
  [1.00000000e+00 2.23174474e-08 3.64723951e-14 6.87250040e-12
   4.00719158e-14]
  [9.99983311e-01 1.67146645e-05 9.45698164e-13 9.71147208e-12
   1.47168486e-12]
  ...
  [9.99991655e-01 8.35460833e-06 7.88796708e-13 9.86636987e-12
   1.03005722e-12]
  [9.99993443e-01 6.55688063e-06 4.49439314e-13 2.14081227e-12
   9.89263142e-13]
  [9.99912143e-01 8.78019782e-05 2.55394859e-12 1.92757268e-11
   2.97947973e-12]]

 [[9.94382381e-01 5.61764464e-03 1.74949583e-10 1.94239913e-08
   2.20536950e-10]
  [9.99999404e-01 5.72207227e-07 2.64860670e-13 9.87058699e-12
   2.97349276e-13]
  [9.99963045e-01 3.69331283e-05 1.12294874e-12 8.75024359e-12
   1.78951439e-12]
  ...
  [9.99999404e-01 5.72431532e-07 6.28948391e-13 1.13454281e-11
   9.97650096e-13]
  [9.99999762e-01 2.05967567e-07 7.71650742e-14 1.35005006e-12
   1.44103953e-13]
  [9.92702723e-01 7.29733566e-03 2.13560877e-10 3.21733618e-09
   3.02936648e-10]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999666e-01 3.2885639e-06 1.1648161e-12 3.5745410e-11 1.6691395e-12]
 [9.9999988e-01 1.6122009e-07 3.5596621e-13 2.2672145e-11 3.7095836e-13]
 [9.9998009e-01 1.9868541e-05 9.2946495e-13 5.2874662e-12 1.6828832e-12]
 ...
 [9.9999940e-01 5.7243153e-07 6.2894839e-13 1.1345428e-11 9.9765010e-13]
 [9.9999976e-01 2.0596757e-07 7.7165074e-14 1.3500501e-12 1.4410395e-13]
 [9.9270272e-01 7.2973357e-03 2.1356088e-10 3.2173362e-09 3.0293665e-10]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0008622450882568956
tp :  99997.0
fp :  3.0
tn :  399997.0
fn :  3.0
accuracy :  0.9999879598617554
precision :  0.999970018863678
recall :  0.999970018863678
auc :  0.999993622303009

y_eval {0: 100000}
pred {0: 99997, 1: 3}
[INFO] confusion matrix for file 
[[99997     3     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[2164944     589       0       0       0]
 [ 204609       4       0       0       0]
 [  27050       2       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0398644e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.0398644e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0398644e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-3.4786710e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-3.4786710e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-3.4786710e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.9999642e-01 3.5787957e-06 1.4531137e-12 5.0462579e-11 2.1209889e-12]
  [1.0000000e+00 1.6958282e-08 3.0317701e-14 4.9950417e-12 3.4055522e-14]
  [9.9999225e-01 7.7700715e-06 1.0295549e-12 1.1640297e-11 1.7431804e-12]
  ...
  [9.9992359e-01 7.6457094e-05 7.9918439e-13 2.8524689e-12 1.2914055e-12]
  [9.9999487e-01 5.1489483e-06 1.5585112e-13 1.0185163e-12 4.0947039e-13]
  [9.9999988e-01 9.4674490e-08 8.8401386e-14 2.0469210e-12 1.8045065e-13]]

 [[9.9996769e-01 3.2266311e-05 2.9310395e-12 1.1698154e-10 3.8101302e-12]
  [9.9999893e-01 1.0939258e-06 9.2571751e-13 2.0924660e-11 1.0406375e-12]
  [9.9996161e-01 3.8400114e-05 1.9721800e-12 1.6987810e-11 2.5353498e-12]
  ...
  [9.9993157e-01 6.8451780e-05 4.5791565e-12 6.8397739e-11 4.9230637e-12]
  [9.9999988e-01 6.1130883e-08 3.2157013e-14 7.0267820e-13 7.8092264e-14]
  [9.9999976e-01 2.5718069e-07 2.7364181e-13 7.4979432e-12 4.6104120e-13]]

 [[9.9999857e-01 1.3783707e-06 5.4632481e-13 1.5455555e-11 7.7183133e-13]
  [9.9999976e-01 2.1104205e-07 6.4471654e-13 4.9574005e-11 6.1054509e-13]
  [9.9986410e-01 1.3586404e-04 8.0975450e-13 3.5959393e-12 1.2795259e-12]
  ...
  [9.9999976e-01 2.9617101e-07 1.1729208e-13 1.7820593e-12 2.4496458e-13]
  [9.9994898e-01 5.1024632e-05 3.2952627e-12 3.9437946e-11 3.6239802e-12]
  [9.9999976e-01 2.9410310e-07 2.8572844e-14 4.0618897e-13 8.0075852e-14]]

 ...

 [[9.9995959e-01 4.0408911e-05 3.8298371e-12 1.3936347e-10 5.2321810e-12]
  [9.9999809e-01 1.9616371e-06 1.4769230e-12 2.7477551e-11 1.6270900e-12]
  [9.9997652e-01 2.3493487e-05 1.2706319e-12 8.5802797e-12 1.5507768e-12]
  ...
  [9.9993992e-01 6.0037568e-05 2.4219097e-12 2.5812156e-11 4.2112442e-12]
  [9.9999630e-01 3.7199179e-06 4.7183785e-13 3.1795751e-12 9.0642598e-13]
  [1.0000000e+00 5.0380610e-08 4.3937673e-14 1.2442419e-12 8.5993631e-14]]

 [[9.9999750e-01 2.4735307e-06 1.0362568e-12 3.5844709e-11 1.5220531e-12]
  [1.0000000e+00 7.6836608e-09 2.4818323e-14 5.3619748e-12 2.6761759e-14]
  [9.9997091e-01 2.9071600e-05 2.0569473e-12 1.8059504e-11 2.7313087e-12]
  ...
  [9.9984705e-01 1.5296877e-04 2.5679669e-12 2.9155893e-11 4.4816854e-12]
  [9.9999928e-01 7.1326855e-07 1.5520009e-13 1.5791054e-12 2.7856339e-13]
  [9.9974209e-01 2.5790065e-04 3.2455472e-11 5.4114585e-10 4.5090737e-11]]

 [[9.9999750e-01 2.4894669e-06 1.0406718e-12 3.5976354e-11 1.5280423e-12]
  [9.9999988e-01 1.3338339e-07 3.0892923e-13 1.5121900e-11 3.1569601e-13]
  [9.9999726e-01 2.7348556e-06 7.0909446e-13 9.0724711e-12 8.7632327e-13]
  ...
  [9.9999845e-01 1.5329117e-06 1.3628672e-13 2.2480739e-12 2.2238450e-13]
  [9.9999416e-01 5.8706923e-06 3.4855097e-13 1.9793440e-12 6.7366138e-13]
  [9.9999988e-01 1.6327833e-07 1.4541188e-13 3.0137442e-12 2.7587852e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999642e-01 3.5787957e-06 1.4531137e-12 5.0462579e-11 2.1209889e-12]
 [1.0000000e+00 1.6958282e-08 3.0317701e-14 4.9950417e-12 3.4055522e-14]
 [9.9999225e-01 7.7700715e-06 1.0295549e-12 1.1640297e-11 1.7431804e-12]
 ...
 [9.9999845e-01 1.5329117e-06 1.3628672e-13 2.2480739e-12 2.2238450e-13]
 [9.9999416e-01 5.8706923e-06 3.4855097e-13 1.9793440e-12 6.7366138e-13]
 [9.9999988e-01 1.6327833e-07 1.4541188e-13 3.0137442e-12 2.7587852e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0013331080080941319
tp :  99988.0
fp :  12.0
tn :  399988.0
fn :  12.0
accuracy :  0.9999520182609558
precision :  0.9998800158500671
recall :  0.9998800158500671
auc :  0.9999685287475586

y_eval {0: 100000}
pred {0: 99988, 1: 12}
[INFO] confusion matrix for file 
[[99988    12     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[2264932     601       0       0       0]
 [ 204609       4       0       0       0]
 [  27050       2       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4786710e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4786710e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4786710e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [ 3.4666502e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4666502e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 3.4666502e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.93166029e-01 6.83392165e-03 1.34200748e-10 1.19730821e-08
   1.64824349e-10]
  [9.99999762e-01 2.78243647e-07 1.69388388e-13 6.78138969e-12
   2.11683603e-13]
  [9.99982119e-01 1.78258506e-05 2.01294168e-12 3.09927362e-11
   2.16408640e-12]
  ...
  [9.99999523e-01 4.91147603e-07 3.11526141e-13 5.17087848e-12
   5.61142387e-13]
  [9.99999762e-01 2.44695201e-07 9.28166506e-14 1.88674792e-12
   1.64337267e-13]
  [9.99989390e-01 1.06526040e-05 1.41671581e-12 2.01533547e-11
   2.36623481e-12]]

 [[9.99942780e-01 5.72350582e-05 4.00639287e-12 1.80164120e-10
   5.00949629e-12]
  [9.99999285e-01 7.70338488e-07 9.98182765e-13 2.62924092e-11
   1.12000762e-12]
  [9.99991655e-01 8.39512541e-06 5.50309744e-13 4.98055850e-12
   8.14786335e-13]
  ...
  [9.99958158e-01 4.17930387e-05 8.24994326e-12 1.54297269e-10
   1.21812820e-11]
  [1.00000000e+00 5.63591804e-08 5.38843059e-14 1.57077357e-12
   1.07211623e-13]
  [9.99999523e-01 4.48218799e-07 1.91825763e-13 3.26157460e-12
   2.99315883e-13]]

 [[9.96436357e-01 3.56370443e-03 5.17819017e-11 3.19878479e-09
   6.44575088e-11]
  [9.99999285e-01 6.82160646e-07 6.59177411e-13 1.82059680e-11
   7.76295044e-13]
  [9.99999166e-01 8.44817691e-07 1.53240457e-13 3.92824705e-12
   2.46063939e-13]
  ...
  [9.99990225e-01 9.73842816e-06 2.14073182e-12 5.15108685e-11
   2.34968165e-12]
  [9.99999642e-01 3.71709120e-07 4.40411901e-14 5.86943797e-13
   1.07968816e-13]
  [9.99997973e-01 2.07517405e-06 6.58086162e-13 6.62596757e-12
   1.13538486e-12]]

 ...

 [[9.99905944e-01 9.40086393e-05 5.97566788e-12 2.51590415e-10
   7.91725800e-12]
  [9.99999762e-01 1.93621347e-07 2.18252012e-13 1.09835413e-11
   2.48963691e-13]
  [9.99958992e-01 4.09760469e-05 2.95061241e-12 2.39964680e-11
   5.43153196e-12]
  ...
  [9.99997020e-01 2.93122412e-06 8.57166240e-14 6.41393351e-13
   2.18566349e-13]
  [9.99999404e-01 5.42542352e-07 4.50471014e-13 1.21828537e-11
   7.47302285e-13]
  [1.00000000e+00 3.33207062e-08 4.64814886e-14 1.53592677e-12
   8.81718811e-14]]

 [[9.99895692e-01 1.04248502e-04 5.50782250e-12 2.70346634e-10
   6.65615740e-12]
  [9.99999523e-01 4.26992415e-07 7.68698310e-13 2.66112236e-11
   8.71247031e-13]
  [9.99998450e-01 1.60004367e-06 1.70053411e-13 3.46067164e-12
   2.76701269e-13]
  ...
  [9.99997258e-01 2.68629515e-06 6.18886832e-13 5.14098096e-12
   1.16175927e-12]
  [9.99997616e-01 2.37324025e-06 2.34630295e-13 2.41518979e-12
   3.40609810e-13]
  [9.99994278e-01 5.67556208e-06 3.06550277e-13 2.66625871e-12
   6.47168517e-13]]

 [[9.97926354e-01 2.07366468e-03 7.48345691e-11 8.11959922e-09
   9.09774339e-11]
  [9.99999881e-01 1.06464483e-07 3.35987423e-13 1.55425776e-11
   3.48905475e-13]
  [9.99998450e-01 1.56843032e-06 1.96373828e-13 2.36939960e-12
   3.04586895e-13]
  ...
  [1.00000000e+00 1.22627739e-08 5.90061921e-14 3.06725912e-12
   1.11294004e-13]
  [9.99999285e-01 6.78968661e-07 6.36333054e-13 1.00580889e-11
   9.98182765e-13]
  [9.99998450e-01 1.50883955e-06 1.51819760e-13 1.98626207e-12
   2.53588193e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.93166029e-01 6.83392165e-03 1.34200748e-10 1.19730821e-08
  1.64824349e-10]
 [9.99999762e-01 2.78243647e-07 1.69388388e-13 6.78138969e-12
  2.11683603e-13]
 [9.99982119e-01 1.78258506e-05 2.01294168e-12 3.09927362e-11
  2.16408640e-12]
 ...
 [1.00000000e+00 1.22627739e-08 5.90061921e-14 3.06725912e-12
  1.11294004e-13]
 [9.99999285e-01 6.78968661e-07 6.36333054e-13 1.00580889e-11
  9.98182765e-13]
 [9.99998450e-01 1.50883955e-06 1.51819760e-13 1.98626207e-12
  2.53588193e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.000990761155448854
tp :  99994.0
fp :  6.0
tn :  399994.0
fn :  6.0
accuracy :  0.9999760389328003
precision :  0.9999399781227112
recall :  0.9999399781227112
auc :  0.9999936819076538

y_eval {0: 100000}
pred {0: 99994, 1: 6}
[INFO] confusion matrix for file 
[[99994     6     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[2364926     607       0       0       0]
 [ 204609       4       0       0       0]
 [  27050       2       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4666502e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 3.4666502e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4666502e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [ 1.0386623e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.0386623e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0386623e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.97940123e-01 2.05989392e-03 7.46508480e-11 8.10912582e-09
   9.07480133e-11]
  [9.99999762e-01 2.71334528e-07 1.82168652e-13 1.00685736e-11
   1.98679032e-13]
  [9.99925137e-01 7.48014863e-05 2.32971541e-12 2.55889823e-11
   3.29650435e-12]
  ...
  [1.00000000e+00 1.61034404e-08 5.05038956e-14 2.56710105e-12
   8.43577053e-14]
  [1.00000000e+00 4.51919071e-08 1.05616728e-13 2.99060516e-12
   2.10853158e-13]
  [9.99999404e-01 5.46915942e-07 5.91133208e-13 9.92757005e-12
   9.09910493e-13]]

 [[9.97953773e-01 2.04621651e-03 7.44677028e-11 8.09866307e-09
   9.05193420e-11]
  [9.99999762e-01 2.70336244e-07 1.81617037e-13 1.00537582e-11
   1.98063056e-13]
  [9.99876261e-01 1.23781356e-04 3.67976439e-12 2.81088972e-11
   3.98342817e-12]
  ...
  [9.99999285e-01 7.23585288e-07 2.59445650e-13 3.25142452e-12
   4.55586307e-13]
  [9.99954343e-01 4.56394300e-05 2.57177656e-12 2.27998627e-11
   3.06519502e-12]
  [9.99987602e-01 1.24155695e-05 3.43317741e-13 3.35028684e-12
   7.60748723e-13]]

 [[9.99816120e-01 1.83926211e-04 9.15207320e-12 4.22459540e-10
   1.20207689e-11]
  [9.99999762e-01 2.30955806e-07 4.60417295e-13 2.51028608e-11
   5.17163677e-13]
  [9.99993682e-01 6.28530915e-06 4.06326746e-13 6.83393533e-12
   5.63715795e-13]
  ...
  [9.99999881e-01 1.77989008e-07 6.91995018e-14 1.17315435e-12
   1.58539482e-13]
  [9.99996901e-01 3.11816507e-06 6.97782598e-13 9.07572281e-12
   9.12697977e-13]
  [9.99997377e-01 2.58510022e-06 1.54767610e-13 1.51025134e-12
   3.60818661e-13]]

 ...

 [[9.96539116e-01 3.46094253e-03 7.90355836e-11 7.16274240e-09
   9.46805689e-11]
  [9.99997735e-01 2.22002222e-06 7.55703334e-13 1.28167130e-11
   9.45343847e-13]
  [9.99997377e-01 2.59048034e-06 3.78565533e-13 5.64446580e-12
   6.47160602e-13]
  ...
  [9.99998689e-01 1.33144636e-06 2.88335328e-13 3.13251551e-12
   4.74277898e-13]
  [9.66796398e-01 3.32035720e-02 6.58712529e-11 3.31404265e-10
   1.22821933e-10]
  [9.99994755e-01 5.27795737e-06 2.14646877e-13 9.00805960e-13
   4.83733550e-13]]

 [[9.99930739e-01 6.92092217e-05 1.15711832e-11 1.05182640e-09
   1.13964168e-11]
  [1.00000000e+00 2.80547816e-08 9.26562429e-14 1.75935499e-11
   1.05543829e-13]
  [9.99999285e-01 7.25533937e-07 9.09824855e-14 2.60365362e-12
   1.54995076e-13]
  ...
  [9.99998450e-01 1.58874161e-06 3.21471690e-13 6.06237152e-12
   4.49139071e-13]
  [9.99997616e-01 2.43845898e-06 2.48519087e-13 1.68367674e-12
   5.50483107e-13]
  [9.99999166e-01 8.07983213e-07 3.54204377e-13 5.46866415e-12
   6.48883508e-13]]

 [[9.99999166e-01 8.82920290e-07 3.74125102e-13 8.26790893e-12
   5.74267413e-13]
  [9.99999642e-01 3.03133163e-07 6.86357329e-13 5.13517492e-11
   7.07612679e-13]
  [9.99998450e-01 1.50330561e-06 8.72065278e-14 2.04994593e-12
   1.54056807e-13]
  ...
  [9.99998450e-01 1.52077507e-06 1.76137845e-13 1.62420695e-12
   3.61810733e-13]
  [9.99974012e-01 2.59287044e-05 1.54213935e-12 1.30534446e-11
   1.75442267e-12]
  [9.99991894e-01 8.06126718e-06 3.51302646e-13 1.36613312e-12
   8.20165767e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9794012e-01 2.0598939e-03 7.4650848e-11 8.1091258e-09 9.0748013e-11]
 [9.9999976e-01 2.7133453e-07 1.8216865e-13 1.0068574e-11 1.9867903e-13]
 [9.9992514e-01 7.4801486e-05 2.3297154e-12 2.5588982e-11 3.2965043e-12]
 ...
 [9.9999845e-01 1.5207751e-06 1.7613785e-13 1.6242070e-12 3.6181073e-13]
 [9.9997401e-01 2.5928704e-05 1.5421394e-12 1.3053445e-11 1.7544227e-12]
 [9.9999189e-01 8.0612672e-06 3.5130265e-13 1.3661331e-12 8.2016577e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0031546709790825846
tp :  99961.0
fp :  39.0
tn :  399961.0
fn :  39.0
accuracy :  0.9998438954353333
precision :  0.9996100068092346
recall :  0.9996100068092346
auc :  0.9999051690101624

y_eval {0: 100000}
pred {0: 99961, 1: 39}
[INFO] confusion matrix for file 
[[99961    39     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[2464887     646       0       0       0]
 [ 204609       4       0       0       0]
 [  27050       2       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0386623e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0386623e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.0386623e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 ...
 [ 1.7331945e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.7331945e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.7331945e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 1 1] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.9999988e-01 1.2092885e-07 4.8474928e-13 1.4218343e-11 8.3722661e-13]
  [9.9999988e-01 1.7645641e-07 7.1830936e-13 3.4883599e-11 7.5737886e-13]
  [9.9998999e-01 1.0061873e-05 1.0901717e-12 7.5419749e-12 1.9035884e-12]
  ...
  [9.9981946e-01 1.8060948e-04 1.0897281e-12 5.5590944e-12 2.3433013e-12]
  [9.9999976e-01 2.8423551e-07 7.4932892e-14 1.4595656e-12 1.1694339e-13]
  [9.9999952e-01 4.7503883e-07 4.1417260e-13 6.8925555e-12 6.4277392e-13]]

 [[9.9975246e-01 2.4752060e-04 7.9509377e-12 4.1308484e-10 9.4292482e-12]
  [1.0000000e+00 5.6853239e-08 8.6119032e-14 8.1395940e-12 1.0541929e-13]
  [9.9999583e-01 4.1929734e-06 6.0606760e-13 1.0780328e-11 8.2465691e-13]
  ...
  [9.9999917e-01 7.7984942e-07 5.2335510e-14 5.2422357e-13 1.3999832e-13]
  [9.9999976e-01 2.2544936e-07 3.3110407e-13 9.4442353e-12 5.6596877e-13]
  [9.9999988e-01 1.1950745e-07 6.4935538e-14 1.3978877e-12 1.1457263e-13]]

 [[9.9987376e-01 1.2617811e-04 5.6523111e-12 2.7357175e-10 6.7030097e-12]
  [9.9999952e-01 4.4046720e-07 7.9158213e-13 2.7278428e-11 8.9515813e-13]
  [9.9999154e-01 8.5220445e-06 4.0822445e-13 9.1070944e-12 7.2114087e-13]
  ...
  [9.9999976e-01 2.8600019e-07 1.4872368e-13 2.6121360e-12 2.6457805e-13]
  [9.9994385e-01 5.6187757e-05 2.3369689e-12 1.8095943e-11 2.6389158e-12]
  [9.9996591e-01 3.4111268e-05 4.7652279e-13 3.2950483e-12 1.0717123e-12]]

 ...

 [[9.9676943e-01 3.2306402e-03 3.1050891e-11 1.6318866e-09 3.6595546e-11]
  [9.9999750e-01 2.4574620e-06 2.1500364e-12 5.9113492e-11 1.9625690e-12]
  [9.9999630e-01 3.7388245e-06 3.9254553e-13 3.4334447e-12 5.9382317e-13]
  ...
  [9.9999952e-01 4.9640607e-07 2.2229823e-13 3.1481393e-12 4.0579939e-13]
  [9.9998295e-01 1.7089296e-05 1.4695750e-12 1.4891607e-11 1.6761959e-12]
  [9.9998224e-01 1.7768092e-05 3.3634055e-13 2.9146696e-12 6.7313700e-13]]

 [[9.9999881e-01 1.2114740e-06 4.6266609e-13 1.0153050e-11 6.9984058e-13]
  [9.9999988e-01 1.7341051e-07 7.5164256e-13 6.3049399e-11 7.4029715e-13]
  [9.9987352e-01 1.2640873e-04 4.9867738e-13 1.9346131e-12 8.9264999e-13]
  ...
  [9.9999964e-01 3.4010066e-07 1.5477268e-13 2.2909298e-12 2.7861342e-13]
  [9.9999011e-01 9.9386671e-06 1.1594311e-12 1.6806971e-11 1.8823014e-12]
  [9.9999487e-01 5.1143434e-06 6.2439989e-13 3.9455461e-12 1.2439698e-12]]

 [[9.9999881e-01 1.2395104e-06 7.6875350e-13 2.3638945e-11 1.1365993e-12]
  [9.9999976e-01 1.8875265e-07 5.6128382e-13 5.8622281e-11 5.6153010e-13]
  [9.9998891e-01 1.1125851e-05 2.1066792e-13 4.1892024e-12 3.9024556e-13]
  ...
  [9.9999917e-01 8.8629480e-07 1.9825607e-13 2.1201899e-12 3.7761789e-13]
  [9.9998772e-01 1.2252998e-05 9.7890977e-13 1.0627511e-11 1.6657215e-12]
  [9.9998975e-01 1.0270406e-05 7.6401927e-13 3.8630848e-12 1.5337009e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999988e-01 1.2092885e-07 4.8474928e-13 1.4218343e-11 8.3722661e-13]
 [9.9999988e-01 1.7645641e-07 7.1830936e-13 3.4883599e-11 7.5737886e-13]
 [9.9998999e-01 1.0061873e-05 1.0901717e-12 7.5419749e-12 1.9035884e-12]
 ...
 [9.9999917e-01 8.8629480e-07 1.9825607e-13 2.1201899e-12 3.7761789e-13]
 [9.9998772e-01 1.2252998e-05 9.7890977e-13 1.0627511e-11 1.6657215e-12]
 [9.9998975e-01 1.0270406e-05 7.6401927e-13 3.8630848e-12 1.5337009e-12]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  1.8017379643917084
tp :  85800.0
fp :  14200.0
tn :  385800.0
fn :  14200.0
accuracy :  0.9432004690170288
precision :  0.8579999804496765
recall :  0.8579999804496765
auc :  0.9108515381813049

y_eval {0: 85858, 1: 14142}
pred {0: 99942, 1: 58}
[INFO] confusion matrix for file 
[[85800    58     0     0     0]
 [14142     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[2550687     704       0       0       0]
 [ 218751       4       0       0       0]
 [  27050       2       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-01_151435_117.log.part13_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1365 (0.273%)
[INFO] ** orig:[0:99.9986%,2:0.0014%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.998%,3:0.002%]
[INFO] ** i/f_dir:[1:99.998%,0:0.002%]
[INFO] ** src:[22:38.1186%,9:26.0918%,7:18.2288%,1:17.558%,21:0.0018%,14:0.0006%,15:0.0004%]
[INFO] ** dst:[21:43.3702%,10:20.8392%,8:18.2288%,9:17.5578%,15:0.002%,22:0.0012%,24:0.0004%,18:0.0002%,6:0.0002%]
[INFO] ** proto:[0:99.9976%,1:0.002%,2:0.0004%]
[INFO] ** appi_name:[21:99.9976%,30:0.002%,31:0.0002%,22:0.0002%]
[INFO] ** proxy_src_ip:[18:38.1186%,20:26.0918%,13:18.2288%,6:17.558%,17:0.002%,16:0.0004%,7:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.9976%,-33.760870000000004:0.0024%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.9978%,0:0.0024%]
[INFO] ** modbus_transaction_id:65534 (13.1068%)
[INFO] ** scada_tag:[3:26.0906%,1:20.839%,5:18.2282%,4:17.5572%,2:17.2792%,0:0.0058%]
[INFO] ** service:[0.0048200000000000005:99.9976%,-211.73542999999998:0.002%,-186.43601999999998:0.0002%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:26.0908%,-0.32151:20.8392%,-1.27613:18.2284%,-0.23351:17.5576%,-0.33484:17.2794%,-71.33197:0.002%,1.45709:0.0006%,-1.27347:0.0004%,-1.02014:0.0004%,-0.24950999999999998:0.0002%,1.46509:0.0002%,1.47576:0.0002%,4.42897:0.0002%,-0.24151:0.0002%,-71.14931:0.0002%]
[INFO] ** classification:[normal:87.5394%,Single Stage Single Point:12.4606%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7325106  0.         0.        ...  2.         0.00482   -0.33484  ]
 [-1.7325106  0.         0.        ...  3.         0.00482    1.45442  ]
 [-1.7325106  0.         0.        ...  2.         0.00482   -0.33484  ]
 ...
 [-1.0383536  0.         0.        ...  1.         0.00482   -0.32151  ]
 [-1.0383536  0.         0.        ...  2.         0.00482   -0.33484  ]
 [-1.0383536  0.         0.        ...  1.         0.00482   -0.32151  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 1 0 ... 1 0 1] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99999523e-01 5.26634096e-07 2.53666852e-13 4.33035552e-12
   4.10825670e-13]
  [9.99999881e-01 1.28578520e-07 1.91842297e-13 1.59717881e-11
   1.96356494e-13]
  [9.99926925e-01 7.31000691e-05 2.36521610e-12 2.06896080e-11
   4.39153184e-12]
  ...
  [9.99999285e-01 7.29582553e-07 8.75609467e-14 6.16963403e-13
   2.24447576e-13]
  [9.99999642e-01 4.03825197e-07 5.53641009e-13 1.12749324e-11
   8.48100941e-13]
  [9.99993205e-01 6.76639775e-06 2.17415035e-13 2.19899099e-12
   3.50736015e-13]]

 [[9.99986887e-01 1.31278475e-05 2.24195467e-12 6.07303305e-11
   3.26145252e-12]
  [9.99999523e-01 4.26397492e-07 2.92440795e-13 1.15103864e-11
   3.43635656e-13]
  [9.99975443e-01 2.45972078e-05 1.98199681e-12 1.79662396e-11
   2.15825990e-12]
  ...
  [9.99970555e-01 2.94865422e-05 1.64595431e-12 1.67637727e-11
   1.97891595e-12]
  [9.99969721e-01 3.02964872e-05 5.60669892e-13 4.58926386e-12
   6.72672963e-13]
  [9.99985099e-01 1.48936442e-05 1.81048536e-13 5.15474057e-13
   4.83751982e-13]]

 [[9.99351561e-01 6.48479850e-04 2.25723433e-11 1.23936206e-09
   2.94330914e-11]
  [9.99999642e-01 3.96215114e-07 4.22368846e-13 1.68477333e-11
   4.65652636e-13]
  [9.99985218e-01 1.47616292e-05 1.38541316e-12 9.19823245e-12
   2.43374938e-12]
  ...
  [9.99999881e-01 1.61312528e-07 6.14777394e-14 9.83401837e-13
   1.31264750e-13]
  [9.99998927e-01 1.06441087e-06 5.29244725e-13 6.34474027e-12
   8.69034228e-13]
  [9.99999881e-01 8.67222525e-08 6.23456636e-14 1.66887110e-12
   1.12261695e-13]]

 ...

 [[9.99999285e-01 7.63518187e-07 1.09861913e-12 6.07026799e-12
   1.50629867e-12]
  [9.99909401e-01 9.06430432e-05 9.82943935e-12 4.62746091e-11
   1.31957605e-11]
  [9.99915957e-01 8.39817003e-05 1.70146525e-12 9.89858976e-12
   3.08076763e-12]
  ...
  [9.99468863e-01 5.31192345e-04 2.40949686e-12 4.83317119e-12
   3.53472915e-12]
  [9.99993920e-01 6.02114869e-06 1.39758268e-13 6.30879301e-13
   3.93201801e-13]
  [9.99999404e-01 5.40875703e-07 4.03998368e-13 6.60562317e-12
   6.71222897e-13]]

 [[9.99994636e-01 5.40810515e-06 1.73492525e-12 6.72548059e-11
   2.43947961e-12]
  [9.99999881e-01 9.06179167e-08 3.13704242e-14 2.94962449e-12
   3.78418305e-14]
  [9.99929190e-01 7.08033549e-05 7.38655751e-12 7.93772409e-11
   1.26278805e-11]
  ...
  [9.99997616e-01 2.39496717e-06 2.78904206e-13 2.98098503e-12
   5.50131501e-13]
  [1.00000000e+00 2.13770512e-08 5.73358093e-14 2.10608093e-12
   1.07571104e-13]
  [9.99999762e-01 2.33813765e-07 3.37111361e-13 7.52884040e-12
   5.18664213e-13]]

 [[9.99926329e-01 7.36337315e-05 1.13580005e-11 9.54426871e-10
   1.15837626e-11]
  [1.00000000e+00 3.11639390e-08 4.09028890e-14 6.98514857e-12
   4.23311593e-14]
  [9.99984622e-01 1.54069712e-05 1.13790195e-12 1.58088820e-11
   1.23385753e-12]
  ...
  [9.99213576e-01 7.86377874e-04 4.82226975e-12 2.49530448e-11
   9.67103394e-12]
  [9.99999523e-01 4.38076427e-07 8.58817954e-14 8.53053847e-13
   2.12329747e-13]
  [9.99999523e-01 4.82754331e-07 5.77329525e-13 1.08598425e-11
   9.12541960e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.99999523e-01 5.26634096e-07 2.53666852e-13 4.33035552e-12
  4.10825670e-13]
 [9.99999881e-01 1.28578520e-07 1.91842297e-13 1.59717881e-11
  1.96356494e-13]
 [9.99926925e-01 7.31000691e-05 2.36521610e-12 2.06896080e-11
  4.39153184e-12]
 ...
 [9.99213576e-01 7.86377874e-04 4.82226975e-12 2.49530448e-11
  9.67103394e-12]
 [9.99999523e-01 4.38076427e-07 8.58817954e-14 8.53053847e-13
  2.12329747e-13]
 [9.99999523e-01 4.82754331e-07 5.77329525e-13 1.08598425e-11
  9.12541960e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  5.909015380096435
tp :  53021.0
fp :  46979.0
tn :  353021.0
fn :  46979.0
accuracy :  0.8120858073234558
precision :  0.530210018157959
recall :  0.530210018157959
auc :  0.7070750594139099

y_eval {0: 53028, 1: 46972}
pred {0: 99993, 1: 7}
[INFO] confusion matrix for file 
[[53021     7     0     0     0]
 [46972     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[2603708     711       0       0       0]
 [ 265723       4       0       0       0]
 [  27050       2       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0383536   0.          0.         ...  2.          0.00482
  -0.33484   ]
 [-1.0383536   0.          0.         ...  4.          0.00482
  -0.23351   ]
 [-1.0383536   0.          0.         ...  3.          0.00482
   1.45442   ]
 ...
 [-0.34673914  0.          0.         ...  1.          0.00482
  -0.32151   ]
 [-0.34673914  0.          0.         ...  1.          0.00482
  -0.32151   ]
 [-0.34673914  0.          0.         ...  4.          0.00482
  -0.23351   ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 1 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.95912492e-01 4.08749329e-03 1.60930325e-10 1.99559391e-08
   2.04740586e-10]
  [9.99999642e-01 3.16056571e-07 4.45328290e-13 1.52072226e-11
   4.31467281e-13]
  [9.99952435e-01 4.75378547e-05 3.13318761e-13 2.08297030e-12
   5.12964129e-13]
  ...
  [9.99976635e-01 2.33459905e-05 1.52739854e-12 1.27369001e-11
   2.71414011e-12]
  [9.99999642e-01 3.77839314e-07 1.05333426e-13 1.33279021e-12
   2.48378385e-13]
  [1.00000000e+00 4.44430128e-08 9.82752630e-14 3.30035608e-12
   1.80299636e-13]]

 [[9.99926925e-01 7.30213360e-05 1.13471810e-11 9.55104884e-10
   1.15672767e-11]
  [1.00000000e+00 4.26622364e-08 1.01449407e-13 1.72849790e-11
   1.14529602e-13]
  [9.99988198e-01 1.17954824e-05 7.23557824e-13 9.69821098e-12
   8.20472542e-13]
  ...
  [9.99999762e-01 2.68910696e-07 1.34985366e-13 2.35129104e-12
   2.78341532e-13]
  [9.99958992e-01 4.09905479e-05 1.62972229e-12 1.08906408e-11
   2.07047096e-12]
  [9.96708512e-01 3.29142227e-03 5.30139127e-12 1.61648837e-11
   1.04352802e-11]]

 [[9.99999285e-01 6.58525380e-07 2.69321159e-13 4.82488355e-12
   4.39565214e-13]
  [9.99999642e-01 3.16453168e-07 4.83884525e-13 3.78460666e-11
   4.80657669e-13]
  [9.99985337e-01 1.47063247e-05 1.09889929e-12 8.37845852e-12
   1.88039059e-12]
  ...
  [9.99996901e-01 3.06706897e-06 6.77503138e-13 9.72465337e-12
   9.39479614e-13]
  [9.99998808e-01 1.24218479e-06 1.26946535e-13 1.39581088e-12
   2.88185789e-13]
  [9.99997616e-01 2.40715121e-06 6.99603461e-13 1.16040268e-11
   1.22507733e-12]]

 ...

 [[9.96107638e-01 3.89237027e-03 1.16347404e-10 1.24989441e-08
   1.44650111e-10]
  [9.99999523e-01 4.26814097e-07 2.22460668e-13 1.01760310e-11
   2.44247439e-13]
  [9.99995708e-01 4.28271551e-06 6.57913990e-13 7.62341405e-12
   8.69177289e-13]
  ...
  [9.99992847e-01 7.17582498e-06 2.83128582e-13 1.63073515e-12
   5.73491016e-13]
  [9.99996185e-01 3.78160871e-06 7.33939656e-13 5.94852726e-12
   1.40156691e-12]
  [9.99999881e-01 8.31853413e-08 5.35317030e-14 1.21405663e-12
   1.03247861e-13]]

 [[9.96131659e-01 3.86834354e-03 1.16095057e-10 1.24910935e-08
   1.44348214e-10]
  [1.00000000e+00 3.89649202e-08 1.87921239e-13 9.82266438e-12
   2.17440988e-13]
  [9.99958158e-01 4.18511154e-05 7.91141837e-13 8.63475871e-12
   1.19897007e-12]
  ...
  [9.99999404e-01 6.47467630e-07 1.54507768e-13 1.57433289e-12
   2.97344750e-13]
  [9.99999762e-01 2.06828915e-07 1.38021566e-13 2.36775812e-12
   2.66438618e-13]
  [9.99994993e-01 4.98265717e-06 6.91564481e-13 7.29274280e-12
   9.71169217e-13]]

 [[9.99995589e-01 4.41365955e-06 1.14013475e-12 4.76025053e-11
   1.46976463e-12]
  [9.99999881e-01 1.48163139e-07 3.93126883e-13 3.36204432e-11
   4.03348714e-13]
  [9.99998808e-01 1.17647187e-06 8.33587553e-14 2.16874218e-12
   1.41892439e-13]
  ...
  [9.99999881e-01 1.71466567e-07 1.14090906e-13 1.93267776e-12
   2.34702909e-13]
  [9.99999642e-01 3.70001942e-07 5.14402214e-13 1.03206202e-11
   8.10593671e-13]
  [9.99995947e-01 4.01891020e-06 3.62179931e-13 3.32352613e-12
   4.65282435e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9591249e-01 4.0874933e-03 1.6093032e-10 1.9955939e-08 2.0474059e-10]
 [9.9999964e-01 3.1605657e-07 4.4532829e-13 1.5207223e-11 4.3146728e-13]
 [9.9995244e-01 4.7537855e-05 3.1331876e-13 2.0829703e-12 5.1296413e-13]
 ...
 [9.9999988e-01 1.7146657e-07 1.1409091e-13 1.9326778e-12 2.3470291e-13]
 [9.9999964e-01 3.7000194e-07 5.1440221e-13 1.0320620e-11 8.1059367e-13]
 [9.9999595e-01 4.0189102e-06 3.6217993e-13 3.3235261e-12 4.6528243e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  1.9368747073061765
tp :  84649.0
fp :  15351.0
tn :  384649.0
fn :  15351.0
accuracy :  0.9385965466499329
precision :  0.8464900255203247
recall :  0.8464900255203247
auc :  0.9043969511985779

y_eval {0: 84669, 1: 15331}
pred {0: 99980, 1: 20}
[INFO] confusion matrix for file 
[[84649    20     0     0     0]
 [15331     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[2688357     731       0       0       0]
 [ 281054       4       0       0       0]
 [  27050       2       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4673914e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-3.4673914e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4673914e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 3.4741792e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 3.4741792e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4741792e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99888420e-01 1.11590933e-04 5.53625158e-12 2.42354359e-10
   6.99408760e-12]
  [9.99999166e-01 8.31222792e-07 8.56939682e-13 2.21814251e-11
   9.51267168e-13]
  [9.99999166e-01 8.59413888e-07 2.10362909e-13 3.67731149e-12
   3.57859142e-13]
  ...
  [9.99974370e-01 2.56684107e-05 3.24585194e-13 1.30835295e-12
   6.21595874e-13]
  [9.96884763e-01 3.11517552e-03 9.88395390e-12 5.13135992e-11
   1.80116339e-11]
  [9.99999523e-01 4.30572072e-07 9.60770702e-14 9.66295620e-13
   2.05066284e-13]]

 [[9.99999166e-01 8.20212563e-07 3.57421910e-13 8.52616415e-12
   5.79365657e-13]
  [9.99999881e-01 1.25955538e-07 3.03764040e-13 3.85631631e-11
   3.04375909e-13]
  [9.99999166e-01 7.84210783e-07 1.12411382e-13 2.61861930e-12
   1.93124921e-13]
  ...
  [9.99999881e-01 1.24012828e-07 1.74401753e-13 4.85687055e-12
   2.69198075e-13]
  [9.99965549e-01 3.44292566e-05 1.47860554e-12 9.08191404e-12
   1.91119624e-12]
  [9.99987602e-01 1.24561520e-05 2.58120321e-13 1.18242211e-12
   5.37922734e-13]]

 [[9.99999881e-01 1.32596298e-07 4.66931669e-13 5.56291948e-12
   6.91563885e-13]
  [9.99999523e-01 4.76022933e-07 1.53742890e-13 7.25386244e-12
   2.35610630e-13]
  [9.99481142e-01 5.18884277e-04 1.35351088e-11 7.78428363e-11
   2.50991727e-11]
  ...
  [9.99878526e-01 1.21443525e-04 1.97327289e-12 8.16665745e-12
   2.52686934e-12]
  [9.91906404e-01 8.09364300e-03 9.68661089e-12 1.35656963e-11
   1.25718012e-11]
  [9.99988556e-01 1.14700033e-05 1.76851792e-13 5.84616719e-13
   4.62572201e-13]]

 ...

 [[9.99900579e-01 9.94394431e-05 5.30492577e-12 2.56614369e-10
   6.41363655e-12]
  [9.99997497e-01 2.53072562e-06 2.51493726e-12 6.89567500e-11
   2.19809067e-12]
  [9.99848843e-01 1.51156768e-04 1.62945883e-12 5.05570282e-12
   2.18197552e-12]
  ...
  [9.99999762e-01 2.16212896e-07 1.45503415e-13 2.47513078e-12
   2.68376738e-13]
  [9.99992967e-01 7.05533057e-06 6.33200523e-13 6.75614252e-12
   8.66566150e-13]
  [9.86047387e-01 1.39525812e-02 2.59492289e-11 1.07519230e-10
   4.69603870e-11]]

 [[9.99997854e-01 2.16861872e-06 1.15864414e-12 3.74097871e-11
   1.73383259e-12]
  [1.00000000e+00 9.37604838e-09 2.49032006e-14 5.11458801e-12
   2.75215167e-14]
  [9.99998569e-01 1.44315550e-06 3.41262365e-13 3.78681028e-12
   4.68865886e-13]
  ...
  [9.99995708e-01 4.27215855e-06 7.67248190e-13 6.22151506e-12
   1.45412729e-12]
  [9.99971986e-01 2.80001805e-05 8.21113685e-13 5.93499902e-12
   9.76702985e-13]
  [9.99997020e-01 2.96740313e-06 8.28741372e-14 6.34646795e-13
   2.21237660e-13]]

 [[9.99999881e-01 1.08816813e-07 5.28675140e-13 1.25857302e-11
   8.53781781e-13]
  [1.00000000e+00 4.85597269e-08 1.04255925e-13 1.01936558e-11
   1.36996087e-13]
  [9.99991417e-01 8.59924239e-06 2.81369047e-12 3.00730656e-11
   3.63283340e-12]
  ...
  [9.99998569e-01 1.44620185e-06 8.45790018e-13 1.15505782e-11
   1.44840715e-12]
  [9.99952912e-01 4.70473569e-05 8.91116662e-13 4.18274443e-12
   1.23096704e-12]
  [9.99997616e-01 2.38465873e-06 2.33428674e-13 1.59194934e-12
   5.03032620e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9988842e-01 1.1159093e-04 5.5362516e-12 2.4235436e-10 6.9940876e-12]
 [9.9999917e-01 8.3122279e-07 8.5693968e-13 2.2181425e-11 9.5126717e-13]
 [9.9999917e-01 8.5941389e-07 2.1036291e-13 3.6773115e-12 3.5785914e-13]
 ...
 [9.9999857e-01 1.4462018e-06 8.4579002e-13 1.1550578e-11 1.4484071e-12]
 [9.9995291e-01 4.7047357e-05 8.9111666e-13 4.1827444e-12 1.2309670e-12]
 [9.9999762e-01 2.3846587e-06 2.3342867e-13 1.5919493e-12 5.0303262e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0011878458876162768
tp :  99981.0
fp :  19.0
tn :  399981.0
fn :  19.0
accuracy :  0.9999240040779114
precision :  0.999809980392456
recall :  0.999809980392456
auc :  0.999993622303009

y_eval {0: 100000}
pred {0: 99981, 1: 19}
[INFO] confusion matrix for file 
[[99981    19     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[2788338     750       0       0       0]
 [ 281054       4       0       0       0]
 [  27050       2       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 0.34741792  0.          0.         ...  4.          0.00482
  -0.23351   ]
 [ 0.34741792  0.          0.         ...  4.          0.00482
  -0.23351   ]
 [ 0.34741792  0.          0.         ...  2.          0.00482
  -0.33484   ]
 ...
 [ 1.0390323   0.          0.         ...  1.          0.00482
  -0.32151   ]
 [ 1.0390323   0.          0.         ...  2.          0.00482
  -0.33484   ]
 [ 1.0390323   0.          0.         ...  1.          0.00482
  -0.32151   ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99997854e-01 2.15344812e-06 1.15147529e-12 3.71084691e-11
   1.72445283e-12]
  [9.99999881e-01 7.77699469e-08 3.21432307e-13 2.24357616e-11
   3.30272810e-13]
  [9.99991417e-01 8.62207071e-06 7.94179880e-13 6.50747858e-12
   1.38783906e-12]
  ...
  [9.99998331e-01 1.65445942e-06 1.09998729e-12 2.07050210e-11
   1.66989372e-12]
  [9.99999762e-01 1.95651623e-07 8.94267096e-14 1.26481464e-12
   1.74505552e-13]
  [9.99997973e-01 1.96705628e-06 1.03252639e-12 1.30141306e-11
   1.79331159e-12]]

 [[9.99998093e-01 1.89338368e-06 6.09793466e-13 1.63953955e-11
   9.75855139e-13]
  [9.99999762e-01 1.86841703e-07 6.67169282e-13 5.16233861e-11
   6.71553525e-13]
  [9.99983907e-01 1.61044045e-05 1.36044767e-13 1.63034733e-12
   2.77339756e-13]
  ...
  [9.99993682e-01 6.29463148e-06 2.15689052e-13 7.91218274e-13
   5.47904062e-13]
  [9.99999642e-01 3.48488470e-07 2.05866560e-13 4.05703682e-12
   4.25468851e-13]
  [9.99996901e-01 3.08755034e-06 7.07502795e-13 5.78646809e-12
   1.25070039e-12]]

 [[9.95460331e-01 4.53968626e-03 9.98551172e-11 9.24981780e-09
   1.21527080e-10]
  [9.99999642e-01 4.01537164e-07 2.63362601e-13 1.14953802e-11
   2.95924716e-13]
  [9.99963403e-01 3.65838496e-05 2.05880820e-12 1.94856839e-11
   2.32288277e-12]
  ...
  [9.99998331e-01 1.68149120e-06 2.90805140e-13 2.59820420e-12
   4.88146199e-13]
  [9.99399066e-01 6.00962434e-04 5.73990985e-12 3.30702375e-11
   1.10560129e-11]
  [9.99992847e-01 7.18398678e-06 2.08652079e-13 7.65039453e-13
   5.11187718e-13]]

 ...

 [[9.96826708e-01 3.17331660e-03 3.28059836e-11 1.77143378e-09
   3.91072660e-11]
  [9.99998212e-01 1.74782554e-06 1.49271741e-12 4.38986243e-11
   1.46362512e-12]
  [9.99953508e-01 4.65391495e-05 1.18358437e-12 7.41547882e-12
   1.59339187e-12]
  ...
  [9.99980450e-01 1.95980811e-05 2.19607102e-12 3.22170277e-11
   2.56532317e-12]
  [9.99988675e-01 1.13258175e-05 3.69226920e-13 4.10174672e-12
   7.14625353e-13]
  [9.99999762e-01 2.82397394e-07 8.98013760e-14 1.83786016e-12
   1.63568608e-13]]

 [[9.99998927e-01 1.07987353e-06 4.04517863e-13 8.58977212e-12
   6.29034476e-13]
  [9.99999642e-01 3.90114025e-07 9.21817202e-13 6.14206186e-11
   9.61306664e-13]
  [9.99997735e-01 2.23995130e-06 8.83502933e-14 1.84154081e-12
   1.61815046e-13]
  ...
  [9.99849200e-01 1.50820604e-04 1.47711444e-12 4.25392100e-12
   2.22833297e-12]
  [9.99986291e-01 1.37646293e-05 5.04970631e-13 1.90466371e-12
   1.16897486e-12]
  [9.99999523e-01 5.11899543e-07 1.66181169e-13 2.34775936e-12
   2.60605746e-13]]

 [[9.99815762e-01 1.84223361e-04 7.14755642e-12 3.67974179e-10
   8.65707679e-12]
  [9.99998927e-01 1.02596096e-06 1.46713100e-12 4.88609014e-11
   1.20625374e-12]
  [9.99620438e-01 3.79526551e-04 1.48093983e-12 3.45014490e-12
   2.06636596e-12]
  ...
  [9.99987125e-01 1.29030896e-05 8.87442626e-13 7.34710730e-12
   1.52623216e-12]
  [9.99999642e-01 3.83620744e-07 9.52541607e-14 9.89988473e-13
   2.16023000e-13]
  [9.99999404e-01 6.00098815e-07 6.38714017e-13 1.11175444e-11
   1.01484619e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999785e-01 2.1534481e-06 1.1514753e-12 3.7108469e-11 1.7244528e-12]
 [9.9999988e-01 7.7769947e-08 3.2143231e-13 2.2435762e-11 3.3027281e-13]
 [9.9999142e-01 8.6220707e-06 7.9417988e-13 6.5074786e-12 1.3878391e-12]
 ...
 [9.9998713e-01 1.2903090e-05 8.8744263e-13 7.3471073e-12 1.5262322e-12]
 [9.9999964e-01 3.8362074e-07 9.5254161e-14 9.8998847e-13 2.1602300e-13]
 [9.9999940e-01 6.0009882e-07 6.3871402e-13 1.1117544e-11 1.0148462e-12]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0017421220757067204
tp :  99979.0
fp :  21.0
tn :  399979.0
fn :  21.0
accuracy :  0.9999160170555115
precision :  0.9997900128364563
recall :  0.9997900128364563
auc :  0.9999935030937195

y_eval {0: 100000}
pred {0: 99979, 1: 21}
[INFO] confusion matrix for file 
[[99979    21     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[2888317     771       0       0       0]
 [ 281054       4       0       0       0]
 [  27050       2       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0390323e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0390323e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.0390323e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [ 1.7331893e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.7331893e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.7331893e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99843597e-01 1.56409063e-04 6.76769448e-12 3.42705586e-10
   7.99293184e-12]
  [9.99999881e-01 1.55193860e-07 4.55131430e-13 2.98025424e-11
   5.24310901e-13]
  [9.99981642e-01 1.84042729e-05 6.50766008e-13 5.44932719e-12
   8.59492978e-13]
  ...
  [9.99998689e-01 1.29910836e-06 1.24632265e-13 1.01338707e-12
   1.95984356e-13]
  [9.99978065e-01 2.18995810e-05 6.68549688e-13 5.88065447e-12
   8.74668285e-13]
  [9.99995232e-01 4.78460652e-06 1.16519153e-13 4.23325139e-13
   3.13810637e-13]]

 [[9.99842525e-01 1.57474104e-04 6.79291822e-12 3.44186318e-10
   8.02232326e-12]
  [9.99999881e-01 1.55196659e-07 4.55553564e-13 2.98793802e-11
   5.24863247e-13]
  [9.99995470e-01 4.56608359e-06 3.28296716e-13 5.28663007e-12
   4.66696289e-13]
  ...
  [9.98768628e-01 1.23134663e-03 6.51975999e-12 2.11542624e-11
   7.30022553e-12]
  [9.99997139e-01 2.86447244e-06 2.00958363e-13 1.34813710e-12
   4.09290169e-13]
  [9.99999762e-01 2.63285585e-07 1.91042616e-13 3.77488709e-12
   3.55611265e-13]]

 [[9.99999762e-01 2.35354051e-07 5.75903203e-13 1.80076735e-11
   1.03266419e-12]
  [9.99999762e-01 2.90667828e-07 4.41143399e-14 4.45814696e-12
   6.21682542e-14]
  [9.99979377e-01 2.05929991e-05 3.06163146e-12 3.20202857e-11
   5.17589617e-12]
  ...
  [9.99999166e-01 8.70525184e-07 2.34674097e-13 3.32798351e-12
   3.51230140e-13]
  [9.99999642e-01 3.73814345e-07 1.40970514e-13 2.04461448e-12
   2.43409432e-13]
  [9.99979496e-01 2.05367160e-05 9.71954613e-13 1.42162905e-11
   1.63987096e-12]]

 ...

 [[9.99998808e-01 1.24049552e-06 7.70194726e-13 2.37029216e-11
   1.13846508e-12]
  [9.99999881e-01 6.75563641e-08 6.43751748e-14 2.24518581e-11
   7.24568585e-14]
  [9.99224544e-01 7.75427965e-04 3.41847731e-11 6.55166976e-10
   5.05360892e-11]
  ...
  [9.99953151e-01 4.68441103e-05 1.87721583e-12 1.18835532e-11
   2.11351509e-12]
  [9.99996543e-01 3.41213104e-06 2.74530697e-13 1.50855153e-12
   6.16958199e-13]
  [9.99999881e-01 1.61442259e-07 1.18105206e-13 2.12552393e-12
   2.05274545e-13]]

 [[9.99776900e-01 2.23099196e-04 7.81401853e-12 4.26819746e-10
   9.20054484e-12]
  [9.99999881e-01 6.70748861e-08 1.57307530e-13 1.32706589e-11
   1.80285176e-13]
  [9.99994278e-01 5.74850219e-06 4.14349002e-13 8.29400871e-12
   7.54322603e-13]
  ...
  [1.00000000e+00 9.35595157e-09 3.36245009e-14 1.27918487e-12
   7.02506426e-14]
  [9.99999881e-01 1.34907935e-07 4.46118186e-13 1.45438930e-11
   6.22758138e-13]
  [9.99997854e-01 2.14655688e-06 1.82199918e-13 2.28479887e-12
   3.05415090e-13]]

 [[9.99951959e-01 4.80844828e-05 1.12399543e-11 1.13599063e-09
   1.07103987e-11]
  [9.99999881e-01 7.09753110e-08 8.76555772e-14 1.27117605e-11
   8.17610411e-14]
  [9.99849200e-01 1.50760636e-04 2.44454587e-12 1.48469917e-11
   3.21327036e-12]
  ...
  [9.99999523e-01 4.25586990e-07 1.85633342e-13 2.30751507e-12
   3.78996205e-13]
  [9.99999762e-01 2.68418518e-07 3.20055153e-13 7.17801556e-12
   5.10685407e-13]
  [9.75534439e-01 2.44655721e-02 1.68537101e-10 1.65846414e-09
   2.52140364e-10]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9984360e-01 1.5640906e-04 6.7676945e-12 3.4270559e-10 7.9929318e-12]
 [9.9999988e-01 1.5519386e-07 4.5513143e-13 2.9802542e-11 5.2431090e-13]
 [9.9998164e-01 1.8404273e-05 6.5076601e-13 5.4493272e-12 8.5949298e-13]
 ...
 [9.9999952e-01 4.2558699e-07 1.8563334e-13 2.3075151e-12 3.7899621e-13]
 [9.9999976e-01 2.6841852e-07 3.2005515e-13 7.1780156e-12 5.1068541e-13]
 [9.7553444e-01 2.4465572e-02 1.6853710e-10 1.6584641e-09 2.5214036e-10]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0021533925922587512
tp :  99964.0
fp :  36.0
tn :  399964.0
fn :  36.0
accuracy :  0.9998559951782227
precision :  0.9996399879455566
recall :  0.9996399879455566
auc :  0.9999872446060181

y_eval {0: 100000}
pred {0: 99964, 1: 36}
[INFO] confusion matrix for file 
[[99964    36     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[2988281     807       0       0       0]
 [ 281054       4       0       0       0]
 [  27050       2       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-01_203011_118.log.part06_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0:99.9988%,2:0.0008%,1:0.0004%]
[INFO] ** type:[0:99.9986%,1:0.001%,2:0.0004%]
[INFO] ** i/f_name:[2:99.998%,3:0.002%]
[INFO] ** i/f_dir:[1:99.9982%,0:0.0018%]
[INFO] ** src:[22:38.138%,9:26.0904%,7:18.1762%,1:17.5892%,10:0.0018%,11:0.0016%,14:0.0012%,21:0.0008%,15:0.0006%,4:0.0002%]
[INFO] ** dst:[21:43.3838%,10:20.845%,8:18.1758%,9:17.589%,15:0.002%,22:0.0014%,6:0.0014%,25:0.0004%,24:0.0004%,18:0.0004%,7:0.0004%]
[INFO] ** proto:[0:99.9954%,2:0.0026%,1:0.002%]
[INFO] ** appi_name:[21:99.9944%,30:0.002%,26:0.0008%,22:0.0006%,31:0.0004%,27:0.0004%,15:0.0004%,0:0.0004%,24:0.0002%,16:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.138%,20:26.0904%,13:18.1762%,6:17.5892%,17:0.002%,11:0.0018%,10:0.0016%,16:0.0006%,21:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9944%,-33.760870000000004:0.0052%,0.9188299999999999:0.0004%]
[INFO] ** modbus_function_description:[7:49.998%,11:49.9964%,0:0.0052%,15:0.0004%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.0894%,1:20.8438%,5:18.1758%,4:17.5888%,2:17.294%,0:0.0082%]
[INFO] ** service:[0.0048200000000000005:99.9954%,-211.73542999999998:0.002%,-211.08346:0.0008%,-211.08818:0.0006%,-186.44547:0.0004%,-186.43601999999998:0.0004%,-202.75898:0.0004%]
[INFO] ** s_port:[1.45442:26.0898%,-0.32151:20.844%,-1.27613:18.1758%,-0.23351:17.589%,-0.33484:17.294%,-71.33197:0.002%,-6.46392:0.0008%,-71.14798:0.0008%,1.45709:0.0006%,-71.14931:0.0006%,-1.02014:0.0006%,-1.27347:0.0004%,-68.79874000000001:0.0004%,-64.19493:0.0004%,-1.81611:0.0004%,-6.49859:0.0002%,-0.24151:0.0002%]
[INFO] ** classification:[normal:90.7904%,Single Stage Multi Point:5.7378%,Single Stage Single Point:3.4718%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7324393e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.7324393e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.7324393e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [-1.0386956e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0386956e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.0386956e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99995708e-01 4.29091278e-06 1.72071678e-12 3.95312949e-11
   2.71398485e-12]
  [9.99995947e-01 4.07126254e-06 8.31018631e-13 1.04729749e-11
   1.09430943e-12]
  [9.99920249e-01 7.97389075e-05 1.55955533e-12 7.32438415e-12
   2.54817413e-12]
  ...
  [1.00000000e+00 5.48260175e-08 3.56875682e-14 7.46086461e-13
   7.54099271e-14]
  [9.99993682e-01 6.33246145e-06 3.54577110e-12 1.10840337e-10
   5.78729946e-12]
  [9.99999166e-01 8.13800909e-07 5.13424644e-13 7.23046015e-12
   8.88401711e-13]]

 [[9.99996662e-01 3.39101962e-06 1.17355778e-12 3.56585178e-11
   1.68259655e-12]
  [9.99999881e-01 1.42680605e-07 3.60970992e-13 2.33185138e-11
   3.75041307e-13]
  [9.99924183e-01 7.57889575e-05 5.09259843e-13 5.26688979e-12
   1.01020277e-12]
  ...
  [9.99968886e-01 3.10922478e-05 1.09701115e-12 6.11895213e-12
   1.77694708e-12]
  [9.99975324e-01 2.46251839e-05 8.80820102e-13 4.02641852e-12
   1.74422510e-12]
  [9.99546468e-01 4.53457935e-04 6.88280032e-12 4.00362347e-11
   7.34235676e-12]]

 [[9.99995708e-01 4.24285145e-06 1.72042469e-12 3.95206645e-11
   2.71600949e-12]
  [9.99998808e-01 1.20648053e-06 2.43816859e-12 9.18328677e-11
   2.17442904e-12]
  [9.83866274e-01 1.61337331e-02 1.06133045e-11 4.65968063e-11
   1.92493955e-11]
  ...
  [9.99998569e-01 1.37994380e-06 6.21330854e-14 4.69088635e-13
   1.69378820e-13]
  [9.99999404e-01 5.90764728e-07 4.18853320e-13 7.18123087e-12
   6.52413074e-13]
  [9.99989986e-01 9.99137137e-06 4.26213643e-13 2.64341543e-12
   6.40779964e-13]]

 ...

 [[9.99923706e-01 7.63283751e-05 1.14048397e-11 9.51485224e-10
   1.16552063e-11]
  [1.00000000e+00 2.90659976e-08 4.73837888e-14 8.29299650e-12
   4.88742991e-14]
  [9.99750316e-01 2.49709672e-04 3.88578232e-12 5.92558849e-11
   7.37399031e-12]
  ...
  [1.00000000e+00 5.33299627e-09 2.32498211e-14 1.19657572e-12
   5.23309626e-14]
  [9.99999762e-01 2.00058864e-07 3.17030690e-13 7.15124487e-12
   4.67551887e-13]
  [9.99988198e-01 1.18197613e-05 8.21863411e-13 5.27673912e-12
   1.03752673e-12]]

 [[9.99999166e-01 8.46567787e-07 3.49000397e-13 8.72421232e-12
   5.78832175e-13]
  [1.00000000e+00 4.63603271e-08 1.74884114e-13 2.47830714e-11
   1.72185264e-13]
  [9.99994040e-01 5.99545001e-06 2.07092576e-13 3.84561914e-12
   3.96263073e-13]
  ...
  [9.99744117e-01 2.55932973e-04 1.98740894e-12 7.71351299e-12
   2.35005331e-12]
  [9.99993563e-01 6.42100304e-06 1.75404789e-13 7.24734346e-13
   3.77303305e-13]
  [9.99995708e-01 4.32622483e-06 1.03818776e-12 1.01686784e-11
   1.86259059e-12]]

 [[9.99999046e-01 9.71909003e-07 1.11988131e-12 5.58291954e-12
   1.55940452e-12]
  [9.99994516e-01 5.43144643e-06 1.24505170e-12 2.26328782e-11
   1.78900091e-12]
  [9.99533057e-01 4.67003876e-04 4.16797760e-12 1.22498305e-11
   7.64074307e-12]
  ...
  [9.99998689e-01 1.29555997e-06 1.50754151e-13 1.33474265e-12
   3.29595292e-13]
  [1.00000000e+00 4.41477326e-08 1.02293072e-13 4.54184780e-12
   1.57612367e-13]
  [9.99998450e-01 1.50008896e-06 2.93666269e-13 2.60421762e-12
   4.84323465e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999571e-01 4.2909128e-06 1.7207168e-12 3.9531295e-11 2.7139849e-12]
 [9.9999595e-01 4.0712625e-06 8.3101863e-13 1.0472975e-11 1.0943094e-12]
 [9.9992025e-01 7.9738908e-05 1.5595553e-12 7.3243842e-12 2.5481741e-12]
 ...
 [9.9999869e-01 1.2955600e-06 1.5075415e-13 1.3347426e-12 3.2959529e-13]
 [1.0000000e+00 4.4147733e-08 1.0229307e-13 4.5418478e-12 1.5761237e-13]
 [9.9999845e-01 1.5000890e-06 2.9366627e-13 2.6042176e-12 4.8432346e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0008968364638276398
tp :  99997.0
fp :  3.0
tn :  399997.0
fn :  3.0
accuracy :  0.9999879598617554
precision :  0.999970018863678
recall :  0.999970018863678
auc :  0.9999937415122986

y_eval {0: 100000}
pred {0: 99997, 1: 3}
[INFO] confusion matrix for file 
[[99997     3     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[3088278     810       0       0       0]
 [ 281054       4       0       0       0]
 [  27050       2       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0386956e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0386956e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.0386956e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [-3.4749308e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4749308e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-3.4749308e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99967575e-01 3.24579378e-05 2.93765468e-12 1.17325413e-10
   3.81754264e-12]
  [9.99999762e-01 2.85548055e-07 2.39565366e-13 1.15441606e-11
   2.85918289e-13]
  [9.99971867e-01 2.81403445e-05 2.07114144e-12 2.40746208e-11
   2.62736772e-12]
  ...
  [9.99966145e-01 3.38502141e-05 1.95125795e-12 4.99336059e-11
   3.16625003e-12]
  [9.99999762e-01 1.79736006e-07 9.00222618e-14 1.36269566e-12
   1.65471464e-13]
  [9.99995232e-01 4.79137816e-06 8.97832047e-13 1.18781608e-11
   1.24603615e-12]]

 [[9.95531261e-01 4.46878280e-03 1.65333830e-10 1.99333137e-08
   2.09854786e-10]
  [9.99999642e-01 3.25112410e-07 1.79201773e-13 7.49030959e-12
   2.16184994e-13]
  [9.99899268e-01 1.00691912e-04 4.41918897e-12 7.15508625e-11
   7.96835167e-12]
  ...
  [1.00000000e+00 5.24720463e-08 4.77290191e-14 1.40267398e-12
   9.21964802e-14]
  [9.99999523e-01 4.84046552e-07 2.94329394e-13 5.49292990e-12
   5.31653985e-13]
  [9.99997973e-01 1.97229883e-06 2.84240920e-13 4.79623199e-12
   5.34614291e-13]]

 [[9.99967933e-01 3.20636209e-05 2.92503652e-12 1.16684953e-10
   3.80341505e-12]
  [9.99997139e-01 2.87930061e-06 3.03098974e-12 7.33420547e-11
   2.75081368e-12]
  [9.99905825e-01 9.41281178e-05 1.77895795e-12 5.69208959e-12
   3.01868426e-12]
  ...
  [9.99999523e-01 4.69686285e-07 5.00596689e-13 8.49185739e-12
   8.03272108e-13]
  [9.99989629e-01 1.03337452e-05 4.60805331e-13 3.31353608e-12
   6.38907601e-13]
  [9.99998569e-01 1.38814710e-06 2.20377576e-13 1.98392604e-12
   4.41084208e-13]]

 ...

 [[9.99996901e-01 3.12966790e-06 1.22984316e-12 4.08873040e-11
   1.78865028e-12]
  [9.99999881e-01 1.06238915e-07 2.05665658e-13 1.14557660e-11
   2.11897326e-13]
  [9.99998569e-01 1.39875965e-06 4.67891242e-13 7.19909419e-12
   6.01324112e-13]
  ...
  [9.99914289e-01 8.57443520e-05 1.64006829e-11 2.95607705e-10
   2.38747355e-11]
  [9.99999642e-01 3.54065833e-07 1.31159610e-13 2.69719295e-12
   2.26870850e-13]
  [9.99999881e-01 1.06223922e-07 6.43733317e-14 2.06919377e-12
   1.19385987e-13]]

 [[9.99954700e-01 4.52818604e-05 3.95729586e-12 1.46441470e-10
   5.35463947e-12]
  [9.99996066e-01 3.90833748e-06 3.27502196e-12 7.71557887e-11
   2.79647009e-12]
  [9.99671578e-01 3.28374124e-04 2.55196602e-12 7.15993757e-12
   3.33035964e-12]
  ...
  [9.99999881e-01 1.52737087e-07 6.72686529e-14 1.42241665e-12
   1.53875258e-13]
  [9.99996066e-01 3.91890762e-06 7.35851538e-13 8.98504795e-12
   9.04194796e-13]
  [9.99996901e-01 3.05020308e-06 1.36334100e-13 9.19012913e-13
   2.89058897e-13]]

 [[9.95370686e-01 4.62935353e-03 1.23436567e-10 1.26743354e-08
   1.53065630e-10]
  [9.99999523e-01 4.78992035e-07 2.63431882e-13 1.09183287e-11
   2.92751636e-13]
  [9.99920845e-01 7.90958657e-05 2.54604779e-12 3.07672048e-11
   4.70540750e-12]
  ...
  [9.99991536e-01 8.48512900e-06 4.03140005e-13 2.50064444e-12
   9.22738557e-13]
  [9.99999881e-01 1.60336143e-07 1.50103034e-13 3.21478456e-12
   2.61537536e-13]
  [1.00000000e+00 3.99466558e-08 8.07705953e-14 3.17529596e-12
   1.40484738e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9996758e-01 3.2457938e-05 2.9376547e-12 1.1732541e-10 3.8175426e-12]
 [9.9999976e-01 2.8554805e-07 2.3956537e-13 1.1544161e-11 2.8591829e-13]
 [9.9997187e-01 2.8140345e-05 2.0711414e-12 2.4074621e-11 2.6273677e-12]
 ...
 [9.9999154e-01 8.4851290e-06 4.0314001e-13 2.5006444e-12 9.2273856e-13]
 [9.9999988e-01 1.6033614e-07 1.5010303e-13 3.2147846e-12 2.6153754e-13]
 [1.0000000e+00 3.9946656e-08 8.0770595e-14 3.1752960e-12 1.4048474e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0007674730107188225
tp :  99994.0
fp :  6.0
tn :  399994.0
fn :  6.0
accuracy :  0.9999760985374451
precision :  0.9999399781227112
recall :  0.9999399781227112
auc :  0.9999999403953552

y_eval {0: 100000}
pred {0: 99994, 1: 6}
[INFO] confusion matrix for file 
[[99994     6     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[3188272     816       0       0       0]
 [ 281054       4       0       0       0]
 [  27050       2       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4749308e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4749308e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-3.4749308e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [ 3.4625062e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4625062e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 3.4625062e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.9539810e-01 4.6018772e-03 1.2319747e-10 1.2670528e-08 1.5278487e-10]
  [1.0000000e+00 2.0582201e-08 1.3625133e-13 8.1380267e-12 1.6778774e-13]
  [9.9997354e-01 2.6445814e-05 4.4499913e-13 3.2607682e-12 6.4377686e-13]
  ...
  [9.9999917e-01 7.7564169e-07 6.4467192e-13 1.0089368e-11 1.0371167e-12]
  [9.9995148e-01 4.8469683e-05 1.0667350e-12 5.4684243e-12 1.3998639e-12]
  [9.9998331e-01 1.6711523e-05 1.9788760e-13 6.6965845e-13 4.8395782e-13]]

 [[9.9994040e-01 5.9570324e-05 4.0071553e-12 1.7880734e-10 5.0005109e-12]
  [9.9999952e-01 4.5037493e-07 6.5832441e-13 2.2207469e-11 7.4540759e-13]
  [9.9995673e-01 4.3254968e-05 1.6667951e-12 1.2575181e-11 1.9751820e-12]
  ...
  [9.9999809e-01 1.8747745e-06 2.6570787e-13 3.1203133e-12 4.6721681e-13]
  [9.9999797e-01 2.0129260e-06 5.1679402e-13 4.5274119e-12 9.7336408e-13]
  [9.9997401e-01 2.5986879e-05 1.0464493e-12 7.2623435e-12 1.2654191e-12]]

 [[9.9994040e-01 5.9589758e-05 4.0104586e-12 1.7904453e-10 5.0043368e-12]
  [9.9999964e-01 3.6338045e-07 8.7888469e-13 3.5709671e-11 8.2493219e-13]
  [9.9973685e-01 2.6315299e-04 1.6262089e-12 4.5205610e-12 2.0760646e-12]
  ...
  [9.9999213e-01 7.8189969e-06 1.2475923e-12 8.7816299e-12 2.3608945e-12]
  [9.9998677e-01 1.3173043e-05 4.6524709e-13 2.3784184e-12 6.9487086e-13]
  [9.9995697e-01 4.3029268e-05 6.4546415e-13 3.1458685e-12 1.3265654e-12]]

 ...

 [[9.9495584e-01 5.0441287e-03 1.0344667e-10 9.3304271e-09 1.2577812e-10]
  [1.0000000e+00 1.0245969e-08 9.8406567e-14 6.2335510e-12 1.3016675e-13]
  [9.9998713e-01 1.2864815e-05 7.3215034e-13 7.2784834e-12 8.5864562e-13]
  ...
  [9.9998581e-01 1.4200299e-05 5.0472582e-13 2.5944030e-12 7.3245527e-13]
  [9.9998629e-01 1.3710233e-05 8.5845827e-13 4.5453554e-12 1.8422013e-12]
  [9.9999988e-01 1.1154191e-07 9.4950171e-14 1.8727296e-12 1.7767945e-13]]

 [[9.9999750e-01 2.4753454e-06 1.2912570e-12 4.3039666e-11 1.9045650e-12]
  [1.0000000e+00 9.4141459e-09 2.2723416e-14 4.5951836e-12 2.5340085e-14]
  [9.9999559e-01 4.4082876e-06 1.0398622e-12 1.2994554e-11 1.3964267e-12]
  ...
  [9.9999881e-01 1.1572045e-06 4.1021071e-13 4.2412050e-12 6.8495486e-13]
  [9.9997878e-01 2.1182705e-05 6.5237979e-13 2.8491951e-12 9.4288770e-13]
  [9.9997735e-01 2.2626366e-05 3.8078476e-13 1.8715092e-12 9.0079029e-13]]

 [[9.9501485e-01 4.9851499e-03 1.0305754e-10 9.3244159e-09 1.2532100e-10]
  [9.9999726e-01 2.7363428e-06 1.1291341e-12 2.3859052e-11 1.0927674e-12]
  [9.9995446e-01 4.5582627e-05 9.1090969e-13 4.9412670e-12 1.3890352e-12]
  ...
  [9.9999893e-01 1.0218266e-06 5.6208869e-14 5.9759695e-13 1.4421494e-13]
  [9.9999988e-01 6.9690728e-08 1.2277018e-13 3.4198757e-12 2.3102099e-13]
  [1.0000000e+00 4.0254282e-08 9.1894510e-14 3.7430974e-12 1.5689284e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9539810e-01 4.6018772e-03 1.2319747e-10 1.2670528e-08 1.5278487e-10]
 [1.0000000e+00 2.0582201e-08 1.3625133e-13 8.1380267e-12 1.6778774e-13]
 [9.9997354e-01 2.6445814e-05 4.4499913e-13 3.2607682e-12 6.4377686e-13]
 ...
 [9.9999893e-01 1.0218266e-06 5.6208869e-14 5.9759695e-13 1.4421494e-13]
 [9.9999988e-01 6.9690728e-08 1.2277018e-13 3.4198757e-12 2.3102099e-13]
 [1.0000000e+00 4.0254282e-08 9.1894510e-14 3.7430974e-12 1.5689284e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0016831423996016383
tp :  99980.0
fp :  20.0
tn :  399980.0
fn :  20.0
accuracy :  0.9999200105667114
precision :  0.9998000264167786
recall :  0.9998000264167786
auc :  0.9999620914459229

y_eval {0: 100000}
pred {0: 99980, 1: 20}
[INFO] confusion matrix for file 
[[99980    20     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[3288252     836       0       0       0]
 [ 281054       4       0       0       0]
 [  27050       2       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4625062e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4625062e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 3.4625062e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 ...
 [ 1.0399942e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.0399942e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0399942e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99998093e-01 1.91950994e-06 7.26833470e-13 2.01710662e-11
   1.13076876e-12]
  [9.99999881e-01 1.07135484e-07 4.66888030e-13 3.36106351e-11
   4.73779327e-13]
  [9.99987721e-01 1.23325053e-05 5.90310515e-13 3.83636395e-12
   1.09113445e-12]
  ...
  [9.99998450e-01 1.49191123e-06 9.19301853e-13 1.26433603e-11
   1.52803790e-12]
  [9.99955535e-01 4.44533143e-05 1.04463725e-12 5.63414072e-12
   1.32214313e-12]
  [9.99835134e-01 1.64865050e-04 1.65805390e-12 9.67983679e-12
   3.10196270e-12]]

 [[9.99999166e-01 8.89980072e-07 3.39487634e-13 7.14663181e-12
   5.41658081e-13]
  [1.00000000e+00 3.66796336e-08 1.22923888e-13 3.13762211e-11
   1.30922698e-13]
  [9.99976397e-01 2.35759217e-05 1.09002813e-12 4.82826192e-12
   2.04450042e-12]
  ...
  [9.99999881e-01 6.69576679e-08 8.40621653e-14 3.18642248e-12
   1.66052596e-13]
  [9.99999881e-01 1.78256727e-07 1.47669678e-13 2.67173111e-12
   2.64858800e-13]
  [9.99999881e-01 1.36071876e-07 1.73045863e-13 4.39898682e-12
   3.06630399e-13]]

 [[9.96154845e-01 3.84518784e-03 4.50953268e-11 2.63016897e-09
   5.50547073e-11]
  [9.99998689e-01 1.27270869e-06 1.22303578e-12 3.74826004e-11
   1.24873137e-12]
  [9.99983549e-01 1.64747034e-05 1.28613862e-12 7.27197686e-12
   2.34863995e-12]
  ...
  [9.99993920e-01 6.07517677e-06 1.65859473e-13 5.36122362e-13
   4.13018523e-13]
  [1.00000000e+00 4.09443857e-08 1.15034880e-13 4.08513154e-12
   2.03030152e-13]
  [9.99997973e-01 2.01435864e-06 4.18537275e-13 7.21335708e-12
   5.66950946e-13]]

 ...

 [[9.99953985e-01 4.60158844e-05 1.12199078e-11 1.14003895e-09
   1.06933360e-11]
  [9.99999762e-01 2.28861467e-07 5.40279898e-13 3.46654441e-11
   4.42718182e-13]
  [9.97705519e-01 2.29451456e-03 2.26729421e-12 3.19217526e-12
   3.73848565e-12]
  ...
  [9.99999762e-01 2.32128116e-07 6.96325796e-14 7.88078262e-13
   1.49316608e-13]
  [9.99997258e-01 2.68776853e-06 8.50837142e-13 1.43705221e-11
   1.10243932e-12]
  [9.99991655e-01 8.28775046e-06 4.17030966e-13 6.63577786e-12
   6.92249697e-13]]

 [[9.99954104e-01 4.59127041e-05 1.12190951e-11 1.14071552e-09
   1.06904815e-11]
  [1.00000000e+00 1.06895808e-08 1.89644815e-14 5.33270303e-12
   2.10260276e-14]
  [9.99993563e-01 6.46605804e-06 2.42967755e-13 1.56170281e-12
   3.48949846e-13]
  ...
  [9.99999285e-01 6.89315641e-07 1.83374041e-13 2.52040663e-12
   3.27110382e-13]
  [9.99858260e-01 1.41662778e-04 2.88540329e-12 1.50284438e-11
   3.22655292e-12]
  [9.99998569e-01 1.39386191e-06 5.58434897e-14 3.71648404e-13
   1.53015187e-13]]

 [[9.97404397e-01 2.59556249e-03 2.84860711e-11 1.52500690e-09
   3.38381788e-11]
  [9.99999642e-01 3.69813193e-07 7.23262541e-13 2.95321684e-11
   8.43989212e-13]
  [9.99999762e-01 2.60389982e-07 1.02916550e-13 2.61035269e-12
   1.73368278e-13]
  ...
  [9.99999762e-01 2.52185913e-07 3.86042571e-13 8.62098240e-12
   5.74447391e-13]
  [9.99999642e-01 3.13203969e-07 1.60458750e-13 2.66531220e-12
   2.86454860e-13]
  [9.99967098e-01 3.29217401e-05 2.17947557e-12 2.25182824e-11
   2.50290717e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.99998093e-01 1.91950994e-06 7.26833470e-13 2.01710662e-11
  1.13076876e-12]
 [9.99999881e-01 1.07135484e-07 4.66888030e-13 3.36106351e-11
  4.73779327e-13]
 [9.99987721e-01 1.23325053e-05 5.90310515e-13 3.83636395e-12
  1.09113445e-12]
 ...
 [9.99999762e-01 2.52185913e-07 3.86042571e-13 8.62098240e-12
  5.74447391e-13]
 [9.99999642e-01 3.13203969e-07 1.60458750e-13 2.66531220e-12
  2.86454860e-13]
 [9.99967098e-01 3.29217401e-05 2.17947557e-12 2.25182824e-11
  2.50290717e-12]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  2.216120646160841
tp :  82593.0
fp :  17407.0
tn :  382593.0
fn :  17407.0
accuracy :  0.9303726553916931
precision :  0.8259299993515015
recall :  0.8259299993515015
auc :  0.8909271955490112

y_eval {0: 82641, 1: 17359}
pred {0: 99952, 1: 48}
[INFO] confusion matrix for file 
[[82593    48     0     0     0]
 [17359     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[3370845     884       0       0       0]
 [ 298413       4       0       0       0]
 [  27050       2       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0399942  0.         0.        ...  4.         0.00482   -0.23351  ]
 [ 1.0399942  0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 1.0399942  0.         0.        ...  1.         0.00482   -0.32151  ]
 ...
 [ 1.733738   0.         0.        ...  2.         0.00482   -0.33484  ]
 [ 1.733738   0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 1.733738   0.         0.        ...  3.         0.00482    1.45442  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [0. 0. 1. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 2 2] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99999762e-01 2.74782309e-07 6.09297985e-13 1.92555121e-11
   1.09661824e-12]
  [9.99999881e-01 1.57486184e-07 3.67764731e-14 4.38171981e-12
   4.99757062e-14]
  [9.99903083e-01 9.69437751e-05 9.56103686e-12 8.72765540e-11
   1.61705805e-11]
  ...
  [9.99985456e-01 1.45127342e-05 4.34845389e-12 7.72934217e-11
   6.31755715e-12]
  [9.99999881e-01 1.36411657e-07 5.32420042e-14 8.15066601e-13
   1.07176238e-13]
  [9.99996901e-01 3.06425636e-06 9.07561407e-13 1.69313799e-11
   1.01349929e-12]]

 [[9.97343361e-01 2.65659695e-03 2.89273154e-11 1.54958346e-09
   3.43741251e-11]
  [9.99999642e-01 3.74888572e-07 7.26737572e-13 2.94787042e-11
   8.48411565e-13]
  [9.99999285e-01 7.40165603e-07 1.02396458e-13 2.44678821e-12
   1.69735333e-13]
  ...
  [9.99999046e-01 9.96829158e-07 3.55838297e-13 5.94979231e-12
   5.01716724e-13]
  [9.99999762e-01 2.91517580e-07 2.50702969e-13 4.75090757e-12
   4.40630659e-13]
  [9.99997020e-01 2.98604550e-06 4.55149265e-13 5.73362451e-12
   7.50036480e-13]]

 [[9.99954462e-01 4.55063127e-05 1.12162111e-11 1.14343457e-09
   1.06793784e-11]
  [9.99999881e-01 8.63036220e-08 1.02973511e-13 1.37873315e-11
   9.50933464e-14]
  [9.99995232e-01 4.77394542e-06 6.55571246e-13 8.44978167e-12
   1.17880564e-12]
  ...
  [9.99769270e-01 2.30793288e-04 2.13035527e-11 3.29856586e-10
   2.93331158e-11]
  [1.00000000e+00 3.94039290e-08 5.02080745e-14 1.56973436e-12
   1.10190997e-13]
  [9.99996781e-01 3.15990724e-06 1.30665151e-12 2.96665609e-11
   1.40713645e-12]]

 ...

 [[9.73931909e-01 2.60680672e-02 3.02210867e-10 2.29015118e-08
   3.62216146e-10]
  [9.99999523e-01 4.40151865e-07 1.67013051e-13 4.91210501e-12
   2.19367100e-13]
  [9.99997973e-01 1.98908970e-06 1.20700748e-12 2.09496396e-11
   2.01849843e-12]
  ...
  [9.99999881e-01 9.43849301e-08 9.35856752e-14 2.44096778e-12
   1.67381774e-13]
  [9.99994278e-01 5.70992233e-06 1.08988328e-12 2.01003623e-11
   1.73410743e-12]
  [9.99994755e-01 5.20401591e-06 6.54973526e-13 4.18259177e-12
   1.31008518e-12]]

 [[9.99999762e-01 1.87078129e-07 3.70474701e-13 9.64471558e-12
   6.64371824e-13]
  [9.99999881e-01 1.22021632e-07 5.48405180e-13 3.42741321e-11
   5.58598903e-13]
  [9.96025443e-01 3.97459650e-03 6.12779749e-12 9.04099365e-11
   1.41137536e-11]
  ...
  [9.99919891e-01 8.00721900e-05 2.34858877e-12 1.40648699e-11
   2.71414640e-12]
  [9.99939442e-01 6.05736641e-05 5.60066154e-13 3.28899603e-12
   1.19161343e-12]
  [9.99993205e-01 6.82936025e-06 7.44763409e-13 5.04384338e-12
   1.43998138e-12]]

 [[9.99755323e-01 2.44693365e-04 8.07204217e-12 4.38549308e-10
   9.46083836e-12]
  [1.00000000e+00 9.29854238e-09 3.19011073e-14 1.03105111e-11
   4.06265597e-14]
  [9.99999642e-01 3.22692813e-07 1.99064398e-13 5.59228011e-12
   2.74441494e-13]
  ...
  [9.99998689e-01 1.27098269e-06 8.24231471e-13 1.27079397e-11
   1.34094591e-12]
  [9.99997377e-01 2.62067124e-06 4.56636356e-13 3.29828330e-12
   8.45116511e-13]
  [9.99998689e-01 1.30000194e-06 2.08432148e-13 2.84467957e-12
   3.37638012e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999976e-01 2.7478231e-07 6.0929799e-13 1.9255512e-11 1.0966182e-12]
 [9.9999988e-01 1.5748618e-07 3.6776473e-14 4.3817198e-12 4.9975706e-14]
 [9.9990308e-01 9.6943775e-05 9.5610369e-12 8.7276554e-11 1.6170580e-11]
 ...
 [9.9999869e-01 1.2709827e-06 8.2423147e-13 1.2707940e-11 1.3409459e-12]
 [9.9999738e-01 2.6206712e-06 4.5663636e-13 3.2982833e-12 8.4511651e-13]
 [9.9999869e-01 1.3000019e-06 2.0843215e-13 2.8446796e-12 3.3763801e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  4.626316625356674
tp :  71270.0
fp :  28730.0
tn :  371270.0
fn :  28730.0
accuracy :  0.8850809931755066
precision :  0.7127000093460083
recall :  0.7127000093460083
auc :  0.8189114928245544

y_eval {0: 71311, 2: 28689}
pred {0: 99956, 1: 44}
[INFO] confusion matrix for file 
[[71270    41     0     0     0]
 [    0     0     0     0     0]
 [28686     3     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[3442115     925       0       0       0]
 [ 298413       4       0       0       0]
 [  55736       5       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-01_203011_118.log.part07_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0:99.9996%,2:0.0004%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9994%,3:0.0006%]
[INFO] ** i/f_dir:[1:99.9994%,0:0.0006%]
[INFO] ** src:[22:38.0718%,9:26.1174%,7:18.2344%,1:17.5754%,21:0.0008%,14:0.0002%]
[INFO] ** dst:[21:43.3758%,10:20.813%,8:18.2342%,9:17.5754%,15:0.0006%,22:0.0004%,24:0.0002%,18:0.0002%,6:0.0002%]
[INFO] ** proto:[0:99.999%,1:0.0006%,2:0.0004%]
[INFO] ** appi_name:[21:99.999%,30:0.0006%,31:0.0002%,22:0.0002%]
[INFO] ** proxy_src_ip:[18:38.0718%,20:26.1174%,13:18.2344%,6:17.5754%,17:0.0006%,7:0.0004%]
[INFO] ** modbus_function_code:[0.02961:99.999%,-33.760870000000004:0.001%]
[INFO] ** modbus_function_description:[7:49.9996%,11:49.9994%,0:0.001%]
[INFO] ** modbus_transaction_id:65301 (13.0602%)
[INFO] ** scada_tag:[3:26.1164%,1:20.813%,5:18.2338%,4:17.575%,2:17.2586%,0:0.0032%]
[INFO] ** service:[0.0048200000000000005:99.999%,-211.73542999999998:0.0006%,-186.43601999999998:0.0002%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:26.1168%,-0.32151:20.813%,-1.27613:18.234%,-0.23351:17.5752%,-0.33484:17.2588%,-71.33197:0.0006%,-1.27347:0.0002%,1.45709:0.0002%,1.46509:0.0002%,1.47576:0.0002%,4.42897:0.0002%,-0.24151:0.0002%,-71.14931:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:89.2092%,Single Stage Multi Point:10.7908%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7311594e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.7311594e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.7311594e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [-1.0380956e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.0380956e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0380956e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[0. 0. 1. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 0. 1. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [2 0 0 ... 2 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99978185e-01 2.17645629e-05 2.35811197e-12 8.57828530e-11
   3.15932046e-12]
  [9.99999523e-01 4.42964819e-07 9.03870349e-13 4.17752742e-11
   9.00140422e-13]
  [9.99815643e-01 1.84366931e-04 1.74397649e-12 6.84689935e-12
   2.34504994e-12]
  ...
  [9.99005616e-01 9.94383590e-04 4.83532875e-12 2.92488846e-11
   8.57747640e-12]
  [9.99814570e-01 1.85463257e-04 1.04157603e-11 1.33073372e-10
   1.53805215e-11]
  [1.00000000e+00 1.93784953e-08 4.01998347e-14 1.39885878e-12
   8.33539238e-14]]

 [[9.99960184e-01 3.97963413e-05 8.66267127e-12 2.53966934e-11
   1.21442596e-11]
  [9.99839664e-01 1.60320342e-04 4.49259276e-11 1.46295642e-10
   3.94657640e-11]
  [9.98334825e-01 1.66516914e-03 3.66413237e-12 4.31270384e-12
   7.57671530e-12]
  ...
  [9.99998093e-01 1.85021861e-06 9.11470877e-13 1.39954263e-11
   1.51373044e-12]
  [9.99993682e-01 6.34992011e-06 2.97795995e-13 2.50934560e-12
   4.95277159e-13]
  [9.99994397e-01 5.61531215e-06 6.85087675e-13 4.85822407e-12
   1.35371976e-12]]

 [[9.99984622e-01 1.53705005e-05 6.28940606e-12 3.88866966e-10
   8.30805216e-12]
  [9.99999881e-01 6.92521311e-08 4.18040812e-14 5.12529082e-12
   4.96721770e-14]
  [9.99979258e-01 2.07338962e-05 2.62998933e-12 2.80539428e-11
   3.66674009e-12]
  ...
  [9.99787271e-01 2.12714061e-04 7.73338078e-12 7.73782496e-11
   1.26074862e-11]
  [1.00000000e+00 1.09532881e-08 3.26260557e-14 1.27380658e-12
   7.11792685e-14]
  [9.99999881e-01 1.51206194e-07 2.83325609e-13 7.14231712e-12
   4.07216849e-13]]

 ...

 [[9.95495915e-01 4.50405059e-03 1.65880101e-10 1.99580192e-08
   2.10517631e-10]
  [9.99999523e-01 4.96919085e-07 2.26099291e-13 9.27508938e-12
   2.51256318e-13]
  [9.99885559e-01 1.14377093e-04 4.20979441e-12 4.04190188e-11
   4.42601164e-12]
  ...
  [9.99999762e-01 2.19920395e-07 6.11493481e-14 1.38529325e-12
   1.14756539e-13]
  [9.99996901e-01 3.14590466e-06 4.30020955e-13 4.11210519e-12
   6.81558705e-13]
  [9.98468459e-01 1.53150316e-03 3.56907646e-12 1.83947614e-11
   6.21490533e-12]]

 [[9.99998689e-01 1.31673414e-06 5.33025284e-13 1.49806695e-11
   7.54730371e-13]
  [1.00000000e+00 3.15504209e-08 7.50264380e-14 1.29258410e-11
   7.89697084e-14]
  [9.99956489e-01 4.35389957e-05 1.90077836e-12 1.08341365e-11
   3.55228629e-12]
  ...
  [9.99994159e-01 5.86457008e-06 7.15458454e-13 8.70973606e-12
   8.95348032e-13]
  [9.99984980e-01 1.50505903e-05 3.87545546e-13 1.97271496e-12
   6.70492795e-13]
  [9.99821961e-01 1.78105314e-04 2.51960887e-12 1.70571855e-11
   5.30721994e-12]]

 [[9.99999285e-01 6.58462000e-07 2.66879428e-13 5.00239867e-12
   4.37660298e-13]
  [9.99999523e-01 4.33810470e-07 8.44063209e-13 4.63506872e-11
   8.12663359e-13]
  [9.99998331e-01 1.70100225e-06 1.06046506e-13 2.65008111e-12
   1.79898468e-13]
  ...
  [9.99996781e-01 3.24162397e-06 9.05901005e-13 8.13067755e-12
   1.62413616e-12]
  [9.99988437e-01 1.15759149e-05 3.63911782e-13 4.91991734e-12
   5.70177152e-13]
  [9.99328732e-01 6.71271060e-04 4.65036083e-12 1.49834589e-11
   5.28305481e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9997818e-01 2.1764563e-05 2.3581120e-12 8.5782853e-11 3.1593205e-12]
 [9.9999952e-01 4.4296482e-07 9.0387035e-13 4.1775274e-11 9.0014042e-13]
 [9.9981564e-01 1.8436693e-04 1.7439765e-12 6.8468993e-12 2.3450499e-12]
 ...
 [9.9999678e-01 3.2416240e-06 9.0590101e-13 8.1306776e-12 1.6241362e-12]
 [9.9998844e-01 1.1575915e-05 3.6391178e-13 4.9199173e-12 5.7017715e-13]
 [9.9932873e-01 6.7127106e-04 4.6503608e-12 1.4983459e-11 5.2830548e-12]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  7.571770488739014
tp :  53024.0
fp :  46976.0
tn :  353024.0
fn :  46976.0
accuracy :  0.8120977878570557
precision :  0.530239999294281
recall :  0.530239999294281
auc :  0.7039937973022461

y_eval {0: 53027, 2: 46973}
pred {0: 99997, 1: 3}
[INFO] confusion matrix for file 
[[53024     3     0     0     0]
 [    0     0     0     0     0]
 [46973     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[3495139     928       0       0       0]
 [ 298413       4       0       0       0]
 [ 102709       5       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0380956e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0380956e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.0380956e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-3.4757039e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-3.4757039e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-3.4757039e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 2 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.95571733e-01 4.42827959e-03 1.64843042e-10 1.99297894e-08
   2.09278928e-10]
  [1.00000000e+00 9.01732200e-09 8.74748746e-14 5.26873597e-12
   1.16976646e-13]
  [9.99994040e-01 5.93697041e-06 1.88115921e-13 3.30033635e-12
   2.86054681e-13]
  ...
  [9.99993443e-01 6.51188202e-06 1.38267314e-13 7.87027778e-13
   3.55944928e-13]
  [9.99999642e-01 3.55163593e-07 1.68543375e-13 3.50614720e-12
   3.46007972e-13]
  [9.99992967e-01 6.99846305e-06 1.52904414e-12 2.58751423e-11
   1.89488572e-12]]

 [[9.99956131e-01 4.38233365e-05 3.28589695e-12 1.35534875e-10
   4.20875054e-12]
  [9.99998569e-01 1.40801990e-06 1.14407670e-12 2.33129696e-11
   1.27920493e-12]
  [9.99982595e-01 1.73569988e-05 1.24542163e-12 9.88590893e-12
   1.53045209e-12]
  ...
  [9.99227524e-01 7.72454310e-04 5.38554748e-12 1.99357562e-11
   6.06836066e-12]
  [9.99994516e-01 5.46350566e-06 2.72164696e-13 1.39825619e-12
   6.01646391e-13]
  [9.99999881e-01 6.13455668e-08 7.58371569e-14 2.05645765e-12
   1.47305386e-13]]

 [[9.99999762e-01 2.77485498e-07 6.76775422e-13 5.28571501e-12
   9.35634057e-13]
  [9.99984980e-01 1.50472324e-05 9.41776171e-12 9.53245261e-11
   1.10735986e-11]
  [9.99982715e-01 1.73161625e-05 2.87971280e-13 2.13598887e-12
   5.59594959e-13]
  ...
  [9.99997258e-01 2.71235399e-06 5.00220471e-13 1.12851464e-11
   8.25758244e-13]
  [9.99999762e-01 2.34861233e-07 9.88241132e-14 1.51010530e-12
   1.78785629e-13]
  [9.99999404e-01 6.19713944e-07 3.76873988e-13 6.49509309e-12
   6.43140543e-13]]

 ...

 [[9.99931812e-01 6.82295577e-05 4.56016518e-12 1.81370266e-10
   5.97521858e-12]
  [9.99999166e-01 8.88838372e-07 7.88913965e-13 1.92833232e-11
   8.82487388e-13]
  [9.99969125e-01 3.09183888e-05 1.90663739e-12 2.04152147e-11
   2.05730853e-12]
  ...
  [9.99980569e-01 1.94129971e-05 1.39722370e-12 1.74248272e-11
   2.49268835e-12]
  [9.99999642e-01 3.13721131e-07 6.85527481e-14 8.19601385e-13
   1.58270857e-13]
  [9.99999166e-01 8.50398465e-07 8.43929256e-13 1.81228504e-11
   1.30015855e-12]]

 [[9.99949813e-01 5.02268558e-05 1.11486965e-11 1.06008613e-09
   1.09067139e-11]
  [1.00000000e+00 1.51168784e-08 2.31892362e-14 5.48583358e-12
   2.54679073e-14]
  [9.99979615e-01 2.03509135e-05 1.05040672e-12 1.12234484e-11
   1.46535757e-12]
  ...
  [9.99787390e-01 2.12663581e-04 1.29877034e-12 3.85619358e-12
   1.85230498e-12]
  [9.99161124e-01 8.38899403e-04 2.58493140e-12 7.57207404e-12
   6.17309025e-12]
  [9.99999881e-01 1.55850898e-07 5.71853017e-14 7.58169460e-13
   1.40985612e-13]]

 [[9.99932408e-01 6.76218406e-05 4.54486839e-12 1.80454582e-10
   5.95920795e-12]
  [9.99998212e-01 1.81106134e-06 1.52337268e-12 3.00729268e-11
   1.67479615e-12]
  [9.99985933e-01 1.40156817e-05 7.93683370e-13 6.48463271e-12
   1.11998843e-12]
  ...
  [9.99999285e-01 6.64593472e-07 1.27329489e-13 1.31532903e-12
   2.57429576e-13]
  [9.99999881e-01 9.27932220e-08 7.03360438e-14 1.69936038e-12
   1.31340875e-13]
  [9.99978900e-01 2.10827438e-05 1.63823176e-12 2.77656752e-11
   2.73878511e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9557173e-01 4.4282796e-03 1.6484304e-10 1.9929789e-08 2.0927893e-10]
 [1.0000000e+00 9.0173220e-09 8.7474875e-14 5.2687360e-12 1.1697665e-13]
 [9.9999404e-01 5.9369704e-06 1.8811592e-13 3.3003363e-12 2.8605468e-13]
 ...
 [9.9999928e-01 6.6459347e-07 1.2732949e-13 1.3153290e-12 2.5742958e-13]
 [9.9999988e-01 9.2793222e-08 7.0336044e-14 1.6993604e-12 1.3134087e-13]
 [9.9997890e-01 2.1082744e-05 1.6382318e-12 2.7765675e-11 2.7387851e-12]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  1.1262525031745434
tp :  93012.0
fp :  6988.0
tn :  393012.0
fn :  6988.0
accuracy :  0.972048282623291
precision :  0.9301199913024902
recall :  0.9301199913024902
auc :  0.9560257792472839

y_eval {0: 93019, 2: 6981}
pred {0: 99993, 1: 7}
[INFO] confusion matrix for file 
[[93012     7     0     0     0]
 [    0     0     0     0     0]
 [ 6981     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[3588151     935       0       0       0]
 [ 298413       4       0       0       0]
 [ 109690       5       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-0.3475704  0.         0.        ...  2.         0.00482   -0.33484  ]
 [-0.3475704  0.         0.        ...  3.         0.00482    1.45442  ]
 [-0.3475704  0.         0.        ...  2.         0.00482   -0.33484  ]
 ...
 [ 0.3454935  0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 0.3454935  0.         0.        ...  3.         0.00482    1.45442  ]
 [ 0.3454935  0.         0.        ...  2.         0.00482   -0.33484  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99999285e-01 7.56391046e-07 2.94561250e-13 6.11736443e-12
   4.79361071e-13]
  [1.00000000e+00 4.69564014e-08 1.45418278e-13 2.87827730e-11
   1.49740165e-13]
  [9.99989986e-01 1.00620164e-05 8.28351927e-13 6.66079822e-12
   1.43497573e-12]
  ...
  [9.99999762e-01 2.08283197e-07 1.75636876e-13 3.34005501e-12
   3.09458757e-13]
  [9.99999881e-01 8.24726811e-08 1.12527521e-13 3.00882192e-12
   1.79772511e-13]
  [9.99988794e-01 1.11510371e-05 6.06083055e-13 7.29322592e-12
   7.35273713e-13]]

 [[9.99933004e-01 6.69587826e-05 4.52898309e-12 1.79517831e-10
   5.94291196e-12]
  [9.99999881e-01 1.78185516e-07 1.67249976e-13 9.78211002e-12
   2.00085743e-13]
  [9.99997735e-01 2.32022421e-06 4.46073842e-13 7.80305334e-12
   6.86057602e-13]
  ...
  [9.99997377e-01 2.57415263e-06 4.47969922e-13 6.58466554e-12
   5.91926248e-13]
  [1.00000000e+00 4.71274149e-08 2.28166180e-14 5.37747852e-13
   5.23290653e-14]
  [1.00000000e+00 3.31465806e-08 6.72288966e-14 2.21356202e-12
   1.29491971e-13]]

 [[9.99925494e-01 7.45097423e-05 4.27733630e-12 1.91234681e-10
   5.29346445e-12]
  [9.99996424e-01 3.53046244e-06 3.59932505e-12 9.25050730e-11
   3.03454505e-12]
  [9.85172033e-01 1.48279853e-02 1.26623651e-11 4.43678774e-11
   2.55974721e-11]
  ...
  [9.99997139e-01 2.89221589e-06 2.81573430e-13 1.64318743e-12
   5.54689270e-13]
  [9.99999881e-01 1.29412598e-07 8.24390876e-14 1.95819164e-12
   1.59616921e-13]
  [9.99997854e-01 2.15654541e-06 4.07889217e-13 4.97018832e-12
   5.93507014e-13]]

 ...

 [[9.99899983e-01 9.99855110e-05 5.05884527e-12 2.37588421e-10
   6.11235975e-12]
  [9.99995708e-01 4.35000493e-06 3.71553959e-12 9.27429800e-11
   3.22438777e-12]
  [9.98476803e-01 1.52324233e-03 3.46320477e-12 1.66669890e-11
   7.07290520e-12]
  ...
  [9.99999523e-01 4.30354476e-07 7.40872885e-14 8.03891350e-13
   1.72005300e-13]
  [1.00000000e+00 4.54145841e-08 5.79693018e-14 1.58660281e-12
   1.04358782e-13]
  [9.99996424e-01 3.62281207e-06 7.04913504e-13 1.06143740e-11
   8.60951176e-13]]

 [[9.99133289e-01 8.66728078e-04 1.62271273e-11 8.85094553e-10
   1.94486111e-11]
  [9.99999881e-01 1.07643871e-07 3.08150668e-13 2.59530696e-11
   3.59094915e-13]
  [9.99997139e-01 2.90097000e-06 5.40668096e-13 6.23096540e-12
   9.14519220e-13]
  ...
  [9.99999762e-01 2.03339596e-07 1.04194865e-13 1.65688188e-12
   2.08933890e-13]
  [1.00000000e+00 3.14582422e-08 7.29368958e-14 2.52246184e-12
   1.36479180e-13]
  [9.99999404e-01 6.28969531e-07 5.91320341e-13 9.88637644e-12
   9.36701563e-13]]

 [[9.99997973e-01 2.02565138e-06 9.66708918e-13 2.95271065e-11
   1.44036465e-12]
  [9.99999762e-01 2.18621594e-07 6.04864357e-13 6.40977549e-11
   6.10162040e-13]
  [9.99999404e-01 5.88528906e-07 6.19662673e-14 1.78678611e-12
   1.06575447e-13]
  ...
  [9.99996066e-01 3.95556617e-06 6.29126254e-13 4.39552301e-12
   1.14015264e-12]
  [9.99999523e-01 4.53949696e-07 1.13587125e-13 1.58057020e-12
   2.02801710e-13]
  [9.99999762e-01 2.78667187e-07 1.46530805e-13 2.54989367e-12
   2.83192144e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.99999285e-01 7.56391046e-07 2.94561250e-13 6.11736443e-12
  4.79361071e-13]
 [1.00000000e+00 4.69564014e-08 1.45418278e-13 2.87827730e-11
  1.49740165e-13]
 [9.99989986e-01 1.00620164e-05 8.28351927e-13 6.66079822e-12
  1.43497573e-12]
 ...
 [9.99996066e-01 3.95556617e-06 6.29126254e-13 4.39552301e-12
  1.14015264e-12]
 [9.99999523e-01 4.53949696e-07 1.13587125e-13 1.58057020e-12
  2.02801710e-13]
 [9.99999762e-01 2.78667187e-07 1.46530805e-13 2.54989367e-12
  2.83192144e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.001036439216695726
tp :  99991.0
fp :  9.0
tn :  399991.0
fn :  9.0
accuracy :  0.9999639987945557
precision :  0.9999099969863892
recall :  0.9999099969863892
auc :  0.9999936819076538

y_eval {0: 100000}
pred {0: 99991, 1: 9}
[INFO] confusion matrix for file 
[[99991     9     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[3688142     944       0       0       0]
 [ 298413       4       0       0       0]
 [ 109690       5       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4549350e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4549350e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4549350e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [ 1.0385574e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.0385574e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0385574e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.9999797e-01 2.0237476e-06 9.6274724e-13 2.9356337e-11 1.4353321e-12]
  [1.0000000e+00 9.0879944e-09 3.9475422e-14 1.0827728e-11 4.0619041e-14]
  [9.9999809e-01 1.8903615e-06 4.0608063e-13 7.7142659e-12 6.4569996e-13]
  ...
  [9.9999964e-01 3.0389413e-07 1.1745371e-13 2.2120923e-12 2.2878720e-13]
  [9.9999940e-01 6.2498492e-07 2.5127448e-13 3.8147523e-12 3.5243816e-13]
  [9.9999988e-01 5.9934671e-08 4.5966950e-14 1.2294646e-12 9.9829338e-14]]

 [[9.9999797e-01 2.0218474e-06 9.5879630e-13 2.9186611e-11 1.4303091e-12]
  [9.9999988e-01 7.5323470e-08 2.7305634e-13 2.3157223e-11 2.9266691e-13]
  [9.9988925e-01 1.1074933e-04 1.0452157e-12 1.7216046e-11 2.2675768e-12]
  ...
  [9.9999988e-01 8.3349398e-08 8.9775355e-14 2.5014810e-12 1.7040464e-13]
  [9.9999940e-01 6.1828712e-07 2.6892543e-13 4.3465908e-12 3.6883951e-13]
  [1.0000000e+00 3.8963286e-08 3.8605424e-14 1.2408860e-12 8.4248689e-14]]

 [[9.9986041e-01 1.3953664e-04 6.2297099e-12 2.9301356e-10 7.7480912e-12]
  [9.9999988e-01 9.8289611e-08 1.1460475e-13 8.7161849e-12 1.3884697e-13]
  [9.9999928e-01 7.1379662e-07 2.7551133e-13 5.7286420e-12 4.3907502e-13]
  ...
  [9.9999511e-01 4.8853522e-06 5.4399996e-13 7.1434681e-12 7.5386155e-13]
  [9.9999952e-01 5.2688074e-07 1.2075914e-13 2.0086927e-12 2.2893821e-13]
  [9.9999928e-01 6.8158511e-07 1.7119617e-13 2.2617960e-12 3.6086065e-13]]

 ...

 [[9.9978441e-01 2.1558466e-04 7.5469856e-12 3.8960640e-10 9.0398140e-12]
  [9.9999988e-01 1.3886302e-07 2.0776478e-13 1.2856796e-11 2.3722232e-13]
  [9.9999058e-01 9.3838016e-06 5.4016568e-13 4.3644467e-12 7.9564534e-13]
  ...
  [9.9998987e-01 1.0191541e-05 3.0272453e-13 2.6902100e-12 7.0350399e-13]
  [9.9988413e-01 1.1590653e-04 1.1417229e-11 1.8433259e-10 1.6311060e-11]
  [9.9999893e-01 1.0329718e-06 4.2415916e-13 4.6613056e-12 7.3164944e-13]]

 [[9.9840683e-01 1.5931771e-03 5.8865100e-11 6.0453824e-09 6.9710709e-11]
  [9.9999738e-01 2.6221762e-06 1.0509925e-12 2.5208741e-11 9.5261266e-13]
  [9.9998295e-01 1.6998401e-05 6.9149287e-13 4.5843294e-12 9.3677724e-13]
  ...
  [9.9999893e-01 1.0483506e-06 8.2472190e-14 6.2352174e-13 2.0422578e-13]
  [9.9996006e-01 3.9991242e-05 2.4903515e-12 2.4213456e-11 2.9135821e-12]
  [9.9994481e-01 5.5175919e-05 7.8325177e-13 3.8795542e-12 1.7977231e-12]]

 [[9.9765140e-01 2.3485627e-03 4.2412625e-11 2.5901283e-09 5.3462120e-11]
  [9.9999928e-01 7.0009469e-07 6.3509143e-13 1.6771229e-11 7.4218133e-13]
  [9.9999928e-01 6.7620618e-07 1.6288858e-13 4.1361693e-12 2.6615201e-13]
  ...
  [9.9999976e-01 2.9379839e-07 7.9131315e-14 9.2730695e-13 1.5464256e-13]
  [1.0000000e+00 4.3669445e-08 1.4154311e-13 6.2623422e-12 2.3634531e-13]
  [9.9996054e-01 3.9411003e-05 1.3761981e-12 1.0218676e-11 1.7657492e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999797e-01 2.0237476e-06 9.6274724e-13 2.9356337e-11 1.4353321e-12]
 [1.0000000e+00 9.0879944e-09 3.9475422e-14 1.0827728e-11 4.0619041e-14]
 [9.9999809e-01 1.8903615e-06 4.0608063e-13 7.7142659e-12 6.4569996e-13]
 ...
 [9.9999976e-01 2.9379839e-07 7.9131315e-14 9.2730695e-13 1.5464256e-13]
 [1.0000000e+00 4.3669445e-08 1.4154311e-13 6.2623422e-12 2.3634531e-13]
 [9.9996054e-01 3.9411003e-05 1.3761981e-12 1.0218676e-11 1.7657492e-12]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0013772053783759474
tp :  99975.0
fp :  25.0
tn :  399975.0
fn :  25.0
accuracy :  0.9998999834060669
precision :  0.999750018119812
recall :  0.999750018119812
auc :  1.0

y_eval {0: 100000}
pred {0: 99975, 1: 25}
[INFO] confusion matrix for file 
[[99975    25     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[3788117     969       0       0       0]
 [ 298413       4       0       0       0]
 [ 109690       5       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0385574  0.         0.        ...  4.         0.00482   -0.23351  ]
 [ 1.0385574  0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 1.0385574  0.         0.        ...  2.         0.00482   -0.33484  ]
 ...
 [ 1.7316213  0.         0.        ...  3.         0.00482    1.45442  ]
 [ 1.7316213  0.         0.        ...  2.         0.00482   -0.33484  ]
 [ 1.7316213  0.         0.        ...  1.         0.00482   -0.32151  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99999881e-01 1.19962706e-07 4.85422846e-13 1.42126762e-11
   8.37290469e-13]
  [9.99999166e-01 7.91689899e-07 6.71135375e-14 4.91557099e-12
   1.00800478e-13]
  [9.99451816e-01 5.48141077e-04 3.10183372e-11 4.89652374e-10
   5.73281908e-11]
  ...
  [9.99977946e-01 2.20962756e-05 9.31605270e-13 5.40084947e-12
   1.15758737e-12]
  [9.99998808e-01 1.23766779e-06 1.82594960e-13 1.63219807e-12
   3.90732829e-13]
  [9.99969006e-01 3.09660427e-05 1.89896493e-12 1.52854760e-11
   2.13304049e-12]]

 [[9.99970675e-01 2.93118446e-05 3.30750640e-12 2.07416945e-10
   3.82309202e-12]
  [9.99999881e-01 1.68378605e-07 4.78129526e-13 3.07316325e-11
   4.04661791e-13]
  [9.99685168e-01 3.14803299e-04 7.22289416e-13 9.95267128e-13
   1.55980144e-12]
  ...
  [9.99999523e-01 4.60697493e-07 1.63964653e-13 2.24297946e-12
   2.99958273e-13]
  [9.99941349e-01 5.86425776e-05 2.38173327e-12 1.73048468e-11
   2.77304828e-12]
  [9.99999523e-01 4.31687113e-07 4.81095774e-14 4.21330072e-13
   1.33953775e-13]]

 [[9.99969602e-01 3.03682227e-05 3.35979335e-12 2.10663778e-10
   3.88242650e-12]
  [9.99999881e-01 8.83730067e-08 3.07775317e-13 3.18183292e-11
   3.29434803e-13]
  [9.99999166e-01 8.32881994e-07 6.98702706e-14 1.95604730e-12
   1.20297937e-13]
  ...
  [9.99999881e-01 5.97061316e-08 5.54444016e-14 1.44660607e-12
   1.14346453e-13]
  [1.00000000e+00 3.37805517e-08 8.00189247e-14 3.77128970e-12
   1.46376102e-13]
  [9.99998927e-01 1.05132608e-06 8.02078998e-13 1.28688301e-11
   1.27756193e-12]]

 ...

 [[9.99761403e-01 2.38647961e-04 8.00080054e-12 4.35266129e-10
   9.38940072e-12]
  [9.99999881e-01 6.93190003e-08 1.51231255e-13 1.25766828e-11
   1.73712539e-13]
  [9.99993563e-01 6.44869851e-06 4.58401709e-13 8.86425308e-12
   8.33017791e-13]
  ...
  [9.99999404e-01 5.90466755e-07 3.96880709e-14 3.14460236e-13
   1.08986957e-13]
  [9.99999642e-01 3.21759558e-07 4.37084857e-13 9.13592639e-12
   6.89691847e-13]
  [9.99999523e-01 4.92803792e-07 1.03853578e-13 2.05327812e-12
   1.77819754e-13]]

 [[9.99852777e-01 1.47226659e-04 6.70037636e-12 3.45096368e-10
   7.79985364e-12]
  [9.99999762e-01 2.39993938e-07 5.66664391e-13 2.15215536e-11
   5.56579251e-13]
  [9.99925375e-01 7.46763399e-05 1.94387095e-13 7.71926468e-13
   3.65963715e-13]
  ...
  [9.99999881e-01 1.44482854e-07 1.19123502e-13 2.29441119e-12
   2.17849447e-13]
  [9.99708593e-01 2.91440898e-04 2.82144481e-11 5.58483926e-10
   3.90372526e-11]
  [9.99999881e-01 6.99805724e-08 3.10151210e-14 4.83975110e-13
   7.46057540e-14]]

 [[9.99999166e-01 7.84441966e-07 3.31587351e-13 7.06490682e-12
   5.23464193e-13]
  [1.00000000e+00 3.23135296e-08 9.38287669e-14 2.45344110e-11
   1.00294264e-13]
  [9.99997497e-01 2.45442175e-06 3.38796238e-13 3.53879166e-12
   4.48409376e-13]
  ...
  [9.99999642e-01 3.74390879e-07 1.00200345e-13 1.83514857e-12
   1.73007537e-13]
  [9.99998450e-01 1.54576867e-06 6.04972073e-13 6.69045852e-12
   1.08283250e-12]
  [9.99996662e-01 3.34813967e-06 2.83506861e-13 3.42380681e-12
   4.77669553e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.99999881e-01 1.19962706e-07 4.85422846e-13 1.42126762e-11
  8.37290469e-13]
 [9.99999166e-01 7.91689899e-07 6.71135375e-14 4.91557099e-12
  1.00800478e-13]
 [9.99451816e-01 5.48141077e-04 3.10183372e-11 4.89652374e-10
  5.73281908e-11]
 ...
 [9.99999642e-01 3.74390879e-07 1.00200345e-13 1.83514857e-12
  1.73007537e-13]
 [9.99998450e-01 1.54576867e-06 6.04972073e-13 6.69045852e-12
  1.08283250e-12]
 [9.99996662e-01 3.34813967e-06 2.83506861e-13 3.42380681e-12
  4.77669553e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.002224270313605666
tp :  99953.0
fp :  47.0
tn :  399953.0
fn :  47.0
accuracy :  0.9998120069503784
precision :  0.999530017375946
recall :  0.999530017375946
auc :  0.9999933838844299

y_eval {0: 100000}
pred {0: 99953, 1: 47}
[INFO] confusion matrix for file 
[[99953    47     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[3888070    1016       0       0       0]
 [ 298413       4       0       0       0]
 [ 109690       5       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-02_014558_119.log.part06_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0:99.997%,2:0.003%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9964%,3:0.0036%]
[INFO] ** i/f_dir:[1:99.9964%,0:0.0036%]
[INFO] ** src:[22:38.0288%,9:26.1242%,7:18.2114%,1:17.6294%,21:0.003%,2:0.0008%,14:0.0006%,3:0.0006%,15:0.0004%,4:0.0004%,11:0.0002%,8:0.0002%]
[INFO] ** dst:[21:43.357%,10:20.7952%,8:18.2116%,9:17.629%,15:0.0036%,22:0.0012%,16:0.0008%,19:0.0004%,17:0.0004%,6:0.0004%,26:0.0002%,24:0.0002%]
[INFO] ** proto:[0:99.9958%,1:0.0036%,2:0.0006%]
[INFO] ** appi_name:[21:99.9942%,30:0.0036%,17:0.0008%,22:0.0004%,28:0.0002%,26:0.0002%,23:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** proxy_src_ip:[18:38.0288%,20:26.1242%,13:18.2114%,6:17.6294%,17:0.0036%,14:0.0008%,1:0.0006%,21:0.0004%,16:0.0004%,10:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9942%,-33.760870000000004:0.0058%]
[INFO] ** modbus_function_description:[7:49.9974%,11:49.9968%,0:0.0058%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.123%,1:20.7952%,5:18.211%,4:17.6288%,2:17.2336%,0:0.0084%]
[INFO] ** service:[0.0048200000000000005:99.9942%,-211.73542999999998:0.0036%,-205.44247:0.0008%,-211.07873999999998:0.0004%,-211.08818:0.0004%,-211.09762999999998:0.0002%,-211.08346:0.0002%,-185.9872:0.0002%]
[INFO] ** s_port:[1.45442:26.1234%,-0.32151:20.7952%,-1.27613:18.2112%,-0.23351:17.629%,-0.33484:17.2336%,-71.33197:0.0036%,1.45709:0.0006%,9.89942:0.0004%,-1.02014:0.0004%,-71.14931:0.0004%,-58.035180000000004:0.0002%,-5.1466400000000005:0.0002%,-0.24151:0.0002%,-5.08665:0.0002%,1.46509:0.0002%,-71.14798:0.0002%,-0.24950999999999998:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-1.27347:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** classification:[normal:81.41%,Single Stage Single Point:18.59%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7326837e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.7326837e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.7326837e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [-1.0391493e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0391493e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0391493e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 1 0 1] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99991655e-01 8.39514178e-06 1.94796111e-12 4.83637574e-11
   2.92425806e-12]
  [9.99995947e-01 4.01804027e-06 2.78255132e-12 5.05715331e-11
   2.72505477e-12]
  [9.99155879e-01 8.44134658e-04 9.74717616e-12 5.52011908e-11
   1.04087398e-11]
  ...
  [9.99999881e-01 8.00171804e-08 7.25659767e-14 1.86125616e-12
   1.51051372e-13]
  [9.99993563e-01 6.39823338e-06 4.29051949e-13 7.27848858e-12
   6.73458034e-13]
  [9.99987721e-01 1.23294940e-05 4.07741955e-13 1.93254375e-12
   7.92993275e-13]]

 [[9.99968648e-01 3.13835626e-05 2.73959826e-12 1.05831961e-10
   3.59599980e-12]
  [9.99998331e-01 1.66100608e-06 9.20140266e-13 1.85986296e-11
   1.10985440e-12]
  [9.99968886e-01 3.11658077e-05 1.79144763e-12 1.08194426e-11
   3.23683441e-12]
  ...
  [9.99999881e-01 1.08627688e-07 1.64626545e-13 4.43154411e-12
   2.66838363e-13]
  [9.99999642e-01 3.21444247e-07 1.87811884e-13 4.05755551e-12
   3.30451053e-13]
  [9.99943256e-01 5.67753814e-05 8.83120020e-13 9.76908311e-12
   1.38042269e-12]]

 [[9.99996662e-01 3.33132584e-06 1.04474795e-12 2.87714817e-11
   1.53265877e-12]
  [9.99999881e-01 8.80694486e-08 2.02034624e-13 1.39089374e-11
   2.06937020e-13]
  [9.99986529e-01 1.34353159e-05 2.06193656e-12 4.55661758e-11
   2.32757086e-12]
  ...
  [9.99999881e-01 8.05923221e-08 9.35572962e-14 2.23196136e-12
   1.71763401e-13]
  [9.99979854e-01 2.01105049e-05 1.57398096e-12 1.77772692e-11
   2.09564419e-12]
  [9.99708951e-01 2.91004137e-04 3.37762587e-12 1.86245897e-11
   3.69958361e-12]]

 ...

 [[9.99942541e-01 5.74033002e-05 3.65354361e-12 1.55361224e-10
   4.61924292e-12]
  [9.99999762e-01 2.00838031e-07 1.95768992e-13 1.09836255e-11
   2.36216347e-13]
  [9.99997258e-01 2.69261500e-06 5.35233208e-13 8.75276240e-12
   8.09147454e-13]
  ...
  [9.99987245e-01 1.27427966e-05 1.57232419e-12 2.39410505e-11
   1.86071796e-12]
  [9.99843359e-01 1.56670285e-04 9.03880920e-13 2.72959606e-12
   1.44781778e-12]
  [9.97780502e-01 2.21951003e-03 5.44578055e-12 1.80023219e-11
   1.13541164e-11]]

 [[9.99935508e-01 6.44947067e-05 1.11918296e-11 9.65352909e-10
   1.13288753e-11]
  [1.00000000e+00 1.99525676e-08 2.86748910e-14 5.75910240e-12
   3.14231842e-14]
  [9.99991536e-01 8.45084742e-06 6.49084031e-13 9.67059158e-12
   1.07126547e-12]
  ...
  [1.00000000e+00 5.94022822e-08 1.16193920e-13 4.50549710e-12
   1.99285941e-13]
  [9.99989510e-01 1.04396140e-05 9.35519132e-13 4.70892682e-12
   1.77012354e-12]
  [9.99991894e-01 8.10834626e-06 9.15401002e-13 7.77881492e-12
   1.47558485e-12]]

 [[9.99999166e-01 8.33072647e-07 4.56764346e-13 1.21297772e-11
   7.20310584e-13]
  [1.00000000e+00 1.73941785e-08 6.33588844e-14 1.80003287e-11
   6.50137428e-14]
  [9.99961853e-01 3.81179343e-05 1.78782358e-12 1.55644733e-11
   2.32031516e-12]
  ...
  [1.00000000e+00 4.00734876e-08 8.49502828e-14 4.20178822e-12
   1.45901683e-13]
  [9.99989629e-01 1.04236178e-05 1.19236912e-12 7.69116455e-12
   2.15678430e-12]
  [9.99984980e-01 1.49843390e-05 7.85656262e-13 3.34718668e-12
   1.50378256e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999166e-01 8.3951418e-06 1.9479611e-12 4.8363757e-11 2.9242581e-12]
 [9.9999595e-01 4.0180403e-06 2.7825513e-12 5.0571533e-11 2.7250548e-12]
 [9.9915588e-01 8.4413466e-04 9.7471762e-12 5.5201191e-11 1.0408740e-11]
 ...
 [1.0000000e+00 4.0073488e-08 8.4950283e-14 4.2017882e-12 1.4590168e-13]
 [9.9998963e-01 1.0423618e-05 1.1923691e-12 7.6911645e-12 2.1567843e-12]
 [9.9998498e-01 1.4984339e-05 7.8565626e-13 3.3471867e-12 1.5037826e-12]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  4.104269208955765
tp :  67383.0
fp :  32617.0
tn :  367383.0
fn :  32617.0
accuracy :  0.8695333003997803
precision :  0.673829972743988
recall :  0.673829972743988
auc :  0.7966194748878479

y_eval {0: 67398, 1: 32602}
pred {0: 99985, 1: 15}
[INFO] confusion matrix for file 
[[67383    15     0     0     0]
 [32602     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[3955453    1031       0       0       0]
 [ 331015       4       0       0       0]
 [ 109690       5       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0391493e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0391493e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0391493e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-3.4561479e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4561479e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-3.4561479e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [1 0 1 ... 1 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99970078e-01 2.99396506e-05 3.17987975e-12 1.03471856e-10
   4.39841132e-12]
  [9.99994636e-01 5.37246069e-06 3.87382444e-12 8.04471073e-11
   3.60843321e-12]
  [9.99989867e-01 1.01698615e-05 4.00795553e-13 2.59224716e-12
   6.85722529e-13]
  ...
  [1.00000000e+00 4.70234411e-08 5.01315196e-14 1.19625165e-12
   1.11427177e-13]
  [1.00000000e+00 5.66048080e-08 1.24485369e-13 4.70991952e-12
   2.08975795e-13]
  [9.99987721e-01 1.23050140e-05 1.65472085e-12 1.30970183e-11
   2.92312008e-12]]

 [[9.99936223e-01 6.37315752e-05 1.11775658e-11 9.66361324e-10
   1.13067359e-11]
  [9.99999523e-01 4.23953253e-07 4.91036953e-13 2.91488257e-11
   4.16578718e-13]
  [9.99369085e-01 6.30978204e-04 7.04342704e-12 4.82352873e-11
   9.99784890e-12]
  ...
  [9.99997735e-01 2.25599365e-06 3.04264399e-13 2.94632873e-12
   4.36135503e-13]
  [9.99992847e-01 7.17010607e-06 2.86391164e-13 2.43863306e-12
   5.64639752e-13]
  [9.99998450e-01 1.50481878e-06 3.98958590e-13 4.15517490e-12
   7.31372807e-13]]

 [[9.99943733e-01 5.62428613e-05 3.62391996e-12 1.53750970e-10
   4.58630963e-12]
  [9.99999762e-01 1.98898036e-07 1.94766756e-13 1.10029165e-11
   2.34861853e-13]
  [9.99947667e-01 5.23592644e-05 2.91404639e-12 2.98027471e-11
   3.46002719e-12]
  ...
  [9.99982238e-01 1.77967540e-05 6.57462312e-13 3.55253370e-12
   9.41277438e-13]
  [9.99999642e-01 3.05585274e-07 6.70772167e-14 8.77973258e-13
   1.61494082e-13]
  [9.99999523e-01 4.99455211e-07 2.70675111e-13 4.10795269e-12
   4.31795712e-13]]

 ...

 [[9.99989271e-01 1.06960297e-05 1.79181225e-12 8.34368269e-11
   2.24999663e-12]
  [9.99999881e-01 9.04923496e-08 9.98380930e-14 2.98307490e-11
   1.12731601e-13]
  [9.99986172e-01 1.38691057e-05 8.79795369e-13 5.36488779e-12
   1.60274983e-12]
  ...
  [9.99987960e-01 1.20564791e-05 1.29903347e-12 1.82945950e-11
   1.48338991e-12]
  [9.99999642e-01 3.84752155e-07 5.54547524e-14 7.02585559e-13
   1.20566521e-13]
  [1.00000000e+00 1.91545197e-08 4.44550843e-14 1.42630460e-12
   9.28088850e-14]]

 [[9.99913454e-01 8.65078910e-05 4.51165971e-12 2.03212794e-10
   5.55373542e-12]
  [9.99996305e-01 3.69546683e-06 3.57534922e-12 8.93319169e-11
   3.02965205e-12]
  [9.86858487e-01 1.31415585e-02 1.22002400e-11 4.63931081e-11
   2.50231971e-11]
  ...
  [9.99998093e-01 1.95669872e-06 2.10373507e-13 1.47670613e-12
   4.30313581e-13]
  [9.99999881e-01 6.41568150e-08 9.88329766e-14 2.57716786e-12
   1.87035473e-13]
  [9.99999285e-01 6.55908025e-07 2.60932470e-13 4.70904479e-12
   3.89220096e-13]]

 [[9.99999642e-01 3.25251335e-07 6.16195680e-13 5.31065469e-12
   9.26825890e-13]
  [9.99999881e-01 1.72923492e-07 1.06880847e-13 6.87962100e-12
   1.51431290e-13]
  [9.99976158e-01 2.38682478e-05 5.92397398e-12 4.61544657e-11
   7.13029245e-12]
  ...
  [9.99999762e-01 2.97364778e-07 4.84407219e-13 1.02594452e-11
   7.13871724e-13]
  [9.99917865e-01 8.21750145e-05 2.17985048e-12 1.61164103e-11
   2.42290975e-12]
  [9.99579489e-01 4.20461933e-04 1.51589006e-12 2.66705473e-12
   2.24295279e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.99970078e-01 2.99396506e-05 3.17987975e-12 1.03471856e-10
  4.39841132e-12]
 [9.99994636e-01 5.37246069e-06 3.87382444e-12 8.04471073e-11
  3.60843321e-12]
 [9.99989867e-01 1.01698615e-05 4.00795553e-13 2.59224716e-12
  6.85722529e-13]
 ...
 [9.99999762e-01 2.97364778e-07 4.84407219e-13 1.02594452e-11
  7.13871724e-13]
 [9.99917865e-01 8.21750145e-05 2.17985048e-12 1.61164103e-11
  2.42290975e-12]
 [9.99579489e-01 4.20461933e-04 1.51589006e-12 2.66705473e-12
  2.24295279e-12]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  5.946663660430908
tp :  53037.0
fp :  46963.0
tn :  353037.0
fn :  46963.0
accuracy :  0.8121498227119446
precision :  0.5303699970245361
recall :  0.5303699970245361
auc :  0.7068828344345093

y_eval {0: 53052, 1: 46948}
pred {0: 99985, 1: 15}
[INFO] confusion matrix for file 
[[53037    15     0     0     0]
 [46948     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[4008490    1046       0       0       0]
 [ 377963       4       0       0       0]
 [ 109690       5       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4561479e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4561479e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-3.4561479e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [ 3.4537926e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 3.4537926e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 3.4537926e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 1 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.97632504e-01 2.36745691e-03 9.73202352e-11 1.17095551e-08
   1.21445937e-10]
  [9.99999762e-01 2.52830318e-07 1.49062213e-13 7.68952610e-12
   1.71747341e-13]
  [9.99972224e-01 2.77890194e-05 1.65535175e-12 1.62930017e-11
   2.13823273e-12]
  ...
  [9.99995947e-01 4.03647573e-06 7.09431754e-13 5.29470608e-12
   1.34755987e-12]
  [9.99999285e-01 7.22474454e-07 1.68531733e-13 2.12316427e-12
   2.45069644e-13]
  [9.99998927e-01 1.12697705e-06 1.04521216e-13 1.92894138e-12
   1.96166515e-13]]

 [[9.99914408e-01 8.56173792e-05 4.49454623e-12 2.02328099e-10
   5.53473760e-12]
  [1.00000000e+00 5.38945457e-08 8.01204806e-14 9.23815798e-12
   9.74058277e-14]
  [9.99996185e-01 3.78657774e-06 7.09740535e-13 1.19651468e-11
   1.22270152e-12]
  ...
  [9.99998927e-01 1.11720703e-06 7.41406719e-14 1.43040321e-12
   1.43958250e-13]
  [9.99986768e-01 1.31829975e-05 6.61764263e-13 3.05166721e-12
   1.30984481e-12]
  [9.99997377e-01 2.63572247e-06 2.99479706e-13 2.99551269e-12
   4.20265683e-13]]

 [[9.99914646e-01 8.53957608e-05 4.49028011e-12 2.02107525e-10
   5.53001178e-12]
  [9.99999762e-01 2.45459006e-07 6.15331299e-13 2.76402842e-11
   5.75846066e-13]
  [9.96844888e-01 3.15512042e-03 8.67697580e-12 4.11975974e-11
   1.37256777e-11]
  ...
  [9.99994636e-01 5.32568720e-06 5.29540333e-13 5.20976925e-12
   7.07922328e-13]
  [9.99907374e-01 9.26357170e-05 1.30284921e-12 4.58523323e-12
   1.72829730e-12]
  [9.99999046e-01 9.22616380e-07 1.16110951e-13 1.04351965e-12
   2.62478841e-13]]

 ...

 [[9.99830961e-01 1.68968880e-04 6.70037073e-12 3.22917693e-10
   8.21335014e-12]
  [9.99999285e-01 7.17905721e-07 1.22248143e-12 4.22407803e-11
   1.03878169e-12]
  [9.99901414e-01 9.85828228e-05 8.17747074e-13 1.75998615e-12
   1.49995034e-12]
  ...
  [9.99986768e-01 1.32720443e-05 2.50987734e-13 1.03819828e-12
   5.45239852e-13]
  [9.99999762e-01 2.64909090e-07 8.97212534e-14 1.58989239e-12
   2.10120021e-13]
  [9.99999881e-01 1.26013333e-07 1.27884506e-13 2.61506745e-12
   2.29320252e-13]]

 [[9.99999285e-01 7.05798300e-07 3.06719114e-13 6.33934788e-12
   4.84817427e-13]
  [1.00000000e+00 4.39175309e-08 1.31669469e-13 2.18780341e-11
   1.35971204e-13]
  [9.99916792e-01 8.31901416e-05 5.53939750e-12 6.49797993e-11
   9.18102313e-12]
  ...
  [9.99496102e-01 5.03892894e-04 3.93897762e-12 2.28215155e-11
   7.17999922e-12]
  [9.99998569e-01 1.46644834e-06 1.80889442e-13 1.92559575e-12
   2.84358745e-13]
  [9.99998808e-01 1.23747884e-06 4.61206160e-13 4.74793165e-12
   8.13056545e-13]]

 [[9.99832273e-01 1.67740538e-04 6.68127532e-12 3.21685567e-10
   8.19445813e-12]
  [9.99995589e-01 4.46226795e-06 3.78316779e-12 1.04236141e-10
   3.10831244e-12]
  [9.99989152e-01 1.08370850e-05 4.00566028e-13 2.50419932e-12
   7.53121198e-13]
  ...
  [1.00000000e+00 2.35177637e-08 6.62280289e-14 2.60926827e-12
   1.19537762e-13]
  [9.99999046e-01 9.88437137e-07 3.68459684e-13 2.62961146e-11
   5.58707106e-13]
  [9.99996305e-01 3.71934675e-06 5.58185822e-13 4.08268601e-12
   1.04585611e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9763250e-01 2.3674569e-03 9.7320235e-11 1.1709555e-08 1.2144594e-10]
 [9.9999976e-01 2.5283032e-07 1.4906221e-13 7.6895261e-12 1.7174734e-13]
 [9.9997222e-01 2.7789019e-05 1.6553517e-12 1.6293002e-11 2.1382327e-12]
 ...
 [1.0000000e+00 2.3517764e-08 6.6228029e-14 2.6092683e-12 1.1953776e-13]
 [9.9999905e-01 9.8843714e-07 3.6845968e-13 2.6296115e-11 5.5870711e-13]
 [9.9999630e-01 3.7193468e-06 5.5818582e-13 4.0826860e-12 1.0458561e-12]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  1.702870324654877
tp :  86582.0
fp :  13418.0
tn :  386582.0
fn :  13418.0
accuracy :  0.9463284611701965
precision :  0.8658199906349182
recall :  0.8658199906349182
auc :  0.9161326289176941

y_eval {0: 86600, 1: 13400}
pred {0: 99982, 1: 18}
[INFO] confusion matrix for file 
[[86582    18     0     0     0]
 [13400     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[4095072    1064       0       0       0]
 [ 391363       4       0       0       0]
 [ 109690       5       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4537926e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4537926e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4537926e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 ...
 [ 1.0389137e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.0389137e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0389137e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99997973e-01 2.07653602e-06 1.07283464e-12 3.43059851e-11
   1.57436076e-12]
  [1.00000000e+00 7.47322737e-09 3.00589970e-14 8.58624370e-12
   3.13729416e-14]
  [9.99898076e-01 1.01919919e-04 3.53954691e-12 8.68693936e-11
   6.59038145e-12]
  ...
  [9.99993682e-01 6.26724477e-06 1.90549792e-13 8.77236543e-13
   4.15163563e-13]
  [9.99999523e-01 5.22373341e-07 3.32481059e-13 6.18137009e-12
   6.36880793e-13]
  [9.99999046e-01 9.61777573e-07 5.54049482e-13 7.52607785e-12
   9.19046414e-13]]

 [[9.99999285e-01 6.93705090e-07 3.04934138e-13 6.28742371e-12
   4.81330904e-13]
  [9.99999762e-01 2.10587871e-07 8.33064249e-13 6.79817730e-11
   7.99826297e-13]
  [9.99971628e-01 2.83922200e-05 1.34266716e-13 1.11419814e-12
   2.75393396e-13]
  ...
  [9.99980569e-01 1.93712385e-05 7.62719315e-13 5.19003850e-12
   9.46605099e-13]
  [9.99988317e-01 1.16966503e-05 2.09696030e-13 8.48766153e-13
   4.92168806e-13]
  [9.99999642e-01 3.92563777e-07 1.52139098e-13 2.82214096e-12
   3.19595180e-13]]

 [[9.99997258e-01 2.76313517e-06 1.39614156e-12 4.77406135e-11
   2.03324206e-12]
  [9.99999881e-01 1.59734512e-07 3.04092011e-14 2.83015191e-12
   3.93572334e-14]
  [9.99998689e-01 1.33127867e-06 2.52331874e-13 2.92022656e-12
   3.83254246e-13]
  ...
  [9.99983668e-01 1.63171226e-05 8.30552044e-13 7.53886363e-12
   1.07472397e-12]
  [9.95544255e-01 4.45573870e-03 8.04999383e-12 1.48103561e-11
   1.03729542e-11]
  [9.99996901e-01 3.05739650e-06 1.13445657e-13 5.69547176e-13
   3.02016116e-13]]

 ...

 [[9.97597516e-01 2.40252074e-03 2.71035017e-11 1.44878132e-09
   3.21617802e-11]
  [9.99999166e-01 8.83602581e-07 8.06135866e-13 2.72055694e-11
   8.45654981e-13]
  [9.99987125e-01 1.28603133e-05 1.34843233e-12 9.20490160e-12
   2.43907954e-12]
  ...
  [9.99999881e-01 1.76399709e-07 1.24409407e-13 2.70913478e-12
   2.18124265e-13]
  [9.99964118e-01 3.58718316e-05 1.94386174e-12 1.98242152e-11
   2.20146189e-12]
  [9.99999881e-01 1.78101587e-07 3.72837239e-14 4.53421046e-13
   1.03065465e-13]]

 [[9.99767482e-01 2.32535793e-04 7.76155442e-12 4.01859712e-10
   9.24681512e-12]
  [9.99995947e-01 4.05968512e-06 3.55969074e-12 1.04481604e-10
   2.74528599e-12]
  [9.94846582e-01 5.15341945e-03 5.43410846e-12 2.01735729e-11
   1.13621560e-11]
  ...
  [9.99999881e-01 7.20789828e-08 9.98822810e-14 2.36080491e-12
   1.90121871e-13]
  [9.99999881e-01 8.13714180e-08 1.04278978e-13 3.11005713e-12
   1.72022742e-13]
  [9.99999881e-01 1.14799050e-07 1.12418111e-13 3.23008872e-12
   2.11147723e-13]]

 [[9.99999046e-01 9.95314053e-07 3.89855981e-13 8.39987108e-12
   6.04627459e-13]
  [1.00000000e+00 2.79096106e-08 8.98394315e-14 2.75067590e-11
   9.88897481e-14]
  [9.99993801e-01 6.15581666e-06 8.61331677e-13 8.16998292e-12
   1.46773088e-12]
  ...
  [9.99997854e-01 2.19026560e-06 6.78203262e-13 1.57434933e-11
   1.18700102e-12]
  [9.99999404e-01 5.86506758e-07 1.72717350e-13 2.14056377e-12
   3.13380100e-13]
  [9.99997139e-01 2.90122443e-06 6.82780601e-13 5.48206272e-12
   1.27118888e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999797e-01 2.0765360e-06 1.0728346e-12 3.4305985e-11 1.5743608e-12]
 [1.0000000e+00 7.4732274e-09 3.0058997e-14 8.5862437e-12 3.1372942e-14]
 [9.9989808e-01 1.0191992e-04 3.5395469e-12 8.6869394e-11 6.5903815e-12]
 ...
 [9.9999785e-01 2.1902656e-06 6.7820326e-13 1.5743493e-11 1.1870010e-12]
 [9.9999940e-01 5.8650676e-07 1.7271735e-13 2.1405638e-12 3.1338010e-13]
 [9.9999714e-01 2.9012244e-06 6.8278060e-13 5.4820627e-12 1.2711889e-12]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0022589718572795393
tp :  99958.0
fp :  42.0
tn :  399958.0
fn :  42.0
accuracy :  0.999832034111023
precision :  0.9995800256729126
recall :  0.9995800256729126
auc :  0.9999683499336243

y_eval {0: 100000}
pred {0: 99958, 1: 42}
[INFO] confusion matrix for file 
[[99958    42     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[4195030    1106       0       0       0]
 [ 391363       4       0       0       0]
 [ 109690       5       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0389137e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0389137e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.0389137e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [ 1.7324482e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.7324482e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.7324482e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99999881e-01 1.13384800e-07 5.05670484e-13 1.44630618e-11
   8.57555075e-13]
  [9.99997377e-01 2.57773695e-06 1.10326136e-13 6.12316578e-12
   1.75906666e-13]
  [9.99987125e-01 1.28865249e-05 6.22717242e-12 6.60887248e-11
   8.67825169e-12]
  ...
  [9.99993443e-01 6.49712456e-06 7.77176446e-13 9.27322802e-12
   9.82669892e-13]
  [9.99994278e-01 5.72119461e-06 4.23076125e-13 1.99357501e-12
   8.96643491e-13]
  [9.99999642e-01 3.57810592e-07 1.21774078e-13 1.69079876e-12
   1.89859833e-13]]

 [[9.99768794e-01 2.31154423e-04 7.74408575e-12 4.00842859e-10
   9.22996402e-12]
  [9.99999881e-01 1.43098944e-07 2.02629336e-13 1.25103400e-11
   2.31722681e-13]
  [9.99990821e-01 9.19621652e-06 6.79401305e-13 7.57898432e-12
   9.46304341e-13]
  ...
  [9.99648929e-01 3.51038441e-04 2.72216126e-12 8.31642307e-12
   3.34613218e-12]
  [9.99982119e-01 1.78547380e-05 5.13038071e-13 1.86145001e-12
   1.21684943e-12]
  [1.00000000e+00 5.68473837e-08 7.57543307e-14 1.89828123e-12
   1.44418779e-13]]

 [[9.99953985e-01 4.60209340e-05 1.12199295e-11 1.13998466e-09
   1.06935598e-11]
  [9.99999881e-01 1.10554041e-07 3.46126881e-13 2.51287793e-11
   3.11437128e-13]
  [9.99876142e-01 1.23866485e-04 3.13159844e-13 1.22288822e-12
   5.90770651e-13]
  ...
  [9.99999166e-01 8.52912933e-07 1.43239031e-13 1.20473195e-12
   3.19908488e-13]
  [9.99986172e-01 1.37815841e-05 1.20202405e-12 1.29294110e-11
   1.45343687e-12]
  [9.99986529e-01 1.34728707e-05 4.01725636e-13 1.23888280e-12
   9.52747646e-13]]

 ...

 [[9.99999762e-01 1.87507695e-07 3.70908816e-13 9.66325804e-12
   6.65194733e-13]
  [9.99999881e-01 1.46971445e-07 5.96076682e-13 3.45414322e-11
   6.12106448e-13]
  [9.99910712e-01 8.92249373e-05 7.50861992e-13 1.19937359e-11
   1.64839106e-12]
  ...
  [9.99999523e-01 4.72976126e-07 1.73038884e-13 2.85402973e-12
   2.77691309e-13]
  [1.00000000e+00 2.14143121e-08 8.10876499e-14 3.22299956e-12
   1.41092704e-13]
  [9.99999762e-01 2.50249656e-07 4.04075563e-13 8.79012748e-12
   6.14472774e-13]]

 [[9.99997497e-01 2.48230003e-06 1.56442502e-12 5.88722474e-11
   2.24185449e-12]
  [1.00000000e+00 7.09614723e-09 2.18897725e-14 5.73522740e-12
   2.35329927e-14]
  [9.99992728e-01 7.27504175e-06 6.12670938e-13 4.41654309e-12
   9.03469519e-13]
  ...
  [9.99656558e-01 3.43386724e-04 9.78071096e-12 1.59075850e-10
   1.51322860e-11]
  [9.99999881e-01 1.57529300e-07 8.45269831e-14 1.26402382e-12
   1.56836864e-13]
  [1.00000000e+00 3.62435912e-08 6.68395732e-14 2.02570729e-12
   1.29403825e-13]]

 [[9.99054849e-01 9.45119129e-04 4.39312232e-11 4.46109993e-09
   5.03204388e-11]
  [1.00000000e+00 6.60014621e-09 8.14814457e-14 6.92580758e-12
   1.10739861e-13]
  [9.99994636e-01 5.31149499e-06 2.08484570e-13 1.89703678e-12
   3.27158792e-13]
  ...
  [9.99999881e-01 1.46595298e-07 1.01567111e-13 2.15830023e-12
   1.76927334e-13]
  [9.99881506e-01 1.18539159e-04 1.61110916e-11 3.03825909e-10
   2.31231492e-11]
  [9.99999762e-01 2.22172844e-07 7.99735915e-14 1.13973934e-12
   1.61642008e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.99999881e-01 1.13384800e-07 5.05670484e-13 1.44630618e-11
  8.57555075e-13]
 [9.99997377e-01 2.57773695e-06 1.10326136e-13 6.12316578e-12
  1.75906666e-13]
 [9.99987125e-01 1.28865249e-05 6.22717242e-12 6.60887248e-11
  8.67825169e-12]
 ...
 [9.99999881e-01 1.46595298e-07 1.01567111e-13 2.15830023e-12
  1.76927334e-13]
 [9.99881506e-01 1.18539159e-04 1.61110916e-11 3.03825909e-10
  2.31231492e-11]
 [9.99999762e-01 2.22172844e-07 7.99735915e-14 1.13973934e-12
  1.61642008e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.002948991381376982
tp :  99941.0
fp :  59.0
tn :  399941.0
fn :  59.0
accuracy :  0.999764084815979
precision :  0.9994099736213684
recall :  0.9994099736213684
auc :  0.9999741315841675

y_eval {0: 100000}
pred {0: 99941, 1: 59}
[INFO] confusion matrix for file 
[[99941    59     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[4294971    1165       0       0       0]
 [ 391363       4       0       0       0]
 [ 109690       5       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-02_121729_121.log.part12_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1368 (0.2736%)
[INFO] ** orig:[0:99.9986%,1:0.0008%,2:0.0006%]
[INFO] ** type:[0:99.9984%,1:0.0014%,2:0.0002%]
[INFO] ** i/f_name:[2:99.9978%,3:0.0022%]
[INFO] ** i/f_dir:[1:99.998%,0:0.002%]
[INFO] ** src:[22:38.1136%,9:26.1176%,7:18.2158%,1:17.5472%,14:0.0016%,11:0.0014%,10:0.001%,21:0.0006%,15:0.0004%,2:0.0004%,4:0.0002%,3:0.0002%]
[INFO] ** dst:[21:43.4022%,10:20.8284%,8:18.2156%,9:17.547%,15:0.0022%,22:0.002%,6:0.0008%,26:0.0004%,25:0.0004%,19:0.0004%,24:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** proto:[0:99.996%,1:0.0022%,2:0.0018%]
[INFO] ** appi_name:[21:99.9946%,30:0.0022%,22:0.0006%,26:0.0004%,0:0.0004%,31:0.0002%,27:0.0002%,24:0.0002%,23:0.0002%,18:0.0002%,16:0.0002%,15:0.0002%,14:0.0002%,5:0.0002%]
[INFO] ** proxy_src_ip:[18:38.1136%,20:26.1176%,13:18.2158%,6:17.5472%,17:0.0022%,10:0.0014%,11:0.001%,16:0.0004%,14:0.0004%,21:0.0002%,1:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9946%,-33.760870000000004:0.0052%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.9984%,11:49.9962%,0:0.0052%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1164%,1:20.8284%,5:18.2154%,4:17.5466%,2:17.285%,0:0.0082%]
[INFO] ** service:[0.0048200000000000005:99.9954%,-211.73542999999998:0.0022%,-211.08818:0.0006%,-186.44547:0.0004%,-211.08346:0.0004%,-211.07873999999998:0.0004%,-186.42657:0.0002%,-186.43601999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:26.1168%,-0.32151:20.8284%,-1.27613:18.2154%,-0.23351:17.5468%,-0.33484:17.2852%,-71.33197:0.0022%,-10.59042:0.0008%,-71.14931:0.0006%,-64.19493:0.0004%,-1.02014:0.0004%,-0.24151:0.0004%,-71.14798:0.0004%,1.45709:0.0004%,10.54739:0.0004%,1.47576:0.0002%,1.46509:0.0002%,-1.27347:0.0002%,-68.79874000000001:0.0002%,13.34061:0.0002%,-1.2708:0.0002%,15.264529999999999:0.0002%]
[INFO] ** classification:[normal:99.9996%,Single Stage Multi Point:0.0004%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7332737e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.7332737e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.7332737e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-1.0409675e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0409675e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0409675e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.9999332e-01 6.6480407e-06 3.7455221e-12 1.8739627e-10 5.2834135e-12]
  [9.9999976e-01 2.2764615e-07 4.6358962e-13 2.9044831e-11 4.4957335e-13]
  [9.9990201e-01 9.8019555e-05 6.2701754e-13 4.1607698e-12 1.2361771e-12]
  ...
  [9.9999857e-01 1.4206203e-06 1.5528496e-13 1.6973531e-12 2.4806847e-13]
  [9.9999857e-01 1.4477293e-06 1.8829160e-13 2.0692619e-12 3.8690752e-13]
  [9.9999928e-01 7.1295233e-07 3.6887886e-13 5.0658566e-12 6.4849997e-13]]

 [[9.9997580e-01 2.4241819e-05 2.4634808e-12 9.1228636e-11 3.2806887e-12]
  [9.9999928e-01 7.2810968e-07 1.5167929e-12 6.3968261e-11 1.4791237e-12]
  [9.9966252e-01 3.3750708e-04 1.8741770e-12 5.9283433e-12 2.5406608e-12]
  ...
  [9.9984121e-01 1.5879785e-04 9.2801678e-12 1.0970898e-10 1.5184874e-11]
  [9.9999976e-01 1.9706357e-07 6.5014224e-14 7.8385676e-13 1.6694750e-13]
  [9.9999940e-01 5.6743761e-07 5.5083911e-13 9.1226219e-12 8.4900224e-13]]

 [[9.9999404e-01 6.0147381e-06 1.7951662e-12 4.2353180e-11 2.7598336e-12]
  [9.9999702e-01 2.9632658e-06 1.0587443e-12 1.4039339e-11 1.2182796e-12]
  [9.9999821e-01 1.7937742e-06 3.6018085e-13 4.8042438e-12 6.3687147e-13]
  ...
  [9.9999881e-01 1.1607568e-06 3.8669144e-13 4.2286847e-12 7.1645728e-13]
  [9.9999452e-01 5.4532247e-06 3.6036370e-13 3.3120230e-12 4.9999680e-13]
  [9.9999332e-01 6.6559514e-06 2.7379303e-13 2.0745823e-12 5.8279916e-13]]

 ...

 [[9.9999702e-01 3.0290162e-06 1.2789932e-12 4.0348801e-11 1.8410900e-12]
  [9.9999988e-01 6.0367078e-08 2.2111047e-13 2.1709474e-11 2.3458609e-13]
  [9.9998534e-01 1.4709985e-05 2.7177937e-13 3.7116057e-12 5.4542628e-13]
  ...
  [9.9999905e-01 9.8062628e-07 6.8373063e-13 1.0392398e-11 1.1006008e-12]
  [9.9999332e-01 6.6718840e-06 6.2532379e-13 3.4229401e-12 1.1341004e-12]
  [9.9978131e-01 2.1871367e-04 3.1587105e-12 1.3898658e-11 3.7029858e-12]]

 [[9.9999893e-01 1.0951272e-06 1.2515429e-12 6.1069513e-12 1.7267191e-12]
  [9.9999917e-01 8.7445585e-07 3.5646196e-13 8.5783958e-12 5.0237749e-13]
  [9.9855202e-01 1.4479816e-03 1.2736573e-11 4.6641083e-11 2.4883264e-11]
  ...
  [9.9999201e-01 8.0380532e-06 1.5426790e-12 1.3804485e-11 2.7134779e-12]
  [9.9990749e-01 9.2541421e-05 2.0438373e-12 1.1008975e-11 2.2243353e-12]
  [9.9999714e-01 2.8735290e-06 8.2756467e-14 4.9367558e-13 2.1667859e-13]]

 [[9.9999702e-01 3.0268361e-06 1.2732587e-12 4.0054897e-11 1.8341186e-12]
  [9.9999988e-01 1.3345057e-07 3.3973727e-13 2.2951478e-11 3.5754418e-13]
  [9.9998391e-01 1.6076430e-05 3.7105719e-13 3.1426309e-12 6.5058874e-13]
  ...
  [9.9999750e-01 2.5418180e-06 4.8353660e-13 5.2353850e-12 7.6706230e-13]
  [9.9999094e-01 9.0717849e-06 4.3861602e-13 3.3329873e-12 6.9347826e-13]
  [9.9997795e-01 2.2080625e-05 1.0897948e-12 9.8205740e-12 1.9873846e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999332e-01 6.6480407e-06 3.7455221e-12 1.8739627e-10 5.2834135e-12]
 [9.9999976e-01 2.2764615e-07 4.6358962e-13 2.9044831e-11 4.4957335e-13]
 [9.9990201e-01 9.8019555e-05 6.2701754e-13 4.1607698e-12 1.2361771e-12]
 ...
 [9.9999750e-01 2.5418180e-06 4.8353660e-13 5.2353850e-12 7.6706230e-13]
 [9.9999094e-01 9.0717849e-06 4.3861602e-13 3.3329873e-12 6.9347826e-13]
 [9.9997795e-01 2.2080625e-05 1.0897948e-12 9.8205740e-12 1.9873846e-12]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0018713280871510505
tp :  99984.0
fp :  16.0
tn :  399984.0
fn :  16.0
accuracy :  0.9999359250068665
precision :  0.9998400211334229
recall :  0.9998400211334229
auc :  0.9999306201934814

y_eval {0: 100000}
pred {0: 99984, 1: 16}
[INFO] confusion matrix for file 
[[99984    16     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[4394955    1181       0       0       0]
 [ 391363       4       0       0       0]
 [ 109690       5       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0409675e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.0409675e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0409675e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-3.4612519e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4612519e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4612519e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.9993002e-01 7.0004964e-05 1.1292247e-11 9.5830122e-10 1.1484697e-11]
  [9.9999881e-01 1.1334657e-06 6.2277527e-13 2.5230809e-11 5.2107130e-13]
  [9.9999309e-01 6.8983454e-06 2.0276791e-13 1.6949788e-12 3.7630129e-13]
  ...
  [9.9999988e-01 1.2006228e-07 6.6510064e-14 1.0009918e-12 1.2358283e-13]
  [1.0000000e+00 9.9623794e-09 5.2199571e-14 2.4428263e-12 1.0754690e-13]
  [9.9999046e-01 9.5748228e-06 1.7327057e-12 1.3537520e-10 2.5710603e-12]]

 [[9.9994719e-01 5.2809264e-05 3.5339327e-12 1.4886681e-10 4.4861372e-12]
  [9.9999738e-01 2.6289042e-06 1.8502506e-12 3.0991321e-11 2.0540689e-12]
  [9.9991977e-01 8.0211365e-05 2.4753342e-12 4.3585580e-11 3.8730252e-12]
  ...
  [9.9999595e-01 4.0237960e-06 4.2096144e-13 4.2685421e-12 6.5770588e-13]
  [9.9705803e-01 2.9419425e-03 9.3021693e-12 3.9857041e-11 1.6731215e-11]
  [9.9985623e-01 1.4374645e-04 1.7132987e-12 6.1980386e-12 2.0733287e-12]]

 [[9.9993062e-01 6.9432535e-05 1.1281899e-11 9.5897834e-10 1.1468812e-11]
  [9.9999964e-01 3.6482356e-07 6.5217937e-13 3.0729690e-11 5.2040127e-13]
  [9.9888390e-01 1.1160962e-03 2.8409013e-12 5.7339645e-12 4.0411867e-12]
  ...
  [9.9999952e-01 4.2160829e-07 9.5277769e-14 9.2703265e-13 1.9848354e-13]
  [9.9999857e-01 1.3789729e-06 9.6779052e-13 1.5696250e-11 1.5661284e-12]
  [9.9997783e-01 2.2193059e-05 9.0238998e-13 7.8354250e-12 1.0860492e-12]]

 ...

 [[9.9992108e-01 7.8931917e-05 4.3641852e-12 1.9562811e-10 5.3899845e-12]
  [9.9999642e-01 3.5865005e-06 3.6303718e-12 9.3172470e-11 3.0538046e-12]
  [9.8505276e-01 1.4947197e-02 1.2883167e-11 4.8759032e-11 2.6725847e-11]
  ...
  [9.9999917e-01 8.7657668e-07 2.4144738e-13 3.1053131e-12 3.8652125e-13]
  [9.9999762e-01 2.3546008e-06 3.4521230e-13 3.4397157e-12 5.3894687e-13]
  [9.9999833e-01 1.6202172e-06 1.4771761e-13 1.7382373e-12 3.1528390e-13]]

 [[9.9992132e-01 7.8719866e-05 4.3600176e-12 1.9541521e-10 5.3853515e-12]
  [9.9999964e-01 3.3995281e-07 8.4468494e-13 3.3930431e-11 7.9484563e-13]
  [9.9961096e-01 3.8906516e-04 1.3787878e-12 3.6992280e-12 2.0416999e-12]
  ...
  [9.9999774e-01 2.3188948e-06 5.3847226e-13 4.4319995e-12 1.0203470e-12]
  [1.0000000e+00 4.8154181e-08 5.1704124e-14 1.4652813e-12 9.6417476e-14]
  [9.9999630e-01 3.6401245e-06 5.4345921e-13 6.2531287e-12 8.1934383e-13]]

 [[9.9708360e-01 2.9163680e-03 1.0491831e-10 1.2063444e-08 1.3081176e-10]
  [9.9999976e-01 2.8205423e-07 1.6752389e-13 8.1027572e-12 1.9407849e-13]
  [9.9999869e-01 1.2735646e-06 4.1805329e-13 7.5734375e-12 7.3513797e-13]
  ...
  [9.9985838e-01 1.4161255e-04 5.9686401e-12 8.5470617e-11 8.7919351e-12]
  [9.9999726e-01 2.6929101e-06 4.2334376e-13 2.9792501e-12 8.4410473e-13]
  [9.9999988e-01 6.2613275e-08 5.6321928e-14 1.3573703e-12 9.7962532e-14]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9993002e-01 7.0004964e-05 1.1292247e-11 9.5830122e-10 1.1484697e-11]
 [9.9999881e-01 1.1334657e-06 6.2277527e-13 2.5230809e-11 5.2107130e-13]
 [9.9999309e-01 6.8983454e-06 2.0276791e-13 1.6949788e-12 3.7630129e-13]
 ...
 [9.9985838e-01 1.4161255e-04 5.9686401e-12 8.5470617e-11 8.7919351e-12]
 [9.9999726e-01 2.6929101e-06 4.2334376e-13 2.9792501e-12 8.4410473e-13]
 [9.9999988e-01 6.2613275e-08 5.6321928e-14 1.3573703e-12 9.7962532e-14]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0018262725269421935
tp :  99984.0
fp :  16.0
tn :  399984.0
fn :  16.0
accuracy :  0.9999359250068665
precision :  0.9998400211334229
recall :  0.9998400211334229
auc :  0.9999369978904724

y_eval {0: 100000}
pred {0: 99984, 1: 16}
[INFO] confusion matrix for file 
[[99984    16     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[4494939    1197       0       0       0]
 [ 391363       4       0       0       0]
 [ 109690       5       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.461252e-01  0.000000e+00  0.000000e+00 ...  5.000000e+00
   4.820000e-03 -1.276130e+00]
 [-3.461252e-01  0.000000e+00  0.000000e+00 ...  2.000000e+00
   4.820000e-03 -3.348400e-01]
 [-3.461252e-01  0.000000e+00  0.000000e+00 ...  3.000000e+00
   4.820000e-03  1.454420e+00]
 ...
 [ 3.461811e-01  0.000000e+00  0.000000e+00 ...  1.000000e+00
   4.820000e-03 -3.215100e-01]
 [ 3.461811e-01  0.000000e+00  0.000000e+00 ...  5.000000e+00
   4.820000e-03 -1.276130e+00]
 [ 3.461811e-01  0.000000e+00  0.000000e+00 ...  3.000000e+00
   4.820000e-03  1.454420e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99997854e-01 2.14317356e-06 6.95852067e-13 1.86513392e-11
   1.09659309e-12]
  [9.99999881e-01 9.24884205e-08 2.57671434e-13 2.68833011e-11
   2.54081424e-13]
  [9.99998689e-01 1.30083413e-06 1.50882440e-13 4.01097558e-12
   2.62953748e-13]
  ...
  [9.99997377e-01 2.64127834e-06 1.29061841e-13 1.03163994e-12
   2.68453906e-13]
  [9.99999881e-01 1.43357653e-07 8.13159422e-14 1.32423597e-12
   1.67120834e-13]
  [9.99907374e-01 9.26295324e-05 3.11618808e-12 5.90152233e-11
   4.97715714e-12]]

 [[9.99928713e-01 7.13385598e-05 4.63815184e-12 1.86065344e-10
   6.05710621e-12]
  [9.99998808e-01 1.13565784e-06 1.02865882e-12 2.34223491e-11
   1.13572812e-12]
  [9.99989152e-01 1.08890090e-05 6.76561725e-13 1.00764206e-11
   1.15254854e-12]
  ...
  [9.99999523e-01 4.57519207e-07 8.63509093e-14 8.82669534e-13
   2.02677962e-13]
  [1.00000000e+00 4.82549503e-08 8.34420491e-14 3.57213824e-12
   1.63096994e-13]
  [9.99999285e-01 7.00494695e-07 2.73723129e-13 3.99081636e-12
   4.24450676e-13]]

 [[9.99996066e-01 3.88891476e-06 1.06678045e-12 4.36204302e-11
   1.38201570e-12]
  [9.99999762e-01 1.85655381e-07 1.42927459e-13 3.92521814e-11
   1.65723514e-13]
  [9.99983072e-01 1.69561772e-05 8.75083155e-13 4.83492933e-12
   1.61864923e-12]
  ...
  [9.99993682e-01 6.34804928e-06 1.38750350e-12 3.23084684e-11
   2.28850532e-12]
  [9.99999762e-01 1.84448979e-07 1.15445454e-13 1.81846584e-12
   2.32724105e-13]
  [9.99999404e-01 5.41724944e-07 5.23725919e-13 8.47071371e-12
   8.52401591e-13]]

 ...

 [[9.99999285e-01 6.74303294e-07 3.02453239e-13 6.20946914e-12
   4.76057236e-13]
  [9.99999642e-01 4.08363718e-07 8.83407334e-13 5.37658945e-11
   8.75690416e-13]
  [9.99998331e-01 1.72750083e-06 8.42034030e-14 1.91322110e-12
   1.48378664e-13]
  ...
  [9.99988079e-01 1.19294591e-05 1.54981822e-13 6.23342578e-13
   4.15904670e-13]
  [1.00000000e+00 2.55957691e-08 3.83833963e-14 1.08095846e-12
   7.62467549e-14]
  [9.99996185e-01 3.84961686e-06 5.05031455e-13 2.52393089e-11
   8.11864302e-13]]

 [[9.99954224e-01 4.57484130e-05 1.11884538e-11 1.12066612e-09
   1.07374431e-11]
  [1.00000000e+00 1.02475335e-08 2.33929646e-14 6.38588054e-12
   2.53486891e-14]
  [9.99330521e-01 6.69462432e-04 1.10280864e-11 1.81664420e-10
   2.08063202e-11]
  ...
  [9.99805152e-01 1.94917942e-04 2.80331574e-12 1.16351668e-11
   3.22052823e-12]
  [9.99998808e-01 1.19403592e-06 9.10772448e-14 6.84438996e-13
   2.23710211e-13]
  [1.00000000e+00 5.36854543e-08 5.45909651e-14 1.35064789e-12
   9.73384107e-14]]

 [[9.96559680e-01 3.44031816e-03 4.06202814e-11 2.33343433e-09
   4.94743760e-11]
  [9.99999642e-01 2.98465380e-07 3.15135233e-13 1.30365120e-11
   3.74913913e-13]
  [9.99994755e-01 5.18700563e-06 1.35488257e-12 1.49207261e-11
   2.31083382e-12]
  ...
  [9.99997020e-01 3.01713817e-06 5.30724607e-13 4.00856692e-12
   1.05376211e-12]
  [9.99994874e-01 5.09927986e-06 4.21994010e-13 4.22096472e-12
   5.29672768e-13]
  [9.99997497e-01 2.47528874e-06 1.52589801e-13 1.38527427e-12
   3.59715838e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999785e-01 2.1431736e-06 6.9585207e-13 1.8651339e-11 1.0965931e-12]
 [9.9999988e-01 9.2488420e-08 2.5767143e-13 2.6883301e-11 2.5408142e-13]
 [9.9999869e-01 1.3008341e-06 1.5088244e-13 4.0109756e-12 2.6295375e-13]
 ...
 [9.9999702e-01 3.0171382e-06 5.3072461e-13 4.0085669e-12 1.0537621e-12]
 [9.9999487e-01 5.0992799e-06 4.2199401e-13 4.2209647e-12 5.2967277e-13]
 [9.9999750e-01 2.4752887e-06 1.5258980e-13 1.3852743e-12 3.5971584e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0013259054051712156
tp :  99986.0
fp :  14.0
tn :  399986.0
fn :  14.0
accuracy :  0.9999439120292664
precision :  0.9998599886894226
recall :  0.9998599886894226
auc :  0.9999809861183167

y_eval {0: 100000}
pred {0: 99986, 1: 14}
[INFO] confusion matrix for file 
[[99986    14     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[4594925    1211       0       0       0]
 [ 391363       4       0       0       0]
 [ 109690       5       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4618109e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 3.4618109e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4618109e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 ...
 [ 1.0384874e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.0384874e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0384874e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.9999928e-01 6.6464230e-07 3.0149310e-13 6.1740751e-12 4.7366429e-13]
  [9.9999976e-01 2.7676901e-07 5.7772071e-13 3.3554583e-11 5.9998328e-13]
  [9.9981493e-01 1.8506244e-04 1.2290424e-12 1.3414189e-11 2.5747308e-12]
  ...
  [9.9999976e-01 2.8564639e-07 1.2387498e-13 2.2364144e-12 2.0194676e-13]
  [9.9999988e-01 1.0597945e-07 5.1918166e-14 2.1659005e-12 1.0308611e-13]
  [9.9999952e-01 5.1316891e-07 2.6291436e-13 3.7734173e-12 4.4417963e-13]]

 [[9.9647337e-01 3.5265454e-03 4.1527334e-11 2.3926214e-09 5.0601915e-11]
  [9.9999976e-01 2.8742997e-07 3.0343336e-13 1.2675105e-11 3.6240244e-13]
  [9.9990499e-01 9.5057745e-05 6.7536927e-12 7.4931047e-11 1.2400850e-11]
  ...
  [9.9999988e-01 1.4595000e-07 1.0917031e-13 3.2095891e-12 2.1507008e-13]
  [9.9999976e-01 2.3265292e-07 1.5808501e-13 2.7679996e-12 2.7367209e-13]
  [9.9999988e-01 1.0179316e-07 1.4228774e-13 4.2460501e-12 2.4975895e-13]]

 [[9.9644583e-01 3.5541838e-03 4.1822271e-11 2.4119686e-09 5.0968889e-11]
  [9.9999976e-01 2.8096719e-07 2.9681560e-13 1.2482428e-11 3.5520859e-13]
  [9.9999499e-01 4.9876821e-06 1.3581405e-12 1.5304660e-11 2.3119631e-12]
  ...
  [1.0000000e+00 2.4559919e-08 5.3691843e-14 1.7492690e-12 1.0084210e-13]
  [9.9999976e-01 2.4688592e-07 1.2076447e-13 4.0008634e-12 1.7928420e-13]
  [9.9999964e-01 3.5991980e-07 1.9715318e-13 3.2961338e-12 3.7214107e-13]]

 ...

 [[9.9978703e-01 2.1303131e-04 7.5146720e-12 3.8780731e-10 9.0086836e-12]
  [9.9999976e-01 1.9564604e-07 5.7757087e-13 2.3073410e-11 5.5119245e-13]
  [9.9906272e-01 9.3724584e-04 1.3509426e-12 2.8895211e-12 2.1695282e-12]
  ...
  [9.9999785e-01 2.1972555e-06 3.0698556e-13 2.2534216e-12 6.7312188e-13]
  [9.9999917e-01 8.8701438e-07 4.8860671e-13 6.0886578e-12 8.4709822e-13]
  [9.9999893e-01 1.1268976e-06 1.6621151e-13 2.5924586e-12 2.6837855e-13]]

 [[9.9989021e-01 1.0972672e-04 5.5034345e-12 2.6919206e-10 6.5267080e-12]
  [9.9999976e-01 2.5715127e-07 6.3387186e-13 2.4908554e-11 6.2528606e-13]
  [9.9464285e-01 5.3571109e-03 4.0423910e-12 4.0966388e-12 6.1797911e-12]
  ...
  [9.9992502e-01 7.5002776e-05 2.0978128e-12 1.0398131e-11 2.4361897e-12]
  [9.9997032e-01 2.9672659e-05 3.5242455e-13 1.0222534e-12 7.2458483e-13]
  [9.9995029e-01 4.9752714e-05 1.1902931e-12 6.8934784e-12 2.3897178e-12]]

 [[9.9999893e-01 1.0189792e-06 3.9367725e-13 8.4462038e-12 6.1127286e-13]
  [9.9999964e-01 3.5817416e-07 8.3813073e-13 5.8211352e-11 8.7039344e-13]
  [9.9999702e-01 3.0079793e-06 1.8349609e-13 2.4946985e-12 2.9597134e-13]
  ...
  [9.9947971e-01 5.2030868e-04 1.7685867e-12 4.1351241e-12 2.3809652e-12]
  [9.9999714e-01 2.8355125e-06 1.2363578e-13 6.3560387e-13 3.0665761e-13]
  [1.0000000e+00 3.2209169e-08 5.0410542e-14 1.4740271e-12 1.0097028e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999928e-01 6.6464230e-07 3.0149310e-13 6.1740751e-12 4.7366429e-13]
 [9.9999976e-01 2.7676901e-07 5.7772071e-13 3.3554583e-11 5.9998328e-13]
 [9.9981493e-01 1.8506244e-04 1.2290424e-12 1.3414189e-11 2.5747308e-12]
 ...
 [9.9947971e-01 5.2030868e-04 1.7685867e-12 4.1351241e-12 2.3809652e-12]
 [9.9999714e-01 2.8355125e-06 1.2363578e-13 6.3560387e-13 3.0665761e-13]
 [1.0000000e+00 3.2209169e-08 5.0410542e-14 1.4740271e-12 1.0097028e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0015766316410154105
tp :  99975.0
fp :  25.0
tn :  399975.0
fn :  25.0
accuracy :  0.9998999834060669
precision :  0.999750018119812
recall :  0.999750018119812
auc :  0.9999873638153076

y_eval {0: 100000}
pred {0: 99975, 1: 25}
[INFO] confusion matrix for file 
[[99975    25     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[4694900    1236       0       0       0]
 [ 391363       4       0       0       0]
 [ 109690       5       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0384874  0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 1.0384874  0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 1.0384874  0.         0.        ...  3.         0.00482    1.45442  ]
 ...
 [ 1.7307937  0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 1.7307937  0.         0.        ...  4.         0.00482   -0.23351  ]
 [ 1.7307937  0.         0.        ...  3.         0.00482    1.45442  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.9842286e-01 1.5771331e-03 2.1129964e-11 1.1298854e-09 2.4942954e-11]
  [9.9999976e-01 2.8403741e-07 6.4967400e-13 3.0219018e-11 7.5254050e-13]
  [9.9999928e-01 7.1677147e-07 9.4380809e-14 2.3161217e-12 1.5715658e-13]
  ...
  [9.9999988e-01 1.0377275e-07 5.2179855e-14 1.1052973e-12 9.8237770e-14]
  [9.9999988e-01 1.7527684e-07 3.0256190e-13 7.5441788e-12 4.5435430e-13]
  [9.9999869e-01 1.3445239e-06 1.6348297e-13 1.2304107e-12 3.1037290e-13]]

 [[9.9978870e-01 2.1133294e-04 7.4931866e-12 3.8661890e-10 8.9880004e-12]
  [1.0000000e+00 5.3463101e-08 7.9196266e-14 7.8810292e-12 9.7105497e-14]
  [9.9999642e-01 3.5472628e-06 1.2474597e-12 1.6739030e-11 2.0952112e-12]
  ...
  [9.9990571e-01 9.4237235e-05 6.4004439e-13 3.9945855e-12 1.5234236e-12]
  [9.9999976e-01 2.0636749e-07 1.2541696e-13 2.0854184e-12 2.3966728e-13]
  [9.9999952e-01 5.3115087e-07 4.9678062e-13 8.0831982e-12 8.0734556e-13]]

 [[9.9999976e-01 2.8447008e-07 6.1751580e-13 1.9561540e-11 1.1121997e-12]
  [1.0000000e+00 1.1456878e-08 3.4811563e-14 7.7938194e-12 4.0375187e-14]
  [9.9984515e-01 1.5482122e-04 2.0736945e-11 3.2029807e-10 3.3507634e-11]
  ...
  [9.9998522e-01 1.4772797e-05 1.7817750e-12 2.1951109e-11 2.7489922e-12]
  [9.9999917e-01 7.9243244e-07 1.1326300e-13 9.2263296e-13 2.5876756e-13]
  [9.9996722e-01 3.2774824e-05 3.1655529e-12 5.6409082e-11 5.0540067e-12]]

 ...

 [[9.9954897e-01 4.5097538e-04 1.1143037e-11 6.2780092e-10 1.2784038e-11]
  [9.9999988e-01 1.4861742e-07 4.7018113e-13 3.1890750e-11 5.3934304e-13]
  [9.9999964e-01 3.4160405e-07 9.6486614e-14 2.5283230e-12 1.5747530e-13]
  ...
  [9.9994588e-01 5.4084114e-05 1.6838530e-12 8.9752112e-12 1.9767397e-12]
  [9.9999499e-01 5.0294625e-06 3.5393346e-13 1.7003247e-12 8.0498168e-13]
  [9.9999988e-01 1.3556996e-07 7.8590590e-14 1.3838700e-12 1.3181796e-13]]

 [[9.9999917e-01 8.5425370e-07 3.6822650e-13 8.1009132e-12 5.7212237e-13]
  [1.0000000e+00 3.0829611e-08 1.0833191e-13 2.3959628e-11 1.1461745e-13]
  [9.9999690e-01 3.0474525e-06 1.7388905e-13 2.9085978e-12 3.1835198e-13]
  ...
  [9.9999487e-01 5.1352367e-06 5.9575543e-13 3.5757736e-12 1.2035003e-12]
  [9.9999964e-01 3.1367895e-07 1.0967158e-13 1.7494285e-12 1.8655338e-13]
  [9.9984133e-01 1.5861882e-04 3.1282019e-12 1.8063159e-11 3.5205547e-12]]

 [[9.9975330e-01 2.4669201e-04 8.0948295e-12 4.3949969e-10 9.4844150e-12]
  [9.9999619e-01 3.7740606e-06 3.2200011e-12 1.0047268e-10 2.4773465e-12]
  [9.9994862e-01 5.1433832e-05 8.1122820e-13 2.9048485e-12 1.2564956e-12]
  ...
  [9.9999237e-01 7.5920548e-06 5.9066353e-13 3.1833611e-12 1.2036694e-12]
  [9.9997985e-01 2.0140773e-05 9.6359325e-13 6.9659022e-12 1.1013398e-12]
  [9.9999702e-01 2.9755672e-06 1.0222099e-13 8.8015234e-13 2.3801116e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9842286e-01 1.5771331e-03 2.1129964e-11 1.1298854e-09 2.4942954e-11]
 [9.9999976e-01 2.8403741e-07 6.4967400e-13 3.0219018e-11 7.5254050e-13]
 [9.9999928e-01 7.1677147e-07 9.4380809e-14 2.3161217e-12 1.5715658e-13]
 ...
 [9.9999237e-01 7.5920548e-06 5.9066353e-13 3.1833611e-12 1.2036694e-12]
 [9.9997985e-01 2.0140773e-05 9.6359325e-13 6.9659022e-12 1.1013398e-12]
 [9.9999702e-01 2.9755672e-06 1.0222099e-13 8.8015234e-13 2.3801116e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.002384169116616249
tp :  99961.0
fp :  39.0
tn :  399961.0
fn :  39.0
accuracy :  0.9998440742492676
precision :  0.9996100068092346
recall :  0.9996100068092346
auc :  0.999987006187439

y_eval {0: 99998, 2: 2}
pred {0: 99963, 1: 37}
[INFO] confusion matrix for file 
[[99961    37     0     0     0]
 [    0     0     0     0     0]
 [    2     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[4794861    1273       0       0       0]
 [ 391363       4       0       0       0]
 [ 109692       5       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-02_121729_121.log.part13_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1368 (0.2736%)
[INFO] ** orig:[0:99.9996%,2:0.0004%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9994%,3:0.0006%]
[INFO] ** i/f_dir:[1:99.9994%,0:0.0006%]
[INFO] ** src:[22:38.162%,9:26.1664%,7:18.0742%,1:17.5958%,21:0.0008%,17:0.0002%,15:0.0002%,14:0.0002%,8:0.0002%]
[INFO] ** dst:[21:43.4352%,10:20.8932%,8:18.0744%,9:17.5952%,22:0.0006%,18:0.0006%,15:0.0006%,6:0.0002%]
[INFO] ** proto:[0:99.9986%,2:0.0008%,1:0.0006%]
[INFO] ** appi_name:[21:99.9986%,31:0.0006%,30:0.0006%,22:0.0002%]
[INFO] ** proxy_src_ip:[18:38.162%,20:26.1664%,13:18.0742%,6:17.5958%,17:0.0006%,7:0.0004%,16:0.0002%,2:0.0002%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9986%,-33.760870000000004:0.0014%]
[INFO] ** modbus_function_description:[7:49.9998%,11:49.9988%,0:0.0014%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.166%,1:20.893%,5:18.0738%,4:17.5948%,2:17.2688%,0:0.0036%]
[INFO] ** service:[0.0048200000000000005:99.9986%,-211.73542999999998:0.0006%,-186.43601999999998:0.0006%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:26.1662%,-0.32151:20.8932%,-1.27613:18.074%,-0.23351:17.5952%,-0.33484:17.2688%,-71.33197:0.0006%,15.43653:0.0004%,-0.24151:0.0004%,-0.24950999999999998:0.0002%,1.46509:0.0002%,4.42897:0.0002%,-71.14931:0.0002%,-1.02014:0.0002%,-1.2708:0.0002%]
[INFO] ** classification:[normal:92.8338%,Multi Stage Single Point:7.1662%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7333814e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.7333814e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.7333814e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [-1.0384512e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0384512e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.0384512e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.9997747e-01 2.2493836e-05 2.3895139e-12 8.7397325e-11 3.1955595e-12]
  [9.9999893e-01 1.0465185e-06 8.4327418e-13 2.1330120e-11 9.6268566e-13]
  [9.9994850e-01 5.1469935e-05 2.2453521e-12 1.4201243e-11 2.5073570e-12]
  ...
  [9.9999976e-01 2.2008342e-07 1.0535634e-13 1.7009557e-12 1.9659595e-13]
  [9.9992001e-01 7.9976962e-05 3.1905099e-12 3.1646987e-11 4.0474542e-12]
  [9.9968648e-01 3.1357878e-04 1.2026336e-12 2.6632581e-12 2.1024710e-12]]

 [[9.9999917e-01 8.5686793e-07 3.8177119e-13 8.5137652e-12 5.7123810e-13]
  [9.9999988e-01 9.6314089e-08 1.5163852e-13 1.7379624e-11 1.5557362e-13]
  [9.9997234e-01 2.7633918e-05 1.4344689e-12 8.8359433e-12 2.6194932e-12]
  ...
  [9.9999976e-01 2.1866580e-07 9.4588284e-14 1.4416783e-12 2.0225630e-13]
  [1.0000000e+00 3.4223365e-08 7.0339269e-14 2.7039417e-12 1.2799774e-13]
  [9.9999881e-01 1.1590953e-06 3.9564494e-13 6.8360955e-12 6.9862828e-13]]

 [[9.9999952e-01 5.3137074e-07 2.5405613e-13 4.3405266e-12 4.1175605e-13]
  [9.9999940e-01 6.2353939e-07 9.9266938e-13 3.7824337e-11 1.0043879e-12]
  [9.9995971e-01 4.0282830e-05 1.2414775e-12 5.1252314e-12 2.2634884e-12]
  ...
  [9.9999571e-01 4.2361316e-06 1.1886229e-12 1.1139111e-11 2.1474138e-12]
  [9.9995625e-01 4.3769211e-05 1.5666447e-12 1.3566439e-11 1.8322186e-12]
  [9.9996269e-01 3.7300251e-05 5.6285071e-13 1.9579358e-12 9.4187147e-13]]

 ...

 [[9.9996340e-01 3.6647401e-05 3.0701787e-12 1.2415403e-10 3.9664053e-12]
  [9.9999952e-01 4.3145704e-07 1.0163089e-12 4.3031790e-11 9.7421257e-13]
  [9.9992883e-01 7.1138289e-05 7.5687595e-13 2.5912042e-12 1.2691326e-12]
  ...
  [9.9999976e-01 1.8372847e-07 1.6277779e-13 3.1781370e-12 2.8826580e-13]
  [9.9997735e-01 2.2638151e-05 1.9870119e-12 2.3177868e-11 2.4796068e-12]
  [9.9999988e-01 1.0733798e-07 2.6422088e-14 4.4023755e-13 6.8607446e-14]]

 [[9.9999857e-01 1.4223635e-06 4.5904621e-13 7.9404964e-12 7.1736784e-13]
  [9.9999940e-01 6.2120267e-07 6.8784594e-13 2.4101702e-11 6.8476447e-13]
  [9.9988639e-01 1.1360491e-04 4.2376476e-12 5.1915028e-11 7.5740022e-12]
  ...
  [9.9999380e-01 6.1537858e-06 1.8787348e-13 1.1474191e-12 4.7141029e-13]
  [9.9999988e-01 6.8879331e-08 7.8253593e-14 1.7312915e-12 1.5663598e-13]
  [9.9999416e-01 5.7887273e-06 1.0023292e-12 2.8490283e-11 1.7007320e-12]]

 [[9.9999845e-01 1.5149285e-06 4.7885258e-13 8.3455690e-12 7.4651234e-13]
  [9.9999940e-01 6.3096292e-07 6.8663478e-13 2.3688832e-11 6.8479190e-13]
  [9.9999952e-01 4.9776190e-07 1.3472940e-13 3.3523277e-12 2.1899461e-13]
  ...
  [9.9999952e-01 4.4699840e-07 1.7902411e-13 3.7488545e-12 3.0012936e-13]
  [9.9999940e-01 5.8300907e-07 4.2079675e-13 6.2169475e-12 7.2711872e-13]
  [9.9999988e-01 1.1386419e-07 6.2261767e-14 1.7609989e-12 1.1125005e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9997747e-01 2.2493836e-05 2.3895139e-12 8.7397325e-11 3.1955595e-12]
 [9.9999893e-01 1.0465185e-06 8.4327418e-13 2.1330120e-11 9.6268566e-13]
 [9.9994850e-01 5.1469935e-05 2.2453521e-12 1.4201243e-11 2.5073570e-12]
 ...
 [9.9999952e-01 4.4699840e-07 1.7902411e-13 3.7488545e-12 3.0012936e-13]
 [9.9999940e-01 5.8300907e-07 4.2079675e-13 6.2169475e-12 7.2711872e-13]
 [9.9999988e-01 1.1386419e-07 6.2261767e-14 1.7609989e-12 1.1125005e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0009307098248042166
tp :  99998.0
fp :  2.0
tn :  399998.0
fn :  2.0
accuracy :  0.9999920129776001
precision :  0.9999799728393555
recall :  0.9999799728393555
auc :  0.9999873042106628

y_eval {0: 100000}
pred {0: 99998, 1: 2}
[INFO] confusion matrix for file 
[[99998     2     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[4894859    1275       0       0       0]
 [ 391363       4       0       0       0]
 [ 109692       5       0       0       0]
 [      0       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0384512e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0384512e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0384512e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-3.4605739e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4605739e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4605739e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99999166e-01 8.46370028e-07 3.47122315e-13 8.67891956e-12
   5.76523800e-13]
  [9.99999881e-01 1.47641259e-07 3.29309794e-13 3.44495821e-11
   3.27033892e-13]
  [9.99998569e-01 1.37171833e-06 1.57615755e-13 2.87045387e-12
   2.77172464e-13]
  ...
  [9.99981880e-01 1.81674459e-05 1.40204417e-12 1.52342132e-11
   1.74840014e-12]
  [9.96102929e-01 3.89713957e-03 4.32921667e-12 1.59045711e-11
   8.15108831e-12]
  [9.99996543e-01 3.42948988e-06 1.64774268e-13 8.51760394e-13
   4.35197641e-13]]

 [[9.99964118e-01 3.59036640e-05 3.04696849e-12 1.22947097e-10
   3.94030338e-12]
  [9.99999523e-01 4.37559521e-07 1.02903233e-12 4.35687736e-11
   9.86719495e-13]
  [9.99928117e-01 7.19355521e-05 7.63005219e-13 2.60482434e-12
   1.27890266e-12]
  ...
  [9.99875546e-01 1.24422862e-04 2.07069735e-12 8.86325822e-12
   2.61762161e-12]
  [9.99997020e-01 2.94350184e-06 1.48993014e-13 8.58711485e-13
   3.56222620e-13]
  [9.99998450e-01 1.56879537e-06 3.44750649e-13 3.70172079e-12
   5.63172555e-13]]

 [[9.99995112e-01 4.87438820e-06 1.67691664e-12 6.09572462e-11
   2.38389733e-12]
  [9.99999762e-01 2.68930449e-07 3.66909872e-14 2.21229111e-12
   4.79758953e-14]
  [9.97552335e-01 2.44771666e-03 1.06802185e-10 1.63770697e-09
   1.81812870e-10]
  ...
  [9.99999642e-01 3.09356409e-07 1.21263473e-13 1.91816376e-12
   2.11713053e-13]
  [9.99800742e-01 1.99235728e-04 4.15987210e-12 2.90423189e-11
   5.43570917e-12]
  [9.57476079e-01 4.25238609e-02 2.85084040e-11 9.03560213e-11
   5.24150827e-11]]

 ...

 [[9.99064505e-01 9.35570337e-04 1.90117488e-11 1.04892461e-09
   2.34579335e-11]
  [9.99999523e-01 4.19076400e-07 4.52097886e-13 1.84192436e-11
   4.98529982e-13]
  [9.99987960e-01 1.20249597e-05 1.46620856e-12 1.13365159e-11
   2.59720609e-12]
  ...
  [9.99999881e-01 9.00343906e-08 1.02310426e-13 2.30042331e-12
   1.90053350e-13]
  [9.99999762e-01 2.52845041e-07 1.75438670e-13 4.09578838e-12
   2.73364285e-13]
  [9.99998569e-01 1.41753196e-06 1.88706134e-13 3.47728617e-12
   3.59174604e-13]]

 [[9.99939322e-01 6.06736176e-05 4.02120828e-12 1.79237736e-10
   5.01404820e-12]
  [9.99999881e-01 1.56760038e-07 1.57045804e-13 9.99071572e-12
   1.90134922e-13]
  [9.99998093e-01 1.88629531e-06 4.69567256e-13 8.72981201e-12
   7.22014083e-13]
  ...
  [9.99999762e-01 2.41735790e-07 5.48667421e-14 6.98225278e-13
   1.26388564e-13]
  [9.99999523e-01 4.40684005e-07 3.05132032e-13 6.11955972e-12
   4.64038909e-13]
  [9.99912381e-01 8.76058548e-05 2.69520409e-12 4.14027146e-11
   4.40761360e-12]]

 [[9.99999881e-01 1.07015808e-07 4.40597076e-13 6.11627112e-12
   6.57347278e-13]
  [9.99992132e-01 7.87808312e-06 2.75361353e-12 2.70748771e-11
   3.59348575e-12]
  [9.99531388e-01 4.68670391e-04 2.75331082e-12 2.78237416e-11
   5.51929509e-12]
  ...
  [9.99840975e-01 1.59020885e-04 5.57924843e-12 6.44194559e-11
   9.60073600e-12]
  [9.99997020e-01 2.92511413e-06 4.69932307e-13 3.39405479e-12
   9.38759704e-13]
  [9.99977708e-01 2.23429233e-05 9.35502869e-13 7.95458057e-12
   1.09250011e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999917e-01 8.4637003e-07 3.4712231e-13 8.6789196e-12 5.7652380e-13]
 [9.9999988e-01 1.4764126e-07 3.2930979e-13 3.4449582e-11 3.2703389e-13]
 [9.9999857e-01 1.3717183e-06 1.5761576e-13 2.8704539e-12 2.7717246e-13]
 ...
 [9.9984097e-01 1.5902088e-04 5.5792484e-12 6.4419456e-11 9.6007360e-12]
 [9.9999702e-01 2.9251141e-06 4.6993231e-13 3.3940548e-12 9.3875970e-13]
 [9.9997771e-01 2.2342923e-05 9.3550287e-13 7.9545806e-12 1.0925001e-12]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  1.8167373952388763
tp :  88727.0
fp :  11273.0
tn :  388727.0
fn :  11273.0
accuracy :  0.9549081325531006
precision :  0.8872699737548828
recall :  0.8872699737548828
auc :  0.9289288520812988

y_eval {0: 88734, 3: 11266}
pred {0: 99993, 1: 7}
[INFO] confusion matrix for file 
[[88727     7     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [11266     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[4983586    1282       0       0       0]
 [ 391363       4       0       0       0]
 [ 109692       5       0       0       0]
 [  11266       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-0.3460574   0.          0.         ...  3.          0.00482
   1.45442   ]
 [-0.3460574   0.          0.         ...  3.          0.00482
   1.45442   ]
 [-0.3460574   0.          0.         ...  4.          0.00482
  -0.23351   ]
 ...
 [ 0.34633645  0.          0.         ...  3.          0.00482
   1.45442   ]
 [ 0.34633645  0.          0.         ...  2.          0.00482
  -0.33484   ]
 [ 0.34633645  0.          0.         ...  1.          0.00482
  -0.32151   ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99953985e-01 4.60391529e-05 3.97836972e-12 1.47631851e-10
   5.37595229e-12]
  [9.99999166e-01 7.96017389e-07 4.70312645e-13 1.30882276e-11
   5.61168896e-13]
  [9.99988556e-01 1.14659351e-05 8.30665452e-13 7.14827329e-12
   1.04702553e-12]
  ...
  [9.99999762e-01 2.02919807e-07 2.86931720e-13 8.91638326e-12
   5.23429553e-13]
  [9.99999285e-01 7.23352116e-07 5.54793082e-13 8.43928226e-12
   9.07013234e-13]
  [9.99998331e-01 1.64161088e-06 5.63813102e-13 8.15379795e-12
   9.09167056e-13]]

 [[9.99939799e-01 6.02209439e-05 4.01566150e-12 1.79075504e-10
   5.00867880e-12]
  [9.99999642e-01 4.08090813e-07 9.97950962e-13 3.81231123e-11
   9.33569736e-13]
  [9.98502970e-01 1.49704679e-03 5.41601486e-12 3.05342383e-11
   8.66859536e-12]
  ...
  [1.00000000e+00 2.39171101e-08 5.00892730e-14 1.47098262e-12
   9.97726207e-14]
  [9.99999762e-01 2.90867206e-07 1.68596758e-13 4.33508394e-12
   2.50761326e-13]
  [9.99996066e-01 3.95301277e-06 3.39732718e-13 1.84602160e-12
   6.61536906e-13]]

 [[9.99939919e-01 6.01114734e-05 4.01439819e-12 1.79043086e-10
   5.00747577e-12]
  [9.99999642e-01 4.08112214e-07 9.98244131e-13 3.81175126e-11
   9.33744184e-13]
  [9.98489022e-01 1.51099323e-03 5.42586549e-12 3.05372498e-11
   8.69120487e-12]
  ...
  [9.99999523e-01 4.78175991e-07 3.93884795e-13 6.84339304e-12
   6.47689259e-13]
  [9.99999881e-01 8.54062492e-08 7.44868848e-14 1.75822334e-12
   1.37251864e-13]
  [9.99984980e-01 1.50094675e-05 8.09778243e-13 1.00780885e-11
   1.37097094e-12]]

 ...

 [[9.94048357e-01 5.95160481e-03 1.08339573e-10 9.29996613e-09
   1.31418348e-10]
  [9.99997377e-01 2.61178889e-06 1.12625209e-12 2.38811818e-11
   1.10380292e-12]
  [9.99938965e-01 6.09926210e-05 1.04489095e-12 7.37244120e-12
   1.87247982e-12]
  ...
  [9.99999046e-01 9.32665159e-07 3.32543048e-13 7.27436470e-12
   4.49290128e-13]
  [9.99600351e-01 3.99646058e-04 5.09597399e-12 2.75625547e-11
   1.02012496e-11]
  [9.99997854e-01 2.12634109e-06 1.46201126e-13 7.29771332e-13
   3.57419389e-13]]

 [[9.99945521e-01 5.44378418e-05 1.12981517e-11 1.08058584e-09
   1.09915384e-11]
  [1.00000000e+00 2.20396945e-08 6.74131568e-14 1.51164237e-11
   7.65886920e-14]
  [9.99993205e-01 6.80469429e-06 4.24820660e-13 5.37385587e-12
   5.25167149e-13]
  ...
  [9.99996066e-01 3.89436673e-06 3.33547019e-13 2.84397202e-12
   7.07324119e-13]
  [9.99999762e-01 2.45669298e-07 1.90598215e-13 3.37032464e-12
   3.33866479e-13]
  [9.99993801e-01 6.20357014e-06 1.04532496e-12 1.40247614e-11
   1.71534271e-12]]

 [[9.99999046e-01 9.44739668e-07 3.50979662e-13 7.37851186e-12
   5.59642502e-13]
  [9.99999762e-01 2.58827498e-07 8.59470806e-13 6.48934101e-11
   8.70611038e-13]
  [9.99959707e-01 4.02324949e-05 2.93656565e-13 1.57299174e-12
   5.44686637e-13]
  ...
  [9.99999762e-01 2.54303018e-07 1.13260048e-13 2.51554745e-12
   2.06777195e-13]
  [9.99998808e-01 1.22604911e-06 2.45503189e-13 3.47470793e-12
   4.07704496e-13]
  [9.99877930e-01 1.22083526e-04 1.84520845e-12 1.27496676e-11
   3.24515696e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.99953985e-01 4.60391529e-05 3.97836972e-12 1.47631851e-10
  5.37595229e-12]
 [9.99999166e-01 7.96017389e-07 4.70312645e-13 1.30882276e-11
  5.61168896e-13]
 [9.99988556e-01 1.14659351e-05 8.30665452e-13 7.14827329e-12
  1.04702553e-12]
 ...
 [9.99999762e-01 2.54303018e-07 1.13260048e-13 2.51554745e-12
  2.06777195e-13]
 [9.99998808e-01 1.22604911e-06 2.45503189e-13 3.47470793e-12
  4.07704496e-13]
 [9.99877930e-01 1.22083526e-04 1.84520845e-12 1.27496676e-11
  3.24515696e-12]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  1.2205610192000866
tp :  92411.0
fp :  7589.0
tn :  392411.0
fn :  7589.0
accuracy :  0.9696440100669861
precision :  0.9241099953651428
recall :  0.9241099953651428
auc :  0.952293872833252

y_eval {0: 92435, 3: 7565}
pred {0: 99976, 1: 24}
[INFO] confusion matrix for file 
[[92411    24     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [ 7565     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[5075997    1306       0       0       0]
 [ 391363       4       0       0       0]
 [ 109692       5       0       0       0]
 [  18831       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4633645e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 3.4633645e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4633645e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 1.0387303e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0387303e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0387303e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99945879e-01 5.41191512e-05 1.12932441e-11 1.08177189e-09
   1.09818396e-11]
  [9.99999404e-01 5.63496599e-07 4.08107765e-13 2.33790695e-11
   3.47456222e-13]
  [9.99994040e-01 6.00773319e-06 3.32175612e-13 3.07319057e-12
   6.34244339e-13]
  ...
  [9.99997973e-01 1.97176473e-06 6.16448570e-13 1.03337616e-11
   9.99059559e-13]
  [9.99999046e-01 9.58726218e-07 2.69845588e-13 2.97369768e-12
   4.76560414e-13]
  [9.99976516e-01 2.34593645e-05 1.63000570e-12 1.48564459e-11
   2.80440601e-12]]

 [[9.99945998e-01 5.39609900e-05 1.12908120e-11 1.08236653e-09
   1.09770248e-11]
  [1.00000000e+00 1.25356792e-08 2.15514726e-14 5.56092585e-12
   2.38494357e-14]
  [9.99912024e-01 8.80033258e-05 1.43276081e-12 8.59838589e-12
   1.72811093e-12]
  ...
  [9.99999762e-01 2.78727271e-07 1.10868752e-13 1.73758349e-12
   1.76269820e-13]
  [9.99988675e-01 1.13238302e-05 4.15350778e-13 4.49655200e-12
   5.89590930e-13]
  [9.99976397e-01 2.36537981e-05 3.33313401e-13 1.14316781e-12
   8.45240653e-13]]

 [[9.98939097e-01 1.06095767e-03 1.81864593e-11 9.91960736e-10
   2.18416986e-11]
  [9.99997497e-01 2.49457639e-06 2.15341395e-12 6.27897803e-11
   1.85019426e-12]
  [9.99918699e-01 8.12912549e-05 1.55568776e-12 4.73873111e-12
   3.14745257e-12]
  ...
  [1.00000000e+00 4.43456365e-08 7.42840034e-14 3.74922099e-12
   1.40253423e-13]
  [9.99999285e-01 7.10992083e-07 5.13383552e-13 8.33247013e-12
   7.96847506e-13]
  [9.99993324e-01 6.62500952e-06 4.79181798e-13 4.75521922e-12
   8.03408067e-13]]

 ...

 [[9.99817193e-01 1.82787539e-04 7.12869607e-12 3.66945085e-10
   8.63919179e-12]
  [1.00000000e+00 5.69922101e-08 8.13427830e-14 7.91434973e-12
   9.90241350e-14]
  [9.99955893e-01 4.41108823e-05 5.40041145e-12 8.77483711e-11
   9.63181097e-12]
  ...
  [9.99999881e-01 1.20444753e-07 9.09121140e-14 1.78908212e-12
   1.84732031e-13]
  [1.00000000e+00 2.91326554e-08 6.08958616e-14 2.42824901e-12
   1.09948095e-13]
  [9.99999881e-01 8.43209662e-08 1.60448383e-13 5.17189677e-12
   2.65484954e-13]]

 [[9.98466015e-01 1.53402390e-03 2.08065284e-11 1.11304443e-09
   2.45530020e-11]
  [9.99998569e-01 1.44081218e-06 1.23042006e-12 4.01952395e-11
   1.18850383e-12]
  [9.99939322e-01 6.06752365e-05 2.72636622e-12 1.63635668e-11
   5.11018268e-12]
  ...
  [9.99999881e-01 1.20383774e-07 1.70732569e-13 4.33395984e-12
   2.87546462e-13]
  [9.99999881e-01 1.69877666e-07 8.45792281e-14 2.08147258e-12
   1.42031230e-13]
  [1.00000000e+00 5.26322239e-08 8.71770646e-14 4.17289250e-12
   1.74864097e-13]]

 [[9.99998927e-01 1.11265615e-06 4.11325650e-13 8.68666770e-12
   6.39318188e-13]
  [9.99999642e-01 3.72849144e-07 8.81754251e-13 6.09758979e-11
   9.23471477e-13]
  [9.99997854e-01 2.16456465e-06 8.94720902e-14 1.91218048e-12
   1.63322331e-13]
  ...
  [9.99679565e-01 3.20430234e-04 3.24983313e-12 1.27970525e-11
   3.79003079e-12]
  [9.99998689e-01 1.36263589e-06 7.01688599e-14 4.10563673e-13
   1.98254092e-13]
  [9.99999881e-01 6.32523296e-08 1.02947585e-13 3.72120780e-12
   2.03158725e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.99945879e-01 5.41191512e-05 1.12932441e-11 1.08177189e-09
  1.09818396e-11]
 [9.99999404e-01 5.63496599e-07 4.08107765e-13 2.33790695e-11
  3.47456222e-13]
 [9.99994040e-01 6.00773319e-06 3.32175612e-13 3.07319057e-12
  6.34244339e-13]
 ...
 [9.99679565e-01 3.20430234e-04 3.24983313e-12 1.27970525e-11
  3.79003079e-12]
 [9.99998689e-01 1.36263589e-06 7.01688599e-14 4.10563673e-13
  1.98254092e-13]
 [9.99999881e-01 6.32523296e-08 1.02947585e-13 3.72120780e-12
  2.03158725e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0017065687337890268
tp :  99963.0
fp :  37.0
tn :  399963.0
fn :  37.0
accuracy :  0.9998520016670227
precision :  0.9996299743652344
recall :  0.9996299743652344
auc :  0.9999935626983643

y_eval {0: 100000}
pred {0: 99963, 1: 37}
[INFO] confusion matrix for file 
[[99963    37     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[5175960    1343       0       0       0]
 [ 391363       4       0       0       0]
 [ 109692       5       0       0       0]
 [  18831       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0387303  0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 1.0387303  0.         0.        ...  2.         0.00482   -0.33484  ]
 [ 1.0387303  0.         0.        ...  1.         0.00482   -0.32151  ]
 ...
 [ 1.7311242  0.         0.        ...  1.         0.00482   -0.32151  ]
 [ 1.7311242  0.         0.        ...  3.         0.00482    1.45442  ]
 [ 1.7311242  0.         0.        ...  3.         0.00482    1.45442  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.98393595e-01 1.60635891e-03 2.13474446e-11 1.14121868e-09
   2.52049666e-11]
  [9.99998569e-01 1.45256695e-06 1.24190241e-12 4.03240913e-11
   1.20109922e-12]
  [9.99973774e-01 2.61922632e-05 1.34246065e-12 6.41134151e-12
   2.54418253e-12]
  ...
  [1.00000000e+00 4.74887081e-08 4.46198864e-14 9.45374855e-13
   8.55556674e-14]
  [9.99999642e-01 2.99075708e-07 3.25336573e-13 1.07253217e-11
   5.10636672e-13]
  [9.99999762e-01 2.31938913e-07 3.65411342e-13 7.87648852e-12
   5.74333441e-13]]

 [[9.99999881e-01 1.22021518e-07 4.84218839e-13 1.42293304e-11
   8.37453425e-13]
  [9.99999881e-01 7.15652746e-08 5.92294497e-14 6.33909722e-12
   7.94557427e-14]
  [9.99993443e-01 6.50173661e-06 2.54039216e-12 3.10696156e-11
   3.36989833e-12]
  ...
  [9.99990582e-01 9.38319317e-06 7.26872447e-13 6.31342157e-12
   1.36308347e-12]
  [9.99999046e-01 9.77557988e-07 2.58437071e-13 3.04461165e-12
   4.41213960e-13]
  [9.99999642e-01 3.53690893e-07 3.41701710e-13 6.31123973e-12
   5.94824971e-13]]

 [[9.99833584e-01 1.66422207e-04 7.00363509e-12 3.56659174e-10
   8.26792801e-12]
  [9.99999642e-01 3.38122391e-07 7.04964190e-13 2.77829374e-11
   8.04299390e-13]
  [9.99992132e-01 7.83359610e-06 3.26173523e-13 2.45625330e-12
   5.13056936e-13]
  ...
  [9.99996424e-01 3.56725127e-06 9.00278441e-13 7.98542048e-12
   1.57786046e-12]
  [9.99927282e-01 7.27223887e-05 1.26500286e-12 5.62909398e-12
   1.68846903e-12]
  [9.99950290e-01 4.96598987e-05 1.40770457e-12 6.16617001e-12
   3.10891265e-12]]

 ...

 [[9.99997497e-01 2.50292146e-06 1.68857777e-12 6.76685513e-11
   2.39126210e-12]
  [1.00000000e+00 3.95150153e-08 1.76290704e-13 1.78590233e-11
   1.86050990e-13]
  [9.99986410e-01 1.36239378e-05 4.87001173e-13 4.22756014e-12
   7.77595056e-13]
  ...
  [9.99959230e-01 4.07621592e-05 1.14771647e-12 4.00677234e-12
   2.43521826e-12]
  [9.99999523e-01 4.77560263e-07 1.17468033e-13 1.58932795e-12
   2.25467960e-13]
  [9.97172058e-01 2.82792444e-03 5.86134891e-11 8.23388802e-10
   8.28819721e-11]]

 [[9.99998808e-01 1.22731842e-06 8.89459405e-13 2.99374796e-11
   1.27854183e-12]
  [9.99999881e-01 1.47488564e-07 4.20420670e-13 4.77658746e-11
   4.24274466e-13]
  [9.99997497e-01 2.49579739e-06 7.49724583e-14 1.22849821e-12
   1.41005724e-13]
  ...
  [9.99988317e-01 1.16567835e-05 5.79392545e-13 2.39959680e-12
   1.12489803e-12]
  [9.99997497e-01 2.53743201e-06 7.92266263e-13 7.67413910e-12
   1.39381106e-12]
  [9.99997497e-01 2.44520493e-06 2.33114065e-13 2.25680173e-12
   3.96257625e-13]]

 [[9.99904394e-01 9.56199510e-05 5.16379387e-12 2.59122224e-10
   6.05892333e-12]
  [1.00000000e+00 1.48879646e-08 3.99816763e-14 1.05750877e-11
   4.99188398e-14]
  [9.99974847e-01 2.51250403e-05 8.59362549e-13 5.97527019e-12
   1.06503792e-12]
  ...
  [9.99965549e-01 3.44894288e-05 1.15598882e-12 3.78867901e-12
   2.34034276e-12]
  [9.99999046e-01 9.16443639e-07 1.60962593e-13 1.75600669e-12
   2.96549460e-13]
  [9.99999642e-01 3.39525116e-07 2.38687352e-13 4.34350039e-12
   4.07802833e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9839360e-01 1.6063589e-03 2.1347445e-11 1.1412187e-09 2.5204967e-11]
 [9.9999857e-01 1.4525669e-06 1.2419024e-12 4.0324091e-11 1.2010992e-12]
 [9.9997377e-01 2.6192263e-05 1.3424606e-12 6.4113415e-12 2.5441825e-12]
 ...
 [9.9996555e-01 3.4489429e-05 1.1559888e-12 3.7886790e-12 2.3403428e-12]
 [9.9999905e-01 9.1644364e-07 1.6096259e-13 1.7560067e-12 2.9654946e-13]
 [9.9999964e-01 3.3952512e-07 2.3868735e-13 4.3435004e-12 4.0780283e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  2.742226470184326
tp :  82958.0
fp :  17042.0
tn :  382958.0
fn :  17042.0
accuracy :  0.9318321347236633
precision :  0.8295800089836121
recall :  0.8295800089836121
auc :  0.8927081823348999

y_eval {0: 83000, 3: 17000}
pred {0: 99958, 1: 42}
[INFO] confusion matrix for file 
[[82958    42     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [17000     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[5258918    1385       0       0       0]
 [ 391363       4       0       0       0]
 [ 109692       5       0       0       0]
 [  35831       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-02_121729_121.log.part14_sorted-labeled.csv
[INFO] process dataset, shape: (439824, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (439824, 17)

[INFO] analyzing data
[INFO] 439824 rows
[INFO] ** unixtime:1201 (0.27306%)
[INFO] ** orig:[0:99.99955%,2:0.00045%]
[INFO] ** type:[0:99.99977%,1:0.00023%]
[INFO] ** i/f_name:[2:99.99864%,3:0.00136%]
[INFO] ** i/f_dir:[1:99.99886%,0:0.00114%]
[INFO] ** src:[22:38.09456%,9:26.09703%,7:18.22161%,1:17.58408%,14:0.00091%,21:0.00068%,15:0.00068%,4:0.00023%,3:0.00023%]
[INFO] ** dst:[21:43.35416%,10:20.83674%,8:18.22115%,9:17.58385%,22:0.00159%,15:0.00136%,24:0.00045%,25:0.00023%,6:0.00023%,2:0.00023%]
[INFO] ** proto:[0:99.99818%,1:0.00136%,2:0.00045%]
[INFO] ** appi_name:[21:99.99795%,30:0.00136%,26:0.00023%,8:0.00023%,0:0.00023%]
[INFO] ** proxy_src_ip:[18:38.09456%,20:26.09703%,13:18.22161%,6:17.58408%,17:0.00136%,16:0.00068%,21:0.00023%,7:0.00023%,1:0.00023%]
[INFO] ** modbus_function_code:[0.02961:99.99795%,-33.760870000000004:0.00205%]
[INFO] ** modbus_function_description:[7:49.99955%,11:49.99841%,0:0.00205%]
[INFO] ** modbus_transaction_id:65536 (14.90051%)
[INFO] ** scada_tag:[3:26.09612%,1:20.83652%,5:18.22092%,4:17.5834%,2:17.25758%,0:0.00546%]
[INFO] ** service:[0.0048200000000000005:99.99795%,-211.73542999999998:0.00136%,-186.44547:0.00023%,-211.08346:0.00023%,-211.35747999999998:0.00023%]
[INFO] ** s_port:[1.45442:26.09635%,-0.32151:20.83674%,-1.27613:18.22115%,-0.23351:17.58362%,-0.33484:17.25781%,-71.33197:0.00136%,-1.02014:0.00068%,-1.27347:0.00045%,1.45709:0.00045%,-0.24151:0.00045%,-71.14798:0.00023%,1.47576:0.00023%,-64.19493:0.00023%,-1.2708:0.00023%]
[INFO] ** classification:[normal:93.34597%,Single Stage Single Point:4.48861%,Multi Stage Single Point:2.16541%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/439824 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.732219e+00  0.000000e+00  0.000000e+00 ...  5.000000e+00
   4.820000e-03 -1.276130e+00]
 [-1.732219e+00  0.000000e+00  0.000000e+00 ...  1.000000e+00
   4.820000e-03 -3.215100e-01]
 [-1.732219e+00  0.000000e+00  0.000000e+00 ...  2.000000e+00
   4.820000e-03 -3.348400e-01]
 ...
 [-9.465184e-01  0.000000e+00  0.000000e+00 ...  5.000000e+00
   4.820000e-03 -1.276130e+00]
 [-9.465184e-01  0.000000e+00  0.000000e+00 ...  2.000000e+00
   4.820000e-03 -3.348400e-01]
 [-9.465184e-01  0.000000e+00  0.000000e+00 ...  3.000000e+00
   4.820000e-03  1.454420e+00]] shape (100000, 16)
y_test [[0. 0. 0. 1. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [3 0 0 ... 1 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99997735e-01 2.31842819e-06 9.96514828e-13 3.21741071e-11
   1.43781428e-12]
  [1.00000000e+00 2.92061522e-08 2.76743265e-14 4.58631397e-12
   3.17451753e-14]
  [9.99985099e-01 1.49007337e-05 1.99537912e-12 4.01610585e-11
   3.01913681e-12]
  ...
  [9.99991179e-01 8.87107581e-06 7.40139720e-13 1.05679181e-11
   7.97648514e-13]
  [9.99999285e-01 7.48685522e-07 8.62870092e-14 7.25227983e-13
   1.76918471e-13]
  [1.00000000e+00 9.89441507e-09 5.56118533e-14 2.62517764e-12
   1.10140148e-13]]

 [[9.99997616e-01 2.34170875e-06 1.00142301e-12 3.23010160e-11
   1.44446607e-12]
  [1.00000000e+00 1.09135208e-08 2.33331183e-14 4.65586424e-12
   2.58415979e-14]
  [9.99991179e-01 8.78384344e-06 1.51645374e-12 1.70179860e-11
   2.16033658e-12]
  ...
  [9.99996901e-01 3.07866503e-06 5.19362602e-13 3.85400826e-12
   8.73809326e-13]
  [9.99982595e-01 1.73598637e-05 1.29480151e-12 9.35318663e-12
   2.38275849e-12]
  [9.99948382e-01 5.15880165e-05 1.38799378e-12 7.22076305e-12
   1.57234403e-12]]

 [[9.99997616e-01 2.36499341e-06 1.00629216e-12 3.24263255e-11
   1.45106301e-12]
  [1.00000000e+00 1.09066747e-08 2.33454935e-14 4.65925735e-12
   2.58556502e-14]
  [9.99994874e-01 5.11022336e-06 6.47019493e-13 8.77085730e-12
   1.13677687e-12]
  ...
  [9.99953747e-01 4.62407152e-05 7.90345057e-13 5.37151270e-12
   9.56489011e-13]
  [9.99994516e-01 5.43905026e-06 1.51747660e-13 7.84012666e-13
   3.74463156e-13]
  [9.99999166e-01 8.52773894e-07 4.73104466e-13 6.99395489e-12
   7.98262173e-13]]

 ...

 [[9.99999285e-01 6.72307578e-07 2.69968157e-13 5.42978293e-12
   4.43390631e-13]
  [9.99999881e-01 6.23541823e-08 1.58185788e-13 1.97846930e-11
   1.60211390e-13]
  [9.99973655e-01 2.62918402e-05 1.74505744e-12 1.42567208e-11
   3.03184366e-12]
  ...
  [9.99952078e-01 4.79384762e-05 3.92060543e-13 1.26589104e-12
   7.66771466e-13]
  [9.99999166e-01 7.79822642e-07 1.13975547e-13 1.30494855e-12
   2.80459114e-13]
  [9.99999881e-01 1.03583702e-07 1.12367736e-13 2.44871332e-12
   2.03173063e-13]]

 [[9.99998689e-01 1.28409204e-06 5.37314496e-13 1.54758810e-11
   7.58087603e-13]
  [1.00000000e+00 4.26388098e-08 8.32641451e-14 2.25090172e-11
   9.04692987e-14]
  [9.99999046e-01 9.29871987e-07 1.37681221e-13 2.41643728e-12
   2.53346606e-13]
  ...
  [9.99997973e-01 2.05372999e-06 1.22321627e-13 8.37442257e-13
   2.72506925e-13]
  [9.99999881e-01 1.61979557e-07 1.08285004e-13 2.48843741e-12
   2.22064798e-13]
  [9.99999642e-01 3.70409708e-07 1.96915658e-13 3.07277402e-12
   3.32110966e-13]]

 [[9.99932289e-01 6.76888012e-05 3.92615714e-12 1.70263428e-10
   4.92059865e-12]
  [9.99996781e-01 3.20237655e-06 2.76949123e-12 6.40142384e-11
   2.51951606e-12]
  [9.98980343e-01 1.01958192e-03 2.66185923e-12 1.08421961e-11
   5.10666466e-12]
  ...
  [9.99999285e-01 7.36700827e-07 5.72732508e-14 4.52505844e-13
   1.51369680e-13]
  [9.99999642e-01 3.56122769e-07 2.61637256e-13 4.33705979e-12
   4.23299552e-13]
  [9.99999881e-01 9.04055710e-08 7.84375413e-14 1.86078041e-12
   1.49313220e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999774e-01 2.3184282e-06 9.9651483e-13 3.2174107e-11 1.4378143e-12]
 [1.0000000e+00 2.9206152e-08 2.7674327e-14 4.5863140e-12 3.1745175e-14]
 [9.9998510e-01 1.4900734e-05 1.9953791e-12 4.0161059e-11 3.0191368e-12]
 ...
 [9.9999928e-01 7.3670083e-07 5.7273251e-14 4.5250584e-13 1.5136968e-13]
 [9.9999964e-01 3.5612277e-07 2.6163726e-13 4.3370598e-12 4.2329955e-13]
 [9.9999988e-01 9.0405571e-08 7.8437541e-14 1.8607804e-12 1.4931322e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  1.96048889503479
tp :  86774.0
fp :  13226.0
tn :  386774.0
fn :  13226.0
accuracy :  0.9470961093902588
precision :  0.8677399754524231
recall :  0.8677399754524231
auc :  0.9167261123657227

y_eval {0: 86777, 1: 3699, 3: 9524}
pred {0: 99997, 1: 3}
[INFO] confusion matrix for file 
[[86774     3     0     0     0]
 [ 3699     0     0     0     0]
 [    0     0     0     0     0]
 [ 9524     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[5345692    1388       0       0       0]
 [ 395062       4       0       0       0]
 [ 109692       5       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 100000-200000/439824 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-0.9465184  0.         0.        ...  4.         0.00482   -0.23351  ]
 [-0.9436298  0.         0.        ...  1.         0.00482   -0.32151  ]
 [-0.9436298  0.         0.        ...  2.         0.00482   -0.33484  ]
 ...
 [-0.1579293  0.         0.        ...  2.         0.00482   -0.33484  ]
 [-0.1579293  0.         0.        ...  3.         0.00482    1.45442  ]
 [-0.1579293  0.         0.        ...  2.         0.00482   -0.33484  ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99999762e-01 2.66426696e-07 6.62169321e-13 5.21019339e-12
   9.18705324e-13]
  [9.99989271e-01 1.07326914e-05 8.36392533e-13 1.67398352e-11
   1.25730665e-12]
  [9.99976993e-01 2.29997513e-05 9.28381851e-12 8.71722000e-11
   1.21440462e-11]
  ...
  [9.99999046e-01 9.86938517e-07 8.19761468e-14 6.83999352e-13
   1.99479322e-13]
  [9.99964833e-01 3.52071329e-05 3.24875240e-12 3.81141507e-11
   3.44087606e-12]
  [9.99998808e-01 1.14835882e-06 7.06926515e-14 4.84722830e-13
   1.80239938e-13]]

 [[9.99999762e-01 2.61816552e-07 6.56391228e-13 5.19823204e-12
   9.11110922e-13]
  [9.99998927e-01 1.06083871e-06 3.05245954e-13 8.76492282e-12
   4.68294023e-13]
  [9.99936819e-01 6.32051451e-05 4.28381029e-12 2.05901754e-11
   7.07721121e-12]
  ...
  [9.99884009e-01 1.15960574e-04 2.88844578e-12 1.97225344e-11
   3.06548233e-12]
  [9.99972582e-01 2.74079484e-05 3.45531709e-13 9.63483308e-13
   6.70998793e-13]
  [9.99999881e-01 1.03243252e-07 6.62778141e-14 1.15830631e-12
   1.45584215e-13]]

 [[9.99956965e-01 4.29979700e-05 3.67588685e-12 1.29828856e-10
   4.95807475e-12]
  [9.99998212e-01 1.76483127e-06 7.49110897e-13 1.46172605e-11
   9.14497536e-13]
  [9.99980569e-01 1.94426029e-05 8.52396875e-13 6.77492437e-12
   1.25221242e-12]
  ...
  [9.99996781e-01 3.22569895e-06 7.71339440e-14 3.56981615e-13
   2.15089109e-13]
  [9.99998689e-01 1.27267344e-06 1.30241651e-12 3.66873684e-11
   1.99161521e-12]
  [9.99999881e-01 1.60033068e-07 6.25693887e-14 1.17205388e-12
   1.20249622e-13]]

 ...

 [[9.99902248e-01 9.77387026e-05 4.79019602e-12 2.18694840e-10
   5.85357587e-12]
  [9.99999642e-01 3.59226078e-07 9.12782328e-13 3.30485431e-11
   8.48461709e-13]
  [9.88926291e-01 1.10737113e-02 1.57255754e-11 6.46155005e-11
   2.52541824e-11]
  ...
  [9.99864817e-01 1.35223134e-04 9.43159830e-13 3.19938303e-12
   1.42999599e-12]
  [9.99950528e-01 4.94281121e-05 4.43789509e-13 1.01068611e-12
   1.07068640e-12]
  [9.99999881e-01 6.01104020e-08 8.53830149e-14 2.38288144e-12
   1.63768426e-13]]

 [[9.99998093e-01 1.92569996e-06 1.02132289e-12 3.17971587e-11
   1.55211228e-12]
  [9.99999881e-01 6.78852174e-08 2.73515558e-13 2.25120200e-11
   2.81201738e-13]
  [9.99707878e-01 2.92097393e-04 1.56073570e-12 2.21407753e-11
   3.44216431e-12]
  ...
  [9.99997973e-01 2.01540979e-06 3.79806863e-13 4.12411121e-12
   6.55155563e-13]
  [9.99996066e-01 3.87696127e-06 8.17826059e-13 8.48088700e-12
   1.45136247e-12]
  [9.99986649e-01 1.33387493e-05 6.20321990e-13 5.12606364e-12
   1.00110274e-12]]

 [[9.99997973e-01 2.08092911e-06 6.82348926e-13 1.83667335e-11
   1.07759667e-12]
  [9.99999762e-01 1.98876407e-07 6.69272309e-13 4.29770906e-11
   6.47423901e-13]
  [9.99999285e-01 7.63294679e-07 8.28981862e-14 2.67101076e-12
   1.41856795e-13]
  ...
  [9.99238372e-01 7.61616800e-04 3.13623541e-12 9.87896657e-12
   6.14243031e-12]
  [9.99998808e-01 1.23685948e-06 1.55474361e-13 1.19565035e-12
   3.47881094e-13]
  [9.99999642e-01 4.02433471e-07 4.55506509e-13 9.00195890e-12
   7.14592285e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999976e-01 2.6642670e-07 6.6216932e-13 5.2101934e-12 9.1870532e-13]
 [9.9998927e-01 1.0732691e-05 8.3639253e-13 1.6739835e-11 1.2573067e-12]
 [9.9997699e-01 2.2999751e-05 9.2838185e-12 8.7172200e-11 1.2144046e-11]
 ...
 [9.9923837e-01 7.6161680e-04 3.1362354e-12 9.8789666e-12 6.1424303e-12]
 [9.9999881e-01 1.2368595e-06 1.5547436e-13 1.1956503e-12 3.4788109e-13]
 [9.9999964e-01 4.0243347e-07 4.5550651e-13 9.0019589e-12 7.1459229e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  1.881296252632141
tp :  83950.0
fp :  16050.0
tn :  383950.0
fn :  16050.0
accuracy :  0.9358000159263611
precision :  0.8395000100135803
recall :  0.8395000100135803
auc :  0.8990594148635864

y_eval {0: 83957, 1: 16043}
pred {0: 99993, 1: 7}
[INFO] confusion matrix for file 
[[83950     7     0     0     0]
 [16043     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[5429642    1395       0       0       0]
 [ 411105       4       0       0       0]
 [ 109692       5       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 200000-300000/439824 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.579293e-01  0.000000e+00  0.000000e+00 ...  3.000000e+00
   4.820000e-03  1.454420e+00]
 [-1.579293e-01  0.000000e+00  0.000000e+00 ...  4.000000e+00
   4.820000e-03 -2.335100e-01]
 [-1.579293e-01  0.000000e+00  0.000000e+00 ...  5.000000e+00
   4.820000e-03 -1.276130e+00]
 ...
 [ 6.306598e-01  0.000000e+00  0.000000e+00 ...  5.000000e+00
   4.820000e-03 -1.276130e+00]
 [ 6.306598e-01  0.000000e+00  0.000000e+00 ...  4.000000e+00
   4.820000e-03 -2.335100e-01]
 [ 6.306598e-01  0.000000e+00  0.000000e+00 ...  3.000000e+00
   4.820000e-03  1.454420e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99903202e-01 9.68116656e-05 4.77371961e-12 2.17856969e-10
   5.83524461e-12]
  [9.99999642e-01 3.59449160e-07 9.14193634e-13 3.30986939e-11
   8.49658505e-13]
  [9.99037385e-01 9.62645339e-04 1.94945297e-12 3.86867708e-12
   2.98980112e-12]
  ...
  [9.99999762e-01 1.90131672e-07 1.20344137e-13 1.99245329e-12
   2.31525601e-13]
  [1.00000000e+00 5.26131529e-08 1.17188580e-13 4.60032273e-12
   2.04830266e-13]
  [9.99927521e-01 7.24645870e-05 3.55457590e-12 4.09976983e-11
   5.69399389e-12]]

 [[9.99999166e-01 8.32065098e-07 3.17394142e-13 6.61603671e-12
   5.11087537e-13]
  [9.99999881e-01 1.72308162e-07 3.59904028e-13 4.44724466e-11
   3.76631262e-13]
  [9.99988437e-01 1.15405755e-05 6.39646973e-13 7.60237706e-12
   7.90321205e-13]
  ...
  [9.99954581e-01 4.54749097e-05 4.92022709e-13 2.31443727e-12
   9.90357427e-13]
  [9.99998689e-01 1.25319229e-06 2.61708867e-13 2.67891763e-12
   5.11871687e-13]
  [9.99999285e-01 6.80060623e-07 2.39030312e-13 3.71253505e-12
   4.46773586e-13]]

 [[9.99998093e-01 1.89188916e-06 1.00914112e-12 3.13118316e-11
   1.53597957e-12]
  [9.99999881e-01 7.46586508e-08 2.93701254e-14 3.40781656e-12
   3.60404625e-14]
  [9.99998331e-01 1.65450206e-06 7.85698275e-13 1.38366003e-11
   1.18387461e-12]
  ...
  [1.00000000e+00 4.53445601e-08 4.46563258e-14 9.22144631e-13
   9.73460204e-14]
  [9.99999881e-01 6.81821177e-08 1.16303655e-13 3.41432264e-12
   2.02025002e-13]
  [9.99999881e-01 1.78086125e-07 1.55038647e-13 5.02658028e-12
   2.78487059e-13]]

 ...

 [[9.99881387e-01 1.18606760e-04 6.05200438e-12 3.52481822e-10
   7.07603637e-12]
  [9.99999404e-01 6.19975197e-07 8.72163073e-13 3.53622270e-11
   7.08705230e-13]
  [9.99890327e-01 1.09695247e-04 7.15185018e-13 1.24270386e-12
   1.44136656e-12]
  ...
  [9.99999881e-01 7.43687210e-08 1.09337432e-13 2.73111156e-12
   2.01843208e-13]
  [9.99999285e-01 6.88572584e-07 5.73160063e-13 8.75319869e-12
   9.01201856e-13]
  [9.99964595e-01 3.54578551e-05 9.84926984e-13 5.90639560e-12
   1.29316653e-12]]

 [[9.97586608e-01 2.41333526e-03 7.42393855e-11 7.52684493e-09
   8.95788235e-11]
  [9.99999762e-01 2.48192322e-07 1.60406126e-13 8.57535831e-12
   1.81217034e-13]
  [9.99998093e-01 1.89849345e-06 4.24200876e-13 5.76538903e-12
   6.91560036e-13]
  ...
  [9.99984860e-01 1.51444501e-05 6.77921586e-13 2.93258300e-12
   1.35053470e-12]
  [1.00000000e+00 5.94407048e-08 5.82208367e-14 1.50918416e-12
   1.14976103e-13]
  [9.99508142e-01 4.91848914e-04 2.19713744e-11 4.18630630e-10
   3.14086153e-11]]

 [[9.99879837e-01 1.20152057e-04 5.45962277e-12 2.59479410e-10
   6.53351548e-12]
  [9.99999404e-01 5.73897580e-07 8.53426433e-13 2.57342481e-11
   9.58523408e-13]
  [9.99974847e-01 2.50982903e-05 1.11670384e-12 8.32243562e-12
   1.52611452e-12]
  ...
  [9.99999285e-01 6.65903599e-07 2.57170451e-13 4.13886850e-12
   3.98953575e-13]
  [9.99994278e-01 5.71442206e-06 5.44969452e-13 4.53686914e-12
   7.40637694e-13]
  [9.99999523e-01 4.50075220e-07 1.06236126e-13 1.37692917e-12
   2.44191088e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.99903202e-01 9.68116656e-05 4.77371961e-12 2.17856969e-10
  5.83524461e-12]
 [9.99999642e-01 3.59449160e-07 9.14193634e-13 3.30986939e-11
  8.49658505e-13]
 [9.99037385e-01 9.62645339e-04 1.94945297e-12 3.86867708e-12
  2.98980112e-12]
 ...
 [9.99999285e-01 6.65903599e-07 2.57170451e-13 4.13886850e-12
  3.98953575e-13]
 [9.99994278e-01 5.71442206e-06 5.44969452e-13 4.53686914e-12
  7.40637694e-13]
 [9.99999523e-01 4.50075220e-07 1.06236126e-13 1.37692917e-12
  2.44191088e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0014982788115739823
tp :  99982.0
fp :  18.0
tn :  399982.0
fn :  18.0
accuracy :  0.9999279975891113
precision :  0.9998199939727783
recall :  0.9998199939727783
auc :  0.9999748468399048

y_eval {0: 100000}
pred {0: 99982, 1: 18}
[INFO] confusion matrix for file 
[[99982    18     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[5529624    1413       0       0       0]
 [ 411105       4       0       0       0]
 [ 109692       5       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 300000-400000/439824 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 6.3065982e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 6.3065982e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 6.3065982e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 1.4192489e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.4192489e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.4192489e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99998212e-01 1.79704978e-06 7.45666820e-13 2.10875518e-11
   1.15004902e-12]
  [9.99998212e-01 1.79629933e-06 1.50554374e-13 2.52462461e-11
   2.01791668e-13]
  [9.99995589e-01 4.35704169e-06 5.69176217e-13 7.22657394e-12
   1.03938039e-12]
  ...
  [9.99935985e-01 6.40022408e-05 7.75242771e-13 5.80903901e-12
   1.55759997e-12]
  [9.99993563e-01 6.44458532e-06 5.68714889e-13 3.36496586e-12
   1.10550317e-12]
  [1.00000000e+00 3.17319540e-08 4.45873027e-14 1.53720168e-12
   8.47719112e-14]]

 [[9.99999762e-01 1.91265414e-07 6.14881952e-13 1.75467973e-11
   1.06496702e-12]
  [1.00000000e+00 1.29830369e-08 3.97929980e-14 7.15759179e-12
   4.83602077e-14]
  [9.99892712e-01 1.07312313e-04 4.68727054e-12 6.65915031e-11
   8.93275644e-12]
  ...
  [9.99943495e-01 5.64471447e-05 1.90145339e-12 1.16303425e-11
   2.13782074e-12]
  [9.99926805e-01 7.31714099e-05 1.14718478e-12 8.06314737e-12
   2.24709400e-12]
  [9.99999881e-01 1.12328003e-07 7.40130274e-14 1.17935533e-12
   1.61380810e-13]]

 [[9.99999762e-01 1.89869482e-07 6.13358051e-13 1.75070149e-11
   1.06206428e-12]
  [9.99998927e-01 1.06883067e-06 8.67000699e-14 5.29686277e-12
   1.22280685e-13]
  [9.99790847e-01 2.09125588e-04 9.45954946e-12 5.65472391e-11
   1.71719496e-11]
  ...
  [9.99827504e-01 1.72523854e-04 2.16069176e-12 6.75100644e-12
   2.81530094e-12]
  [9.87204790e-01 1.27951670e-02 1.23545809e-11 1.50504643e-11
   1.56832360e-11]
  [9.99986291e-01 1.37228826e-05 2.14219701e-13 6.83658046e-13
   5.48182268e-13]]

 ...

 [[9.99971986e-01 2.80558579e-05 3.31040750e-12 2.14094020e-10
   3.78871760e-12]
  [1.00000000e+00 1.29929951e-08 3.83999439e-14 1.88193315e-11
   4.49959250e-14]
  [9.99995351e-01 4.61662103e-06 7.89784145e-13 7.91734820e-12
   1.33075224e-12]
  ...
  [9.99990463e-01 9.51483526e-06 5.48360294e-13 2.54960744e-12
   1.22240531e-12]
  [9.99969959e-01 3.00455922e-05 1.27238172e-12 9.17617111e-12
   1.44888799e-12]
  [9.99997020e-01 2.94409710e-06 8.96864438e-14 5.45432677e-13
   2.28827618e-13]]

 [[9.99727190e-01 2.72745558e-04 8.33990082e-12 4.43632714e-10
   9.77500459e-12]
  [1.00000000e+00 1.91103631e-08 4.46796700e-14 7.65991437e-12
   5.58349448e-14]
  [9.99998927e-01 1.06009736e-06 3.82044277e-13 7.32646929e-12
   4.96193147e-13]
  ...
  [9.99999285e-01 7.61713807e-07 1.50129854e-13 1.59160283e-12
   3.14757253e-13]
  [9.99999166e-01 8.48892910e-07 6.66784770e-13 1.02521229e-11
   1.10803196e-12]
  [9.99953508e-01 4.64866316e-05 1.24897022e-12 7.78565667e-12
   1.50312434e-12]]

 [[9.99727547e-01 2.72441743e-04 8.33621453e-12 4.43423881e-10
   9.77144754e-12]
  [9.99999881e-01 1.03769977e-07 1.62829358e-13 1.16292895e-11
   1.86921713e-13]
  [9.99988794e-01 1.12122780e-05 5.53664645e-13 4.14111497e-12
   8.47587246e-13]
  ...
  [9.99990940e-01 9.10643939e-06 2.64708069e-12 3.79970500e-11
   3.97310960e-12]
  [9.99999642e-01 3.24672101e-07 9.75526761e-14 1.11935873e-12
   1.93879404e-13]
  [1.00000000e+00 2.71300813e-08 7.75283090e-14 2.89155895e-12
   1.48584229e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999821e-01 1.7970498e-06 7.4566682e-13 2.1087552e-11 1.1500490e-12]
 [9.9999821e-01 1.7962993e-06 1.5055437e-13 2.5246246e-11 2.0179167e-13]
 [9.9999559e-01 4.3570417e-06 5.6917622e-13 7.2265739e-12 1.0393804e-12]
 ...
 [9.9999094e-01 9.1064394e-06 2.6470807e-12 3.7997050e-11 3.9731096e-12]
 [9.9999964e-01 3.2467210e-07 9.7552676e-14 1.1193587e-12 1.9387940e-13]
 [1.0000000e+00 2.7130081e-08 7.7528309e-14 2.8915590e-12 1.4858423e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0018274879977107049
tp :  99964.0
fp :  36.0
tn :  399964.0
fn :  36.0
accuracy :  0.9998559951782227
precision :  0.9996399879455566
recall :  0.9996399879455566
auc :  0.9999998807907104

y_eval {0: 100000}
pred {0: 99964, 1: 36}
[INFO] confusion matrix for file 
[[99964    36     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[5629588    1449       0       0       0]
 [ 411105       4       0       0       0]
 [ 109692       5       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 400000-500000/439824 for LSTM
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-02_172943_122.log.part03_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1376 (0.2752%)
[INFO] ** orig:[0:99.9976%,2:0.002%,1:0.0004%]
[INFO] ** type:[0:99.9988%,1:0.001%,2:0.0002%]
[INFO] ** i/f_name:[2:99.9944%,3:0.0056%]
[INFO] ** i/f_dir:[1:99.9946%,0:0.0054%]
[INFO] ** src:[22:38.2234%,9:26.124%,7:18.075%,1:17.571%,14:0.0036%,21:0.0022%,2:0.0004%,11:0.0002%,10:0.0002%]
[INFO] ** dst:[21:43.4342%,10:20.913%,8:18.0748%,9:17.5708%,15:0.0056%,22:0.0006%,25:0.0004%,24:0.0002%,18:0.0002%,7:0.0002%]
[INFO] ** proto:[0:99.9936%,1:0.0056%,2:0.0008%]
[INFO] ** appi_name:[21:99.9934%,30:0.0056%,0:0.0004%,31:0.0002%,27:0.0002%,15:0.0002%]
[INFO] ** proxy_src_ip:[18:38.2234%,20:26.124%,13:18.075%,6:17.571%,17:0.0056%,14:0.0004%,11:0.0002%,10:0.0002%,7:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9934%,-33.760870000000004:0.0064%,0.9188299999999999:0.0002%]
[INFO] ** modbus_function_description:[7:49.997%,11:49.9964%,0:0.0064%,15:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1234%,1:20.9128%,5:18.0748%,4:17.5704%,2:17.3102%,0:0.0084%]
[INFO] ** service:[0.0048200000000000005:99.9936%,-211.73542999999998:0.0056%,-186.44547:0.0004%,-186.43601999999998:0.0002%,-202.75898:0.0002%]
[INFO] ** s_port:[1.45442:26.1238%,-0.32151:20.913%,-1.27613:18.0748%,-0.23351:17.5706%,-0.33484:17.3104%,-71.33197:0.0056%,-0.24151:0.0004%,-64.19493:0.0004%,-1.27347:0.0002%,-10.59042:0.0002%,11.862:0.0002%,1.47576:0.0002%,13.431270000000001:0.0002%]
[INFO] ** classification:[normal:94.9296%,Single Stage Single Point:5.0704%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7301897e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.7301897e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.7301897e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 ...
 [-1.0376850e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.0376850e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0376850e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99999285e-01 6.98195095e-07 2.76299654e-13 4.82375164e-12
   4.52877997e-13]
  [9.99999881e-01 1.11642578e-07 2.02309578e-13 1.85034071e-11
   2.03338214e-13]
  [9.99939322e-01 6.07068396e-05 2.20137775e-12 1.60912308e-11
   3.91477345e-12]
  ...
  [9.99999881e-01 1.33654751e-07 5.50549156e-14 9.14896848e-13
   1.23227871e-13]
  [9.99999285e-01 6.95597123e-07 6.27031847e-13 1.08245192e-11
   1.01719479e-12]
  [9.99998808e-01 1.14239265e-06 1.34810267e-13 1.91589496e-12
   2.25452320e-13]]

 [[9.99961019e-01 3.90064379e-05 2.99904524e-12 1.19889237e-10
   3.88890005e-12]
  [9.99999404e-01 6.42553346e-07 6.09539546e-13 1.92122516e-11
   6.89603593e-13]
  [9.99973416e-01 2.65865874e-05 9.32560995e-13 7.39500388e-12
   1.58519042e-12]
  ...
  [9.99985695e-01 1.43103616e-05 1.18316208e-12 1.07194661e-11
   1.39375729e-12]
  [9.99999166e-01 8.50220829e-07 5.31148781e-14 6.28265994e-13
   1.30299539e-13]
  [9.99999881e-01 1.08863105e-07 1.54443624e-13 3.89510169e-12
   2.82922232e-13]]

 [[9.99999285e-01 7.01429940e-07 2.76875202e-13 4.83191048e-12
   4.53817919e-13]
  [9.99999523e-01 4.97539759e-07 6.92185241e-13 2.82229812e-11
   6.78578396e-13]
  [9.99999285e-01 6.85587850e-07 1.28614594e-13 3.12685858e-12
   2.10808774e-13]
  ...
  [9.99999881e-01 1.40532862e-07 1.77753686e-13 3.96999404e-12
   3.10995506e-13]
  [9.99998331e-01 1.63778759e-06 3.17859725e-13 3.63985014e-12
   4.84256895e-13]
  [9.99640703e-01 3.59312136e-04 3.58818964e-12 1.33908917e-11
   4.54500717e-12]]

 ...

 [[9.99997616e-01 2.41024554e-06 7.84151173e-13 2.06923749e-11
   1.21137063e-12]
  [9.99999881e-01 1.19302243e-07 4.25584210e-13 2.88832448e-11
   4.41247164e-13]
  [9.99981999e-01 1.79562703e-05 2.35794430e-13 2.97061399e-12
   4.80218513e-13]
  ...
  [9.99999285e-01 6.98195095e-07 4.03623234e-13 5.30913377e-12
   6.51179739e-13]
  [9.99999881e-01 1.17301852e-07 6.70299184e-14 1.39925886e-12
   1.32460910e-13]
  [9.99997616e-01 2.32757748e-06 8.93457508e-13 1.07320732e-11
   1.44774286e-12]]

 [[9.99997616e-01 2.40628378e-06 7.81330946e-13 2.06017980e-11
   1.20767719e-12]
  [9.99999881e-01 1.19731268e-07 4.27210784e-13 2.89317095e-11
   4.42851674e-13]
  [9.99981999e-01 1.80559873e-05 2.35912283e-13 2.96697888e-12
   4.80512548e-13]
  ...
  [9.99999523e-01 4.63889421e-07 5.96098095e-13 1.11961967e-11
   9.10985588e-13]
  [9.99906063e-01 9.39673264e-05 1.30472499e-12 5.74665619e-12
   1.79054254e-12]
  [9.99963284e-01 3.67080902e-05 4.26266498e-13 1.19988221e-12
   9.26875330e-13]]

 [[9.93569016e-01 6.43090811e-03 1.76474807e-10 1.83404190e-08
   2.21297508e-10]
  [9.99999523e-01 4.46588501e-07 2.36703398e-13 8.35481510e-12
   2.87222421e-13]
  [9.99935389e-01 6.46619155e-05 3.43866862e-12 6.21938751e-11
   6.07135045e-12]
  ...
  [9.99767005e-01 2.33034967e-04 5.38205591e-12 4.22672349e-11
   5.77064568e-12]
  [9.99999046e-01 9.19669958e-07 3.34582622e-14 2.78012856e-13
   1.00408438e-13]
  [9.99999881e-01 6.19546654e-08 9.99733879e-14 3.08976521e-12
   1.87810135e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999928e-01 6.9819509e-07 2.7629965e-13 4.8237516e-12 4.5287800e-13]
 [9.9999988e-01 1.1164258e-07 2.0230958e-13 1.8503407e-11 2.0333821e-13]
 [9.9993932e-01 6.0706840e-05 2.2013778e-12 1.6091231e-11 3.9147735e-12]
 ...
 [9.9976701e-01 2.3303497e-04 5.3820559e-12 4.2267235e-11 5.7706457e-12]
 [9.9999905e-01 9.1966996e-07 3.3458262e-14 2.7801286e-13 1.0040844e-13]
 [9.9999988e-01 6.1954665e-08 9.9973388e-14 3.0897652e-12 1.8781014e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0007380609586834908
tp :  99998.0
fp :  2.0
tn :  399998.0
fn :  2.0
accuracy :  0.9999920129776001
precision :  0.9999799728393555
recall :  0.9999799728393555
auc :  1.0

y_eval {0: 100000}
pred {0: 99998, 1: 2}
[INFO] confusion matrix for file 
[[99998     2     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[5729586    1451       0       0       0]
 [ 411105       4       0       0       0]
 [ 109692       5       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.037685    0.          0.         ...  4.          0.00482
  -0.23351   ]
 [-1.037685    0.          0.         ...  3.          0.00482
   1.45442   ]
 [-1.037685    0.          0.         ...  2.          0.00482
  -0.33484   ]
 ...
 [-0.34771708  0.          0.         ...  4.          0.00482
  -0.23351   ]
 [-0.34771708  0.          0.         ...  1.          0.00482
  -0.32151   ]
 [-0.34771708  0.          0.         ...  1.          0.00482
  -0.32151   ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.9999976e-01 2.9265493e-07 6.9523391e-13 5.3242662e-12 9.6013030e-13]
  [9.9999976e-01 2.5896156e-07 2.2061083e-13 7.4746260e-12 3.1170628e-13]
  [9.9995863e-01 4.1352665e-05 3.5091346e-12 1.8027586e-11 5.5342120e-12]
  ...
  [1.0000000e+00 1.2728232e-08 3.3689980e-14 1.1382016e-12 7.0441035e-14]
  [9.9999976e-01 2.3478844e-07 3.9448788e-13 8.7859537e-12 5.8020868e-13]
  [9.9999988e-01 1.1967522e-07 6.6956572e-14 1.3526691e-12 1.3426615e-13]]

 [[9.9999928e-01 6.5616825e-07 2.6611647e-13 5.2924210e-12 4.3734488e-13]
  [9.9999988e-01 6.2276683e-08 1.6432633e-13 2.4665504e-11 1.6612545e-13]
  [9.9996924e-01 3.0728293e-05 9.8186108e-13 9.2238769e-12 1.4319850e-12]
  ...
  [9.9997377e-01 2.6193587e-05 3.3805508e-12 6.0549912e-11 4.0463752e-12]
  [9.9999940e-01 5.4379797e-07 7.8662235e-14 9.1810934e-13 1.7558254e-13]
  [9.9999988e-01 1.3261236e-07 1.1540055e-13 2.8098045e-12 2.4052825e-13]]

 [[9.9993312e-01 6.6907538e-05 3.8858335e-12 1.6802881e-10 4.8766421e-12]
  [9.9999964e-01 3.0715776e-07 9.1781541e-13 3.4184808e-11 8.7623843e-13]
  [9.9975687e-01 2.4311763e-04 5.0379574e-13 2.0269229e-12 8.9761803e-13]
  ...
  [9.9998927e-01 1.0742911e-05 6.1460114e-13 3.3525873e-12 1.0108602e-12]
  [9.9996734e-01 3.2637527e-05 7.6849329e-13 2.1689263e-12 1.6803632e-12]
  [9.9974602e-01 2.5391806e-04 4.4377856e-12 2.5512863e-11 5.2168556e-12]]

 ...

 [[9.9994242e-01 5.7525613e-05 4.0030236e-12 1.7971925e-10 5.0038320e-12]
  [9.9999702e-01 2.9404578e-06 2.5301399e-12 6.0406895e-11 2.4627767e-12]
  [9.9990916e-01 9.0847432e-05 2.1411995e-12 9.3849329e-12 2.5277085e-12]
  ...
  [9.9999976e-01 2.8116287e-07 1.4806590e-13 2.7447831e-12 2.7023620e-13]
  [9.9997330e-01 2.6657191e-05 1.6224848e-12 2.3847970e-11 2.7124336e-12]
  [9.9999404e-01 5.9665485e-06 5.7743654e-13 3.4107749e-12 1.1351011e-12]]

 [[9.9999762e-01 2.4009153e-06 1.0161150e-12 3.5238951e-11 1.4947194e-12]
  [1.0000000e+00 3.6821508e-08 3.9982896e-14 4.6912170e-12 4.3896459e-14]
  [9.9998295e-01 1.7015871e-05 1.7146535e-12 1.9198384e-11 2.2927626e-12]
  ...
  [9.9999464e-01 5.3246258e-06 1.1305147e-12 1.8946584e-11 1.2003342e-12]
  [9.9999702e-01 3.0258288e-06 7.5899309e-14 6.2937172e-13 1.8959624e-13]
  [9.9999893e-01 1.0518135e-06 6.3003351e-13 1.2805146e-11 1.1238248e-12]]

 [[9.9992979e-01 7.0238661e-05 1.1488638e-11 1.0109925e-09 1.1496463e-11]
  [9.9999964e-01 3.3914193e-07 6.4522823e-13 3.2799801e-11 5.0992522e-13]
  [9.9995172e-01 4.8331542e-05 4.3958121e-13 1.7471872e-12 7.2254952e-13]
  ...
  [9.9935728e-01 6.4269808e-04 5.8113935e-12 2.7041024e-11 6.3487288e-12]
  [9.9973243e-01 2.6755067e-04 1.5282202e-12 5.2245118e-12 3.2270146e-12]
  [9.9999535e-01 4.6890091e-06 6.1260003e-13 4.3373144e-12 1.1893753e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999976e-01 2.9265493e-07 6.9523391e-13 5.3242662e-12 9.6013030e-13]
 [9.9999976e-01 2.5896156e-07 2.2061083e-13 7.4746260e-12 3.1170628e-13]
 [9.9995863e-01 4.1352665e-05 3.5091346e-12 1.8027586e-11 5.5342120e-12]
 ...
 [9.9935728e-01 6.4269808e-04 5.8113935e-12 2.7041024e-11 6.3487288e-12]
 [9.9973243e-01 2.6755067e-04 1.5282202e-12 5.2245118e-12 3.2270146e-12]
 [9.9999535e-01 4.6890091e-06 6.1260003e-13 4.3373144e-12 1.1893753e-12]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0009648918998427689
tp :  99989.0
fp :  11.0
tn :  399989.0
fn :  11.0
accuracy :  0.9999560713768005
precision :  0.9998900294303894
recall :  0.9998900294303894
auc :  0.9999873638153076

y_eval {0: 100000}
pred {0: 99989, 1: 11}
[INFO] confusion matrix for file 
[[99989    11     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[5829575    1462       0       0       0]
 [ 411105       4       0       0       0]
 [ 109692       5       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-0.34771708  0.          0.         ...  3.          0.00482
   1.45442   ]
 [-0.34771708  0.          0.         ...  3.          0.00482
   1.45442   ]
 [-0.34771708  0.          0.         ...  2.          0.00482
  -0.33484   ]
 ...
 [ 0.34478754  0.          0.         ...  4.          0.00482
  -0.23351   ]
 [ 0.34478754  0.          0.         ...  1.          0.00482
  -0.32151   ]
 [ 0.34478754  0.          0.         ...  3.          0.00482
   1.45442   ]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99960065e-01 3.99428754e-05 3.81816150e-12 1.38720688e-10
   5.22150682e-12]
  [9.99999166e-01 7.79810023e-07 4.73658818e-13 1.31294827e-11
   5.62964605e-13]
  [9.99989986e-01 1.00059324e-05 4.99138925e-13 4.53501559e-12
   8.34091151e-13]
  ...
  [9.99999881e-01 1.02175591e-07 1.15593096e-13 2.82747567e-12
   2.01514695e-13]
  [9.99996066e-01 3.99112014e-06 6.88918974e-13 1.74733891e-11
   7.98629717e-13]
  [9.99953628e-01 4.63507786e-05 9.03148162e-13 7.57227180e-12
   1.71056908e-12]]

 [[9.99999166e-01 8.15541227e-07 3.68034108e-13 8.84172596e-12
   5.93000855e-13]
  [9.99999762e-01 2.68879432e-07 7.72443470e-13 5.93617447e-11
   7.47716017e-13]
  [9.99997854e-01 2.11541283e-06 9.91202969e-14 2.09005339e-12
   1.73698932e-13]
  ...
  [9.99997616e-01 2.41973203e-06 1.76892192e-13 1.16164890e-12
   3.99560620e-13]
  [9.99999285e-01 7.13121665e-07 2.43994088e-13 3.01720498e-12
   4.14675211e-13]
  [9.99569118e-01 4.30885557e-04 4.55872015e-12 4.06443733e-11
   8.43584490e-12]]

 [[9.99930501e-01 6.94506743e-05 1.14749373e-11 1.01239417e-09
   1.14743241e-11]
  [9.99999762e-01 2.83996542e-07 3.76801536e-13 2.45900626e-11
   3.10955688e-13]
  [9.99610007e-01 3.89984925e-04 1.41938284e-12 3.25494796e-12
   1.94590329e-12]
  ...
  [9.99997973e-01 2.04018420e-06 3.51124566e-13 3.53576413e-12
   5.82349598e-13]
  [9.99996781e-01 3.17215972e-06 4.90562885e-13 3.59837225e-12
   9.35699001e-13]
  [9.99996305e-01 3.72233103e-06 2.75431696e-13 2.52459447e-12
   4.74700303e-13]]

 ...

 [[9.99997139e-01 2.84254406e-06 1.42159635e-12 4.92171755e-11
   2.06079468e-12]
  [1.00000000e+00 6.04963812e-09 2.38129811e-14 5.86708113e-12
   2.55293325e-14]
  [9.99808133e-01 1.91835294e-04 2.86396462e-11 5.27900557e-10
   4.41626041e-11]
  ...
  [9.98523653e-01 1.47641811e-03 4.12736685e-11 5.20471111e-10
   5.52729529e-11]
  [9.99998689e-01 1.35006167e-06 3.14464844e-13 2.61516394e-12
   6.14357306e-13]
  [1.00000000e+00 1.95688887e-08 5.54482133e-14 2.13406701e-12
   1.02123855e-13]]

 [[9.97763395e-01 2.23662378e-03 7.69949798e-11 8.24529955e-09
   9.36745959e-11]
  [9.99999881e-01 8.99007162e-08 3.07551158e-13 1.45018997e-11
   3.24949052e-13]
  [9.99871492e-01 1.28449101e-04 9.06214340e-13 3.84332236e-12
   1.29723576e-12]
  ...
  [9.99999642e-01 3.13281646e-07 1.00873038e-13 1.44267660e-12
   1.60881047e-13]
  [9.99998927e-01 1.12031069e-06 1.30823968e-13 2.10930275e-12
   2.31123470e-13]
  [9.99997377e-01 2.66512347e-06 2.40601077e-13 1.89132651e-12
   5.50203709e-13]]

 [[9.99998093e-01 1.89770594e-06 6.49633288e-13 1.76111088e-11
   1.02883067e-12]
  [9.99999881e-01 1.17941120e-07 4.41901588e-13 2.89113004e-11
   4.61835160e-13]
  [9.96759355e-01 3.24064819e-03 5.67435118e-12 7.05043454e-11
   1.26653731e-11]
  ...
  [1.00000000e+00 3.84825469e-08 9.69550368e-14 4.43042044e-12
   1.69011493e-13]
  [9.99999762e-01 2.04433135e-07 4.08997787e-13 9.86127586e-12
   5.62754541e-13]
  [9.99999523e-01 5.26183783e-07 1.45838745e-13 2.52604751e-12
   2.55855368e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9996006e-01 3.9942875e-05 3.8181615e-12 1.3872069e-10 5.2215068e-12]
 [9.9999917e-01 7.7981002e-07 4.7365882e-13 1.3129483e-11 5.6296461e-13]
 [9.9998999e-01 1.0005932e-05 4.9913892e-13 4.5350156e-12 8.3409115e-13]
 ...
 [1.0000000e+00 3.8482547e-08 9.6955037e-14 4.4304204e-12 1.6901149e-13]
 [9.9999976e-01 2.0443314e-07 4.0899779e-13 9.8612759e-12 5.6275454e-13]
 [9.9999952e-01 5.2618378e-07 1.4583874e-13 2.5260475e-12 2.5585537e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0009845298800617457
tp :  99990.0
fp :  10.0
tn :  399990.0
fn :  10.0
accuracy :  0.9999600052833557
precision :  0.9998999834060669
recall :  0.9998999834060669
auc :  0.999993622303009

y_eval {0: 100000}
pred {0: 99990, 1: 10}
[INFO] confusion matrix for file 
[[99990    10     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[5929565    1472       0       0       0]
 [ 411105       4       0       0       0]
 [ 109692       5       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4478754e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 3.4478754e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4478754e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [ 1.0398288e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0398288e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0398288e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99976516e-01 2.35311109e-05 2.56606173e-12 8.85655230e-11
   3.48410059e-12]
  [9.99999881e-01 1.45422035e-07 1.86235941e-13 1.11508493e-11
   2.07144740e-13]
  [9.99986649e-01 1.33126205e-05 9.03469140e-13 1.66039474e-11
   1.27936539e-12]
  ...
  [1.00000000e+00 4.11213392e-08 7.64359008e-14 3.13949409e-12
   1.52167870e-13]
  [9.99999642e-01 3.78313814e-07 3.32845947e-13 8.14435932e-12
   5.53757181e-13]
  [9.99897242e-01 1.02785736e-04 9.37716311e-12 1.54791915e-10
   1.46910244e-11]]

 [[9.99896526e-01 1.03447885e-04 5.47314277e-12 2.67948469e-10
   6.61472700e-12]
  [9.99999523e-01 4.49444713e-07 7.61787226e-13 2.54741037e-11
   8.63145601e-13]
  [9.99984622e-01 1.53623096e-05 8.32313114e-13 8.21823252e-12
   1.13260334e-12]
  ...
  [9.99999881e-01 8.92433150e-08 8.34923493e-14 2.01645146e-12
   1.41479127e-13]
  [9.99999881e-01 1.39483376e-07 9.71125239e-14 2.69326597e-12
   1.61745658e-13]
  [9.99641538e-01 3.58467019e-04 9.75044524e-12 8.56740304e-11
   1.75858009e-11]]

 [[9.99998093e-01 1.89680316e-06 6.44526153e-13 1.74507440e-11
   1.02205169e-12]
  [9.99999881e-01 1.18745255e-07 4.45579879e-13 2.90245102e-11
   4.65438723e-13]
  [9.96679783e-01 3.32025578e-03 5.73076959e-12 7.09224832e-11
   1.27894726e-11]
  ...
  [1.00000000e+00 5.84069824e-08 1.16278162e-13 3.24255835e-12
   2.11856140e-13]
  [9.99988675e-01 1.12793605e-05 6.25566602e-13 9.86812802e-12
   9.32431216e-13]
  [9.99998927e-01 1.07034543e-06 1.46298907e-13 1.24659701e-12
   3.02178096e-13]]

 ...

 [[9.99934196e-01 6.58212593e-05 1.15127968e-11 1.06000286e-09
   1.12965375e-11]
  [9.99999881e-01 1.49769463e-07 4.15180395e-13 2.60714991e-11
   3.63035475e-13]
  [9.99530196e-01 4.69820370e-04 8.03469541e-13 1.28043377e-12
   1.62381491e-12]
  ...
  [9.98213887e-01 1.78618450e-03 7.42897063e-12 1.81357186e-11
   9.08899778e-12]
  [9.99991417e-01 8.54360769e-06 1.58191087e-13 5.25770562e-13
   4.53725192e-13]
  [9.99992013e-01 8.02510931e-06 1.19992124e-12 1.74503380e-11
   2.18307056e-12]]

 [[9.99896288e-01 1.03721693e-04 5.70189078e-12 2.68025047e-10
   7.24201341e-12]
  [9.99999881e-01 1.55465528e-07 1.43270297e-13 8.43079252e-12
   1.68122813e-13]
  [9.99977231e-01 2.28209901e-05 1.13428993e-12 9.26098781e-12
   1.50996750e-12]
  ...
  [9.99898314e-01 1.01680045e-04 2.94253727e-12 2.73772498e-11
   3.33796510e-12]
  [9.99805748e-01 1.94306136e-04 1.50253258e-12 6.63513905e-12
   3.24783278e-12]
  [9.99996543e-01 3.45202307e-06 5.38557914e-13 4.13397311e-12
   1.03813713e-12]]

 [[9.99746382e-01 2.53628445e-04 8.02816494e-12 4.17785861e-10
   9.50334516e-12]
  [9.99999881e-01 8.69431886e-08 3.42417501e-13 1.62181414e-11
   3.48251240e-13]
  [9.99453366e-01 5.46620227e-04 1.13931445e-12 4.64322938e-12
   1.98238322e-12]
  ...
  [9.99997735e-01 2.23719098e-06 9.58795624e-14 5.21637475e-13
   2.63462077e-13]
  [9.99999881e-01 6.61777193e-08 1.08467732e-13 3.88096673e-12
   2.07349098e-13]
  [9.99999285e-01 7.57634268e-07 3.92168042e-13 8.17861837e-12
   6.31943716e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.99976516e-01 2.35311109e-05 2.56606173e-12 8.85655230e-11
  3.48410059e-12]
 [9.99999881e-01 1.45422035e-07 1.86235941e-13 1.11508493e-11
  2.07144740e-13]
 [9.99986649e-01 1.33126205e-05 9.03469140e-13 1.66039474e-11
  1.27936539e-12]
 ...
 [9.99997735e-01 2.23719098e-06 9.58795624e-14 5.21637475e-13
  2.63462077e-13]
 [9.99999881e-01 6.61777193e-08 1.08467732e-13 3.88096673e-12
  2.07349098e-13]
 [9.99999285e-01 7.57634268e-07 3.92168042e-13 8.17861837e-12
  6.31943716e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.00421383289732039
tp :  99954.0
fp :  46.0
tn :  399954.0
fn :  46.0
accuracy :  0.9998159408569336
precision :  0.9995399713516235
recall :  0.9995399713516235
auc :  0.9998546242713928

y_eval {0: 100000}
pred {0: 99954, 1: 46}
[INFO] confusion matrix for file 
[[99954    46     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[6029519    1518       0       0       0]
 [ 411105       4       0       0       0]
 [ 109692       5       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0398288e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.0398288e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.0398288e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 ...
 [ 1.7323334e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.7323334e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.7323334e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99999166e-01 7.96795121e-07 4.40749732e-13 1.09803720e-11
   6.60636151e-13]
  [9.99999881e-01 1.64540253e-07 4.81051234e-13 4.79735938e-11
   4.89479280e-13]
  [9.99752700e-01 2.47325079e-04 4.97246862e-12 1.57448665e-10
   8.28109976e-12]
  ...
  [9.99985695e-01 1.42580375e-05 9.06098330e-13 7.39076595e-12
   1.10402583e-12]
  [9.99999046e-01 9.36682568e-07 6.97963416e-14 8.33869594e-13
   1.63014120e-13]
  [9.99998212e-01 1.79668132e-06 2.06412388e-13 1.66031501e-12
   3.37987722e-13]]

 [[9.99869227e-01 1.30755216e-04 5.71717847e-12 2.76531936e-10
   6.77831923e-12]
  [1.00000000e+00 2.26685941e-08 4.89995617e-14 9.26268263e-12
   6.10340026e-14]
  [9.99998808e-01 1.20169318e-06 3.80502514e-13 9.20664239e-12
   6.10681969e-13]
  ...
  [9.99997258e-01 2.70972737e-06 7.96766895e-13 1.70256222e-11
   1.24686123e-12]
  [9.99790251e-01 2.09754056e-04 3.08663793e-12 1.21700176e-11
   3.75113092e-12]
  [9.81578052e-01 1.84219629e-02 2.66416316e-11 1.13076666e-10
   5.44709694e-11]]

 [[9.99935269e-01 6.47028573e-05 1.14935440e-11 1.06295173e-09
   1.12628578e-11]
  [9.99999285e-01 7.00332407e-07 5.22770791e-13 2.83324093e-11
   4.19672137e-13]
  [9.99905944e-01 9.40945611e-05 1.40215162e-12 4.27143217e-12
   2.67182131e-12]
  ...
  [9.99985099e-01 1.48896825e-05 2.15267279e-12 2.51492663e-11
   3.50204588e-12]
  [9.99991298e-01 8.71765860e-06 6.35180819e-13 3.06919876e-12
   1.29632264e-12]
  [9.99919653e-01 8.03025105e-05 3.74836230e-12 5.46856622e-11
   5.32024598e-12]]

 ...

 [[9.99999881e-01 1.35274860e-07 3.78440850e-13 9.85601271e-12
   6.66150891e-13]
  [9.99999046e-01 9.06559194e-07 8.36651224e-13 3.36009276e-11
   9.09292552e-13]
  [9.99987841e-01 1.21846087e-05 1.41035632e-12 1.34876320e-11
   1.93780712e-12]
  ...
  [9.99999642e-01 3.96641553e-07 3.41814494e-13 5.44444871e-12
   6.09024875e-13]
  [9.99999881e-01 1.45836736e-07 1.17477263e-13 2.70794129e-12
   1.94788304e-13]
  [9.99981046e-01 1.88960585e-05 1.75850220e-12 2.13251812e-11
   2.83383646e-12]]

 [[9.99727786e-01 2.72181875e-04 8.39374924e-12 4.53929977e-10
   9.78390806e-12]
  [9.99999762e-01 2.39877011e-07 5.96089096e-13 2.95980358e-11
   6.73658774e-13]
  [9.99979496e-01 2.05383185e-05 7.37017760e-13 6.78807184e-12
   9.77860371e-13]
  ...
  [9.99990225e-01 9.76553838e-06 6.07852852e-13 3.32966814e-12
   1.13895482e-12]
  [9.99996901e-01 3.07365417e-06 8.65345664e-13 8.70323431e-12
   1.56875066e-12]
  [9.99969721e-01 3.02606804e-05 9.35147467e-13 5.73806237e-12
   1.14644644e-12]]

 [[9.99998808e-01 1.22519350e-06 9.15667498e-13 3.14429802e-11
   1.30866195e-12]
  [1.00000000e+00 5.19779775e-08 2.89459808e-13 3.63346957e-11
   2.87083969e-13]
  [9.99987483e-01 1.25306296e-05 1.00017732e-13 1.14347269e-12
   2.11443750e-13]
  ...
  [9.99956369e-01 4.36696901e-05 2.67852819e-12 3.61327634e-11
   4.54169254e-12]
  [9.99999404e-01 6.12093459e-07 1.53695375e-13 1.63578623e-12
   2.94040942e-13]
  [9.99999046e-01 9.08814172e-07 6.67474322e-13 9.85327792e-12
   1.11760872e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999917e-01 7.9679512e-07 4.4074973e-13 1.0980372e-11 6.6063615e-13]
 [9.9999988e-01 1.6454025e-07 4.8105123e-13 4.7973594e-11 4.8947928e-13]
 [9.9975270e-01 2.4732508e-04 4.9724686e-12 1.5744867e-10 8.2810998e-12]
 ...
 [9.9995637e-01 4.3669690e-05 2.6785282e-12 3.6132763e-11 4.5416925e-12]
 [9.9999940e-01 6.1209346e-07 1.5369538e-13 1.6357862e-12 2.9404094e-13]
 [9.9999905e-01 9.0881417e-07 6.6747432e-13 9.8532779e-12 1.1176087e-12]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  3.2303775698184967
tp :  74616.0
fp :  25384.0
tn :  374616.0
fn :  25384.0
accuracy :  0.8984646201133728
precision :  0.7461599707603455
recall :  0.7461599707603455
auc :  0.8404262661933899

y_eval {0: 74648, 1: 25352}
pred {0: 99968, 1: 32}
[INFO] confusion matrix for file 
[[74616    32     0     0     0]
 [25352     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[6104135    1550       0       0       0]
 [ 436457       4       0       0       0]
 [ 109692       5       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-02_172943_122.log.part04_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1377 (0.2754%)
[INFO] ** orig:[0:99.995%,2:0.005%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9944%,3:0.0056%]
[INFO] ** i/f_dir:[1:99.9944%,0:0.0056%]
[INFO] ** src:[22:38.203%,9:26.1368%,7:18.1014%,1:17.5508%,21:0.005%,3:0.0008%,15:0.0006%,14:0.0006%,4:0.0004%,2:0.0004%,8:0.0002%]
[INFO] ** dst:[21:43.4462%,10:20.893%,8:18.1012%,9:17.5504%,15:0.0056%,22:0.0016%,16:0.0008%,6:0.0006%,17:0.0004%,24:0.0002%]
[INFO] ** proto:[0:99.9938%,1:0.0056%,2:0.0006%]
[INFO] ** appi_name:[21:99.9926%,30:0.0056%,17:0.0008%,26:0.0004%,28:0.0002%,22:0.0002%,7:0.0002%]
[INFO] ** proxy_src_ip:[18:38.203%,20:26.1368%,13:18.1014%,6:17.5508%,17:0.0056%,1:0.0008%,16:0.0006%,21:0.0004%,14:0.0004%,0:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9926%,-33.760870000000004:0.0074%]
[INFO] ** modbus_function_description:[7:49.9972%,11:49.9954%,0:0.0074%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1358%,1:20.8928%,5:18.1008%,4:17.55%,2:17.31%,0:0.0106%]
[INFO] ** service:[0.0048200000000000005:99.9926%,-211.73542999999998:0.0056%,-205.44247:0.0008%,-211.08346:0.0004%,-211.09762999999998:0.0002%,-185.9872:0.0002%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:26.136%,-0.32151:20.893%,-1.27613:18.101%,-0.23351:17.5502%,-0.33484:17.31%,-71.33197:0.0056%,1.45709:0.0006%,-1.02014:0.0006%,-71.14798:0.0004%,-0.24151:0.0004%,-5.1466400000000005:0.0002%,-58.035180000000004:0.0002%,-1.2708:0.0002%,-71.14931:0.0002%,1.47576:0.0002%,-1.27347:0.0002%,-5.08665:0.0002%,-0.24950999999999998:0.0002%,2.05573:0.0002%,-43.76509:0.0002%,-58.032509999999995:0.0002%]
[INFO] ** classification:[normal:64.3482%,Single Stage Single Point:35.6518%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7331795e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-1.7331795e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.7331795e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [-1.0379097e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0379097e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-1.0379097e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 1 1 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99865055e-01 1.34979258e-04 1.18194187e-11 8.40274406e-10
   1.27163280e-11]
  [9.99999523e-01 5.26426675e-07 5.69618246e-13 2.85963805e-11
   4.89455752e-13]
  [9.99903202e-01 9.68474997e-05 8.01596962e-13 3.59169985e-12
   1.00057245e-12]
  ...
  [9.99992490e-01 7.45134912e-06 3.30899641e-13 2.58917041e-12
   6.98230807e-13]
  [9.99889970e-01 1.10010020e-04 9.80795089e-13 3.78436995e-12
   1.71366361e-12]
  [9.93676245e-01 6.32369099e-03 1.55768575e-11 3.41859319e-11
   1.93569657e-11]]

 [[9.99966264e-01 3.36970661e-05 2.82150323e-12 1.10241476e-10
   3.68880230e-12]
  [9.99998212e-01 1.72858824e-06 1.26541594e-12 2.38868040e-11
   1.41301781e-12]
  [9.99989390e-01 1.06403595e-05 7.56868418e-13 8.18751230e-12
   1.23370335e-12]
  ...
  [9.99988317e-01 1.16811216e-05 2.31137321e-13 8.80064088e-13
   5.19909257e-13]
  [9.99999881e-01 9.70063780e-08 1.13117144e-13 2.82342856e-12
   2.18494033e-13]
  [9.99999166e-01 8.76604247e-07 2.81305578e-13 5.15808143e-12
   4.60402983e-13]]

 [[9.99999285e-01 7.20227661e-07 2.80416369e-13 4.87594166e-12
   4.59494151e-13]
  [9.99998212e-01 1.84234477e-06 2.48680568e-12 1.91136995e-10
   2.36528982e-12]
  [9.99992609e-01 7.34825608e-06 1.05353382e-13 1.57589350e-12
   1.86663483e-13]
  ...
  [9.99795139e-01 2.04876764e-04 1.04514726e-12 2.82237124e-12
   1.61951225e-12]
  [9.99902368e-01 9.75975054e-05 7.99548633e-13 2.28047550e-12
   1.69649711e-12]
  [9.99999523e-01 4.94242613e-07 8.43264599e-14 9.98080308e-13
   2.08813530e-13]]

 ...

 [[9.99996305e-01 3.64134667e-06 1.31629885e-12 5.51479210e-11
   1.89709077e-12]
  [1.00000000e+00 1.66676877e-08 4.55172941e-14 7.90241830e-12
   4.85941413e-14]
  [9.99817431e-01 1.82607939e-04 4.56350669e-12 7.07472345e-11
   8.09011625e-12]
  ...
  [9.99999523e-01 4.86845124e-07 1.15417902e-13 1.84563714e-12
   2.21330224e-13]
  [9.99998093e-01 1.90911646e-06 6.06331500e-13 5.87561466e-12
   1.07497323e-12]
  [9.99999762e-01 1.82916224e-07 9.29348083e-14 1.77818860e-12
   1.67536978e-13]]

 [[9.99997020e-01 2.97999736e-06 1.33800295e-12 4.39032595e-11
   1.91048371e-12]
  [1.00000000e+00 9.58377822e-09 2.31880419e-14 5.14696098e-12
   2.55503779e-14]
  [9.99998212e-01 1.84358214e-06 6.73882608e-13 1.41874637e-11
   7.74035024e-13]
  ...
  [9.99946952e-01 5.31028782e-05 5.05990107e-13 1.56507403e-12
   1.06340468e-12]
  [9.99991655e-01 8.35200262e-06 9.97973405e-13 9.17007182e-12
   1.91143564e-12]
  [9.99998927e-01 1.04854450e-06 3.13705279e-13 3.06922803e-12
   5.80978950e-13]]

 [[9.99967456e-01 3.25207693e-05 3.28083025e-12 1.08720595e-10
   4.51108552e-12]
  [9.99996662e-01 3.31455226e-06 2.48079487e-12 5.41599404e-11
   2.28171301e-12]
  [9.99773324e-01 2.26643446e-04 3.49392607e-12 2.19586849e-11
   3.68877281e-12]
  ...
  [9.99997377e-01 2.62417257e-06 2.25509620e-13 1.62808536e-12
   4.42256312e-13]
  [9.99999762e-01 1.95360585e-07 1.11182161e-13 2.00738341e-12
   2.37688802e-13]
  [9.99999404e-01 5.86358567e-07 5.75825032e-13 9.88626282e-12
   9.28048111e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9986506e-01 1.3497926e-04 1.1819419e-11 8.4027441e-10 1.2716328e-11]
 [9.9999952e-01 5.2642667e-07 5.6961825e-13 2.8596380e-11 4.8945575e-13]
 [9.9990320e-01 9.6847500e-05 8.0159696e-13 3.5916999e-12 1.0005725e-12]
 ...
 [9.9999738e-01 2.6241726e-06 2.2550962e-13 1.6280854e-12 4.4225631e-13]
 [9.9999976e-01 1.9536058e-07 1.1118216e-13 2.0073834e-12 2.3768880e-13]
 [9.9999940e-01 5.8635857e-07 5.7582503e-13 9.8862628e-12 9.2804811e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  4.0324335998535155
tp :  64449.0
fp :  35551.0
tn :  364449.0
fn :  35551.0
accuracy :  0.8577969670295715
precision :  0.6444900035858154
recall :  0.6444900035858154
auc :  0.781473696231842

y_eval {0: 64457, 1: 35543}
pred {0: 99992, 1: 8}
[INFO] confusion matrix for file 
[[64449     8     0     0     0]
 [35543     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[6168584    1558       0       0       0]
 [ 472000       4       0       0       0]
 [ 109692       5       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0379097  0.         0.        ...  4.         0.00482   -0.23351  ]
 [-1.0379097  0.         0.        ...  3.         0.00482    1.45442  ]
 [-1.0379097  0.         0.        ...  2.         0.00482   -0.33484  ]
 ...
 [-0.3451776  0.         0.        ...  2.         0.00482   -0.33484  ]
 [-0.3451776  0.         0.        ...  3.         0.00482    1.45442  ]
 [-0.3451776  0.         0.        ...  1.         0.00482   -0.32151  ]] shape (100000, 16)
y_test [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [1 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99996305e-01 3.69504050e-06 1.33014964e-12 5.56226593e-11
   1.91521083e-12]
  [1.00000000e+00 1.17955139e-08 2.59373465e-14 5.13352902e-12
   2.81906727e-14]
  [9.99957085e-01 4.29223437e-05 4.11032580e-12 3.13016522e-11
   6.59938727e-12]
  ...
  [9.99976158e-01 2.38900884e-05 1.82812554e-12 2.54011690e-11
   3.07988943e-12]
  [9.99999642e-01 3.90420695e-07 6.57713020e-14 7.81028616e-13
   1.50699101e-13]
  [9.99999404e-01 5.47606930e-07 5.65323396e-13 1.00151701e-11
   9.17722495e-13]]

 [[9.99941230e-01 5.87233262e-05 3.68718380e-12 1.57192953e-10
   4.65661190e-12]
  [9.99998689e-01 1.35955179e-06 1.11455148e-12 2.31328724e-11
   1.24950571e-12]
  [9.99995828e-01 4.16961393e-06 4.26692752e-13 5.66595425e-12
   7.07774713e-13]
  ...
  [1.00000000e+00 1.34067415e-08 4.99461719e-14 2.00201921e-12
   9.92287036e-14]
  [9.99999404e-01 5.79560435e-07 2.72692920e-13 1.87305484e-11
   3.96725757e-13]
  [9.99994636e-01 5.37435199e-06 6.50429472e-13 4.40415239e-12
   1.24176960e-12]]

 [[9.99968290e-01 3.16942824e-05 3.24897422e-12 1.07054116e-10
   4.47559134e-12]
  [9.99996662e-01 3.33995627e-06 2.51286860e-12 5.47770440e-11
   2.30900975e-12]
  [9.99664307e-01 3.35725024e-04 1.61717070e-12 4.61838033e-12
   2.54801280e-12]
  ...
  [9.99999881e-01 1.19096718e-07 1.01576022e-13 2.55711229e-12
   2.17834485e-13]
  [9.99999881e-01 1.19659575e-07 1.19638796e-13 6.36236636e-12
   1.52737496e-13]
  [9.99994636e-01 5.36704283e-06 3.54740976e-13 1.89148718e-12
   6.71442502e-13]]

 ...

 [[9.99890566e-01 1.09372595e-04 1.20916185e-11 9.64405888e-10
   1.24360348e-11]
  [1.00000000e+00 2.77686336e-08 3.81094014e-14 6.76400385e-12
   4.19387357e-14]
  [9.99315500e-01 6.84512139e-04 2.05760062e-11 2.14780610e-10
   3.94739033e-11]
  ...
  [9.99981403e-01 1.85972731e-05 9.84432696e-13 2.51943987e-11
   1.52676201e-12]
  [9.98741686e-01 1.25837268e-03 3.84177022e-12 6.50336382e-12
   5.32273271e-12]
  [9.99983549e-01 1.64126195e-05 4.69436013e-13 1.66306704e-12
   1.12170885e-12]]

 [[9.99999166e-01 7.91753337e-07 4.13442365e-13 1.03429036e-11
   6.50044255e-13]
  [1.00000000e+00 1.86673876e-08 6.68826770e-14 2.09330261e-11
   6.93301685e-14]
  [9.99989271e-01 1.07557980e-05 3.32463061e-13 6.12184392e-12
   6.20344921e-13]
  ...
  [9.99998212e-01 1.82648796e-06 3.38168946e-13 4.35995380e-12
   5.13020887e-13]
  [9.99641657e-01 3.58386431e-04 2.71706312e-12 1.45315582e-11
   4.94185118e-12]
  [9.99999404e-01 5.57397698e-07 1.16280317e-13 1.34403502e-12
   2.03537572e-13]]

 [[9.99891520e-01 1.08450891e-04 1.20794590e-11 9.65200031e-10
   1.24172981e-11]
  [1.00000000e+00 1.66254601e-08 2.88732898e-14 5.98178364e-12
   3.22643455e-14]
  [9.99958158e-01 4.18071104e-05 1.52937884e-12 1.44888537e-11
   1.72042892e-12]
  ...
  [9.99999762e-01 2.47332508e-07 1.06416639e-13 1.41624429e-12
   2.43456351e-13]
  [1.00000000e+00 5.76349848e-08 9.85301454e-14 4.10076053e-12
   1.77059702e-13]
  [9.99997377e-01 2.61929949e-06 7.38339457e-13 6.66766121e-12
   1.28782575e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999630e-01 3.6950405e-06 1.3301496e-12 5.5622659e-11 1.9152108e-12]
 [1.0000000e+00 1.1795514e-08 2.5937347e-14 5.1335290e-12 2.8190673e-14]
 [9.9995708e-01 4.2922344e-05 4.1103258e-12 3.1301652e-11 6.5993873e-12]
 ...
 [9.9999976e-01 2.4733251e-07 1.0641664e-13 1.4162443e-12 2.4345635e-13]
 [1.0000000e+00 5.7634985e-08 9.8530145e-14 4.1007605e-12 1.7705970e-13]
 [9.9999738e-01 2.6192995e-06 7.3833946e-13 6.6676612e-12 1.2878257e-12]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  4.174280011749268
tp :  64576.0
fp :  35424.0
tn :  364576.0
fn :  35424.0
accuracy :  0.8583049178123474
precision :  0.6457599997520447
recall :  0.6457599997520447
auc :  0.7806676030158997

y_eval {0: 64588, 1: 35412}
pred {0: 99988, 1: 12}
[INFO] confusion matrix for file 
[[64576    12     0     0     0]
 [35412     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[6233160    1570       0       0       0]
 [ 507412       4       0       0       0]
 [ 109692       5       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4517759e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4517759e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-3.4517759e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 3.4755462e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4755462e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 3.4755462e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 1 0 ... 1 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.95462239e-01 4.53772489e-03 1.22529070e-10 1.26449073e-08
   1.51981455e-10]
  [9.99998689e-01 1.31100171e-06 5.33825967e-13 1.48317469e-11
   5.69298406e-13]
  [9.99998331e-01 1.63689288e-06 3.53213037e-13 5.35341259e-12
   6.33124250e-13]
  ...
  [9.99996662e-01 3.36361995e-06 3.12002160e-13 5.16170960e-12
   5.27502033e-13]
  [9.99816358e-01 1.83684358e-04 2.19127169e-12 7.57169414e-12
   2.75575613e-12]
  [9.99983788e-01 1.61904063e-05 4.58429573e-13 1.53296939e-12
   1.10020413e-12]]

 [[9.99922872e-01 7.71075720e-05 4.32864465e-12 1.93826372e-10
   5.35045662e-12]
  [9.99999166e-01 8.31002467e-07 8.86590497e-13 2.22258930e-11
   9.98293137e-13]
  [9.99923706e-01 7.63132994e-05 2.89783106e-12 2.18531374e-11
   3.28680594e-12]
  ...
  [9.99968886e-01 3.11416879e-05 3.06401779e-12 3.76107444e-11
   3.41923473e-12]
  [9.99999642e-01 4.09939332e-07 3.83920224e-14 4.94809001e-13
   9.92190203e-14]
  [9.99999404e-01 6.52456777e-07 4.06422102e-13 9.93101695e-12
   7.47245256e-13]]

 [[9.99892950e-01 1.07083441e-04 1.20612192e-11 9.66391300e-10
   1.23892346e-11]
  [9.99999642e-01 3.00413518e-07 6.03892533e-13 2.83099481e-11
   4.87616403e-13]
  [9.98026073e-01 1.97392632e-03 3.81224566e-12 6.23121043e-12
   5.38764606e-12]
  ...
  [9.99996662e-01 3.31057504e-06 1.38931821e-13 8.90771560e-13
   2.94907355e-13]
  [9.99932170e-01 6.78269571e-05 2.97650056e-12 2.90286909e-11
   5.76300813e-12]
  [9.99997735e-01 2.27457235e-06 4.10665100e-13 3.16299396e-12
   7.65034412e-13]]

 ...

 [[9.99999166e-01 8.91926675e-07 3.39915270e-13 7.15590694e-12
   5.42323836e-13]
  [9.99999881e-01 1.00486417e-07 1.39263912e-13 4.52490163e-11
   1.61351875e-13]
  [9.99893546e-01 1.06493637e-04 8.62993704e-12 1.01783158e-10
   1.38162953e-11]
  ...
  [9.99785125e-01 2.14893473e-04 4.07758332e-12 2.16861060e-11
   7.93318536e-12]
  [9.99999881e-01 9.53955634e-08 6.75966241e-14 1.07720419e-12
   1.47216617e-13]
  [9.99999285e-01 6.97805660e-07 3.43176415e-13 7.76750192e-12
   4.75008758e-13]]

 [[9.99950409e-01 4.96315915e-05 1.12298226e-11 1.10055942e-09
   1.08468477e-11]
  [9.99999881e-01 1.33950408e-07 1.37382293e-13 1.50304300e-11
   1.25782306e-13]
  [9.99995708e-01 4.24678228e-06 4.88505341e-13 6.19658621e-12
   8.98502301e-13]
  ...
  [1.00000000e+00 3.26386029e-08 6.66716302e-14 2.40634856e-12
   1.21975672e-13]
  [9.99998808e-01 1.13544456e-06 7.30349917e-13 9.55256360e-12
   1.18743459e-12]
  [9.99996305e-01 3.72894306e-06 3.51682306e-13 2.87637730e-12
   4.65780734e-13]]

 [[9.99998093e-01 1.96322230e-06 8.35170908e-13 2.41486050e-11
   1.27185469e-12]
  [1.00000000e+00 1.23328370e-08 4.09768384e-14 1.04274124e-11
   4.32806595e-14]
  [9.99998212e-01 1.78268920e-06 3.53033846e-13 8.55637609e-12
   5.90458617e-13]
  ...
  [9.99999881e-01 6.56607142e-08 1.11405277e-13 3.37498237e-12
   2.06400530e-13]
  [9.99999881e-01 8.34693523e-08 1.05452458e-13 4.88868408e-12
   1.75160491e-13]
  [9.99994993e-01 5.04394939e-06 6.97105514e-13 4.31323163e-12
   1.29919870e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.95462239e-01 4.53772489e-03 1.22529070e-10 1.26449073e-08
  1.51981455e-10]
 [9.99998689e-01 1.31100171e-06 5.33825967e-13 1.48317469e-11
  5.69298406e-13]
 [9.99998331e-01 1.63689288e-06 3.53213037e-13 5.35341259e-12
  6.33124250e-13]
 ...
 [9.99999881e-01 6.56607142e-08 1.11405277e-13 3.37498237e-12
  2.06400530e-13]
 [9.99999881e-01 8.34693523e-08 1.05452458e-13 4.88868408e-12
  1.75160491e-13]
 [9.99994993e-01 5.04394939e-06 6.97105514e-13 4.31323163e-12
  1.29919870e-12]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  4.342442311859131
tp :  64251.0
fp :  35749.0
tn :  364251.0
fn :  35749.0
accuracy :  0.8570050001144409
precision :  0.6425099968910217
recall :  0.6425099968910217
auc :  0.7773746848106384

y_eval {0: 64276, 1: 35724}
pred {0: 99975, 1: 25}
[INFO] confusion matrix for file 
[[64251    25     0     0     0]
 [35724     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[6297411    1595       0       0       0]
 [ 543136       4       0       0       0]
 [ 109692       5       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4755462e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4755462e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 3.4755462e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 ...
 [ 1.0377493e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.0377493e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0377493e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]] shape (100000, 16)
y_test [[0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [1 1 1 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.9999917e-01 8.0892613e-07 3.2704799e-13 7.3271693e-12 5.3171871e-13]
  [9.9999964e-01 3.7160279e-07 1.1343305e-12 1.0769215e-10 1.1314307e-12]
  [9.9997687e-01 2.3118720e-05 2.3579728e-13 1.7352287e-12 3.7710275e-13]
  ...
  [9.9999988e-01 1.5084022e-07 1.9869420e-13 5.3127333e-12 3.8519090e-13]
  [9.9999988e-01 9.9662984e-08 8.8935979e-14 2.4613373e-12 1.5986493e-13]
  [9.9999750e-01 2.4517992e-06 1.1328189e-12 1.6770111e-11 1.8501166e-12]]

 [[9.9999738e-01 2.6214611e-06 1.3471864e-12 4.5477847e-11 1.9743957e-12]
  [1.0000000e+00 5.3764229e-09 2.2510529e-14 5.5526590e-12 2.4203118e-14]
  [9.9998260e-01 1.7407690e-05 3.3245214e-12 3.7349901e-11 5.2760153e-12]
  ...
  [9.9980527e-01 1.9474256e-04 5.7726172e-12 1.2318152e-10 8.9117082e-12]
  [9.9999952e-01 5.2137096e-07 1.0313662e-13 1.0601412e-12 2.3507468e-13]
  [9.9999940e-01 5.7661151e-07 7.9083956e-13 2.0549090e-11 1.1779789e-12]]

 [[9.9999738e-01 2.6150090e-06 1.3448271e-12 4.5373098e-11 1.9714868e-12]
  [1.0000000e+00 8.9335579e-09 2.1277691e-14 4.3029408e-12 2.3789737e-14]
  [9.9995768e-01 4.2325162e-05 3.5851877e-12 7.5537271e-11 6.5158413e-12]
  ...
  [9.9970132e-01 2.9862422e-04 8.9030302e-13 1.6773643e-12 2.1125961e-12]
  [9.9999976e-01 2.0274764e-07 8.7636007e-14 1.4012645e-12 1.9916049e-13]
  [9.9999940e-01 6.1628560e-07 4.2241067e-13 1.2602947e-11 6.6920823e-13]]

 ...

 [[9.9978155e-01 2.1848794e-04 7.5834851e-12 3.9162881e-10 9.0750662e-12]
  [1.0000000e+00 5.2484058e-08 7.8561974e-14 7.8690873e-12 9.6484249e-14]
  [9.9998987e-01 1.0134532e-05 9.2585390e-13 1.2553862e-11 1.1169123e-12]
  ...
  [9.9999678e-01 3.2565995e-06 7.3141586e-14 2.6248724e-13 2.0549602e-13]
  [9.9998426e-01 1.5703246e-05 3.2730411e-12 7.4154696e-11 5.5192899e-12]
  [9.9999964e-01 4.0239433e-07 1.2351941e-13 1.5350682e-12 2.3608752e-13]]

 [[9.9803537e-01 1.9646073e-03 2.3968813e-11 1.2794795e-09 2.8369414e-11]
  [9.9999988e-01 1.2388386e-07 3.6117761e-13 2.8711929e-11 4.2430683e-13]
  [9.9999988e-01 1.2950852e-07 6.0386700e-14 2.1400139e-12 1.0039263e-13]
  ...
  [9.9999952e-01 4.7975823e-07 1.0697870e-13 2.0235825e-12 2.1987144e-13]
  [9.9999976e-01 1.9277620e-07 1.4995763e-13 3.0093040e-12 2.6979740e-13]
  [9.9999988e-01 1.3311616e-07 1.6362668e-13 4.4778673e-12 2.7929880e-13]]

 [[9.9999917e-01 8.0686516e-07 4.2389239e-13 1.0272363e-11 6.4206794e-13]
  [9.9999988e-01 6.9823379e-08 1.1118811e-13 4.4118702e-11 1.2810934e-13]
  [9.9995649e-01 4.3530901e-05 6.0686998e-12 8.7392323e-11 9.1699764e-12]
  ...
  [9.9999952e-01 4.3169413e-07 9.5194211e-14 9.3165916e-13 2.1458649e-13]
  [9.9999988e-01 7.5677576e-08 1.8922106e-13 6.4650989e-12 3.1638800e-13]
  [9.9989092e-01 1.0908909e-04 1.2416178e-11 1.8472522e-10 1.8184771e-11]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999917e-01 8.0892613e-07 3.2704799e-13 7.3271693e-12 5.3171871e-13]
 [9.9999964e-01 3.7160279e-07 1.1343305e-12 1.0769215e-10 1.1314307e-12]
 [9.9997687e-01 2.3118720e-05 2.3579728e-13 1.7352287e-12 3.7710275e-13]
 ...
 [9.9999952e-01 4.3169413e-07 9.5194211e-14 9.3165916e-13 2.1458649e-13]
 [9.9999988e-01 7.5677576e-08 1.8922106e-13 6.4650989e-12 3.1638800e-13]
 [9.9989092e-01 1.0908909e-04 1.2416178e-11 1.8472522e-10 1.8184771e-11]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  4.437877907562256
tp :  64237.0
fp :  35763.0
tn :  364237.0
fn :  35763.0
accuracy :  0.8569489121437073
precision :  0.6423699855804443
recall :  0.6423699855804443
auc :  0.7761095762252808

y_eval {0: 64281, 1: 35719}
pred {0: 99956, 1: 44}
[INFO] confusion matrix for file 
[[64237    44     0     0     0]
 [35719     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[6361648    1639       0       0       0]
 [ 578855       4       0       0       0]
 [ 109692       5       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0377493e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0377493e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.0377493e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 1.7330190e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.7330190e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.7330190e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 1. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [1 0 0 ... 1 1 1] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99999881e-01 1.13876347e-07 5.00957945e-13 1.43880567e-11
   8.52019952e-13]
  [9.99998808e-01 1.24512383e-06 9.54791476e-13 2.25031105e-11
   1.12547211e-12]
  [9.99997377e-01 2.57987404e-06 3.27703034e-13 6.74041769e-12
   5.59275553e-13]
  ...
  [9.99995112e-01 4.85270448e-06 3.92093096e-13 2.49606932e-12
   8.78979669e-13]
  [9.99999881e-01 1.15725804e-07 4.36994699e-14 8.27466296e-13
   7.65097011e-14]
  [1.00000000e+00 2.36603910e-08 4.03580198e-14 1.37009230e-12
   8.65100296e-14]]

 [[9.99783218e-01 2.16775617e-04 7.56181836e-12 3.90411564e-10
   9.05416020e-12]
  [1.00000000e+00 5.28878275e-08 7.89154983e-14 7.87704624e-12
   9.68766625e-14]
  [9.99996424e-01 3.57102954e-06 1.25577456e-12 1.68537198e-11
   2.10776101e-12]
  ...
  [9.99972463e-01 2.75463026e-05 1.03858144e-12 8.47488139e-12
   1.19631453e-12]
  [9.99935865e-01 6.41178776e-05 7.79524774e-13 5.01710175e-12
   1.70372039e-12]
  [9.99999881e-01 9.54037489e-08 5.13275911e-14 7.76256988e-13
   1.16676268e-13]]

 [[9.99999881e-01 1.13751852e-07 5.01962187e-13 1.44040925e-11
   8.53190836e-13]
  [9.99998689e-01 1.25991016e-06 9.60121956e-13 2.24546579e-11
   1.13310977e-12]
  [9.99998331e-01 1.70051885e-06 3.83007103e-13 6.93388489e-12
   6.28046280e-13]
  ...
  [9.99997854e-01 2.14442275e-06 2.89380255e-13 1.90493996e-12
   5.53633691e-13]
  [1.00000000e+00 2.18423768e-08 5.43367672e-14 2.18097372e-12
   1.01710002e-13]
  [9.99986887e-01 1.30663821e-05 1.40469841e-12 2.20203820e-11
   1.60629799e-12]]

 ...

 [[9.99998569e-01 1.37093230e-06 5.15650131e-13 1.35116978e-11
   8.24725162e-13]
  [1.00000000e+00 2.31725501e-08 9.82670163e-14 2.28339361e-11
   9.87378378e-14]
  [9.99997735e-01 2.29986381e-06 1.91784089e-13 4.37555504e-12
   3.41962515e-13]
  ...
  [9.99998927e-01 1.12579551e-06 1.40909677e-13 1.42157466e-12
   2.91168836e-13]
  [9.99999762e-01 2.44761708e-07 2.52608562e-13 5.17394851e-12
   4.26188517e-13]
  [9.99989986e-01 9.95703249e-06 6.57054977e-13 4.65581740e-12
   9.53023576e-13]]

 [[9.98789608e-01 1.21040223e-03 2.13898274e-11 1.18466670e-09
   2.62091633e-11]
  [9.99999046e-01 9.06733021e-07 8.66422656e-13 2.94684555e-11
   8.92202002e-13]
  [9.99988079e-01 1.18834942e-05 4.55452624e-13 5.07908299e-12
   8.16888766e-13]
  ...
  [9.99999523e-01 4.37640466e-07 1.49608502e-13 3.12496925e-12
   2.40151350e-13]
  [9.99999523e-01 4.77673723e-07 9.28926058e-14 8.76117972e-13
   2.06720369e-13]
  [9.99997020e-01 2.95347286e-06 8.94181539e-13 1.72654217e-11
   1.67241611e-12]]

 [[9.99946117e-01 5.38220265e-05 1.13147425e-11 1.10632359e-09
   1.08887153e-11]
  [1.00000000e+00 5.18916004e-08 4.59864250e-14 1.30141323e-11
   5.48910384e-14]
  [9.99998331e-01 1.69314785e-06 2.72116937e-13 4.57388381e-12
   4.72919989e-13]
  ...
  [9.99970198e-01 2.97426632e-05 1.85783138e-12 1.58435192e-11
   2.19255365e-12]
  [9.99939680e-01 6.02583386e-05 4.82296494e-13 2.08534882e-12
   7.98135538e-13]
  [9.99999642e-01 3.78087663e-07 6.93399263e-14 7.14348340e-13
   1.67617195e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999988e-01 1.1387635e-07 5.0095794e-13 1.4388057e-11 8.5201995e-13]
 [9.9999881e-01 1.2451238e-06 9.5479148e-13 2.2503110e-11 1.1254721e-12]
 [9.9999738e-01 2.5798740e-06 3.2770303e-13 6.7404177e-12 5.5927555e-13]
 ...
 [9.9997020e-01 2.9742663e-05 1.8578314e-12 1.5843519e-11 2.1925536e-12]
 [9.9993968e-01 6.0258339e-05 4.8229649e-13 2.0853488e-12 7.9813554e-13]
 [9.9999964e-01 3.7808766e-07 6.9339926e-14 7.1434834e-13 1.6761720e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  4.555643822479248
tp :  64100.0
fp :  35900.0
tn :  364100.0
fn :  35900.0
accuracy :  0.8564010262489319
precision :  0.640999972820282
recall :  0.640999972820282
auc :  0.7745242118835449

y_eval {0: 64139, 1: 35861}
pred {0: 99961, 1: 39}
[INFO] confusion matrix for file 
[[64100    39     0     0     0]
 [35861     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[6425748    1678       0       0       0]
 [ 614716       4       0       0       0]
 [ 109692       5       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.2/eval/2016-01-02_172943_122.log.part05_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1367 (0.2734%)
[INFO] ** orig:[0:99.9992%,2:0.0008%]
[INFO] ** type:[0:100.0%]
[INFO] ** i/f_name:[2:99.9984%,3:0.0016%]
[INFO] ** i/f_dir:[1:99.9984%,0:0.0016%]
[INFO] ** src:[22:38.0648%,9:26.1164%,7:18.2044%,1:17.6118%,21:0.001%,14:0.0008%,3:0.0004%,2:0.0004%]
[INFO] ** dst:[21:43.368%,10:20.8128%,8:18.2044%,9:17.6114%,15:0.0016%,22:0.0006%,16:0.0004%,24:0.0002%,18:0.0002%,6:0.0002%,2:0.0002%]
[INFO] ** proto:[0:99.998%,1:0.0016%,2:0.0004%]
[INFO] ** appi_name:[21:99.9974%,30:0.0016%,7:0.0006%,31:0.0002%,22:0.0002%]
[INFO] ** proxy_src_ip:[18:38.0648%,20:26.1164%,13:18.2044%,6:17.6118%,17:0.0016%,14:0.0004%,1:0.0004%,7:0.0002%]
[INFO] ** modbus_function_code:[0.02961:99.9974%,-33.760870000000004:0.0026%]
[INFO] ** modbus_function_description:[7:49.9992%,11:49.9982%,0:0.0026%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[3:26.1154%,1:20.8126%,5:18.204%,4:17.6112%,2:17.2518%,0:0.005%]
[INFO] ** service:[0.0048200000000000005:99.9974%,-211.73542999999998:0.0016%,-211.09762999999998:0.0006%,-186.43601999999998:0.0002%,-211.08818:0.0002%]
[INFO] ** s_port:[1.45442:26.1158%,-0.32151:20.8128%,-1.27613:18.204%,-0.23351:17.6114%,-0.33484:17.252%,-71.33197:0.0016%,1.45709:0.0004%,-1.2708:0.0002%,-71.14931:0.0002%,-0.24151:0.0002%,-2.02544:0.0002%,1.46509:0.0002%,10.73138:0.0002%,-0.24950999999999998:0.0002%,14.88321:0.0002%,-1.27347:0.0002%,-2.81074:0.0002%]
[INFO] ** classification:[normal:97.0224%,Single Stage Single Point:2.9776%]
[33mencode_numeric_zscore unixtime[0m
[INFO] processing batch 0-100000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.7314488e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.7314488e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.7314488e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [-1.0388432e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0388432e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-1.0388432e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [1 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99999166e-01 8.29262319e-07 3.80977585e-13 1.00467742e-11
   6.31169054e-13]
  [1.00000000e+00 3.97249451e-08 1.55565326e-13 2.51513671e-11
   1.53471664e-13]
  [9.99997854e-01 2.16628291e-06 1.59390255e-13 2.82438699e-12
   3.04139092e-13]
  ...
  [9.99997854e-01 2.11337829e-06 6.93004410e-13 1.03697936e-11
   1.17270668e-12]
  [9.99986053e-01 1.39075673e-05 8.68519286e-13 7.08265087e-12
   1.10432106e-12]
  [9.99793351e-01 2.06630808e-04 1.09045433e-12 2.73207932e-12
   1.78915270e-12]]

 [[9.99993682e-01 6.28010275e-06 1.81184213e-12 4.29908470e-11
   2.77686142e-12]
  [9.99994159e-01 5.86779288e-06 4.11451038e-12 7.69011729e-11
   3.98338871e-12]
  [9.97661948e-01 2.33805506e-03 4.30788218e-12 1.51999715e-11
   8.61152989e-12]
  ...
  [9.99945045e-01 5.49567849e-05 1.67563055e-12 1.38546917e-11
   1.74755219e-12]
  [9.99993443e-01 6.57305236e-06 1.63250910e-13 8.66864089e-13
   3.86815498e-13]
  [9.99999881e-01 1.55366379e-07 1.54984532e-13 3.13754209e-12
   2.79731696e-13]]

 [[9.99958038e-01 4.19196112e-05 8.43087319e-12 2.28775731e-11
   1.17914472e-11]
  [9.99880314e-01 1.19632794e-04 1.64020013e-11 7.85993007e-11
   2.08659062e-11]
  [9.99089241e-01 9.10704839e-04 1.89173382e-11 4.95454927e-11
   2.35254125e-11]
  ...
  [9.99999523e-01 4.96469511e-07 1.06775259e-13 1.05511021e-12
   2.15319556e-13]
  [9.99999881e-01 1.15046305e-07 1.41643560e-13 6.04518735e-12
   1.98566153e-13]
  [9.99994040e-01 6.01824968e-06 4.17891904e-13 2.31197830e-12
   7.24936495e-13]]

 ...

 [[9.93944466e-01 6.05554460e-03 1.76550247e-10 1.89516491e-08
   2.21946822e-10]
  [9.99999881e-01 8.58426290e-08 2.45099215e-13 1.02316194e-11
   2.65213659e-13]
  [9.99915838e-01 8.41778165e-05 1.40660129e-12 6.47796010e-12
   1.61369171e-12]
  ...
  [9.99988556e-01 1.14299937e-05 3.96205746e-13 1.89464590e-12
   6.74941223e-13]
  [9.99971628e-01 2.83153440e-05 9.34318486e-13 8.19846187e-12
   2.25947819e-12]
  [9.99999881e-01 1.08471994e-07 6.41771792e-14 1.01208245e-12
   1.53371863e-13]]

 [[9.99999166e-01 8.40122368e-07 4.14143221e-13 1.06416083e-11
   6.64758071e-13]
  [9.99999881e-01 7.87194026e-08 1.54323481e-13 2.56637749e-11
   1.58048257e-13]
  [9.99984145e-01 1.57999239e-05 1.91912220e-12 1.66267243e-11
   3.15283802e-12]
  ...
  [9.98269320e-01 1.73060258e-03 5.09021774e-12 2.87011370e-11
   9.65437799e-12]
  [9.99998093e-01 1.87734190e-06 1.21453791e-13 7.05525373e-13
   3.19031937e-13]
  [9.99999881e-01 1.28212648e-07 1.14605198e-13 2.52078328e-12
   2.08185262e-13]]

 [[9.99979615e-01 2.03568161e-05 2.77459327e-12 8.32973621e-11
   3.94798517e-12]
  [9.99996305e-01 3.64201696e-06 1.96696630e-12 2.80483206e-11
   2.19463618e-12]
  [9.99719679e-01 2.80358770e-04 7.60039167e-12 5.63707067e-11
   8.30114710e-12]
  ...
  [9.99982476e-01 1.75611603e-05 2.39029011e-13 9.86798750e-13
   6.02699260e-13]
  [9.99999881e-01 1.33320697e-07 1.22485518e-13 2.45417445e-12
   2.30457228e-13]
  [9.99994040e-01 5.94594621e-06 1.18374754e-12 2.47743701e-11
   1.42554002e-12]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999917e-01 8.2926232e-07 3.8097758e-13 1.0046774e-11 6.3116905e-13]
 [1.0000000e+00 3.9724945e-08 1.5556533e-13 2.5151367e-11 1.5347166e-13]
 [9.9999785e-01 2.1662829e-06 1.5939026e-13 2.8243870e-12 3.0413909e-13]
 ...
 [9.9998248e-01 1.7561160e-05 2.3902901e-13 9.8679875e-13 6.0269926e-13]
 [9.9999988e-01 1.3332070e-07 1.2248552e-13 2.4541745e-12 2.3045723e-13]
 [9.9999404e-01 5.9459462e-06 1.1837475e-12 2.4774370e-11 1.4255400e-12]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  1.6650232802489773
tp :  85108.0
fp :  14892.0
tn :  385108.0
fn :  14892.0
accuracy :  0.9404323697090149
precision :  0.8510800004005432
recall :  0.8510800004005432
auc :  0.90870201587677

y_eval {0: 85112, 1: 14888}
pred {0: 99996, 1: 4}
[INFO] confusion matrix for file 
[[85108     4     0     0     0]
 [14888     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[6510856    1682       0       0       0]
 [ 629604       4       0       0       0]
 [ 109692       5       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 100000-200000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-1.0388432e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [-1.0388432e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-1.0388432e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 ...
 [-3.4623763e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [-3.4623763e-01  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [-3.4623763e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99999166e-01 8.40419659e-07 4.12109447e-13 1.05747772e-11
   6.62080525e-13]
  [9.99999881e-01 1.66376637e-07 6.91131343e-13 5.78295745e-11
   6.80208765e-13]
  [9.98839796e-01 1.16027601e-03 2.63021636e-12 3.04805799e-11
   5.48166373e-12]
  ...
  [9.99955177e-01 4.47781131e-05 3.29391760e-13 9.26070852e-13
   7.44803199e-13]
  [9.99997616e-01 2.37668746e-06 2.64812234e-13 1.89758170e-12
   5.22278564e-13]
  [9.99994040e-01 5.98613769e-06 4.98748829e-13 7.08557215e-12
   8.69146010e-13]]

 [[9.99948382e-01 5.15880674e-05 1.09450842e-11 9.84563098e-10
   1.09383639e-11]
  [1.00000000e+00 2.42536551e-08 3.54206546e-14 6.70816614e-12
   3.69222475e-14]
  [9.99975681e-01 2.43454724e-05 1.39447460e-12 1.63553927e-11
   1.52968567e-12]
  ...
  [1.00000000e+00 4.26729798e-08 1.13854401e-13 4.83278001e-12
   1.89975084e-13]
  [9.99988675e-01 1.13694841e-05 1.28260781e-12 7.53397171e-12
   2.40589905e-12]
  [9.99980211e-01 1.98199996e-05 1.37916566e-12 1.01958260e-11
   2.23802183e-12]]

 [[9.99997020e-01 3.02897865e-06 1.30546095e-12 4.17778798e-11
   1.87299568e-12]
  [9.99999762e-01 2.06248458e-07 3.75800275e-13 4.60435336e-11
   3.87994324e-13]
  [9.99987364e-01 1.26622999e-05 3.05359470e-13 2.72379450e-12
   4.59724489e-13]
  ...
  [9.99999762e-01 2.89331751e-07 7.05204734e-14 8.34053150e-13
   1.68720601e-13]
  [9.99999166e-01 8.50929837e-07 6.04413112e-13 8.53403893e-12
   9.91129054e-13]
  [9.99920726e-01 7.92640931e-05 1.51407240e-12 7.30546786e-12
   1.94196178e-12]]

 ...

 [[9.99937654e-01 6.23405867e-05 1.13507450e-11 1.02669218e-09
   1.12690308e-11]
  [9.99999881e-01 1.74978723e-07 4.15094879e-13 2.33182466e-11
   3.52623909e-13]
  [9.99704778e-01 2.95212027e-04 7.43041967e-13 3.23626954e-12
   1.33661485e-12]
  ...
  [1.00000000e+00 3.66942601e-08 5.76381119e-14 1.73971287e-12
   1.08813586e-13]
  [9.99999046e-01 9.40102950e-07 3.67889475e-13 7.93235616e-12
   5.84054398e-13]
  [9.99991894e-01 8.12738290e-06 5.70435897e-13 3.52251561e-12
   9.13485867e-13]]

 [[9.99997854e-01 2.09639984e-06 1.05670952e-12 3.31806770e-11
   1.59775665e-12]
  [1.00000000e+00 1.02785407e-08 5.61269713e-14 1.02782704e-11
   5.89710911e-14]
  [9.99998569e-01 1.46696584e-06 3.18376781e-13 6.28504497e-12
   5.45262945e-13]
  ...
  [9.99982238e-01 1.77720922e-05 9.33539162e-13 9.01979706e-12
   1.19959370e-12]
  [1.00000000e+00 5.08366078e-08 2.84828008e-14 5.90330194e-13
   7.09806495e-14]
  [9.99999881e-01 1.23019603e-07 2.47278001e-13 6.82467711e-12
   4.01941772e-13]]

 [[9.99997735e-01 2.21983169e-06 7.90209478e-13 2.17172565e-11
   1.22115111e-12]
  [9.99999881e-01 1.15023376e-07 4.66699270e-13 3.12420298e-11
   4.75529338e-13]
  [9.99959469e-01 4.05067185e-05 2.52869774e-13 2.68527344e-12
   5.28199229e-13]
  ...
  [9.99999762e-01 2.05814800e-07 8.49755447e-14 1.00947202e-12
   1.86744229e-13]
  [9.99999404e-01 5.59121077e-07 5.95588791e-13 1.03663094e-11
   9.26783281e-13]
  [9.99997616e-01 2.40384338e-06 4.57853915e-13 4.82690927e-12
   7.48336451e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999917e-01 8.4041966e-07 4.1210945e-13 1.0574777e-11 6.6208052e-13]
 [9.9999988e-01 1.6637664e-07 6.9113134e-13 5.7829574e-11 6.8020876e-13]
 [9.9883980e-01 1.1602760e-03 2.6302164e-12 3.0480580e-11 5.4816637e-12]
 ...
 [9.9999976e-01 2.0581480e-07 8.4975545e-14 1.0094720e-12 1.8674423e-13]
 [9.9999940e-01 5.5912108e-07 5.9558879e-13 1.0366309e-11 9.2678328e-13]
 [9.9999762e-01 2.4038434e-06 4.5785392e-13 4.8269093e-12 7.4833645e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0009907422844320536
tp :  99994.0
fp :  6.0
tn :  399994.0
fn :  6.0
accuracy :  0.9999760389328003
precision :  0.9999399781227112
recall :  0.9999399781227112
auc :  0.9999873638153076

y_eval {0: 100000}
pred {0: 99994, 1: 6}
[INFO] confusion matrix for file 
[[99994     6     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[6610850    1688       0       0       0]
 [ 629604       4       0       0       0]
 [ 109692       5       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 200000-300000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[-3.4623763e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [-3.4623763e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [-3.4623763e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 3.4890494e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4890494e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 3.4890494e-01  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99999881e-01 1.03448450e-07 4.40363539e-13 6.35898192e-12
   6.57822646e-13]
  [9.99999404e-01 6.09270046e-07 1.95956451e-13 8.17436136e-12
   3.06168529e-13]
  [9.99933720e-01 6.62415041e-05 2.60843864e-12 1.17575186e-11
   4.87241454e-12]
  ...
  [9.99964595e-01 3.54315198e-05 2.30782169e-12 3.47585016e-11
   4.03811143e-12]
  [9.99995947e-01 4.01664965e-06 2.03913397e-13 9.53214612e-13
   4.59615364e-13]
  [9.99999285e-01 6.98575434e-07 2.31215708e-13 3.76723219e-12
   4.62257890e-13]]

 [[9.92649257e-01 7.35077960e-03 1.29773761e-10 1.08978959e-08
   1.58750305e-10]
  [9.99997139e-01 2.89579839e-06 8.64590192e-13 1.21257743e-11
   1.08062951e-12]
  [9.99999523e-01 4.18192457e-07 1.83713681e-13 3.84430552e-12
   3.27031262e-13]
  ...
  [9.99998093e-01 1.86109332e-06 4.17434723e-13 3.36645122e-12
   7.77707976e-13]
  [9.99999523e-01 5.06573031e-07 3.12226292e-13 4.93392740e-12
   5.37978407e-13]
  [9.99995112e-01 4.83945860e-06 4.49081039e-13 4.85683759e-12
   5.74258523e-13]]

 [[9.99938369e-01 6.16021134e-05 4.39133929e-12 1.71353251e-10
   5.79894553e-12]
  [9.99999166e-01 7.81428469e-07 4.50961778e-13 1.29855328e-11
   5.39605036e-13]
  [9.99979973e-01 2.00536269e-05 7.58345318e-13 5.27895089e-12
   1.20281693e-12]
  ...
  [9.99775589e-01 2.24427931e-04 8.05483826e-13 3.78860224e-12
   1.54667273e-12]
  [9.99841332e-01 1.58587965e-04 1.80396334e-12 6.26383320e-12
   2.83014042e-12]
  [9.99999762e-01 2.06705280e-07 5.21230533e-14 6.65201076e-13
   1.24107918e-13]]

 ...

 [[9.99861598e-01 1.38418589e-04 6.21163494e-12 2.91903834e-10
   7.73035629e-12]
  [9.99999404e-01 5.84029124e-07 8.39375173e-13 2.56655738e-11
   9.31600391e-13]
  [9.99972463e-01 2.75225902e-05 1.18285763e-12 9.67976307e-12
   1.57536289e-12]
  ...
  [9.99999642e-01 3.56013402e-07 7.87587904e-14 7.41574554e-13
   1.84271692e-13]
  [9.99999523e-01 4.72928321e-07 8.37692762e-13 2.23294109e-11
   1.24794912e-12]
  [9.99998808e-01 1.22178994e-06 1.48337709e-13 1.89260673e-12
   2.54586635e-13]]

 [[9.99861956e-01 1.38053583e-04 6.20562152e-12 2.91529495e-10
   7.72444955e-12]
  [9.99999404e-01 5.85943781e-07 8.40897501e-13 2.56789416e-11
   9.33213359e-13]
  [9.99999523e-01 4.44455594e-07 1.55499989e-13 3.39375294e-12
   2.58119941e-13]
  ...
  [9.99990106e-01 9.84396866e-06 1.38896533e-12 4.59724481e-11
   2.11743058e-12]
  [9.99478996e-01 5.20980568e-04 3.36402369e-12 8.21182185e-12
   4.25193214e-12]
  [9.99988079e-01 1.19293563e-05 1.81359431e-13 7.99065241e-13
   4.74415808e-13]]

 [[9.97259855e-01 2.74011958e-03 8.30172736e-11 8.56121041e-09
   1.01122957e-10]
  [9.99999523e-01 4.41610837e-07 2.48019514e-13 1.02974755e-11
   2.76492127e-13]
  [9.99998569e-01 1.45994284e-06 4.53347809e-13 8.00491184e-12
   8.01445607e-13]
  ...
  [9.99999881e-01 8.54334630e-08 8.63912959e-14 2.11776625e-12
   1.51367756e-13]
  [9.98123586e-01 1.87640428e-03 2.70020291e-11 5.32609457e-10
   4.53659714e-11]
  [9.99999881e-01 1.11349955e-07 7.07936517e-14 1.70308223e-12
   1.29418625e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.99999881e-01 1.03448450e-07 4.40363539e-13 6.35898192e-12
  6.57822646e-13]
 [9.99999404e-01 6.09270046e-07 1.95956451e-13 8.17436136e-12
  3.06168529e-13]
 [9.99933720e-01 6.62415041e-05 2.60843864e-12 1.17575186e-11
  4.87241454e-12]
 ...
 [9.99999881e-01 8.54334630e-08 8.63912959e-14 2.11776625e-12
  1.51367756e-13]
 [9.98123586e-01 1.87640428e-03 2.70020291e-11 5.32609457e-10
  4.53659714e-11]
 [9.99999881e-01 1.11349955e-07 7.07936517e-14 1.70308223e-12
  1.29418625e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0013520363682880997
tp :  99988.0
fp :  12.0
tn :  399988.0
fn :  12.0
accuracy :  0.9999520182609558
precision :  0.9998800158500671
recall :  0.9998800158500671
auc :  0.99997478723526

y_eval {0: 100000}
pred {0: 99988, 1: 12}
[INFO] confusion matrix for file 
[[99988    12     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[6710838    1700       0       0       0]
 [ 629604       4       0       0       0]
 [ 109692       5       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 300000-400000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 3.4890494e-01  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 3.4890494e-01  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 3.4890494e-01  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 ...
 [ 1.0389735e+00  0.0000000e+00  0.0000000e+00 ...  2.0000000e+00
   4.8199999e-03 -3.3484000e-01]
 [ 1.0389735e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.0389735e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.99997973e-01 2.04615822e-06 1.01334772e-12 3.15871600e-11
   1.49935706e-12]
  [1.00000000e+00 5.22891170e-08 1.44372510e-13 2.10533483e-11
   1.44400605e-13]
  [9.99999046e-01 9.30109707e-07 1.70321954e-13 5.36740314e-12
   2.88114991e-13]
  ...
  [9.99997377e-01 2.66910934e-06 1.26066123e-13 1.03318580e-12
   2.59321481e-13]
  [9.91874039e-01 8.12598877e-03 3.72258890e-11 2.49195609e-10
   6.31000877e-11]
  [9.99971628e-01 2.83206373e-05 3.36764015e-12 4.25503660e-11
   4.24174541e-12]]

 [[9.99978185e-01 2.18138939e-05 2.74300721e-12 1.56579943e-10
   3.26695897e-12]
  [1.00000000e+00 1.42531489e-08 3.72484704e-14 8.87300476e-12
   4.14905537e-14]
  [9.99999523e-01 4.28317094e-07 1.88773273e-13 4.99307713e-12
   3.12326364e-13]
  ...
  [1.00000000e+00 1.24791173e-08 7.72080831e-14 4.93963551e-12
   1.42173274e-13]
  [9.99999523e-01 4.20122802e-07 4.25236804e-13 7.79745886e-12
   6.37769405e-13]
  [9.99999642e-01 3.19646148e-07 1.48861893e-13 2.44079952e-12
   2.68763446e-13]]

 [[9.99997139e-01 2.84858220e-06 1.42495174e-12 4.96864251e-11
   2.06231646e-12]
  [1.00000000e+00 3.18542064e-08 1.49332586e-13 1.77572262e-11
   1.55964326e-13]
  [9.99988437e-01 1.15292223e-05 2.81747715e-13 4.32658466e-12
   5.70937828e-13]
  ...
  [9.99999881e-01 1.34874881e-07 7.87200641e-14 1.13263793e-12
   1.60960275e-13]
  [1.00000000e+00 2.65015139e-08 1.17163766e-13 5.37628102e-12
   1.98163616e-13]
  [9.99951005e-01 4.89995364e-05 8.87466923e-12 1.52852078e-10
   1.25253662e-11]]

 ...

 [[9.99957800e-01 4.21434343e-05 1.12056640e-11 1.16909948e-09
   1.05968715e-11]
  [1.00000000e+00 8.47276738e-09 2.10931888e-14 6.25842564e-12
   2.31559106e-14]
  [9.99855042e-01 1.44942795e-04 1.20986407e-11 1.52740084e-10
   2.05359375e-11]
  ...
  [9.99999762e-01 2.03840145e-07 1.58102508e-13 7.95172175e-12
   2.48200332e-13]
  [9.99890566e-01 1.09365610e-04 1.10763709e-12 2.69837017e-12
   1.49131900e-12]
  [9.99998927e-01 1.11181942e-06 2.30011295e-13 2.52654711e-12
   4.97398455e-13]]

 [[9.99999166e-01 8.00205953e-07 4.35155628e-13 1.07405682e-11
   6.54520600e-13]
  [9.99999881e-01 6.18083078e-08 1.05484645e-13 4.23778339e-11
   1.20948892e-13]
  [9.99997497e-01 2.46380728e-06 2.91200088e-13 5.71434653e-12
   5.12950034e-13]
  ...
  [9.99999404e-01 5.47481591e-07 8.87845841e-14 8.99807301e-13
   2.04963813e-13]
  [9.99998927e-01 1.08464292e-06 4.35978835e-13 6.52596076e-12
   6.03229001e-13]
  [9.99999881e-01 1.69757826e-07 6.71448235e-14 1.27147132e-12
   1.27416537e-13]]

 [[9.96531308e-01 3.46871372e-03 3.53430445e-11 1.92475391e-09
   4.22453426e-11]
  [9.99999523e-01 4.46669844e-07 7.66622117e-13 2.85945261e-11
   9.00485578e-13]
  [9.99999285e-01 6.99686211e-07 1.05610406e-13 2.48496883e-12
   1.74925680e-13]
  ...
  [9.99953747e-01 4.62663447e-05 3.80388299e-12 3.86064965e-11
   4.90321238e-12]
  [9.99999881e-01 6.55906192e-08 6.51110296e-14 1.43603033e-12
   1.12819368e-13]
  [9.99999642e-01 3.80322234e-07 6.35270970e-13 1.44274610e-11
   9.73079798e-13]]]Using TensorFlow backend.
 (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9999797e-01 2.0461582e-06 1.0133477e-12 3.1587160e-11 1.4993571e-12]
 [1.0000000e+00 5.2289117e-08 1.4437251e-13 2.1053348e-11 1.4440060e-13]
 [9.9999905e-01 9.3010971e-07 1.7032195e-13 5.3674031e-12 2.8811499e-13]
 ...
 [9.9995375e-01 4.6266345e-05 3.8038830e-12 3.8606496e-11 4.9032124e-12]
 [9.9999988e-01 6.5590619e-08 6.5111030e-14 1.4360303e-12 1.1281937e-13]
 [9.9999964e-01 3.8032223e-07 6.3527097e-13 1.4427461e-11 9.7307980e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.0015510075123980642
tp :  99972.0
fp :  28.0
tn :  399972.0
fn :  28.0
accuracy :  0.9998879432678223
precision :  0.9997199773788452
recall :  0.9997199773788452
auc :  0.9999998807907104

y_eval {0: 100000}
pred {0: 99972, 1: 28}
[INFO] confusion matrix for file 
[[99972    28     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[6810810    1728       0       0       0]
 [ 629604       4       0       0       0]
 [ 109692       5       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
[INFO] processing batch 400000-500000/500000 for LSTM
[INFO] to_xy labeltype: normal
[INFO] to_xy labeltype: Single Stage Single Point
[INFO] to_xy labeltype: Single Stage Multi Point
[INFO] to_xy labeltype: Multi Stage Single Point
[INFO] to_xy labeltype: Multi Stage Multi Point
x_test [[ 1.0389735e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]
 [ 1.0389735e+00  0.0000000e+00  0.0000000e+00 ...  4.0000000e+00
   4.8199999e-03 -2.3351000e-01]
 [ 1.0389735e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 ...
 [ 1.7315791e+00  0.0000000e+00  0.0000000e+00 ...  1.0000000e+00
   4.8199999e-03 -3.2150999e-01]
 [ 1.7315791e+00  0.0000000e+00  0.0000000e+00 ...  5.0000000e+00
   4.8199999e-03 -1.2761300e+00]
 [ 1.7315791e+00  0.0000000e+00  0.0000000e+00 ...  3.0000000e+00
   4.8199999e-03  1.4544200e+00]] shape (100000, 16)
y_test [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]] shape (100000, 5)
loading weights
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 15)            1920      
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 30)            5520      
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 15)            2760      
_________________________________________________________________
dense_1 (Dense)              (None, 10, 5)             80        
=================================================================
Total params: 10,280
Trainable params: 10,280
Non-trainable params: 0
_________________________________________________________________
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
pred 1 [[[9.9978071e-01 2.1927326e-04 7.5937555e-12 3.9224224e-10 9.0849134e-12]
  [9.9999988e-01 7.5632407e-08 3.1417086e-13 1.5711607e-11 3.2455389e-13]
  [9.9715841e-01 2.8415977e-03 3.7282920e-12 5.2544856e-12 5.4916553e-12]
  ...
  [9.9984503e-01 1.5489179e-04 2.4726388e-12 1.7536854e-11 4.4299200e-12]
  [9.9998879e-01 1.1246182e-05 6.5304110e-13 3.1319767e-12 1.3558621e-12]
  [9.9999988e-01 1.5986329e-07 8.3144639e-14 1.7428745e-12 1.5379984e-13]]

 [[9.9999797e-01 2.0795958e-06 1.1156099e-12 3.5708249e-11 1.6748821e-12]
  [1.0000000e+00 7.3398594e-09 3.0011733e-14 7.1149206e-12 3.1746022e-14]
  [9.9991930e-01 8.0653146e-05 3.6991343e-12 9.3471071e-11 6.9787652e-12]
  ...
  [9.9999559e-01 4.3826544e-06 8.1734187e-14 2.7667622e-13 2.3079626e-13]
  [9.9999988e-01 1.4353098e-07 2.0529960e-13 6.8100230e-12 3.8275795e-13]
  [9.9999881e-01 1.1626901e-06 4.5077155e-13 4.9162818e-12 7.4272337e-13]]

 [[9.9988997e-01 1.1005704e-04 5.4700285e-12 2.6670108e-10 6.4890584e-12]
  [9.9999988e-01 8.0500605e-08 9.8657444e-14 8.1344098e-12 1.2264776e-13]
  [9.9999595e-01 4.0342820e-06 1.4177226e-12 1.8613456e-11 2.3805281e-12]
  ...
  [1.0000000e+00 2.1395765e-09 1.8177571e-14 2.1539534e-12 3.6182561e-14]
  [9.9999917e-01 7.9963149e-07 5.0049721e-13 7.4081123e-12 7.5291043e-13]
  [9.9521458e-01 4.7854399e-03 1.2754386e-11 9.7653580e-11 2.5163991e-11]]

 ...

 [[9.9841416e-01 1.5857945e-03 2.0257079e-11 1.0660661e-09 2.3548604e-11]
  [9.9999952e-01 4.9987642e-07 4.4629505e-13 1.7747838e-11 4.9176803e-13]
  [9.9999046e-01 9.5666628e-06 1.3861923e-12 1.1582517e-11 2.4649601e-12]
  ...
  [9.9999881e-01 1.1471952e-06 1.9471122e-13 2.3801898e-12 3.1646129e-13]
  [9.9999964e-01 4.0431345e-07 2.3726572e-13 3.9226565e-12 4.2360646e-13]
  [9.9999976e-01 2.4644953e-07 1.5282285e-13 3.0740289e-12 2.6069630e-13]]

 [[9.9999750e-01 2.5372842e-06 1.6776436e-12 6.6289640e-11 2.3803047e-12]
  [1.0000000e+00 1.0523534e-08 1.9102179e-14 4.4118854e-12 2.1421190e-14]
  [9.9999392e-01 6.0598368e-06 4.3618790e-13 3.2600077e-12 6.5264477e-13]
  ...
  [9.9999964e-01 3.1849714e-07 1.1885725e-13 1.4809760e-12 2.2131885e-13]
  [1.0000000e+00 3.2721445e-08 1.2148020e-13 4.6371552e-12 2.0855649e-13]
  [9.9999976e-01 2.2331399e-07 1.4766712e-13 3.9722357e-12 2.3017561e-13]]

 [[9.9995387e-01 4.6116878e-05 1.1221918e-11 1.1487612e-09 1.0652579e-11]
  [1.0000000e+00 2.4483587e-08 7.6310770e-14 1.5972399e-11 8.6085368e-14]
  [9.9999154e-01 8.4446365e-06 4.2614683e-13 4.6707495e-12 5.4258453e-13]
  ...
  [9.9997485e-01 2.5137168e-05 9.7139788e-13 3.4168107e-12 2.0552143e-12]
  [9.9999475e-01 5.3016834e-06 3.8102315e-13 2.9558272e-12 5.1193506e-13]
  [9.9999177e-01 8.2535116e-06 2.9043573e-13 1.9940872e-12 6.4432785e-13]]] (10000, 10, 5)
y_test shape (10000, 10, 5)
pred 2 [[9.9978071e-01 2.1927326e-04 7.5937555e-12 3.9224224e-10 9.0849134e-12]
 [9.9999988e-01 7.5632407e-08 3.1417086e-13 1.5711607e-11 3.2455389e-13]
 [9.9715841e-01 2.8415977e-03 3.7282920e-12 5.2544856e-12 5.4916553e-12]
 ...
 [9.9997485e-01 2.5137168e-05 9.7139788e-13 3.4168107e-12 2.0552143e-12]
 [9.9999475e-01 5.3016834e-06 3.8102315e-13 2.9558272e-12 5.1193506e-13]
 [9.9999177e-01 8.2535116e-06 2.9043573e-13 1.9940872e-12 6.4432785e-13]] (100000, 5)
pred 3 (argmax) [0 0 0 ... 0 0 0] (100000,)
[33m[INFO] metrics:[0m
loss :  0.002688537233322859
tp :  99950.0
fp :  50.0
tn :  399950.0
fn :  50.0
accuracy :  0.9998000264167786
precision :  0.9994999766349792
recall :  0.9994999766349792
auc :  0.9999619126319885

y_eval {0: 100000}
pred {0: 99950, 1: 50}
[INFO] confusion matrix for file 
[[99950    50     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]
 [    0     0     0     0     0]]
[INFO] confusion matrix after adding it to total:
[[6910760    1778       0       0       0]
 [ 629604       4       0       0       0]
 [ 109692       5       0       0       0]
 [  45355       0       0       0       0]
 [ 202802       0       0       0       0]]
