2020-02-07 20:48:37.440016: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-02-07 20:48:37.452973: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f8b7655e8b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-02-07 20:48:37.453006: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Using TensorFlow backend.
WARNING:tensorflow:Large dropout rate: 0.8 (>0.5). In TensorFlow 2.x, dropout() uses dropout rate instead of keep_prob. Please ensure that this is intended.
2020-02-07 20:48:43.973986: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-07 20:48:43.999884: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-07 20:48:44.013405: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-07 20:48:44.129649: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-07 20:48:44.137714: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-07 20:48:44.147237: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-07 20:48:44.155682: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-07 20:48:44.193333: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-07 20:49:18.045597: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-07 20:49:18.053368: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-07 20:49:18.056912: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-07 20:49:18.090003: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-07 20:49:18.092553: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-07 20:49:18.095230: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-07 20:49:18.097948: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-07 20:49:18.111469: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
=================================================
        TRAINING v0.4.1 (binaryClasses)
=================================================
Date: 2020-02-07 20:48:37.434914
[INFO] input_shape (100, 16)
[INFO] LSTM first and last layer neurons: 2
[INFO] adding core layer 0
[INFO] created DNN
[33m[INFO] epoch 1/3[0m
[33m[INFO] loading file 1-2/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1000000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] processing batch 0-1000000/1000000
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 40s - loss: 0.6378 - tp: 617943.0000 - fp: 178857.0000 - tn: 621143.0000 - fn: 182057.0000 - accuracy: 0.7744 - precision: 0.7755 - recall: 0.7724 - auc: 0.7755 - val_loss: 0.6279 - val_tp: 140283.0000 - val_fp: 59717.0000 - val_tn: 140283.0000 - val_fn: 59717.0000 - val_accuracy: 0.7014 - val_precision: 0.7014 - val_recall: 0.7014 - val_auc: 0.7014
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-2-batch-0-1000000
[33m[INFO] loading file 3-4/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1000000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] processing batch 0-1000000/1000000
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 37s - loss: 0.4593 - tp: 733557.0000 - fp: 66443.0000 - tn: 733557.0000 - fn: 66443.0000 - accuracy: 0.9169 - precision: 0.9169 - recall: 0.9169 - auc: 0.9176 - val_loss: 0.5344 - val_tp: 156221.0000 - val_fp: 43779.0000 - val_tn: 156221.0000 - val_fn: 43779.0000 - val_accuracy: 0.7811 - val_precision: 0.7811 - val_recall: 0.7811 - val_auc: 0.7811
[INFO] saving weights to checkpoints/lstm-epoch-001-files-2-4-batch-0-1000000
[33m[INFO] loading file 5-6/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1000000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] processing batch 0-1000000/1000000
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 36s - loss: 0.3560 - tp: 743655.0000 - fp: 56345.0000 - tn: 743655.0000 - fn: 56345.0000 - accuracy: 0.9296 - precision: 0.9296 - recall: 0.9296 - auc: 0.9281 - val_loss: 0.5033 - val_tp: 159595.0000 - val_fp: 40405.0000 - val_tn: 159595.0000 - val_fn: 40405.0000 - val_accuracy: 0.7980 - val_precision: 0.7980 - val_recall: 0.7980 - val_auc: 0.7980
[INFO] saving weights to checkpoints/lstm-epoch-001-files-4-6-batch-0-1000000
[33m[INFO] loading file 7-8/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1000000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] processing batch 0-1000000/1000000
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 37s - loss: 0.3675 - tp: 713581.0000 - fp: 86419.0000 - tn: 713581.0000 - fn: 86419.0000 - accuracy: 0.8920 - precision: 0.8920 - recall: 0.8920 - auc: 0.8922 - val_loss: 0.4138 - val_tp: 171422.0000 - val_fp: 28578.0000 - val_tn: 171422.0000 - val_fn: 28578.0000 - val_accuracy: 0.8571 - val_precision: 0.8571 - val_recall: 0.8571 - val_auc: 0.8571
[INFO] saving weights to checkpoints/lstm-epoch-001-files-6-8-batch-0-1000000
[33m[INFO] loading file 9-10/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1000000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] processing batch 0-1000000/1000000
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 35s - loss: 0.2749 - tp: 749970.0000 - fp: 50030.0000 - tn: 749970.0000 - fn: 50030.0000 - accuracy: 0.9375 - precision: 0.9375 - recall: 0.9375 - auc: 0.9374 - val_loss: 0.1487 - val_tp: 200000.0000 - val_fp: 0.0000e+00 - val_tn: 200000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-8-10-batch-0-1000000
[33m[INFO] loading file 11-12/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1000000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] processing batch 0-1000000/1000000
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 37s - loss: 0.2203 - tp: 763809.0000 - fp: 36191.0000 - tn: 763809.0000 - fn: 36191.0000 - accuracy: 0.9548 - precision: 0.9548 - recall: 0.9548 - auc: 0.9555 - val_loss: 0.1161 - val_tp: 200000.0000 - val_fp: 0.0000e+00 - val_tn: 200000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-10-12-batch-0-1000000
[33m[INFO] loading file 13-14/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1000000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] processing batch 0-1000000/1000000
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 35s - loss: 0.3621 - tp: 706030.0000 - fp: 93970.0000 - tn: 706030.0000 - fn: 93970.0000 - accuracy: 0.8825 - precision: 0.8825 - recall: 0.8825 - auc: 0.8820 - val_loss: 0.1183 - val_tp: 200000.0000 - val_fp: 0.0000e+00 - val_tn: 200000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-12-14-batch-0-1000000
[33m[INFO] loading file 15-16/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (939690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] processing batch 0-1000000/939690
[33m[INFO] loading file 17-18/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1939690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1939690
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 35s - loss: 0.4364 - tp: 676261.0000 - fp: 123739.0000 - tn: 676261.0000 - fn: 123739.0000 - accuracy: 0.8453 - precision: 0.8453 - recall: 0.8453 - auc: 0.8442 - val_loss: 0.1359 - val_tp: 200000.0000 - val_fp: 0.0000e+00 - val_tn: 200000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-16-18-batch-0-1000000
[INFO] processing batch 1000000-2000000/1939690
[33m[INFO] loading file 19-20/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1939690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1939690
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 37s - loss: 0.4420 - tp: 672152.0000 - fp: 127848.0000 - tn: 672152.0000 - fn: 127848.0000 - accuracy: 0.8402 - precision: 0.8402 - recall: 0.8402 - auc: 0.8410 - val_loss: 0.1530 - val_tp: 200000.0000 - val_fp: 0.0000e+00 - val_tn: 200000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-18-20-batch-0-1000000
[INFO] processing batch 1000000-2000000/1939690
[33m[INFO] loading file 21-22/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1939687, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1939687
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 36s - loss: 0.4062 - tp: 687461.0000 - fp: 112539.0000 - tn: 687461.0000 - fn: 112539.0000 - accuracy: 0.8593 - precision: 0.8593 - recall: 0.8593 - auc: 0.8583 - val_loss: 0.1530 - val_tp: 200000.0000 - val_fp: 0.0000e+00 - val_tn: 200000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-20-22-batch-0-1000000
[INFO] processing batch 1000000-2000000/1939687
[33m[INFO] loading file 23-24/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1939687, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1939687
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 37s - loss: 0.5369 - tp: 624588.0000 - fp: 175412.0000 - tn: 624588.0000 - fn: 175412.0000 - accuracy: 0.7807 - precision: 0.7807 - recall: 0.7807 - auc: 0.7801 - val_loss: 0.7586 - val_tp: 125264.0000 - val_fp: 74736.0000 - val_tn: 125264.0000 - val_fn: 74736.0000 - val_accuracy: 0.6263 - val_precision: 0.6263 - val_recall: 0.6263 - val_auc: 0.6263
[INFO] saving weights to checkpoints/lstm-epoch-001-files-22-24-batch-0-1000000
[INFO] processing batch 1000000-2000000/1939687
[33m[INFO] loading file 25-26/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1939687, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1939687
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 35s - loss: 0.1468 - tp: 800000.0000 - fp: 0.0000e+00 - tn: 800000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.6214 - val_tp: 152954.0000 - val_fp: 47046.0000 - val_tn: 152954.0000 - val_fn: 47046.0000 - val_accuracy: 0.7648 - val_precision: 0.7648 - val_recall: 0.7648 - val_auc: 0.7648
[INFO] saving weights to checkpoints/lstm-epoch-001-files-24-26-batch-0-1000000
[INFO] processing batch 1000000-2000000/1939687
[33m[INFO] loading file 27-28/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1879817, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1879817
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 34s - loss: 0.7878 - tp: 515023.0000 - fp: 284977.0000 - tn: 515023.0000 - fn: 284977.0000 - accuracy: 0.6438 - precision: 0.6438 - recall: 0.6438 - auc: 0.6438 - val_loss: 0.7143 - val_tp: 128667.0000 - val_fp: 71333.0000 - val_tn: 128667.0000 - val_fn: 71333.0000 - val_accuracy: 0.6433 - val_precision: 0.6433 - val_recall: 0.6433 - val_auc: 0.6433
[INFO] saving weights to checkpoints/lstm-epoch-001-files-26-28-batch-0-1000000
[INFO] processing batch 1000000-2000000/1879817
[33m[INFO] loading file 29-30/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1879817, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1879817
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 34s - loss: 0.6835 - tp: 514771.0000 - fp: 285229.0000 - tn: 514771.0000 - fn: 285229.0000 - accuracy: 0.6435 - precision: 0.6435 - recall: 0.6435 - auc: 0.6434 - val_loss: 0.6641 - val_tp: 128693.0000 - val_fp: 71307.0000 - val_tn: 128693.0000 - val_fn: 71307.0000 - val_accuracy: 0.6435 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.6435
[INFO] saving weights to checkpoints/lstm-epoch-001-files-28-30-batch-0-1000000
[INFO] processing batch 1000000-2000000/1879817
[33m[INFO] loading file 31-32/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1879817, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1879817
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 34s - loss: 0.6570 - tp: 515055.0000 - fp: 284945.0000 - tn: 515055.0000 - fn: 284945.0000 - accuracy: 0.6438 - precision: 0.6438 - recall: 0.6438 - auc: 0.6439 - val_loss: 0.6528 - val_tp: 128841.0000 - val_fp: 71159.0000 - val_tn: 128841.0000 - val_fn: 71159.0000 - val_accuracy: 0.6442 - val_precision: 0.6442 - val_recall: 0.6442 - val_auc: 0.6442
[INFO] saving weights to checkpoints/lstm-epoch-001-files-30-32-batch-0-1000000
[INFO] processing batch 1000000-2000000/1879817
[33m[INFO] loading file 33-34/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1879817, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1879817
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 36s - loss: 0.6520 - tp: 514982.0000 - fp: 285018.0000 - tn: 514982.0000 - fn: 285018.0000 - accuracy: 0.6437 - precision: 0.6437 - recall: 0.6437 - auc: 0.6440 - val_loss: 0.6514 - val_tp: 128765.0000 - val_fp: 71235.0000 - val_tn: 128765.0000 - val_fn: 71235.0000 - val_accuracy: 0.6438 - val_precision: 0.6438 - val_recall: 0.6438 - val_auc: 0.6438
[INFO] saving weights to checkpoints/lstm-epoch-001-files-32-34-batch-0-1000000
[INFO] processing batch 1000000-2000000/1879817
[33m[INFO] loading file 35-36/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1879817, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1879817
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 34s - loss: 0.6514 - tp: 514914.0000 - fp: 285086.0000 - tn: 514914.0000 - fn: 285086.0000 - accuracy: 0.6436 - precision: 0.6436 - recall: 0.6436 - auc: 0.6435 - val_loss: 0.6513 - val_tp: 128739.0000 - val_fp: 71261.0000 - val_tn: 128739.0000 - val_fn: 71261.0000 - val_accuracy: 0.6437 - val_precision: 0.6437 - val_recall: 0.6437 - val_auc: 0.6437
[INFO] saving weights to checkpoints/lstm-epoch-001-files-34-36-batch-0-1000000
[INFO] processing batch 1000000-2000000/1879817
[33m[INFO] loading file 37-38/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1879817, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1879817
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 36s - loss: 0.6512 - tp: 515096.0000 - fp: 284904.0000 - tn: 515096.0000 - fn: 284904.0000 - accuracy: 0.6439 - precision: 0.6439 - recall: 0.6439 - auc: 0.6439 - val_loss: 0.6516 - val_tp: 128626.0000 - val_fp: 71374.0000 - val_tn: 128626.0000 - val_fn: 71374.0000 - val_accuracy: 0.6431 - val_precision: 0.6431 - val_recall: 0.6431 - val_auc: 0.6431
[INFO] saving weights to checkpoints/lstm-epoch-001-files-36-38-batch-0-1000000
[INFO] processing batch 1000000-2000000/1879817
[33m[INFO] loading file 39-40/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1879817, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1879817
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 37s - loss: 0.6510 - tp: 515339.0000 - fp: 284661.0000 - tn: 515339.0000 - fn: 284661.0000 - accuracy: 0.6442 - precision: 0.6442 - recall: 0.6442 - auc: 0.6442 - val_loss: 0.6510 - val_tp: 128840.0000 - val_fp: 71160.0000 - val_tn: 128840.0000 - val_fn: 71160.0000 - val_accuracy: 0.6442 - val_precision: 0.6442 - val_recall: 0.6442 - val_auc: 0.6442
[INFO] saving weights to checkpoints/lstm-epoch-001-files-38-40-batch-0-1000000
[INFO] processing batch 1000000-2000000/1879817
[33m[INFO] loading file 41-42/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1819975, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1819975
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 36s - loss: 0.6513 - tp: 514961.0000 - fp: 285039.0000 - tn: 514961.0000 - fn: 285039.0000 - accuracy: 0.6437 - precision: 0.6437 - recall: 0.6437 - auc: 0.6437 - val_loss: 0.6515 - val_tp: 128671.0000 - val_fp: 71329.0000 - val_tn: 128671.0000 - val_fn: 71329.0000 - val_accuracy: 0.6434 - val_precision: 0.6434 - val_recall: 0.6434 - val_auc: 0.6434
[INFO] saving weights to checkpoints/lstm-epoch-001-files-40-42-batch-0-1000000
[INFO] processing batch 1000000-2000000/1819975
[33m[INFO] loading file 43-44/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1819975, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1819975
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 37s - loss: 0.6511 - tp: 515178.0000 - fp: 284822.0000 - tn: 515178.0000 - fn: 284822.0000 - accuracy: 0.6440 - precision: 0.6440 - recall: 0.6440 - auc: 0.6440 - val_loss: 0.6510 - val_tp: 128817.0000 - val_fp: 71183.0000 - val_tn: 128817.0000 - val_fn: 71183.0000 - val_accuracy: 0.6441 - val_precision: 0.6441 - val_recall: 0.6441 - val_auc: 0.6441
[INFO] saving weights to checkpoints/lstm-epoch-001-files-42-44-batch-0-1000000
[INFO] processing batch 1000000-2000000/1819975
[33m[INFO] loading file 45-46/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1819975, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1819975
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 37s - loss: 0.6513 - tp: 514967.0000 - fp: 285033.0000 - tn: 514967.0000 - fn: 285033.0000 - accuracy: 0.6437 - precision: 0.6437 - recall: 0.6437 - auc: 0.6437 - val_loss: 0.6507 - val_tp: 128912.0000 - val_fp: 71088.0000 - val_tn: 128912.0000 - val_fn: 71088.0000 - val_accuracy: 0.6446 - val_precision: 0.6446 - val_recall: 0.6446 - val_auc: 0.6446
[INFO] saving weights to checkpoints/lstm-epoch-001-files-44-46-batch-0-1000000
[INFO] processing batch 1000000-2000000/1819975
[33m[INFO] loading file 47-48/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1819975, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1819975
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 37s - loss: 0.6510 - tp: 515268.0000 - fp: 284732.0000 - tn: 515268.0000 - fn: 284732.0000 - accuracy: 0.6441 - precision: 0.6441 - recall: 0.6441 - auc: 0.6441 - val_loss: 0.6507 - val_tp: 128923.0000 - val_fp: 71077.0000 - val_tn: 128923.0000 - val_fn: 71077.0000 - val_accuracy: 0.6446 - val_precision: 0.6446 - val_recall: 0.6446 - val_auc: 0.6446
[INFO] saving weights to checkpoints/lstm-epoch-001-files-46-48-batch-0-1000000
[INFO] processing batch 1000000-2000000/1819975
[33m[INFO] loading file 49-50/50 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1819975, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1819975
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 35s - loss: 0.6511 - tp: 515194.0000 - fp: 284806.0000 - tn: 515194.0000 - fn: 284806.0000 - accuracy: 0.6440 - precision: 0.6440 - recall: 0.6440 - auc: 0.6440 - val_loss: 0.6512 - val_tp: 128751.0000 - val_fp: 71249.0000 - val_tn: 128751.0000 - val_fn: 71249.0000 - val_accuracy: 0.6438 - val_precision: 0.6438 - val_recall: 0.6438 - val_auc: 0.6438
[INFO] saving weights to checkpoints/lstm-epoch-001-files-48-50-batch-0-1000000
[INFO] processing batch 1000000-2000000/1819975
[33m[LOSS] 0.6512270088195801[0m
[33m[INFO] epoch 2/3[0m
[33m[INFO] loading file 1-2/50 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1000000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] processing batch 0-1000000/1000000
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 36s - loss: 0.5423 - tp: 620154.0000 - fp: 179846.0000 - tn: 620154.0000 - fn: 179846.0000 - accuracy: 0.7752 - precision: 0.7752 - recall: 0.7752 - auc: 0.7752 - val_loss: 0.6195 - val_tp: 140283.0000 - val_fp: 59717.0000 - val_tn: 140283.0000 - val_fn: 59717.0000 - val_accuracy: 0.7014 - val_precision: 0.7014 - val_recall: 0.7014 - val_auc: 0.7014
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-2-batch-0-1000000
[33m[INFO] loading file 3-4/50 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1000000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] processing batch 0-1000000/1000000
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 36s - loss: 0.3200 - tp: 733557.0000 - fp: 66443.0000 - tn: 733557.0000 - fn: 66443.0000 - accuracy: 0.9169 - precision: 0.9169 - recall: 0.9169 - auc: 0.9163 - val_loss: 0.5556 - val_tp: 156221.0000 - val_fp: 43779.0000 - val_tn: 156221.0000 - val_fn: 43779.0000 - val_accuracy: 0.7811 - val_precision: 0.7811 - val_recall: 0.7811 - val_auc: 0.7811
[INFO] saving weights to checkpoints/lstm-epoch-002-files-2-4-batch-0-1000000
[33m[INFO] loading file 5-6/50 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1000000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] processing batch 0-1000000/1000000
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 35s - loss: 0.2643 - tp: 743655.0000 - fp: 56345.0000 - tn: 743655.0000 - fn: 56345.0000 - accuracy: 0.9296 - precision: 0.9296 - recall: 0.9296 - auc: 0.9292 - val_loss: 0.5535 - val_tp: 159595.0000 - val_fp: 40405.0000 - val_tn: 159595.0000 - val_fn: 40405.0000 - val_accuracy: 0.7980 - val_precision: 0.7980 - val_recall: 0.7980 - val_auc: 0.7980
[INFO] saving weights to checkpoints/lstm-epoch-002-files-4-6-batch-0-1000000
[33m[INFO] loading file 7-8/50 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1000000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] processing batch 0-1000000/1000000
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 35s - loss: 0.3428 - tp: 713581.0000 - fp: 86419.0000 - tn: 713581.0000 - fn: 86419.0000 - accuracy: 0.8920 - precision: 0.8920 - recall: 0.8920 - auc: 0.8928 - val_loss: 0.4180 - val_tp: 171422.0000 - val_fp: 28578.0000 - val_tn: 171422.0000 - val_fn: 28578.0000 - val_accuracy: 0.8571 - val_precision: 0.8571 - val_recall: 0.8571 - val_auc: 0.8571
[INFO] saving weights to checkpoints/lstm-epoch-002-files-6-8-batch-0-1000000
[33m[INFO] loading file 9-10/50 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1000000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] processing batch 0-1000000/1000000
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 35s - loss: 0.2395 - tp: 749970.0000 - fp: 50030.0000 - tn: 749970.0000 - fn: 50030.0000 - accuracy: 0.9375 - precision: 0.9375 - recall: 0.9375 - auc: 0.9377 - val_loss: 0.0846 - val_tp: 200000.0000 - val_fp: 0.0000e+00 - val_tn: 200000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-8-10-batch-0-1000000
[33m[INFO] loading file 11-12/50 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1000000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] processing batch 0-1000000/1000000
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 39s - loss: 0.1901 - tp: 763809.0000 - fp: 36191.0000 - tn: 763809.0000 - fn: 36191.0000 - accuracy: 0.9548 - precision: 0.9548 - recall: 0.9548 - auc: 0.9554 - val_loss: 0.0652 - val_tp: 200000.0000 - val_fp: 0.0000e+00 - val_tn: 200000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-10-12-batch-0-1000000
[33m[INFO] loading file 13-14/50 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1000000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] processing batch 0-1000000/1000000
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 34s - loss: 0.3726 - tp: 706030.0000 - fp: 93970.0000 - tn: 706030.0000 - fn: 93970.0000 - accuracy: 0.8825 - precision: 0.8825 - recall: 0.8825 - auc: 0.8794 - val_loss: 0.0951 - val_tp: 200000.0000 - val_fp: 0.0000e+00 - val_tn: 200000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-12-14-batch-0-1000000
[33m[INFO] loading file 15-16/50 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (939690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] processing batch 0-1000000/939690
[33m[INFO] loading file 17-18/50 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1939690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1939690
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 38s - loss: 0.4396 - tp: 676261.0000 - fp: 123739.0000 - tn: 676261.0000 - fn: 123739.0000 - accuracy: 0.8453 - precision: 0.8453 - recall: 0.8453 - auc: 0.8450 - val_loss: 0.1415 - val_tp: 200000.0000 - val_fp: 0.0000e+00 - val_tn: 200000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-16-18-batch-0-1000000
[INFO] processing batch 1000000-2000000/1939690
[33m[INFO] loading file 19-20/50 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1939690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1939690
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 38s - loss: 0.4405 - tp: 672152.0000 - fp: 127848.0000 - tn: 672152.0000 - fn: 127848.0000 - accuracy: 0.8402 - precision: 0.8402 - recall: 0.8402 - auc: 0.8410 - val_loss: 0.1655 - val_tp: 200000.0000 - val_fp: 0.0000e+00 - val_tn: 200000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-18-20-batch-0-1000000
[INFO] processing batch 1000000-2000000/1939690
[33m[INFO] loading file 21-22/50 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1939687, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1939687
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 36s - loss: 0.4064 - tp: 687461.0000 - fp: 112539.0000 - tn: 687461.0000 - fn: 112539.0000 - accuracy: 0.8593 - precision: 0.8593 - recall: 0.8593 - auc: 0.8594 - val_loss: 0.1552 - val_tp: 200000.0000 - val_fp: 0.0000e+00 - val_tn: 200000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-20-22-batch-0-1000000
[INFO] processing batch 1000000-2000000/1939687
[33m[INFO] loading file 23-24/50 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1939687, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1939687
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 36s - loss: 0.5327 - tp: 624588.0000 - fp: 175412.0000 - tn: 624588.0000 - fn: 175412.0000 - accuracy: 0.7807 - precision: 0.7807 - recall: 0.7807 - auc: 0.7824 - val_loss: 0.7370 - val_tp: 125264.0000 - val_fp: 74736.0000 - val_tn: 125264.0000 - val_fn: 74736.0000 - val_accuracy: 0.6263 - val_precision: 0.6263 - val_recall: 0.6263 - val_auc: 0.6263
[INFO] saving weights to checkpoints/lstm-epoch-002-files-22-24-batch-0-1000000
[INFO] processing batch 1000000-2000000/1939687
[33m[INFO] loading file 25-26/50 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1939687, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1939687
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 36s - loss: 0.1435 - tp: 800000.0000 - fp: 0.0000e+00 - tn: 800000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.6379 - val_tp: 152954.0000 - val_fp: 47046.0000 - val_tn: 152954.0000 - val_fn: 47046.0000 - val_accuracy: 0.7648 - val_precision: 0.7648 - val_recall: 0.7648 - val_auc: 0.7648
[INFO] saving weights to checkpoints/lstm-epoch-002-files-24-26-batch-0-1000000
[INFO] processing batch 1000000-2000000/1939687
[33m[INFO] loading file 27-28/50 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1879817, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1879817
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 36s - loss: 0.7960 - tp: 515023.0000 - fp: 284977.0000 - tn: 515023.0000 - fn: 284977.0000 - accuracy: 0.6438 - precision: 0.6438 - recall: 0.6438 - auc: 0.6439 - val_loss: 0.7120 - val_tp: 128667.0000 - val_fp: 71333.0000 - val_tn: 128667.0000 - val_fn: 71333.0000 - val_accuracy: 0.6433 - val_precision: 0.6433 - val_recall: 0.6433 - val_auc: 0.6433
[INFO] saving weights to checkpoints/lstm-epoch-002-files-26-28-batch-0-1000000
[INFO] processing batch 1000000-2000000/1879817
[33m[INFO] loading file 29-30/50 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1879817, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1879817
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 37s - loss: 0.6807 - tp: 514771.0000 - fp: 285229.0000 - tn: 514771.0000 - fn: 285229.0000 - accuracy: 0.6435 - precision: 0.6435 - recall: 0.6435 - auc: 0.6433 - val_loss: 0.6619 - val_tp: 128693.0000 - val_fp: 71307.0000 - val_tn: 128693.0000 - val_fn: 71307.0000 - val_accuracy: 0.6435 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.6435
[INFO] saving weights to checkpoints/lstm-epoch-002-files-28-30-batch-0-1000000
[INFO] processing batch 1000000-2000000/1879817
[33m[INFO] loading file 31-32/50 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1879817, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1879817
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 43s - loss: 0.6557 - tp: 515055.0000 - fp: 284945.0000 - tn: 515055.0000 - fn: 284945.0000 - accuracy: 0.6438 - precision: 0.6438 - recall: 0.6438 - auc: 0.6439 - val_loss: 0.6522 - val_tp: 128841.0000 - val_fp: 71159.0000 - val_tn: 128841.0000 - val_fn: 71159.0000 - val_accuracy: 0.6442 - val_precision: 0.6442 - val_recall: 0.6442 - val_auc: 0.6442
[INFO] saving weights to checkpoints/lstm-epoch-002-files-30-32-batch-0-1000000
[INFO] processing batch 1000000-2000000/1879817
[33m[INFO] loading file 33-34/50 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1879817, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1879817
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 38s - loss: 0.6518 - tp: 514982.0000 - fp: 285018.0000 - tn: 514982.0000 - fn: 285018.0000 - accuracy: 0.6437 - precision: 0.6437 - recall: 0.6437 - auc: 0.6438 - val_loss: 0.6513 - val_tp: 128765.0000 - val_fp: 71235.0000 - val_tn: 128765.0000 - val_fn: 71235.0000 - val_accuracy: 0.6438 - val_precision: 0.6438 - val_recall: 0.6438 - val_auc: 0.6438
[INFO] saving weights to checkpoints/lstm-epoch-002-files-32-34-batch-0-1000000
[INFO] processing batch 1000000-2000000/1879817
[33m[INFO] loading file 35-36/50 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1879817, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1879817
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 38s - loss: 0.6513 - tp: 514914.0000 - fp: 285086.0000 - tn: 514914.0000 - fn: 285086.0000 - accuracy: 0.6436 - precision: 0.6436 - recall: 0.6436 - auc: 0.6437 - val_loss: 0.6513 - val_tp: 128739.0000 - val_fp: 71261.0000 - val_tn: 128739.0000 - val_fn: 71261.0000 - val_accuracy: 0.6437 - val_precision: 0.6437 - val_recall: 0.6437 - val_auc: 0.6437
[INFO] saving weights to checkpoints/lstm-epoch-002-files-34-36-batch-0-1000000
[INFO] processing batch 1000000-2000000/1879817
[33m[INFO] loading file 37-38/50 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1879817, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1879817
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 37s - loss: 0.6512 - tp: 515096.0000 - fp: 284904.0000 - tn: 515096.0000 - fn: 284904.0000 - accuracy: 0.6439 - precision: 0.6439 - recall: 0.6439 - auc: 0.6439 - val_loss: 0.6516 - val_tp: 128626.0000 - val_fp: 71374.0000 - val_tn: 128626.0000 - val_fn: 71374.0000 - val_accuracy: 0.6431 - val_precision: 0.6431 - val_recall: 0.6431 - val_auc: 0.6431
[INFO] saving weights to checkpoints/lstm-epoch-002-files-36-38-batch-0-1000000
[INFO] processing batch 1000000-2000000/1879817
[33m[INFO] loading file 39-40/50 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1879817, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1879817
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 37s - loss: 0.6510 - tp: 515339.0000 - fp: 284661.0000 - tn: 515339.0000 - fn: 284661.0000 - accuracy: 0.6442 - precision: 0.6442 - recall: 0.6442 - auc: 0.6442 - val_loss: 0.6510 - val_tp: 128840.0000 - val_fp: 71160.0000 - val_tn: 128840.0000 - val_fn: 71160.0000 - val_accuracy: 0.6442 - val_precision: 0.6442 - val_recall: 0.6442 - val_auc: 0.6442
[INFO] saving weights to checkpoints/lstm-epoch-002-files-38-40-batch-0-1000000
[INFO] processing batch 1000000-2000000/1879817
[33m[INFO] loading file 41-42/50 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1819975, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1819975
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 36s - loss: 0.6513 - tp: 514961.0000 - fp: 285039.0000 - tn: 514961.0000 - fn: 285039.0000 - accuracy: 0.6437 - precision: 0.6437 - recall: 0.6437 - auc: 0.6437 - val_loss: 0.6515 - val_tp: 128671.0000 - val_fp: 71329.0000 - val_tn: 128671.0000 - val_fn: 71329.0000 - val_accuracy: 0.6434 - val_precision: 0.6434 - val_recall: 0.6434 - val_auc: 0.6434
[INFO] saving weights to checkpoints/lstm-epoch-002-files-40-42-batch-0-1000000
[INFO] processing batch 1000000-2000000/1819975
[33m[INFO] loading file 43-44/50 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1819975, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1819975
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 35s - loss: 0.6511 - tp: 515178.0000 - fp: 284822.0000 - tn: 515178.0000 - fn: 284822.0000 - accuracy: 0.6440 - precision: 0.6440 - recall: 0.6440 - auc: 0.6440 - val_loss: 0.6510 - val_tp: 128817.0000 - val_fp: 71183.0000 - val_tn: 128817.0000 - val_fn: 71183.0000 - val_accuracy: 0.6441 - val_precision: 0.6441 - val_recall: 0.6441 - val_auc: 0.6441
[INFO] saving weights to checkpoints/lstm-epoch-002-files-42-44-batch-0-1000000
[INFO] processing batch 1000000-2000000/1819975
[33m[INFO] loading file 45-46/50 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1819975, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1819975
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 36s - loss: 0.6513 - tp: 514967.0000 - fp: 285033.0000 - tn: 514967.0000 - fn: 285033.0000 - accuracy: 0.6437 - precision: 0.6437 - recall: 0.6437 - auc: 0.6437 - val_loss: 0.6507 - val_tp: 128912.0000 - val_fp: 71088.0000 - val_tn: 128912.0000 - val_fn: 71088.0000 - val_accuracy: 0.6446 - val_precision: 0.6446 - val_recall: 0.6446 - val_auc: 0.6446
[INFO] saving weights to checkpoints/lstm-epoch-002-files-44-46-batch-0-1000000
[INFO] processing batch 1000000-2000000/1819975
[33m[INFO] loading file 47-48/50 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1819975, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1819975
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 36s - loss: 0.6510 - tp: 515268.0000 - fp: 284732.0000 - tn: 515268.0000 - fn: 284732.0000 - accuracy: 0.6441 - precision: 0.6441 - recall: 0.6441 - auc: 0.6441 - val_loss: 0.6507 - val_tp: 128923.0000 - val_fp: 71077.0000 - val_tn: 128923.0000 - val_fn: 71077.0000 - val_accuracy: 0.6446 - val_precision: 0.6446 - val_recall: 0.6446 - val_auc: 0.6446
[INFO] saving weights to checkpoints/lstm-epoch-002-files-46-48-batch-0-1000000
[INFO] processing batch 1000000-2000000/1819975
[33m[INFO] loading file 49-50/50 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1819975, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1819975
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 37s - loss: 0.6511 - tp: 515194.0000 - fp: 284806.0000 - tn: 515194.0000 - fn: 284806.0000 - accuracy: 0.6440 - precision: 0.6440 - recall: 0.6440 - auc: 0.6440 - val_loss: 0.6512 - val_tp: 128751.0000 - val_fp: 71249.0000 - val_tn: 128751.0000 - val_fn: 71249.0000 - val_accuracy: 0.6438 - val_precision: 0.6438 - val_recall: 0.6438 - val_auc: 0.6438
[INFO] saving weights to checkpoints/lstm-epoch-002-files-48-50-batch-0-1000000
[INFO] processing batch 1000000-2000000/1819975
[33m[LOSS] 0.651229838848114[0m
[33m[INFO] epoch 3/3[0m
[33m[INFO] loading file 1-2/50 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1000000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] processing batch 0-1000000/1000000
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 36s - loss: 0.5416 - tp: 620154.0000 - fp: 179846.0000 - tn: 620154.0000 - fn: 179846.0000 - accuracy: 0.7752 - precision: 0.7752 - recall: 0.7752 - auc: 0.7770 - val_loss: 0.6203 - val_tp: 140283.0000 - val_fp: 59717.0000 - val_tn: 140283.0000 - val_fn: 59717.0000 - val_accuracy: 0.7014 - val_precision: 0.7014 - val_recall: 0.7014 - val_auc: 0.7014
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-2-batch-0-1000000
[33m[INFO] loading file 3-4/50 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_164554_99.log.part01_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_164554_99.log.part02_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1000000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] processing batch 0-1000000/1000000
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 38s - loss: 0.3181 - tp: 733557.0000 - fp: 66443.0000 - tn: 733557.0000 - fn: 66443.0000 - accuracy: 0.9169 - precision: 0.9169 - recall: 0.9169 - auc: 0.9155 - val_loss: 0.5574 - val_tp: 156221.0000 - val_fp: 43779.0000 - val_tn: 156221.0000 - val_fn: 43779.0000 - val_accuracy: 0.7811 - val_precision: 0.7811 - val_recall: 0.7811 - val_auc: 0.7811
[INFO] saving weights to checkpoints/lstm-epoch-003-files-2-4-batch-0-1000000
[33m[INFO] loading file 5-6/50 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_164554_99.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_164554_99.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1000000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] processing batch 0-1000000/1000000
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 34s - loss: 0.2635 - tp: 743655.0000 - fp: 56345.0000 - tn: 743655.0000 - fn: 56345.0000 - accuracy: 0.9296 - precision: 0.9296 - recall: 0.9296 - auc: 0.9300 - val_loss: 0.5556 - val_tp: 159595.0000 - val_fp: 40405.0000 - val_tn: 159595.0000 - val_fn: 40405.0000 - val_accuracy: 0.7980 - val_precision: 0.7980 - val_recall: 0.7980 - val_auc: 0.7980
[INFO] saving weights to checkpoints/lstm-epoch-003-files-4-6-batch-0-1000000
[33m[INFO] loading file 7-8/50 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_164554_99.log.part06_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_164554_99.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1000000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] processing batch 0-1000000/1000000
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 37s - loss: 0.3429 - tp: 713581.0000 - fp: 86419.0000 - tn: 713581.0000 - fn: 86419.0000 - accuracy: 0.8920 - precision: 0.8920 - recall: 0.8920 - auc: 0.8923 - val_loss: 0.4185 - val_tp: 171422.0000 - val_fp: 28578.0000 - val_tn: 171422.0000 - val_fn: 28578.0000 - val_accuracy: 0.8571 - val_precision: 0.8571 - val_recall: 0.8571 - val_auc: 0.8571
[INFO] saving weights to checkpoints/lstm-epoch-003-files-6-8-batch-0-1000000
[33m[INFO] loading file 9-10/50 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-28_164554_99.log.part09_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-29_134830_103.log.part08_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1000000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] processing batch 0-1000000/1000000
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 36s - loss: 0.2391 - tp: 749970.0000 - fp: 50030.0000 - tn: 749970.0000 - fn: 50030.0000 - accuracy: 0.9375 - precision: 0.9375 - recall: 0.9375 - auc: 0.9386 - val_loss: 0.0835 - val_tp: 200000.0000 - val_fp: 0.0000e+00 - val_tn: 200000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-8-10-batch-0-1000000
[33m[INFO] loading file 11-12/50 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-29_134830_103.log.part09_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-29_134830_103.log.part10_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1000000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] processing batch 0-1000000/1000000
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 33s - loss: 0.1898 - tp: 763809.0000 - fp: 36191.0000 - tn: 763809.0000 - fn: 36191.0000 - accuracy: 0.9548 - precision: 0.9548 - recall: 0.9548 - auc: 0.9539 - val_loss: 0.0648 - val_tp: 200000.0000 - val_fp: 0.0000e+00 - val_tn: 200000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-10-12-batch-0-1000000
[33m[INFO] loading file 13-14/50 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-29_190411_104.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-29_190411_104.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1000000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] processing batch 0-1000000/1000000
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 36s - loss: 0.3725 - tp: 706030.0000 - fp: 93970.0000 - tn: 706030.0000 - fn: 93970.0000 - accuracy: 0.8825 - precision: 0.8825 - recall: 0.8825 - auc: 0.8831 - val_loss: 0.0964 - val_tp: 200000.0000 - val_fp: 0.0000e+00 - val_tn: 200000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-12-14-batch-0-1000000
[33m[INFO] loading file 15-16/50 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-29_190411_104.log.part13_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-29_190411_104.log.part14_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (939690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] processing batch 0-1000000/939690
[33m[INFO] loading file 17-18/50 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-30_001940_105.log.part11_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-30_053515_106.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1939690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1939690
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 37s - loss: 0.4392 - tp: 676261.0000 - fp: 123739.0000 - tn: 676261.0000 - fn: 123739.0000 - accuracy: 0.8453 - precision: 0.8453 - recall: 0.8453 - auc: 0.8433 - val_loss: 0.1423 - val_tp: 200000.0000 - val_fp: 0.0000e+00 - val_tn: 200000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-16-18-batch-0-1000000
[INFO] processing batch 1000000-2000000/1939690
[33m[INFO] loading file 19-20/50 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-30_105053_107.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-30_105053_107.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1939690, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1939690
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 36s - loss: 0.4405 - tp: 672152.0000 - fp: 127848.0000 - tn: 672152.0000 - fn: 127848.0000 - accuracy: 0.8402 - precision: 0.8402 - recall: 0.8402 - auc: 0.8409 - val_loss: 0.1659 - val_tp: 200000.0000 - val_fp: 0.0000e+00 - val_tn: 200000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-18-20-batch-0-1000000
[INFO] processing batch 1000000-2000000/1939690
[33m[INFO] loading file 21-22/50 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-30_212042_109.log.part03_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-30_212042_109.log.part04_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1939687, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1939687
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 34s - loss: 0.4064 - tp: 687461.0000 - fp: 112539.0000 - tn: 687461.0000 - fn: 112539.0000 - accuracy: 0.8593 - precision: 0.8593 - recall: 0.8593 - auc: 0.8592 - val_loss: 0.1554 - val_tp: 200000.0000 - val_fp: 0.0000e+00 - val_tn: 200000.0000 - val_fn: 0.0000e+00 - val_accuracy: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-20-22-batch-0-1000000
[INFO] processing batch 1000000-2000000/1939687
[33m[INFO] loading file 23-24/50 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-30_212042_109.log.part05_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_023431_110.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1939687, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1939687
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 36s - loss: 0.5327 - tp: 624588.0000 - fp: 175412.0000 - tn: 624588.0000 - fn: 175412.0000 - accuracy: 0.7807 - precision: 0.7807 - recall: 0.7807 - auc: 0.7798 - val_loss: 0.7375 - val_tp: 125264.0000 - val_fp: 74736.0000 - val_tn: 125264.0000 - val_fn: 74736.0000 - val_accuracy: 0.6263 - val_precision: 0.6263 - val_recall: 0.6263 - val_auc: 0.6263
[INFO] saving weights to checkpoints/lstm-epoch-003-files-22-24-batch-0-1000000
[INFO] processing batch 1000000-2000000/1939687
[33m[INFO] loading file 25-26/50 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_023431_110.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_023431_110.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1939687, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1939687
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 36s - loss: 0.1423 - tp: 800000.0000 - fp: 0.0000e+00 - tn: 800000.0000 - fn: 0.0000e+00 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000 - auc: 1.0000 - val_loss: 0.6393 - val_tp: 152954.0000 - val_fp: 47046.0000 - val_tn: 152954.0000 - val_fn: 47046.0000 - val_accuracy: 0.7648 - val_precision: 0.7648 - val_recall: 0.7648 - val_auc: 0.7648
[INFO] saving weights to checkpoints/lstm-epoch-003-files-24-26-batch-0-1000000
[INFO] processing batch 1000000-2000000/1939687
[33m[INFO] loading file 27-28/50 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_023431_110.log.part14_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1879817, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1879817
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 37s - loss: 0.7973 - tp: 515023.0000 - fp: 284977.0000 - tn: 515023.0000 - fn: 284977.0000 - accuracy: 0.6438 - precision: 0.6438 - recall: 0.6438 - auc: 0.6438 - val_loss: 0.7126 - val_tp: 128667.0000 - val_fp: 71333.0000 - val_tn: 128667.0000 - val_fn: 71333.0000 - val_accuracy: 0.6433 - val_precision: 0.6433 - val_recall: 0.6433 - val_auc: 0.6433
[INFO] saving weights to checkpoints/lstm-epoch-003-files-26-28-batch-0-1000000
[INFO] processing batch 1000000-2000000/1879817
[33m[INFO] loading file 29-30/50 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part02_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1879817, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1879817
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 38s - loss: 0.6810 - tp: 514771.0000 - fp: 285229.0000 - tn: 514771.0000 - fn: 285229.0000 - accuracy: 0.6435 - precision: 0.6435 - recall: 0.6435 - auc: 0.6433 - val_loss: 0.6620 - val_tp: 128693.0000 - val_fp: 71307.0000 - val_tn: 128693.0000 - val_fn: 71307.0000 - val_accuracy: 0.6435 - val_precision: 0.6435 - val_recall: 0.6435 - val_auc: 0.6435
[INFO] saving weights to checkpoints/lstm-epoch-003-files-28-30-batch-0-1000000
[INFO] processing batch 1000000-2000000/1879817
[33m[INFO] loading file 31-32/50 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part04_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1879817, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1879817
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 36s - loss: 0.6558 - tp: 515055.0000 - fp: 284945.0000 - tn: 515055.0000 - fn: 284945.0000 - accuracy: 0.6438 - precision: 0.6438 - recall: 0.6438 - auc: 0.6439 - val_loss: 0.6523 - val_tp: 128841.0000 - val_fp: 71159.0000 - val_tn: 128841.0000 - val_fn: 71159.0000 - val_accuracy: 0.6442 - val_precision: 0.6442 - val_recall: 0.6442 - val_auc: 0.6442
[INFO] saving weights to checkpoints/lstm-epoch-003-files-30-32-batch-0-1000000
[INFO] processing batch 1000000-2000000/1879817
[33m[INFO] loading file 33-34/50 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part06_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1879817, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1879817
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 35s - loss: 0.6518 - tp: 514982.0000 - fp: 285018.0000 - tn: 514982.0000 - fn: 285018.0000 - accuracy: 0.6437 - precision: 0.6437 - recall: 0.6437 - auc: 0.6438 - val_loss: 0.6513 - val_tp: 128765.0000 - val_fp: 71235.0000 - val_tn: 128765.0000 - val_fn: 71235.0000 - val_accuracy: 0.6438 - val_precision: 0.6438 - val_recall: 0.6438 - val_auc: 0.6438
[INFO] saving weights to checkpoints/lstm-epoch-003-files-32-34-batch-0-1000000
[INFO] processing batch 1000000-2000000/1879817
[33m[INFO] loading file 35-36/50 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part08_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1879817, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1879817
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 35s - loss: 0.6513 - tp: 514914.0000 - fp: 285086.0000 - tn: 514914.0000 - fn: 285086.0000 - accuracy: 0.6436 - precision: 0.6436 - recall: 0.6436 - auc: 0.6437 - val_loss: 0.6513 - val_tp: 128739.0000 - val_fp: 71261.0000 - val_tn: 128739.0000 - val_fn: 71261.0000 - val_accuracy: 0.6437 - val_precision: 0.6437 - val_recall: 0.6437 - val_auc: 0.6437
[INFO] saving weights to checkpoints/lstm-epoch-003-files-34-36-batch-0-1000000
[INFO] processing batch 1000000-2000000/1879817
[33m[INFO] loading file 37-38/50 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part10_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part11_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1879817, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1879817
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 35s - loss: 0.6512 - tp: 515096.0000 - fp: 284904.0000 - tn: 515096.0000 - fn: 284904.0000 - accuracy: 0.6439 - precision: 0.6439 - recall: 0.6439 - auc: 0.6439 - val_loss: 0.6516 - val_tp: 128626.0000 - val_fp: 71374.0000 - val_tn: 128626.0000 - val_fn: 71374.0000 - val_accuracy: 0.6431 - val_precision: 0.6431 - val_recall: 0.6431 - val_auc: 0.6431
[INFO] saving weights to checkpoints/lstm-epoch-003-files-36-38-batch-0-1000000
[INFO] processing batch 1000000-2000000/1879817
[33m[INFO] loading file 39-40/50 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part12_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1879817, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1879817
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 37s - loss: 0.6510 - tp: 515339.0000 - fp: 284661.0000 - tn: 515339.0000 - fn: 284661.0000 - accuracy: 0.6442 - precision: 0.6442 - recall: 0.6442 - auc: 0.6442 - val_loss: 0.6510 - val_tp: 128840.0000 - val_fp: 71160.0000 - val_tn: 128840.0000 - val_fn: 71160.0000 - val_accuracy: 0.6442 - val_precision: 0.6442 - val_recall: 0.6442 - val_auc: 0.6442
[INFO] saving weights to checkpoints/lstm-epoch-003-files-38-40-batch-0-1000000
[INFO] processing batch 1000000-2000000/1879817
[33m[INFO] loading file 41-42/50 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_074818_111.log.part14_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part01_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1819975, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1819975
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 36s - loss: 0.6513 - tp: 514961.0000 - fp: 285039.0000 - tn: 514961.0000 - fn: 285039.0000 - accuracy: 0.6437 - precision: 0.6437 - recall: 0.6437 - auc: 0.6437 - val_loss: 0.6515 - val_tp: 128671.0000 - val_fp: 71329.0000 - val_tn: 128671.0000 - val_fn: 71329.0000 - val_accuracy: 0.6434 - val_precision: 0.6434 - val_recall: 0.6434 - val_auc: 0.6434
[INFO] saving weights to checkpoints/lstm-epoch-003-files-40-42-batch-0-1000000
[INFO] processing batch 1000000-2000000/1819975
[33m[INFO] loading file 43-44/50 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part02_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part03_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1819975, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1819975
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 36s - loss: 0.6511 - tp: 515178.0000 - fp: 284822.0000 - tn: 515178.0000 - fn: 284822.0000 - accuracy: 0.6440 - precision: 0.6440 - recall: 0.6440 - auc: 0.6440 - val_loss: 0.6510 - val_tp: 128817.0000 - val_fp: 71183.0000 - val_tn: 128817.0000 - val_fn: 71183.0000 - val_accuracy: 0.6441 - val_precision: 0.6441 - val_recall: 0.6441 - val_auc: 0.6441
[INFO] saving weights to checkpoints/lstm-epoch-003-files-42-44-batch-0-1000000
[INFO] processing batch 1000000-2000000/1819975
[33m[INFO] loading file 45-46/50 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part04_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part05_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1819975, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1819975
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 34s - loss: 0.6513 - tp: 514967.0000 - fp: 285033.0000 - tn: 514967.0000 - fn: 285033.0000 - accuracy: 0.6437 - precision: 0.6437 - recall: 0.6437 - auc: 0.6437 - val_loss: 0.6507 - val_tp: 128912.0000 - val_fp: 71088.0000 - val_tn: 128912.0000 - val_fn: 71088.0000 - val_accuracy: 0.6446 - val_precision: 0.6446 - val_recall: 0.6446 - val_auc: 0.6446
[INFO] saving weights to checkpoints/lstm-epoch-003-files-44-46-batch-0-1000000
[INFO] processing batch 1000000-2000000/1819975
[33m[INFO] loading file 47-48/50 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part06_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part07_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1819975, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1819975
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 35s - loss: 0.6510 - tp: 515268.0000 - fp: 284732.0000 - tn: 515268.0000 - fn: 284732.0000 - accuracy: 0.6441 - precision: 0.6441 - recall: 0.6441 - auc: 0.6441 - val_loss: 0.6507 - val_tp: 128923.0000 - val_fp: 71077.0000 - val_tn: 128923.0000 - val_fn: 71077.0000 - val_accuracy: 0.6446 - val_precision: 0.6446 - val_recall: 0.6446 - val_auc: 0.6446
[INFO] saving weights to checkpoints/lstm-epoch-003-files-46-48-batch-0-1000000
[INFO] processing batch 1000000-2000000/1819975
[33m[INFO] loading file 49-50/50 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part08_sorted-labeled.csv
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/train/2015-12-31_130240_112.log.part09_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (1819975, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['appi_name', 'classification', 'dst', 'i/f_dir', 'i/f_name',
       'modbus_function_code', 'modbus_function_description',
       'modbus_transaction_id', 'orig', 'proto', 'proxy_src_ip', 's_port',
       'scada_tag', 'service', 'src', 'type', 'unixtime'],
      dtype='object')
[INFO] processing batch 0-1000000/1819975
[INFO] breaking into predictors and prediction...
[INFO] creating train/test split: 0.2
[INFO] using LSTM layers
[INFO] fitting model
Train on 8000 samples, validate on 2000 samples
Epoch 1/1
 - 37s - loss: 0.6511 - tp: 515194.0000 - fp: 284806.0000 - tn: 515194.0000 - fn: 284806.0000 - accuracy: 0.6440 - precision: 0.6440 - recall: 0.6440 - auc: 0.6440 - val_loss: 0.6512 - val_tp: 128751.0000 - val_fp: 71249.0000 - val_tn: 128751.0000 - val_fn: 71249.0000 - val_accuracy: 0.6438 - val_precision: 0.6438 - val_recall: 0.6438 - val_auc: 0.6438
train.py:186: FutureWarning: Sorting because non-concatenation axis is not aligned. A future version
of pandas will change to not sort by default.

To accept the future behavior, pass 'sort=False'.

To retain the current behavior and silence the warning, pass 'sort=True'.

  df = pd.concat(df_from_each_file, ignore_index=True)
[INFO] saving weights to checkpoints/lstm-epoch-003-files-48-50-batch-0-1000000
[INFO] processing batch 1000000-2000000/1819975
[33m[LOSS] 0.6512249250411988[0m
[CHECKING EARLY STOP]: currentLoss < min_delta ? => 0.6512249250411988  <  0.001
--- 2859.723904132843 seconds ---
2020-02-07 21:36:21.305167: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-02-07 21:36:21.319936: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7ff8e0684fb0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-02-07 21:36:21.319970: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Using TensorFlow backend.
WARNING:tensorflow:Large dropout rate: 0.8 (>0.5). In TensorFlow 2.x, dropout() uses dropout rate instead of keep_prob. Please ensure that this is intended.
2020-02-07 21:36:24.655934: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-07 21:36:24.662215: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-07 21:36:24.664856: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-07 21:36:24.688294: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-07 21:36:24.691211: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-07 21:36:24.692860: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-07 21:36:24.694590: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-07 21:36:24.703227: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
=================================================
        SCORING v0.4.1 (binaryClasses)
=================================================
Date: 2020-02-07 21:36:21.300466
[INFO] input_shape (10, 16)
[INFO] LSTM first and last layer neurons: 2
[INFO] adding core layer 0
[INFO] created DNN
loading weights: checkpoints/*
loading file checkpoints/lstm-epoch-003-files-8-10-batch-0-1000000
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 10, 2)             152       
_________________________________________________________________
dropout_1 (Dropout)          (None, 10, 2)             0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 10, 4)             112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 10, 4)             0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 10, 2)             56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 10, 2)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 10, 1)             3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 10, 1)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 10, 2)             4         
=================================================================
Total params: 327
Trainable params: 327
Non-trainable params: 0
_________________________________________________________________
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/eval/2015-12-31_130240_112.log.part10_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1364 (0.2728%)
[INFO] ** orig:[0.5:99.9992%,0.0:0.0008%]
[INFO] ** type:[1.0:99.9984%,0.5:0.0014%,0.0:0.0002%]
[INFO] ** i/f_name:[0.0:99.9984%,0.5:0.0016%]
[INFO] ** i/f_dir:[0.0:99.9986%,1.0:0.0014%]
[INFO] ** src:[0.0666666667:38.114%,0.9333333333:26.0964%,0.6666666667:18.2424%,0.3333333333:17.543%,0.1333333333:0.0016%,0.0:0.0012%,0.2:0.001%,0.5333333333:0.0004%]
[INFO] ** dst:[0.1764705882:43.3686%,0.9411764706:20.8412%,0.8823529412000001:18.2422%,0.5294117647:17.5434%,0.2941176471:0.0016%,0.0:0.0014%,0.3529411765:0.0006%,0.5882352941:0.0004%,0.4705882353:0.0002%,0.23529411760000002:0.0002%,0.058823529400000005:0.0002%]
[INFO] ** proto:[0.5:99.997%,0.0:0.0016%,1.0:0.0014%]
[INFO] ** appi_name:[0.0:99.9962%,0.0384615385:0.0016%,0.9230769231:0.0004%,0.0769230769:0.0004%,0.3846153846:0.0002%,0.34615384619999995:0.0002%,0.4230769231:0.0002%,0.6153846154:0.0002%,0.3076923077:0.0002%,0.9615384615000001:0.0002%,0.5769230769:0.0002%]
[INFO] ** proxy_src_ip:[0.6666666667:38.114%,0.0:26.0964%,0.9333333333:18.2424%,0.4:17.543%,0.5333333333:0.0016%,0.1333333333:0.0012%,0.0666666667:0.001%,0.6:0.0004%]
[INFO] ** modbus_function_code:[0.9743589744:99.9962%,0.0:0.0036%,1.0:0.0002%]
[INFO] ** modbus_function_description:[0.2:49.9988%,0.0:49.9974%,0.4:0.0036%,0.6:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[1.0:26.0954%,0.6:20.841%,0.8:18.242%,0.0:17.5424%,0.4:17.2726%,0.2:0.0066%]
[INFO] ** service:[0.7025755984000001:99.997%,0.0:0.0016%,0.0021633145999999997:0.0004%,0.08391465880000001:0.0004%,0.0297847659:0.0002%,0.08394601119999999:0.0002%,0.0021476384:0.0002%]
[INFO] ** s_port:[0.834280824:26.0956%,0.8139250565:20.8412%,0.8029830673999999:18.242%,0.8149336757:17.5424%,0.8137722355:17.2728%,0.0:0.0016%,0.7081881533:0.0008%,0.814841983:0.0006%,0.8059172320999999:0.0004%,0.8343113882:0.0004%,0.0021089309:0.0004%,0.0818051226:0.0004%,0.8030441959000001:0.0002%,0.8344030809:0.0002%,0.8345253376999999:0.0002%,0.0290360046:0.0002%,0.0020936488:0.0002%,0.8030136315999999:0.0002%,0.7806864723:0.0002%]
[INFO] ** classification:[normal:79.7796%,Single Stage Single Point:20.2204%]
[INFO] columns with count within 2-10 {'orig': 2, 'type': 3, 'i/f_name': 2, 'i/f_dir': 2, 'src': 8, 'proto': 3, 'proxy_src_ip': 8, 'modbus_function_code': 3, 'modbus_function_description': 4, 'scada_tag': 6, 'service': 7, 'classification': 2}
[INFO] processing batch 0-100000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 1 1 ... 1 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.955898105430603
tp :  64261.0
fp :  35739.0
tn :  64261.0
fn :  35739.0
accuracy :  0.6426100134849548
precision :  0.6426100134849548
recall :  0.6426100134849548
auc :  0.6426100730895996

y_eval {0: 64261, 1: 35739}
pred {0: 100000}
[INFO] confusion matrix for file 
[[64261     0]
 [35739     0]]
[INFO] confusion matrix after adding it to total:
[[64261     0]
 [35739     0]]
[INFO] processing batch 100000-200000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 1 1] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.956630419921875
tp :  64231.0
fp :  35769.0
tn :  64231.0
fn :  35769.0
accuracy :  0.6423100233078003
precision :  0.6423100233078003
recall :  0.6423100233078003
auc :  0.6423100233078003

y_eval {0: 64231, 1: 35769}
pred {0: 100000}
[INFO] confusion matrix for file 
[[64231     0]
 [35769     0]]
[INFO] confusion matrix after adding it to total:
[[128492      0]
 [ 71508      0]]
[INFO] processing batch 200000-300000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 1 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.8058943081736565
tp :  70406.0
fp :  29594.0
tn :  70406.0
fn :  29594.0
accuracy :  0.7040600180625916
precision :  0.7040600180625916
recall :  0.7040600180625916
auc :  0.7040599584579468

y_eval {0: 70406, 1: 29594}
pred {0: 100000}
[INFO] confusion matrix for file 
[[70406     0]
 [29594     0]]
[INFO] confusion matrix after adding it to total:
[[198898      0]
 [101102      0]]
[INFO] processing batch 300000-400000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[298898      0]
 [101102      0]]
[INFO] processing batch 400000-500000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[398898      0]
 [101102      0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/eval/2015-12-31_181648_113.log.part08_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1370 (0.274%)
[INFO] ** orig:[0.5:99.9948%,1.0:0.0052%]
[INFO] ** type:[1.0:100.0%]
[INFO] ** i/f_name:[0.0:99.9948%,0.5:0.0052%]
[INFO] ** i/f_dir:[0.0:99.9948%,1.0:0.0052%]
[INFO] ** src:[0.0666666667:38.4402%,0.9333333333:25.9738%,0.6666666667:18.1202%,0.3333333333:17.4598%,0.8:0.0052%,0.2666666667:0.0004%,0.5333333333:0.0002%,0.0:0.0002%]
[INFO] ** dst:[0.1764705882:43.345%,0.9411764706:21.0682%,0.8823529412000001:18.1202%,0.5294117647:17.4594%,0.2941176471:0.0052%,0.0:0.0012%,0.7647058823999999:0.0004%,1.0:0.0002%,0.23529411760000002:0.0002%]
[INFO] ** proto:[0.5:99.9946%,0.0:0.0052%,1.0:0.0002%]
[INFO] ** appi_name:[0.0:99.9942%,0.0384615385:0.0052%,0.4230769231:0.0002%,0.1538461538:0.0002%,0.4615384615:0.0002%]
[INFO] ** proxy_src_ip:[0.6666666667:38.4402%,0.0:25.9738%,0.9333333333:18.1202%,0.4:17.4598%,0.5333333333:0.0052%,0.8:0.0004%,0.6:0.0002%,0.1333333333:0.0002%]
[INFO] ** modbus_function_code:[0.9743589744:99.9942%,0.0:0.0058%]
[INFO] ** modbus_function_description:[0.2:49.998%,0.0:49.9962%,0.4:0.0058%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[1.0:25.9726%,0.6:21.0682%,0.8:18.1198%,0.0:17.459%,0.4:17.3718%,0.2:0.0086%]
[INFO] ** service:[0.7025755984000001:99.9942%,0.0:0.0052%,0.0021789908:0.0004%,0.0021476384:0.0002%]
[INFO] ** s_port:[0.834280824:25.973%,0.8139250565:21.0682%,0.8029830673999999:18.12%,0.8149336757:17.4592%,0.8137722355:17.372%,0.0:0.0052%,0.814841983:0.0006%,0.8343113882:0.0004%,0.9137019378:0.0004%,0.8059172320999999:0.0002%,0.8030136315999999:0.0002%,0.8344030809:0.0002%,0.8345253376999999:0.0002%,0.0020936488:0.0002%]
[INFO] ** classification:[normal:80.1196%,Multi Stage Multi Point:14.47%,Single Stage Multi Point:5.4104%]
[INFO] columns with count within 2-10 {'orig': 2, 'i/f_name': 2, 'i/f_dir': 2, 'src': 8, 'dst': 9, 'proto': 3, 'appi_name': 5, 'proxy_src_ip': 8, 'modbus_function_code': 2, 'modbus_function_description': 3, 'scada_tag': 6, 'service': 4, 'classification': 3}
[INFO] processing batch 0-100000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.7438422807812691
tp :  72948.0
fp :  27052.0
tn :  72948.0
fn :  27052.0
accuracy :  0.7294800281524658
precision :  0.7294800281524658
recall :  0.7294800281524658
auc :  0.7294800281524658

y_eval {0: 72948, 1: 27052}
pred {0: 100000}
[INFO] confusion matrix for file 
[[72948     0]
 [27052     0]]
[INFO] confusion matrix after adding it to total:
[[471846      0]
 [128154      0]]
[INFO] processing batch 100000-200000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[571846      0]
 [128154      0]]
[INFO] processing batch 200000-300000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[671846      0]
 [128154      0]]
[INFO] processing batch 300000-400000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.6993660032272339
tp :  74770.0
fp :  25230.0
tn :  74770.0
fn :  25230.0
accuracy :  0.7476999759674072
precision :  0.7476999759674072
recall :  0.7476999759674072
auc :  0.7476999163627625

y_eval {0: 74770, 1: 25230}
pred {0: 100000}
[INFO] confusion matrix for file 
[[74770     0]
 [25230     0]]
[INFO] confusion matrix after adding it to total:
[[746616      0]
 [153384      0]]
[INFO] processing batch 400000-500000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 1 0 ... 1 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  1.2337163829803466
tp :  52880.0
fp :  47120.0
tn :  52880.0
fn :  47120.0
accuracy :  0.5288000106811523
precision :  0.5288000106811523
recall :  0.5288000106811523
auc :  0.5288000106811523

y_eval {0: 52880, 1: 47120}
pred {0: 100000}
[INFO] confusion matrix for file 
[[52880     0]
 [47120     0]]
[INFO] confusion matrix after adding it to total:
[[799496      0]
 [200504      0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/eval/2015-12-31_181648_113.log.part09_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1359 (0.2718%)
[INFO] ** orig:[0.5:99.9966%,1.0:0.0034%]
[INFO] ** type:[1.0:99.9996%,0.5:0.0004%]
[INFO] ** i/f_name:[0.0:99.9938%,0.5:0.0062%]
[INFO] ** i/f_dir:[0.0:99.9942%,1.0:0.0058%]
[INFO] ** src:[0.0666666667:38.4204%,0.9333333333:25.9634%,0.6666666667:18.123%,0.3333333333:17.486%,0.8:0.0034%,0.1333333333:0.0028%,0.5333333333:0.0006%,0.2666666667:0.0004%]
[INFO] ** dst:[0.1764705882:43.3316%,0.9411764706:21.0518%,0.8823529412000001:18.123%,0.5294117647:17.486%,0.2941176471:0.0062%,0.0:0.0008%,0.4705882353:0.0002%,0.23529411760000002:0.0002%,0.058823529400000005:0.0002%]
[INFO] ** proto:[0.5:99.9934%,0.0:0.0062%,1.0:0.0004%]
[INFO] ** appi_name:[0.0:99.9934%,0.0384615385:0.0062%,0.3076923077:0.0002%,0.9615384615000001:0.0002%]
[INFO] ** proxy_src_ip:[0.6666666667:38.4204%,0.0:25.9634%,0.9333333333:18.123%,0.4:17.486%,0.5333333333:0.0062%,0.6:0.0006%,0.8:0.0004%]
[INFO] ** modbus_function_code:[0.9743589744:99.9934%,0.0:0.0066%]
[INFO] ** modbus_function_description:[0.2:49.9972%,0.0:49.9962%,0.4:0.0066%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[1.0:25.9624%,0.6:21.0518%,0.8:18.1226%,0.0:17.4856%,0.4:17.3686%,0.2:0.009%]
[INFO] ** service:[0.7025755984000001:99.9934%,0.0:0.0062%,0.0297847659:0.0002%,0.08394601119999999:0.0002%]
[INFO] ** s_port:[0.834280824:25.9628%,0.8139250565:21.0518%,0.8029830673999999:18.1226%,0.8149336757:17.4858%,0.8137722355:17.3686%,0.0:0.0062%,0.8059172320999999:0.0006%,0.9715599976:0.0002%,0.8030136315999999:0.0002%,0.8343113882:0.0002%,0.8147502904:0.0002%,0.8030441959000001:0.0002%,0.8344030809:0.0002%,0.9535729568000001:0.0002%,0.8345253376999999:0.0002%]
[INFO] ** classification:[normal:73.9096%,Multi Stage Multi Point:26.0904%]
[INFO] columns with count within 2-10 {'orig': 2, 'type': 2, 'i/f_name': 2, 'i/f_dir': 2, 'src': 8, 'dst': 9, 'proto': 3, 'appi_name': 4, 'proxy_src_ip': 7, 'modbus_function_code': 2, 'modbus_function_description': 3, 'scada_tag': 6, 'service': 4, 'classification': 2}
[INFO] processing batch 0-100000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 1 0 ... 1 1 1] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  1.2313973678588868
tp :  52975.0
fp :  47025.0
tn :  52975.0
fn :  47025.0
accuracy :  0.5297499895095825
precision :  0.5297499895095825
recall :  0.5297499895095825
auc :  0.5297499895095825

y_eval {0: 52975, 1: 47025}
pred {0: 100000}
[INFO] confusion matrix for file 
[[52975     0]
 [47025     0]]
[INFO] confusion matrix after adding it to total:
[[852471      0]
 [247529      0]]
[INFO] processing batch 100000-200000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [1 0 1 ... 0 1 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  1.2300791887283324
tp :  53029.0
fp :  46971.0
tn :  53029.0
fn :  46971.0
accuracy :  0.5302900075912476
precision :  0.5302900075912476
recall :  0.5302900075912476
auc :  0.5302900075912476

y_eval {0: 53029, 1: 46971}
pred {0: 100000}
[INFO] confusion matrix for file 
[[53029     0]
 [46971     0]]
[INFO] confusion matrix after adding it to total:
[[905500      0]
 [294500      0]]
[INFO] processing batch 200000-300000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [1 1 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.9734006096720695
tp :  63544.0
fp :  36456.0
tn :  63544.0
fn :  36456.0
accuracy :  0.6354399919509888
precision :  0.6354399919509888
recall :  0.6354399919509888
auc :  0.6354399919509888

y_eval {0: 63544, 1: 36456}
pred {0: 100000}
[INFO] confusion matrix for file 
[[63544     0]
 [36456     0]]
[INFO] confusion matrix after adding it to total:
[[969044      0]
 [330956      0]]
[INFO] processing batch 300000-400000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[1069044       0]
 [ 330956       0]]
[INFO] processing batch 400000-500000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[1169044       0]
 [ 330956       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/eval/2015-12-31_233049_114.log.part11_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1361 (0.2722%)
[INFO] ** orig:[0.5:99.9996%,1.0:0.0004%]
[INFO] ** type:[1.0:99.9994%,0.5:0.0004%,0.0:0.0002%]
[INFO] ** i/f_name:[0.0:99.9968%,0.5:0.0032%]
[INFO] ** i/f_dir:[0.0:99.9972%,1.0:0.0028%]
[INFO] ** src:[0.0666666667:38.4512%,0.9333333333:25.9642%,0.6666666667:18.089%,0.3333333333:17.4908%,0.1333333333:0.0028%,0.0:0.0008%,0.2666666667:0.0004%,0.5333333333:0.0004%,0.8:0.0004%]
[INFO] ** dst:[0.1764705882:43.3436%,0.9411764706:21.0714%,0.8823529412000001:18.0896%,0.5294117647:17.4906%,0.2941176471:0.0032%,0.0:0.001%,0.4705882353:0.0002%,0.23529411760000002:0.0002%,0.058823529400000005:0.0002%]
[INFO] ** proto:[0.5:99.9964%,0.0:0.0032%,1.0:0.0004%]
[INFO] ** appi_name:[0.0:99.9956%,0.0384615385:0.0032%,0.3846153846:0.0002%,0.34615384619999995:0.0002%,0.6153846154:0.0002%,0.3076923077:0.0002%,0.9615384615000001:0.0002%,0.5769230769:0.0002%]
[INFO] ** proxy_src_ip:[0.6666666667:38.4512%,0.0:25.9642%,0.9333333333:18.089%,0.4:17.4908%,0.5333333333:0.0032%,0.1333333333:0.0008%,0.6:0.0004%,0.8:0.0004%]
[INFO] ** modbus_function_code:[0.9743589744:99.9956%,0.0:0.0042%,1.0:0.0002%]
[INFO] ** modbus_function_description:[0.2:49.999%,0.0:49.9966%,0.4:0.0042%,0.6:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[1.0:25.9632%,0.6:21.0714%,0.8:18.0886%,0.0:17.4902%,0.4:17.3796%,0.2:0.007%]
[INFO] ** service:[0.7025755984000001:99.9964%,0.0:0.0032%,0.0297847659:0.0002%,0.08394601119999999:0.0002%]
[INFO] ** s_port:[0.834280824:25.9636%,0.8139250565:21.0714%,0.8029830673999999:18.0886%,0.8149336757:17.4904%,0.8137722355:17.3798%,0.0:0.0032%,0.8896631823000001:0.0008%,0.8059172320999999:0.0004%,0.8343113882:0.0004%,0.9715599976:0.0002%,0.8030136315999999:0.0002%,0.8147502904:0.0002%,0.8030441959000001:0.0002%,0.814841983:0.0002%,0.9535729568000001:0.0002%,0.8345253376999999:0.0002%]
[INFO] ** classification:[normal:95.0874%,Single Stage Single Point:4.9126%]
[INFO] columns with count within 2-10 {'orig': 2, 'type': 3, 'i/f_name': 2, 'i/f_dir': 2, 'src': 9, 'dst': 9, 'proto': 3, 'appi_name': 8, 'proxy_src_ip': 8, 'modbus_function_code': 3, 'modbus_function_description': 4, 'scada_tag': 6, 'service': 4, 'classification': 2}
[INFO] processing batch 0-100000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[1269044       0]
 [ 330956       0]]
[INFO] processing batch 100000-200000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[1369044       0]
 [ 330956       0]]
[INFO] processing batch 200000-300000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.26317104623317716
tp :  92639.0
fp :  7361.0
tn :  92639.0
fn :  7361.0
accuracy :  0.9263899922370911
precision :  0.9263899922370911
recall :  0.9263899922370911
auc :  0.9263899326324463

y_eval {0: 92639, 1: 7361}
pred {0: 100000}
[INFO] confusion matrix for file 
[[92639     0]
 [ 7361     0]]
[INFO] confusion matrix after adding it to total:
[[1461683       0]
 [ 338317       0]]
[INFO] processing batch 300000-400000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 1 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.5033967675328255
tp :  82798.0
fp :  17202.0
tn :  82798.0
fn :  17202.0
accuracy :  0.8279799818992615
precision :  0.8279799818992615
recall :  0.8279799818992615
auc :  0.8279799818992615

y_eval {0: 82798, 1: 17202}
pred {0: 100000}
[INFO] confusion matrix for file 
[[82798     0]
 [17202     0]]
[INFO] confusion matrix after adding it to total:
[[1544481       0]
 [ 355519       0]]
[INFO] processing batch 400000-500000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[1644481       0]
 [ 355519       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/eval/2016-01-01_151435_117.log.part03_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1365 (0.273%)
[INFO] ** orig:[0.5:99.9976%,1.0:0.0024%]
[INFO] ** type:[1.0:100.0%]
[INFO] ** i/f_name:[0.0:99.9966%,0.5:0.0034%]
[INFO] ** i/f_dir:[0.0:99.9966%,1.0:0.0034%]
[INFO] ** src:[0.0666666667:38.1462%,0.9333333333:26.099%,0.6666666667:18.1904%,0.3333333333:17.5592%,0.8:0.0028%,0.1333333333:0.001%,1.0:0.0006%,0.2666666667:0.0004%,0.5333333333:0.0004%]
[INFO] ** dst:[0.1764705882:43.376%,0.9411764706:20.8688%,0.8823529412000001:18.1902%,0.5294117647:17.5592%,0.2941176471:0.0034%,0.0:0.0008%,0.3529411765:0.0004%,0.4705882353:0.0004%,0.6470588235:0.0004%,0.4117647059:0.0002%,0.23529411760000002:0.0002%]
[INFO] ** proto:[0.5:99.9958%,0.0:0.0034%,1.0:0.0008%]
[INFO] ** appi_name:[0.0:99.9952%,0.0384615385:0.0034%,0.5384615385:0.0006%,0.3076923077:0.0004%,0.4230769231:0.0002%,0.0769230769:0.0002%]
[INFO] ** proxy_src_ip:[0.6666666667:38.1462%,0.0:26.099%,0.9333333333:18.1904%,0.4:17.5592%,0.5333333333:0.0034%,0.7333333333:0.0006%,0.6:0.0004%,0.4666666667:0.0004%,0.8:0.0004%]
[INFO] ** modbus_function_code:[0.9743589744:99.9952%,0.0:0.0048%]
[INFO] ** modbus_function_description:[0.2:49.9978%,0.0:49.9974%,0.4:0.0048%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[1.0:26.0982%,0.6:20.8688%,0.8:18.19%,0.0:17.5588%,0.4:17.2772%,0.2:0.007%]
[INFO] ** service:[0.7025755984000001:99.9952%,0.0:0.0034%,0.002116286:0.0006%,0.08394601119999999:0.0004%,0.0021633145999999997:0.0002%,0.0021476384:0.0002%]
[INFO] ** s_port:[0.834280824:26.0986%,0.8139250565:20.8688%,0.8029830673999999:18.1902%,0.8149336757:17.559%,0.8137722355:17.2774%,0.0:0.0034%,0.8059172320999999:0.0004%,0.8343113882:0.0002%,0.814841983:0.0002%,0.9228712024:0.0002%,0.0021089309:0.0002%,0.7616602481999999:0.0002%,0.8345253376999999:0.0002%,0.0020936488:0.0002%,0.8683752063:0.0002%,0.7840485359999999:0.0002%,0.8030136315999999:0.0002%,0.8086374473000001:0.0002%]
[INFO] ** classification:[normal:84.2104%,Single Stage Single Point:15.7896%]
[INFO] columns with count within 2-10 {'orig': 2, 'i/f_name': 2, 'i/f_dir': 2, 'src': 9, 'proto': 3, 'appi_name': 6, 'proxy_src_ip': 9, 'modbus_function_code': 2, 'modbus_function_description': 3, 'scada_tag': 6, 'service': 6, 'classification': 2}
[INFO] processing batch 0-100000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 1 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.7985222712516785
tp :  70708.0
fp :  29292.0
tn :  70708.0
fn :  29292.0
accuracy :  0.7070800065994263
precision :  0.7070800065994263
recall :  0.7070800065994263
auc :  0.7070800065994263

y_eval {0: 70708, 1: 29292}
pred {0: 100000}
[INFO] confusion matrix for file 
[[70708     0]
 [29292     0]]
[INFO] confusion matrix after adding it to total:
[[1715189       0]
 [ 384811       0]]
[INFO] processing batch 100000-200000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [1 0 1 ... 1 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.9570209911346436
tp :  64215.0
fp :  35785.0
tn :  64215.0
fn :  35785.0
accuracy :  0.6421499848365784
precision :  0.6421499848365784
recall :  0.6421499848365784
auc :  0.6421500444412231

y_eval {0: 64215, 1: 35785}
pred {0: 100000}
[INFO] confusion matrix for file 
[[64215     0]
 [35785     0]]
[INFO] confusion matrix after adding it to total:
[[1779404       0]
 [ 420596       0]]
[INFO] processing batch 200000-300000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 1 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.42208477653265
tp :  86129.0
fp :  13871.0
tn :  86129.0
fn :  13871.0
accuracy :  0.8612899780273438
precision :  0.8612899780273438
recall :  0.8612899780273438
auc :  0.8612899780273438

y_eval {0: 86129, 1: 13871}
pred {0: 100000}
[INFO] confusion matrix for file 
[[86129     0]
 [13871     0]]
[INFO] confusion matrix after adding it to total:
[[1865533       0]
 [ 434467       0]]
[INFO] processing batch 300000-400000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[1965533       0]
 [ 434467       0]]
[INFO] processing batch 400000-500000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[2065533       0]
 [ 434467       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/eval/2016-01-01_151435_117.log.part12_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1377 (0.2754%)
[INFO] ** orig:[0.5:99.9964%,1.0:0.0036%]
[INFO] ** type:[1.0:99.9994%,0.5:0.0004%,0.0:0.0002%]
[INFO] ** i/f_name:[0.0:99.996%,0.5:0.004%]
[INFO] ** i/f_dir:[0.0:99.9964%,1.0:0.0036%]
[INFO] ** src:[0.0666666667:38.049%,0.9333333333:26.1306%,0.6666666667:18.2264%,0.3333333333:17.587%,0.8:0.0036%,0.0:0.0014%,0.2:0.001%,0.1333333333:0.0004%,0.5333333333:0.0002%,0.4:0.0002%,0.6:0.0002%]
[INFO] ** dst:[0.1764705882:43.355%,0.9411764706:20.8256%,0.8823529412000001:18.226%,0.5294117647:17.5868%,0.2941176471:0.004%,0.3529411765:0.001%,0.0:0.0006%,0.5882352941:0.0004%,0.4705882353:0.0002%,0.23529411760000002:0.0002%,0.058823529400000005:0.0002%]
[INFO] ** proto:[0.5:99.9942%,0.0:0.004%,1.0:0.0018%]
[INFO] ** appi_name:[0.0:99.9932%,0.0384615385:0.004%,0.4230769231:0.0006%,0.9230769231:0.0004%,0.0769230769:0.0004%,0.1923076923:0.0002%,0.34615384619999995:0.0002%,0.6153846154:0.0002%,0.3076923077:0.0002%,0.3846153846:0.0002%,0.9615384615000001:0.0002%,0.5769230769:0.0002%]
[INFO] ** proxy_src_ip:[0.6666666667:38.049%,0.0:26.1306%,0.9333333333:18.2264%,0.4:17.587%,0.5333333333:0.004%,0.1333333333:0.0014%,0.0666666667:0.001%,1.0:0.0002%,0.6:0.0002%,0.3333333333:0.0002%]
[INFO] ** modbus_function_code:[0.9743589744:99.9932%,0.0:0.0066%,1.0:0.0002%]
[INFO] ** modbus_function_description:[0.2:49.9974%,0.0:49.9958%,0.4:0.0066%,0.6:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[1.0:26.13%,0.6:20.8244%,0.8:18.2258%,0.0:17.5864%,0.4:17.2242%,0.2:0.0092%]
[INFO] ** service:[0.7025755984000001:99.9942%,0.0:0.004%,0.0021476384:0.0006%,0.0021633145999999997:0.0004%,0.08391465880000001:0.0004%,0.0297847659:0.0002%,0.08394601119999999:0.0002%]
[INFO] ** s_port:[0.834280824:26.1304%,0.8139250565:20.8246%,0.8029830673999999:18.226%,0.8149336757:17.5866%,0.8137722355:17.2244%,0.0:0.004%,0.7431230515:0.0008%,0.0020936488:0.0006%,0.814841983:0.0004%,0.0021089309:0.0004%,0.0818051226:0.0004%,0.8030441959000001:0.0002%,0.7967938137999999:0.0002%,0.8345253376999999:0.0002%,0.0290360046:0.0002%,0.1074484993:0.0002%,0.8030136315999999:0.0002%,0.8059172320999999:0.0002%]
[INFO] ** classification:[normal:97.1716%,Single Stage Single Point:2.8284%]
[INFO] columns with count within 2-10 {'orig': 2, 'type': 3, 'i/f_name': 2, 'i/f_dir': 2, 'proto': 3, 'modbus_function_code': 3, 'modbus_function_description': 4, 'scada_tag': 6, 'service': 7, 'classification': 2}
[INFO] processing batch 0-100000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[2165533       0]
 [ 434467       0]]
[INFO] processing batch 100000-200000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[2265533       0]
 [ 434467       0]]
[INFO] processing batch 200000-300000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[2365533       0]
 [ 434467       0]]
[INFO] processing batch 300000-400000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[2465533       0]
 [ 434467       0]]
[INFO] processing batch 400000-500000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 1 1] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.4287000867366791
tp :  85858.0
fp :  14142.0
tn :  85858.0
fn :  14142.0
accuracy :  0.8585799932479858
precision :  0.8585799932479858
recall :  0.8585799932479858
auc :  0.8585799932479858

y_eval {0: 85858, 1: 14142}
pred {0: 100000}
[INFO] confusion matrix for file 
[[85858     0]
 [14142     0]]
[INFO] confusion matrix after adding it to total:
[[2551391       0]
 [ 448609       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/eval/2016-01-01_151435_117.log.part13_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1365 (0.273%)
[INFO] ** orig:[0.5:99.9986%,1.0:0.0014%]
[INFO] ** type:[1.0:100.0%]
[INFO] ** i/f_name:[0.0:99.998%,0.5:0.002%]
[INFO] ** i/f_dir:[0.0:99.998%,1.0:0.002%]
[INFO] ** src:[0.0666666667:38.1186%,0.9333333333:26.0918%,0.6666666667:18.2288%,0.3333333333:17.558%,0.8:0.0018%,0.1333333333:0.0006%,0.5333333333:0.0004%]
[INFO] ** dst:[0.1764705882:43.3702%,0.9411764706:20.8392%,0.8823529412000001:18.2288%,0.5294117647:17.5578%,0.2941176471:0.002%,0.0:0.0012%,0.23529411760000002:0.0004%,0.3529411765:0.0002%,0.4705882353:0.0002%]
[INFO] ** proto:[0.5:99.9976%,0.0:0.002%,1.0:0.0004%]
[INFO] ** appi_name:[0.0:99.9976%,0.0384615385:0.002%,0.4230769231:0.0002%,0.3076923077:0.0002%]
[INFO] ** proxy_src_ip:[0.6666666667:38.1186%,0.0:26.0918%,0.9333333333:18.2288%,0.4:17.558%,0.5333333333:0.002%,0.6:0.0004%,0.4666666667:0.0004%]
[INFO] ** modbus_function_code:[0.9743589744:99.9976%,0.0:0.0024%]
[INFO] ** modbus_function_description:[0.2:49.9998%,0.0:49.9978%,0.4:0.0024%]
[INFO] ** modbus_transaction_id:65534 (13.1068%)
[INFO] ** scada_tag:[1.0:26.0906%,0.6:20.839%,0.8:18.2282%,0.0:17.5572%,0.4:17.2792%,0.2:0.0058%]
[INFO] ** service:[0.7025755984000001:99.9976%,0.0:0.002%,0.08394601119999999:0.0002%,0.0021476384:0.0002%]
[INFO] ** s_port:[0.834280824:26.0908%,0.8139250565:20.8392%,0.8029830673999999:18.2284%,0.8149336757:17.5576%,0.8137722355:17.2794%,0.0:0.002%,0.8343113882:0.0006%,0.8059172320999999:0.0004%,0.8030136315999999:0.0004%,0.8147502904:0.0002%,0.814841983:0.0002%,0.8344030809:0.0002%,0.8345253376999999:0.0002%,0.0020936488:0.0002%,0.8683752063:0.0002%]
[INFO] ** classification:[normal:87.5394%,Single Stage Single Point:12.4606%]
[INFO] columns with count within 2-10 {'orig': 2, 'i/f_name': 2, 'i/f_dir': 2, 'src': 7, 'dst': 9, 'proto': 3, 'appi_name': 4, 'proxy_src_ip': 7, 'modbus_function_code': 2, 'modbus_function_description': 3, 'scada_tag': 6, 'service': 4, 'classification': 2}
[INFO] processing batch 0-100000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 1 0 ... 1 0 1] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  1.2301036003112793
tp :  53028.0
fp :  46972.0
tn :  53028.0
fn :  46972.0
accuracy :  0.5302799940109253
precision :  0.5302799940109253
recall :  0.5302799940109253
auc :  0.5302799940109253

y_eval {0: 53028, 1: 46972}
pred {0: 100000}
[INFO] confusion matrix for file 
[[53028     0]
 [46972     0]]
[INFO] confusion matrix after adding it to total:
[[2604419       0]
 [ 495581       0]]
[INFO] processing batch 100000-200000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 1 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.4577244176506996
tp :  84669.0
fp :  15331.0
tn :  84669.0
fn :  15331.0
accuracy :  0.8466899991035461
precision :  0.8466899991035461
recall :  0.8466899991035461
auc :  0.8466899991035461

y_eval {0: 84669, 1: 15331}
pred {0: 100000}
[INFO] confusion matrix for file 
[[84669     0]
 [15331     0]]
[INFO] confusion matrix after adding it to total:
[[2689088       0]
 [ 510912       0]]
[INFO] processing batch 200000-300000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[2789088       0]
 [ 510912       0]]
[INFO] processing batch 300000-400000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[2889088       0]
 [ 510912       0]]
[INFO] processing batch 400000-500000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[2989088       0]
 [ 510912       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/eval/2016-01-01_203011_118.log.part06_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0.5:99.9988%,1.0:0.0008%,0.0:0.0004%]
[INFO] ** type:[1.0:99.9986%,0.5:0.001%,0.0:0.0004%]
[INFO] ** i/f_name:[0.0:99.998%,0.5:0.002%]
[INFO] ** i/f_dir:[0.0:99.9982%,1.0:0.0018%]
[INFO] ** src:[0.0666666667:38.138%,0.9333333333:26.0904%,0.6666666667:18.1762%,0.3333333333:17.5892%,0.2:0.0018%,0.0:0.0016%,0.1333333333:0.0012%,0.8:0.0008%,0.5333333333:0.0006%,0.4:0.0002%]
[INFO] ** dst:[0.1764705882:43.3838%,0.9411764706:20.845%,0.8823529412000001:18.1758%,0.5294117647:17.589%,0.2941176471:0.002%,0.3529411765:0.0014%,0.0:0.0014%,0.5882352941:0.0004%,0.4705882353:0.0004%,0.23529411760000002:0.0004%,0.058823529400000005:0.0004%]
[INFO] ** proto:[0.5:99.9954%,1.0:0.0026%,0.0:0.002%]
[INFO] ** appi_name:[0.0:99.9944%,0.0384615385:0.002%,0.0769230769:0.0008%,0.4230769231:0.0006%,0.9230769231:0.0004%,0.34615384619999995:0.0004%,0.3076923077:0.0004%,0.9615384615000001:0.0004%,0.3846153846:0.0002%,0.6153846154:0.0002%,0.5769230769:0.0002%]
[INFO] ** proxy_src_ip:[0.6666666667:38.138%,0.0:26.0904%,0.9333333333:18.1762%,0.4:17.5892%,0.5333333333:0.002%,0.0666666667:0.0018%,0.1333333333:0.0016%,0.6:0.0006%,1.0:0.0002%]
[INFO] ** modbus_function_code:[0.9743589744:99.9944%,0.0:0.0052%,1.0:0.0004%]
[INFO] ** modbus_function_description:[0.2:49.998%,0.0:49.9964%,0.4:0.0052%,0.6:0.0004%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[1.0:26.0894%,0.6:20.8438%,0.8:18.1758%,0.0:17.5888%,0.4:17.294%,0.2:0.0082%]
[INFO] ** service:[0.7025755984000001:99.9954%,0.0:0.002%,0.0021633145999999997:0.0008%,0.0021476384:0.0006%,0.08391465880000001:0.0004%,0.0297847659:0.0004%,0.08394601119999999:0.0004%]
[INFO] ** s_port:[0.834280824:26.0898%,0.8139250565:20.844%,0.8029830673999999:18.1758%,0.8149336757:17.589%,0.8137722355:17.294%,0.0:0.002%,0.7435203863:0.0008%,0.0021089309:0.0008%,0.0020936488:0.0006%,0.8059172320999999:0.0006%,0.8343113882:0.0006%,0.7967938137999999:0.0004%,0.0290360046:0.0004%,0.0818051226:0.0004%,0.8030136315999999:0.0004%,0.7431230515:0.0002%,0.814841983:0.0002%]
[INFO] ** classification:[normal:90.7904%,Single Stage Multi Point:5.7378%,Single Stage Single Point:3.4718%]
[INFO] columns with count within 2-10 {'orig': 3, 'type': 3, 'i/f_name': 2, 'i/f_dir': 2, 'proto': 3, 'proxy_src_ip': 9, 'modbus_function_code': 3, 'modbus_function_description': 4, 'scada_tag': 6, 'service': 7, 'classification': 3}
[INFO] processing batch 0-100000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[3089088       0]
 [ 510912       0]]
[INFO] processing batch 100000-200000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[3189088       0]
 [ 510912       0]]
[INFO] processing batch 200000-300000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[3289088       0]
 [ 510912       0]]
[INFO] processing batch 300000-400000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.5072293334364891
tp :  82641.0
fp :  17359.0
tn :  82641.0
fn :  17359.0
accuracy :  0.8264099955558777
precision :  0.8264099955558777
recall :  0.8264099955558777
auc :  0.8264100551605225

y_eval {0: 82641, 1: 17359}
pred {0: 100000}
[INFO] confusion matrix for file 
[[82641     0]
 [17359     0]]
[INFO] confusion matrix after adding it to total:
[[3371729       0]
 [ 528271       0]]
[INFO] processing batch 400000-500000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 1 1] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.7838026386022567
tp :  71311.0
fp :  28689.0
tn :  71311.0
fn :  28689.0
accuracy :  0.7131100296974182
precision :  0.7131100296974182
recall :  0.7131100296974182
auc :  0.7131099700927734

y_eval {0: 71311, 1: 28689}
pred {0: 100000}
[INFO] confusion matrix for file 
[[71311     0]
 [28689     0]]
[INFO] confusion matrix after adding it to total:
[[3443040       0]
 [ 556960       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/eval/2016-01-01_203011_118.log.part07_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0.5:99.9996%,1.0:0.0004%]
[INFO] ** type:[1.0:100.0%]
[INFO] ** i/f_name:[0.0:99.9994%,0.5:0.0006%]
[INFO] ** i/f_dir:[0.0:99.9994%,1.0:0.0006%]
[INFO] ** src:[0.0666666667:38.0718%,0.9333333333:26.1174%,0.6666666667:18.2344%,0.3333333333:17.5754%,0.8:0.0008%,0.1333333333:0.0002%]
[INFO] ** dst:[0.1764705882:43.3758%,0.9411764706:20.813%,0.8823529412000001:18.2342%,0.5294117647:17.5754%,0.2941176471:0.0006%,0.0:0.0004%,0.3529411765:0.0002%,0.4705882353:0.0002%,0.23529411760000002:0.0002%]
[INFO] ** proto:[0.5:99.999%,0.0:0.0006%,1.0:0.0004%]
[INFO] ** appi_name:[0.0:99.999%,0.0384615385:0.0006%,0.4230769231:0.0002%,0.3076923077:0.0002%]
[INFO] ** proxy_src_ip:[0.6666666667:38.0718%,0.0:26.1174%,0.9333333333:18.2344%,0.4:17.5754%,0.5333333333:0.0006%,0.4666666667:0.0004%]
[INFO] ** modbus_function_code:[0.9743589744:99.999%,0.0:0.001%]
[INFO] ** modbus_function_description:[0.2:49.9996%,0.0:49.9994%,0.4:0.001%]
[INFO] ** modbus_transaction_id:65301 (13.0602%)
[INFO] ** scada_tag:[1.0:26.1164%,0.6:20.813%,0.8:18.2338%,0.0:17.575%,0.4:17.2586%,0.2:0.0032%]
[INFO] ** service:[0.7025755984000001:99.999%,0.0:0.0006%,0.08394601119999999:0.0002%,0.0021476384:0.0002%]
[INFO] ** s_port:[0.834280824:26.1168%,0.8139250565:20.813%,0.8029830673999999:18.234%,0.8149336757:17.5752%,0.8137722355:17.2588%,0.0:0.0006%,0.8030136315999999:0.0002%,0.8343113882:0.0002%,0.8030441959000001:0.0002%,0.814841983:0.0002%,0.8344030809:0.0002%,0.8345253376999999:0.0002%,0.0020936488:0.0002%,0.8683752063:0.0002%]
[INFO] ** classification:[normal:89.2092%,Single Stage Multi Point:10.7908%]
[INFO] columns with count within 2-10 {'orig': 2, 'i/f_name': 2, 'i/f_dir': 2, 'src': 6, 'dst': 9, 'proto': 3, 'appi_name': 4, 'proxy_src_ip': 6, 'modbus_function_code': 2, 'modbus_function_description': 3, 'scada_tag': 6, 'service': 4, 'classification': 2}
[INFO] processing batch 0-100000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [1 0 0 ... 1 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  1.230128000831604
tp :  53027.0
fp :  46973.0
tn :  53027.0
fn :  46973.0
accuracy :  0.530269980430603
precision :  0.530269980430603
recall :  0.530269980430603
auc :  0.530269980430603

y_eval {0: 53027, 1: 46973}
pred {0: 100000}
[INFO] confusion matrix for file 
[[53027     0]
 [46973     0]]
[INFO] confusion matrix after adding it to total:
[[3496067       0]
 [ 603933       0]]
[INFO] processing batch 100000-200000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 1 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.25389501322507857
tp :  93019.0
fp :  6981.0
tn :  93019.0
fn :  6981.0
accuracy :  0.9301900267601013
precision :  0.9301900267601013
recall :  0.9301900267601013
auc :  0.9301899671554565

y_eval {0: 93019, 1: 6981}
pred {0: 100000}
[INFO] confusion matrix for file 
[[93019     0]
 [ 6981     0]]
[INFO] confusion matrix after adding it to total:
[[3589086       0]
 [ 610914       0]]
[INFO] processing batch 200000-300000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[3689086       0]
 [ 610914       0]]
[INFO] processing batch 300000-400000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[3789086       0]
 [ 610914       0]]
[INFO] processing batch 400000-500000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[3889086       0]
 [ 610914       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/eval/2016-01-02_014558_119.log.part06_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1366 (0.2732%)
[INFO] ** orig:[0.5:99.997%,1.0:0.003%]
[INFO] ** type:[1.0:100.0%]
[INFO] ** i/f_name:[0.0:99.9964%,0.5:0.0036%]
[INFO] ** i/f_dir:[0.0:99.9964%,1.0:0.0036%]
[INFO] ** src:[0.0666666667:38.0288%,0.9333333333:26.1242%,0.6666666667:18.2114%,0.3333333333:17.6294%,0.8:0.003%,0.2666666667:0.0008%,1.0:0.0006%,0.1333333333:0.0006%,0.5333333333:0.0004%,0.4:0.0004%,0.6:0.0002%,0.0:0.0002%]
[INFO] ** dst:[0.1764705882:43.357%,0.9411764706:20.7952%,0.8823529412000001:18.2116%,0.5294117647:17.629%,0.2941176471:0.0036%,0.0:0.0012%,0.6470588235:0.0008%,0.3529411765:0.0004%,0.7058823529000001:0.0004%,0.7647058823999999:0.0004%,1.0:0.0002%,0.23529411760000002:0.0002%]
[INFO] ** proto:[0.5:99.9958%,0.0:0.0036%,1.0:0.0006%]
[INFO] ** appi_name:[0.0:99.9942%,0.0384615385:0.0036%,0.7692307692:0.0008%,0.4230769231:0.0004%,0.5384615385:0.0002%,0.0769230769:0.0002%,0.11538461539999999:0.0002%,0.1538461538:0.0002%,0.4615384615:0.0002%]
[INFO] ** proxy_src_ip:[0.6666666667:38.0288%,0.0:26.1242%,0.9333333333:18.2114%,0.4:17.6294%,0.5333333333:0.0036%,0.8:0.0008%,0.7333333333:0.0006%,1.0:0.0004%,0.6:0.0004%,0.3333333333:0.0002%,0.1333333333:0.0002%]
[INFO] ** modbus_function_code:[0.9743589744:99.9942%,0.0:0.0058%]
[INFO] ** modbus_function_description:[0.2:49.9974%,0.0:49.9968%,0.4:0.0058%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[1.0:26.123%,0.6:20.7952%,0.8:18.211%,0.0:17.6288%,0.4:17.2336%,0.2:0.0084%]
[INFO] ** service:[0.7025755984000001:99.9942%,0.0:0.0036%,0.0208806885:0.0008%,0.0021789908:0.0004%,0.0021476384:0.0004%,0.0021633145999999997:0.0002%,0.08543524949999999:0.0002%,0.002116286:0.0002%]
[INFO] ** s_port:[0.834280824:26.1234%,0.8139250565:20.7952%,0.8029830673999999:18.2112%,0.8149336757:17.629%,0.8137722355:17.2336%,0.0:0.0036%,0.8343113882:0.0006%,0.0020936488:0.0004%,0.9310776942:0.0004%,0.8059172320999999:0.0004%,0.8147502904:0.0002%,0.814841983:0.0002%,0.15243902439999998:0.0002%,0.8344030809:0.0002%,0.0021089309:0.0002%,0.8411730545999999:0.0002%,0.7593068036:0.0002%,0.15240846019999998:0.0002%,0.8030136315999999:0.0002%,0.315972859:0.0002%,0.7586191087:0.0002%]
[INFO] ** classification:[normal:81.41%,Single Stage Single Point:18.59%]
[INFO] columns with count within 2-10 {'orig': 2, 'i/f_name': 2, 'i/f_dir': 2, 'proto': 3, 'appi_name': 9, 'modbus_function_code': 2, 'modbus_function_description': 3, 'scada_tag': 6, 'service': 8, 'classification': 2}
[INFO] processing batch 0-100000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 1 0 1] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.8793217411279678
tp :  67398.0
fp :  32602.0
tn :  67398.0
fn :  32602.0
accuracy :  0.6739799976348877
precision :  0.6739799976348877
recall :  0.6739799976348877
auc :  0.6739799976348877

y_eval {0: 67398, 1: 32602}
pred {0: 100000}
[INFO] confusion matrix for file 
[[67398     0]
 [32602     0]]
[INFO] confusion matrix after adding it to total:
[[3956484       0]
 [ 643516       0]]
[INFO] processing batch 100000-200000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [1 0 1 ... 1 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  1.2295177417755128
tp :  53052.0
fp :  46948.0
tn :  53052.0
fn :  46948.0
accuracy :  0.5305200219154358
precision :  0.5305200219154358
recall :  0.5305200219154358
auc :  0.530519962310791

y_eval {0: 53052, 1: 46948}
pred {0: 100000}
[INFO] confusion matrix for file 
[[53052     0]
 [46948     0]]
[INFO] confusion matrix after adding it to total:
[[4009536       0]
 [ 690464       0]]
[INFO] processing batch 200000-300000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 1 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.4105873417496681
tp :  86600.0
fp :  13400.0
tn :  86600.0
fn :  13400.0
accuracy :  0.8659999966621399
precision :  0.8659999966621399
recall :  0.8659999966621399
auc :  0.8659999966621399

y_eval {0: 86600, 1: 13400}
pred {0: 100000}
[INFO] confusion matrix for file 
[[86600     0]
 [13400     0]]
[INFO] confusion matrix after adding it to total:
[[4096136       0]
 [ 703864       0]]
[INFO] processing batch 300000-400000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[4196136       0]
 [ 703864       0]]
[INFO] processing batch 400000-500000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[4296136       0]
 [ 703864       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/eval/2016-01-02_121729_121.log.part12_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1368 (0.2736%)
[INFO] ** orig:[0.5:99.9986%,0.0:0.0008%,1.0:0.0006%]
[INFO] ** type:[1.0:99.9984%,0.5:0.0014%,0.0:0.0002%]
[INFO] ** i/f_name:[0.0:99.9978%,0.5:0.0022%]
[INFO] ** i/f_dir:[0.0:99.998%,1.0:0.002%]
[INFO] ** src:[0.0666666667:38.1136%,0.9333333333:26.1176%,0.6666666667:18.2158%,0.3333333333:17.5472%,0.1333333333:0.0016%,0.0:0.0014%,0.2:0.001%,0.8:0.0006%,0.2666666667:0.0004%,0.5333333333:0.0004%,0.4:0.0002%,1.0:0.0002%]
[INFO] ** dst:[0.1764705882:43.4022%,0.9411764706:20.8284%,0.8823529412000001:18.2156%,0.5294117647:17.547%,0.2941176471:0.0022%,0.0:0.002%,0.3529411765:0.0008%,0.5882352941:0.0004%,0.7647058823999999:0.0004%,1.0:0.0004%,0.4705882353:0.0002%,0.23529411760000002:0.0002%,0.058823529400000005:0.0002%]
[INFO] ** proto:[0.5:99.996%,0.0:0.0022%,1.0:0.0018%]
[INFO] ** appi_name:[0.0:99.9946%,0.0384615385:0.0022%,0.4230769231:0.0006%,0.9230769231:0.0004%,0.0769230769:0.0004%,0.1538461538:0.0002%,0.3846153846:0.0002%,1.0:0.0002%,0.34615384619999995:0.0002%,0.6153846154:0.0002%,0.3076923077:0.0002%,0.4615384615:0.0002%,0.9615384615000001:0.0002%,0.5769230769:0.0002%]
[INFO] ** proxy_src_ip:[0.6666666667:38.1136%,0.0:26.1176%,0.9333333333:18.2158%,0.4:17.5472%,0.5333333333:0.0022%,0.1333333333:0.0014%,0.0666666667:0.001%,0.6:0.0004%,0.8:0.0004%,1.0:0.0002%,0.7333333333:0.0002%]
[INFO] ** modbus_function_code:[0.9743589744:99.9946%,0.0:0.0052%,1.0:0.0002%]
[INFO] ** modbus_function_description:[0.2:49.9984%,0.0:49.9962%,0.4:0.0052%,0.6:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[1.0:26.1164%,0.6:20.8284%,0.8:18.2154%,0.0:17.5466%,0.4:17.285%,0.2:0.0082%]
[INFO] ** service:[0.7025755984000001:99.9954%,0.0:0.0022%,0.0021476384:0.0006%,0.0021789908:0.0004%,0.0021633145999999997:0.0004%,0.08391465880000001:0.0004%,0.0839773636:0.0002%,0.0297847659:0.0002%,0.08394601119999999:0.0002%]
[INFO] ** s_port:[0.834280824:26.1168%,0.8139250565:20.8284%,0.8029830673999999:18.2154%,0.8149336757:17.5468%,0.8137722355:17.2852%,0.0:0.0022%,0.696222263:0.0008%,0.0020936488:0.0006%,0.8059172320999999:0.0004%,0.8343113882:0.0004%,0.0021089309:0.0004%,0.0818051226:0.0004%,0.9385047986:0.0004%,0.814841983:0.0004%,0.8030441959000001:0.0002%,0.9925728957:0.0002%,0.8344030809:0.0002%,0.9705208142:0.0002%,0.8345253376999999:0.0002%,0.0290360046:0.0002%,0.8030136315999999:0.0002%]
[INFO] ** classification:[normal:99.9996%,Single Stage Multi Point:0.0004%]
[INFO] columns with count within 2-10 {'orig': 3, 'type': 3, 'i/f_name': 2, 'i/f_dir': 2, 'proto': 3, 'modbus_function_code': 3, 'modbus_function_description': 4, 'scada_tag': 6, 'service': 9, 'classification': 2}
[INFO] processing batch 0-100000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[4396136       0]
 [ 703864       0]]
[INFO] processing batch 100000-200000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[4496136       0]
 [ 703864       0]]
[INFO] processing batch 200000-300000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[4596136       0]
 [ 703864       0]]
[INFO] processing batch 300000-400000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[4696136       0]
 [ 703864       0]]
[INFO] processing batch 400000-500000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08353268862962723
tp :  99998.0
fp :  2.0
tn :  99998.0
fn :  2.0
accuracy :  0.9999799728393555
precision :  0.9999799728393555
recall :  0.9999799728393555
auc :  0.9999799728393555

y_eval {0: 99998, 1: 2}
pred {0: 100000}
[INFO] confusion matrix for file 
[[99998     0]
 [    2     0]]
[INFO] confusion matrix after adding it to total:
[[4796134       0]
 [ 703866       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/eval/2016-01-02_121729_121.log.part13_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1368 (0.2736%)
[INFO] ** orig:[0.5:99.9996%,1.0:0.0004%]
[INFO] ** type:[1.0:100.0%]
[INFO] ** i/f_name:[0.0:99.9994%,0.5:0.0006%]
[INFO] ** i/f_dir:[0.0:99.9994%,1.0:0.0006%]
[INFO] ** src:[0.0666666667:38.162%,0.9333333333:26.1664%,0.6666666667:18.0742%,0.3333333333:17.5958%,0.8:0.0008%,0.5333333333:0.0002%,0.7333333333:0.0002%,0.6:0.0002%,0.1333333333:0.0002%]
[INFO] ** dst:[0.1764705882:43.4352%,0.9411764706:20.8932%,0.8823529412000001:18.0744%,0.5294117647:17.5952%,0.2941176471:0.0006%,0.4705882353:0.0006%,0.0:0.0006%,0.3529411765:0.0002%]
[INFO] ** proto:[0.5:99.9986%,1.0:0.0008%,0.0:0.0006%]
[INFO] ** appi_name:[0.0:99.9986%,0.0384615385:0.0006%,0.3076923077:0.0006%,0.4230769231:0.0002%]
[INFO] ** proxy_src_ip:[0.6666666667:38.162%,0.0:26.1664%,0.9333333333:18.0742%,0.4:17.5958%,0.5333333333:0.0006%,0.4666666667:0.0004%,0.2666666667:0.0002%,0.6:0.0002%,0.3333333333:0.0002%]
[INFO] ** modbus_function_code:[0.9743589744:99.9986%,0.0:0.0014%]
[INFO] ** modbus_function_description:[0.2:49.9998%,0.0:49.9988%,0.4:0.0014%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[1.0:26.166%,0.6:20.893%,0.8:18.0738%,0.0:17.5948%,0.4:17.2688%,0.2:0.0036%]
[INFO] ** service:[0.7025755984000001:99.9986%,0.08394601119999999:0.0006%,0.0:0.0006%,0.0021476384:0.0002%]
[INFO] ** s_port:[0.834280824:26.1662%,0.8139250565:20.8932%,0.8029830673999999:18.074%,0.8149336757:17.5952%,0.8137722355:17.2688%,0.0:0.0006%,0.814841983:0.0004%,0.9945442875:0.0004%,0.8059172320999999:0.0002%,0.8147502904:0.0002%,0.8030441959000001:0.0002%,0.8344030809:0.0002%,0.0020936488:0.0002%,0.8683752063:0.0002%]
[INFO] ** classification:[normal:92.8338%,Multi Stage Single Point:7.1662%]
[INFO] columns with count within 2-10 {'orig': 2, 'i/f_name': 2, 'i/f_dir': 2, 'src': 9, 'dst': 8, 'proto': 3, 'appi_name': 4, 'proxy_src_ip': 9, 'modbus_function_code': 2, 'modbus_function_description': 3, 'scada_tag': 6, 'service': 4, 'classification': 2}
[INFO] processing batch 0-100000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[4896134       0]
 [ 703866       0]]
[INFO] processing batch 100000-200000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.35849483697414397
tp :  88734.0
fp :  11266.0
tn :  88734.0
fn :  11266.0
accuracy :  0.8873400092124939
precision :  0.8873400092124939
recall :  0.8873400092124939
auc :  0.8873400092124939

y_eval {0: 88734, 1: 11266}
pred {0: 100000}
[INFO] confusion matrix for file 
[[88734     0]
 [11266     0]]
[INFO] confusion matrix after adding it to total:
[[4984868       0]
 [ 715132       0]]
[INFO] processing batch 200000-300000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.26815082935094836
tp :  92435.0
fp :  7565.0
tn :  92435.0
fn :  7565.0
accuracy :  0.9243500232696533
precision :  0.9243500232696533
recall :  0.9243500232696533
auc :  0.9243500232696533

y_eval {0: 92435, 1: 7565}
pred {0: 100000}
[INFO] confusion matrix for file 
[[92435     0]
 [ 7565     0]]
[INFO] confusion matrix after adding it to total:
[[5077303       0]
 [ 722697       0]]
[INFO] processing batch 300000-400000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[5177303       0]
 [ 722697       0]]
[INFO] processing batch 400000-500000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.4984658029317856
tp :  83000.0
fp :  17000.0
tn :  83000.0
fn :  17000.0
accuracy :  0.8299999833106995
precision :  0.8299999833106995
recall :  0.8299999833106995
auc :  0.8299999833106995

y_eval {0: 83000, 1: 17000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[83000     0]
 [17000     0]]
[INFO] confusion matrix after adding it to total:
[[5260303       0]
 [ 739697       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/eval/2016-01-02_121729_121.log.part14_sorted-labeled.csv
[INFO] process dataset, shape: (439824, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (439824, 17)

[INFO] analyzing data
[INFO] 439824 rows
[INFO] ** unixtime:1201 (0.27306%)
[INFO] ** orig:[0.5:99.99955%,1.0:0.00045%]
[INFO] ** type:[1.0:99.99977%,0.5:0.00023%]
[INFO] ** i/f_name:[0.0:99.99864%,0.5:0.00136%]
[INFO] ** i/f_dir:[0.0:99.99886%,1.0:0.00114%]
[INFO] ** src:[0.0666666667:38.09456%,0.9333333333:26.09703%,0.6666666667:18.22161%,0.3333333333:17.58408%,0.1333333333:0.00091%,0.5333333333:0.00068%,0.8:0.00068%,0.4:0.00023%,1.0:0.00023%]
[INFO] ** dst:[0.1764705882:43.35416%,0.9411764706:20.83674%,0.8823529412000001:18.22115%,0.5294117647:17.58385%,0.0:0.00159%,0.2941176471:0.00136%,0.23529411760000002:0.00045%,0.3529411765:0.00023%,0.5882352941:0.00023%,0.4117647059:0.00023%]
[INFO] ** proto:[0.5:99.99818%,0.0:0.00136%,1.0:0.00045%]
[INFO] ** appi_name:[0.0:99.99795%,0.0384615385:0.00136%,0.9230769231:0.00023%,0.7307692308:0.00023%,0.0769230769:0.00023%]
[INFO] ** proxy_src_ip:[0.6666666667:38.09456%,0.0:26.09703%,0.9333333333:18.22161%,0.4:17.58408%,0.5333333333:0.00136%,0.6:0.00068%,1.0:0.00023%,0.7333333333:0.00023%,0.4666666667:0.00023%]
[INFO] ** modbus_function_code:[0.9743589744:99.99795%,0.0:0.00205%]
[INFO] ** modbus_function_description:[0.2:49.99955%,0.0:49.99841%,0.4:0.00205%]
[INFO] ** modbus_transaction_id:65536 (14.90051%)
[INFO] ** scada_tag:[1.0:26.09612%,0.6:20.83652%,0.8:18.22092%,0.0:17.5834%,0.4:17.25758%,0.2:0.00546%]
[INFO] ** service:[0.7025755984000001:99.99795%,0.0:0.00136%,0.0021633145999999997:0.00023%,0.08391465880000001:0.00023%,0.0012540954:0.00023%]
[INFO] ** s_port:[0.834280824:26.09635%,0.8139250565:20.83674%,0.8029830673999999:18.22115%,0.8149336757:17.58362%,0.8137722355:17.25781%,0.0:0.00136%,0.8059172320999999:0.00068%,0.8030136315999999:0.00045%,0.8343113882:0.00045%,0.814841983:0.00045%,0.0818051226:0.00023%,0.0021089309:0.00023%,0.8030441959000001:0.00023%,0.8345253376999999:0.00023%]
[INFO] ** classification:[normal:93.34597%,Single Stage Single Point:4.48861%,Multi Stage Single Point:2.16541%]
[INFO] columns with count within 2-10 {'orig': 2, 'type': 2, 'i/f_name': 2, 'i/f_dir': 2, 'src': 9, 'proto': 3, 'appi_name': 5, 'proxy_src_ip': 9, 'modbus_function_code': 2, 'modbus_function_description': 3, 'scada_tag': 6, 'service': 5, 'classification': 3}
[INFO] processing batch 0-100000/439824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [1 0 0 ... 1 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.40626658194065096
tp :  86777.0
fp :  13223.0
tn :  86777.0
fn :  13223.0
accuracy :  0.8677700161933899
precision :  0.8677700161933899
recall :  0.8677700161933899
auc :  0.8677700161933899

y_eval {0: 86777, 1: 13223}
pred {0: 100000}
[INFO] confusion matrix for file 
[[86777     0]
 [13223     0]]
[INFO] confusion matrix after adding it to total:
[[5347080       0]
 [ 752920       0]]
[INFO] processing batch 100000-200000/439824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.47510476330518725
tp :  83957.0
fp :  16043.0
tn :  83957.0
fn :  16043.0
accuracy :  0.8395699858665466
precision :  0.8395699858665466
recall :  0.8395699858665466
auc :  0.8395699858665466

y_eval {0: 83957, 1: 16043}
pred {0: 100000}
[INFO] confusion matrix for file 
[[83957     0]
 [16043     0]]
[INFO] confusion matrix after adding it to total:
[[5431037       0]
 [ 768963       0]]
[INFO] processing batch 200000-300000/439824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[5531037       0]
 [ 768963       0]]
[INFO] processing batch 300000-400000/439824
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[5631037       0]
 [ 768963       0]]
[INFO] processing batch 400000-500000/439824
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/eval/2016-01-02_172943_122.log.part03_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1376 (0.2752%)
[INFO] ** orig:[0.5:99.9976%,1.0:0.002%,0.0:0.0004%]
[INFO] ** type:[1.0:99.9988%,0.5:0.001%,0.0:0.0002%]
[INFO] ** i/f_name:[0.0:99.9944%,0.5:0.0056%]
[INFO] ** i/f_dir:[0.0:99.9946%,1.0:0.0054%]
[INFO] ** src:[0.0666666667:38.2234%,0.9333333333:26.124%,0.6666666667:18.075%,0.3333333333:17.571%,0.1333333333:0.0036%,0.8:0.0022%,0.2666666667:0.0004%,0.2:0.0002%,0.0:0.0002%]
[INFO] ** dst:[0.1764705882:43.4342%,0.9411764706:20.913%,0.8823529412000001:18.0748%,0.5294117647:17.5708%,0.2941176471:0.0056%,0.0:0.0006%,0.5882352941:0.0004%,0.4705882353:0.0002%,0.23529411760000002:0.0002%,0.058823529400000005:0.0002%]
[INFO] ** proto:[0.5:99.9936%,0.0:0.0056%,1.0:0.0008%]
[INFO] ** appi_name:[0.0:99.9934%,0.0384615385:0.0056%,0.9230769231:0.0004%,0.34615384619999995:0.0002%,0.3076923077:0.0002%,0.9615384615000001:0.0002%]
[INFO] ** proxy_src_ip:[0.6666666667:38.2234%,0.0:26.124%,0.9333333333:18.075%,0.4:17.571%,0.5333333333:0.0056%,0.8:0.0004%,0.4666666667:0.0002%,0.0666666667:0.0002%,0.1333333333:0.0002%]
[INFO] ** modbus_function_code:[0.9743589744:99.9934%,0.0:0.0064%,1.0:0.0002%]
[INFO] ** modbus_function_description:[0.2:49.997%,0.0:49.9964%,0.4:0.0064%,0.6:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[1.0:26.1234%,0.6:20.9128%,0.8:18.0748%,0.0:17.5704%,0.4:17.3102%,0.2:0.0084%]
[INFO] ** service:[0.7025755984000001:99.9936%,0.0:0.0056%,0.08391465880000001:0.0004%,0.0297847659:0.0002%,0.08394601119999999:0.0002%]
[INFO] ** s_port:[0.834280824:26.1238%,0.8139250565:20.913%,0.8029830673999999:18.0748%,0.8149336757:17.5706%,0.8137722355:17.3104%,0.0:0.0056%,0.0818051226:0.0004%,0.814841983:0.0004%,0.9715599976:0.0002%,0.8030136315999999:0.0002%,0.696222263:0.0002%,0.9535729568000001:0.0002%,0.8345253376999999:0.0002%]
[INFO] ** classification:[normal:94.9296%,Single Stage Single Point:5.0704%]
[INFO] columns with count within 2-10 {'orig': 3, 'type': 3, 'i/f_name': 2, 'i/f_dir': 2, 'src': 9, 'proto': 3, 'appi_name': 6, 'proxy_src_ip': 9, 'modbus_function_code': 3, 'modbus_function_description': 4, 'scada_tag': 6, 'service': 5, 'classification': 2}
[INFO] processing batch 0-100000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[5731037       0]
 [ 768963       0]]
[INFO] processing batch 100000-200000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[5831037       0]
 [ 768963       0]]
[INFO] processing batch 200000-300000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[5931037       0]
 [ 768963       0]]
[INFO] processing batch 300000-400000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[6031037       0]
 [ 768963       0]]
[INFO] processing batch 400000-500000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.7023440923690796
tp :  74648.0
fp :  25352.0
tn :  74648.0
fn :  25352.0
accuracy :  0.7464799880981445
precision :  0.7464799880981445
recall :  0.7464799880981445
auc :  0.7464799880981445

y_eval {0: 74648, 1: 25352}
pred {0: 100000}
[INFO] confusion matrix for file 
[[74648     0]
 [25352     0]]
[INFO] confusion matrix after adding it to total:
[[6105685       0]
 [ 794315       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/eval/2016-01-02_172943_122.log.part04_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1377 (0.2754%)
[INFO] ** orig:[0.5:99.995%,1.0:0.005%]
[INFO] ** type:[1.0:100.0%]
[INFO] ** i/f_name:[0.0:99.9944%,0.5:0.0056%]
[INFO] ** i/f_dir:[0.0:99.9944%,1.0:0.0056%]
[INFO] ** src:[0.0666666667:38.203%,0.9333333333:26.1368%,0.6666666667:18.1014%,0.3333333333:17.5508%,0.8:0.005%,1.0:0.0008%,0.5333333333:0.0006%,0.1333333333:0.0006%,0.2666666667:0.0004%,0.4:0.0004%,0.6:0.0002%]
[INFO] ** dst:[0.1764705882:43.4462%,0.9411764706:20.893%,0.8823529412000001:18.1012%,0.5294117647:17.5504%,0.2941176471:0.0056%,0.0:0.0016%,0.6470588235:0.0008%,0.3529411765:0.0006%,0.7058823529000001:0.0004%,0.23529411760000002:0.0002%]
[INFO] ** proto:[0.5:99.9938%,0.0:0.0056%,1.0:0.0006%]
[INFO] ** appi_name:[0.0:99.9926%,0.0384615385:0.0056%,0.7692307692:0.0008%,0.0769230769:0.0004%,0.5384615385:0.0002%,0.4230769231:0.0002%,0.11538461539999999:0.0002%]
[INFO] ** proxy_src_ip:[0.6666666667:38.203%,0.0:26.1368%,0.9333333333:18.1014%,0.4:17.5508%,0.5333333333:0.0056%,0.7333333333:0.0008%,0.6:0.0006%,1.0:0.0004%,0.8:0.0004%,0.3333333333:0.0002%]
[INFO] ** modbus_function_code:[0.9743589744:99.9926%,0.0:0.0074%]
[INFO] ** modbus_function_description:[0.2:49.9972%,0.0:49.9954%,0.4:0.0074%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[1.0:26.1358%,0.6:20.8928%,0.8:18.1008%,0.0:17.55%,0.4:17.31%,0.2:0.0106%]
[INFO] ** service:[0.7025755984000001:99.9926%,0.0:0.0056%,0.0208806885:0.0008%,0.0021633145999999997:0.0004%,0.08543524949999999:0.0002%,0.002116286:0.0002%,0.0021476384:0.0002%]
[INFO] ** s_port:[0.834280824:26.136%,0.8139250565:20.893%,0.8029830673999999:18.101%,0.8149336757:17.5502%,0.8137722355:17.31%,0.0:0.0056%,0.8343113882:0.0006%,0.8059172320999999:0.0006%,0.0021089309:0.0004%,0.814841983:0.0004%,0.8147502904:0.0002%,0.7593068036:0.0002%,0.7586191087:0.0002%,0.15243902439999998:0.0002%,0.15240846019999998:0.0002%,0.8411730545999999:0.0002%,0.8030136315999999:0.0002%,0.8345253376999999:0.0002%,0.0020936488:0.0002%,0.315972859:0.0002%,0.8030441959000001:0.0002%]
[INFO] ** classification:[normal:64.3482%,Single Stage Single Point:35.6518%]
[INFO] columns with count within 2-10 {'orig': 2, 'i/f_name': 2, 'i/f_dir': 2, 'proto': 3, 'appi_name': 7, 'modbus_function_code': 2, 'modbus_function_description': 3, 'scada_tag': 6, 'service': 7, 'classification': 2}
[INFO] processing batch 0-100000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 1 1 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.9511136022567749
tp :  64457.0
fp :  35543.0
tn :  64457.0
fn :  35543.0
accuracy :  0.644569993019104
precision :  0.644569993019104
recall :  0.644569993019104
auc :  0.644569993019104

y_eval {0: 64457, 1: 35543}
pred {0: 100000}
[INFO] confusion matrix for file 
[[64457     0]
 [35543     0]]
[INFO] confusion matrix after adding it to total:
[[6170142       0]
 [ 829858       0]]
[INFO] processing batch 100000-200000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [1 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.9479157978057862
tp :  64588.0
fp :  35412.0
tn :  64588.0
fn :  35412.0
accuracy :  0.6458799839019775
precision :  0.6458799839019775
recall :  0.6458799839019775
auc :  0.6458799839019775

y_eval {0: 64588, 1: 35412}
pred {0: 100000}
[INFO] confusion matrix for file 
[[64588     0]
 [35412     0]]
[INFO] confusion matrix after adding it to total:
[[6234730       0]
 [ 865270       0]]
[INFO] processing batch 200000-300000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 1 0 ... 1 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.9555319374084472
tp :  64276.0
fp :  35724.0
tn :  64276.0
fn :  35724.0
accuracy :  0.6427599787712097
precision :  0.6427599787712097
recall :  0.6427599787712097
auc :  0.6427600383758545

y_eval {0: 64276, 1: 35724}
pred {0: 100000}
[INFO] confusion matrix for file 
[[64276     0]
 [35724     0]]
[INFO] confusion matrix after adding it to total:
[[6299006       0]
 [ 900994       0]]
[INFO] processing batch 300000-400000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [1 1 1 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.955409882926941
tp :  64281.0
fp :  35719.0
tn :  64281.0
fn :  35719.0
accuracy :  0.6428099870681763
precision :  0.6428099870681763
recall :  0.6428099870681763
auc :  0.6428099870681763

y_eval {0: 64281, 1: 35719}
pred {0: 100000}
[INFO] confusion matrix for file 
[[64281     0]
 [35719     0]]
[INFO] confusion matrix after adding it to total:
[[6363287       0]
 [ 936713       0]]
[INFO] processing batch 400000-500000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [1 0 0 ... 1 1 1] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.9588762058258057
tp :  64139.0
fp :  35861.0
tn :  64139.0
fn :  35861.0
accuracy :  0.6413900256156921
precision :  0.6413900256156921
recall :  0.6413900256156921
auc :  0.6413899660110474

y_eval {0: 64139, 1: 35861}
pred {0: 100000}
[INFO] confusion matrix for file 
[[64139     0]
 [35861     0]]
[INFO] confusion matrix after adding it to total:
[[6427426       0]
 [ 972574       0]]
[INFO] reading file data/SWaT2015-Attack-Files-v0.4-minmax/eval/2016-01-02_172943_122.log.part05_sorted-labeled.csv
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1367 (0.2734%)
[INFO] ** orig:[0.5:99.9992%,1.0:0.0008%]
[INFO] ** type:[1.0:100.0%]
[INFO] ** i/f_name:[0.0:99.9984%,0.5:0.0016%]
[INFO] ** i/f_dir:[0.0:99.9984%,1.0:0.0016%]
[INFO] ** src:[0.0666666667:38.0648%,0.9333333333:26.1164%,0.6666666667:18.2044%,0.3333333333:17.6118%,0.8:0.001%,0.1333333333:0.0008%,0.2666666667:0.0004%,1.0:0.0004%]
[INFO] ** dst:[0.1764705882:43.368%,0.9411764706:20.8128%,0.8823529412000001:18.2044%,0.5294117647:17.6114%,0.2941176471:0.0016%,0.0:0.0006%,0.6470588235:0.0004%,0.3529411765:0.0002%,0.4705882353:0.0002%,0.4117647059:0.0002%,0.23529411760000002:0.0002%]
[INFO] ** proto:[0.5:99.998%,0.0:0.0016%,1.0:0.0004%]
[INFO] ** appi_name:[0.0:99.9974%,0.0384615385:0.0016%,0.5384615385:0.0006%,0.4230769231:0.0002%,0.3076923077:0.0002%]
[INFO] ** proxy_src_ip:[0.6666666667:38.0648%,0.0:26.1164%,0.9333333333:18.2044%,0.4:17.6118%,0.5333333333:0.0016%,0.7333333333:0.0004%,0.8:0.0004%,0.4666666667:0.0002%]
[INFO] ** modbus_function_code:[0.9743589744:99.9974%,0.0:0.0026%]
[INFO] ** modbus_function_description:[0.2:49.9992%,0.0:49.9982%,0.4:0.0026%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[1.0:26.1154%,0.6:20.8126%,0.8:18.204%,0.0:17.6112%,0.4:17.2518%,0.2:0.005%]
[INFO] ** service:[0.7025755984000001:99.9974%,0.0:0.0016%,0.002116286:0.0006%,0.08394601119999999:0.0002%,0.0021476384:0.0002%]
[INFO] ** s_port:[0.834280824:26.1158%,0.8139250565:20.8128%,0.8029830673999999:18.204%,0.8149336757:17.6114%,0.8137722355:17.252%,0.0:0.0016%,0.8343113882:0.0004%,0.8147502904:0.0002%,0.7853933615:0.0002%,0.8030136315999999:0.0002%,0.9882022128:0.0002%,0.814841983:0.0002%,0.8344030809:0.0002%,0.9406137294:0.0002%,0.0020936488:0.0002%,0.7943945229:0.0002%,0.8030441959000001:0.0002%]
[INFO] ** classification:[normal:97.0224%,Single Stage Single Point:2.9776%]
[INFO] columns with count within 2-10 {'orig': 2, 'i/f_name': 2, 'i/f_dir': 2, 'src': 8, 'proto': 3, 'appi_name': 5, 'proxy_src_ip': 8, 'modbus_function_code': 2, 'modbus_function_description': 3, 'scada_tag': 6, 'service': 5, 'classification': 2}
[INFO] processing batch 0-100000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [1 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.446910463988781
tp :  85112.0
fp :  14888.0
tn :  85112.0
fn :  14888.0
accuracy :  0.8511199951171875
precision :  0.8511199951171875
recall :  0.8511199951171875
auc :  0.8511199951171875

y_eval {0: 85112, 1: 14888}
pred {0: 100000}
[INFO] confusion matrix for file 
[[85112     0]
 [14888     0]]
[INFO] confusion matrix after adding it to total:
[[6512538       0]
 [ 987462       0]]
[INFO] processing batch 100000-200000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[6612538       0]
 [ 987462       0]]
[INFO] processing batch 200000-300000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[6712538       0]
 [ 987462       0]]
[INFO] processing batch 300000-400000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[6812538       0]
 [ 987462       0]]
[INFO] processing batch 400000-500000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (100000, 16)
y_eval [0 0 0 ... 0 0 0] (100000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  0.08348386727571487
tp :  100000.0
fp :  0.0
tn :  100000.0
fn :  0.0
accuracy :  1.0
precision :  1.0
recall :  1.0
auc :  1.0

y_eval {0: 100000}
pred {0: 100000}
[INFO] confusion matrix for file 
[[100000      0]
 [     0      0]]
[INFO] confusion matrix after adding it to total:
[[6912538       0]
 [ 987462       0]]
--- 165.8326768875122 seconds ---
