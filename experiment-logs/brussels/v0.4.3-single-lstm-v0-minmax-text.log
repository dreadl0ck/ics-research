2020-02-09 10:06:39.835740: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory
2020-02-09 10:06:39.835794: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory
2020-02-09 10:06:39.835800: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-02-09 10:06:40.325998: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory
2020-02-09 10:06:40.326018: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-02-09 10:06:40.326033: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (brussels): /proc/driver/nvidia/version does not exist
2020-02-09 10:06:40.326141: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-02-09 10:06:40.349799: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3312000000 Hz
2020-02-09 10:06:40.350191: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x4cc2800 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-02-09 10:06:40.350215: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Using TensorFlow backend.
WARNING:tensorflow:Large dropout rate: 0.8 (>0.5). In TensorFlow 2.x, dropout() uses dropout rate instead of keep_prob. Please ensure that this is intended.
=================================================
        TRAINING v0.4.4 (multi-class)
=================================================
Date: 2020-02-09 10:06:40.322580
MULTI-CLASS num classes: 5
------------DNN info-------------
wrapLayerSize 2
coreLayerSize 4
numCoreLayers 1
outputLayerActivation softmax
output_dim 5
loss categorical_crossentropy
optimizer adam
------------DNN info-------------
[INFO] input_shape (128, 107)
[INFO] LSTM first and last layer neurons: 2
[INFO] adding core layer 0
[INFO] created DNN
[33m[INFO] epoch 1/3[0m
[33m[INFO] loading file 1-50/1 on epoch 1/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[33mencode_text_dummy orig[0m
[33mencode_text_dummy type[0m
[33mencode_text_dummy i/f_name[0m
[33mencode_text_dummy i/f_dir[0m
[33mencode_text_dummy src[0m
[33mencode_text_dummy dst[0m
[33mencode_text_dummy proto[0m
[33mencode_text_dummy appi_name[0m
[33mencode_text_dummy proxy_src_ip[0m
[33mencode_text_dummy modbus_function_description[0m
[33mencode_text_dummy scada_tag[0m
adding missing-0
adding missing-1
adding missing-2
adding missing-3
adding missing-4
adding missing-5
adding missing-6
adding missing-7
adding missing-8
adding missing-9
adding missing-10
adding missing-11
adding missing-12
adding missing-13
adding missing-14
adding missing-15
adding missing-16
adding missing-17
adding missing-18
adding missing-19
adding missing-20
adding missing-21
adding missing-22
adding missing-23
adding missing-24
len(df.columns) 108
numFeatures 107
[INFO] columns: Index(['unixtime', 'modbus_function_code', 'modbus_transaction_id', 'service',
       's_port', 'classification', 'orig-192.168.1.48', 'type-alert',
       'type-log', 'i/f_name-0',
       ...
       'missing-15', 'missing-16', 'missing-17', 'missing-18', 'missing-19',
       'missing-20', 'missing-21', 'missing-22', 'missing-23', 'missing-24'],
      dtype='object', length=108)
[INFO] analyze dataset: (500000, 108)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1356 (0.2712%)
[INFO] ** modbus_function_code:[0.9743589744:99.9928%,0.0:0.007%,1.0:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** service:[0.7025755984000001:99.9936%,0.0:0.0012%,0.0021476384:0.001%,0.0021789908:0.0008%,0.0208806885:0.0008%,0.0021633145999999997:0.0006%,0.08394601119999999:0.0006%,0.002116286:0.0006%,0.08391465880000001:0.0004%,0.0297847659:0.0002%,0.08543524949999999:0.0002%]
[INFO] ** s_port:[0.834280824:25.8978%,0.8139250565:21.0408%,0.8029830673999999:18.1632%,0.8149336757:17.5212%,0.8137722355:17.368%,0.0:0.0012%,0.0020936488:0.001%,0.792988569:0.0008%,0.0021089309:0.0006%,0.814841983:0.0006%,0.7897640443:0.0004%,0.0818051226:0.0004%,0.8685433095:0.0004%,0.8059172320999999:0.0004%,0.8643407299:0.0002%,0.15240846019999998:0.0002%,0.9399107525:0.0002%,0.15243902439999998:0.0002%,0.980989058:0.0002%,0.8344030809:0.0002%,0.7593068036:0.0002%,0.8411730545999999:0.0002%,0.8668928418999999:0.0002%,0.7586191087:0.0002%,0.8345253376999999:0.0002%,0.0290360046:0.0002%,0.8030136315999999:0.0002%,0.8030441959000001:0.0002%,0.315972859:0.0002%,0.8876612262000001:0.0002%]
[INFO] ** classification:[normal:79.2972%,Single Stage Single Point:20.7028%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** type-alert:[0:99.9998%,1:0.0002%]
[INFO] ** type-log:[1:99.9998%,0:0.0002%]
[INFO] ** i/f_name-0:[0:99.9988%,1:0.0012%]
[INFO] ** i/f_name-eth1:[1:99.9988%,0:0.0012%]
[INFO] ** i/f_dir-inbound:[0:99.9988%,1:0.0012%]
[INFO] ** i/f_dir-outbound:[1:99.9988%,0:0.0012%]
[INFO] ** src-0:[0:99.9988%,1:0.0012%]
[INFO] ** src-192.168.1.10:[0:74.1018%,1:25.8982%]
[INFO] ** src-192.168.1.136:[0:99.9986%,1:0.0014%]
[INFO] ** src-192.168.1.19:[0:99.9986%,1:0.0014%]
[INFO] ** src-192.168.1.199:[0:99.9998%,1:0.0002%]
[INFO] ** src-192.168.1.20:[0:82.4782%,1:17.5218%]
[INFO] ** src-192.168.1.200:[0:99.9996%,1:0.0004%]
[INFO] ** src-192.168.1.201:[0:99.999%,1:0.001%]
[INFO] ** src-192.168.1.30:[0:81.8364%,1:18.1636%]
[INFO] ** src-192.168.1.40:[0:99.9996%,1:0.0004%]
[INFO] ** src-192.168.1.49:[0:99.999%,1:0.001%]
[INFO] ** src-192.168.1.60:[0:61.5912%,1:38.4088%]
[INFO] ** src-192.168.1.88:[0:99.9994%,1:0.0006%]
[INFO] ** dst-0:[0:99.9988%,1:0.0012%]
[INFO] ** dst-192.168.1.10:[0:78.9584%,1:21.0416%]
[INFO] ** dst-192.168.1.19:[0:99.9996%,1:0.0004%]
[INFO] ** dst-192.168.1.20:[0:56.734%,1:43.266%]
[INFO] ** dst-192.168.1.200:[0:99.9996%,1:0.0004%]
[INFO] ** dst-192.168.1.201:[0:99.9988%,1:0.0012%]
[INFO] ** dst-192.168.1.255:[0:99.9984%,1:0.0016%]
[INFO] ** dst-192.168.1.30:[0:82.4786%,1:17.5214%]
[INFO] ** dst-192.168.1.40:[0:81.8366%,1:18.1634%]
[INFO] ** dst-192.168.1.49:[0:99.9996%,1:0.0004%]
[INFO] ** dst-192.168.1.50:[0:99.999%,1:0.001%]
[INFO] ** dst-192.168.1.60:[0:99.9998%,1:0.0002%]
[INFO] ** dst-224.0.0.251:[0:99.9996%,1:0.0004%]
[INFO] ** dst-224.0.0.252:[0:99.9994%,1:0.0006%]
[INFO] ** dst-239.255.255.250:[0:99.9998%,1:0.0002%]
[INFO] ** proto-0:[0:99.9988%,1:0.0012%]
[INFO] ** proto-tcp:[1:99.996%,0:0.004%]
[INFO] ** proto-udp:[0:99.9972%,1:0.0028%]
[INFO] ** appi_name-0:[0:99.9988%,1:0.0012%]
[INFO] ** appi_name-CIP_gen:[0:99.9998%,1:0.0002%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.9928%,0:0.0072%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.9998%,1:0.0002%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.9998%,1:0.0002%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.9994%,1:0.0006%]
[INFO] ** appi_name-EtherNet/IP:[0:99.9998%,1:0.0002%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.9994%,1:0.0006%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.9996%,1:0.0004%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.9994%,1:0.0006%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.999%,1:0.001%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.9996%,1:0.0004%]
[INFO] ** appi_name-OSIsoft PI:[0:99.9998%,1:0.0002%]
[INFO] ** appi_name-SSDP:[0:99.9998%,1:0.0002%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.9996%,1:0.0004%]
[INFO] ** appi_name-Unknown Traffic:[0:99.9992%,1:0.0008%]
[INFO] ** proxy_src_ip-0:[0:99.9988%,1:0.0012%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.1018%,1:25.8982%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.9986%,1:0.0014%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.9986%,1:0.0014%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.9998%,1:0.0002%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.4782%,1:17.5218%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.9996%,1:0.0004%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.999%,1:0.001%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8364%,1:18.1636%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.9996%,1:0.0004%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.999%,1:0.001%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.5912%,1:38.4088%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.9994%,1:0.0006%]
[INFO] ** modbus_function_description-0:[0:99.993%,1:0.007%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.9998%,1:0.0002%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.0046%,1:49.9954%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.0026%,1:49.9974%]
[INFO] ** scada_tag-0:[0:99.99%,1:0.01%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.6322%,1:17.3678%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.1024%,1:25.8976%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.9594%,1:21.0406%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.479%,1:17.521%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.837%,1:18.163%]
[INFO] ** missing-0:[0:100.0%]
[INFO] ** missing-1:[0:100.0%]
[INFO] ** missing-2:[0:100.0%]
[INFO] ** missing-3:[0:100.0%]
[INFO] ** missing-4:[0:100.0%]
[INFO] ** missing-5:[0:100.0%]
[INFO] ** missing-6:[0:100.0%]
[INFO] ** missing-7:[0:100.0%]
[INFO] ** missing-8:[0:100.0%]
[INFO] ** missing-9:[0:100.0%]
[INFO] ** missing-10:[0:100.0%]
[INFO] ** missing-11:[0:100.0%]
[INFO] ** missing-12:[0:100.0%]
[INFO] ** missing-13:[0:100.0%]
[INFO] ** missing-14:[0:100.0%]
[INFO] ** missing-15:[0:100.0%]
[INFO] ** missing-16:[0:100.0%]
[INFO] ** missing-17:[0:100.0%]
[INFO] ** missing-18:[0:100.0%]
[INFO] ** missing-19:[0:100.0%]
[INFO] ** missing-20:[0:100.0%]
[INFO] ** missing-21:[0:100.0%]
[INFO] ** missing-22:[0:100.0%]
[INFO] ** missing-23:[0:100.0%]
[INFO] ** missing-24:[0:100.0%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'classification': 2, 'type-alert': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-SSDP': 2, 'appi_name-Server Message Block (SMB)': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
--------------AFTER DROPPING COLUMNS ----------------
df.columns Index(['unixtime', 'modbus_function_code', 'modbus_transaction_id', 'service',
       's_port', 'classification', 'orig-192.168.1.48', 'type-alert',
       'type-log', 'i/f_name-0',
       ...
       'missing-15', 'missing-16', 'missing-17', 'missing-18', 'missing-19',
       'missing-20', 'missing-21', 'missing-22', 'missing-23', 'missing-24'],
      dtype='object', length=108) 108
        unixtime  modbus_function_code  modbus_transaction_id   service  \
0       0.000000              0.974359               0.105043  0.702576   
1       0.000000              0.974359               0.049699  0.702576   
2       0.000000              0.974359               0.760021  0.702576   
3       0.000000              0.974359               0.724208  0.702576   
4       0.000000              0.974359               0.099031  0.702576   
...          ...                   ...                    ...       ...   
499995  0.003041              0.974359               0.129915  0.702576   
499996  0.003041              0.974359               0.570916  0.702576   
499997  0.003041              0.974359               0.713100  0.702576   
499998  0.003041              0.974359               0.570916  0.702576   
499999  0.003041              0.974359               0.129915  0.702576   

          s_port             classification  orig-192.168.1.48  type-alert  \
0       0.813772                     normal                  1           0   
1       0.834281                     normal                  1           0   
2       0.802983                     normal                  1           0   
3       0.814934                     normal                  1           0   
4       0.813925                     normal                  1           0   
...          ...                        ...                ...         ...   
499995  0.802983                     normal                  1           0   
499996  0.813925  Single Stage Single Point                  1           0   
499997  0.813772                     normal                  1           0   
499998  0.813925  Single Stage Single Point                  1           0   
499999  0.802983                     normal                  1           0   

        type-log  i/f_name-0  i/f_name-eth1  i/f_dir-inbound  \
0              1           0              1                0   
1              1           0              1                0   
2              1           0              1                0   
3              1           0              1                0   
4              1           0              1                0   
...          ...         ...            ...              ...   
499995         1           0              1                0   
499996         1           0              1                0   
499997         1           0              1                0   
499998         1           0              1                0   
499999         1           0              1                0   

        i/f_dir-outbound  src-0  src-192.168.1.10  src-192.168.1.136  \
0                      1      0                 0                  0   
1                      1      0                 1                  0   
2                      1      0                 0                  0   
3                      1      0                 0                  0   
4                      1      0                 0                  0   
...                  ...    ...               ...                ...   
499995                 1      0                 0                  0   
499996                 1      0                 0                  0   
499997                 1      0                 0                  0   
499998                 1      0                 0                  0   
499999                 1      0                 0                  0   

        src-192.168.1.19  src-192.168.1.199  src-192.168.1.20  \
0                      0                  0                 0   
1                      0                  0                 0   
2                      0                  0                 0   
3                      0                  0                 1   
4                      0                  0                 0   
...                  ...                ...               ...   
499995                 0                  0                 0   
499996                 0                  0                 0   
499997                 0                  0                 0   
499998                 0                  0                 0   
499999                 0                  0                 0   

        src-192.168.1.200  src-192.168.1.201  src-192.168.1.30  \
0                       0                  0                 0   
1                       0                  0                 0   
2                       0                  0                 1   
3                       0                  0                 0   
4                       0                  0                 0   
...                   ...                ...               ...   
499995                  0                  0                 1   
499996                  0                  0                 0   
499997                  0                  0                 0   
499998                  0                  0                 0   
499999                  0                  0                 1   

        src-192.168.1.40  src-192.168.1.49  src-192.168.1.60  \
0                      0                 0                 1   
1                      0                 0                 0   
2                      0                 0                 0   
3                      0                 0                 0   
4                      0                 0                 1   
...                  ...               ...               ...   
499995                 0                 0                 0   
499996                 0                 0                 1   
499997                 0                 0                 1   
499998                 0                 0                 1   
499999                 0                 0                 0   

        src-192.168.1.88  dst-0  dst-192.168.1.10  dst-192.168.1.19  \
0                      0      0                 0                 0   
1                      0      0                 0                 0   
2                      0      0                 0                 0   
3                      0      0                 0                 0   
4                      0      0                 1                 0   
...                  ...    ...               ...               ...   
499995                 0      0                 0                 0   
499996                 0      0                 1                 0   
499997                 0      0                 0                 0   
499998                 0      0                 1                 0   
499999                 0      0                 0                 0   

        dst-192.168.1.20  dst-192.168.1.200  dst-192.168.1.201  \
0                      1                  0                  0   
1                      1                  0                  0   
2                      0                  0                  0   
3                      0                  0                  0   
4                      0                  0                  0   
...                  ...                ...                ...   
499995                 0                  0                  0   
499996                 0                  0                  0   
499997                 1                  0                  0   
499998                 0                  0                  0   
499999                 0                  0                  0   

        dst-192.168.1.255  dst-192.168.1.30  dst-192.168.1.40  \
0                       0                 0                 0   
1                       0                 0                 0   
2                       0                 0                 1   
3                       0                 1                 0   
4                       0                 0                 0   
...                   ...               ...               ...   
499995                  0                 0                 1   
499996                  0                 0                 0   
499997                  0                 0                 0   
499998                  0                 0                 0   
499999                  0                 0                 1   

        dst-192.168.1.49  dst-192.168.1.50  dst-192.168.1.60  dst-224.0.0.251  \
0                      0                 0                 0                0   
1                      0                 0                 0                0   
2                      0                 0                 0                0   
3                      0                 0                 0                0   
4                      0                 0                 0                0   
...                  ...               ...               ...              ...   
499995                 0                 0                 0                0   
499996                 0                 0                 0                0   
499997                 0                 0                 0                0   
499998                 0                 0                 0                0   
499999                 0                 0                 0                0   

        dst-224.0.0.252  dst-239.255.255.250  proto-0  proto-tcp  proto-udp  \
0                     0                    0        0          1          0   
1                     0                    0        0          1          0   
2                     0                    0        0          1          0   
3                     0                    0        0          1          0   
4                     0                    0        0          1          0   
...                 ...                  ...      ...        ...        ...   
499995                0                    0        0          1          0   
499996                0                    0        0          1          0   
499997                0                    0        0          1          0   
499998                0                    0        0          1          0   
499999                0                    0        0          1          0   

        appi_name-0  appi_name-CIP_gen  appi_name-CIP_read_tag_service  \
0                 0                  0                               1   
1                 0                  0                               1   
2                 0                  0                               1   
3                 0                  0                               1   
4                 0                  0                               1   
...             ...                ...                             ...   
499995            0                  0                               1   
499996            0                  0                               1   
499997            0                  0                               1   
499998            0                  0                               1   
499999            0                  0                               1   

        appi_name-Common Industrial Protocol  \
0                                          0   
1                                          0   
2                                          0   
3                                          0   
4                                          0   
...                                      ...   
499995                                     0   
499996                                     0   
499997                                     0   
499998                                     0   
499999                                     0   

        appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)  \
0                                                       0                
1                                                       0                
2                                                       0                
3                                                       0                
4                                                       0                
...                                                   ...                
499995                                                  0                
499996                                                  0                
499997                                                  0                
499998                                                  0                
499999                                                  0                

        appi_name-DCE-RPC Protocol  appi_name-EtherNet/IP  \
0                                0                      0   
1                                0                      0   
2                                0                      0   
3                                0                      0   
4                                0                      0   
...                            ...                    ...   
499995                           0                      0   
499996                           0                      0   
499997                           0                      0   
499998                           0                      0   
499999                           0                      0   

        appi_name-LLMNR Protocol  appi_name-Multicast DNS Protocol (mDNS)  \
0                              0                                        0   
1                              0                                        0   
2                              0                                        0   
3                              0                                        0   
4                              0                                        0   
...                          ...                                      ...   
499995                         0                                        0   
499996                         0                                        0   
499997                         0                                        0   
499998                         0                                        0   
499999                         0                                        0   

        appi_name-NetBIOS Datagram Service  appi_name-NetBIOS Name Service  \
0                                        0                               0   
1                                        0                               0   
2                                        0                               0   
3                                        0                               0   
4                                        0                               0   
...                                    ...                             ...   
499995                                   0                               0   
499996                                   0                               0   
499997                                   0                               0   
499998                                   0                               0   
499999                                   0                               0   

        appi_name-NetBIOS Session Service  appi_name-OSIsoft PI  \
0                                       0                     0   
1                                       0                     0   
2                                       0                     0   
3                                       0                     0   
4                                       0                     0   
...                                   ...                   ...   
499995                                  0                     0   
499996                                  0                     0   
499997                                  0                     0   
499998                                  0                     0   
499999                                  0                     0   

        appi_name-SSDP  appi_name-Server Message Block (SMB)  \
0                    0                                     0   
1                    0                                     0   
2                    0                                     0   
3                    0                                     0   
4                    0                                     0   
...                ...                                   ...   
499995               0                                     0   
499996               0                                     0   
499997               0                                     0   
499998               0                                     0   
499999               0                                     0   

        appi_name-Unknown Traffic  proxy_src_ip-0  proxy_src_ip-192.168.1.10  \
0                               0               0                          0   
1                               0               0                          1   
2                               0               0                          0   
3                               0               0                          0   
4                               0               0                          0   
...                           ...             ...                        ...   
499995                          0               0                          0   
499996                          0               0                          0   
499997                          0               0                          0   
499998                          0               0                          0   
499999                          0               0                          0   

        proxy_src_ip-192.168.1.136  proxy_src_ip-192.168.1.19  \
0                                0                          0   
1                                0                          0   
2                                0                          0   
3                                0                          0   
4                                0                          0   
...                            ...                        ...   
499995                           0                          0   
499996                           0                          0   
499997                           0                          0   
499998                           0                          0   
499999                           0                          0   

        proxy_src_ip-192.168.1.199  proxy_src_ip-192.168.1.20  \
0                                0                          0   
1                                0                          0   
2                                0                          0   
3                                0                          1   
4                                0                          0   
...                            ...                        ...   
499995                           0                          0   
499996                           0                          0   
499997                           0                          0   
499998                           0                          0   
499999                           0                          0   

        proxy_src_ip-192.168.1.200  proxy_src_ip-192.168.1.201  \
0                                0                           0   
1                                0                           0   
2                                0                           0   
3                                0                           0   
4                                0                           0   
...                            ...                         ...   
499995                           0                           0   
499996                           0                           0   
499997                           0                           0   
499998                           0                           0   
499999                           0                           0   

        proxy_src_ip-192.168.1.30  proxy_src_ip-192.168.1.40  \
0                               0                          0   
1                               0                          0   
2                               1                          0   
3                               0                          0   
4                               0                          0   
...                           ...                        ...   
499995                          1                          0   
499996                          0                          0   
499997                          0                          0   
499998                          0                          0   
499999                          1                          0   

        proxy_src_ip-192.168.1.49  proxy_src_ip-192.168.1.60  \
0                               0                          1   
1                               0                          0   
2                               0                          0   
3                               0                          0   
4                               0                          1   
...                           ...                        ...   
499995                          0                          0   
499996                          0                          1   
499997                          0                          1   
499998                          0                          1   
499999                          0                          0   

        proxy_src_ip-192.168.1.88  modbus_function_description-0  \
0                               0                              0   
1                               0                              0   
2                               0                              0   
3                               0                              0   
4                               0                              0   
...                           ...                            ...   
499995                          0                              0   
499996                          0                              0   
499997                          0                              0   
499998                          0                              0   
499999                          0                              0   

        modbus_function_description-Forward Close - Response  \
0                                                       0      
1                                                       0      
2                                                       0      
3                                                       0      
4                                                       0      
...                                                   ...      
499995                                                  0      
499996                                                  0      
499997                                                  0      
499998                                                  0      
499999                                                  0      

        modbus_function_description-Read Tag Service  \
0                                                  0   
1                                                  0   
2                                                  1   
3                                                  1   
4                                                  1   
...                                              ...   
499995                                             1   
499996                                             1   
499997                                             1   
499998                                             0   
499999                                             0   

        modbus_function_description-Read Tag Service - Response  scada_tag-0  \
0                                                       1                  0   
1                                                       1                  0   
2                                                       0                  0   
3                                                       0                  0   
4                                                       0                  0   
...                                                   ...                ...   
499995                                                  0                  0   
499996                                                  0                  0   
499997                                                  0                  0   
499998                                                  1                  0   
499999                                                  1                  0   

        scada_tag-HMI_AIT202  scada_tag-HMI_FIT201  scada_tag-HMI_LIT101  \
0                          1                     0                     0   
1                          0                     1                     0   
2                          0                     0                     0   
3                          0                     0                     0   
4                          0                     0                     1   
...                      ...                   ...                   ...   
499995                     0                     0                     0   
499996                     0                     0                     1   
499997                     1                     0                     0   
499998                     0                     0                     1   
499999                     0                     0                     0   

        scada_tag-HMI_LIT301  scada_tag-HMI_LIT401  missing-0  missing-1  \
0                          0                     0          0          0   
1                          0                     0          0          0   
2                          0                     1          0          0   
3                          1                     0          0          0   
4                          0                     0          0          0   
...                      ...                   ...        ...        ...   
499995                     0                     1          0          0   
499996                     0                     0          0          0   
499997                     0                     0          0          0   
499998                     0                     0          0          0   
499999                     0                     1          0          0   

        missing-2  missing-3  missing-4  missing-5  missing-6  missing-7  \
0               0          0          0          0          0          0   
1               0          0          0          0          0          0   
2               0          0          0          0          0          0   
3               0          0          0          0          0          0   
4               0          0          0          0          0          0   
...           ...        ...        ...        ...        ...        ...   
499995          0          0          0          0          0          0   
499996          0          0          0          0          0          0   
499997          0          0          0          0          0          0   
499998          0          0          0          0          0          0   
499999          0          0          0          0          0          0   

        missing-8  missing-9  missing-10  missing-11  missing-12  missing-13  \
0               0          0           0           0           0           0   
1               0          0           0           0           0           0   
2               0          0           0           0           0           0   
3               0          0           0           0           0           0   
4               0          0           0           0           0           0   
...           ...        ...         ...         ...         ...         ...   
499995          0          0           0           0           0           0   
499996          0          0           0           0           0           0   
499997          0          0           0           0           0           0   
499998          0          0           0           0           0           0   
499999          0          0           0           0           0           0   

        missing-14  missing-15  missing-16  missing-17  missing-18  \
0                0           0           0           0           0   
1                0           0           0           0           0   
2                0           0           0           0           0   
3                0           0           0           0           0   
4                0           0           0           0           0   
...            ...         ...         ...         ...         ...   
499995           0           0           0           0           0   
499996           0           0           0           0           0   
499997           0           0           0           0           0   
499998           0           0           0           0           0   
499999           0           0           0           0           0   

        missing-19  missing-20  missing-21  missing-22  missing-23  missing-24  
0                0           0           0           0           0           0  
1                0           0           0           0           0           0  
2                0           0           0           0           0           0  
3                0           0           0           0           0           0  
4                0           0           0           0           0           0  
...            ...         ...         ...         ...         ...         ...  
499995           0           0           0           0           0           0  
499996           0           0           0           0           0           0  
499997           0           0           0           0           0           0  
499998           0           0           0           0           0           0  
499999           0           0           0           0           0           0  

[500000 rows x 108 columns]
[INFO] processing batch 0-256000/500000
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99297%,0.0:0.00664%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:57548 (22.47969%)
[INFO] ** service:[0.7025755984000001:99.99453%,0.0021476384:0.00117%,0.0:0.00117%,0.0021789908:0.00078%,0.0021633145999999997:0.00078%,0.08391465880000001:0.00078%,0.0297847659:0.00039%,0.08394601119999999:0.00039%]
[INFO] ** s_port:[0.834280824:25.90586%,0.8139250565:21.04297%,0.8029830673999999:18.20469%,0.8149336757:17.47891%,0.8137722355:17.3582%,0.792988569:0.00156%,0.0:0.00117%,0.0020936488:0.00117%,0.0021089309:0.00078%,0.814841983:0.00078%,0.8059172320999999:0.00078%,0.7897640443:0.00078%,0.0818051226:0.00078%,0.0290360046:0.00039%,0.8030441959000001:0.00039%,0.980989058:0.00039%,0.8345253376999999:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.10:[0:74.09375%,1:25.90625%]
[INFO] ** src-192.168.1.136:[0:99.99727%,1:0.00273%]
[INFO] ** src-192.168.1.19:[0:99.99727%,1:0.00273%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.52031%,1:17.47969%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.79492%,1:18.20508%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.59883%,1:38.40117%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.95547%,1:21.04453%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.73555%,1:43.26445%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.30:[0:82.5207%,1:17.4793%]
[INFO] ** dst-192.168.1.40:[0:81.79531%,1:18.20469%]
[INFO] ** dst-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99531%,0:0.00469%]
[INFO] ** proto-udp:[0:99.99648%,1:0.00352%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99297%,0:0.00703%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.09375%,1:25.90625%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52031%,1:17.47969%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.79492%,1:18.20508%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.59883%,1:38.40117%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99336%,1:0.00664%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00508%,1:49.99492%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** scada_tag-0:[0:99.98984%,1:0.01016%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64219%,1:17.35781%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.09453%,1:25.90547%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.95703%,1:21.04297%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.52109%,1:17.47891%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.79531%,1:18.20469%]
[INFO] ** missing-0:[0:100.0%]
[INFO] ** missing-1:[0:100.0%]
[INFO] ** missing-2:[0:100.0%]
[INFO] ** missing-3:[0:100.0%]
[INFO] ** missing-4:[0:100.0%]
[INFO] ** missing-5:[0:100.0%]
[INFO] ** missing-6:[0:100.0%]
[INFO] ** missing-7:[0:100.0%]
[INFO] ** missing-8:[0:100.0%]
[INFO] ** missing-9:[0:100.0%]
[INFO] ** missing-10:[0:100.0%]
[INFO] ** missing-11:[0:100.0%]
[INFO] ** missing-12:[0:100.0%]
[INFO] ** missing-13:[0:100.0%]
[INFO] ** missing-14:[0:100.0%]
[INFO] ** missing-15:[0:100.0%]
[INFO] ** missing-16:[0:100.0%]
[INFO] ** missing-17:[0:100.0%]
[INFO] ** missing-18:[0:100.0%]
[INFO] ** missing-19:[0:100.0%]
[INFO] ** missing-20:[0:100.0%]
[INFO] ** missing-21:[0:100.0%]
[INFO] ** missing-22:[0:100.0%]
[INFO] ** missing-23:[0:100.0%]
[INFO] ** missing-24:[0:100.0%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 8, 'type-alert': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-SSDP': 2, 'appi_name-Server Message Block (SMB)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]2020-02-09 10:06:45.396164: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-09 10:06:45.410566: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 10:06:45.416845: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 10:06:45.468951: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-09 10:06:45.471765: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-09 10:06:45.476234: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 10:06:45.480644: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 10:06:45.492840: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-09 10:06:49.537118: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-09 10:06:49.540687: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 10:06:49.542355: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 10:06:49.554212: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-09 10:06:49.554990: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-09 10:06:49.556127: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 10:06:49.557270: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 10:06:49.561148: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.

z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 5s - loss: 1.5738 - tp: 0.0000e+00 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 192000.0000 - accuracy: 0.8000 - precision: 0.0000e+00 - recall: 0.0000e+00 - auc: 0.9573 - val_loss: 1.5356 - val_tp: 0.0000e+00 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 64000.0000 - val_accuracy: 0.8000 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-001-files-0-50-batch-0-256000
[INFO] processing batch 256000-512000/500000
[33m[LOSS] 1.5356293201446534[0m
[33m[INFO] epoch 2/3[0m
[33m[INFO] loading file 1-50/1 on epoch 2/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[33mencode_text_dummy orig[0m
[33mencode_text_dummy type[0m
[33mencode_text_dummy i/f_name[0m
[33mencode_text_dummy i/f_dir[0m
[33mencode_text_dummy src[0m
[33mencode_text_dummy dst[0m
[33mencode_text_dummy proto[0m
[33mencode_text_dummy appi_name[0m
[33mencode_text_dummy proxy_src_ip[0m
[33mencode_text_dummy modbus_function_description[0m
[33mencode_text_dummy scada_tag[0m
adding missing-0
adding missing-1
adding missing-2
adding missing-3
adding missing-4
adding missing-5
adding missing-6
adding missing-7
adding missing-8
adding missing-9
adding missing-10
adding missing-11
adding missing-12
adding missing-13
adding missing-14
adding missing-15
adding missing-16
adding missing-17
adding missing-18
adding missing-19
adding missing-20
adding missing-21
adding missing-22
adding missing-23
adding missing-24
len(df.columns) 108
numFeatures 107
[INFO] columns: Index(['unixtime', 'modbus_function_code', 'modbus_transaction_id', 'service',
       's_port', 'classification', 'orig-192.168.1.48', 'type-alert',
       'type-log', 'i/f_name-0',
       ...
       'missing-15', 'missing-16', 'missing-17', 'missing-18', 'missing-19',
       'missing-20', 'missing-21', 'missing-22', 'missing-23', 'missing-24'],
      dtype='object', length=108)
[INFO] analyze dataset: (500000, 108)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1356 (0.2712%)
[INFO] ** modbus_function_code:[0.9743589744:99.9928%,0.0:0.007%,1.0:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** service:[0.7025755984000001:99.9936%,0.0:0.0012%,0.0021476384:0.001%,0.0021789908:0.0008%,0.0208806885:0.0008%,0.0021633145999999997:0.0006%,0.08394601119999999:0.0006%,0.002116286:0.0006%,0.08391465880000001:0.0004%,0.0297847659:0.0002%,0.08543524949999999:0.0002%]
[INFO] ** s_port:[0.834280824:25.8978%,0.8139250565:21.0408%,0.8029830673999999:18.1632%,0.8149336757:17.5212%,0.8137722355:17.368%,0.0:0.0012%,0.0020936488:0.001%,0.792988569:0.0008%,0.0021089309:0.0006%,0.814841983:0.0006%,0.7897640443:0.0004%,0.0818051226:0.0004%,0.8685433095:0.0004%,0.8059172320999999:0.0004%,0.8643407299:0.0002%,0.15240846019999998:0.0002%,0.9399107525:0.0002%,0.15243902439999998:0.0002%,0.980989058:0.0002%,0.8344030809:0.0002%,0.7593068036:0.0002%,0.8411730545999999:0.0002%,0.8668928418999999:0.0002%,0.7586191087:0.0002%,0.8345253376999999:0.0002%,0.0290360046:0.0002%,0.8030136315999999:0.0002%,0.8030441959000001:0.0002%,0.315972859:0.0002%,0.8876612262000001:0.0002%]
[INFO] ** classification:[normal:79.2972%,Single Stage Single Point:20.7028%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** type-alert:[0:99.9998%,1:0.0002%]
[INFO] ** type-log:[1:99.9998%,0:0.0002%]
[INFO] ** i/f_name-0:[0:99.9988%,1:0.0012%]
[INFO] ** i/f_name-eth1:[1:99.9988%,0:0.0012%]
[INFO] ** i/f_dir-inbound:[0:99.9988%,1:0.0012%]
[INFO] ** i/f_dir-outbound:[1:99.9988%,0:0.0012%]
[INFO] ** src-0:[0:99.9988%,1:0.0012%]
[INFO] ** src-192.168.1.10:[0:74.1018%,1:25.8982%]
[INFO] ** src-192.168.1.136:[0:99.9986%,1:0.0014%]
[INFO] ** src-192.168.1.19:[0:99.9986%,1:0.0014%]
[INFO] ** src-192.168.1.199:[0:99.9998%,1:0.0002%]
[INFO] ** src-192.168.1.20:[0:82.4782%,1:17.5218%]
[INFO] ** src-192.168.1.200:[0:99.9996%,1:0.0004%]
[INFO] ** src-192.168.1.201:[0:99.999%,1:0.001%]
[INFO] ** src-192.168.1.30:[0:81.8364%,1:18.1636%]
[INFO] ** src-192.168.1.40:[0:99.9996%,1:0.0004%]
[INFO] ** src-192.168.1.49:[0:99.999%,1:0.001%]
[INFO] ** src-192.168.1.60:[0:61.5912%,1:38.4088%]
[INFO] ** src-192.168.1.88:[0:99.9994%,1:0.0006%]
[INFO] ** dst-0:[0:99.9988%,1:0.0012%]
[INFO] ** dst-192.168.1.10:[0:78.9584%,1:21.0416%]
[INFO] ** dst-192.168.1.19:[0:99.9996%,1:0.0004%]
[INFO] ** dst-192.168.1.20:[0:56.734%,1:43.266%]
[INFO] ** dst-192.168.1.200:[0:99.9996%,1:0.0004%]
[INFO] ** dst-192.168.1.201:[0:99.9988%,1:0.0012%]
[INFO] ** dst-192.168.1.255:[0:99.9984%,1:0.0016%]
[INFO] ** dst-192.168.1.30:[0:82.4786%,1:17.5214%]
[INFO] ** dst-192.168.1.40:[0:81.8366%,1:18.1634%]
[INFO] ** dst-192.168.1.49:[0:99.9996%,1:0.0004%]
[INFO] ** dst-192.168.1.50:[0:99.999%,1:0.001%]
[INFO] ** dst-192.168.1.60:[0:99.9998%,1:0.0002%]
[INFO] ** dst-224.0.0.251:[0:99.9996%,1:0.0004%]
[INFO] ** dst-224.0.0.252:[0:99.9994%,1:0.0006%]
[INFO] ** dst-239.255.255.250:[0:99.9998%,1:0.0002%]
[INFO] ** proto-0:[0:99.9988%,1:0.0012%]
[INFO] ** proto-tcp:[1:99.996%,0:0.004%]
[INFO] ** proto-udp:[0:99.9972%,1:0.0028%]
[INFO] ** appi_name-0:[0:99.9988%,1:0.0012%]
[INFO] ** appi_name-CIP_gen:[0:99.9998%,1:0.0002%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.9928%,0:0.0072%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.9998%,1:0.0002%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.9998%,1:0.0002%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.9994%,1:0.0006%]
[INFO] ** appi_name-EtherNet/IP:[0:99.9998%,1:0.0002%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.9994%,1:0.0006%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.9996%,1:0.0004%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.9994%,1:0.0006%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.999%,1:0.001%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.9996%,1:0.0004%]
[INFO] ** appi_name-OSIsoft PI:[0:99.9998%,1:0.0002%]
[INFO] ** appi_name-SSDP:[0:99.9998%,1:0.0002%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.9996%,1:0.0004%]
[INFO] ** appi_name-Unknown Traffic:[0:99.9992%,1:0.0008%]
[INFO] ** proxy_src_ip-0:[0:99.9988%,1:0.0012%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.1018%,1:25.8982%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.9986%,1:0.0014%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.9986%,1:0.0014%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.9998%,1:0.0002%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.4782%,1:17.5218%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.9996%,1:0.0004%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.999%,1:0.001%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8364%,1:18.1636%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.9996%,1:0.0004%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.999%,1:0.001%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.5912%,1:38.4088%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.9994%,1:0.0006%]
[INFO] ** modbus_function_description-0:[0:99.993%,1:0.007%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.9998%,1:0.0002%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.0046%,1:49.9954%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.0026%,1:49.9974%]
[INFO] ** scada_tag-0:[0:99.99%,1:0.01%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.6322%,1:17.3678%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.1024%,1:25.8976%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.9594%,1:21.0406%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.479%,1:17.521%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.837%,1:18.163%]
[INFO] ** missing-0:[0:100.0%]
[INFO] ** missing-1:[0:100.0%]
[INFO] ** missing-2:[0:100.0%]
[INFO] ** missing-3:[0:100.0%]
[INFO] ** missing-4:[0:100.0%]
[INFO] ** missing-5:[0:100.0%]
[INFO] ** missing-6:[0:100.0%]
[INFO] ** missing-7:[0:100.0%]
[INFO] ** missing-8:[0:100.0%]
[INFO] ** missing-9:[0:100.0%]
[INFO] ** missing-10:[0:100.0%]
[INFO] ** missing-11:[0:100.0%]
[INFO] ** missing-12:[0:100.0%]
[INFO] ** missing-13:[0:100.0%]
[INFO] ** missing-14:[0:100.0%]
[INFO] ** missing-15:[0:100.0%]
[INFO] ** missing-16:[0:100.0%]
[INFO] ** missing-17:[0:100.0%]
[INFO] ** missing-18:[0:100.0%]
[INFO] ** missing-19:[0:100.0%]
[INFO] ** missing-20:[0:100.0%]
[INFO] ** missing-21:[0:100.0%]
[INFO] ** missing-22:[0:100.0%]
[INFO] ** missing-23:[0:100.0%]
[INFO] ** missing-24:[0:100.0%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'classification': 2, 'type-alert': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-SSDP': 2, 'appi_name-Server Message Block (SMB)': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
--------------AFTER DROPPING COLUMNS ----------------
df.columns Index(['unixtime', 'modbus_function_code', 'modbus_transaction_id', 'service',
       's_port', 'classification', 'orig-192.168.1.48', 'type-alert',
       'type-log', 'i/f_name-0',
       ...
       'missing-15', 'missing-16', 'missing-17', 'missing-18', 'missing-19',
       'missing-20', 'missing-21', 'missing-22', 'missing-23', 'missing-24'],
      dtype='object', length=108) 108
        unixtime  modbus_function_code  modbus_transaction_id   service  \
0       0.000000              0.974359               0.105043  0.702576   
1       0.000000              0.974359               0.049699  0.702576   
2       0.000000              0.974359               0.760021  0.702576   
3       0.000000              0.974359               0.724208  0.702576   
4       0.000000              0.974359               0.099031  0.702576   
...          ...                   ...                    ...       ...   
499995  0.003041              0.974359               0.129915  0.702576   
499996  0.003041              0.974359               0.570916  0.702576   
499997  0.003041              0.974359               0.713100  0.702576   
499998  0.003041              0.974359               0.570916  0.702576   
499999  0.003041              0.974359               0.129915  0.702576   

          s_port             classification  orig-192.168.1.48  type-alert  \
0       0.813772                     normal                  1           0   
1       0.834281                     normal                  1           0   
2       0.802983                     normal                  1           0   
3       0.814934                     normal                  1           0   
4       0.813925                     normal                  1           0   
...          ...                        ...                ...         ...   
499995  0.802983                     normal                  1           0   
499996  0.813925  Single Stage Single Point                  1           0   
499997  0.813772                     normal                  1           0   
499998  0.813925  Single Stage Single Point                  1           0   
499999  0.802983                     normal                  1           0   

        type-log  i/f_name-0  i/f_name-eth1  i/f_dir-inbound  \
0              1           0              1                0   
1              1           0              1                0   
2              1           0              1                0   
3              1           0              1                0   
4              1           0              1                0   
...          ...         ...            ...              ...   
499995         1           0              1                0   
499996         1           0              1                0   
499997         1           0              1                0   
499998         1           0              1                0   
499999         1           0              1                0   

        i/f_dir-outbound  src-0  src-192.168.1.10  src-192.168.1.136  \
0                      1      0                 0                  0   
1                      1      0                 1                  0   
2                      1      0                 0                  0   
3                      1      0                 0                  0   
4                      1      0                 0                  0   
...                  ...    ...               ...                ...   
499995                 1      0                 0                  0   
499996                 1      0                 0                  0   
499997                 1      0                 0                  0   
499998                 1      0                 0                  0   
499999                 1      0                 0                  0   

        src-192.168.1.19  src-192.168.1.199  src-192.168.1.20  \
0                      0                  0                 0   
1                      0                  0                 0   
2                      0                  0                 0   
3                      0                  0                 1   
4                      0                  0                 0   
...                  ...                ...               ...   
499995                 0                  0                 0   
499996                 0                  0                 0   
499997                 0                  0                 0   
499998                 0                  0                 0   
499999                 0                  0                 0   

        src-192.168.1.200  src-192.168.1.201  src-192.168.1.30  \
0                       0                  0                 0   
1                       0                  0                 0   
2                       0                  0                 1   
3                       0                  0                 0   
4                       0                  0                 0   
...                   ...                ...               ...   
499995                  0                  0                 1   
499996                  0                  0                 0   
499997                  0                  0                 0   
499998                  0                  0                 0   
499999                  0                  0                 1   

        src-192.168.1.40  src-192.168.1.49  src-192.168.1.60  \
0                      0                 0                 1   
1                      0                 0                 0   
2                      0                 0                 0   
3                      0                 0                 0   
4                      0                 0                 1   
...                  ...               ...               ...   
499995                 0                 0                 0   
499996                 0                 0                 1   
499997                 0                 0                 1   
499998                 0                 0                 1   
499999                 0                 0                 0   

        src-192.168.1.88  dst-0  dst-192.168.1.10  dst-192.168.1.19  \
0                      0      0                 0                 0   
1                      0      0                 0                 0   
2                      0      0                 0                 0   
3                      0      0                 0                 0   
4                      0      0                 1                 0   
...                  ...    ...               ...               ...   
499995                 0      0                 0                 0   
499996                 0      0                 1                 0   
499997                 0      0                 0                 0   
499998                 0      0                 1                 0   
499999                 0      0                 0                 0   

        dst-192.168.1.20  dst-192.168.1.200  dst-192.168.1.201  \
0                      1                  0                  0   
1                      1                  0                  0   
2                      0                  0                  0   
3                      0                  0                  0   
4                      0                  0                  0   
...                  ...                ...                ...   
499995                 0                  0                  0   
499996                 0                  0                  0   
499997                 1                  0                  0   
499998                 0                  0                  0   
499999                 0                  0                  0   

        dst-192.168.1.255  dst-192.168.1.30  dst-192.168.1.40  \
0                       0                 0                 0   
1                       0                 0                 0   
2                       0                 0                 1   
3                       0                 1                 0   
4                       0                 0                 0   
...                   ...               ...               ...   
499995                  0                 0                 1   
499996                  0                 0                 0   
499997                  0                 0                 0   
499998                  0                 0                 0   
499999                  0                 0                 1   

        dst-192.168.1.49  dst-192.168.1.50  dst-192.168.1.60  dst-224.0.0.251  \
0                      0                 0                 0                0   
1                      0                 0                 0                0   
2                      0                 0                 0                0   
3                      0                 0                 0                0   
4                      0                 0                 0                0   
...                  ...               ...               ...              ...   
499995                 0                 0                 0                0   
499996                 0                 0                 0                0   
499997                 0                 0                 0                0   
499998                 0                 0                 0                0   
499999                 0                 0                 0                0   

        dst-224.0.0.252  dst-239.255.255.250  proto-0  proto-tcp  proto-udp  \
0                     0                    0        0          1          0   
1                     0                    0        0          1          0   
2                     0                    0        0          1          0   
3                     0                    0        0          1          0   
4                     0                    0        0          1          0   
...                 ...                  ...      ...        ...        ...   
499995                0                    0        0          1          0   
499996                0                    0        0          1          0   
499997                0                    0        0          1          0   
499998                0                    0        0          1          0   
499999                0                    0        0          1          0   

        appi_name-0  appi_name-CIP_gen  appi_name-CIP_read_tag_service  \
0                 0                  0                               1   
1                 0                  0                               1   
2                 0                  0                               1   
3                 0                  0                               1   
4                 0                  0                               1   
...             ...                ...                             ...   
499995            0                  0                               1   
499996            0                  0                               1   
499997            0                  0                               1   
499998            0                  0                               1   
499999            0                  0                               1   

        appi_name-Common Industrial Protocol  \
0                                          0   
1                                          0   
2                                          0   
3                                          0   
4                                          0   
...                                      ...   
499995                                     0   
499996                                     0   
499997                                     0   
499998                                     0   
499999                                     0   

        appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)  \
0                                                       0                
1                                                       0                
2                                                       0                
3                                                       0                
4                                                       0                
...                                                   ...                
499995                                                  0                
499996                                                  0                
499997                                                  0                
499998                                                  0                
499999                                                  0                

        appi_name-DCE-RPC Protocol  appi_name-EtherNet/IP  \
0                                0                      0   
1                                0                      0   
2                                0                      0   
3                                0                      0   
4                                0                      0   
...                            ...                    ...   
499995                           0                      0   
499996                           0                      0   
499997                           0                      0   
499998                           0                      0   
499999                           0                      0   

        appi_name-LLMNR Protocol  appi_name-Multicast DNS Protocol (mDNS)  \
0                              0                                        0   
1                              0                                        0   
2                              0                                        0   
3                              0                                        0   
4                              0                                        0   
...                          ...                                      ...   
499995                         0                                        0   
499996                         0                                        0   
499997                         0                                        0   
499998                         0                                        0   
499999                         0                                        0   

        appi_name-NetBIOS Datagram Service  appi_name-NetBIOS Name Service  \
0                                        0                               0   
1                                        0                               0   
2                                        0                               0   
3                                        0                               0   
4                                        0                               0   
...                                    ...                             ...   
499995                                   0                               0   
499996                                   0                               0   
499997                                   0                               0   
499998                                   0                               0   
499999                                   0                               0   

        appi_name-NetBIOS Session Service  appi_name-OSIsoft PI  \
0                                       0                     0   
1                                       0                     0   
2                                       0                     0   
3                                       0                     0   
4                                       0                     0   
...                                   ...                   ...   
499995                                  0                     0   
499996                                  0                     0   
499997                                  0                     0   
499998                                  0                     0   
499999                                  0                     0   

        appi_name-SSDP  appi_name-Server Message Block (SMB)  \
0                    0                                     0   
1                    0                                     0   
2                    0                                     0   
3                    0                                     0   
4                    0                                     0   
...                ...                                   ...   
499995               0                                     0   
499996               0                                     0   
499997               0                                     0   
499998               0                                     0   
499999               0                                     0   

        appi_name-Unknown Traffic  proxy_src_ip-0  proxy_src_ip-192.168.1.10  \
0                               0               0                          0   
1                               0               0                          1   
2                               0               0                          0   
3                               0               0                          0   
4                               0               0                          0   
...                           ...             ...                        ...   
499995                          0               0                          0   
499996                          0               0                          0   
499997                          0               0                          0   
499998                          0               0                          0   
499999                          0               0                          0   

        proxy_src_ip-192.168.1.136  proxy_src_ip-192.168.1.19  \
0                                0                          0   
1                                0                          0   
2                                0                          0   
3                                0                          0   
4                                0                          0   
...                            ...                        ...   
499995                           0                          0   
499996                           0                          0   
499997                           0                          0   
499998                           0                          0   
499999                           0                          0   

        proxy_src_ip-192.168.1.199  proxy_src_ip-192.168.1.20  \
0                                0                          0   
1                                0                          0   
2                                0                          0   
3                                0                          1   
4                                0                          0   
...                            ...                        ...   
499995                           0                          0   
499996                           0                          0   
499997                           0                          0   
499998                           0                          0   
499999                           0                          0   

        proxy_src_ip-192.168.1.200  proxy_src_ip-192.168.1.201  \
0                                0                           0   
1                                0                           0   
2                                0                           0   
3                                0                           0   
4                                0                           0   
...                            ...                         ...   
499995                           0                           0   
499996                           0                           0   
499997                           0                           0   
499998                           0                           0   
499999                           0                           0   

        proxy_src_ip-192.168.1.30  proxy_src_ip-192.168.1.40  \
0                               0                          0   
1                               0                          0   
2                               1                          0   
3                               0                          0   
4                               0                          0   
...                           ...                        ...   
499995                          1                          0   
499996                          0                          0   
499997                          0                          0   
499998                          0                          0   
499999                          1                          0   

        proxy_src_ip-192.168.1.49  proxy_src_ip-192.168.1.60  \
0                               0                          1   
1                               0                          0   
2                               0                          0   
3                               0                          0   
4                               0                          1   
...                           ...                        ...   
499995                          0                          0   
499996                          0                          1   
499997                          0                          1   
499998                          0                          1   
499999                          0                          0   

        proxy_src_ip-192.168.1.88  modbus_function_description-0  \
0                               0                              0   
1                               0                              0   
2                               0                              0   
3                               0                              0   
4                               0                              0   
...                           ...                            ...   
499995                          0                              0   
499996                          0                              0   
499997                          0                              0   
499998                          0                              0   
499999                          0                              0   

        modbus_function_description-Forward Close - Response  \
0                                                       0      
1                                                       0      
2                                                       0      
3                                                       0      
4                                                       0      
...                                                   ...      
499995                                                  0      
499996                                                  0      
499997                                                  0      
499998                                                  0      
499999                                                  0      

        modbus_function_description-Read Tag Service  \
0                                                  0   
1                                                  0   
2                                                  1   
3                                                  1   
4                                                  1   
...                                              ...   
499995                                             1   
499996                                             1   
499997                                             1   
499998                                             0   
499999                                             0   

        modbus_function_description-Read Tag Service - Response  scada_tag-0  \
0                                                       1                  0   
1                                                       1                  0   
2                                                       0                  0   
3                                                       0                  0   
4                                                       0                  0   
...                                                   ...                ...   
499995                                                  0                  0   
499996                                                  0                  0   
499997                                                  0                  0   
499998                                                  1                  0   
499999                                                  1                  0   

        scada_tag-HMI_AIT202  scada_tag-HMI_FIT201  scada_tag-HMI_LIT101  \
0                          1                     0                     0   
1                          0                     1                     0   
2                          0                     0                     0   
3                          0                     0                     0   
4                          0                     0                     1   
...                      ...                   ...                   ...   
499995                     0                     0                     0   
499996                     0                     0                     1   
499997                     1                     0                     0   
499998                     0                     0                     1   
499999                     0                     0                     0   

        scada_tag-HMI_LIT301  scada_tag-HMI_LIT401  missing-0  missing-1  \
0                          0                     0          0          0   
1                          0                     0          0          0   
2                          0                     1          0          0   
3                          1                     0          0          0   
4                          0                     0          0          0   
...                      ...                   ...        ...        ...   
499995                     0                     1          0          0   
499996                     0                     0          0          0   
499997                     0                     0          0          0   
499998                     0                     0          0          0   
499999                     0                     1          0          0   

        missing-2  missing-3  missing-4  missing-5  missing-6  missing-7  \
0               0          0          0          0          0          0   
1               0          0          0          0          0          0   
2               0          0          0          0          0          0   
3               0          0          0          0          0          0   
4               0          0          0          0          0          0   
...           ...        ...        ...        ...        ...        ...   
499995          0          0          0          0          0          0   
499996          0          0          0          0          0          0   
499997          0          0          0          0          0          0   
499998          0          0          0          0          0          0   
499999          0          0          0          0          0          0   

        missing-8  missing-9  missing-10  missing-11  missing-12  missing-13  \
0               0          0           0           0           0           0   
1               0          0           0           0           0           0   
2               0          0           0           0           0           0   
3               0          0           0           0           0           0   
4               0          0           0           0           0           0   
...           ...        ...         ...         ...         ...         ...   
499995          0          0           0           0           0           0   
499996          0          0           0           0           0           0   
499997          0          0           0           0           0           0   
499998          0          0           0           0           0           0   
499999          0          0           0           0           0           0   

        missing-14  missing-15  missing-16  missing-17  missing-18  \
0                0           0           0           0           0   
1                0           0           0           0           0   
2                0           0           0           0           0   
3                0           0           0           0           0   
4                0           0           0           0           0   
...            ...         ...         ...         ...         ...   
499995           0           0           0           0           0   
499996           0           0           0           0           0   
499997           0           0           0           0           0   
499998           0           0           0           0           0   
499999           0           0           0           0           0   

        missing-19  missing-20  missing-21  missing-22  missing-23  missing-24  
0                0           0           0           0           0           0  
1                0           0           0           0           0           0  
2                0           0           0           0           0           0  
3                0           0           0           0           0           0  
4                0           0           0           0           0           0  
...            ...         ...         ...         ...         ...         ...  
499995           0           0           0           0           0           0  
499996           0           0           0           0           0           0  
499997           0           0           0           0           0           0  
499998           0           0           0           0           0           0  
499999           0           0           0           0           0           0  

[500000 rows x 108 columns]
[INFO] processing batch 0-256000/500000
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99297%,0.0:0.00664%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:57548 (22.47969%)
[INFO] ** service:[0.7025755984000001:99.99453%,0.0021476384:0.00117%,0.0:0.00117%,0.0021789908:0.00078%,0.0021633145999999997:0.00078%,0.08391465880000001:0.00078%,0.0297847659:0.00039%,0.08394601119999999:0.00039%]
[INFO] ** s_port:[0.834280824:25.90586%,0.8139250565:21.04297%,0.8029830673999999:18.20469%,0.8149336757:17.47891%,0.8137722355:17.3582%,0.792988569:0.00156%,0.0:0.00117%,0.0020936488:0.00117%,0.0021089309:0.00078%,0.814841983:0.00078%,0.8059172320999999:0.00078%,0.7897640443:0.00078%,0.0818051226:0.00078%,0.0290360046:0.00039%,0.8030441959000001:0.00039%,0.980989058:0.00039%,0.8345253376999999:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.10:[0:74.09375%,1:25.90625%]
[INFO] ** src-192.168.1.136:[0:99.99727%,1:0.00273%]
[INFO] ** src-192.168.1.19:[0:99.99727%,1:0.00273%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.52031%,1:17.47969%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.79492%,1:18.20508%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.59883%,1:38.40117%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.95547%,1:21.04453%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.73555%,1:43.26445%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.30:[0:82.5207%,1:17.4793%]
[INFO] ** dst-192.168.1.40:[0:81.79531%,1:18.20469%]
[INFO] ** dst-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99531%,0:0.00469%]
[INFO] ** proto-udp:[0:99.99648%,1:0.00352%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99297%,0:0.00703%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.09375%,1:25.90625%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52031%,1:17.47969%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.79492%,1:18.20508%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.59883%,1:38.40117%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99336%,1:0.00664%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00508%,1:49.99492%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** scada_tag-0:[0:99.98984%,1:0.01016%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64219%,1:17.35781%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.09453%,1:25.90547%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.95703%,1:21.04297%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.52109%,1:17.47891%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.79531%,1:18.20469%]
[INFO] ** missing-0:[0:100.0%]
[INFO] ** missing-1:[0:100.0%]
[INFO] ** missing-2:[0:100.0%]
[INFO] ** missing-3:[0:100.0%]
[INFO] ** missing-4:[0:100.0%]
[INFO] ** missing-5:[0:100.0%]
[INFO] ** missing-6:[0:100.0%]
[INFO] ** missing-7:[0:100.0%]
[INFO] ** missing-8:[0:100.0%]
[INFO] ** missing-9:[0:100.0%]
[INFO] ** missing-10:[0:100.0%]
[INFO] ** missing-11:[0:100.0%]
[INFO] ** missing-12:[0:100.0%]
[INFO] ** missing-13:[0:100.0%]
[INFO] ** missing-14:[0:100.0%]
[INFO] ** missing-15:[0:100.0%]
[INFO] ** missing-16:[0:100.0%]
[INFO] ** missing-17:[0:100.0%]
[INFO] ** missing-18:[0:100.0%]
[INFO] ** missing-19:[0:100.0%]
[INFO] ** missing-20:[0:100.0%]
[INFO] ** missing-21:[0:100.0%]
[INFO] ** missing-22:[0:100.0%]
[INFO] ** missing-23:[0:100.0%]
[INFO] ** missing-24:[0:100.0%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 8, 'type-alert': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-SSDP': 2, 'appi_name-Server Message Block (SMB)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 4s - loss: 1.4999 - tp: 0.0000e+00 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 192000.0000 - accuracy: 0.8000 - precision: 0.0000e+00 - recall: 0.0000e+00 - auc: 1.0000 - val_loss: 1.4629 - val_tp: 0.0000e+00 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 64000.0000 - val_accuracy: 0.8000 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-002-files-0-50-batch-0-256000
[INFO] processing batch 256000-512000/500000
[33m[LOSS] 1.462947630882263[0m
[33m[INFO] epoch 3/3[0m
[33m[INFO] loading file 1-50/1 on epoch 3/3[0m
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_113021_98.log.part12_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[INFO] sampling 1.0
[33mdropping column: modbus_value[0m
[33mencode_text_dummy orig[0m
[33mencode_text_dummy type[0m
[33mencode_text_dummy i/f_name[0m
[33mencode_text_dummy i/f_dir[0m
[33mencode_text_dummy src[0m
[33mencode_text_dummy dst[0m
[33mencode_text_dummy proto[0m
[33mencode_text_dummy appi_name[0m
[33mencode_text_dummy proxy_src_ip[0m
[33mencode_text_dummy modbus_function_description[0m
[33mencode_text_dummy scada_tag[0m
adding missing-0
adding missing-1
adding missing-2
adding missing-3
adding missing-4
adding missing-5
adding missing-6
adding missing-7
adding missing-8
adding missing-9
adding missing-10
adding missing-11
adding missing-12
adding missing-13
adding missing-14
adding missing-15
adding missing-16
adding missing-17
adding missing-18
adding missing-19
adding missing-20
adding missing-21
adding missing-22
adding missing-23
adding missing-24
len(df.columns) 108
numFeatures 107
[INFO] columns: Index(['unixtime', 'modbus_function_code', 'modbus_transaction_id', 'service',
       's_port', 'classification', 'orig-192.168.1.48', 'type-alert',
       'type-log', 'i/f_name-0',
       ...
       'missing-15', 'missing-16', 'missing-17', 'missing-18', 'missing-19',
       'missing-20', 'missing-21', 'missing-22', 'missing-23', 'missing-24'],
      dtype='object', length=108)
[INFO] analyze dataset: (500000, 108)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1356 (0.2712%)
[INFO] ** modbus_function_code:[0.9743589744:99.9928%,0.0:0.007%,1.0:0.0002%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** service:[0.7025755984000001:99.9936%,0.0:0.0012%,0.0021476384:0.001%,0.0021789908:0.0008%,0.0208806885:0.0008%,0.0021633145999999997:0.0006%,0.08394601119999999:0.0006%,0.002116286:0.0006%,0.08391465880000001:0.0004%,0.0297847659:0.0002%,0.08543524949999999:0.0002%]
[INFO] ** s_port:[0.834280824:25.8978%,0.8139250565:21.0408%,0.8029830673999999:18.1632%,0.8149336757:17.5212%,0.8137722355:17.368%,0.0:0.0012%,0.0020936488:0.001%,0.792988569:0.0008%,0.0021089309:0.0006%,0.814841983:0.0006%,0.7897640443:0.0004%,0.0818051226:0.0004%,0.8685433095:0.0004%,0.8059172320999999:0.0004%,0.8643407299:0.0002%,0.15240846019999998:0.0002%,0.9399107525:0.0002%,0.15243902439999998:0.0002%,0.980989058:0.0002%,0.8344030809:0.0002%,0.7593068036:0.0002%,0.8411730545999999:0.0002%,0.8668928418999999:0.0002%,0.7586191087:0.0002%,0.8345253376999999:0.0002%,0.0290360046:0.0002%,0.8030136315999999:0.0002%,0.8030441959000001:0.0002%,0.315972859:0.0002%,0.8876612262000001:0.0002%]
[INFO] ** classification:[normal:79.2972%,Single Stage Single Point:20.7028%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** type-alert:[0:99.9998%,1:0.0002%]
[INFO] ** type-log:[1:99.9998%,0:0.0002%]
[INFO] ** i/f_name-0:[0:99.9988%,1:0.0012%]
[INFO] ** i/f_name-eth1:[1:99.9988%,0:0.0012%]
[INFO] ** i/f_dir-inbound:[0:99.9988%,1:0.0012%]
[INFO] ** i/f_dir-outbound:[1:99.9988%,0:0.0012%]
[INFO] ** src-0:[0:99.9988%,1:0.0012%]
[INFO] ** src-192.168.1.10:[0:74.1018%,1:25.8982%]
[INFO] ** src-192.168.1.136:[0:99.9986%,1:0.0014%]
[INFO] ** src-192.168.1.19:[0:99.9986%,1:0.0014%]
[INFO] ** src-192.168.1.199:[0:99.9998%,1:0.0002%]
[INFO] ** src-192.168.1.20:[0:82.4782%,1:17.5218%]
[INFO] ** src-192.168.1.200:[0:99.9996%,1:0.0004%]
[INFO] ** src-192.168.1.201:[0:99.999%,1:0.001%]
[INFO] ** src-192.168.1.30:[0:81.8364%,1:18.1636%]
[INFO] ** src-192.168.1.40:[0:99.9996%,1:0.0004%]
[INFO] ** src-192.168.1.49:[0:99.999%,1:0.001%]
[INFO] ** src-192.168.1.60:[0:61.5912%,1:38.4088%]
[INFO] ** src-192.168.1.88:[0:99.9994%,1:0.0006%]
[INFO] ** dst-0:[0:99.9988%,1:0.0012%]
[INFO] ** dst-192.168.1.10:[0:78.9584%,1:21.0416%]
[INFO] ** dst-192.168.1.19:[0:99.9996%,1:0.0004%]
[INFO] ** dst-192.168.1.20:[0:56.734%,1:43.266%]
[INFO] ** dst-192.168.1.200:[0:99.9996%,1:0.0004%]
[INFO] ** dst-192.168.1.201:[0:99.9988%,1:0.0012%]
[INFO] ** dst-192.168.1.255:[0:99.9984%,1:0.0016%]
[INFO] ** dst-192.168.1.30:[0:82.4786%,1:17.5214%]
[INFO] ** dst-192.168.1.40:[0:81.8366%,1:18.1634%]
[INFO] ** dst-192.168.1.49:[0:99.9996%,1:0.0004%]
[INFO] ** dst-192.168.1.50:[0:99.999%,1:0.001%]
[INFO] ** dst-192.168.1.60:[0:99.9998%,1:0.0002%]
[INFO] ** dst-224.0.0.251:[0:99.9996%,1:0.0004%]
[INFO] ** dst-224.0.0.252:[0:99.9994%,1:0.0006%]
[INFO] ** dst-239.255.255.250:[0:99.9998%,1:0.0002%]
[INFO] ** proto-0:[0:99.9988%,1:0.0012%]
[INFO] ** proto-tcp:[1:99.996%,0:0.004%]
[INFO] ** proto-udp:[0:99.9972%,1:0.0028%]
[INFO] ** appi_name-0:[0:99.9988%,1:0.0012%]
[INFO] ** appi_name-CIP_gen:[0:99.9998%,1:0.0002%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.9928%,0:0.0072%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.9998%,1:0.0002%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.9998%,1:0.0002%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:99.9994%,1:0.0006%]
[INFO] ** appi_name-EtherNet/IP:[0:99.9998%,1:0.0002%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.9994%,1:0.0006%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.9996%,1:0.0004%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.9994%,1:0.0006%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.999%,1:0.001%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.9996%,1:0.0004%]
[INFO] ** appi_name-OSIsoft PI:[0:99.9998%,1:0.0002%]
[INFO] ** appi_name-SSDP:[0:99.9998%,1:0.0002%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.9996%,1:0.0004%]
[INFO] ** appi_name-Unknown Traffic:[0:99.9992%,1:0.0008%]
[INFO] ** proxy_src_ip-0:[0:99.9988%,1:0.0012%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.1018%,1:25.8982%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.9986%,1:0.0014%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.9986%,1:0.0014%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:99.9998%,1:0.0002%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.4782%,1:17.5218%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:99.9996%,1:0.0004%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:99.999%,1:0.001%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.8364%,1:18.1636%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.9996%,1:0.0004%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.999%,1:0.001%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.5912%,1:38.4088%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:99.9994%,1:0.0006%]
[INFO] ** modbus_function_description-0:[0:99.993%,1:0.007%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.9998%,1:0.0002%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.0046%,1:49.9954%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.0026%,1:49.9974%]
[INFO] ** scada_tag-0:[0:99.99%,1:0.01%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.6322%,1:17.3678%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.1024%,1:25.8976%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.9594%,1:21.0406%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.479%,1:17.521%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.837%,1:18.163%]
[INFO] ** missing-0:[0:100.0%]
[INFO] ** missing-1:[0:100.0%]
[INFO] ** missing-2:[0:100.0%]
[INFO] ** missing-3:[0:100.0%]
[INFO] ** missing-4:[0:100.0%]
[INFO] ** missing-5:[0:100.0%]
[INFO] ** missing-6:[0:100.0%]
[INFO] ** missing-7:[0:100.0%]
[INFO] ** missing-8:[0:100.0%]
[INFO] ** missing-9:[0:100.0%]
[INFO] ** missing-10:[0:100.0%]
[INFO] ** missing-11:[0:100.0%]
[INFO] ** missing-12:[0:100.0%]
[INFO] ** missing-13:[0:100.0%]
[INFO] ** missing-14:[0:100.0%]
[INFO] ** missing-15:[0:100.0%]
[INFO] ** missing-16:[0:100.0%]
[INFO] ** missing-17:[0:100.0%]
[INFO] ** missing-18:[0:100.0%]
[INFO] ** missing-19:[0:100.0%]
[INFO] ** missing-20:[0:100.0%]
[INFO] ** missing-21:[0:100.0%]
[INFO] ** missing-22:[0:100.0%]
[INFO] ** missing-23:[0:100.0%]
[INFO] ** missing-24:[0:100.0%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'classification': 2, 'type-alert': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.199': 2, 'src-192.168.1.20': 2, 'src-192.168.1.200': 2, 'src-192.168.1.201': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'src-192.168.1.88': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.19': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.200': 2, 'dst-192.168.1.201': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'dst-192.168.1.60': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-DCE-RPC Protocol': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-OSIsoft PI': 2, 'appi_name-SSDP': 2, 'appi_name-Server Message Block (SMB)': 2, 'appi_name-Unknown Traffic': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.199': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.200': 2, 'proxy_src_ip-192.168.1.201': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'proxy_src_ip-192.168.1.88': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
--------------AFTER DROPPING COLUMNS ----------------
df.columns Index(['unixtime', 'modbus_function_code', 'modbus_transaction_id', 'service',
       's_port', 'classification', 'orig-192.168.1.48', 'type-alert',
       'type-log', 'i/f_name-0',
       ...
       'missing-15', 'missing-16', 'missing-17', 'missing-18', 'missing-19',
       'missing-20', 'missing-21', 'missing-22', 'missing-23', 'missing-24'],
      dtype='object', length=108) 108
        unixtime  modbus_function_code  modbus_transaction_id   service  \
0       0.000000              0.974359               0.105043  0.702576   
1       0.000000              0.974359               0.049699  0.702576   
2       0.000000              0.974359               0.760021  0.702576   
3       0.000000              0.974359               0.724208  0.702576   
4       0.000000              0.974359               0.099031  0.702576   
...          ...                   ...                    ...       ...   
499995  0.003041              0.974359               0.129915  0.702576   
499996  0.003041              0.974359               0.570916  0.702576   
499997  0.003041              0.974359               0.713100  0.702576   
499998  0.003041              0.974359               0.570916  0.702576   
499999  0.003041              0.974359               0.129915  0.702576   

          s_port             classification  orig-192.168.1.48  type-alert  \
0       0.813772                     normal                  1           0   
1       0.834281                     normal                  1           0   
2       0.802983                     normal                  1           0   
3       0.814934                     normal                  1           0   
4       0.813925                     normal                  1           0   
...          ...                        ...                ...         ...   
499995  0.802983                     normal                  1           0   
499996  0.813925  Single Stage Single Point                  1           0   
499997  0.813772                     normal                  1           0   
499998  0.813925  Single Stage Single Point                  1           0   
499999  0.802983                     normal                  1           0   

        type-log  i/f_name-0  i/f_name-eth1  i/f_dir-inbound  \
0              1           0              1                0   
1              1           0              1                0   
2              1           0              1                0   
3              1           0              1                0   
4              1           0              1                0   
...          ...         ...            ...              ...   
499995         1           0              1                0   
499996         1           0              1                0   
499997         1           0              1                0   
499998         1           0              1                0   
499999         1           0              1                0   

        i/f_dir-outbound  src-0  src-192.168.1.10  src-192.168.1.136  \
0                      1      0                 0                  0   
1                      1      0                 1                  0   
2                      1      0                 0                  0   
3                      1      0                 0                  0   
4                      1      0                 0                  0   
...                  ...    ...               ...                ...   
499995                 1      0                 0                  0   
499996                 1      0                 0                  0   
499997                 1      0                 0                  0   
499998                 1      0                 0                  0   
499999                 1      0                 0                  0   

        src-192.168.1.19  src-192.168.1.199  src-192.168.1.20  \
0                      0                  0                 0   
1                      0                  0                 0   
2                      0                  0                 0   
3                      0                  0                 1   
4                      0                  0                 0   
...                  ...                ...               ...   
499995                 0                  0                 0   
499996                 0                  0                 0   
499997                 0                  0                 0   
499998                 0                  0                 0   
499999                 0                  0                 0   

        src-192.168.1.200  src-192.168.1.201  src-192.168.1.30  \
0                       0                  0                 0   
1                       0                  0                 0   
2                       0                  0                 1   
3                       0                  0                 0   
4                       0                  0                 0   
...                   ...                ...               ...   
499995                  0                  0                 1   
499996                  0                  0                 0   
499997                  0                  0                 0   
499998                  0                  0                 0   
499999                  0                  0                 1   

        src-192.168.1.40  src-192.168.1.49  src-192.168.1.60  \
0                      0                 0                 1   
1                      0                 0                 0   
2                      0                 0                 0   
3                      0                 0                 0   
4                      0                 0                 1   
...                  ...               ...               ...   
499995                 0                 0                 0   
499996                 0                 0                 1   
499997                 0                 0                 1   
499998                 0                 0                 1   
499999                 0                 0                 0   

        src-192.168.1.88  dst-0  dst-192.168.1.10  dst-192.168.1.19  \
0                      0      0                 0                 0   
1                      0      0                 0                 0   
2                      0      0                 0                 0   
3                      0      0                 0                 0   
4                      0      0                 1                 0   
...                  ...    ...               ...               ...   
499995                 0      0                 0                 0   
499996                 0      0                 1                 0   
499997                 0      0                 0                 0   
499998                 0      0                 1                 0   
499999                 0      0                 0                 0   

        dst-192.168.1.20  dst-192.168.1.200  dst-192.168.1.201  \
0                      1                  0                  0   
1                      1                  0                  0   
2                      0                  0                  0   
3                      0                  0                  0   
4                      0                  0                  0   
...                  ...                ...                ...   
499995                 0                  0                  0   
499996                 0                  0                  0   
499997                 1                  0                  0   
499998                 0                  0                  0   
499999                 0                  0                  0   

        dst-192.168.1.255  dst-192.168.1.30  dst-192.168.1.40  \
0                       0                 0                 0   
1                       0                 0                 0   
2                       0                 0                 1   
3                       0                 1                 0   
4                       0                 0                 0   
...                   ...               ...               ...   
499995                  0                 0                 1   
499996                  0                 0                 0   
499997                  0                 0                 0   
499998                  0                 0                 0   
499999                  0                 0                 1   

        dst-192.168.1.49  dst-192.168.1.50  dst-192.168.1.60  dst-224.0.0.251  \
0                      0                 0                 0                0   
1                      0                 0                 0                0   
2                      0                 0                 0                0   
3                      0                 0                 0                0   
4                      0                 0                 0                0   
...                  ...               ...               ...              ...   
499995                 0                 0                 0                0   
499996                 0                 0                 0                0   
499997                 0                 0                 0                0   
499998                 0                 0                 0                0   
499999                 0                 0                 0                0   

        dst-224.0.0.252  dst-239.255.255.250  proto-0  proto-tcp  proto-udp  \
0                     0                    0        0          1          0   
1                     0                    0        0          1          0   
2                     0                    0        0          1          0   
3                     0                    0        0          1          0   
4                     0                    0        0          1          0   
...                 ...                  ...      ...        ...        ...   
499995                0                    0        0          1          0   
499996                0                    0        0          1          0   
499997                0                    0        0          1          0   
499998                0                    0        0          1          0   
499999                0                    0        0          1          0   

        appi_name-0  appi_name-CIP_gen  appi_name-CIP_read_tag_service  \
0                 0                  0                               1   
1                 0                  0                               1   
2                 0                  0                               1   
3                 0                  0                               1   
4                 0                  0                               1   
...             ...                ...                             ...   
499995            0                  0                               1   
499996            0                  0                               1   
499997            0                  0                               1   
499998            0                  0                               1   
499999            0                  0                               1   

        appi_name-Common Industrial Protocol  \
0                                          0   
1                                          0   
2                                          0   
3                                          0   
4                                          0   
...                                      ...   
499995                                     0   
499996                                     0   
499997                                     0   
499998                                     0   
499999                                     0   

        appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)  \
0                                                       0                
1                                                       0                
2                                                       0                
3                                                       0                
4                                                       0                
...                                                   ...                
499995                                                  0                
499996                                                  0                
499997                                                  0                
499998                                                  0                
499999                                                  0                

        appi_name-DCE-RPC Protocol  appi_name-EtherNet/IP  \
0                                0                      0   
1                                0                      0   
2                                0                      0   
3                                0                      0   
4                                0                      0   
...                            ...                    ...   
499995                           0                      0   
499996                           0                      0   
499997                           0                      0   
499998                           0                      0   
499999                           0                      0   

        appi_name-LLMNR Protocol  appi_name-Multicast DNS Protocol (mDNS)  \
0                              0                                        0   
1                              0                                        0   
2                              0                                        0   
3                              0                                        0   
4                              0                                        0   
...                          ...                                      ...   
499995                         0                                        0   
499996                         0                                        0   
499997                         0                                        0   
499998                         0                                        0   
499999                         0                                        0   

        appi_name-NetBIOS Datagram Service  appi_name-NetBIOS Name Service  \
0                                        0                               0   
1                                        0                               0   
2                                        0                               0   
3                                        0                               0   
4                                        0                               0   
...                                    ...                             ...   
499995                                   0                               0   
499996                                   0                               0   
499997                                   0                               0   
499998                                   0                               0   
499999                                   0                               0   

        appi_name-NetBIOS Session Service  appi_name-OSIsoft PI  \
0                                       0                     0   
1                                       0                     0   
2                                       0                     0   
3                                       0                     0   
4                                       0                     0   
...                                   ...                   ...   
499995                                  0                     0   
499996                                  0                     0   
499997                                  0                     0   
499998                                  0                     0   
499999                                  0                     0   

        appi_name-SSDP  appi_name-Server Message Block (SMB)  \
0                    0                                     0   
1                    0                                     0   
2                    0                                     0   
3                    0                                     0   
4                    0                                     0   
...                ...                                   ...   
499995               0                                     0   
499996               0                                     0   
499997               0                                     0   
499998               0                                     0   
499999               0                                     0   

        appi_name-Unknown Traffic  proxy_src_ip-0  proxy_src_ip-192.168.1.10  \
0                               0               0                          0   
1                               0               0                          1   
2                               0               0                          0   
3                               0               0                          0   
4                               0               0                          0   
...                           ...             ...                        ...   
499995                          0               0                          0   
499996                          0               0                          0   
499997                          0               0                          0   
499998                          0               0                          0   
499999                          0               0                          0   

        proxy_src_ip-192.168.1.136  proxy_src_ip-192.168.1.19  \
0                                0                          0   
1                                0                          0   
2                                0                          0   
3                                0                          0   
4                                0                          0   
...                            ...                        ...   
499995                           0                          0   
499996                           0                          0   
499997                           0                          0   
499998                           0                          0   
499999                           0                          0   

        proxy_src_ip-192.168.1.199  proxy_src_ip-192.168.1.20  \
0                                0                          0   
1                                0                          0   
2                                0                          0   
3                                0                          1   
4                                0                          0   
...                            ...                        ...   
499995                           0                          0   
499996                           0                          0   
499997                           0                          0   
499998                           0                          0   
499999                           0                          0   

        proxy_src_ip-192.168.1.200  proxy_src_ip-192.168.1.201  \
0                                0                           0   
1                                0                           0   
2                                0                           0   
3                                0                           0   
4                                0                           0   
...                            ...                         ...   
499995                           0                           0   
499996                           0                           0   
499997                           0                           0   
499998                           0                           0   
499999                           0                           0   

        proxy_src_ip-192.168.1.30  proxy_src_ip-192.168.1.40  \
0                               0                          0   
1                               0                          0   
2                               1                          0   
3                               0                          0   
4                               0                          0   
...                           ...                        ...   
499995                          1                          0   
499996                          0                          0   
499997                          0                          0   
499998                          0                          0   
499999                          1                          0   

        proxy_src_ip-192.168.1.49  proxy_src_ip-192.168.1.60  \
0                               0                          1   
1                               0                          0   
2                               0                          0   
3                               0                          0   
4                               0                          1   
...                           ...                        ...   
499995                          0                          0   
499996                          0                          1   
499997                          0                          1   
499998                          0                          1   
499999                          0                          0   

        proxy_src_ip-192.168.1.88  modbus_function_description-0  \
0                               0                              0   
1                               0                              0   
2                               0                              0   
3                               0                              0   
4                               0                              0   
...                           ...                            ...   
499995                          0                              0   
499996                          0                              0   
499997                          0                              0   
499998                          0                              0   
499999                          0                              0   

        modbus_function_description-Forward Close - Response  \
0                                                       0      
1                                                       0      
2                                                       0      
3                                                       0      
4                                                       0      
...                                                   ...      
499995                                                  0      
499996                                                  0      
499997                                                  0      
499998                                                  0      
499999                                                  0      

        modbus_function_description-Read Tag Service  \
0                                                  0   
1                                                  0   
2                                                  1   
3                                                  1   
4                                                  1   
...                                              ...   
499995                                             1   
499996                                             1   
499997                                             1   
499998                                             0   
499999                                             0   

        modbus_function_description-Read Tag Service - Response  scada_tag-0  \
0                                                       1                  0   
1                                                       1                  0   
2                                                       0                  0   
3                                                       0                  0   
4                                                       0                  0   
...                                                   ...                ...   
499995                                                  0                  0   
499996                                                  0                  0   
499997                                                  0                  0   
499998                                                  1                  0   
499999                                                  1                  0   

        scada_tag-HMI_AIT202  scada_tag-HMI_FIT201  scada_tag-HMI_LIT101  \
0                          1                     0                     0   
1                          0                     1                     0   
2                          0                     0                     0   
3                          0                     0                     0   
4                          0                     0                     1   
...                      ...                   ...                   ...   
499995                     0                     0                     0   
499996                     0                     0                     1   
499997                     1                     0                     0   
499998                     0                     0                     1   
499999                     0                     0                     0   

        scada_tag-HMI_LIT301  scada_tag-HMI_LIT401  missing-0  missing-1  \
0                          0                     0          0          0   
1                          0                     0          0          0   
2                          0                     1          0          0   
3                          1                     0          0          0   
4                          0                     0          0          0   
...                      ...                   ...        ...        ...   
499995                     0                     1          0          0   
499996                     0                     0          0          0   
499997                     0                     0          0          0   
499998                     0                     0          0          0   
499999                     0                     1          0          0   

        missing-2  missing-3  missing-4  missing-5  missing-6  missing-7  \
0               0          0          0          0          0          0   
1               0          0          0          0          0          0   
2               0          0          0          0          0          0   
3               0          0          0          0          0          0   
4               0          0          0          0          0          0   
...           ...        ...        ...        ...        ...        ...   
499995          0          0          0          0          0          0   
499996          0          0          0          0          0          0   
499997          0          0          0          0          0          0   
499998          0          0          0          0          0          0   
499999          0          0          0          0          0          0   

        missing-8  missing-9  missing-10  missing-11  missing-12  missing-13  \
0               0          0           0           0           0           0   
1               0          0           0           0           0           0   
2               0          0           0           0           0           0   
3               0          0           0           0           0           0   
4               0          0           0           0           0           0   
...           ...        ...         ...         ...         ...         ...   
499995          0          0           0           0           0           0   
499996          0          0           0           0           0           0   
499997          0          0           0           0           0           0   
499998          0          0           0           0           0           0   
499999          0          0           0           0           0           0   

        missing-14  missing-15  missing-16  missing-17  missing-18  \
0                0           0           0           0           0   
1                0           0           0           0           0   
2                0           0           0           0           0   
3                0           0           0           0           0   
4                0           0           0           0           0   
...            ...         ...         ...         ...         ...   
499995           0           0           0           0           0   
499996           0           0           0           0           0   
499997           0           0           0           0           0   
499998           0           0           0           0           0   
499999           0           0           0           0           0   

        missing-19  missing-20  missing-21  missing-22  missing-23  missing-24  
0                0           0           0           0           0           0  
1                0           0           0           0           0           0  
2                0           0           0           0           0           0  
3                0           0           0           0           0           0  
4                0           0           0           0           0           0  
...            ...         ...         ...         ...         ...         ...  
499995           0           0           0           0           0           0  
499996           0           0           0           0           0           0  
499997           0           0           0           0           0           0  
499998           0           0           0           0           0           0  
499999           0           0           0           0           0           0  

[500000 rows x 108 columns]
[INFO] processing batch 0-256000/500000
[INFO] breaking into predictors and prediction...
CHUNK ANALYZE

[INFO] analyzing data
[INFO] 256000 rows
[INFO] ** unixtime:695 (0.27148%)
[INFO] ** modbus_function_code:[0.9743589744:99.99297%,0.0:0.00664%,1.0:0.00039%]
[INFO] ** modbus_transaction_id:57548 (22.47969%)
[INFO] ** service:[0.7025755984000001:99.99453%,0.0021476384:0.00117%,0.0:0.00117%,0.0021789908:0.00078%,0.0021633145999999997:0.00078%,0.08391465880000001:0.00078%,0.0297847659:0.00039%,0.08394601119999999:0.00039%]
[INFO] ** s_port:[0.834280824:25.90586%,0.8139250565:21.04297%,0.8029830673999999:18.20469%,0.8149336757:17.47891%,0.8137722355:17.3582%,0.792988569:0.00156%,0.0:0.00117%,0.0020936488:0.00117%,0.0021089309:0.00078%,0.814841983:0.00078%,0.8059172320999999:0.00078%,0.7897640443:0.00078%,0.0818051226:0.00078%,0.0290360046:0.00039%,0.8030441959000001:0.00039%,0.980989058:0.00039%,0.8345253376999999:0.00039%]
[INFO] ** classification:[normal:100.0%]
[INFO] ** orig-192.168.1.48:[1:100.0%]
[INFO] ** type-alert:[0:99.99961%,1:0.00039%]
[INFO] ** type-log:[1:99.99961%,0:0.00039%]
[INFO] ** i/f_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_name-eth1:[1:99.99883%,0:0.00117%]
[INFO] ** i/f_dir-inbound:[0:99.99883%,1:0.00117%]
[INFO] ** i/f_dir-outbound:[1:99.99883%,0:0.00117%]
[INFO] ** src-0:[0:99.99883%,1:0.00117%]
[INFO] ** src-192.168.1.10:[0:74.09375%,1:25.90625%]
[INFO] ** src-192.168.1.136:[0:99.99727%,1:0.00273%]
[INFO] ** src-192.168.1.19:[0:99.99727%,1:0.00273%]
[INFO] ** src-192.168.1.199:[0:100.0%]
[INFO] ** src-192.168.1.20:[0:82.52031%,1:17.47969%]
[INFO] ** src-192.168.1.200:[0:100.0%]
[INFO] ** src-192.168.1.201:[0:100.0%]
[INFO] ** src-192.168.1.30:[0:81.79492%,1:18.20508%]
[INFO] ** src-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** src-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** src-192.168.1.60:[0:61.59883%,1:38.40117%]
[INFO] ** src-192.168.1.88:[0:100.0%]
[INFO] ** dst-0:[0:99.99883%,1:0.00117%]
[INFO] ** dst-192.168.1.10:[0:78.95547%,1:21.04453%]
[INFO] ** dst-192.168.1.19:[0:100.0%]
[INFO] ** dst-192.168.1.20:[0:56.73555%,1:43.26445%]
[INFO] ** dst-192.168.1.200:[0:100.0%]
[INFO] ** dst-192.168.1.201:[0:100.0%]
[INFO] ** dst-192.168.1.255:[0:99.99805%,1:0.00195%]
[INFO] ** dst-192.168.1.30:[0:82.5207%,1:17.4793%]
[INFO] ** dst-192.168.1.40:[0:81.79531%,1:18.20469%]
[INFO] ** dst-192.168.1.49:[0:99.99922%,1:0.00078%]
[INFO] ** dst-192.168.1.50:[0:99.99844%,1:0.00156%]
[INFO] ** dst-192.168.1.60:[0:100.0%]
[INFO] ** dst-224.0.0.251:[0:99.99922%,1:0.00078%]
[INFO] ** dst-224.0.0.252:[0:99.99961%,1:0.00039%]
[INFO] ** dst-239.255.255.250:[0:99.99961%,1:0.00039%]
[INFO] ** proto-0:[0:99.99883%,1:0.00117%]
[INFO] ** proto-tcp:[1:99.99531%,0:0.00469%]
[INFO] ** proto-udp:[0:99.99648%,1:0.00352%]
[INFO] ** appi_name-0:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-CIP_gen:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-CIP_read_tag_service:[1:99.99297%,0:0.00703%]
[INFO] ** appi_name-Common Industrial Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Common Industrial Protocol - RMW (Read/Modify/Write):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-DCE-RPC Protocol:[0:100.0%]
[INFO] ** appi_name-EtherNet/IP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-LLMNR Protocol:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Multicast DNS Protocol (mDNS):[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Datagram Service:[0:99.99922%,1:0.00078%]
[INFO] ** appi_name-NetBIOS Name Service:[0:99.99883%,1:0.00117%]
[INFO] ** appi_name-NetBIOS Session Service:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-OSIsoft PI:[0:100.0%]
[INFO] ** appi_name-SSDP:[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Server Message Block (SMB):[0:99.99961%,1:0.00039%]
[INFO] ** appi_name-Unknown Traffic:[0:100.0%]
[INFO] ** proxy_src_ip-0:[0:99.99883%,1:0.00117%]
[INFO] ** proxy_src_ip-192.168.1.10:[0:74.09375%,1:25.90625%]
[INFO] ** proxy_src_ip-192.168.1.136:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-192.168.1.19:[0:99.99727%,1:0.00273%]
[INFO] ** proxy_src_ip-192.168.1.199:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.20:[0:82.52031%,1:17.47969%]
[INFO] ** proxy_src_ip-192.168.1.200:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.201:[0:100.0%]
[INFO] ** proxy_src_ip-192.168.1.30:[0:81.79492%,1:18.20508%]
[INFO] ** proxy_src_ip-192.168.1.40:[0:99.99922%,1:0.00078%]
[INFO] ** proxy_src_ip-192.168.1.49:[0:99.99961%,1:0.00039%]
[INFO] ** proxy_src_ip-192.168.1.60:[0:61.59883%,1:38.40117%]
[INFO] ** proxy_src_ip-192.168.1.88:[0:100.0%]
[INFO] ** modbus_function_description-0:[0:99.99336%,1:0.00664%]
[INFO] ** modbus_function_description-Forward Close - Response:[0:99.99961%,1:0.00039%]
[INFO] ** modbus_function_description-Read Tag Service:[0:50.00508%,1:49.99492%]
[INFO] ** modbus_function_description-Read Tag Service - Response:[0:50.00195%,1:49.99805%]
[INFO] ** scada_tag-0:[0:99.98984%,1:0.01016%]
[INFO] ** scada_tag-HMI_AIT202:[0:82.64219%,1:17.35781%]
[INFO] ** scada_tag-HMI_FIT201:[0:74.09453%,1:25.90547%]
[INFO] ** scada_tag-HMI_LIT101:[0:78.95703%,1:21.04297%]
[INFO] ** scada_tag-HMI_LIT301:[0:82.52109%,1:17.47891%]
[INFO] ** scada_tag-HMI_LIT401:[0:81.79531%,1:18.20469%]
[INFO] ** missing-0:[0:100.0%]
[INFO] ** missing-1:[0:100.0%]
[INFO] ** missing-2:[0:100.0%]
[INFO] ** missing-3:[0:100.0%]
[INFO] ** missing-4:[0:100.0%]
[INFO] ** missing-5:[0:100.0%]
[INFO] ** missing-6:[0:100.0%]
[INFO] ** missing-7:[0:100.0%]
[INFO] ** missing-8:[0:100.0%]
[INFO] ** missing-9:[0:100.0%]
[INFO] ** missing-10:[0:100.0%]
[INFO] ** missing-11:[0:100.0%]
[INFO] ** missing-12:[0:100.0%]
[INFO] ** missing-13:[0:100.0%]
[INFO] ** missing-14:[0:100.0%]
[INFO] ** missing-15:[0:100.0%]
[INFO] ** missing-16:[0:100.0%]
[INFO] ** missing-17:[0:100.0%]
[INFO] ** missing-18:[0:100.0%]
[INFO] ** missing-19:[0:100.0%]
[INFO] ** missing-20:[0:100.0%]
[INFO] ** missing-21:[0:100.0%]
[INFO] ** missing-22:[0:100.0%]
[INFO] ** missing-23:[0:100.0%]
[INFO] ** missing-24:[0:100.0%]
[INFO] columns with count within 2-10 {'modbus_function_code': 3, 'service': 8, 'type-alert': 2, 'type-log': 2, 'i/f_name-0': 2, 'i/f_name-eth1': 2, 'i/f_dir-inbound': 2, 'i/f_dir-outbound': 2, 'src-0': 2, 'src-192.168.1.10': 2, 'src-192.168.1.136': 2, 'src-192.168.1.19': 2, 'src-192.168.1.20': 2, 'src-192.168.1.30': 2, 'src-192.168.1.40': 2, 'src-192.168.1.49': 2, 'src-192.168.1.60': 2, 'dst-0': 2, 'dst-192.168.1.10': 2, 'dst-192.168.1.20': 2, 'dst-192.168.1.255': 2, 'dst-192.168.1.30': 2, 'dst-192.168.1.40': 2, 'dst-192.168.1.49': 2, 'dst-192.168.1.50': 2, 'dst-224.0.0.251': 2, 'dst-224.0.0.252': 2, 'dst-239.255.255.250': 2, 'proto-0': 2, 'proto-tcp': 2, 'proto-udp': 2, 'appi_name-0': 2, 'appi_name-CIP_gen': 2, 'appi_name-CIP_read_tag_service': 2, 'appi_name-Common Industrial Protocol': 2, 'appi_name-Common Industrial Protocol - RMW (Read/Modify/Write)': 2, 'appi_name-EtherNet/IP': 2, 'appi_name-LLMNR Protocol': 2, 'appi_name-Multicast DNS Protocol (mDNS)': 2, 'appi_name-NetBIOS Datagram Service': 2, 'appi_name-NetBIOS Name Service': 2, 'appi_name-NetBIOS Session Service': 2, 'appi_name-SSDP': 2, 'appi_name-Server Message Block (SMB)': 2, 'proxy_src_ip-0': 2, 'proxy_src_ip-192.168.1.10': 2, 'proxy_src_ip-192.168.1.136': 2, 'proxy_src_ip-192.168.1.19': 2, 'proxy_src_ip-192.168.1.20': 2, 'proxy_src_ip-192.168.1.30': 2, 'proxy_src_ip-192.168.1.40': 2, 'proxy_src_ip-192.168.1.49': 2, 'proxy_src_ip-192.168.1.60': 2, 'modbus_function_description-0': 2, 'modbus_function_description-Forward Close - Response': 2, 'modbus_function_description-Read Tag Service': 2, 'modbus_function_description-Read Tag Service - Response': 2, 'scada_tag-0': 2, 'scada_tag-HMI_AIT202': 2, 'scada_tag-HMI_FIT201': 2, 'scada_tag-HMI_LIT101': 2, 'scada_tag-HMI_LIT301': 2, 'scada_tag-HMI_LIT401': 2}
[INFO] to_xy labeltype: normal
indices (array([     0,      1,      2, ..., 255997, 255998, 255999]),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Single Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Single Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] to_xy labeltype: Multi Stage Multi Point
indices (array([], dtype=int64),)
y_vector [[1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 ...
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]]
z vector sum [256000.      0.      0.      0.      0.]
[INFO] creating train/test split: 0.25
--------SHAPES--------
x_train.shape (192000, 107)
x_test.shape (64000, 107)
y_train.shape (192000, 5)
y_test.shape (64000, 5)
[INFO] using LSTM layers
--------RESHAPED--------
x_train.shape (1500, 128, 107)
x_test.shape (500, 128, 107)
y_train.shape (1500, 128, 5)
y_test.shape (500, 128, 5)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] fitting model
Train on 1500 samples, validate on 500 samples
Epoch 1/1
 - 4s - loss: 1.4285 - tp: 0.0000e+00 - fp: 0.0000e+00 - tn: 768000.0000 - fn: 192000.0000 - accuracy: 0.8000 - precision: 0.0000e+00 - recall: 0.0000e+00 - auc: 1.0000 - val_loss: 1.3928 - val_tp: 0.0000e+00 - val_fp: 0.0000e+00 - val_tn: 256000.0000 - val_fn: 64000.0000 - val_accuracy: 0.8000 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00 - val_auc: 1.0000
[INFO] saving weights to checkpoints/lstm-epoch-003-files-0-50-batch-0-256000
[INFO] processing batch 256000-512000/500000
[33m[LOSS] 1.392761354446411[0m
[CHECKING EARLY STOP]: currentLoss < min_delta ? => 1.392761354446411  <  0.001
--- 25.235538959503174 seconds ---
2020-02-09 10:07:06.452844: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory
2020-02-09 10:07:06.452895: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory
2020-02-09 10:07:06.452901: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-02-09 10:07:06.942180: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory
2020-02-09 10:07:06.942200: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-02-09 10:07:06.942214: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (brussels): /proc/driver/nvidia/version does not exist
2020-02-09 10:07:06.942321: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-02-09 10:07:06.965841: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3312000000 Hz
2020-02-09 10:07:06.966133: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x52a6350 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-02-09 10:07:06.966158: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Using TensorFlow backend.
WARNING:tensorflow:Large dropout rate: 0.8 (>0.5). In TensorFlow 2.x, dropout() uses dropout rate instead of keep_prob. Please ensure that this is intended.
2020-02-09 10:07:11.140981: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-09 10:07:11.144094: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 10:07:11.145570: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 10:07:11.156375: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-02-09 10:07:11.157085: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/dense_2_loss/categorical_crossentropy/weighted_loss/concat'.
2020-02-09 10:07:11.158137: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 10:07:11.159180: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-02-09 10:07:11.161765: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
=================================================
        SCORING v0.4.4 (multi-class)
=================================================
Date: 2020-02-09 10:07:06.938879
MULTI-CLASS num classes: 5
------------DNN info-------------
wrapLayerSize 2
coreLayerSize 4
numCoreLayers 1
outputLayerActivation softmax
output_dim 5
loss categorical_crossentropy
optimizer adam
------------DNN info-------------
[INFO] input_shape (128, 107)
[INFO] LSTM first and last layer neurons: 2
[INFO] adding core layer 0
[INFO] created DNN
loading weights: checkpoints/*
loading file checkpoints/lstm-epoch-003-files-0-50-batch-0-256000
[33m[INFO] model summary:[0m
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 128, 2)            880       
_________________________________________________________________
dropout_1 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128, 4)            112       
_________________________________________________________________
dropout_2 (Dropout)          (None, 128, 4)            0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128, 2)            56        
_________________________________________________________________
dropout_3 (Dropout)          (None, 128, 2)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128, 1)            3         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128, 1)            0         
_________________________________________________________________
dense_2 (Dense)              (None, 128, 5)            10        
=================================================================
Total params: 1,061
Trainable params: 1,061
Non-trainable params: 0
_________________________________________________________________
[INFO] reading file data/SWaT2015-Attack-Files-v0.4.3-minmax-text/train/2015-12-28_113021_98.log.part13_sorted-labeled.csv
[INFO] concatenate the files
[INFO] process dataset, shape: (500000, 18)
[33mdropping column: modbus_value[0m
[INFO] columns: Index(['unixtime', 'orig', 'type', 'i/f_name', 'i/f_dir', 'src', 'dst',
       'proto', 'appi_name', 'proxy_src_ip', 'modbus_function_code',
       'modbus_function_description', 'modbus_transaction_id', 'scada_tag',
       'service', 's_port', 'classification'],
      dtype='object')
[INFO] analyze dataset: (500000, 17)

[INFO] analyzing data
[INFO] 500000 rows
[INFO] ** unixtime:1359 (0.2718%)
[INFO] ** orig:[192.168.1.48:100.0%]
[INFO] ** type:[log:100.0%]
[INFO] ** i/f_name:[eth1:99.9996%,0:0.0004%]
[INFO] ** i/f_dir:[outbound:99.9996%,inbound:0.0004%]
[INFO] ** src:[192.168.1.60:38.3832%,192.168.1.10:25.9606%,192.168.1.30:18.1352%,192.168.1.20:17.52%,192.168.1.201:0.0004%,0:0.0004%,192.168.1.40:0.0002%]
[INFO] ** dst:[192.168.1.20:43.3108%,192.168.1.10:21.0326%,192.168.1.40:18.135%,192.168.1.30:17.5198%,192.168.1.50:0.0008%,0:0.0004%,192.168.1.88:0.0004%,192.168.1.60:0.0002%]
[INFO] ** proto:[tcp:99.9996%,0:0.0004%]
[INFO] ** appi_name:[CIP_read_tag_service:99.9992%,0:0.0004%,DCE-RPC Protocol:0.0002%,Web Browsing:0.0002%]
[INFO] ** proxy_src_ip:[192.168.1.60:38.3832%,192.168.1.10:25.9606%,192.168.1.30:18.1352%,192.168.1.20:17.52%,192.168.1.201:0.0004%,0:0.0004%,192.168.1.40:0.0002%]
[INFO] ** modbus_function_code:[0.9743589744:99.9992%,0.0:0.0008%]
[INFO] ** modbus_function_description:[Read Tag Service - Response:50.0%,Read Tag Service:49.9992%,0:0.0008%]
[INFO] ** modbus_transaction_id:65536 (13.1072%)
[INFO] ** scada_tag:[HMI_FIT201:25.9596%,HMI_LIT101:21.0326%,HMI_LIT401:18.1348%,HMI_LIT301:17.5194%,HMI_AIT202:17.3504%,0:0.0032%]
[INFO] ** service:[0.7025755984000001:99.9992%,0.0:0.0004%,0.0012540954:0.0002%,0.002116286:0.0002%]
[INFO] ** s_port:[0.834280824:25.96%,0.8139250565:21.0326%,0.8029830673999999:18.1348%,0.8149336757:17.5196%,0.8137722355:17.3506%,0.8343113882:0.0004%,0.0:0.0004%,0.8059172320999999:0.0002%,0.8030136315999999:0.0002%,0.8147502904:0.0002%,0.8030441959000001:0.0002%,0.814841983:0.0002%,0.9621003729000001:0.0002%,0.8345253376999999:0.0002%,0.7788831836:0.0002%]
[INFO] ** classification:[normal:72.7902%,Single Stage Single Point:27.2098%]
[INFO] columns with count within 2-10 {'i/f_name': 2, 'i/f_dir': 2, 'src': 7, 'dst': 8, 'proto': 2, 'appi_name': 4, 'proxy_src_ip': 7, 'modbus_function_code': 2, 'modbus_function_description': 3, 'scada_tag': 6, 'service': 4, 'classification': 2}
[33mencode_text_dummy orig[0m
[33mencode_text_dummy type[0m
[33mencode_text_dummy i/f_name[0m
[33mencode_text_dummy i/f_dir[0m
[33mencode_text_dummy src[0m
[33mencode_text_dummy dst[0m
[33mencode_text_dummy proto[0m
[33mencode_text_dummy appi_name[0m
[33mencode_text_dummy proxy_src_ip[0m
[33mencode_text_dummy modbus_function_description[0m
[33mencode_text_dummy scada_tag[0m
adding missing-0
adding missing-1
adding missing-2
adding missing-3
adding missing-4
adding missing-5
adding missing-6
adding missing-7
adding missing-8
adding missing-9
adding missing-10
adding missing-11
adding missing-12
adding missing-13
adding missing-14
adding missing-15
adding missing-16
adding missing-17
adding missing-18
adding missing-19
adding missing-20
adding missing-21
adding missing-22
adding missing-23
adding missing-24
adding missing-25
adding missing-26
adding missing-27
adding missing-28
adding missing-29
adding missing-30
adding missing-31
adding missing-32
adding missing-33
adding missing-34
adding missing-35
adding missing-36
adding missing-37
adding missing-38
adding missing-39
adding missing-40
adding missing-41
adding missing-42
adding missing-43
adding missing-44
adding missing-45
adding missing-46
adding missing-47
adding missing-48
adding missing-49
adding missing-50
adding missing-51
adding missing-52
adding missing-53
adding missing-54
adding missing-55
adding missing-56
adding missing-57
adding missing-58
len(df.columns) 108
numFeatures 107
[INFO] processing batch 0-256000/500000
[33m[INFO] measuring accuracy...[0m
x_test.shape: (256000, 107)
y_eval [1 0 1 ... 0 0 0] (256000,)
[INFO] reshape for using LSTM layers
[33m[INFO] metrics:[0m
loss :  1.457466917037964
tp :  0.0
fp :  0.0
tn :  1024000.0
fn :  256000.0
accuracy :  0.7999964356422424
precision :  0.0
recall :  0.0
auc :  0.8550854325294495

y_eval {0: 196643, 1: 59357}
pred {0: 256000}
[INFO] confusion matrix for file 
[[196643      0      0      0      0]
 [ 59357      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] confusion matrix after adding it to total:
[[196643      0      0      0      0]
 [ 59357      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]
 [     0      0      0      0      0]]
[INFO] processing batch 256000-512000/500000
--- 6.567343235015869 seconds ---
